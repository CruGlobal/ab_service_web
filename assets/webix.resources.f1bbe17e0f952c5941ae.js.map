{"version":3,"file":"webix.resources.f1bbe17e0f952c5941ae.js","mappings":"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,QACPue,KAAM,OACN4iE,aAAc,aACdC,MAAO,QACPC,MAAO,QACPC,IAAK,MACLrM,SAAU,WACV91D,MAAO,QACPhkC,KAAM,OACN6gD,GAAI,KACJulD,aAAc,aACdC,oBAAqB,oBACrBC,WAAY,WACZC,eAAgB,eAGhBC,MAAO,QACPC,KAAM,OACNC,MAAO,QACPvuF,IAAK,MACL6hB,KAAM,OACNvhB,MAAO,QACPkuF,OAAQ,SACRvtE,KAAM,OACNuwD,MAAO,QACP74E,KAAM,QACN81F,QAAS,UACTjuE,MAAO,QACPoB,OAAQ,SACR8sE,OAAQ,SACR7tE,KAAM,OACN8tE,MAAO,QACPC,OAAQ,SACRC,aAAc,aACdC,eAAgB,eAChBC,KAAM,OACNC,MAAO,QACPC,gBAAiB,gBACjBC,iBAAkB,iBAClBC,gBAAiB,gBACjBC,oBAAqB,oBACrBC,OAAQ,SACRC,MAAO,QACP9+F,GAAI,KACJ++F,GAAI,KACJC,cAAe,cACfC,4BAA6B,4BAC7Bn3F,KAAM,OACNo3F,UAAW,UACXC,2BAA4B,2BAC5BvjE,gBAAiB,gBAGjBwjE,aAAc,aACdC,aAAc,aACdC,+BAAgC,+BAChCptC,OAAQ,SACRD,MAAO,QACPstC,uBAAwB,uBAExBC,iBAAkB,iBAClBC,QAAS,UACTC,YAAa,YAEb1zB,UAAW,UACX2zB,aAAc;;;;;;;;;;;A8H/Gf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mDAAmD,yBAAyB;AAC5E;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA,mDAAmD,yBAAyB;AAC5E;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA,kBAAkB,0BAA0B;AAC5C;AACA;AACA,IAAI;AACJ;AACA;AACA,aAAa,IAAI;AACjB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mDAAmD,yBAAyB;AAC5E;AACA,OAAO;AACP;AACA;AACA;;AAEA,gDAAgD,yBAAyB;AACzE;AACA,OAAO;AACP,IAAI;AACJ;;;;;;;;;;;;;;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8IAGC;AACkC;AACnC,gJAGC;AACD,6IAGC;AACwC;AACzC;AACA;AACuD;AACvD,kJAGC;AACD,qJAGC;;AAED;AAC4B","sources":["webpack://ab_platform_web/./js/webix/components/gantt/ sync","webpack://ab_platform_web/./js/webix/components/pivot/ sync","webpack://ab_platform_web/./js/webix/components/reports/ sync","webpack://ab_platform_web/./js/webix/components/scheduler/ sync","webpack://ab_platform_web/./js/webix/components/node_modules/webix-jet/dist/es6/jet.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/rLayout.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/jetWin.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-restate/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dragscroll.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dnd.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/bars.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/diagram.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/common.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/rdiagram/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/baseline.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/links.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/numeditor.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/resources.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/info.js","webpack://ab_platform_web/./js/webix/components/sources/views/task/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/tree.js","webpack://ab_platform_web/./js/webix/components/sources/views/top.js","webpack://ab_platform_web/./js/webix/components/sources/export_views.js","webpack://ab_platform_web/./js/webix/components/sources/models/Local.js","webpack://ab_platform_web/./js/webix/components/sources/models/Backend.js","webpack://ab_platform_web/./js/webix/components/sources/models/Operations.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/Helpers.js","webpack://ab_platform_web/./js/webix/components/sources/models/Grouping.js","webpack://ab_platform_web/./js/webix/components/sources/app.js","webpack://ab_platform_web/./js/webix/components/sources/locales/en.js","webpack://ab_platform_web/./js/webix/components/sources/header.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/image.js","webpack://ab_platform_web/./js/webix/components/sources/common.js","webpack://ab_platform_web/./js/webix/components/sources/list.js","webpack://ab_platform_web/./js/webix/components/sources/dataview.js","webpack://ab_platform_web/./js/webix/components/sources/uploader.js","webpack://ab_platform_web/./js/webix/components/sources/kanban.js","webpack://ab_platform_web/./js/webix/components/sources/locale.js","webpack://ab_platform_web/./js/webix/components/sources/editor.js","webpack://ab_platform_web/./js/webix/components/sources/userlist.js","webpack://ab_platform_web/./js/webix/components/sources/menu.js","webpack://ab_platform_web/./js/webix/components/sources/comments.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/portlet.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/complex.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/values.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/group.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/properties/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/filter.js","webpack://ab_platform_web/./js/webix/components/sources/views/mode.js","webpack://ab_platform_web/./js/webix/components/sources/views/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/config/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/main.js","webpack://ab_platform_web/./js/webix/components/sources/views/table.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/rengine/dist/rengine.es6.js","webpack://ab_platform_web/./js/webix/components/sources/models/LocalData.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/common/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/jet-restate-bind/index.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/inputlist.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/icons.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/query/codebase/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/common.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/prompt.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/queryselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/query.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/data.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summarypopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucket.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/bucketpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/groupselect.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/buckets.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/datepopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/summary.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/groups.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/other/sorts.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/axis.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/baseview.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/colorpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/rsearch.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chartseries.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/column.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/editor/structure/table.js","webpack://ab_platform_web/./js/webix/components/sources/views/empty.js","webpack://ab_platform_web/./js/webix/components/sources/views/heatmap.js","webpack://ab_platform_web/./js/webix/components/sources/views/menu.js","webpack://ab_platform_web/./js/webix/components/sources/views/modules.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/export.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/toolbar.js","webpack://ab_platform_web/./js/webix/components/sources/views/table/index.js","webpack://ab_platform_web/./js/webix/components/node_modules/jet-hotkey/index.js","webpack://ab_platform_web/./js/webix/components/sources/models/Charts.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/jet-helpers/waitVisible.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/add.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/date.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/nav.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/palette.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/editor.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/popup.js","webpack://ab_platform_web/./js/webix/components/sources/views/side/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/navpopup.js","webpack://ab_platform_web/./js/webix/components/sources/views/bars/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/actionmenu.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/dates.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/ical.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/recurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/recurringform.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/editrecurring.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/form.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/formpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/copypaste.js","webpack://ab_platform_web/./js/webix/components/sources/views/event/info.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/colors.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/actionpopup.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/templates.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/unitlist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/agenda/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/hourscale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/common/multimore.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/selection.js","webpack://ab_platform_web/./js/webix/components/sources/helpers/resizer.js","webpack://ab_platform_web/./js/webix/components/node_modules/@xbs/webix-gantt-lib/dist/wgantt.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/day/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/list.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/month/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/bar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/more.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/chart.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/scale.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/timeline/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/events.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multidaylist.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/units/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/compact.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/header.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/multiday.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/week/index.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/calendar.js","webpack://ab_platform_web/./js/webix/components/sources/views/modes/year/index.js","webpack://ab_platform_web/./js/webix/locales/th-TH.js","webpack://ab_platform_web/./js/webix/webixResources.js"],"sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 69907;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 24327;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 31163;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 38509;\nmodule.exports = webpackEmptyContext;","class NavigationBlocked {\r\n}\n\nclass JetBase {\r\n    constructor(webix, config) {\r\n        this.webixJet = true;\r\n        this.webix = webix;\r\n        this._events = [];\r\n        this._subs = {};\r\n        this._data = {};\r\n        if (config && config.params)\r\n            webix.extend(this._data, config.params);\r\n    }\r\n    getRoot() {\r\n        return this._root;\r\n    }\r\n    destructor() {\r\n        this._detachEvents();\r\n        this._destroySubs();\r\n        this._events = this._container = this.app = this._parent = this._root = null;\r\n    }\r\n    setParam(id, value, url) {\r\n        if (this._data[id] !== value) {\r\n            this._data[id] = value;\r\n            this._segment.update(id, value, 0);\r\n            if (url) {\r\n                return this.show(null);\r\n            }\r\n        }\r\n    }\r\n    getParam(id, parent) {\r\n        const value = this._data[id];\r\n        if (typeof value !== \"undefined\" || !parent) {\r\n            return value;\r\n        }\r\n        const view = this.getParentView();\r\n        if (view) {\r\n            return view.getParam(id, parent);\r\n        }\r\n    }\r\n    getUrl() {\r\n        return this._segment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._segment.toString();\r\n    }\r\n    getParentView() {\r\n        return this._parent;\r\n    }\r\n    $$(id) {\r\n        if (typeof id === \"string\") {\r\n            const root = this.getRoot();\r\n            return root.queryView((obj => (obj.config.id === id || obj.config.localId === id) &&\r\n                (obj.$scope === root.$scope)), \"self\");\r\n        }\r\n        else {\r\n            return id;\r\n        }\r\n    }\r\n    on(obj, name, code) {\r\n        const id = obj.attachEvent(name, code);\r\n        this._events.push({ obj, id });\r\n        return id;\r\n    }\r\n    contains(view) {\r\n        for (const key in this._subs) {\r\n            const kid = this._subs[key].view;\r\n            if (kid === view || kid.contains(view)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    getSubView(name) {\r\n        const sub = this.getSubViewInfo(name);\r\n        if (sub) {\r\n            return sub.subview.view;\r\n        }\r\n    }\r\n    getSubViewInfo(name) {\r\n        const sub = this._subs[name || \"default\"];\r\n        if (sub) {\r\n            return { subview: sub, parent: this };\r\n        }\r\n        if (name === \"_top\") {\r\n            this._subs[name] = { url: \"\", id: null, popup: true };\r\n            return this.getSubViewInfo(name);\r\n        }\r\n        // when called from a child view, searches for nearest parent with subview\r\n        if (this._parent) {\r\n            return this._parent.getSubViewInfo(name);\r\n        }\r\n        return null;\r\n    }\r\n    _detachEvents() {\r\n        const events = this._events;\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            events[i].obj.detachEvent(events[i].id);\r\n        }\r\n    }\r\n    _destroySubs() {\r\n        // destroy sub views\r\n        for (const key in this._subs) {\r\n            const subView = this._subs[key].view;\r\n            // it possible that subview was not loaded with any content yet\r\n            // so check on null\r\n            if (subView) {\r\n                subView.destructor();\r\n            }\r\n        }\r\n        // reset to prevent memory leaks\r\n        this._subs = {};\r\n    }\r\n    _init_url_data() {\r\n        const url = this._segment.current();\r\n        this._data = {};\r\n        this.webix.extend(this._data, url.params, true);\r\n    }\r\n    _getDefaultSub() {\r\n        if (this._subs.default) {\r\n            return this._subs.default;\r\n        }\r\n        for (const key in this._subs) {\r\n            const sub = this._subs[key];\r\n            if (!sub.branch && sub.view && key !== \"_top\") {\r\n                const child = sub.view._getDefaultSub();\r\n                if (child) {\r\n                    return child;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _routed_view() {\r\n        const parent = this.getParentView();\r\n        if (!parent) {\r\n            return true;\r\n        }\r\n        const sub = parent._getDefaultSub();\r\n        if (!sub && sub !== this) {\r\n            return false;\r\n        }\r\n        return parent._routed_view();\r\n    }\r\n}\n\nfunction parse(url) {\r\n    // remove starting /\r\n    if (url[0] === \"/\") {\r\n        url = url.substr(1);\r\n    }\r\n    // split url by \"/\"\r\n    const parts = url.split(\"/\");\r\n    const chunks = [];\r\n    // for each page in url\r\n    for (let i = 0; i < parts.length; i++) {\r\n        const test = parts[i];\r\n        const result = {};\r\n        // detect params\r\n        // support old \t\t\tsome:a=b:c=d\r\n        // and new notation\t\tsome?a=b&c=d\r\n        let pos = test.indexOf(\":\");\r\n        if (pos === -1) {\r\n            pos = test.indexOf(\"?\");\r\n        }\r\n        if (pos !== -1) {\r\n            const params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\r\n            // create hash of named params\r\n            for (const param of params) {\r\n                const dchunk = param.split(\"=\");\r\n                result[dchunk[0]] = decodeURIComponent(dchunk[1]);\r\n            }\r\n        }\r\n        // store parsed values\r\n        chunks[i] = {\r\n            page: (pos > -1 ? test.substr(0, pos) : test),\r\n            params: result,\r\n            isNew: true\r\n        };\r\n    }\r\n    // return array of page objects\r\n    return chunks;\r\n}\r\nfunction url2str(stack) {\r\n    const url = [];\r\n    for (const chunk of stack) {\r\n        url.push(\"/\" + chunk.page);\r\n        const params = obj2str(chunk.params);\r\n        if (params) {\r\n            url.push(\"?\" + params);\r\n        }\r\n    }\r\n    return url.join(\"\");\r\n}\r\nfunction obj2str(obj) {\r\n    const str = [];\r\n    for (const key in obj) {\r\n        if (typeof obj[key] === \"object\")\r\n            continue;\r\n        if (str.length) {\r\n            str.push(\"&\");\r\n        }\r\n        str.push(key + \"=\" + encodeURIComponent(obj[key]));\r\n    }\r\n    return str.join(\"\");\r\n}\n\nclass Route {\r\n    constructor(route, index) {\r\n        this._next = 1;\r\n        if (typeof route === \"string\") {\r\n            this.route = {\r\n                url: parse(route),\r\n                path: route\r\n            };\r\n        }\r\n        else {\r\n            this.route = route;\r\n        }\r\n        this.index = index;\r\n    }\r\n    current() {\r\n        return this.route.url[this.index];\r\n    }\r\n    next() {\r\n        return this.route.url[this.index + this._next];\r\n    }\r\n    suburl() {\r\n        return this.route.url.slice(this.index);\r\n    }\r\n    shift(params) {\r\n        const route = new Route(this.route, this.index + this._next);\r\n        route.setParams(route.route.url, params, route.index);\r\n        return route;\r\n    }\r\n    setParams(url, params, index) {\r\n        if (params) {\r\n            const old = url[index].params;\r\n            for (var key in params)\r\n                old[key] = params[key];\r\n        }\r\n    }\r\n    refresh() {\r\n        const url = this.route.url;\r\n        for (let i = this.index + 1; i < url.length; i++) {\r\n            url[i].isNew = true;\r\n        }\r\n    }\r\n    toString() {\r\n        const str = url2str(this.suburl());\r\n        return str ? str.substr(1) : \"\";\r\n    }\r\n    _join(path, kids) {\r\n        let url = this.route.url;\r\n        if (path === null) { // change of parameters, route elements are not affected\r\n            return url;\r\n        }\r\n        const old = this.route.url;\r\n        let reset = true;\r\n        url = old.slice(0, this.index + (kids ? this._next : 0));\r\n        if (path) {\r\n            url = url.concat(parse(path));\r\n            for (let i = 0; i < url.length; i++) {\r\n                if (old[i]) {\r\n                    url[i].view = old[i].view;\r\n                }\r\n                if (reset && old[i] && url[i].page === old[i].page) {\r\n                    url[i].isNew = false;\r\n                }\r\n                else if (url[i].isNew) {\r\n                    // if some segment was marked as new, all subsegments must be updated as well\r\n                    reset = false;\r\n                }\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n    append(path) {\r\n        const url = this._join(path, true);\r\n        this.route.path = url2str(url);\r\n        this.route.url = url;\r\n        return this.route.path;\r\n    }\r\n    show(path, view, kids) {\r\n        const url = this._join(path.url, kids);\r\n        this.setParams(url, path.params, this.index + (kids ? this._next : 0));\r\n        return new Promise((res, rej) => {\r\n            const redirect = url2str(url);\r\n            const obj = {\r\n                url,\r\n                redirect,\r\n                confirm: Promise.resolve()\r\n            };\r\n            const app = view ? view.app : null;\r\n            // when creating a new route, it possible that it will not have any content\r\n            // guard is not necessary in such case\r\n            if (app) {\r\n                const result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\r\n                if (!result) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n            }\r\n            obj.confirm.catch(err => rej(err)).then(() => {\r\n                if (obj.redirect === null) {\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                if (obj.redirect !== redirect) {\r\n                    app.show(obj.redirect);\r\n                    rej(new NavigationBlocked());\r\n                    return;\r\n                }\r\n                this.route.path = redirect;\r\n                this.route.url = url;\r\n                res();\r\n            });\r\n        });\r\n    }\r\n    size(n) {\r\n        this._next = n;\r\n    }\r\n    split() {\r\n        const route = {\r\n            url: this.route.url.slice(this.index + 1),\r\n            path: \"\"\r\n        };\r\n        if (route.url.length) {\r\n            route.path = url2str(route.url);\r\n        }\r\n        return new Route(route, 0);\r\n    }\r\n    update(name, value, index) {\r\n        const chunk = this.route.url[this.index + (index || 0)];\r\n        if (!chunk) {\r\n            this.route.url.push({ page: \"\", params: {} });\r\n            return this.update(name, value, index);\r\n        }\r\n        if (name === \"\") {\r\n            chunk.page = value;\r\n        }\r\n        else {\r\n            chunk.params[name] = value;\r\n        }\r\n        this.route.path = url2str(this.route.url);\r\n    }\r\n}\n\nclass JetView extends JetBase {\r\n    constructor(app, config) {\r\n        super(app.webix);\r\n        this.app = app;\r\n        //this.$config = config;\r\n        this._children = [];\r\n    }\r\n    ui(ui, config) {\r\n        config = config || {};\r\n        const container = config.container || ui.container;\r\n        const jetview = this.app.createView(ui);\r\n        this._children.push(jetview);\r\n        jetview.render(container, this._segment, this);\r\n        if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\r\n            // raw webix UI\r\n            return jetview;\r\n        }\r\n        else {\r\n            return jetview.getRoot();\r\n        }\r\n    }\r\n    show(path, config) {\r\n        config = config || {};\r\n        // convert parameters object to url\r\n        if (typeof path === \"object\") {\r\n            for (const key in path) {\r\n                this.setParam(key, path[key]);\r\n            }\r\n            path = null;\r\n        }\r\n        else {\r\n            // deligate to app in case of root prefix\r\n            if (path.substr(0, 1) === \"/\") {\r\n                return this.app.show(path, config);\r\n            }\r\n            // local path, do nothing\r\n            if (path.indexOf(\"./\") === 0) {\r\n                path = path.substr(2);\r\n            }\r\n            // parent path, call parent view\r\n            if (path.indexOf(\"../\") === 0) {\r\n                const parent = this.getParentView();\r\n                if (parent) {\r\n                    return parent.show(path.substr(3), config);\r\n                }\r\n                else {\r\n                    return this.app.show(\"/\" + path.substr(3));\r\n                }\r\n            }\r\n            const sub = this.getSubViewInfo(config.target);\r\n            if (sub) {\r\n                if (sub.parent !== this) {\r\n                    return sub.parent.show(path, config);\r\n                }\r\n                else if (config.target && config.target !== \"default\") {\r\n                    return this._renderFrameLock(config.target, sub.subview, {\r\n                        url: path,\r\n                        params: config.params,\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                if (path) {\r\n                    return this.app.show(\"/\" + path, config);\r\n                }\r\n            }\r\n        }\r\n        return this._show(this._segment, { url: path, params: config.params }, this);\r\n    }\r\n    _show(segment, path, view) {\r\n        return segment.show(path, view, true).then(() => {\r\n            this._init_url_data();\r\n            return this._urlChange();\r\n        }).then(() => {\r\n            if (segment.route.linkRouter) {\r\n                this.app.getRouter().set(segment.route.path, { silent: true });\r\n                this.app.callEvent(\"app:route\", [segment.route.path]);\r\n            }\r\n        });\r\n    }\r\n    init(_$view, _$) {\r\n        // stub\r\n    }\r\n    ready(_$view, _$url) {\r\n        // stub\r\n    }\r\n    config() {\r\n        this.app.webix.message(\"View:Config is not implemented\");\r\n    }\r\n    urlChange(_$view, _$url) {\r\n        // stub\r\n    }\r\n    destroy() {\r\n        // stub\r\n    }\r\n    destructor() {\r\n        this.destroy();\r\n        this._destroyKids();\r\n        // destroy actual UI\r\n        if (this._root) {\r\n            this._root.destructor();\r\n            super.destructor();\r\n        }\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this.app, this, config);\r\n    }\r\n    refresh() {\r\n        const url = this.getUrl();\r\n        this.destroy();\r\n        this._destroyKids();\r\n        this._destroySubs();\r\n        this._detachEvents();\r\n        if (this._container.tagName) {\r\n            this._root.destructor();\r\n        }\r\n        this._segment.refresh();\r\n        return this._render(this._segment);\r\n    }\r\n    render(root, url, parent) {\r\n        if (typeof url === \"string\") {\r\n            url = new Route(url, 0);\r\n        }\r\n        this._segment = url;\r\n        this._parent = parent;\r\n        this._init_url_data();\r\n        root = root || document.body;\r\n        const _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\r\n        if (this._container !== _container) {\r\n            this._container = _container;\r\n            return this._render(url);\r\n        }\r\n        else {\r\n            return this._urlChange().then(() => this.getRoot());\r\n        }\r\n    }\r\n    _render(url) {\r\n        const config = this.config();\r\n        if (config.then) {\r\n            return config.then(cfg => this._render_final(cfg, url));\r\n        }\r\n        else {\r\n            return this._render_final(config, url);\r\n        }\r\n    }\r\n    _render_final(config, url) {\r\n        // get previous view in the same slot\r\n        let slot = null;\r\n        let container = null;\r\n        let show = false;\r\n        if (!this._container.tagName) {\r\n            slot = this._container;\r\n            if (slot.popup) {\r\n                container = document.body;\r\n                show = true;\r\n            }\r\n            else {\r\n                container = this.webix.$$(slot.id);\r\n            }\r\n        }\r\n        else {\r\n            container = this._container;\r\n        }\r\n        // view already destroyed\r\n        if (!this.app || !container) {\r\n            return Promise.reject(null);\r\n        }\r\n        let response;\r\n        const current = this._segment.current();\r\n        // using wrapper object, so ui can be changed from app:render event\r\n        const result = { ui: {} };\r\n        this.app.copyConfig(config, result.ui, this._subs);\r\n        this.app.callEvent(\"app:render\", [this, url, result]);\r\n        result.ui.$scope = this;\r\n        /* destroy old HTML attached views before creating new one */\r\n        if (!slot && current.isNew && current.view) {\r\n            current.view.destructor();\r\n        }\r\n        try {\r\n            // special handling for adding inside of multiview - preserve old id\r\n            if (slot && !show) {\r\n                const oldui = container;\r\n                const parent = oldui.getParentView();\r\n                if (parent && parent.name === \"multiview\" && !result.ui.id) {\r\n                    result.ui.id = oldui.config.id;\r\n                }\r\n            }\r\n            this._root = this.app.webix.ui(result.ui, container);\r\n            const asWin = this._root;\r\n            // check for url added to ignore this.ui calls\r\n            if (show && asWin.setPosition && !asWin.isVisible()) {\r\n                asWin.show();\r\n            }\r\n            // check, if we are replacing some older view\r\n            if (slot) {\r\n                if (slot.view && slot.view !== this && slot.view !== this.app) {\r\n                    slot.view.destructor();\r\n                }\r\n                slot.id = this._root.config.id;\r\n                if (this.getParentView() || !this.app.app)\r\n                    slot.view = this;\r\n                else {\r\n                    // when we have subapp, set whole app as a view\r\n                    // so on destruction, the whole app will be destroyed\r\n                    slot.view = this.app;\r\n                }\r\n            }\r\n            if (current.isNew) {\r\n                current.view = this;\r\n                current.isNew = false;\r\n            }\r\n            response = Promise.resolve(this._init(this._root, url)).then(() => {\r\n                return this._urlChange().then(() => {\r\n                    this._initUrl = null;\r\n                    return this.ready(this._root, url.suburl());\r\n                });\r\n            });\r\n        }\r\n        catch (e) {\r\n            response = Promise.reject(e);\r\n        }\r\n        return response.catch(err => this._initError(this, err));\r\n    }\r\n    _init(view, url) {\r\n        return this.init(view, url.suburl());\r\n    }\r\n    _urlChange() {\r\n        this.app.callEvent(\"app:urlchange\", [this, this._segment]);\r\n        const waits = [];\r\n        for (const key in this._subs) {\r\n            const frame = this._subs[key];\r\n            const wait = this._renderFrameLock(key, frame, null);\r\n            if (wait) {\r\n                waits.push(wait);\r\n            }\r\n        }\r\n        return Promise.all(waits).then(() => {\r\n            return this.urlChange(this._root, this._segment.suburl());\r\n        });\r\n    }\r\n    _renderFrameLock(key, frame, path) {\r\n        // if subview is not occupied by some rendering yet\r\n        if (!frame.lock) {\r\n            // retreive and store rendering end promise\r\n            const lock = this._renderFrame(key, frame, path);\r\n            if (lock) {\r\n                // clear lock after frame rendering\r\n                // as promise.finally is not supported by  Webix lesser than 6.2\r\n                // using a more verbose notation\r\n                frame.lock = lock.then(() => frame.lock = null, () => frame.lock = null);\r\n            }\r\n        }\r\n        // return rendering end promise\r\n        return frame.lock;\r\n    }\r\n    _renderFrame(key, frame, path) {\r\n        //default route\r\n        if (key === \"default\") {\r\n            if (this._segment.next()) {\r\n                // we have a next segment in url, render it\r\n                let params = path ? path.params : null;\r\n                if (frame.params) {\r\n                    params = this.webix.extend(params || {}, frame.params);\r\n                }\r\n                return this._createSubView(frame, this._segment.shift(params));\r\n            }\r\n            else if (frame.view && frame.popup) {\r\n                // there is no next segment, delete the existing sub-view\r\n                frame.view.destructor();\r\n                frame.view = null;\r\n            }\r\n        }\r\n        //if new path provided, set it to the frame\r\n        if (path !== null) {\r\n            frame.url = path.url;\r\n            if (frame.params) {\r\n                path.params = this.webix.extend(path.params || {}, frame.params);\r\n            }\r\n        }\r\n        // in case of routed sub-view\r\n        if (frame.route) {\r\n            // we have a new path for sub-view\r\n            if (path !== null) {\r\n                return frame.route.show(path, frame.view).then(() => {\r\n                    return this._createSubView(frame, frame.route);\r\n                });\r\n            }\r\n            // do not trigger onChange for isolated sub-views\r\n            if (frame.branch) {\r\n                return;\r\n            }\r\n        }\r\n        let view = frame.view;\r\n        // if view doesn't exists yet, init it\r\n        if (!view && frame.url) {\r\n            if (typeof frame.url === \"string\") {\r\n                // string, so we have isolated subview url\r\n                frame.route = new Route(frame.url, 0);\r\n                if (path)\r\n                    frame.route.setParams(frame.route.route.url, path.params, 0);\r\n                if (frame.params)\r\n                    frame.route.setParams(frame.route.route.url, frame.params, 0);\r\n                return this._createSubView(frame, frame.route);\r\n            }\r\n            else {\r\n                // object, so we have an embeded subview\r\n                if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\r\n                    view = new (this.app._override(frame.url))(this.app, \"\");\r\n                }\r\n                if (!view) {\r\n                    view = frame.url;\r\n                }\r\n            }\r\n        }\r\n        // trigger onChange for already existed view\r\n        if (view) {\r\n            return view.render(frame, (frame.route || this._segment), this);\r\n        }\r\n    }\r\n    _initError(view, err) {\r\n        /*\r\n            if view is destroyed, ignore any view related errors\r\n        */\r\n        if (this.app) {\r\n            this.app.error(\"app:error:initview\", [err, view]);\r\n        }\r\n        return true;\r\n    }\r\n    _createSubView(sub, suburl) {\r\n        return this.app.createFromURL(suburl.current()).then(view => {\r\n            return view.render(sub, suburl, this);\r\n        });\r\n    }\r\n    _destroyKids() {\r\n        // destroy child views\r\n        const uis = this._children;\r\n        for (let i = uis.length - 1; i >= 0; i--) {\r\n            if (uis[i] && uis[i].destructor) {\r\n                uis[i].destructor();\r\n            }\r\n        }\r\n        // reset vars for better GC processing\r\n        this._children = [];\r\n    }\r\n}\n\n// wrapper for raw objects and Jet 1.x structs\r\nclass JetViewRaw extends JetView {\r\n    constructor(app, config) {\r\n        super(app, config);\r\n        this._ui = config.ui;\r\n    }\r\n    config() {\r\n        return this._ui;\r\n    }\r\n}\n\nclass SubRouter {\r\n    constructor(cb, config, app) {\r\n        this.path = \"\";\r\n        this.app = app;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        const a = this.app;\r\n        a.app.getRouter().set(a._segment.append(this.path), { silent: true });\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nlet _once = true;\r\nclass JetAppBase extends JetBase {\r\n    constructor(config) {\r\n        const webix = (config || {}).webix || window.webix;\r\n        config = webix.extend({\r\n            name: \"App\",\r\n            version: \"1.0\",\r\n            start: \"/home\"\r\n        }, config, true);\r\n        super(webix, config);\r\n        this.config = config;\r\n        this.app = this.config.app;\r\n        this.ready = Promise.resolve();\r\n        this._services = {};\r\n        this.webix.extend(this, this.webix.EventSystem);\r\n    }\r\n    getUrl() {\r\n        return this._subSegment.suburl();\r\n    }\r\n    getUrlString() {\r\n        return this._subSegment.toString();\r\n    }\r\n    getService(name) {\r\n        let obj = this._services[name];\r\n        if (typeof obj === \"function\") {\r\n            obj = this._services[name] = obj(this);\r\n        }\r\n        return obj;\r\n    }\r\n    setService(name, handler) {\r\n        this._services[name] = handler;\r\n    }\r\n    destructor() {\r\n        this.getSubView().destructor();\r\n        super.destructor();\r\n    }\r\n    // copy object and collect extra handlers\r\n    copyConfig(obj, target, config) {\r\n        // raw ui config\r\n        if (obj instanceof JetBase ||\r\n            (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\r\n            obj = { $subview: obj };\r\n        }\r\n        // subview placeholder\r\n        if (typeof obj.$subview != \"undefined\") {\r\n            return this.addSubView(obj, target, config);\r\n        }\r\n        // process sub-properties\r\n        const isArray = obj instanceof Array;\r\n        target = target || (isArray ? [] : {});\r\n        for (const method in obj) {\r\n            let point = obj[method];\r\n            // view class\r\n            if (typeof point === \"function\" && point.prototype instanceof JetBase) {\r\n                point = { $subview: point };\r\n            }\r\n            if (point && typeof point === \"object\" &&\r\n                !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\r\n                if (point instanceof Date) {\r\n                    target[method] = new Date(point);\r\n                }\r\n                else {\r\n                    const copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\r\n                    if (copy !== null) {\r\n                        if (isArray)\r\n                            target.push(copy);\r\n                        else\r\n                            target[method] = copy;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                target[method] = point;\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n    getRouter() {\r\n        return this.$router;\r\n    }\r\n    clickHandler(e, target) {\r\n        if (e) {\r\n            target = target || (e.target || e.srcElement);\r\n            if (target && target.getAttribute) {\r\n                const trigger = target.getAttribute(\"trigger\");\r\n                if (trigger) {\r\n                    this._forView(target, view => view.app.trigger(trigger));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n                const route = target.getAttribute(\"route\");\r\n                if (route) {\r\n                    this._forView(target, view => view.show(route));\r\n                    e.cancelBubble = true;\r\n                    return e.preventDefault();\r\n                }\r\n            }\r\n        }\r\n        const parent = target.parentNode;\r\n        if (parent) {\r\n            this.clickHandler(e, parent);\r\n        }\r\n    }\r\n    getRoot() {\r\n        return this.getSubView().getRoot();\r\n    }\r\n    refresh() {\r\n        if (!this._subSegment) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return this.getSubView().refresh().then(view => {\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return view;\r\n        });\r\n    }\r\n    loadView(url) {\r\n        const views = this.config.views;\r\n        let result = null;\r\n        if (url === \"\") {\r\n            return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\r\n        }\r\n        try {\r\n            if (views) {\r\n                if (typeof views === \"function\") {\r\n                    // custom loading strategy\r\n                    result = views(url);\r\n                }\r\n                else {\r\n                    // predefined hash\r\n                    result = views[url];\r\n                }\r\n                if (typeof result === \"string\") {\r\n                    url = result;\r\n                    result = null;\r\n                }\r\n            }\r\n            if (!result) {\r\n                if (url === \"_hidden\") {\r\n                    result = { hidden: true };\r\n                }\r\n                else if (url === \"_blank\") {\r\n                    result = {};\r\n                }\r\n                else {\r\n                    url = url.replace(/\\./g, \"/\");\r\n                    result = this.require(\"jet-views\", url);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            result = this._loadError(url, e);\r\n        }\r\n        // custom handler can return view or its promise\r\n        if (!result.then) {\r\n            result = Promise.resolve(result);\r\n        }\r\n        // set error handler\r\n        result = result\r\n            .then(module => module.__esModule ? module.default : module)\r\n            .catch(err => this._loadError(url, err));\r\n        return result;\r\n    }\r\n    _forView(target, handler) {\r\n        const view = this.webix.$$(target);\r\n        if (view) {\r\n            handler(view.$scope);\r\n        }\r\n    }\r\n    _loadViewDynamic(url) {\r\n        return null;\r\n    }\r\n    createFromURL(chunk) {\r\n        let view;\r\n        if (chunk.isNew || !chunk.view) {\r\n            view = this.loadView(chunk.page)\r\n                .then(ui => this.createView(ui, name, chunk.params));\r\n        }\r\n        else {\r\n            view = Promise.resolve(chunk.view);\r\n        }\r\n        return view;\r\n    }\r\n    _override(ui) {\r\n        const over = this.config.override;\r\n        if (over) {\r\n            let dv;\r\n            while (ui) {\r\n                dv = ui;\r\n                ui = over.get(ui);\r\n            }\r\n            return dv;\r\n        }\r\n        return ui;\r\n    }\r\n    createView(ui, name, params) {\r\n        ui = this._override(ui);\r\n        let obj;\r\n        if (typeof ui === \"function\") {\r\n            if (ui.prototype instanceof JetAppBase) {\r\n                // UI class\r\n                return new ui({ app: this, name, params, router: SubRouter });\r\n            }\r\n            else if (ui.prototype instanceof JetBase) {\r\n                // UI class\r\n                return new ui(this, { name, params });\r\n            }\r\n            else {\r\n                // UI factory functions\r\n                ui = ui(this);\r\n            }\r\n        }\r\n        if (ui instanceof JetBase) {\r\n            obj = ui;\r\n        }\r\n        else {\r\n            // UI object\r\n            obj = new JetViewRaw(this, { name, ui });\r\n        }\r\n        return obj;\r\n    }\r\n    // show view path\r\n    show(url, config) {\r\n        if (url && this.app && url.indexOf(\"//\") == 0)\r\n            return this.app.show(url.substr(1), config);\r\n        return this.render(this._container, url || this.config.start, config);\r\n    }\r\n    // event helpers\r\n    trigger(name, ...rest) {\r\n        this.apply(name, rest);\r\n    }\r\n    apply(name, data) {\r\n        this.callEvent(name, data);\r\n    }\r\n    action(name) {\r\n        return this.webix.bind(function (...rest) {\r\n            this.apply(name, rest);\r\n        }, this);\r\n    }\r\n    on(name, handler) {\r\n        this.attachEvent(name, handler);\r\n    }\r\n    use(plugin, config) {\r\n        plugin(this, null, config);\r\n    }\r\n    error(name, er) {\r\n        this.callEvent(name, er);\r\n        this.callEvent(\"app:error\", er);\r\n        /* tslint:disable */\r\n        if (this.config.debug) {\r\n            for (var i = 0; i < er.length; i++) {\r\n                console.error(er[i]);\r\n                if (er[i] instanceof Error) {\r\n                    let text = er[i].message;\r\n                    if (text.indexOf(\"Module build failed\") === 0) {\r\n                        text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\r\n                        document.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\r\n                    }\r\n                    else {\r\n                        text += \"<br><br>Check console for more details\";\r\n                        this.webix.message({ type: \"error\", text: text, expire: -1 });\r\n                    }\r\n                }\r\n            }\r\n            debugger;\r\n        }\r\n        /* tslint:enable */\r\n    }\r\n    // renders top view\r\n    render(root, url, config) {\r\n        this._container = (typeof root === \"string\") ?\r\n            this.webix.toNode(root) :\r\n            (root || document.body);\r\n        const firstInit = !this.$router;\r\n        let path = null;\r\n        if (firstInit) {\r\n            if (_once && \"tagName\" in this._container) {\r\n                this.webix.event(document.body, \"click\", e => this.clickHandler(e));\r\n                _once = false;\r\n            }\r\n            if (typeof url === \"string\") {\r\n                url = new Route(url, 0);\r\n            }\r\n            this._subSegment = this._first_start(url);\r\n            this._subSegment.route.linkRouter = true;\r\n        }\r\n        else {\r\n            if (typeof url === \"string\") {\r\n                path = url;\r\n            }\r\n            else {\r\n                if (this.app) {\r\n                    path = url.split().route.path || this.config.start;\r\n                }\r\n                else {\r\n                    path = url.toString();\r\n                }\r\n            }\r\n        }\r\n        const params = config ? config.params : this.config.params || null;\r\n        const top = this.getSubView();\r\n        const segment = this._subSegment;\r\n        const ready = segment\r\n            .show({ url: path, params }, top)\r\n            .then(() => this.createFromURL(segment.current()))\r\n            .then(view => view.render(root, segment))\r\n            .then(base => {\r\n            this.$router.set(segment.route.path, { silent: true });\r\n            this.callEvent(\"app:route\", [this.getUrl()]);\r\n            return base;\r\n        });\r\n        this.ready = this.ready.then(() => ready);\r\n        return ready;\r\n    }\r\n    getSubView() {\r\n        if (this._subSegment) {\r\n            const view = this._subSegment.current().view;\r\n            if (view)\r\n                return view;\r\n        }\r\n        return new JetView(this, {});\r\n    }\r\n    require(type, url) { return null; }\r\n    _first_start(route) {\r\n        this._segment = route;\r\n        const cb = (a) => setTimeout(() => {\r\n            this.show(a).catch(e => {\r\n                if (!(e instanceof NavigationBlocked))\r\n                    throw e;\r\n            });\r\n        }, 1);\r\n        this.$router = new (this.config.router)(cb, this.config, this);\r\n        // start animation for top-level app\r\n        if (this._container === document.body && this.config.animation !== false) {\r\n            const node = this._container;\r\n            this.webix.html.addCss(node, \"webixappstart\");\r\n            setTimeout(() => {\r\n                this.webix.html.removeCss(node, \"webixappstart\");\r\n                this.webix.html.addCss(node, \"webixapp\");\r\n            }, 10);\r\n        }\r\n        if (!route) {\r\n            // if no url defined, check router first\r\n            let urlString = this.$router.get();\r\n            if (!urlString) {\r\n                urlString = this.config.start;\r\n                this.$router.set(urlString, { silent: true });\r\n            }\r\n            route = new Route(urlString, 0);\r\n        }\r\n        else if (this.app) {\r\n            const now = route.current().view;\r\n            route.current().view = this;\r\n            if (route.next()) {\r\n                route.refresh();\r\n                route = route.split();\r\n            }\r\n            else {\r\n                route = new Route(this.config.start, 0);\r\n            }\r\n            route.current().view = now;\r\n        }\r\n        return route;\r\n    }\r\n    // error during view resolving\r\n    _loadError(url, err) {\r\n        this.error(\"app:error:resolve\", [err, url]);\r\n        return { template: \" \" };\r\n    }\r\n    addSubView(obj, target, config) {\r\n        const url = obj.$subview !== true ? obj.$subview : null;\r\n        const name = obj.name || (url ? this.webix.uid() : \"default\");\r\n        target.id = obj.id || \"s\" + this.webix.uid();\r\n        const view = config[name] = {\r\n            id: target.id,\r\n            url,\r\n            branch: obj.branch,\r\n            popup: obj.popup,\r\n            params: obj.params\r\n        };\r\n        return view.popup ? null : target;\r\n    }\r\n}\n\nclass HashRouter {\r\n    constructor(cb, config) {\r\n        this.config = config || {};\r\n        this._detectPrefix();\r\n        this.cb = cb;\r\n        window.onpopstate = () => this.cb(this.get());\r\n    }\r\n    set(path, config) {\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            for (const key in this.config.routes) {\r\n                if (this.config.routes[key] === compare[0]) {\r\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this.get() !== path) {\r\n            window.history.pushState(null, null, this.prefix + this.sufix + path);\r\n        }\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        let path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\r\n        path = (path !== \"/\" && path !== \"#\") ? path : \"\";\r\n        if (this.config.routes) {\r\n            const compare = path.split(\"?\", 2);\r\n            const key = this.config.routes[compare[0]];\r\n            if (key) {\r\n                path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\r\n            }\r\n        }\r\n        return path;\r\n    }\r\n    _detectPrefix() {\r\n        // use \"#!\" for backward compatibility\r\n        const sufix = this.config.routerPrefix;\r\n        this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\r\n        this.prefix = document.location.href.split(\"#\", 2)[0];\r\n    }\r\n    _getRaw() {\r\n        return document.location.href;\r\n    }\r\n}\n\nlet isPatched = false;\r\nfunction patch(w) {\r\n    if (isPatched || !w) {\r\n        return;\r\n    }\r\n    isPatched = true;\r\n    // custom promise for IE8\r\n    const win = window;\r\n    if (!win.Promise) {\r\n        win.Promise = w.promise;\r\n    }\r\n    const version = w.version.split(\".\");\r\n    // will be fixed in webix 5.3\r\n    if (version[0] * 10 + version[1] * 1 < 53) {\r\n        w.ui.freeze = function (handler) {\r\n            // disabled because webix jet 5.0 can't handle resize of scrollview correctly\r\n            // w.ui.$freeze = true;\r\n            const res = handler();\r\n            if (res && res.then) {\r\n                res.then(function (some) {\r\n                    w.ui.$freeze = false;\r\n                    w.ui.resize();\r\n                    return some;\r\n                });\r\n            }\r\n            else {\r\n                w.ui.$freeze = false;\r\n                w.ui.resize();\r\n            }\r\n            return res;\r\n        };\r\n    }\r\n    // adding views as classes\r\n    const baseAdd = w.ui.baselayout.prototype.addView;\r\n    const baseRemove = w.ui.baselayout.prototype.removeView;\r\n    const config = {\r\n        addView(view, index) {\r\n            // trigger logic only for widgets inside of jet-view\r\n            // ignore case when addView used with already initialized widget\r\n            if (this.$scope && this.$scope.webixJet && !view.queryView) {\r\n                const jview = this.$scope;\r\n                const subs = {};\r\n                view = jview.app.copyConfig(view, {}, subs);\r\n                baseAdd.apply(this, [view, index]);\r\n                for (const key in subs) {\r\n                    jview._renderFrame(key, subs[key], null).then(() => {\r\n                        jview._subs[key] = subs[key];\r\n                    });\r\n                }\r\n                return view.id;\r\n            }\r\n            else {\r\n                return baseAdd.apply(this, arguments);\r\n            }\r\n        },\r\n        removeView() {\r\n            baseRemove.apply(this, arguments);\r\n            if (this.$scope && this.$scope.webixJet) {\r\n                const subs = this.$scope._subs;\r\n                // check all sub-views, destroy and clean the removed one\r\n                for (const key in subs) {\r\n                    const test = subs[key];\r\n                    if (!w.$$(test.id)) {\r\n                        test.view.destructor();\r\n                        delete subs[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    w.extend(w.ui.layout.prototype, config, true);\r\n    w.extend(w.ui.baselayout.prototype, config, true);\r\n    // wrapper for using Jet Apps as views\r\n    w.protoUI({\r\n        name: \"jetapp\",\r\n        $init(cfg) {\r\n            this.$app = new this.app(cfg);\r\n            const id = w.uid().toString();\r\n            cfg.body = { id };\r\n            this.$ready.push(function () {\r\n                this.callEvent(\"onInit\", [this.$app]);\r\n                this.$app.render({ id });\r\n            });\r\n        }\r\n    }, w.ui.proxy, w.EventSystem);\r\n}\n\nclass JetApp extends JetAppBase {\r\n    constructor(config) {\r\n        config.router = config.router || HashRouter;\r\n        super(config);\r\n        patch(this.webix);\r\n    }\r\n    require(type, url) {\r\n        return require(type + \"/\" + url);\r\n    }\r\n}\n\nclass StoreRouter {\r\n    constructor(cb, config, app) {\r\n        this.storage = config.storage || app.webix.storage.session;\r\n        this.name = (config.storeName || config.id + \":route\");\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.storage.put(this.name, path);\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.storage.get(this.name);\r\n    }\r\n}\n\nclass UrlRouter extends HashRouter {\r\n    _detectPrefix() {\r\n        this.prefix = \"\";\r\n        this.sufix = this.config.routerPrefix || \"\";\r\n    }\r\n    _getRaw() {\r\n        return document.location.pathname + (document.location.search || \"\");\r\n    }\r\n}\n\nclass EmptyRouter {\r\n    constructor(cb, _$config) {\r\n        this.path = \"\";\r\n        this.cb = cb;\r\n    }\r\n    set(path, config) {\r\n        this.path = path;\r\n        if (!config || !config.silent) {\r\n            setTimeout(() => this.cb(path), 1);\r\n        }\r\n    }\r\n    get() {\r\n        return this.path;\r\n    }\r\n}\n\nfunction UnloadGuard(app, view, config) {\r\n    view.on(app, `app:guard`, function (_$url, point, promise) {\r\n        if (point === view || point.contains(view)) {\r\n            const res = config();\r\n            if (res === false) {\r\n                promise.confirm = Promise.reject(new NavigationBlocked());\r\n            }\r\n            else {\r\n                promise.confirm = promise.confirm.then(() => res);\r\n            }\r\n        }\r\n    });\r\n}\n\n//     (c) 2012-2018 Airbnb, Inc.\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nvar webixPolyglot = Polyglot;\n\nfunction Locale(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\r\n    function setLangData(name, data, silent) {\r\n        if (data.__esModule) {\r\n            data = data.default;\r\n        }\r\n        const pconfig = { phrases: data };\r\n        if (config.polyglot) {\r\n            app.webix.extend(pconfig, config.polyglot);\r\n        }\r\n        const poly = service.polyglot = new webixPolyglot(pconfig);\r\n        poly.locale(name);\r\n        service._ = app.webix.bind(poly.t, poly);\r\n        lang = name;\r\n        if (storage) {\r\n            storage.put(\"lang\", lang);\r\n        }\r\n        if (config.webix) {\r\n            const locName = config.webix[name];\r\n            if (locName) {\r\n                app.webix.i18n.setLocale(locName);\r\n            }\r\n        }\r\n        if (!silent) {\r\n            return app.refresh();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    function getLang() { return lang; }\r\n    function setLang(name, silent) {\r\n        // ignore setLang if loading by path is disabled\r\n        if (config.path === false) {\r\n            return;\r\n        }\r\n        const path = (config.path ? config.path + \"/\" : \"\") + name;\r\n        const data = app.require(\"jet-locales\", path);\r\n        setLangData(name, data, silent);\r\n    }\r\n    const service = {\r\n        getLang, setLang, setLangData, _: null, polyglot: null\r\n    };\r\n    app.setService(\"locale\", service);\r\n    setLang(lang, true);\r\n}\n\nfunction show(view, config, value) {\r\n    if (config.urls) {\r\n        value = config.urls[value] || value;\r\n    }\r\n    else if (config.param) {\r\n        value = { [config.param]: value };\r\n    }\r\n    view.show(value);\r\n}\r\nfunction Menu(app, view, config) {\r\n    const frame = view.getSubViewInfo().parent;\r\n    const ui = view.$$(config.id || config);\r\n    let silent = false;\r\n    ui.attachEvent(\"onchange\", function () {\r\n        if (!silent) {\r\n            show(frame, config, this.getValue());\r\n        }\r\n    });\r\n    ui.attachEvent(\"onafterselect\", function () {\r\n        if (!silent) {\r\n            let id = null;\r\n            if (ui.setValue) {\r\n                id = this.getValue();\r\n            }\r\n            else if (ui.getSelectedId) {\r\n                id = ui.getSelectedId();\r\n            }\r\n            show(frame, config, id);\r\n        }\r\n    });\r\n    view.on(app, `app:route`, function () {\r\n        let name = \"\";\r\n        if (config.param) {\r\n            name = view.getParam(config.param, true);\r\n        }\r\n        else {\r\n            const segment = frame.getUrl()[1];\r\n            if (segment) {\r\n                name = segment.page;\r\n            }\r\n        }\r\n        if (name) {\r\n            silent = true;\r\n            if (ui.setValue && ui.getValue() !== name) {\r\n                ui.setValue(name);\r\n            }\r\n            else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\r\n                ui.select(name);\r\n            }\r\n            silent = false;\r\n        }\r\n    });\r\n}\n\nconst baseicons = {\r\n    good: \"check\",\r\n    error: \"warning\",\r\n    saving: \"refresh fa-spin\"\r\n};\r\nconst basetext = {\r\n    good: \"Ok\",\r\n    error: \"Error\",\r\n    saving: \"Connecting...\"\r\n};\r\nfunction Status(app, view, config) {\r\n    let status = \"good\";\r\n    let count = 0;\r\n    let iserror = false;\r\n    let expireDelay = config.expire;\r\n    if (!expireDelay && expireDelay !== false) {\r\n        expireDelay = 2000;\r\n    }\r\n    const texts = config.texts || basetext;\r\n    const icons = config.icons || baseicons;\r\n    if (typeof config === \"string\") {\r\n        config = { target: config };\r\n    }\r\n    function refresh(content) {\r\n        const area = view.$$(config.target);\r\n        if (area) {\r\n            if (!content) {\r\n                content = \"<div class='status_\" +\r\n                    status +\r\n                    \"'><span class='webix_icon fa-\" +\r\n                    icons[status] + \"'></span> \" + texts[status] + \"</div>\";\r\n            }\r\n            area.setHTML(content);\r\n        }\r\n    }\r\n    function success() {\r\n        count--;\r\n        setStatus(\"good\");\r\n    }\r\n    function fail(err) {\r\n        count--;\r\n        setStatus(\"error\", err);\r\n    }\r\n    function start(promise) {\r\n        count++;\r\n        setStatus(\"saving\");\r\n        if (promise && promise.then) {\r\n            promise.then(success, fail);\r\n        }\r\n    }\r\n    function getStatus() {\r\n        return status;\r\n    }\r\n    function hideStatus() {\r\n        if (count === 0) {\r\n            refresh(\" \");\r\n        }\r\n    }\r\n    function setStatus(mode, err) {\r\n        if (count < 0) {\r\n            count = 0;\r\n        }\r\n        if (mode === \"saving\") {\r\n            status = \"saving\";\r\n            refresh();\r\n        }\r\n        else {\r\n            iserror = (mode === \"error\");\r\n            if (count === 0) {\r\n                status = iserror ? \"error\" : \"good\";\r\n                if (iserror) {\r\n                    app.error(\"app:error:server\", [err.responseText || err]);\r\n                }\r\n                else {\r\n                    if (expireDelay) {\r\n                        setTimeout(hideStatus, expireDelay);\r\n                    }\r\n                }\r\n                refresh();\r\n            }\r\n        }\r\n    }\r\n    function track(data) {\r\n        const dp = app.webix.dp(data);\r\n        if (dp) {\r\n            view.on(dp, \"onAfterDataSend\", start);\r\n            view.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\r\n            view.on(dp, \"onAfterSave\", success);\r\n        }\r\n    }\r\n    app.setService(\"status\", {\r\n        getStatus,\r\n        setStatus,\r\n        track\r\n    });\r\n    if (config.remote) {\r\n        view.on(app.webix, \"onRemoteCall\", start);\r\n    }\r\n    if (config.ajax) {\r\n        view.on(app.webix, \"onBeforeAjax\", (_mode, _url, _data, _request, _headers, _files, promise) => {\r\n            start(promise);\r\n        });\r\n    }\r\n    if (config.data) {\r\n        track(config.data);\r\n    }\r\n}\n\nfunction Theme(app, _view, config) {\r\n    config = config || {};\r\n    const storage = config.storage;\r\n    let theme = storage ?\r\n        (storage.get(\"theme\") || \"flat-default\")\r\n        :\r\n            (config.theme || \"flat-default\");\r\n    const service = {\r\n        getTheme() { return theme; },\r\n        setTheme(name, silent) {\r\n            const parts = name.split(\"-\");\r\n            const links = document.getElementsByTagName(\"link\");\r\n            for (let i = 0; i < links.length; i++) {\r\n                const lname = links[i].getAttribute(\"title\");\r\n                if (lname) {\r\n                    if (lname === name || lname === parts[0]) {\r\n                        links[i].disabled = false;\r\n                    }\r\n                    else {\r\n                        links[i].disabled = true;\r\n                    }\r\n                }\r\n            }\r\n            app.webix.skin.set(parts[0]);\r\n            // remove old css\r\n            app.webix.html.removeCss(document.body, \"theme-\" + theme);\r\n            // add new css\r\n            app.webix.html.addCss(document.body, \"theme-\" + name);\r\n            theme = name;\r\n            if (storage) {\r\n                storage.put(\"theme\", name);\r\n            }\r\n            if (!silent) {\r\n                app.refresh();\r\n            }\r\n        }\r\n    };\r\n    app.setService(\"theme\", service);\r\n    service.setTheme(theme, true);\r\n}\n\nfunction copyParams(data, url, route) {\r\n    for (let i = 0; i < route.length; i++) {\r\n        data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\r\n    }\r\n}\r\nfunction UrlParam(app, view, config) {\r\n    const route = config.route || config;\r\n    const data = {};\r\n    view.on(app, \"app:urlchange\", function (subview, segment) {\r\n        if (view === subview) {\r\n            copyParams(data, segment.suburl(), route);\r\n            segment.size(route.length + 1);\r\n        }\r\n    });\r\n    const os = view.setParam;\r\n    const og = view.getParam;\r\n    view.setParam = function (name, value, show) {\r\n        const index = route.indexOf(name);\r\n        if (index >= 0) {\r\n            data[name] = value;\r\n            this._segment.update(\"\", value, index + 1);\r\n            if (show) {\r\n                return view.show(null);\r\n            }\r\n        }\r\n        else {\r\n            return os.call(this, name, value, show);\r\n        }\r\n    };\r\n    view.getParam = function (key, mode) {\r\n        const val = data[key];\r\n        if (typeof val !== \"undefined\") {\r\n            return val;\r\n        }\r\n        return og.call(this, key, mode);\r\n    };\r\n    copyParams(data, view.getUrl(), route);\r\n}\n\nfunction User(app, _view, config) {\r\n    config = config || {};\r\n    const login = config.login || \"/login\";\r\n    const logout = config.logout || \"/logout\";\r\n    const afterLogin = config.afterLogin || app.config.start;\r\n    const afterLogout = config.afterLogout || \"/login\";\r\n    const ping = config.ping || 5 * 60 * 1000;\r\n    const model = config.model;\r\n    let user = config.user;\r\n    const service = {\r\n        getUser() {\r\n            return user;\r\n        },\r\n        getStatus(server) {\r\n            if (!server) {\r\n                return user !== null;\r\n            }\r\n            return model.status().catch(() => null).then(data => {\r\n                user = data;\r\n            });\r\n        },\r\n        login(name, pass) {\r\n            return model.login(name, pass).then(data => {\r\n                user = data;\r\n                if (!data) {\r\n                    throw new Error(\"Access denied\");\r\n                }\r\n                app.callEvent(\"app:user:login\", [user]);\r\n                app.show(afterLogin);\r\n            });\r\n        },\r\n        logout() {\r\n            user = null;\r\n            return model.logout().then(res => {\r\n                app.callEvent(\"app:user:logout\", []);\r\n                return res;\r\n            });\r\n        }\r\n    };\r\n    function canNavigate(url, obj) {\r\n        if (url === logout) {\r\n            service.logout();\r\n            obj.redirect = afterLogout;\r\n        }\r\n        else if (url !== login && !service.getStatus()) {\r\n            obj.redirect = login;\r\n        }\r\n    }\r\n    app.setService(\"user\", service);\r\n    app.attachEvent(`app:guard`, function (url, _$root, obj) {\r\n        if (config.public && config.public(url)) {\r\n            return true;\r\n        }\r\n        if (typeof user === \"undefined\") {\r\n            obj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\r\n        }\r\n        return canNavigate(url, obj);\r\n    });\r\n    if (ping) {\r\n        setInterval(() => service.getStatus(true), ping);\r\n    }\r\n}\n\n/*\r\nMIT License\r\nCopyright (c) 2019 XB Software\r\n*/\r\nlet webix = window.webix;\r\nif (webix) {\r\n    patch(webix);\r\n}\r\nconst plugins = {\r\n    UnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\r\n};\r\nconst errors = { NavigationBlocked };\r\nconst w = window;\r\nif (!w.Promise) {\r\n    w.Promise = w.webix.promise;\r\n}\n\nexport { plugins, errors, JetApp, JetView, HashRouter, StoreRouter, UrlRouter, EmptyRouter, SubRouter };\n//# sourceMappingURL=jet.js.map\n","let once = false;\n\nexport function initRLayout(){\n    if (once) return;\n    once = true;\n\n    webix.protoUI(\n        {\n            name: \"r-layout\",\n            sizeTrigger(app, handler, value) {\n                this._compactValue = value;\n                this._compactHandler = handler;\n                this._app = app;\n\n                const config = app.config;\n                this._forceCompact = typeof config.params.forceCompact !== \"undefined\";\n                this._compactWidth = config.compactWidth;\n\n                if (!this._forceCompact) this._checkTrigger(this.$view.width, value);\n            },\n            _checkTrigger(x, value) {\n                if (this._compactWidth) {\n                    if (\n                        (x <= this._compactWidth && !value) ||\n                        (x > this._compactWidth && value)\n                    ) {\n                        this._compactWidth = null;\n                        this._compactHandler(!value);\n                        return false;\n                    }\n                }\n                return true;\n            },\n            $setSize(x, y) {\n                if (this._forceCompact || this._checkTrigger(x, this._compactValue))\n                    webix.ui.layout.prototype.$setSize.call(this, x, y);\n                if (this._app) this._app.callEvent(\"view:resize\", []); //edit popup resize\n            },\n        },\n        webix.ui.layout\n    );\n}\n","export function initJetWin(app) {\n\tlet appId;\n\n\tconst service = {\n\t\tupdateConfig(config){\n\t\t\tconst appView = app.getRoot();\n\t\t\tconst appNode = appView.$view;\n\n\t\t\tif(!appId){\n\t\t\t\tif(appNode.id)\n\t\t\t\t\tappId = appNode.id;\n\t\t\t\telse \n\t\t\t\t\tappNode.id = appId = \"webix_\" + webix.uid();\n\n\t\t\t\twebix.html.addStyle(`.webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }`);\n\t\t\t\twebix.html.addStyle(`#${appId}{ position: relative; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_window{ z-index:2 !important; }`);\n\t\t\t\twebix.html.addStyle(`#${appId} .webix_disabled{ z-index:1 !important; }`);\n\t\t\t}\n\t\t\telse if(appId && !appNode.id) //app refresh\n\t\t\t\tappNode.id = appId;\n\n\t\t\tconfig.container = appId;\n\n\t\t\tif(config.fullscreen){\n\t\t\t\tconfig._fillApp = true;\n\t\t\t\tdelete config.fullscreen;\n\t\t\t}\n\n\t\t\tif(!config.on)\n\t\t\t\tconfig.on = {};\n\n\t\t\tlet firstShow = true;\n\t\t\tconst defaultHandler = config.on.onShow;\n\n\t\t\tconfig.on.onShow = function(){\n\t\t\t\tif(defaultHandler)\n\t\t\t\t\tdefaultHandler.apply(this, arguments);\n\n\t\t\t\tif(firstShow){\n\t\t\t\t\tthis.$setSize = (x, y) => {\n\t\t\t\t\t\tsetSize(this, appView, true);\n\t\t\t\t\t\twebix.ui.window.prototype.$setSize.apply(this, [x, y]);\n\t\t\t\t\t};\n\t\t\t\t\tsetHandlers(this, app);\n\t\t\t\t\tfirstShow = null;\n\t\t\t\t}\n\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\twebix.html.addCss(appNode, \"webix_win_inside\");\n\t\t\t\tappView.disable();\n\n\t\t\t\tsetSize(this, appView);\n\t\t\t}\n\n\t\t\treturn config;\n\t\t}\n\t};\n\n\tapp.setService(\"jet-win\", service);\n}\n\nfunction setSize(win, appView, silent){\n\tconst appWidth = appView.$width;\n\tconst appHeight = appView.$height;\n\n\tif(win.config._fillApp)\n\t\twin.define({\n\t\t\twidth: appWidth,\n\t\t\theight: appHeight,\n\t\t});\n\telse {\n\t\twin.define({\n\t\t\tleft: (appWidth - win.$width) / 2,\n\t\t\ttop: (appHeight - win.$height) / 2,\n\t\t});\n\t}\n\n\tif(!silent)\n\t\twin.resize();\n}\n\nfunction setHandlers(win, app){\n\tconst appView = app.getRoot();\n\n\twin.attachEvent(\"onHide\", ()=> {\n\t\tif(!appView.$destructed){\n\t\t\twebix.html.removeCss(appView.$view, \"webix_win_inside\");\n\t\t\tappView.enable();\n\t\t}\n\t});\n\n\tconst resizeEv = app.attachEvent(\"view:resize\", ()=> {\n\t\tsetSize(win, appView);\n\t});\n\n\twin.attachEvent(\"onDestruct\", ()=> {\n\t\tapp.detachEvent(resizeEv);\n\t});\n}\n","var index = 1;\nfunction uid() {\n\treturn index++;\n}\n\nvar empty = undefined;\n\nexport function ignoreInitial(code) {\n\tlet init = false;\n\treturn function() {\n\t\tif (init) return code.apply(this, arguments);\n\t\telse init = true;\n\t};\n}\n\nvar context = null;\nexport function withContext(value, code) {\n\tcontext = value;\n\tcode();\n\tcontext = null;\n}\n\nexport function filter(rule, handler) {\n\treturn function(v, o, obj, meta) {\n\t\tif (rule(v, meta)) handler.apply(this, arguments);\n\t};\n}\n\nexport function link(source, target, key) {\n\tObject.defineProperty(target, key, {\n\t\tget: () => source[key],\n\t\tset: value => (source[key] = value),\n\t});\n}\n\nexport function debounce(handler, delay) {\n\tdelay = delay || 200;\n\tlet timer = null;\n\tlet data = null;\n\treturn function() {\n\t\tdata = arguments;\n\t\tif (!timer) {\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = null;\n\n\t\t\t\thandler.apply(this, data);\n\t\t\t}, delay);\n\t\t}\n\t};\n}\n\nexport function createState(data, config) {\n\tconfig = config || {};\n\tconst handlers = {};\n\tconst out = {};\n\n\tconst observe = function(mask, handler) {\n\t\tconst key = uid();\n\t\thandlers[key] = { mask, handler };\n\t\tif (mask === \"*\") handler(out, empty, mask);\n\t\telse handler(out[mask], empty, mask);\n\n\t\treturn key;\n\t};\n\n\tconst extend = function(data, sconfig){\n\t\tsconfig = sconfig || config;\n\t\t// normal js object\n\t\tfor (const key in data) {\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tconst test = data[key];\n\t\t\t\tif (sconfig.nested && typeof test === \"object\" && test) {\n\t\t\t\t\tout[key] = createState(test, sconfig);\n\t\t\t\t} else {\n\t\t\t\t\treactive(out, test, key, notify);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst observeEnd = function(id) {\n\t\tdelete handlers[id];\n\t};\n\n\tconst queue = [];\n\tlet waitInQueue = false;\n\n\tvar batch = function(code) {\n\t\tif (typeof code !== \"function\") {\n\t\t\tconst values = code;\n\t\t\tcode = () => {\n\t\t\t\tfor (const key in values) out[key] = values[key];\n\t\t\t};\n\t\t}\n\n\t\twaitInQueue = true;\n\t\tcode(out);\n\t\twaitInQueue = false;\n\t\twhile (queue.length) {\n\t\t\tconst obj = queue.shift();\n\t\t\tnotify.apply(this, obj);\n\t\t}\n\t};\n\n\tconst notify = function(key, old, value, meta) {\n\t\tif (waitInQueue) {\n\t\t\tqueue.push([key, old, value, meta]);\n\t\t\treturn;\n\t\t}\n\n\t\tconst list = Object.keys(handlers);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst obj = handlers[list[i]];\n\t\t\tif (!obj) continue;\n\t\t\tif (obj.mask === \"*\" || obj.mask === key) {\n\t\t\t\tobj.handler(value, old, key, meta);\n\t\t\t}\n\t\t}\n\t};\n\n\tObject.defineProperty(out, \"$changes\", {\n\t\tvalue: {\n\t\t\tattachEvent: observe,\n\t\t\tdetachEvent: observeEnd,\n\t\t},\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$observe\", {\n\t\tvalue: observe,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$batch\", {\n\t\tvalue: batch,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\tObject.defineProperty(out, \"$extend\", {\n\t\tvalue: extend,\n\t\tenumerable: false,\n\t\tconfigurable: false,\n\t});\n\n\tout.$extend(data, config);\n\treturn out;\n}\n\nfunction reactive(obj, val, key, notify) {\n\tObject.defineProperty(obj, key, {\n\t\tget: function() {\n\t\t\treturn val;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvar changed = false;\n\t\t\tif (val === null || value === null) {\n\t\t\t\tchanged = val !== value;\n\t\t\t} else {\n\t\t\t\tchanged = val.valueOf() != value.valueOf();\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tvar old = val;\n\t\t\t\tval = value;\n\t\t\t\tnotify(key, old, value, context);\n\t\t\t}\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t});\n}","function updateDragPos(e, pos) {\n\tif (webix.DragControl.active) {\n\t\tconst node = webix.DragControl.getNode();\n\n\t\tpos = webix.copy(pos);\n\t\twebix.DragControl.$dragPos(pos, e);\n\n\t\tnode.style.top = pos.y + webix.DragControl.top + \"px\";\n\t\tnode.style.left = pos.x + webix.DragControl.left + \"px\";\n\t}\n}\n\nconst DragScroll = {\n\tstart(ctx, e) {\n\t\tctx._auto_scroll_delay = webix.delay(\n\t\t\tDragScroll.autoScroll,\n\t\t\tctx,\n\t\t\t[e, webix.html.pos(e)],\n\t\t\t250\n\t\t);\n\t},\n\n\treset(ctx) {\n\t\tif (ctx._auto_scroll_delay)\n\t\t\tctx._auto_scroll_delay = window.clearTimeout(ctx._auto_scroll_delay);\n\t},\n\n\tautoScroll(e, pos) {\n\t\tconst yScroll = this.direction.indexOf(\"y\") !== -1;\n\t\tconst xScroll = this.direction.indexOf(\"x\") !== -1;\n\t\tconst box = webix.html.offset(this.from.$view);\n\n\t\tlet reset = false;\n\t\tif (yScroll && DragScroll.autoYScroll.call(this, pos, box, this.senseY))\n\t\t\treset = true;\n\t\tif (xScroll && DragScroll.autoXScroll.call(this, pos, box, this.senseX))\n\t\t\treset = true;\n\n\t\tif (reset) {\n\t\t\tupdateDragPos(e, pos);\n\t\t\tthis._auto_scroll_delay = webix.delay(\n\t\t\t\tDragScroll.autoScroll,\n\t\t\t\tthis,\n\t\t\t\t[e, pos],\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t},\n\n\tautoYScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.y < box.y + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y - sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t} else if (pos.y > box.y + box.height - sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x,\n\t\t\t\tscroll.y + sense,\n\t\t\t\t\"y\"\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoXScroll(pos, box, sense) {\n\t\tconst scroll = this.from.getScrollState();\n\n\t\tif (pos.x < box.x + sense) {\n\t\t\treturn DragScroll.autoScrollTo.call(\n\t\t\t\tthis,\n\t\t\t\tscroll.x - sense,\n\t\t\t\tscroll.y,\n\t\t\t\t\"x\"\n\t\t\t);\n\t\t} else if (pos.x > box.x + box.width - sense) {\n\t\t\tconst x = this.snode\n\t\t\t\t? Math.min(scroll.x + sense, this.snode.scrollWidth - box.width)\n\t\t\t\t: scroll.x + sense;\n\t\t\treturn x == scroll.x\n\t\t\t\t? false\n\t\t\t\t: DragScroll.autoScrollTo.call(this, x, scroll.y, \"x\");\n\t\t}\n\t\treturn false;\n\t},\n\n\tautoScrollTo(x, y, mode) {\n\t\tthis.from.scrollTo(x, y);\n\t\tthis.from.callEvent(\"onAfterAutoScroll\", []);\n\n\t\tconst scroll = this.from.getScrollState();\n\t\treturn Math.abs((mode === \"x\" ? x : y) - scroll[mode]) < 1;\n\t},\n};\n\nexport default DragScroll;\n","import DragScroll from \"./dragscroll\";\n\nexport function initDnD(view) {\n\tconst ctrl = webix.copy(DragControl);\n\n\tctrl.view = view;\n\tctrl.master = this;\n\n\tctrl.Local = this.app.getService(\"local\");\n\n\twebix.DragControl.addDrag(view.$view, ctrl);\n\twebix.DragControl.addDrop(view.$view, ctrl, true);\n}\n\nexport function switchCursor(e, view) {\n\tif (webix.DragControl.active) return;\n\n\tconst id = webix.html.locate(e, \"webix_l_id\");\n\tif (id && view.getItem(id).type == \"task\") {\n\t\tconst node = view.getItemNode(id);\n\t\tconst mode = getMoveMode(node, e.clientX);\n\t\tnode.style.cursor = mode == \"move\" ? \"pointer\" : \"ew-resize\";\n\t}\n}\n\nfunction getMoveMode(node, x) {\n\tconst rect = node.getBoundingClientRect();\n\tconst p = (x - rect.left) / rect.width;\n\tconst minWidth = webix.env.touch ? 400 : 200;\n\tconst delta = 0.2 / (rect.width > minWidth ? rect.width / minWidth : 1);\n\n\tif (p < delta) return \"start\";\n\tif (p > 1 - delta) return \"end\";\n\treturn \"move\";\n}\n\nfunction updateDragScrollConfig(ds) {\n\tconst scales = this.Local.getScales();\n\tds.senseX = Math.round(scales.cellWidth * (webix.env.touch ? 1 : 0.5));\n\tds.senseY = Math.round(scales.cellHeight * (webix.env.touch ? 3 : 1));\n\treturn ds;\n}\n\nfunction isProgressDrag(t, node) {\n\twhile (t != node) {\n\t\tif (t.classList.contains(\"webix_gantt_progress_drag\")) return true;\n\t\tt = t.parentNode;\n\t}\n\treturn false;\n}\n\nconst DragControl = {\n\t$longTouchLimit: true,\n\t$dragCreate: function(t, e, pointer) {\n\t\tif (this.master.State.readonly) return false;\n\n\t\tconst ctx = this.getContext();\n\t\tctx.$touch = pointer === \"touch\";\n\n\t\tconst id = this.locateEvent(e);\n\t\tif (id) {\n\t\t\tconst item = this.view.getItem(id);\n\t\t\tif (item.$group) return false;\n\n\t\t\tconst target = e.target;\n\n\t\t\tif (target.classList.contains(\"webix_gantt_link\")) {\n\t\t\t\tctx.mode = \"links\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst node = this.view.getItemNode(id);\n\t\t\tif (!ctx.$touch && isProgressDrag(target, node)) {\n\t\t\t\tctx.mode = \"progress\";\n\t\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e, id);\n\t\t\t}\n\n\t\t\tconst scroll = this.view.getScrollState();\n\t\t\tconst evContext = this.getEventContext(e, ctx);\n\n\t\t\tlet mode = getMoveMode(node, evContext.x);\n\t\t\tif (item.type != \"task\" && (mode == \"start\" || mode == \"end\"))\n\t\t\t\tmode = \"move\";\n\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tlet step = scales.cellWidth;\n\t\t\tif (scales.precise) {\n\t\t\t\tconst nsc = this.master.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t\t}\n\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\tmode,\n\t\t\t\t\tnode,\n\t\t\t\t\tstep,\n\t\t\t\t\tdx: 0,\n\t\t\t\t\tfrom: this.view,\n\t\t\t\t\tsnode: t.querySelector(\".webix_scroll_cont\"),\n\t\t\t\t\tx: evContext.x,\n\t\t\t\t\tscroll: scroll,\n\t\t\t\t\tt: parseInt(node.style.top),\n\t\t\t\t\tl: parseInt(node.style.left),\n\t\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\tif (!this.master.app.callEvent(\"bars:beforedrag\", [item, ctx]))\n\t\t\t\treturn false;\n\n\t\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\t\twebix.extend(\n\t\t\t\t\tctx,\n\t\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t\t);\n\n\t\t\tconst html = node.cloneNode(true);\n\t\t\thtml.className += \" webix_drag_zone webix_gantt_mode_\" + mode;\n\n\t\t\tnode.style.visibility = \"hidden\";\n\t\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\n\t\t\tt.style.cursor = mode == \"move\" ? \"move\" : \"ew-resize\";\n\t\t\tt.appendChild(html);\n\t\t\treturn html;\n\t\t} else if (\n\t\t\tthis.master.app.config.split &&\n\t\t\tthis.master.State.display !== \"resources\" &&\n\t\t\te.target == t\n\t\t) {\n\t\t\tctx.mode = \"split\";\n\t\t\treturn Modes[ctx.mode].$dragCreate.call(this, t, e);\n\t\t}\n\n\t\treturn false;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (Modes[ctx.mode].dragScroll) DragScroll.reset(ctx);\n\n\t\tif (ctx.mode && Modes[ctx.mode].$dragDestroy)\n\t\t\treturn Modes[ctx.mode].$dragDestroy.call(this, t, node);\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-time\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-time\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tctx.$waitUpdate.finally(() => {\n\t\t\tctx.node.style.visibility = \"\";\n\t\t\twebix.html.remove(node);\n\n\t\t\tif (this.master.app.config.split && ctx.id)\n\t\t\t\tthis.master.Action({\n\t\t\t\t\taction: \"split-resize\",\n\t\t\t\t\tid: ctx.id,\n\t\t\t\t});\n\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].dragScroll) {\n\t\t\tDragScroll.reset(ctx);\n\t\t\tDragScroll.start(ctx, e);\n\t\t}\n\n\t\tif (Modes[ctx.mode].$dragIn)\n\t\t\treturn Modes[ctx.mode].$dragIn.call(this, s, t, e);\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\treturn Modes[ctx.mode].$dragPos.call(this, pos);\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (Modes[ctx.mode].$dragOut)\n\t\t\treturn Modes[ctx.mode].$dragOut.call(this, s, t, n, e);\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tif (!ctx.mode) return false;\n\n\t\tif (Modes[ctx.mode].$drop) return Modes[ctx.mode].$drop.call(this, s, t, e);\n\n\t\tconst { id, mode, dx, step } = ctx;\n\t\tconst time = Math.round(dx / step);\n\t\tctx.timeShift = time;\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(ctx.id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\taction: \"update-task-time\",\n\t\t\tmode,\n\t\t\ttime,\n\t\t\tid,\n\t\t});\n\t},\n\tlocateEvent: function(ev, context) {\n\t\tif (context) {\n\t\t\tev = document.elementFromPoint(context.x, context.y);\n\t\t}\n\t\treturn webix.html.locate(ev, \"webix_l_id\");\n\t},\n\tgetEventContext: function(e, ctx) {\n\t\tif (ctx.$touch) {\n\t\t\tif (e.changedTouches && !(e.touches && e.touches[0])) {\n\t\t\t\tconst t = e.changedTouches[0];\n\t\t\t\treturn { x: t.pageX, y: t.pageY };\n\t\t\t}\n\t\t\treturn e.time ? e : webix.env.touch.context(e);\n\t\t}\n\t\treturn { x: e.clientX, y: e.clientY };\n\t},\n\tgetContext: function() {\n\t\treturn webix.DragControl.getContext();\n\t},\n\tsetDragOffset: function(node, target, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst pos = webix.html.pos(e);\n\t\tconst offset = webix.html.offset(node);\n\n\t\tctx.width = offset.width;\n\t\tctx.height = offset.height;\n\t\tctx.x_offset = offset.x - pos.x;\n\t\tctx.y_offset = offset.y - pos.y;\n\t},\n};\n\nconst links = {\n\tdragScroll: {\n\t\tdirection: \"xy\",\n\t},\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst link = e.target;\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst scroll = this.view.getScrollState();\n\t\tconst offset = webix.html.offset(link);\n\t\tconst css = link.classList;\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode,\n\t\t\t\tlink,\n\t\t\t\tfromStart: css.contains(\"webix_gantt_link_left\"),\n\t\t\t\tstart: {\n\t\t\t\t\tx: offset.x + offset.width / 2 + scroll.x,\n\t\t\t\t\ty: offset.y + offset.height / 2 + scroll.y,\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tif (Modes[ctx.mode].dragScroll)\n\t\t\twebix.extend(\n\t\t\t\tctx,\n\t\t\t\tupdateDragScrollConfig.call(this, Modes[ctx.mode].dragScroll)\n\t\t\t);\n\n\t\tlink.style.opacity = 1;\n\t\twebix.html.addCss(node, \"webix_gantt_task_in_action\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tthis.master.Action({ action: \"temp-link\" });\n\n\t\tif (ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t}\n\n\t\tctx.link.style.opacity = \"\";\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_task_in_action\");\n\t\twebix.html.remove(node);\n\n\t\treturn false;\n\t},\n\t$dragIn: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!id) return false;\n\n\t\tconst node = this.view.getItemNode(id);\n\t\tif (id != ctx.target) {\n\t\t\twebix.html.addCss(node, \"webix_gantt_link_visible\", true);\n\t\t\tctx.target = id;\n\t\t}\n\t\treturn node;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tctx.end = {\n\t\t\tx: pos.x + nscroll.x,\n\t\t\ty: pos.y + nscroll.y,\n\t\t};\n\n\t\tthis.master.Action({ action: \"temp-link\", start: ctx.start, end: ctx.end });\n\t},\n\t$dragOut: function(s, t, n, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst id = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (ctx.target && id != ctx.target) {\n\t\t\tconst node = this.view.getItemNode(ctx.target);\n\t\t\twebix.html.removeCss(node, \"webix_gantt_link_visible\");\n\t\t\tctx.target = null;\n\t\t}\n\t\treturn null;\n\t},\n\t$drop: function(s, t, e) {\n\t\tconst ctx = this.getContext();\n\t\tconst source = ctx.id;\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst target = this.locateEvent(e, ctx.$touch ? evContext : null);\n\n\t\tif (!target || source == target) return false;\n\n\t\tconst node = this.view.getItemNode(target);\n\t\tconst rect = node.getBoundingClientRect();\n\t\tconst toStart = evContext.x - rect.left < rect.width / 2;\n\n\t\tconst type = (ctx.linkType = (ctx.fromStart ? 1 : 0) + (toStart ? 0 : 2));\n\t\tctx.targetId = target;\n\t\tif (\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [\n\t\t\t\tthis.view.getItem(source),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\tthis.master.Action({ action: \"add-link\", source, target, type });\n\t},\n};\n\nconst resize = {\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst node = webix.DragControl.getNode();\n\t\tconst { mode, l, t, w, x, id, scroll, step } = ctx;\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tif (mode === \"start\") {\n\t\t\tpos.x = Math.min(l + dx, l + w - step);\n\t\t\tnode.style.width = `${Math.max(w - dx, step)}px`;\n\t\t} else if (mode === \"end\") {\n\t\t\tpos.x = l;\n\t\t\tnode.style.width = `${Math.max(w + dx, step)}px`;\n\t\t}\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst move = {\n\tdragScroll: {\n\t\tdirection: \"x\",\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { node, l, t, x, id, scroll } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\t\tconst dx = (ctx.dx = pos.x - x - scroll.x + nscroll.x);\n\n\t\tpos.x = l + dx;\n\t\tpos.y = t;\n\n\t\tthis.master.Action({\n\t\t\taction: \"drag-task\",\n\t\t\tid,\n\t\t\tleft: pos.x,\n\t\t\twidth: parseInt(node.style.width),\n\t\t});\n\n\t\tif (this.master.app.config.split)\n\t\t\tthis.master.Action({\n\t\t\t\taction: \"split-resize\",\n\t\t\t\tid,\n\t\t\t});\n\t},\n};\n\nconst progress = {\n\t$dragCreate: function(t, e, id) {\n\t\tconst ctx = this.getContext();\n\t\tconst node = this.view.getItemNode(id);\n\t\tconst prevProgress = this.view.getItem(id).progress;\n\t\tconst progressNode = node.querySelector(\".webix_gantt_progress\");\n\t\tconst evContext = this.getEventContext(e, ctx);\n\t\tconst scroll = this.view.getScrollState();\n\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tnode,\n\t\t\t\tprevProgress,\n\t\t\t\tprogressNode,\n\t\t\t\tfrom: this.view,\n\t\t\t\tx: evContext.x,\n\t\t\t\tw: parseInt(node.style.width),\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tif (\n\t\t\t!this.master.app.callEvent(\"bars:beforedrag\", [\n\t\t\t\tthis.view.getItem(id),\n\t\t\t\tctx,\n\t\t\t])\n\t\t)\n\t\t\treturn false;\n\n\t\tt.style.cursor = \"ew-resize\";\n\t\twebix.html.addCss(t, \"webix_gantt_in_action\", true);\n\t\twebix.html.addCss(node, \"webix_gantt_mode_progress\", true);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst { x, scroll, w, node } = ctx;\n\t\tconst nscroll = this.view.getScrollState();\n\n\t\tconst dx = pos.x - x - scroll.x + nscroll.x;\n\t\tconst progress = Math.min(\n\t\t\tMath.max(ctx.prevProgress + Math.round((dx * 100) / w), 0),\n\t\t\t100\n\t\t);\n\n\t\tif (ctx.progress != progress) {\n\t\t\tctx.progress = progress;\n\t\t\tModes[ctx.mode].updateTaskTemplate.call(this, ctx, progress);\n\t\t}\n\n\t\tconst colors = { contrast: \"#393939\", dark: \"#20262B\" };\n\t\tnode.style.zIndex = \"3\";\n\t\tnode.style.boxShadow = `${\n\t\t\tcolors[webix.skin.$name || \"#ffffff\"]\n\t\t} -1px 0px 0px`;\n\t},\n\t$drop: function() {\n\t\tconst ctx = this.getContext();\n\t\tconst { id, progress, prevProgress } = ctx;\n\n\t\tif (\n\t\t\t!webix.isUndefined(progress) &&\n\t\t\tprogress != prevProgress &&\n\t\t\tthis.master.app.callEvent(\"bars:beforedrop\", [this.view.getItem(id), ctx])\n\t\t)\n\t\t\tctx[\"$waitUpdate\"] = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tprogress,\n\t\t\t\tid,\n\t\t\t});\n\t},\n\t$dragDestroy: function(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.$waitUpdate) {\n\t\t\tctx.$waitUpdate.catch(() => {\n\t\t\t\tthis.master.Action({ action: \"update-task-progress\", id: ctx.id });\n\t\t\t});\n\t\t} else\n\t\t\tctx.$waitUpdate = this.master.Action({\n\t\t\t\taction: \"update-task-progress\",\n\t\t\t\tid: ctx.id,\n\t\t\t});\n\n\t\tt.style.cursor = \"\";\n\t\twebix.html.removeCss(t, \"webix_gantt_in_action\");\n\t\twebix.html.removeCss(ctx.node, \"webix_gantt_mode_progress\");\n\n\t\twebix.html.remove(node);\n\t\treturn false;\n\t},\n\tupdateTaskTemplate(ctx, progress) {\n\t\tconst node = ctx.progressNode;\n\t\tnode.style.width = progress + \"%\";\n\t\tnode.innerHTML = this.master.DragProgressTemplate(progress);\n\t},\n};\n\nconst split = {\n\t$dragCreate: function(t, e) {\n\t\tconst selection = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_split_selection\",\n\t\t});\n\n\t\tconst scales = this.Local.getScales();\n\t\tconst scroll = this.view.getScrollState();\n\n\t\tconst tb = e.target.getBoundingClientRect();\n\t\tconst index = Math.floor((e.y - tb.y + scroll.y) / scales.cellHeight);\n\t\tconst offsetX = e.x - tb.x;\n\n\t\tselection.style.top = index * scales.cellHeight + 6 + \"px\";\n\t\tselection.style.left = offsetX + scroll.x + \"px\";\n\t\tselection.style.height = scales.cellHeight - 14 + \"px\";\n\t\tselection.style.width = \"0px\";\n\n\t\tlet step = scales.cellWidth;\n\t\tif (scales.precise) {\n\t\t\tconst nsc = this.master.app\n\t\t\t\t.getService(\"helpers\")\n\t\t\t\t.getSmallerCount(scales.minUnit);\n\t\t\tstep = Math.round(step / (typeof nsc === \"number\" ? nsc : nsc()));\n\t\t}\n\n\t\tconst ctx = this.getContext();\n\t\twebix.extend(\n\t\t\tctx,\n\t\t\t{\n\t\t\t\tfrom: this.view,\n\t\t\t\tnode: selection,\n\t\t\t\tstart: { offsetX, clientX: e.clientX },\n\t\t\t\tindex,\n\t\t\t\tstep,\n\t\t\t\tscroll,\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tt.appendChild(selection);\n\n\t\tconst html = webix.html.create(\"div\", { visibility: \"hidden\" });\n\t\tdocument.body.appendChild(html);\n\t\treturn html;\n\t},\n\t$dragPos(pos) {\n\t\tconst ctx = this.getContext();\n\t\tconst width = (ctx.dx = pos.x - ctx.start.clientX);\n\t\tif (pos.x < ctx.start.clientX) {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + width + \"px\";\n\t\t\tctx.node.style.width = -width + \"px\";\n\t\t} else {\n\t\t\tctx.node.style.left = ctx.start.offsetX + ctx.scroll.x + \"px\";\n\t\t\tctx.node.style.width = pos.x - ctx.start.clientX + \"px\";\n\t\t}\n\t},\n\t$drop() {\n\t\tconst ctx = this.getContext();\n\t\tconst id = this.view.getIdByIndex(ctx.index);\n\n\t\tlet start = Math.round((ctx.start.offsetX + ctx.scroll.x) / ctx.step);\n\t\tlet end = Math.round(ctx.dx / ctx.step);\n\t\tif (end < 0) {\n\t\t\tstart = start + end;\n\t\t\tend *= -1;\n\t\t}\n\n\t\tthis.master.Action({ action: \"add-task\", id, dates: { start, end } });\n\t},\n\t$dragDestroy(t, node) {\n\t\tconst ctx = this.getContext();\n\n\t\twebix.html.remove(node);\n\t\twebix.html.remove(ctx.node);\n\n\t\treturn false;\n\t},\n};\n\nconst Modes = {\n\tlinks,\n\tmove,\n\tprogress,\n\tstart: resize,\n\tend: resize,\n\tsplit,\n};\n","import { JetView } from \"webix-jet\";\nimport { initDnD, switchCursor } from \"../../helpers/dnd\";\n\nexport default class BarsView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss:\n\t\t\t\tthis.State.readonly || !this.app.config.links\n\t\t\t\t\t? \"webix_gantt_readonly\"\n\t\t\t\t\t: \"\",\n\t\t\tborderless: true,\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_links\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.BarsType(_),\n\t\t\t\t\tcss: `webix_gantt${webix.env.touch ? \"_touch\" : \"\"}_bars`,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: obj => this.GetTooltip(obj, _),\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, links, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Links = links;\n\t\tthis.Bars = bars;\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = local.getScales();\n\t\tconst linkCollection = local.links();\n\t\tconst ldata = (this.LinksData = linkCollection.data);\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\tthis.HandleScroll();\n\t\tthis.HandleDrag(scales);\n\t\tthis.HandleSelection(scales);\n\t\tthis.InitMarkers();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.State.$changes, \"display\", (v, old) => {\n\t\t\t// if the selected task type was changed, the form not closed and the display mode changed, we need to close the form and remove selection layer\n\t\t\tthis.SyncData(true);\n\t\t\tif (old) {\n\t\t\t\tthis.Local.refreshLinks();\n\t\t\t\tthis.RefreshLinks();\n\t\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t\t}\n\t\t});\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t\tthis.Bars.refresh();\n\t\t\tthis.RefreshLinks();\n\t\t});\n\n\t\tthis.on(this.VisibleTasks.data, \"onStoreUpdated\", (id, data, action) => {\n\t\t\tthis.RefreshLinks();\n\t\t\tif (action !== \"update\") this.ApplySelection();\n\t\t\tif (!action && this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\t\tthis.on(ldata, \"onStoreUpdated\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tthis.on(this.State.$changes, \"criticalPath\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o)) {\n\t\t\t\tthis.Local.showCriticalPath(!v);\n\t\t\t\tthis.RefreshLinks();\n\t\t\t}\n\t\t});\n\t\tthis.on(this.State.$changes, \"compact\", () => {\n\t\t\tthis.RefreshLinks();\n\t\t});\n\t\tif (this.Calendars)\n\t\t\tthis.on(\n\t\t\t\tthis.Local.assignments().data,\n\t\t\t\t\"onStoreUpdated\",\n\t\t\t\t(id, data, action) => {\n\t\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t\t\tif (this.app.config.excludeHolidays && action) {\n\t\t\t\t\t\tconst task = this.Local.tasks().getItem(data.task);\n\t\t\t\t\t\tif (task) this.Ops.updateAssignedTaskDates(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, o) => {\n\t\t\tif (!webix.isUndefined(o))\n\t\t\t\tthis.Local.updateScaleMinMax(this.VisibleTasks);\n\t\t});\n\t}\n\n\t/**\n\t * Sets action ot bar item click\n\t * @param {(string|number)} id  - ID of the clicked item\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Bars.getItem(id).$group)\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id,\n\t\t\t});\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {view} Object - Webix view of bars chart\n\t * @param {scales} Object - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(view, scales) {\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.drawGridInner(\n\t\t\t\tscales.cellWidth,\n\t\t\t\tscales.cellHeight,\n\t\t\t\tcolors[webix.skin.$name] || \"#ccc\"\n\t\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tconst state = this.app.getState();\n\t\tview.$view.style.backgroundPosition = `-${state.left}px -${state.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Loads data to the chart\n\t * @param {Boolean} unselect - passed on 'display' change; if the selected task is not found on chart and this param is true, State.selected will be nulled in ApplySelection\n\t */\n\tSyncData(unselect) {\n\t\tthis.Bars.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tif (this.Calendars) {\n\t\t\tthis.Local.taskCalendarMap().then(() => {\n\t\t\t\tthis.Bars.sync(this.VisibleTasks);\n\t\t\t});\n\t\t} else this.Bars.sync(this.VisibleTasks);\n\t\tthis.ApplySelection(unselect);\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst text = obj.text || (obj.$group ? _(\"Unassigned\") : _(\"(no title)\"));\n\t\treturn obj.type == \"milestone\" ? `<span>${text}</span>` : text;\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} all templates for bars\n\t */\n\tBarsType(_) {\n\t\treturn {\n\t\t\ttemplate: obj => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\tobj.type === \"split\" &&\n\t\t\t\t\tobj.$data &&\n\t\t\t\t\tobj.$data.length\n\t\t\t\t) {\n\t\t\t\t\tconst { height, width, left, top } = this.GetSplitBox(obj);\n\t\t\t\t\tlet html = `<div class=\"webix_gantt_split_container\" webix_s_id=\"${obj.id}\" style=\"top:${top}px;left:${left}px;height:${height}px;width:${width}px;\"></div>`;\n\n\t\t\t\t\t// split kids are not in the order\n\t\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\t\tconst isLast = order.length > 1 && obj.id == order[order.length - 1];\n\t\t\t\t\tobj.$data.forEach(kid => {\n\t\t\t\t\t\thtml +=\n\t\t\t\t\t\t\tthis.TemplateStart(kid, isLast, true) +\n\t\t\t\t\t\t\tthis.BarsTemplate(kid, _) +\n\t\t\t\t\t\t\tthis.TemplateEnd(kid);\n\t\t\t\t\t});\n\t\t\t\t\treturn html;\n\t\t\t\t} else return this.BarsTemplate(obj, _);\n\t\t\t},\n\t\t\ttemplateStart: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\tconst order = this.VisibleTasks.data.order;\n\t\t\t\tconst isLast = order.length > 1 && task.id == order[order.length - 1];\n\t\t\t\treturn this.TemplateStart(task, isLast);\n\t\t\t},\n\t\t\ttemplateEnd: task => {\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display === \"tasks\" &&\n\t\t\t\t\ttask.type === \"split\" &&\n\t\t\t\t\ttask.$data &&\n\t\t\t\t\ttask.$data.length\n\t\t\t\t)\n\t\t\t\t\treturn \"\";\n\t\t\t\treturn this.TemplateEnd();\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Gets the size and position parameters for a decorative div-element behind a split task\n\t * @param {Object} obj - data of a split task\n\t * @returns {Object} an object with top, left, height, and width of an element\n\t */\n\tGetSplitBox(obj) {\n\t\tconst last = obj.$data[0];\n\t\tconst first = obj.$data[obj.$data.length - 1];\n\t\tconst left =\n\t\t\tfirst.$x + (first.type == \"milestone\" ? Math.floor(first.$w / 2) : 0);\n\t\tconst rwidth = last.type == \"milestone\" ? Math.floor(last.$w / 2) : last.$w;\n\n\t\treturn {\n\t\t\ttop: last.$y,\n\t\t\tleft,\n\t\t\theight: last.$h,\n\t\t\twidth: last.$x - left + rwidth,\n\t\t};\n\t}\n\n\t/**\n\t * Returns the html for the first part of a task\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @param {Boolean} split - a flag that indicates that this task is a child of a parent with \"split\" type\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateStart(task, last, split) {\n\t\tlet w = task.$w,\n\t\t\th = task.$h,\n\t\t\tdiff = 0,\n\t\t\tprogress = \"\";\n\t\tconst css = this.BarCSS(task, last);\n\t\tconst contentCss = this.ContentCss(task);\n\t\tif (task.type == \"milestone\") {\n\t\t\tw = h = Math.ceil(Math.sqrt(Math.pow(task.$w, 2) / 2));\n\t\t\tdiff = Math.ceil((task.$w - w) / 2);\n\t\t} else {\n\t\t\tconst drag =\n\t\t\t\ttask.type == \"task\" ? this.DragProgressTemplate(task.progress) : \"\";\n\t\t\tprogress = `<div class=\"webix_gantt_progress\" style=\"width:${task.progress}%;\">${drag}</div>`;\n\t\t}\n\n\t\tlet baseline = \"\";\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\ttask.type !== \"milestone\" &&\n\t\t\ttask.planned_start &&\n\t\t\t!split\n\t\t)\n\t\t\tbaseline = this.TemplateBaseline(task);\n\n\t\treturn (\n\t\t\tbaseline +\n\t\t\t`<div webix_l_id=\"${task.id}\" class=\"${css}\" \n\t\t\tstyle=\"left:${task.$x + diff}px;top:${task.$y +\n\t\t\t\tdiff -\n\t\t\t\t(baseline ? 1 : 0)}px;width:${w}px;height:${h}px;\" \n\t\t\tdata-id=\"${task.id}\">\n\t\t\t\t<div class=\"webix_gantt_link webix_gantt_link_left\"></div>\n\t\t\t\t${progress}\n\t\t\t\t<div class=\"webix_gantt_content ${contentCss}\">`\n\t\t);\n\t}\n\n\tTemplateBaseline(t) {\n\t\treturn `<div  \n\t\t\tclass=\"webix_gantt_baseline_${t.type}\" \n\t\t\tstyle=\"left:${t.$x0}px;top:${t.$y + t.$h - 2}px;width:${t.$w0}px; \" \n\t\t\tdata-baseid=\"${t.id}\"></div>`;\n\t}\n\n\t/**\n\t * Get task classname\n\t * @param {Object} task - a task data object\n\t * @param {Boolean} last - a flag that indicates that this task is in the last line of gantt\n\t * @returns {string} a classname\n\t */\n\tBarCSS(task, last) {\n\t\tlet css = `webix_gantt_task_base webix_gantt_${\n\t\t\ttask.type === \"split\" ? \"task\" : task.type\n\t\t}`;\n\t\tif (task.$critical) css += \" webix_gantt_critical\";\n\t\tif (task.$group) css += \" webix_gantt_group\";\n\t\tif (last) css += \" webix_gantt_last\";\n\t\tif (task.css && task.type != \"milestone\") css += \" \" + task.css;\n\t\treturn css;\n\t}\n\tContentCss(task) {\n\t\treturn task.css && task.type == \"milestone\" ? \" \" + task.css : \"\";\n\t}\n\t/**\n\t * Returns the html for the last part of a task\n\t * @returns {string} HTML that defines how a task is displayed\n\t */\n\tTemplateEnd() {\n\t\treturn `</div><div class=\"webix_gantt_link webix_gantt_link_right\"></div></div>`;\n\t}\n\n\t/**\n\t * Returns a string with HTML of the progress drag marker\n\t * @param {number} progress - the progress of a task (number from 0 to 100)\n\t * @returns {string}\n\t */\n\tDragProgressTemplate(progress) {\n\t\treturn `<div class=\"webix_gantt_progress_drag\" style=\"left:${progress}%\">\n\t\t\t<span class=\"webix_gantt_progress_percent\">${progress}</span>\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Extends the class with methods for DnD and handles cursor change for bars\n\t */\n\tHandleDrag() {\n\t\tinitDnD.call(this, this.Bars);\n\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars);\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis._mousemove_handler = webix.eventRemove(this._mousemove_handler);\n\t\tthis._scroll_handler = webix.eventRemove(this._scroll_handler);\n\n\t\tconst markers = this.app.config.markers;\n\t\tif (markers)\n\t\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\t\tconst m = markers[i];\n\t\t\t\tif (m.$interval) m.$interval = clearInterval(m.$interval);\n\t\t\t}\n\t}\n\n\t/**\n\t * Finds and returns the SVG element with all links or the temp link that is rendered while the user is linking two tasks\n\t * @param {Boolean} temp - if true, the method looks for the temp link\n\t * @returns {SVGElement}\n\t */\n\tGetLinks(temp) {\n\t\treturn this.Links.$view.querySelector(\n\t\t\t`.webix_gantt_${temp ? \"temp_line\" : \"lines\"}`\n\t\t);\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\n\t\t\tthis.holidaysContainer.style.height = 0 + \"px\";\n\t\t\tthis.containerForMarkers.style.height = 0 + \"px\";\n\n\t\t\tif (this.app.config.links) {\n\t\t\t\tconst lines = this.GetLinks();\n\t\t\t\tconst temp = this.GetLinks(true);\n\t\t\t\tconst attrs = {\n\t\t\t\t\tviewBox: `${left} ${top} ${bars.scrollWidth} ${bars.scrollHeight}`,\n\t\t\t\t\twidth: bars.scrollWidth,\n\t\t\t\t\theight: bars.scrollHeight,\n\t\t\t\t};\n\n\t\t\t\tfor (let key in attrs) {\n\t\t\t\t\tlines.setAttribute(key, attrs[key]);\n\t\t\t\t\ttemp.setAttribute(key, attrs[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\n\t\t\tthis.containerForMarkers.style.height = bars.scrollHeight + \"px\";\n\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.$batch({ top, left });\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\t\tif (this.State.resourcesDiagram) this.Bars.scrollTo(v, this.State.top);\n\t\t\t});\n\n\t\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\t\tthis.holidaysContainer.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t\tthis.containerForMarkers.style.height =\n\t\t\t\t\tthis.Bars.$view.scrollHeight + \"px\";\n\t\t\t});\n\t\t}\n\t}\n\n\tSetHolidaysScroll(height, x, y) {\n\t\tthis.holidaysContainer.style.height = height + \"px\";\n\t\tthis.holidaysContainer.style.left = -x + \"px\";\n\t\tthis.holidaysContainer.style.top = -y + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height = height + \"px\";\n\t\t\tthis.resHolidaysContainer.style.left = -x + \"px\";\n\t\t\tthis.resHolidaysContainer.style.top = -y + \"px\";\n\t\t}\n\t}\n\n\t/**\n\t * Handles selection\n\t * @param {Object} scales - the current scales\n\t */\n\tHandleSelection(scales) {\n\t\tthis.selLine = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_bar_selection\",\n\t\t\tstyle: `height:${scales.cellHeight}px;width:${scales.width}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(this.selLine, this.Bars.$view.firstChild);\n\n\t\tthis.on(this.State.$changes, \"selected\", () => this.ApplySelection());\n\t}\n\n\t/**\n\t * Highlights the selected task\n\t * @param {Boolean} unselect - passed by SyncData call on 'display' change; if the selected task is not found in current collection and this param is true, State.selected will be nulled\n\t */\n\tApplySelection(unselect) {\n\t\tconst id = this.State.selected;\n\t\tlet top = -100;\n\t\tif (id && this.Bars.data.order.length) {\n\t\t\tlet ind = (top = this.Bars.getIndexById(id));\n\t\t\tconst task = this.Bars.getItem(id);\n\t\t\tif (ind < 0) {\n\t\t\t\t// split subtasks will not be found in datastore order\n\t\t\t\tif (\n\t\t\t\t\tthis.State.display == \"tasks\" &&\n\t\t\t\t\ttask &&\n\t\t\t\t\ttask.parent != 0 &&\n\t\t\t\t\tthis.Bars.getItem(task.parent).type === \"split\"\n\t\t\t\t) {\n\t\t\t\t\tind = this.Bars.getIndexById(task.parent);\n\t\t\t\t} else if (unselect && !this.Bars.exists(id)) {\n\t\t\t\t\tthis.State.selected = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttop = ind * this.Local.getScales().cellHeight;\n\n\t\t\tthis.ScrollToTask(task);\n\t\t}\n\t\tthis.selLine.style.top = top + \"px\";\n\t}\n\n\t/**\n\t * Scrolls the chart to make the task visible\n\t * @param {Object} task - the data object of a task\n\t */\n\tScrollToTask(task) {\n\t\tif (task) {\n\t\t\tconst bars = this.Bars;\n\t\t\tif (\n\t\t\t\ttask.$x > bars.$width - this.Local.getScales().cellWidth ||\n\t\t\t\ttask.$x < bars.$view.scrollLeft\n\t\t\t) {\n\t\t\t\t// to make it visible, -30px for better looks - not sticking to the tree\n\t\t\t\tthis.State.left = task.$x - 30;\n\t\t\t}\n\t\t}\n\t\tthis.Bars.scrollTo(this.State.left, this.State.top);\n\t}\n\n\t/**\n\t * Creates and renders markers (today and custom ones if they are provided)\n\t */\n\tInitMarkers() {\n\t\tthis.containerForMarkers = webix.html.create(\"DIV\", {\n\t\t\tclass: \"webix_gantt_markers\",\n\t\t\tstyle: `height:${this.Bars.$view.scrollHeight}px`,\n\t\t});\n\t\tthis.Bars.$view.insertBefore(\n\t\t\tthis.containerForMarkers,\n\t\t\tthis.Bars.$view.firstChild\n\t\t);\n\n\t\tthis.RenderMarkers(this.app.config.markers);\n\t\tthis.on(this.app, \"onScalesUpdate\", () =>\n\t\t\tthis.RenderMarkers(this.app.config.markers)\n\t\t);\n\t}\n\n\t/**\n\t * Renders markers (today and custom ones if they are provided)\n\t * @param {Array} markers - all markers\n\t */\n\tRenderMarkers(markers) {\n\t\tif (!markers) return;\n\n\t\tconst html = [];\n\t\tfor (let i = 0; i < markers.length; i++) {\n\t\t\tconst m = markers[i];\n\t\t\tif (m.now) {\n\t\t\t\tm.start_date = new Date();\n\t\t\t\tif (!m.$interval)\n\t\t\t\t\tm.$interval = setInterval(\n\t\t\t\t\t\titem => {\n\t\t\t\t\t\t\tconst node = this.containerForMarkers.querySelector(\n\t\t\t\t\t\t\t\t`[gantt_now=\"${item.$interval}\"]`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tnode.style.left = this.GetMarkerPosition(new Date()) + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\t5 * 60 * 1000,\n\t\t\t\t\t\tm\n\t\t\t\t\t);\n\t\t\t}\n\t\t\thtml.push(this.MarkerTemplate(markers[i]));\n\t\t}\n\t\tthis.containerForMarkers.innerHTML = html.join(\"\");\n\t}\n\n\t/**\n\t * Returns a string with HTML content of a marker\n\t * @param {Object} obj - marker settings\n\t * @returns {string}\n\t */\n\tMarkerTemplate(obj) {\n\t\tconst text = obj.text\n\t\t\t? `<span class=\"webix_gantt_marker_text\">${obj.text}</span>`\n\t\t\t: \"\";\n\n\t\treturn `<div\n\t\t\tgantt_now=\"${obj.$interval}\"\n\t\t\tclass=\"webix_gantt_marker ${obj.css || \"\"}\"\n\t\t\tstyle=\"left:${this.GetMarkerPosition(obj.start_date)}px\">${text}</div>`;\n\t}\n\n\t/**\n\t * Calculates new X position of a marker based on its date\n\t * @param {Date} date - the date from marker settings\n\t * @returns {number}\n\t */\n\tGetMarkerPosition(date) {\n\t\tconst { start, end, cellWidth, diff, minUnit } = this.Local.getScales();\n\t\tconst astart = this.Helpers.getUnitStart(minUnit, start);\n\n\t\treturn date < start || date > end\n\t\t\t? -100\n\t\t\t: Math.round(\n\t\t\t\t\tdiff(date, astart, webix.Date.startOnMonday, true) * cellWidth\n\t\t\t  );\n\t}\n\n\t/**\n\t * Returns a string with SVG with all links or a temp link\n\t * @param {string} lines - all lines as SVG polylines\n\t * @param {string} css - the name of CSS class for SVG (by default 'webix_gantt_lines' or 'webix_gantt_temp_line')\n\t * @returns {string}\n\t */\n\tLinksTemplate(lines, css) {\n\t\tconst bars = this.Bars.$view;\n\n\t\treturn `<svg\n\t\t\tclass=\"${css}\"\n\t\t\tviewBox=\"${this.State.left} ${this.State.top} ${bars.scrollWidth} ${bars.scrollHeight}\"\n\t\t\twidth=\"${bars.scrollWidth}\"\n\t\t\theight=\"${bars.scrollHeight}\"\n\t\t>${lines}</svg>`;\n\t}\n\n\t/**\n\t * Re-renders links\n\t */\n\tRefreshLinks() {\n\t\tconst lines = [];\n\t\t// check to skip multiple re-rendering initially\n\t\tif (this.LinksData.count() && this.VisibleTasks.count()) {\n\t\t\tconst links = this.LinksData;\n\t\t\tlinks.order.each(id => {\n\t\t\t\tconst link = links.getItem(id);\n\t\t\t\tif (link.$p) {\n\t\t\t\t\tlet critical =\n\t\t\t\t\t\tthis.State.criticalPath && this.Local.isLinkCritical(link);\n\t\t\t\t\tlines.push(\n\t\t\t\t\t\t`<polyline data-id=\"${id}\" ${\n\t\t\t\t\t\t\tcritical ? \"class='webix_gantt_line_critical'\" : \"\"\n\t\t\t\t\t\t} points=\"${link.$p}\" />`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst html =\n\t\t\tthis.LinksTemplate(lines.join(\"\"), \"webix_gantt_lines\") +\n\t\t\tthis.LinksTemplate('<polyline points=\"\" />', \"webix_gantt_temp_line\");\n\t\tthis.Links.setHTML(html);\n\t}\n\n\t/**\n\t * Refreshes links of a task\n\t * @param {string, number} tid - the ID of a task\n\t */\n\tRefreshTaskLinks(tid) {\n\t\tthis.LinksData.find(a => a.source == tid || a.target == tid).forEach(\n\t\t\tobj => {\n\t\t\t\tconst l = this.Links.$view.querySelector(`[data-id=\"${obj.id}\"]`);\n\t\t\t\tif (l) {\n\t\t\t\t\tconst s = this.VisibleTasks.getItem(obj.source);\n\t\t\t\t\tconst e = this.VisibleTasks.getItem(obj.target);\n\t\t\t\t\tthis.Helpers.updateLink(obj, s, e);\n\t\t\t\t\tl.setAttribute(\"points\", obj.$p);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\n\t\tif (this.selLine) this.selLine.style.width = width + \"px\";\n\t}\n\n\t/**\n\t * Handles actions with tasks\n\t * @param {Object} obj - settings of an action\n\t * @returns {Promise} - the result of asynchronous operations or an empty promise\n\t */\n\tAction(obj) {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\t/**\n\t\t * Some actions invoke server-side request\n\t\t * therefore we need show progress bar for them\n\t\t */\n\t\tlet inProgress = null;\n\n\t\tif (obj.action === \"update-task-time\") {\n\t\t\tif (obj.time) {\n\t\t\t\tinProgress = ops.updateTaskTime(obj.id, obj.mode, obj.time);\n\t\t\t} else {\n\t\t\t\tthis.Local.refreshTasks(obj.id);\n\t\t\t\tif (this.State.display === \"resources\") {\n\t\t\t\t\tthis.VisibleTasks.refresh(obj.id);\n\t\t\t\t}\n\t\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t\t}\n\t\t} else if (obj.action === \"update-task-progress\") {\n\t\t\tif (!webix.isUndefined(obj.progress)) {\n\t\t\t\tinProgress = ops.updateTask(obj.id, { progress: obj.progress });\n\t\t\t} else {\n\t\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\t\tthis.Bars.render(obj.id, task, \"paint\");\n\t\t\t}\n\t\t} else if (obj.action === \"drag-task\") {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\ttask.$x = parseInt(obj.left);\n\t\t\ttask.$w = parseInt(obj.width);\n\n\t\t\tthis.RefreshTaskLinks(obj.id);\n\t\t} else if (obj.action === \"add-link\") {\n\t\t\tconst { source, target, type } = obj;\n\t\t\tinProgress = ops.addLink({ source, target, type });\n\t\t} else if (obj.action === \"temp-link\") {\n\t\t\tconst { start, end } = obj;\n\t\t\tconst link = this.GetLinks(true).firstChild;\n\n\t\t\tif (!start) {\n\t\t\t\tlink.setAttribute(\"points\", \"\");\n\t\t\t} else {\n\t\t\t\tconst { left, top, p } = this.app\n\t\t\t\t\t.getService(\"helpers\")\n\t\t\t\t\t.newLink(this.Links.$view.getBoundingClientRect(), start, end);\n\t\t\t\tconst shift = [left, top];\n\t\t\t\tconst points = p\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map((a, i) => a * 1 + shift[i % 2])\n\t\t\t\t\t.join(\",\");\n\n\t\t\t\tlink.setAttribute(\"points\", points);\n\t\t\t}\n\t\t} else if (obj.action === \"add-task\") {\n\t\t\tconst scales = this.Local.getScales();\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.Helpers.getSmallerUnit(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst start = this.Helpers.addUnit(unit, scales.start, obj.dates.start);\n\t\t\tconst end = this.Helpers.addUnit(unit, start, obj.dates.end);\n\t\t\tthis.app.callEvent(\"task:add\", [obj.id, { start, end }]);\n\t\t} else if (\n\t\t\tobj.action === \"split-resize\" &&\n\t\t\tthis.State.display !== \"resources\"\n\t\t) {\n\t\t\tconst task = this.VisibleTasks.getItem(obj.id);\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this.VisibleTasks.getItem(task.parent);\n\t\t\t\tif (parent.type === \"split\") {\n\t\t\t\t\tconst splitCont = this.Bars.$view.querySelector(\n\t\t\t\t\t\t`[webix_s_id=\"${task.parent}\"]`\n\t\t\t\t\t);\n\t\t\t\t\tparent.$data.sort((a, b) => b.$x - a.$x);\n\t\t\t\t\tconst { width, left } = this.GetSplitBox(parent);\n\t\t\t\t\tsplitCont.style.width = `${width}px`;\n\t\t\t\t\tsplitCont.style.left = `${left}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Adds the layer for holiday highlighting and renders it\n\t * @param {Object} scales - current scales\n\t */\n\tHandleHolidays(scales) {\n\t\tlet html =\n\t\t\t\"<div class='webix_gantt_bar_holidays' style='height:\" +\n\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\"px'></div>\";\n\t\tif (this.Calendars)\n\t\t\thtml +=\n\t\t\t\t\"<div class='webix_gantt_bar_resource_holidays' style='height:\" +\n\t\t\t\tthis.Bars.$view.scrollHeight +\n\t\t\t\t\"px'></div>\";\n\t\tthis.Holidays.setHTML(html);\n\t\tthis.holidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_holidays\"\n\t\t);\n\t\tthis.resHolidaysContainer = this.Holidays.$view.querySelector(\n\t\t\t\".webix_gantt_bar_resource_holidays\"\n\t\t);\n\t\tthis.RenderHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderHolidays(scales));\n\t\tthis.on(this.app.getRoot(), \"onViewShow\", () => {\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tEachScaleDate(scales, func) {\n\t\tif (scales.minUnit === \"day\" || scales.minUnit === \"hour\") {\n\t\t\tlet date = webix.Date.copy(scales.start);\n\n\t\t\tlet end = webix.Date.dayStart(scales.end);\n\t\t\tif (!(scales.end - end)) {\n\t\t\t\tend = webix.Date.add(end, -1, \"day\", true);\n\t\t\t}\n\n\t\t\tlet hourOffset = scales.start.getHours();\n\n\t\t\twhile (date <= end) {\n\t\t\t\tfunc.call(this, date, hourOffset);\n\t\t\t\tdate = webix.Date.add(webix.Date.dayStart(date), 1, \"day\", true);\n\t\t\t\thourOffset = webix.Date.equal(date, end)\n\t\t\t\t\t? 24 - Math.ceil(webix.Date.timePart(scales.end) / 60 / 60)\n\t\t\t\t\t: 0;\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Renders holiday highlighting\n\t * @param {Object} scales - current scales\n\t */\n\tRenderHolidays(scales) {\n\t\tif (this.holidaysContainer) {\n\t\t\tlet html = \"\";\n\t\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\t\tif (scales.isHoliday(date)) {\n\t\t\t\t\thtml += this.HolidayTemplate(scales, date, hourOffset);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.holidaysContainer.innerHTML = html;\n\n\t\t\tif (this.Calendars) this.RenderResourceHolidays(scales);\n\t\t}\n\t}\n\tMarkResourceHolidays(scales, id, calendar) {\n\t\tlet index = this.Bars.getIndexById(id);\n\t\tif (index < 0) return \"\";\n\t\tlet html = \"\",\n\t\t\tn = 0,\n\t\t\tdateStart = null;\n\n\t\tthis.EachScaleDate(scales, (date, hourOffset) => {\n\t\t\tconst isHoliday = scales.isHoliday(date);\n\t\t\tif (this.Helpers.isResourceHoliday(date, calendar)) {\n\t\t\t\tif (!isHoliday) {\n\t\t\t\t\tif (!n) dateStart = date;\n\t\t\t\t\tn++;\n\t\t\t\t} else if (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t} else if (isHoliday) {\n\t\t\t\tif (n) {\n\t\t\t\t\thtml += this.ResourceHolidayTemplate(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdateStart,\n\t\t\t\t\t\thourOffset,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tn\n\t\t\t\t\t);\n\t\t\t\t\tn = 0;\n\t\t\t\t}\n\t\t\t\thtml += this.ResourceWorkDayTemplate(scales, date, hourOffset, index);\n\t\t\t}\n\t\t});\n\t\treturn html;\n\t}\n\tRenderResourceHolidays(scales) {\n\t\tif (this.resHolidaysContainer) {\n\t\t\tscales = scales || this.Local.getScales();\n\t\t\tthis.Local.taskCalendarMap().then(data => {\n\t\t\t\tlet html = \"\";\n\t\t\t\tif (data)\n\t\t\t\t\tfor (let taskId in data)\n\t\t\t\t\t\thtml += this.MarkResourceHolidays(scales, taskId, data[taskId]);\n\t\t\t\tthis.resHolidaysContainer.innerHTML = html;\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Returns a size and position of a date column / cell\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task / row index ( optional )\n\t * @returns {object}\n\t */\n\tGetDateBox(scales, date, hourOffset, i) {\n\t\tconst astart = this.Helpers.getUnitStart(scales.minUnit, scales.start);\n\t\tconst x = Math.round(scales.diff(date, astart) * scales.cellWidth);\n\t\tconst w =\n\t\t\t(scales.minUnit === \"hour\" ? 24 - hourOffset : 1) * scales.cellWidth;\n\t\tlet box = { x, w };\n\t\tif (i || i === 0) {\n\t\t\tbox.y = scales.cellHeight * i;\n\t\t\tbox.h = scales.cellHeight;\n\t\t}\n\t\treturn box;\n\t}\n\t/**\n\t * Returns a string with HTML of 1 holiday highlight element\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @returns {string}\n\t */\n\tHolidayTemplate(scales, date, hourOffset) {\n\t\tconst { x, w } = this.GetDateBox(scales, date, hourOffset);\n\t\tconst style = `left:${x}px;width:${w}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of holiday unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the start date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @param {number} n - a number of holiday dates to include\n\t * @returns {string}\n\t */\n\tResourceHolidayTemplate(scales, date, hourOffset, i, n) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x}px;width:${w * n}px;top:${y}px;height:${h}px;`;\n\t\treturn \"<div class='webix_gantt_holiday' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML of work day unit\n\t * @param {Object} scales - the current scales\n\t * @param {Date} date - the date of this element\n\t * @param {number} hourOffset - the hours of the scale start date\n\t * @param {number} i - a task index\n\t * @returns {string}\n\t */\n\tResourceWorkDayTemplate(scales, date, hourOffset, i) {\n\t\tconst { x, y, w, h } = this.GetDateBox(scales, date, hourOffset, i);\n\t\tconst style = `left:${x + 0.2}px;width:${w - 1.2}px;top:${y}px;height:${h -\n\t\t\t1}px;`;\n\t\treturn \"<div class='webix_gantt_work_day' style='\" + style + \"'></div>\";\n\t}\n\t/**\n\t * Returns a string with HTML content of a tooltip for tasks\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string}\n\t */\n\tGetTooltip(obj, _) {\n\t\tconst parser = webix.i18n.longDateFormatStr;\n\t\tlet tip = `${obj.text || _(\"(no title)\")}<br>\n\t\t\t<br>${_(\"Start date\")}: ${parser(obj.start_date)}`;\n\n\t\tif (obj.type != \"milestone\") {\n\t\t\ttip += `<br>${_(\"End date\")}: ${parser(obj.end_date)}\n\t\t\t<br>${_(\"Lasts\")} ${obj.duration} ${obj.duration > 1 ? _(\"days\") : _(\"day\")}`;\n\t\t}\n\t\treturn tip;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\treturn { view: \"template\", height: 20, css: \"webix_gantt_scale\" };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst scales = this.Local.getScales();\n\t\tthis.RenderScales(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => this.RenderScales(scales));\n\t}\n\n\tready() {\n\t\tconst view = this.getRoot();\n\t\tthis.on(this.State.$changes, \"left\", x => view.scrollTo(x, null));\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t * @param {Object} s - the object that stores the data of current scales\n\t */\n\tRenderScales(s) {\n\t\tconst view = this.getRoot();\n\t\tconst html = s.rows\n\t\t\t.map(line => {\n\t\t\t\tconst canMarkHolidays =\n\t\t\t\t\t(line.type === \"hour\" || line.type === \"day\") && line.step === 1;\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_gantt_scale_row\" style='height:${line.height}px;width:${s.width}px'>` +\n\t\t\t\t\tline.cells\n\t\t\t\t\t\t.map(cell => this.CellTemplate(cell, canMarkHolidays))\n\t\t\t\t\t\t.join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = s.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @param {boolean} canMarkHolidays - signals whether to add styling for holidays\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell, canMarkHolidays) {\n\t\treturn `<div class=\"webix_gantt_scale_cell ${cell.css +\n\t\t\t(canMarkHolidays && this.app.config.isHoliday(cell.date)\n\t\t\t\t? \"webix_gantt_holiday_scale\"\n\t\t\t\t: \"\")}\" style=\"width:${cell.width}px;\">${this.FormatDate(\n\t\t\tcell.date,\n\t\t\tcell.format\n\t\t)}</div>`;\n\t}\n\n\tFormatDate(date, format) {\n\t\tif (typeof format === \"string\") format = webix.Date.dateToStr(format);\n\t\treturn format(date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nimport ScaleView from \"./scale\";\nimport BarsView from \"./bars\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\treturn { rows: [ScaleView, BarsView] };\n\t}\n\tinit() {\n\t\tthis.on(this.app, \"bars:toggle\", v => {\n\t\t\tif (v) this.getRoot().show();\n\t\t\telse this.getRoot().hide();\n\t\t});\n\t}\n}\n","import BarsView from \"../chart/bars\";\n\nexport default class DiagramView extends BarsView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \" webix_gantt_readonly\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tcss: \"webix_gantt_holidays\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"tree\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttype: this.WorkloadMarkersType(),\n\t\t\t\t\tcss: `webix_gantt${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars webix_gantt_resdiagram_chart`,\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t\trelative: true,\n\t\t\t\t\tfilterMode: {\n\t\t\t\t\t\tshowSubItems: false,\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tconst [holidays, bars] = view.getChildViews();\n\t\tthis.Holidays = holidays;\n\t\tthis.Bars = bars;\n\t\tthis.LocalState = this.getParam(\"localState\");\n\t\tthis.Unit = \"hours\";\n\n\t\tconst local = (this.Local = this.app.getService(\"local\"));\n\t\tconst scales = (this.Scales = local.getScales());\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\tthis.on(this.Bars.data, \"onSyncApply\", () => {\n\t\t\tthis.Scales = this.Local.getScales();\n\t\t\tthis.RestoreTreeState();\n\t\t\tif (this.Calendars) this.RenderResourceHolidays();\n\t\t});\n\n\t\tthis.Bars.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.Calendars = this.app.config.resourceCalendars;\n\n\t\t// leave here for app.refresh() calls (inc. from Locale plugin)\n\t\tthis.DrawGrid(view, scales);\n\n\t\t// the order of DrawGrid-HandleScroll and HandleHolidays is important for the case when\n\t\t// main gantt chart is scrolled x and the diagram is empty or has something only in the\n\t\t// beginning of x-axis\n\t\tthis.HandleScroll();\n\t\tthis.HandleHolidays(scales);\n\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tthis.DrawGrid(view, scales);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:branch:toggle\", (id, v) => {\n\t\t\tthis.ToggleBranch(id, v);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:resize\", () => {\n\t\t\tthis.holidaysContainer.style.height = this.Bars.$view.scrollHeight + \"px\";\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:sort\", (by, dir, as) => {\n\t\t\tif (by) this.Bars.sort(by, dir, as);\n\t\t\telse this.Bars.sort(as, dir);\n\t\t});\n\n\t\tif (this.Calendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.RenderResourceHolidays();\n\t\t\t});\n\t}\n\n\t/**\n\t * Opens or closes a branch of the diagram\n\t * @param {number} id - the id of a branch\n\t * @param {Boolean} v - if true, the branch will be opened; false - closed\n\t */\n\tToggleBranch(id, v) {\n\t\tif (v) this.Bars.open(id);\n\t\telse this.Bars.close(id);\n\n\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\tconst opened = this.Bars.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\n\t\tthis._treeOpened = opened.map(id => this.Bars.getIndexById(id));\n\n\t\tthis.holidaysContainer.style.height = this.Bars.$view.clientHeight + \"px\";\n\t\tif (this.Calendars) {\n\t\t\tthis.resHolidaysContainer.style.height =\n\t\t\t\tthis.Bars.$view.clientHeight + \"px\";\n\t\t\tthis.RenderResourceHolidays();\n\t\t}\n\t}\n\n\t/**\n\t * Restores opened/closed branches after diagram update and regroup\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Bars.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Bars.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Bars.openAll();\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.getRoot().$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.State.left = left;\n\t\t\tthis.LocalState.top = top;\n\t\t\tthis.SetHolidaysScroll(bars.scrollHeight, left, top);\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Bars.scrollTo(this.State.left, y);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"left\", v => {\n\t\t\tthis.Bars.scrollTo(v, this.LocalState.top);\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => {\n\t\t\tthis.Unit = u;\n\t\t\tthis.Bars.render();\n\t\t});\n\t}\n\n\t/**\n\t * Returns all templates for bars\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {Object} - all templates for bars\n\t */\n\tWorkloadMarkersType() {\n\t\treturn {\n\t\t\ttemplate: task => this.MarkerTemplate(task),\n\t\t\ttemplateStart: (task, common) => this.MarkerStartTemplate(task, common),\n\t\t\ttemplateEnd: () => \"</div>\",\n\t\t};\n\t}\n\n\t/**\n\t * Defines the html of the data item of the diagram tree\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerStartTemplate(task, common) {\n\t\treturn `<div webix_tm_id=\"${task.id}\" style=\"height:${this.Scales\n\t\t\t.cellHeight - 8}px; padding: 4px;\" class=\"${common.classname(\n\t\t\ttask,\n\t\t\tcommon\n\t\t)} webix_gantt_diagram_line\" ${common.aria(task)}>`;\n\t}\n\n\t/**\n\t * Defines the looks and contents of a diagram workload marker\n\t * @param {Object} task - data object\n\t * @returns {string} with HTML\n\t */\n\tMarkerTemplate(task) {\n\t\tif (task.$level === 2) {\n\t\t\tconst markers = this.GetMarkerData(task);\n\n\t\t\tconst html = [];\n\t\t\tfor (const x in markers) {\n\t\t\t\thtml.push(this.MarkerToHTML(markers[x]));\n\t\t\t}\n\n\t\t\treturn html.join(\"\");\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tCheckResourceHoliday(date, id) {\n\t\tif (this.Calendars) {\n\t\t\tconst resId = this.Bars.getItem(id).resource_id;\n\t\t\tif (resId) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(resId).calendar_id;\n\t\t\t\tif (calendarId) {\n\t\t\t\t\tconst calendar = this.Local.calendars().getItem(calendarId);\n\t\t\t\t\treturn this.Helpers.isResourceHoliday(date, calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\t/**\n\t * Calculates work load per unit and prepares the result for display on the diagram\n\t * @param {Object} task - the data object of the data collection\n\t * @returns {Object} an object with x coordinates as keys and marker data objects and values (hours, count of tasks)\n\t */\n\tGetMarkerData(task) {\n\t\tconst markers = {};\n\t\tfor (let a = 0; a < task.duration.length; ++a) {\n\t\t\tlet d = task.duration[a];\n\t\t\tconst hourParts = task.units[a];\n\t\t\tconst delta = task.$x[a] - Math.min(...task.$x);\n\n\t\t\tconst markerWidth = this.Scales.cellHeight > 40 ? 28 : 20;\n\t\t\tconst step = this.Scales.cellWidth - markerWidth;\n\t\t\tconst halfStep = Math.round(step / 2);\n\t\t\tlet x = delta ? -2 : halfStep;\n\t\t\tlet date = webix.Date.copy(task.start_date[a]);\n\t\t\tfor (let i = 0; i < d; ++i, x += step) {\n\t\t\t\tif (\n\t\t\t\t\tthis.app.config.excludeHolidays &&\n\t\t\t\t\tthis.CheckResourceHoliday(date, task.id)\n\t\t\t\t) {\n\t\t\t\t\t++d;\n\t\t\t\t} else {\n\t\t\t\t\tlet hours = 0;\n\t\t\t\t\tif (this.Scales.minUnit !== \"hour\")\n\t\t\t\t\t\thours =\n\t\t\t\t\t\t\t(i === d - 1 ? hourParts[1] : i ? hourParts[2] : hourParts[0]) ||\n\t\t\t\t\t\t\thourParts[2];\n\t\t\t\t\telse {\n\t\t\t\t\t\thours = hourParts[2];\n\t\t\t\t\t}\n\n\t\t\t\t\tconst cell = task.$x[a] + i * this.Scales.cellWidth - 2;\n\t\t\t\t\tif (!markers[cell]) {\n\t\t\t\t\t\tmarkers[cell] = { hours, x: cell + halfStep, count: 1 };\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarkers[cell].hours += hours;\n\t\t\t\t\t\tmarkers[cell].count += 1;\n\t\t\t\t\t}\n\t\t\t\t\tmarkers[cell].overloaded = this.CheckOverload(markers[cell], task);\n\t\t\t\t}\n\t\t\t\twebix.Date.add(date, 1, this.Scales.minUnit);\n\t\t\t}\n\t\t}\n\n\t\treturn markers;\n\t}\n\n\t/**\n\t * Checks if a resource is overloaded during this unit of time\n\t * @param {Object} marker - the data of a diagram marker for one unit\n\t * @returns {boolean} true if during this unit resource is overloaded with work\n\t */\n\tCheckOverload(marker) {\n\t\tif (this.Scales.minUnit === \"hour\") {\n\t\t\t// temp until full support for hourly duration is done\n\t\t\treturn Math.round(marker.hours * 24) > this.Helpers.unitLoadNorm.day;\n\t\t}\n\t\treturn marker.hours > this.Helpers.unitLoadNorm[this.Scales.minUnit];\n\t}\n\n\t/**\n\t * Returns the html of a marker\n\t * @param {Object} marker - an object with data for a marker (hours, count of tasks)\n\t */\n\tMarkerToHTML(marker) {\n\t\tconst over = marker.overloaded ? \"webix_gantt_overload\" : \"\";\n\t\tconst number =\n\t\t\tthis.Unit === \"hours\"\n\t\t\t\t? marker.hours >= 1\n\t\t\t\t\t? marker.hours\n\t\t\t\t\t: \" \"\n\t\t\t\t: marker.count;\n\t\treturn `<div class=\"webix_gantt_diagram_marker ${over}\" style=\"left:${marker.x}px;\">${number}</div>`;\n\t}\n\n\tRenderResourceHolidays(scales) {\n\t\tscales = scales || this.Local.getScales();\n\t\tlet html = \"\";\n\t\tthis.Bars.data.each(data => {\n\t\t\tif (data.resource_id) {\n\t\t\t\tconst calendarId = this.Local.resources().getItem(data.resource_id)\n\t\t\t\t\t.calendar_id;\n\t\t\t\tif (calendarId)\n\t\t\t\t\thtml += this.MarkResourceHolidays(\n\t\t\t\t\t\tscales,\n\t\t\t\t\t\tdata.id,\n\t\t\t\t\t\tthis.Local.calendars().getItem(calendarId)\n\t\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tthis.resHolidaysContainer.innerHTML = html;\n\t}\n}\n","/**\n * Prepares a sorting function with locale-based comparison\n * @param {string} by - column ID\n * @returns {function} sorting function\n */\nexport function sort(by) {\n\treturn (a, b) =>\n\t\ta[by].localeCompare(b[by], undefined, {\n\t\t\tignorePunctuation: true,\n\t\t\tnumeric: true,\n\t\t});\n}\n\n/**\n * Check if two arrays contain same elements\n * @param {array} a - an array\n * @param {array} b - an array\n * @returns {boolean} true if two arrays contain same elements\n */\nexport function arrayEquals(a, b) {\n\treturn a && a.length == b.length && a.every(item => b.includes(item));\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst scales = this.app.getService(\"local\").getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\n\t\tconst columns = [\n\t\t\t{\n\t\t\t\tid: \"name\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: compact ? \"<span class='webix_icon gti-menu'>\" : _(\"Name\"),\n\t\t\t\ttemplate: (obj, common) => this.TreeTemplate(obj, common),\n\t\t\t\tfillspace: true,\n\t\t\t\tsort: compact ? \"\" : sort(\"name\"),\n\t\t\t\tminWidth: compact ? 44 : 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"load\",\n\t\t\t\theader: _(\"Hours\"),\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"hours\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"count\",\n\t\t\t\theader: _(\"Tasks\"),\n\t\t\t\tbatch: \"tasks\",\n\t\t\t\tsort: \"int\",\n\t\t\t\tminWidth: 50,\n\t\t\t\thidden: true,\n\t\t\t\tresize: false,\n\t\t\t},\n\t\t];\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resdiagram_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\tborderless: skin === \"contrast\",\n\t\t\twidth: compact ? 44 : this.State.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tsort: true,\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\ton: {\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t\tonAfterOpen: id => this.ToggleBranch(id, 1),\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\tfilterMode: {\n\t\t\t\tshowSubItems: false,\n\t\t\t\tlevel: 0,\n\t\t\t},\n\t\t};\n\n\t\tconst ls = (this.LocalState = this.getParam(\"localState\"));\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tls.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.RDCollection = this.app.getService(\"grouping\").getRDCollection();\n\t\tthis._unit = \"hours\";\n\t\tthis._collapsed = true;\n\n\t\tthis.on(this.LocalState.$changes, \"top\", y => {\n\t\t\tthis.Tree.scrollTo(null, y);\n\t\t});\n\n\t\tthis.on(this.Tree.data, \"onSyncApply\", () => this.RestoreTreeState());\n\n\t\tview.sync(this.RDCollection, function() {\n\t\t\tthis.filter(t => t.$group);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"rdiagram:unit:change\", u => this.ShowInUnits(u));\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\t}\n\n\t/**\n\t * Opens/closes same branches as were opened/closed before updates\n\t */\n\tRestoreTreeState() {\n\t\tif (this._treeOpened && this._treeOpened.length) {\n\t\t\tconst t = this._treeOpened;\n\t\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\t\troot.forEach(b => {\n\t\t\t\tconst ind = root.indexOf(b);\n\t\t\t\tb.open = !t.indexOf(ind);\n\t\t\t\tthis.Tree.data.callEvent(\"onStoreUpdated\", [b.id, 0, \"branch\"]);\n\t\t\t});\n\t\t} else this.Tree.openAll();\n\t}\n\n\t/**\n\t * Defines the look of a tree item\n\t * @param {Object} obj - data object of a tree item\n\t * @param {Object} common - type object of tree\n\t */\n\tTreeTemplate(obj, common) {\n\t\tconst compact = this.Compact && this._collapsed;\n\t\tif (obj.$level == 1)\n\t\t\treturn compact\n\t\t\t\t? common.icon(obj)\n\t\t\t\t: common.treetable(obj, common) + obj.category;\n\n\t\tif (compact) return this.Helpers.resourceAvatar(obj);\n\t\treturn common.space(obj) + this.Helpers.resourceAvatar(obj) + obj.name;\n\t}\n\n\t/**\n\t * Shows total workload in tasks or hours\n\t * @param {string} u - \"tasks\" or \"hours\"\n\t */\n\tShowInUnits(u) {\n\t\tthis._unit = u;\n\t\tconst tree = this.Tree;\n\t\tconst cols = tree.config.columns;\n\t\tconst lastFillspace = cols[cols.length - 1].fillspace;\n\t\tif (!this.Compact || !this._collapsed) tree.showColumnBatch(u);\n\t\t// columns normalizing\n\t\tthis.SetColumns(0, lastFillspace);\n\t}\n\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tthis.SetColumns(this.Tree.getColumnIndex(id), true);\n\t}\n\n\tSetColumns(index, fillspace) {\n\t\tconst columns = this.Tree.config.columns;\n\t\tconst last = columns.length - 1;\n\t\tif (index === 0) {\n\t\t\tcolumns[last].fillspace = fillspace;\n\t\t\tcolumns[last].width = 0;\n\t\t\tcolumns[last].resize = false;\n\t\t} else if (index === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\tthis.Tree.refreshColumns();\n\t}\n\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\t// [todo] toggle tree in compact code\n\t\tconst tree = this.Tree;\n\t\tconst lv = tree.isColumnVisible(\"load\");\n\t\tconst cv = tree.isColumnVisible(\"count\");\n\t\tconst vis = (this._collapsed = lv || cv);\n\n\t\tif (vis) {\n\t\t\tif (lv) tree.hideColumn(\"load\");\n\t\t\tif (cv) tree.hideColumn(\"count\");\n\t\t} else {\n\t\t\tif (this._unit === \"hours\") tree.showColumn(\"load\");\n\t\t\telse tree.showColumn(\"count\");\n\t\t}\n\n\t\ttree.config.width = vis ? 44 : 0;\n\t\tconst nameCol = tree.config.columns[0];\n\t\tnameCol.minWidth = vis ? 44 : 150;\n\t\ttree.resize();\n\t\ttree.refreshColumns();\n\n\t\tthis.app.callEvent(\"rdiagram:tree:toggle\", [vis]);\n\t}\n\n\t/**\n\t * Hides/Shows the lines of the diagram for the closed/opened tree branch\n\t * @param {number} id - the ID of a branch\n\t * @param {Number} v - the state of a branch (1 - opened, 0 - closed)\n\t */\n\tToggleBranch(id, v) {\n\t\tconst root = this.Tree.data.getBranch(\"0\");\n\t\tconst opened = this.Tree.getState().open.filter(i => {\n\t\t\treturn root.find(o => o.id == i);\n\t\t});\n\t\tthis._treeOpened = opened.map(id => this.Tree.getIndexById(id));\n\n\t\tthis.app.callEvent(\"rdiagram:branch:toggle\", [id, v]);\n\t}\n\n\tSortTasks(by, dir, as) {\n\t\tthis.app.callEvent(\"rdiagram:sort\", [by, dir, as]);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ScalesView from \"../chart/scale\";\nimport DiagramView from \"./diagram\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class RDiagramView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst contrast = webix.skin.$name === \"contrast\";\n\t\tconst unit = this.app.getService(\"local\").getScales().minUnit;\n\t\treturn {\n\t\t\ttype: contrast ? \"clean\" : \"line\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tborderless: contrast,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\twidth: 330,\n\t\t\t\t\t\t\tvalue: \"hours\",\n\t\t\t\t\t\t\tlocalId: \"radio\",\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: \"hours\", value: `${_(\"Hours per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t\t{ id: \"tasks\", value: `${_(\"Tasks per\")} ${_(unit)}` },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:unit:change\", [v]);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\tTreeView,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: compact ? \"spacer\" : \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\twidth: compact ? 1 : 4,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"diagram\",\n\t\t\t\t\t\t\trows: [ScalesView, DiagramView],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst localState = createState({\n\t\t\ttop: 0,\n\t\t});\n\t\tthis.setParam(\"localState\", localState);\n\n\t\tthis.on(this.app, \"rdiagram:tree:toggle\", v => {\n\t\t\tif (v) this.$$(\"diagram\").show();\n\t\t\telse this.$$(\"diagram\").hide();\n\t\t});\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst radio = this.$$(\"radio\");\n\t\tthis.on(this.app, \"onScalesUpdate\", (scales, old) => {\n\t\t\tif (scales.minUnit !== old.minUnit) {\n\t\t\t\tradio.config.options.map(o => {\n\t\t\t\t\tconst words = o.value.split(\" \");\n\t\t\t\t\twords[words.length - 1] = _(scales.minUnit);\n\t\t\t\t\to.value = words.join(\" \");\n\t\t\t\t});\n\t\t\t\tradio.refresh();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaselineView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\tpadding: {\n\t\t\t\tleft: 3,\n\t\t\t\tright: 3,\n\t\t\t},\n\t\t\tvisibleBatch: \"added\",\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_start\",\n\t\t\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: \"planned_end\",\n\t\t\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\t\tname: \"planned_duration\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\tmax: 1000,\n\t\t\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"none\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Add dates\"),\n\t\t\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbatch: \"added\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-trash\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tlabel: _(\"Remove dates\"),\n\t\t\t\t\t\t\tclick: () => this.RemoveBtnClickHandler(),\n\t\t\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\") this.UpdateTask();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// changing links via bars and dnd\n\t\tthis.Tasks = this.app.getService(\"local\").tasks();\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) this.FillData(id);\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst task = this.Tasks.getItem(id);\n\t\tif (task.planned_start) this.$$(\"form\").showBatch(\"added\");\n\t\telse this.$$(\"form\").showBatch(\"none\");\n\t\tthis.Form.setValues(this.Tasks.getItem(id));\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (\n\t\t\tf == \"planned_duration\" ||\n\t\t\t(f == \"planned_start\" && vals.type == \"project\")\n\t\t)\n\t\t\tvals.planned_end = null;\n\t\telse if (f == \"planned_end\" || f == \"planned_start\")\n\t\t\tvals.planned_duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\t\tif (updateDates) {\n\t\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\t\tif (mode == \"duration\") mode = null;\n\n\t\t\tthis.Ops.updatePlannedTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) this.PrepareDates(vals);\n\n\t\tlet mode = this._eventSource ? this._eventSource.split(\"_\")[1] : null;\n\t\tif (mode == \"duration\") mode = null;\n\t\tthis.Ops.updateTask(id, vals, mode, false, true);\n\t}\n\tAddBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tconst obj = {\n\t\t\tplanned_start: vals.start_date,\n\t\t\tplanned_end: vals.end_date,\n\t\t\tplanned_duration: vals.duration,\n\t\t};\n\t\tthis.Ops.updateTask(id, obj, null, false, true);\n\t}\n\tRemoveBtnClickHandler() {\n\t\tconst id = this.State.selected;\n\t\twebix\n\t\t\t.confirm(this._(\"Planned dates will be removed, are you sure?\"))\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.updateTask(\n\t\t\t\t\tid,\n\t\t\t\t\t{ planned_start: null, planned_end: null, planned_duration: null },\n\t\t\t\t\tnull,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"links\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_link_table_hover\",\n\t\t\tscheme: {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"ttype\",\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"task\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\theader: _(\"Task\"),\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\tif (obj.$group)\n\t\t\t\t\t\t\treturn `<span class=\"webix_strong\">${_(\n\t\t\t\t\t\t\t\tobj.ttype == \"source\" ? _(\"Successors\") : _(\"Predecessors\")\n\t\t\t\t\t\t\t)}</span>`;\n\t\t\t\t\t\telse return obj.text || _(\"(no title)\");\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"type\",\n\t\t\t\t\tcss: \"webix_gantt_type\",\n\t\t\t\t\theader: _(\"Link\"),\n\t\t\t\t\twidth: 140,\n\t\t\t\t\ttemplate: function(obj, c, v, conf) {\n\t\t\t\t\t\tif (obj.$group) return \"\";\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst type = conf.collection.getItem(v).value;\n\t\t\t\t\t\t\treturn `${type}<span class=\"webix_icon wxi-menu-down\"></span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"0\", value: _(\"End to start\") },\n\t\t\t\t\t\t{ id: \"1\", value: _(\"Start to start\") },\n\t\t\t\t\t\t{ id: \"2\", value: _(\"End to end\") },\n\t\t\t\t\t\t{ id: \"3\", value: _(\"Start to end\") },\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\treturn obj.$group\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: \"<span class='webix_icon wxi-trash'></span>\";\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonBeforeEditStart: function(id) {\n\t\t\t\t\treturn !this.getItem(id).$group;\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (v, editor) => {\n\t\t\t\t\tif (v.value != v.old) {\n\t\t\t\t\t\tthis.UpdateLink(editor.row, { type: v.value * 1 });\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"wxi-trash\": (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete link\"),\n\t\t\t\t\t\t\ttext: _(\"The link will be deleted permanently, are you sure?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.DeleteLink(id));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Links = this.$$(\"links\");\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.app.getService(\"local\").links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillData(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tFillData(id) {\n\t\tconst local = this.app.getService(\"local\");\n\t\tconst related = local\n\t\t\t.getLinks(id, \"target\")\n\t\t\t.concat(local.getLinks(id, \"source\"));\n\n\t\tthis.Links.clearAll();\n\t\tif (related.length) {\n\t\t\tthis.Links.parse(related);\n\t\t\tthis.getRoot().show();\n\t\t} else {\n\t\t\tthis.getRoot().hide();\n\t\t}\n\t}\n\n\tUpdateLink(id, obj) {\n\t\tthis.Ops.updateLink(id, obj).then(() => {\n\t\t\tthis.Links.blockEvent();\n\t\t\tthis.Links.editCancel();\n\t\t\tthis.Links.unblockEvent();\n\n\t\t\t// must not give 0 ID to dropdown list of column editor\n\t\t\tobj.type += \"\";\n\t\t\tthis.Links.updateItem(id, obj);\n\t\t});\n\t}\n\n\tDeleteLink(id) {\n\t\tthis.Ops.removeLink(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n}\n","webix.editors.gantt_numeditor = webix.extend(\n\t{\n\t\trender: function() {\n\t\t\tconst node = webix.editors.text.render.call(this);\n\t\t\tconst inp = node.querySelector(\"input\");\n\t\t\tinp.type = \"number\";\n\t\t\tinp.min = 0;\n\t\t\treturn node;\n\t\t},\n\t},\n\twebix.editors.text\n);\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/numeditor\";\n\nexport default class ResourcesView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst conf = this.app.config;\n\t\tconst single = (this.IsSingle =\n\t\t\tconf.resources == \"single\" || conf.resourceCalendars);\n\n\t\tconst button = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tlocalId: \"addBtn\",\n\t\t\t\t\tlabel: _(\"Add assignment\"),\n\t\t\t\t\tclick: () => this.AddBtnClickHandler(),\n\t\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_resource_table webix_gantt_tree webix_gantt_form_tree\",\n\t\t\theader: false,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"resources\",\n\t\t\tautoheight: true,\n\t\t\teditable: true,\n\t\t\teditaction: \"custom\",\n\t\t\tscroll: false,\n\t\t\thover: \"webix_gantt_table_hover\",\n\t\t\trowHeight: Math.max(webix.skin.$active.rowHeight, 32),\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tid: \"resource\",\n\t\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: obj => this.ResourceTemplate(obj),\n\t\t\t\t\teditor: \"richselect\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tpoint: 0,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: r =>\n\t\t\t\t\t\t\t\tsingle ? this.OptionTemplate(r) : this.EditorOptionTemplate(r),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\t{\n\t\t\t\t\tid: \"value\",\n\t\t\t\t\twidth: 85,\n\t\t\t\t\tcss: \"webix_gantt_value\",\n\t\t\t\t\ttemplate: obj => this.ValueTemplate(obj),\n\t\t\t\t\teditFormat: function(v) {\n\t\t\t\t\t\treturn parseFloat(v);\n\t\t\t\t\t},\n\t\t\t\t\teditParse: function(v) {\n\t\t\t\t\t\tv = parseFloat(v);\n\t\t\t\t\t\treturn isNaN(v) ? 0 : v;\n\t\t\t\t\t},\n\t\t\t\t\teditor: \"gantt_numeditor\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"remove\",\n\t\t\t\t\twidth: 30,\n\t\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t\t\ttemplate: obj => this.DeleteIconTemplate(obj),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => {\n\t\t\t\t\tif (!this.Table.getItem(id).$group && id.column != \"remove\") {\n\t\t\t\t\t\tthis.Table.editRow(id);\n\t\t\t\t\t\tif (id.column == \"value\")\n\t\t\t\t\t\t\tthis.Table.getEditor(id.row, \"resource\")\n\t\t\t\t\t\t\t\t.getPopup()\n\t\t\t\t\t\t\t\t.hide();\n\t\t\t\t\t\tthis.Table.getEditor(id.row, id.column).focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStart: id => {\n\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\tif (item.$group) return false;\n\t\t\t\t\tif (id.column == \"resource\") {\n\t\t\t\t\t\tthis.Table.addCellCss(\n\t\t\t\t\t\t\tid.row,\n\t\t\t\t\t\t\tid.column,\n\t\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst r = id && !single ? item.resource : null;\n\t\t\t\t\t\tthis.FilterOptions(r);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterEditStart: id => {\n\t\t\t\t\tif (id.column == \"value\") {\n\t\t\t\t\t\tconst item = this.Table.getItem(id.row);\n\t\t\t\t\t\tconst node = this.Table.getEditor(id.row, \"value\").getInputNode();\n\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\tif (range) this.ApplyEditorLimits(node, range);\n\t\t\t\t\t\tconst step = this.GetValueStep(item);\n\t\t\t\t\t\tif (step) this.ApplyEditorStep(node, step);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonBeforeEditStop: (state, editor) => {\n\t\t\t\t\tthis.Table.removeCellCss(\n\t\t\t\t\t\teditor.row,\n\t\t\t\t\t\t\"resource\",\n\t\t\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t\t\t);\n\t\t\t\t\tif (state.value != state.old) {\n\t\t\t\t\t\tlet obj = {};\n\t\t\t\t\t\tobj[editor.column] = state.value;\n\t\t\t\t\t\tif (editor.column == \"value\") {\n\t\t\t\t\t\t\tconst item = this.Table.getItem(editor.row);\n\t\t\t\t\t\t\tconst range = this.GetRange(item);\n\t\t\t\t\t\t\tif (range) this.ApplyValueRange(obj, range);\n\t\t\t\t\t\t\telse if (obj.value < 0) obj.value = 0;\n\t\t\t\t\t\t\teditor.getInputNode().value = obj.value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.UpdateAssignment(editor.row, obj);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tonAfterLoad: function() {\n\t\t\t\t\tthis.openAll();\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_gantt_remove_icon: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\t\ttitle: _(\"Delete assignment\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete this assignment?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveAssignment(id.row));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tif (!single)\n\t\t\ttable.scheme = {\n\t\t\t\t$group: {\n\t\t\t\t\tby: \"category\",\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: webix.skin.$active.layoutMargin.form, bottom: 5 },\n\t\t\trows: [table, button],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Table = this.$$(\"resources\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Resources = this.Local.resources();\n\t\tif (!this.app.config.resources) return false;\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillData(id);\n\t\t});\n\t}\n\n\t/**\n\t * Display assignments table\n\t * @param {string} id - a task id\n\t */\n\tFillData(id) {\n\t\tconst item = this.Local.tasks().getItem(id);\n\t\tif (item.type != \"task\") return false;\n\n\t\tconst loader = this.Local.getAssignments(id);\n\t\tloader.then(assignees => {\n\t\t\tif (!this.getRoot()) return false;\n\t\t\tthis.Table.clearAll();\n\t\t\tthis.Table.getColumnConfig(\"resource\").collection = this.Resources;\n\n\t\t\tif (assignees.length) {\n\t\t\t\tthis.Table.show();\n\t\t\t\tthis.Table.parse(this.GetData(assignees));\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\t\t} else {\n\t\t\t\tif (this.IsSingle) this.$$(\"addBtn\").enable();\n\t\t\t\tthis.Table.hide();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Get treetable data\n\t * @param {array} assignments - an array of assignments data\n\t * @returns {array} data array\n\t */\n\n\tGetData(assignments) {\n\t\tassignments.sort(this.app.getService(\"operations\").sortResources);\n\t\treturn assignments;\n\t}\n\n\t/**\n\t * Filters an option collection\n\t * @param {string} id - the selected resource id\n\t */\n\tFilterOptions(id) {\n\t\tlet tableIds = [];\n\t\tconst category = id ? this.Resources.getItem(id)[\"category_id\"] : null;\n\t\tthis.Table.data.each(item => {\n\t\t\ttableIds.push(item.resource);\n\t\t});\n\n\t\tthis.Resources.filter(item => {\n\t\t\treturn (\n\t\t\t\t(!category || item[\"category_id\"] == category) &&\n\t\t\t\t(tableIds.indexOf(item.id) < 0 || (id && item.id == id))\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Updates an assignment\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - a hash of new assignment properties\n\t */\n\tUpdateAssignment(id, obj) {\n\t\t// remove \"focus\" style for a richselect cell editor when\n\t\t// the editor is closed without event calls\n\t\tconst node = this.Table.$view.querySelector(\".webix_gantt_select_editor\");\n\t\tif (node) {\n\t\t\tconst rInd = node.getAttribute(\"aria-rowindex\") * 1;\n\t\t\tthis.Table.removeCellCss(\n\t\t\t\tthis.Table.data.getIdByIndex(rInd - 1),\n\t\t\t\t\"resource\",\n\t\t\t\t\"webix_gantt_select_editor\"\n\t\t\t);\n\t\t}\n\n\t\tthis.Ops.updateAssignment(id, obj).then(() => {\n\t\t\tthis.CloseEditor(id, obj);\n\t\t});\n\t}\n\n\t/**\n\t * Get range for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {array} an array with two numeric values [min,max]\n\t */\n\tGetRange(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueRange(resourceItem);\n\t}\n\n\t/**\n\t * Apply limits to \"value\" property of a data object\n\t * @param {object} obj - an object with a value property to change\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyValueRange(obj, range) {\n\t\tif (obj.value < range[0]) obj.value = range[0];\n\t\telse if (obj.value > range[1]) obj.value = range[1];\n\t}\n\t/**\n\t * Apply limits to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {array} range - a value range [min,max]\n\t */\n\tApplyEditorLimits(node, range) {\n\t\tnode.min = range[0];\n\t\tnode.max = range[1];\n\t}\n\t/**\n\t * Get set for unit values\n\t * @param {object} item - an assignment item object\n\t * @returns {number} a step value\n\t */\n\tGetValueStep(item) {\n\t\tconst resourceItem = this.Resources.getItem(item.resource);\n\t\treturn this.Helpers.getResourceValueStep(resourceItem);\n\t}\n\n\t/**\n\t * Apply changing step to editor value\n\t * @param {HTMLInputElement} node - an editor input\n\t * @param {number} step - changing step\n\t */\n\tApplyEditorStep(node, step) {\n\t\tnode.step = step;\n\t}\n\n\t/**\n\t * Closes editor and updated table row\n\t * @param {string} id - an assignment id\n\t * @param {object} obj - assignment properties\n\t */\n\tCloseEditor(id, obj) {\n\t\tthis.Table.blockEvent();\n\t\tthis.Table.editCancel();\n\t\tthis.Table.unblockEvent();\n\n\t\tthis.Table.updateItem(id, obj);\n\t}\n\n\t/**\n\t * Removes assignment\n\t * @param {string} id - assignment id\n\t */\n\tRemoveAssignment(id) {\n\t\tthis.Ops.removeAssignment(id).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\n\t/**\n\t *  \"Add\" button click handler\n\t */\n\tAddBtnClickHandler() {\n\t\tthis.FilterOptions();\n\t\twebix.delay(() => {\n\t\t\tthis.ShowPopup();\n\t\t});\n\t}\n\n\t/**\n\t * Adds an assignment and a new row to \"assignees\" table\n\t * @param {object} obj - assignment properties\n\t */\n\tAddAssignment(obj) {\n\t\tif (this.IsSingle) this.$$(\"addBtn\").disable();\n\t\tthis.Ops.addAssignment({\n\t\t\tresource: obj.id,\n\t\t\tvalue: this.Helpers.getDefaultResourceValue(obj),\n\t\t\ttask: this.State.selected,\n\t\t}).then(() => {\n\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\t}\n\t/**\n\t * A template for a resource column\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of a column cell\n\t */\n\tResourceTemplate(obj) {\n\t\tif (obj.$group) return `<span class=\"webix_strong\">${obj.category}</span>`;\n\t\telse if (obj.resource) {\n\t\t\tconst item = this.Resources.getItem(obj.resource);\n\t\t\treturn this.EditorTemplate(item);\n\t\t}\n\t\treturn \"\";\n\t}\n\t/**\n\t * The template for value column\n\t * @param {object} obj - an assignment data object\n\t * @returns {string} html string\n\t */\n\tValueTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\tconst v = obj.value;\n\t\treturn (\n\t\t\t(isNaN(v) ? this.Helpers.getDefaultResourceValue(obj) : v) +\n\t\t\tthis.GetUnitName(obj)\n\t\t);\n\t}\n\n\t/**\n\t * Get a unit name for a resource\n\t * @param {object} obj - resource object\n\t * @returns {string} a unit name\n\t */\n\tGetUnitName(obj) {\n\t\treturn this._(this.Helpers.getResourceUnit(obj));\n\t}\n\n\t/**\n\t * The template for \"delete\" column\n\t * @param {object} obj - assignment data object\n\t * @returns {string} html string\n\t */\n\tDeleteIconTemplate(obj) {\n\t\tif (obj.$group) return \"\";\n\t\treturn \"<span class='webix_icon wxi-trash webix_gantt_remove_icon'></span>\";\n\t}\n\n\t/**\n\t * Get popup configuration\n\t * @returns {object} popup config\n\t */\n\tGetPopupConfig() {\n\t\treturn {\n\t\t\tview: \"suggest\",\n\t\t\tlocalId: \"popup\",\n\t\t\twidth: 320,\n\t\t\tpadding: 0,\n\t\t\tpoint: 0,\n\t\t\tfitMaster: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_gantt_select_editor_popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tminHeight: 28,\n\t\t\t\ttype: {\n\t\t\t\t\theight: Math.max(webix.skin.$active.listItemHeight, 32),\n\t\t\t\t},\n\t\t\t\tdata: this.Resources,\n\t\t\t\ttemplate: obj => this.OptionTemplate(obj),\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.AddAssignment(this.Resources.getItem(id));\n\t\t\t\t\t\tthis.Popup.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Show resources popup\n\t */\n\tShowPopup() {\n\t\tif (!this.Popup || !this.Popup.$view) {\n\t\t\tthis.Popup = this.ui(this.GetPopupConfig());\n\t\t\tthis.SetPopupPlaceholder();\n\t\t}\n\n\t\tthis.Popup.show(this.$$(\"addBtn\").$view, { x: 1 });\n\t}\n\n\t/**\n\t * Set a placeholder for the \"Add\" popup placeholder\n\t * @param {string} placeholder - a popup placeholder (optional)\n\t */\n\tSetPopupPlaceholder(placeholder) {\n\t\tconst list = this.Popup.getBody();\n\t\tlist.$view.firstChild.setAttribute(\n\t\t\t\"placeholder\",\n\t\t\tplaceholder || this._(\"No resources to add\")\n\t\t);\n\t}\n\n\t/**\n\t * A template for \"Add assignment\" popup options\n\t * @param {object} obj - a data item\n\t * @returns {string} an html string of an editor option\n\t */\n\tOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst avatarStr = `<div class=\"webix_gantt_avatar_box_inline\">${avatar +\n\t\t\tname}</div>`;\n\t\tconst dpt = `<span class='webix_gantt_resource_section'>${obj.category}</span>`;\n\t\treturn (\n\t\t\t\"<div class='webix_gantt_avatar_option_box'>\" + avatarStr + dpt + \"</div>\"\n\t\t);\n\t}\n\n\t/**\n\t * Cell template\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for resource editable cell\n\t */\n\tEditorTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\tconst icon = \"<span class='webix_icon wxi-menu-down'></span>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}${icon}</div>`;\n\t}\n\n\t/**\n\t * Popup option template for resource editor\n\t * @param {object} obj - resource object\n\t * @returns {string} html string for an option\n\t */\n\tEditorOptionTemplate(obj) {\n\t\tconst avatar = this.Helpers.resourceAvatar(obj);\n\t\tconst name =\n\t\t\t\"<div class='webix_gantt_editor_avatar_name'>\" + obj.name + \"</div>\";\n\t\treturn `<div class=\"webix_gantt_avatar_box\">${avatar} ${name}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TableView from \"./links\";\nimport ResourcesView from \"./resources\";\nimport BaselineView from \"./baseline\";\n\nexport default class FormView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst calendar = {\n\t\t\tcss: \"webix_gantt_datepicker\",\n\t\t\ttype: \"calendar\",\n\t\t\t//localId: \"calendar\",\n\t\t\tbody: {\n\t\t\t\theight: 270,\n\t\t\t\twidth: 250,\n\t\t\t\ticons: true,\n\t\t\t\tevents: date => this.app.config.isHoliday(date) && \"webix_cal_event\",\n\t\t\t},\n\t\t};\n\n\t\tconst types = [\n\t\t\t{ id: \"task\", value: _(\"Task\") },\n\t\t\t{ id: \"milestone\", value: _(\"Milestone\") },\n\t\t];\n\t\tif (!this.app.config.projects) {\n\t\t\ttypes.splice(1, 0, { id: \"project\", value: _(\"Project\") });\n\t\t}\n\n\t\tlet accItems = [];\n\t\tif (this.app.config.links)\n\t\t\taccItems.push({\n\t\t\t\theader: _(\"Related tasks\"),\n\t\t\t\tbody: TableView,\n\t\t\t\tcollapsed: true,\n\t\t\t});\n\t\tif (this.isResources)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"resourcesItem\",\n\t\t\t\theader:\n\t\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars\n\t\t\t\t\t\t? _(\"Assignment\")\n\t\t\t\t\t\t: _(\"Assignments\"),\n\t\t\t\tbody: { $subview: ResourcesView, name: \"resources\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\t\tif (this.State.baseline)\n\t\t\taccItems.push({\n\t\t\t\tlocalId: \"baselineItem\",\n\t\t\t\theader: _(\"Planned dates\"),\n\t\t\t\tbody: { $subview: BaselineView, name: \"baseline\" },\n\t\t\t\tcollapsed: true,\n\t\t\t\thidden: true,\n\t\t\t});\n\n\t\tconst accordion = {\n\t\t\tmulti: true,\n\t\t\tview: \"accordion\",\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tmargin: 10,\n\t\t\tcss: \"webix_gantt_accordion\",\n\t\t\trows: accItems,\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tborderless: true,\n\t\t\tautoheight: false,\n\t\t\tscroll: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", name: \"text\", label: _(\"Title\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"types\",\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tlabel: _(\"Type\"),\n\t\t\t\t\toptions: types,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"start_date\",\n\t\t\t\t\tlabel: _(\"Start date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\tname: \"end_date\",\n\t\t\t\t\tlabel: _(\"End date\"),\n\t\t\t\t\tsuggest: webix.copy(calendar),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tname: \"duration\",\n\t\t\t\t\tcss: \"webix_gantt_form_counter\",\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tmax: 1000,\n\t\t\t\t\tlabel: _(\"Duration\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"slider\",\n\t\t\t\t\tname: \"progress\",\n\t\t\t\t\ttitle: webix.template(\"#value#%\"),\n\t\t\t\t\tlabel: _(\"Progress\"),\n\t\t\t\t},\n\t\t\t\taccordion,\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (n, o, config) => {\n\t\t\t\t\tif (this.Compact) this.UpdateTaskTime();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.UpdateTask().then(() => {\n\t\t\t\t\t\t\t\t// redraw all bars because a branch may be closed or opened in tree\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis._eventSource === \"type\" &&\n\t\t\t\t\t\t\t\t\tconfig === \"user\" &&\n\t\t\t\t\t\t\t\t\t(n === \"split\" || o === \"split\")\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\tpadding: { bottom: 14 },\n\t\t\t\trows: [bar, form],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Form = this.$$(\"form\");\n\n\t\t// fills form with data of selected and newly created task\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) {\n\t\t\t\tthis.FillData(id);\n\t\t\t}\n\t\t});\n\n\t\t// updates for start and end dates of task while dnd happens and form is open\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected)\n\t\t\t\tthis.FillData(this.State.selected);\n\t\t});\n\n\t\t// \"resources\" view shows only \"task\" items (disable \"type\" select for it)\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tconst typeSelect = this.$$(\"form\").elements[\"type\"];\n\t\t\tif (v == \"tasks\") typeSelect.enable();\n\t\t\telse if (v == \"resources\") typeSelect.disable();\n\t\t});\n\t\tif (this.app.config.resourceCalendars)\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", () =>\n\t\t\t\tthis.SetResourceHolidays()\n\t\t\t);\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old))\n\t\t\t\tthis.SetBaselineVisibility(this.Tasks.getItem(this.State.selected));\n\t\t});\n\t}\n\n\t/**\n\t * Applies task selection\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tFillData(id) {\n\t\tconst item = this.Tasks.getItem(id);\n\n\t\tconst typeList = this.$$(\"types\").getList();\n\t\tif (this.app.config.split && item.$count) {\n\t\t\tif (!typeList.exists(\"split\"))\n\t\t\t\ttypeList.add({\n\t\t\t\t\tid: \"split\",\n\t\t\t\t\tvalue: this.app.getService(\"locale\")._(\"Split task\"),\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (typeList.exists(\"split\")) typeList.remove(\"split\");\n\t\t}\n\n\t\tif (this.app.config.projects) {\n\t\t\tthis.LimitTypeOptions(item);\n\t\t}\n\t\tif (this.app.config.resourceCalendars) this.SetResourceHolidays();\n\n\t\tif (this.isResources) this.SetResourcesVisibility(item);\n\t\tif (this.State.baseline) this.SetBaselineVisibility(item);\n\t\tthis.Form.setValues(item);\n\t\tthis.Form.focus();\n\t}\n\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetResourcesVisibility(item) {\n\t\tconst layout = this.$$(\"resourcesItem\");\n\t\tif (item.type == \"task\") {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"resources\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\t/**\n\t * Hide/show the \"Assignments\" accordion item depending on a task type\n\t * @param {object} item - a task data object\n\t */\n\tSetBaselineVisibility(item) {\n\t\tconst layout = this.$$(\"baselineItem\");\n\t\tif (\n\t\t\tthis.State.baseline &&\n\t\t\t(item.type == \"task\" || item.type == \"project\")\n\t\t) {\n\t\t\tif (!layout.isVisible()) {\n\t\t\t\tconst sub = this.getSubView(\"baseline\");\n\t\t\t\tif (sub) sub.FillData(item.id);\n\t\t\t\tlayout.show();\n\t\t\t}\n\t\t} else if (layout.isVisible()) layout.hide();\n\t}\n\n\t/**\n\t * Prohibits the user from selecting the type incompatible with other data and relations of a task\n\t * @param {Object} item - the data object of a task\n\t */\n\tLimitTypeOptions(item) {\n\t\tconst typeSelect = this.Form.elements.type;\n\t\tif (item.type === \"project\") typeSelect.hide();\n\t\telse typeSelect.show();\n\t}\n\n\t/**\n\t * Prepares task  object for processing with respect to date-related changes\n\t * @param {Object} vals - object with form values\n\t * @returns {boolean} flag that indicates whether dates were updated or not\n\t */\n\tPrepareDates(vals) {\n\t\tconst f = (this._eventSource = this.Form.$eventSource.config.name);\n\n\t\tlet updateDates = true;\n\t\tif (f == \"duration\" || (f == \"start_date\" && vals.type == \"project\"))\n\t\t\tvals.end_date = null;\n\t\telse if (f == \"end_date\" || f == \"start_date\") vals.duration = null;\n\t\telse updateDates = false;\n\n\t\treturn updateDates;\n\t}\n\t/**\n\t * Update task time and duration on data change in compact form\n\t */\n\tUpdateTaskTime() {\n\t\tconst vals = this.Form.getValues();\n\t\tconst updateDates = this.PrepareDates(vals);\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tconst textUpdated = this.RemoveTagsFromText(vals);\n\t\tif (textUpdated) {\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\n\t\tif (updateDates) {\n\t\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\t\t\tthis.Ops.updateTaskDuration(vals, mode);\n\n\t\t\tthis.Form.blockEvent();\n\t\t\tthis.Form.setValues(vals, true);\n\t\t\tthis.Form.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Removes HTML tags from text fields\n\t * @param {Object} vals - the changed values from the form\n\t * @returns {boolean} - true if there is a text field in the changed values, false otherwise\n\t */\n\tRemoveTagsFromText(vals) {\n\t\tif (this._eventSource === \"text\" || this._eventSource === \"details\") {\n\t\t\tvals[this._eventSource] = (vals[this._eventSource] || \"\").replace(\n\t\t\t\t/(<[^>]+>|^\\s+|\\s+$)/gi,\n\t\t\t\t\"\"\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Saves changes\n\t * @returns {Promise} the result of a data operation (adding new event or updating)\n\t */\n\tUpdateTask() {\n\t\tconst id = this.State.selected;\n\t\tconst vals = this.Form.getValues();\n\t\tif (!this.Compact) {\n\t\t\tthis.PrepareDates(vals);\n\t\t\tthis.RemoveTagsFromText(vals);\n\t\t}\n\n\t\tconst mode = this._eventSource ? this._eventSource.split(\"_\")[0] : null;\n\n\t\t// expand branches with subtasks that are not split anymore\n\t\tif (this._eventSource === \"type\" && vals.type !== \"split\")\n\t\t\tvals.open = vals.opened = 1;\n\n\t\tthis._inProgress = this.Ops.updateTask(id, vals, mode);\n\n\t\tthis._inProgress.finally(() => (this._inProgress = null));\n\t\treturn this._inProgress;\n\t}\n\n\t/**\n\t * Switches end date, duration and progress controls and enables or disables them depending on the type of the task\n\t * @param {string} v - the option chosen in the type selector: \"project\", \"task\", \"milestone\"\n\t */\n\tToggleControls(v) {\n\t\tthis.Form.elements.end_date.show();\n\t\tthis.Form.elements.duration.show();\n\t\tthis.Form.elements.progress.show();\n\t\tthis.Form.elements.end_date.enable();\n\t\tthis.Form.elements.duration.enable();\n\t\tthis.Form.elements.progress.enable();\n\n\t\tif (v == \"project\" || v == \"milestone\") {\n\t\t\tconst action = v == \"project\" ? \"disable\" : \"hide\";\n\t\t\tthis.Form.elements.end_date[action]();\n\t\t\tthis.Form.elements.duration[action]();\n\t\t\tthis.Form.elements.progress[action]();\n\t\t}\n\t}\n\n\t/**\n\t * Handles clicks on the 'cross' icon and closes the form\n\t * if there are unsaved changes, initiates saving after confirmation from the user\n\t */\n\tClose() {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\twebix\n\t\t\t\t.confirm({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t})\n\t\t\t\t.then(() => this.Done(true), () => this.Back(true));\n\t\t} else {\n\t\t\tthis.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either closes the whole right panel or shows \"info\"\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, \"info\" shows up\n\t */\n\tBack(exit) {\n\t\tif (exit)\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: null,\n\t\t\t\tselected: null,\n\t\t\t});\n\t\telse this.State.edit = null;\n\t}\n\n\t/**\n\t * Finishes task editing and closes the form\n\t * @param {Boolean} exit - if true, the right panel will be closed; otherwise, right panel stays, form closes, info shows up\n\t */\n\tDone(exit) {\n\t\tif (this.Compact && this.Form.isDirty()) {\n\t\t\tif (this._inProgress)\n\t\t\t\tthis._inProgress.then(() => {\n\t\t\t\t\tthis.Back(exit);\n\t\t\t\t});\n\t\t\telse this.UpdateTask().then(() => this.Back(exit));\n\t\t} else this.Back(exit);\n\t}\n\n\tSetResourceHolidays() {\n\t\tlet arr = [];\n\t\tconst els = this.Form.elements;\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tarr.push(els[\"start_date\"], els[\"end_date\"]);\n\t\tconst calendar = this.Local.getTaskCalendar(this.State.selected);\n\t\tarr.forEach(el => {\n\t\t\tconst c = el.getPopup().getBody();\n\t\t\tc.config.events = date =>\n\t\t\t\t(calendar\n\t\t\t\t\t? h.isResourceHoliday(date, calendar)\n\t\t\t\t\t: this.app.config.isHoliday(date)) && \"webix_cal_event\";\n\t\t\tc.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst editButton = {\n\t\t\tview: \"button\",\n\t\t\twidth: 130,\n\t\t\tlabel: _(\"Edit\"),\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.EditTask(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_subbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t!state.readonly ? editButton : {},\n\t\t\t],\n\t\t};\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_gantt_task_info\",\n\t\t\ttemplate: obj => this.InfoTemplate(obj),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlabel: _(\"Delete task\"),\n\t\t\tcss: \"webix_danger webix_gantt_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: () => {\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t\ttitle: _(\"Delete task\"),\n\t\t\t\t\t\ttext: _(\"The task will be deleted permanently, are you sure?\"),\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.DeleteTask());\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, !state.readonly ? deleteButton : {}],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Tasks = this.Local.tasks();\n\t\tthis.Text = this.$$(\"text\");\n\t\tthis.isResources = this.app.config.resources;\n\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.FillTemplate(id);\n\t\t});\n\n\t\tthis.on(this.Tasks.data, \"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\" && id == this.State.selected) {\n\t\t\t\tthis.FillTemplate(this.State.selected);\n\t\t\t}\n\t\t});\n\n\t\t// changing links via bars and dnd\n\t\tconst links = this.Local.links();\n\t\tthis.on(links.data, \"onStoreUpdated\", (_id, obj) => {\n\t\t\tif (obj) {\n\t\t\t\tconst tid = this.State.selected;\n\t\t\t\tif (obj.target === tid || obj.source === tid) {\n\t\t\t\t\tthis.FillTemplate(tid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Local.assignments().data, \"onStoreUpdated\", (id, obj) => {\n\t\t\t\tif (obj && obj.task == this.State.selected) this.FillTemplate(obj.task);\n\t\t\t});\n\t\t}\n\t\tthis.on(this.State.$changes, \"baseline\", (v, old) => {\n\t\t\tif (!webix.isUndefined(old)) this.FillTemplate(this.State.selected);\n\t\t});\n\t}\n\n\tFillTemplate(id) {\n\t\tconst item = webix.copy(this.Tasks.getItem(id));\n\t\titem.sources = this.Local.getLinks(id, \"source\");\n\t\titem.targets = this.Local.getLinks(id, \"target\");\n\t\tif (this.isResources && item.type == \"task\") {\n\t\t\tthis.Local.getAssignments(id).then(d => {\n\t\t\t\tif (!this.getRoot()) return false;\n\t\t\t\titem.resources = d.sort(\n\t\t\t\t\tthis.app.getService(\"operations\").sortResources\n\t\t\t\t);\n\t\t\t\tthis.Text.setValues(item);\n\t\t\t});\n\t\t} else this.Text.setValues(item);\n\t}\n\n\tEditTask() {\n\t\tthis.State.edit = true;\n\t}\n\n\tDeleteTask() {\n\t\tthis.app.getService(\"operations\").removeTask(this.State.selected);\n\t\tthis.Close();\n\t}\n\n\tClose() {\n\t\tthis.State.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tInfoTemplate(obj) {\n\t\tif (!obj.start_date) return \"\";\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_gantt_task_title\">${obj.text ||\n\t\t\t_(\"(no title)\")}</span><br><br>`;\n\t\thtml += this.BaseTemplate(obj);\n\t\thtml += this.LinkTemplate(obj);\n\n\t\tif (this.State.baseline && obj.planned_start) {\n\t\t\thtml += this.BaselineTemplateChunk(obj, _(\"Planned dates\"));\n\t\t}\n\n\t\tif (obj.details) {\n\t\t\thtml += `<br><br><div class=\"webix_gantt_task_title\">${_(\"Notes\")}</div>\n\t\t\t\t<br><div class=\"webix_gantt_task_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\t\t}\n\n\t\treturn html;\n\t}\n\n\tBaseTemplate(obj) {\n\t\tconst _ = this._;\n\t\tlet html = `<span class=\"webix_strong\">${_(\n\t\t\t\"Start date\"\n\t\t)}</span>: ${this.DateFormat(obj.start_date)}<br>`;\n\n\t\tif (obj.type !== \"milestone\")\n\t\t\thtml += `<span class=\"webix_strong\">${_(\n\t\t\t\t\"End date\"\n\t\t\t)}</span>: ${this.DateFormat(obj.end_date)}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Duration\")}</span>: ${obj.duration}<br>\n\t\t\t<span class=\"webix_strong\">${_(\"Progress\")}</span>: ${obj.progress}%\n\t\t<br>`;\n\t\treturn html;\n\t}\n\n\tLinkTemplate(obj) {\n\t\tlet html = \"\";\n\t\tconst _ = this._;\n\t\tif (obj.targets.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.targets, _(\"Predecessors\"));\n\t\tif (obj.sources.length)\n\t\t\thtml += this.InfoTemplateChunk(obj.sources, _(\"Successors\"));\n\t\tif (obj.resources) {\n\t\t\tconst single =\n\t\t\t\tthis.isResources == \"single\" || this.app.config.resourceCalendars;\n\t\t\thtml += this.ResourcesTemplateChunk(\n\t\t\t\tobj.resources,\n\t\t\t\tsingle ? _(\"Assignment\") : _(\"Assignments\")\n\t\t\t);\n\t\t}\n\t\treturn html;\n\t}\n\n\tResourcesTemplateChunk(arr, label) {\n\t\tif (!arr || !arr.length) return \"\";\n\t\tlet maxWidth = 130;\n\t\tarr.forEach(r => {\n\t\t\tconst s0 = webix.html.getTextSize(r.name, \"webix_gantt_info_list_text\");\n\t\t\tconst s1 = webix.html.getTextSize(\n\t\t\t\tr.category,\n\t\t\t\t\"webix_gantt_info_list_text webix_gantt_resource_section\"\n\t\t\t);\n\t\t\tmaxWidth = Math.max(maxWidth, s0.width, s1.width);\n\t\t});\n\t\tmaxWidth = Math.min(200, maxWidth);\n\t\tlet list = arr\n\t\t\t.map(r => {\n\t\t\t\tconst h = this.app.getService(\"helpers\");\n\t\t\t\tconst avatar =\n\t\t\t\t\t\"<div>\" +\n\t\t\t\t\th.resourceAvatar(r, \"webix_gantt_person_avatar_big\") +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst dpt =\n\t\t\t\t\t\"<div class=' webix_gantt_info_list_text webix_gantt_resource_section' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.category +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst value =\n\t\t\t\t\t\"<div class='webix_gantt_resource_section'>\" +\n\t\t\t\t\tr.value +\n\t\t\t\t\tthis._(h.getResourceUnit(r)) +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst top =\n\t\t\t\t\t\"<div class='webix_gantt_info_list_text_row'><div class='webix_gantt_info_list_text' style='min-width:\" +\n\t\t\t\t\tmaxWidth +\n\t\t\t\t\t\"px'>\" +\n\t\t\t\t\tr.name +\n\t\t\t\t\t\"</div>\" +\n\t\t\t\t\tvalue +\n\t\t\t\t\t\"</div>\";\n\t\t\t\tconst text = \"<div  >\" + top + dpt + \"</div>\";\n\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_gantt_info_resource'>\" + avatar + text + \"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul class=\"webix_gantt_info_list_resources\">${list}</ul>`;\n\t}\n\n\tInfoTemplateChunk(arr, label) {\n\t\tlet res = arr\n\t\t\t.map(s => `<li>${s.text || this._(\"(no title)\")}</li>`)\n\t\t\t.join(\"\");\n\t\treturn `<br><span class=\"webix_strong\">${label}</span>:<br><ul>${res}</ul>`;\n\t}\n\n\tDateFormat(date) {\n\t\treturn webix.i18n.longDateFormatStr(date);\n\t}\n\tBaselineTemplateChunk(obj, label) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html =\n\t\t\t`${_(\"Start date\")}: ${this.DateFormat(obj.planned_start)}<br>` +\n\t\t\t`${_(\"End date\")}: ${this.DateFormat(obj.planned_end)}<br>` +\n\t\t\t`${_(\"Duration\")}: ${obj.planned_duration}<br>`;\n\t\treturn `<br><span class=\"webix_strong\">${label}</span><br><div class=\"webix_gantt_info_list_planned\">${html}</div>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TaskPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sort } from \"../helpers/common\";\n\nexport default class TreeView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tconst scales = this.Local.getScales();\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst compact = (this.Compact = this.getParam(\"compact\", true));\n\t\tthis.isResources = this.app.config.resources;\n\t\tthis.maxAvatarNumber = 3;\n\n\t\tconst action = {\n\t\t\tid: \"action\",\n\t\t\tcss: \"webix_gantt_action\",\n\t\t\theader: {\n\t\t\t\ttext: `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus-circle\"></span>`,\n\t\t\t\tcss: \"webix_gantt_action\",\n\t\t\t},\n\t\t\ttemplate: () => {\n\t\t\t\treturn `<span webix_tooltip=\"${_(\n\t\t\t\t\t\"Add task\"\n\t\t\t\t)}\" class=\"webix_icon wxi-plus\"></span>`;\n\t\t\t},\n\t\t\twidth: 44,\n\t\t\tminWidth: 44,\n\t\t};\n\n\t\tlet columns = [\n\t\t\t{\n\t\t\t\tid: \"text\",\n\t\t\t\tcss: \"webix_gantt_title\",\n\t\t\t\theader: _(\"Title\"),\n\t\t\t\ttemplate: (obj, common) =>\n\t\t\t\t\tcommon.treetable(obj, common) + this.TitleTemplate(obj),\n\t\t\t\tfillspace: true,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: sort(\"text\"),\n\t\t\t\tminWidth: 150,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"start_date\",\n\t\t\t\theader: _(\"Start date\"),\n\t\t\t\tformat: webix.i18n.dateFormatStr,\n\t\t\t\thidden: compact,\n\t\t\t\tbatch: \"full\",\n\t\t\t\tsort: \"date\",\n\t\t\t\tminWidth: 100,\n\t\t\t},\n\t\t];\n\n\t\tif (this.isResources) {\n\t\t\tcolumns.push({\n\t\t\t\tid: \"resources\",\n\t\t\t\tcss: \"webix_gantt_tree_column_resources\",\n\t\t\t\theader: _(\"Assigned\"),\n\t\t\t\ttemplate: obj => this.ResourcesTemplate(obj),\n\t\t\t\tminWidth: 100,\n\t\t\t});\n\t\t}\n\n\t\tif (compact) {\n\t\t\taction.header.text = \"<span class='webix_icon gti-menu'>\";\n\t\t\tif (state.readonly) action.template = \"\";\n\t\t\tcolumns.unshift(action);\n\t\t} else if (!state.readonly) columns.push(action);\n\n\t\tcolumns[columns.length - 1].resize = false;\n\n\t\tconst skin = webix.skin.$name;\n\t\tconst headerCss =\n\t\t\tskin == \"material\" || skin == \"mini\" ? \"webix_header_border\" : \"\";\n\t\tconst tree = {\n\t\t\tview: \"treetable\",\n\t\t\tcss: \"webix_gantt_tree \" + headerCss,\n\t\t\tprerender: true,\n\t\t\twidth: compact ? 44 : state.treeWidth,\n\t\t\trowHeight: scales.cellHeight,\n\t\t\theaderRowHeight: scales.height,\n\t\t\tscroll: \"xy\",\n\t\t\tscrollAlignY: false,\n\t\t\tselect: \"row\",\n\t\t\tsort: \"multi\",\n\t\t\tresizeColumn: {\n\t\t\t\theaderOnly: true,\n\t\t\t\tsize: 10,\n\t\t\t},\n\t\t\tdrag: state.readonly ? false : \"order\",\n\t\t\tcolumns,\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-plus\": (ev, id) => this.AddTask(id.row),\n\t\t\t\t\"wxi-plus-circle\": () => this.AddTask(\"0\"),\n\t\t\t\t\"gti-menu\": () => this.ToggleColumns(),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeOpen: id => this.HandleToggle(id),\n\t\t\t\tonAfterOpen: id => {\n\t\t\t\t\tthis.ToggleBranch(id, 1);\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t},\n\t\t\t\tonAfterClose: id => this.ToggleBranch(id, 0),\n\t\t\t\tonBeforeSelect: id => this.BeforeSelectHandler(id),\n\t\t\t\tonItemClick: id => this.ItemClickHandler(id),\n\t\t\t\tonAfterSort: (by, dir, as) => this.SortTasks(by, dir, as),\n\t\t\t\tonColumnResize: (id, v, o, user) => this.NormalizeColumns(id, user),\n\t\t\t\tonBeforeDrag: (ctx, e) => this.BeforeDragHandler(ctx, e),\n\t\t\t\tonBeforeDrop: ctx => this.BeforeDropHandler(ctx),\n\t\t\t\tonViewResize: () => {\n\t\t\t\t\tthis.State.treeWidth = this.Tree.$width;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\ttree.on[\"onScrollY\"] = tree.on[\"onSyncScroll\"] = tree.on[\n\t\t\t\"onAfterScroll\"\n\t\t] = function() {\n\t\t\tstate.top = this.getScrollState().y;\n\t\t};\n\t\treturn tree;\n\t}\n\n\tinit(view) {\n\t\tthis.Tree = view;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\t\tthis.Tasks = this.Local.tasks();\n\n\t\tthis.on(this.State.$changes, \"display\", v => {\n\t\t\tthis.Mode = v;\n\t\t\tthis.State.top = 0;\n\t\t\tthis.SyncData();\n\t\t});\n\t\tif (this.isResources) {\n\t\t\tthis.on(this.Assignments.data, \"onStoreUpdated\", () => {\n\t\t\t\tthis.Tree.refresh();\n\t\t\t});\n\t\t\tthis.on(this.Tree.data, \"onStoreUpdated\", id => {\n\t\t\t\tif (this.Mode == \"resources\" && !id) {\n\t\t\t\t\tthis.ApplySelection();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.on(this.State.$changes, \"top\", y => this.Tree.scrollTo(null, y));\n\t\tthis.on(this.State.$changes, \"selected\", id => {\n\t\t\tif (id) this.ApplySelection();\n\t\t\telse this.Tree.unselect();\n\t\t});\n\n\t\t// resetting headerRowHeight\n\t\tthis.on(this.app, \"onScalesUpdate\", scales => {\n\t\t\tconst col = this.Tree.columnId(0);\n\t\t\tthis.Tree.getColumnConfig(col).header[0].height = scales.height;\n\t\t\tthis.Tree.refreshColumns();\n\t\t});\n\n\t\t// compact button and dnd module\n\t\tthis.on(this.app, \"task:add\", (pid, dates) =>\n\t\t\tthis.AddTask(pid || \"0\", dates)\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"treeWidth\", v => {\n\t\t\tif (!this.Compact && view.$width !== v) {\n\t\t\t\tview.define({ width: v });\n\t\t\t\tview.resize();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Prevents split task branches from being opened\n\t * @param {(string|number)} id - the ID of a task branch\n\t * @returns {Boolean} return false to prevent branches from opening\n\t */\n\tHandleToggle(id) {\n\t\tconst obj = this.Tree.getItem(id);\n\t\tif (obj.type === \"split\" && obj.$data.length) return false;\n\t}\n\n\t/**\n\t * Selects a task\n\t * @param {(string|number)} id - the ID of a task\n\t */\n\tItemClickHandler(id) {\n\t\tif (!this.Tree.getItem(id).$group) {\n\t\t\tthis.State.$batch({\n\t\t\t\tparent: null,\n\t\t\t\tselected: id.row,\n\t\t\t});\n\t\t} else this.app.callEvent(\"edit:stop\");\n\t}\n\t/**\n\t * Checks whether selection is allowed\n\t * @param {string, number} id - task ID\n\t * @returns {boolean} returning false prevents selection\n\t */\n\tBeforeSelectHandler(id) {\n\t\treturn !this.Tree.getItem(id).$group;\n\t}\n\t/**\n\t * Checks whether drag-n-drop is allowed and defines the looks of the drag marker\n\t * @param {Object} ctx - the context object of DnD\n\t * @param {MouseEvent} e - native browser event\n\t * @returns {Boolean} returning false prevents Webix drag-n-drop logic\n\t */\n\tBeforeDragHandler(ctx, e) {\n\t\tif (this.Mode == \"tasks\") {\n\t\t\tconst obj = this.Tree.getItem(ctx.start);\n\t\t\tif (obj.type === \"split\" && obj.$data.length) {\n\t\t\t\tconst html = this.Tree.$dragHTML(this.Tree.getItem(ctx.start), e, ctx);\n\t\t\t\tctx.html = html.replace(\n\t\t\t\t\t\"webix_dd_drag\",\n\t\t\t\t\t\"webix_dd_drag webix_gantt_tree_no_icon\"\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t * Saves task position\n\t * @param {Object} ctx - drag-n-drop context\n\t * @returns {boolean} returning false prevents Webix drop logic\n\t */\n\tBeforeDropHandler(ctx) {\n\t\tthis.Ops.moveTask(ctx.start, ctx.parent, ctx.index);\n\t\treturn false;\n\t}\n\t/** Fills tree width data */\n\tSyncData() {\n\t\tthis.Tree.clearAll();\n\t\tthis.VisibleTasks = this.Local.getVisibleTasksCollection();\n\t\tthis.resDisplayed = this.State.display === \"resources\";\n\n\t\t// for Resource view: always handle existing waitData of VisibleTasks\n\t\tif (this.resDisplayed && !this.clearEvID) {\n\t\t\tthis.clearEvID = this.on(this.VisibleTasks.data, \"onClearAll\", () => {\n\t\t\t\tif (this.resDisplayed) {\n\t\t\t\t\tthis.RefreshData();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.RefreshData();\n\t}\n\n\t/**\n\t * Returns waitData of all involved Collections\n\t * @returns {Array} of Promises\n\t */\n\tGetLoaders() {\n\t\tconst loaders = [this.VisibleTasks.waitData];\n\t\tif (this.isResources) {\n\t\t\tthis.Resources = this.Local.resources();\n\t\t\tthis.Assignments = this.Local.assignments();\n\t\t\tloaders.push(this.Resources.waitData, this.Assignments.waitData);\n\t\t}\n\t\treturn loaders;\n\t}\n\n\t/**\n\t * Waits for data before syncing with main collection and restoring state\n\t * @param {Array} loaders -\n\t */\n\tRefreshData() {\n\t\tconst loaders = this.GetLoaders();\n\t\twebix.promise.all(loaders).then(() => {\n\t\t\tthis.Tree.sync(this.VisibleTasks);\n\t\t\tthis.ApplySelection();\n\t\t\tthis.ApplySorting();\n\t\t});\n\t}\n\n\t/** Applies selection from state */\n\tApplySelection() {\n\t\tconst id = this.State.selected;\n\n\t\tif (id && this.Tree.exists(id) && this.Tree.getSelectedId() != id) {\n\t\t\tlet selected;\n\t\t\tconst task = this.Tree.getItem(id);\n\n\t\t\t// split subtasks are in the tree but they are never visible\n\t\t\tif (this.State.display === \"tasks\") {\n\t\t\t\tconst parent = task.parent;\n\t\t\t\tconst pdata = parent != 0 ? this.Tree.getItem(parent) : null;\n\t\t\t\tif (pdata && pdata.type === \"split\") {\n\t\t\t\t\tselected = parent;\n\t\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\t\tselected = id;\n\t\t\t\t}\n\t\t\t} else if (this.Local._isTaskVisible(task)) {\n\t\t\t\tselected = id;\n\t\t\t}\n\n\t\t\tif (selected) {\n\t\t\t\tthis.Tree.select(selected);\n\t\t\t\tthis.Tree.showItem(selected);\n\t\t\t}\n\t\t}\n\t}\n\t/** Applies sorting from state */\n\tApplySorting() {\n\t\tif (this.State.sort) {\n\t\t\t// UI-only: no need to re-apply sorting on collection\n\t\t\tthis.Tree.data.blockEvent();\n\t\t\tthis.Tree.setState({ sort: this.State.sort });\n\t\t\tthis.Tree.data.unblockEvent();\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new task\n\t * @param {string, number} pid - ID of parent task, can be \"0\" for root\n\t * @param {Object} dates - start and end of the new task in units (numbers)\n\t * @returns {boolean} returning false prevents selection of the parent task, if called from tree\n\t */\n\tAddTask(pid, dates) {\n\t\tthis.State.selected = null;\n\n\t\tconst row = this.Tree.getItem(pid);\n\t\tconst index = row ? 0 : -1;\n\t\tlet inProgress;\n\t\tconst newTask = this.GetNewTask(row, dates);\n\n\t\tif (this.Mode == \"resources\" && row) {\n\t\t\tinProgress = this.AddTaskWithAssignment(newTask, pid);\n\t\t} else {\n\t\t\t// row and dates come from drag-n-drop module\n\t\t\tif (row && dates) {\n\t\t\t\tlet assigned;\n\t\t\t\tif (this.app.config.resources) {\n\t\t\t\t\tassigned = this.Assignments.find(a => a.task == row.id);\n\t\t\t\t}\n\t\t\t\tif (assigned && assigned.length)\n\t\t\t\t\tinProgress = this.SplitTaskWithAssignment(\n\t\t\t\t\t\tnewTask,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tpid,\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tassigned\n\t\t\t\t\t);\n\t\t\t\telse inProgress = this.Ops.splitTaskWithDnd(newTask, index, pid, row);\n\t\t\t} else inProgress = this.Ops.addTask(newTask, index, row ? pid : 0);\n\t\t}\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\n\t\tinProgress.then(res => {\n\t\t\tif (row && this.Mode == \"tasks\" && row.type !== \"split\") {\n\t\t\t\tthis.Tree.open(pid);\n\t\t\t}\n\t\t\tthis.State.$batch({\n\t\t\t\tedit: true,\n\t\t\t\tselected: res.id,\n\t\t\t});\n\n\t\t\tthis.Tree.showItem(res.id);\n\t\t});\n\n\t\treturn false;\n\t}\n\t/**\n\t * Returns and object with new task data\n\t * @param {Object} row - the data object of parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} an object with default task fields\n\t */\n\tGetNewTask(row, dates) {\n\t\tconst { start, end } = this.GetDates(row, dates);\n\n\t\treturn {\n\t\t\tstart_date: new Date(start),\n\t\t\tend_date: end || webix.Date.add(start, 1, \"day\", true),\n\t\t\tprogress: 0,\n\t\t\ttext: \"\",\n\t\t};\n\t}\n\n\t/**\n\t * Gets start and end dates for a new task\n\t * @param {Object} row - (optional) the data object of a parent task\n\t * @param {Object} dates - (optional) start and length of the new task in units (numbers)\n\t * @returns {Object} with start and end dates\n\t */\n\tGetDates(row, dates) {\n\t\tif (dates) {\n\t\t\treturn dates;\n\t\t}\n\n\t\tlet start, end;\n\t\tif (row && row.type === \"split\") {\n\t\t\tconst date =\n\t\t\t\trow.$data && row.$data.length ? row.$data[0].end_date : row.end_date;\n\t\t\tstart = this.Helpers.addUnit(\"day\", date, 1);\n\t\t} else {\n\t\t\tif (row) {\n\t\t\t\tstart = row.start_date;\n\t\t\t} else {\n\t\t\t\tconst scales = this.Local.getScales();\n\t\t\t\tstart = webix.Date.add(scales.start, 1, scales.minUnit); //keep scale start\n\t\t\t}\n\t\t}\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Adds a new task with assignment, if any is applicable\n\t * @param {Object} newTask - the data object of a new task\n\t * @param {(string|number)} pid - the ID of the parent task\n\t * @returns {Promise} server response with ID of the new task\n\t */\n\tAddTaskWithAssignment(newTask, pid) {\n\t\tthis.Tasks.data.blockEvent();\n\t\tthis.Assignments.data.blockEvent();\n\t\t// add task\n\t\tlet targetId = \"0\";\n\t\tif (pid) targetId = this.Tree.getItem(pid).$group ? \"0\" : pid;\n\t\tlet index = 0;\n\t\tif (this.Tasks.data.branch[targetId])\n\t\t\tindex = this.Tasks.data.branch[targetId].length;\n\n\t\treturn this.Ops.addTask(newTask, index, targetId)\n\t\t\t.then(obj => {\n\t\t\t\tnewTask.id = obj.id;\n\t\t\t\t// add assignments\n\t\t\t\tlet waitArr = [];\n\t\t\t\tlet resources = null;\n\t\t\t\twhile (pid != \"0\" && !resources) {\n\t\t\t\t\tresources = this.Tree.getItem(pid).resources;\n\t\t\t\t\tif (!resources) pid = this.Tree.getParentId(pid);\n\t\t\t\t}\n\t\t\t\tif (resources && resources.length) {\n\t\t\t\t\tresources.forEach(rId => {\n\t\t\t\t\t\tconst resource = this.Local.resources().getItem(rId);\n\t\t\t\t\t\twaitArr.push(\n\t\t\t\t\t\t\tthis.Ops.addAssignment({\n\t\t\t\t\t\t\t\tresource: rId,\n\t\t\t\t\t\t\t\tvalue: this.Helpers.getDefaultResourceValue(resource),\n\t\t\t\t\t\t\t\ttask: newTask.id,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (!waitArr.length) return webix.promise.resolve(obj);\n\t\t\t\treturn webix.promise.all(waitArr).then(() => obj);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.Tasks.data.unblockEvent();\n\t\t\t\tthis.Assignments.data.unblockEvent();\n\t\t\t\t//now we can refresh\n\t\t\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", [\n\t\t\t\t\tnewTask.id,\n\t\t\t\t\tnewTask,\n\t\t\t\t\t\"add\",\n\t\t\t\t]);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task and reassigns resources from original task to new kid if the original task was not split\n\t * @param {Object} newTask - data for a new split kid\n\t * @param {number} index - the index of the new kid\n\t * @param {(number|string)} pid - the ID of the original task\n\t * @param {Object} row - data of the original task\n\t * @param {Object} assignment - data of the assignment of the original task\n\t * @returns {Promise<Object>} server response with ID of the new task, it's 'sibling' ID\n\t */\n\tSplitTaskWithAssignment(newTask, index, pid, row, assignments) {\n\t\treturn this.Ops.splitTaskWithDnd(newTask, index, pid, row).then(res => {\n\t\t\tif (res.sibling) {\n\t\t\t\tconst aops = [];\n\t\t\t\tfor (let i = 0; i < assignments.length; ++i)\n\t\t\t\t\taops.push(\n\t\t\t\t\t\tthis.Ops.updateAssignment(assignments[i].id, {\n\t\t\t\t\t\t\ttask: res.sibling,\n\t\t\t\t\t\t}).then(() => res)\n\t\t\t\t\t);\n\t\t\t\treturn webix.promise.all(aops).then(() => res);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/** Invokes tasks painting in the chart */\n\tRefreshTasks() {\n\t\tthis.Tasks.data.callEvent(\"onStoreUpdated\", []);\n\t}\n\t/**\n\t * Sorts tasks according to current sorting config\n\t * @param {string, array} by - data field, can store an array of sorting configs in case of multiple sorting\n\t * @param {string, number} dir - sorting direction, \"asc\" or \"desc\"\n\t * @param {string, number} as - data type, \"string\" by default\n\t */\n\tSortTasks(by, dir, as) {\n\t\tconst dataSorter = webix.isArray(by) ? by : { by, dir, as };\n\t\tconst sortState = this.Tree.getState().sort;\n\n\t\t// sort the collection to affect task bars\n\t\tthis.VisibleTasks.sort(dataSorter);\n\t\t// save sorting state to restore it after app.refresh (switching from/to compact mode)\n\t\tthis.State.sort = sortState;\n\t}\n\t/** Shows and hides columns in a compact mode */\n\tToggleColumns() {\n\t\tconst vis = this.Tree.isColumnVisible(\"text\");\n\t\tthis.Tree.showColumnBatch(\"full\", !vis);\n\t\tthis.Tree.config.width = vis ? 44 : 0;\n\t\tthis.Tree.resize();\n\n\t\tthis.app.callEvent(\"bars:toggle\", [vis]);\n\t}\n\t/**\n\t * Adjusts columns after resizing\n\t * @param {string} id - ID of the column being resized\n\t * @param {boolean} user - defines whether resizing was triggered by user or API\n\t */\n\tNormalizeColumns(id, user) {\n\t\tif (!user) return;\n\t\tconst tree = this.Tree;\n\t\tconst columns = tree.config.columns;\n\t\tconst i = tree.getColumnIndex(id);\n\n\t\tlet last = columns.length - 1;\n\t\tif (columns[last].id === \"action\") last -= 1;\n\n\t\tif (i === 0) {\n\t\t\tcolumns[last].fillspace = true;\n\t\t\tcolumns[last].width = 0;\n\t\t} else if (i === last) {\n\t\t\tcolumns[0].fillspace = true;\n\t\t\tcolumns[0].width = 0;\n\t\t}\n\t\ttree.refreshColumns();\n\t}\n\t/**\n\t * Saves a task tree branch state (open or closed)\n\t * @param {number, string} id - the ID of the task (branch node)\n\t * @param {number} open - 1 if open, 0 if closed\n\t */\n\tToggleBranch(id, open) {\n\t\tif (this.State.display != \"resources\") {\n\t\t\tthis.RefreshTasks();\n\t\t\tif (!this.State.readonly) this.Ops.updateTask(id, { opened: open });\n\t\t} else {\n\t\t\tconst tree = this.VisibleTasks;\n\t\t\tconst item = tree.getItem(id);\n\t\t\titem.open = !!open;\n\t\t\t// need to update treestore order\n\t\t\ttree.data.callEvent(\"onStoreUpdated\", [id, 0, \"branch\"]);\n\t\t}\n\t}\n\n\t/**\n\t * Returns a string with the text label for item title\n\t * @param {Object} obj - the data object of a task\n\t * @returns {string} a string with the text label\n\t */\n\tTitleTemplate(obj) {\n\t\treturn (\n\t\t\tobj.text || (obj.$group ? this._(\"Unassigned\") : this._(\"(no title)\"))\n\t\t);\n\t}\n\n\t/**\n\t * Resources cell template\n\t * @param {object} obj - task data item\n\t * @returns {string} html string\n\t */\n\tResourcesTemplate(obj) {\n\t\tif (this.Assignments.count() && this.Resources.count()) {\n\t\t\tlet assigned = [];\n\t\t\tthis.Assignments.data.each(a => {\n\t\t\t\tif (a.task == obj.id) assigned.push(this.Resources.getItem(a.resource));\n\t\t\t});\n\t\t\tassigned.sort(this.Ops.sortResources);\n\t\t\treturn this.GetAssignmentsHTML(assigned);\n\t\t}\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Gets html content for assignments cell\n\t * @param {Array} assignedArr - an array of assignments\n\t * @returns {string} html string\n\t */\n\tGetAssignmentsHTML(assignedArr) {\n\t\tlet str = \"\";\n\t\tif (assignedArr.length > this.maxAvatarNumber) {\n\t\t\tconst num = assignedArr.length - this.maxAvatarNumber + 1;\n\t\t\tassignedArr = assignedArr.splice(0, this.maxAvatarNumber);\n\t\t\t// show remaining assignments as \"+[NUM]\" over the last avatar\n\t\t\tconst last = assignedArr.pop();\n\t\t\tconst lastStr = this.Helpers.resourceAvatar(last);\n\t\t\tconst numStr =\n\t\t\t\t\"<div class='webix_gantt_cell_remain_num'>+\" + num + \"</div>\";\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\tstr +=\n\t\t\t\t\"<div class='webix_gantt_cell_assigned_last'>\" +\n\t\t\t\tlastStr +\n\t\t\t\tnumStr +\n\t\t\t\t\"</div>\";\n\t\t} else {\n\t\t\tstr = assignedArr\n\t\t\t\t.map(r => `${this.Helpers.resourceAvatar(r, null, true)}`)\n\t\t\t\t.join(\"\");\n\t\t\t// show a name for single assignment\n\t\t\tif (assignedArr.length == 1) {\n\t\t\t\tlet arr = assignedArr[0].name.split(\" \");\n\t\t\t\tstr +=\n\t\t\t\t\t\"<span class='webix_gantt_cell_assigned_text'>\" + arr[0] + \"</span>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='webix_gantt_avatar_box'>\" + str + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport TreeView from \"./tree\";\nimport ChartView from \"./chart\";\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\t\tthis.fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(this.fCompact))\n\t\t\tthis.setParam(\"compact\", this.fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst edit = this.Compact\n\t\t\t? { $subview: true, name: \"edit\", popup: true }\n\t\t\t: {\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tcss: \"webix_shadow_medium\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\twidth: 400,\n\t\t\t\t\thidden: true,\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t  };\n\n\t\tlet cols = [\n\t\t\tTreeView,\n\t\t\t{\n\t\t\t\tview: this.Compact ? \"spacer\" : \"resizer\",\n\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\twidth: this.Compact ? 1 : 4,\n\t\t\t},\n\t\t\tChartView,\n\t\t];\n\n\t\tif (this.app.config.resources) {\n\t\t\tcols = [\n\t\t\t\t{\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\tcols,\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonViewResize: () => {\n\t\t\t\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"resizer\",\n\t\t\t\t\t\t\tcss: \"webix_gantt_resizer\",\n\t\t\t\t\t\t\tlocalId: \"rdResizer\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\t\t\tlocalId: \"rdiagram\",\n\t\t\t\t\t\t\theight: this.Compact ? 0 : 400,\n\t\t\t\t\t\t\tbody: { $subview: true, name: \"rdiagram\" },\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tedit,\n\t\t\t];\n\t\t} else {\n\t\t\tcols.push(edit);\n\t\t}\n\n\t\tconst main = {\n\t\t\tview: \"abslayout\",\n\t\t\tcss: \"webix_gantt\",\n\t\t\tcells: [\n\t\t\t\t{\n\t\t\t\t\tview: \"r-layout\",\n\t\t\t\t\tlocalId: \"main\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\trelative: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\tcols: cols,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcss: \"webix_gantt_absbutton\",\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\thidden: !this.Compact || this.State.readonly,\n\t\t\t\t\twidth: 50,\n\t\t\t\t\theight: 50,\n\t\t\t\t\tright: 20,\n\t\t\t\t\tbottom: 20,\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.app.callEvent(\"task:add\", []);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn main;\n\t}\n\n\tinit(view) {\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(this.State.$changes, \"selected\", (id, oid) => {\n\t\t\tif (id) this.ShowTask(this.State.edit ? \"form\" : \"info\");\n\t\t\telse if (oid) this.HideTask();\n\t\t});\n\t\tthis.on(this.State.$changes, \"edit\", v => {\n\t\t\tif (this.State.selected) this.ShowTask(v ? \"form\" : \"info\");\n\t\t});\n\n\t\twebix.extend(view, webix.ProgressBar);\n\t\tthis.on(this.app, \"backend:operation\", res => {\n\t\t\tview.showProgress({ type: \"top\", delay: 2000 });\n\t\t\tres.finally(() => {\n\t\t\t\tview.hideProgress();\n\t\t\t});\n\t\t});\n\n\t\tif (this.app.config.resources) {\n\t\t\tthis.on(this.State.$changes, \"resourcesDiagram\", v => {\n\t\t\t\tif (v) {\n\t\t\t\t\tthis.$$(\"rdiagram\").show();\n\t\t\t\t\tthis.$$(\"rdResizer\").show();\n\t\t\t\t\tthis.show(\"rdiagram\", { target: \"rdiagram\" });\n\t\t\t\t} else {\n\t\t\t\t\tthis.$$(\"rdiagram\").hide();\n\t\t\t\t\tthis.$$(\"rdResizer\").hide();\n\t\t\t\t\tthis.show(\"_blank\", { target: \"rdiagram\" }).then(() => {\n\t\t\t\t\t\tthis.app.callEvent(\"rdiagram:resize\", []);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tShowTask(path) {\n\t\tpath = `task.${path}`;\n\t\tif (this.Compact) {\n\t\t\tthis.show(`task.popup/${path}`, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(path, {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\tHideTask() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.State.$batch({ top: 0, left: 0 });\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import m0 from \"./views/chart/bars\";\nimport m1 from \"./views/chart/index.js\";\nimport m2 from \"./views/chart/scale\";\nimport m3 from \"./views/rdiagram/diagram\";\nimport m4 from \"./views/rdiagram/index.js\";\nimport m5 from \"./views/rdiagram/tree\";\nimport m6 from \"./views/task/baseline\";\nimport m7 from \"./views/task/form\";\nimport m8 from \"./views/task/info\";\nimport m9 from \"./views/task/links\";\nimport m10 from \"./views/task/popup\";\nimport m11 from \"./views/task/resources\";\nimport m12 from \"./views/top\";\nimport m13 from \"./views/tree\";\nimport { JetView } from \"webix-jet\";\n\nconst views = { JetView };\nviews[\"chart/bars\"] = m0;\nviews[\"chart\"] = m1;\nviews[\"chart/scale\"] = m2;\nviews[\"rdiagram/diagram\"] = m3;\nviews[\"rdiagram\"] = m4;\nviews[\"rdiagram/tree\"] = m5;\nviews[\"task/baseline\"] = m6;\nviews[\"task/form\"] = m7;\nviews[\"task/info\"] = m8;\nviews[\"task/links\"] = m9;\nviews[\"task/popup\"] = m10;\nviews[\"task/resources\"] = m11;\nviews[\"top\"] = m12;\nviews[\"tree\"] = m13;\n\nexport default views;\n","export default class Local {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {object} config - object with app settings\n\t */\n\tconstructor(app, config) {\n\t\tthis.app = app;\n\t\tthis.state = app.getState();\n\n\t\tthis.Helpers = this.app.getService(\"helpers\");\n\n\t\t// initial config of scales\n\t\tthis.resetScales(config);\n\n\t\tthis.dateToLocalStr = webix.Date.dateToStr(webix.i18n.parseFormat);\n\t}\n\n\t/**\n\t * Creates and paints scales\n\t * @param {Date} scaleStart - start date\n\t * @param {Date} scaleEnd - end date\n\t * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n\t * @param {number} width - width of smallest cell unit\n\t * @param {number} height - height of scale cell\n\t * @param {Array} scales - a set of scales (objects)\n\t */\n\tsetScales(scaleStart, scaleEnd, precise, width, height, scales) {\n\t\tconst oldScale = this._scales;\n\t\tif (width) {\n\t\t\tthis._scaleBase = { width, height, scales };\n\t\t\tscaleEnd = webix.Date.add(scaleEnd, 1, \"day\"); //inclusive\n\t\t} else {\n\t\t\twidth = this._scaleBase.width;\n\t\t\theight = this._scaleBase.height;\n\t\t\tscales = this._scaleBase.scales;\n\t\t}\n\n\t\tthis._scales = this.app\n\t\t\t.getService(\"helpers\")\n\t\t\t.setScales(scaleStart, scaleEnd, precise, width, height, scales);\n\t\tthis._taskHeight = this._scales.cellHeight - 12;\n\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (tasks && tasks.data.order.length) {\n\t\t\tif (this.state.display === \"resources\") {\n\t\t\t\tthis.app.getService(\"grouping\").refreshResourceTasks();\n\t\t\t} else {\n\t\t\t\tthis.refreshTasks();\n\t\t\t}\n\t\t\tthis.refreshLinks();\n\t\t}\n\n\t\tthis.app.callEvent(\"onScalesUpdate\", [this._scales, oldScale]);\n\t}\n\t/**\n\t * returns scales\n\t * @returns {object} current scales object\n\t */\n\tgetScales() {\n\t\treturn this._scales;\n\t}\n\t/**\n\t * sets initial state of Gantt scales\n\t * @param {Object} config - scales configuration, by default from app config\n\t */\n\tresetScales(config) {\n\t\tconfig = config || this.app.config;\n\n\t\tconst active = webix.skin.$active;\n\t\tconst scaleStart = config.scaleStart || webix.Date.dayStart(new Date());\n\t\tconst scaleEnd =\n\t\t\tconfig.scaleEnd || webix.Date.add(scaleStart, 1, \"month\", true);\n\n\t\tthis.setScales(\n\t\t\tscaleStart,\n\t\t\tscaleEnd,\n\t\t\tconfig.preciseTimeUnit,\n\t\t\tconfig.scaleCellWidth || 80,\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tconfig.scales || [{ unit: \"day\", step: 1, format: \"%d\" }]\n\t\t);\n\t}\n\t/**\n\t * Get tasks height\n\t * @returns {number} tasks height\n\t */\n\tgetTaskHeight() {\n\t\treturn this._taskHeight;\n\t}\n\t/**\n\t * Adjusts scale to edited task\n\t * @param {object} task - task object\n\t */\n\tadjustScale(obj) {\n\t\tlet start = obj.start_date;\n\t\tlet end = obj.end_date;\n\t\tif (this.state.baseline && obj.planned_start && obj.planned_end) {\n\t\t\tif (start > obj.planned_start) start = obj.planned_start;\n\t\t\tif (end < obj.planned_end) end = obj.planned_end;\n\t\t}\n\t\tconst s = this.getScales();\n\n\t\t// add 1 unit space around\n\t\tstart = this.Helpers.addUnit(s.minUnit, start, -1);\n\t\tend = this.Helpers.addUnit(s.minUnit, end, 1);\n\n\t\tif ((s && s.start > start) || s.end < end) {\n\t\t\tthis.setScales(\n\t\t\t\ts.start > start ? start : s.start,\n\t\t\t\ts.end < end ? end : s.end,\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n\t/**\n\t * Fills and returns tasks collection\n\t * @returns {object} tasks Tree Collection\n\t */\n\ttasks(force) {\n\t\tif (this._tasks && !force) return this._tasks;\n\n\t\tif (!this._tasks) {\n\t\t\tthis._tasks = this.createTasks();\n\t\t} else {\n\t\t\tthis._tasks.clearAll();\n\t\t}\n\n\t\tconst waitArr = [this.app.getService(\"backend\").tasks()];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.taskCalendarMap(false, force));\n\n\t\tthis._tasks.parse(\n\t\t\twebix.promise.all(waitArr).then(data => {\n\t\t\t\treturn this.app.getService(\"grouping\").getTreeData(data[0], 0);\n\t\t\t})\n\t\t);\n\t\treturn this._tasks;\n\t}\n\t/**\n\t * Creates tasks collection\n\t * @returns {object} empty tasks Tree Collection\n\t */\n\tcreateTasks() {\n\t\tconst ops = this.app.getService(\"operations\");\n\t\tconst tasks = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreLoad\": () => {\n\t\t\t\t\tif (!this.app.config.scaleStart) this.updateScaleMinMax(tasks);\n\t\t\t\t\ttasks.data.each(d => {\n\t\t\t\t\t\tif (this.app.config.projects && d.$count) d.type = \"project\";\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" ? id : null;\n\t\t\t\t\tthis.refreshTasks(id);\n\t\t\t\t\tthis.refreshLinks();\n\n\t\t\t\t\tif (!mode && this.state.criticalPath) {\n\t\t\t\t\t\tif (this.app.config.links)\n\t\t\t\t\t\t\tthis._links.waitData.then(() => this.showCriticalPath());\n\t\t\t\t\t\telse this.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tobj.start_date = webix.i18n.parseFormatDate(obj.start_date);\n\t\t\t\t\tobj.end_date = webix.i18n.parseFormatDate(obj.end_date);\n\t\t\t\t\tobj.type = obj.type || \"task\";\n\t\t\t\t\tif (!this.app.config.split && obj.type === \"split\") obj.type = \"task\";\n\n\t\t\t\t\tops.updateTaskDuration(obj);\n\n\t\t\t\t\tif (obj.planned_start) {\n\t\t\t\t\t\tobj.planned_start = webix.i18n.parseFormatDate(obj.planned_start);\n\t\t\t\t\t\tobj.planned_end = webix.i18n.parseFormatDate(obj.planned_end);\n\t\t\t\t\t\tops.updatePlannedTaskDuration(obj);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (obj.type === \"split\") {\n\t\t\t\t\t\tobj.open = obj.opened = 0;\n\t\t\t\t\t\tobj.$css = \"webix_gantt_split_task\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete obj.$css;\n\t\t\t\t\t\tobj.open = (obj.open || obj.opened) * 1 || 0;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"position\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t\t$serialize: data => this.taskOut(data),\n\t\t\t\t$export: data => this.taskOut(data),\n\t\t\t},\n\t\t});\n\n\t\treturn tasks;\n\t}\n\t/**\n\t * Re-paints all tasks in chart or, if theID is provided, a specific task\n\t * @param {string|number} updID - (optional) the ID of the task\n\t * @param {number} i - the index of the task\n\t */\n\trefreshTasks(updID, i) {\n\t\t// console.log(\"[x] render tasks\");\n\t\tif (!updID) {\n\t\t\tthis._tasks.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = this._tasks.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : this._tasks.getIndexById(updID);\n\t\t\t// type:\"split\" results in split kids missing in datastore.order\n\t\t\tif (i < 0) i = this._tasks.getIndexById(t.parent);\n\n\t\t\tif (t.type === \"split\") {\n\t\t\t\tt.$data = this._tasks\n\t\t\t\t\t.find(k => k.parent == t.id)\n\t\t\t\t\t.sort(\n\t\t\t\t\t\t(a, b) => b.start_date - a.start_date || b.end_date - a.end_date\n\t\t\t\t\t);\n\t\t\t}\n\t\t\tthis.Helpers.updateTask(t, i);\n\n\t\t\tif (this.state.baseline && t.planned_start) this.refreshBaseline(t, i);\n\t\t}\n\t}\n\n\t/**\n\t * Arranges task baseline\n\t * @param task {object} task object\n\t * @param i {number} task index\n\n\t */\n\trefreshBaseline(task, i) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis.Helpers.updateTask(t, i, this._scales, this._taskHeight);\n\t\ttask.$x0 = t.$x;\n\t\ttask.$w0 = t.$w;\n\t}\n\n\t/**\n\t * Fills and returns links collection\n\t * @returns {object} links Data Collection\n\t */\n\tlinks(force) {\n\t\tif (this._links && !force) return this._links;\n\n\t\tif (!this._links) {\n\t\t\tthis._links = this.createLinks();\n\t\t} else {\n\t\t\tthis._links.clearAll();\n\t\t}\n\n\t\tif (this.app.config.links)\n\t\t\tthis._links.parse(this.app.getService(\"backend\").links());\n\t\treturn this._links;\n\t}\n\t/**\n\t * Creates and returns links collection\n\t * @returns {object} empty links Data Collection\n\t */\n\tcreateLinks() {\n\t\treturn new webix.DataCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, v, mode) => {\n\t\t\t\t\t// do not refresh for initial data parsing\n\t\t\t\t\tif (mode) this.refreshLinks(id);\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$init: obj => {\n\t\t\t\t\tobj.type = obj.type * 1;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\t/**\n\t * Re-paints all links in chart\n\t * @param {(string|number)} id - (optional) the ID of a link\n\t */\n\trefreshLinks(id) {\n\t\tconst tasks = this.getVisibleTasksCollection();\n\t\tif (this._links && tasks) {\n\t\t\tthis._links.data.each(l => {\n\t\t\t\tconst s = tasks.getItem(l.source);\n\t\t\t\tconst e = tasks.getItem(l.target);\n\t\t\t\tif (!s || !e || !this._isTaskVisible(s) || !this._isTaskVisible(e))\n\t\t\t\t\tl.$p = \"\";\n\t\t\t\telse this.Helpers.updateLink(l, s, e);\n\t\t\t});\n\n\t\t\t// refresh the critical path if a link was added, updated or removed\n\t\t\tif (this.state.criticalPath && id) {\n\t\t\t\tthis.showCriticalPath();\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Returns all links of a particular type for the specified task\n\t * @param {string, number} id - task id\n\t * @param {type} type - link type, \"source\" or \"target\"\n\t * @returns {array} links array\n\t */\n\tgetLinks(id, type) {\n\t\tconst found = this._links.find(a => a[type] == id);\n\t\tconst res = [];\n\n\t\tfor (let i = 0; i < found.length; i++) {\n\t\t\tconst a = found[i];\n\t\t\tconst t = this._tasks.getItem(a[type == \"source\" ? \"target\" : \"source\"]);\n\t\t\tif (t)\n\t\t\t\tres.push({\n\t\t\t\t\tid: a.id,\n\t\t\t\t\ttype: a.type.toString(),\n\t\t\t\t\ttext: t.text,\n\t\t\t\t\tttype: type,\n\t\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\t/**\n\t * Prepares task data object for serializing and export\n\t * @param {Object} data - incoming task data object\n\t * @returns {Object} - processed task data object\n\t */\n\ttaskOut(data) {\n\t\tdata = webix.copy(data);\n\n\t\tconst format = this.dateToLocalStr;\n\t\tif (data.start_date) data.start_date = format(data.start_date);\n\t\tif (data.end_date) data.end_date = format(data.end_date);\n\n\t\t// clean $-fields\n\t\tfor (let k in data) {\n\t\t\tif (k.indexOf(\"$\") === 0) delete data[k];\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t/**\n\t * Checks whether the specified task is visible (all parents open)\n\t * @param {object} x - task object\n\t * @param {boolean} tcollection - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {boolean} task visibility\n\t */\n\t_isTaskVisible(x, tcollection) {\n\t\t// display: \"resources\" case to hide projects\n\t\tconst tasks = this.getVisibleTasksCollection(tcollection);\n\n\t\tconst taskParent = x.$parent;\n\t\tconst taskSplit = x.type === \"split\" && !x.open;\n\n\t\tif (taskSplit && !taskParent) return false;\n\t\twhile (x.$parent) {\n\t\t\tx = tasks.getItem(x.$parent);\n\t\t\tif (\n\t\t\t\t!((taskParent == x.id && x.type == \"split\") || x.open) ||\n\t\t\t\t(x.open && taskSplit)\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource categories collection\n\t * @returns {object} categories Data Collection\n\t */\n\tcategories(force) {\n\t\tif (this._categories && !force) return this._categories;\n\t\tif (!this._categories) {\n\t\t\tthis._categories = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._categories.clearAll();\n\t\t}\n\n\t\tthis._categories.parse(this.app.getService(\"backend\").categories());\n\t\treturn this._categories;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource collection\n\t * @returns {object} resources Data Collection\n\t */\n\tresources(force) {\n\t\tif (this._resources && !force) return this._resources;\n\n\t\tif (!this._resources) {\n\t\t\tthis._resources = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._resources.clearAll();\n\t\t}\n\n\t\tlet waitArr = [\n\t\t\tthis.app.getService(\"backend\").resources(),\n\t\t\tthis.categories(force).waitData,\n\t\t];\n\t\tif (this.app.config.resourceCalendars)\n\t\t\twaitArr.push(this.calendars(force).waitData);\n\n\t\tthis._resources.parse(\n\t\t\twebix.promise.all(waitArr).then(arr => {\n\t\t\t\tlet rData = arr[0];\n\t\t\t\trData.forEach(resource => {\n\t\t\t\t\tif (resource[\"category_id\"]) {\n\t\t\t\t\t\tconst ctg = this.categories().getItem(resource[\"category_id\"]);\n\t\t\t\t\t\tresource.category = ctg.name;\n\t\t\t\t\t\tif (!resource.unit && ctg.unit) resource.unit = ctg.unit;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\trData.sort(this.app.getService(\"operations\").sortResources);\n\t\t\t\treturn rData;\n\t\t\t})\n\t\t);\n\t\treturn this._resources;\n\t}\n\n\t/**\n\t * Creates, fills and returns resource-task relation collection\n\t * @returns {object} assignments Data Collection\n\t */\n\tassignments(force) {\n\t\tif (this._assignments && !force) return this._assignments;\n\n\t\tif (!this._assignments) {\n\t\t\tthis._assignments = new webix.DataCollection({});\n\t\t} else {\n\t\t\tthis._assignments.clearAll();\n\t\t}\n\n\t\tthis._assignments.parse(this.app.getService(\"backend\").assignments());\n\t\treturn this._assignments;\n\t}\n\n\t/**\n\t * Returns all resource assignments for the specified task\n\t * @param {string, number} id - a task id\n\t * @returns {array} an array of assignments extended with resource properties\n\t */\n\tgetAssignments(id) {\n\t\treturn webix.promise\n\t\t\t.all([this.resources().waitData, this.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst resources = this.resources();\n\t\t\t\tconst assigned = this.assignments().data.find(a => a.task == id);\n\t\t\t\treturn assigned.map(a => {\n\t\t\t\t\tlet aCopy = Object.assign({}, a);\n\t\t\t\t\tlet resource = Object.assign({}, resources.getItem(a.resource));\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\treturn Object.assign(aCopy, resource);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\t/**\n\t * Fills and returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars(force) {\n\t\tif (this._calendars && !force) return this._calendars;\n\n\t\tif (!this._calendars) {\n\t\t\tthis._calendars = this.createCalendars();\n\t\t} else {\n\t\t\tthis._calendars.clearAll();\n\t\t}\n\n\t\tthis._calendars.parse(this.app.getService(\"backend\").calendars());\n\t\treturn this._calendars;\n\t}\n\t/**\n\t * Creates calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcreateCalendars() {\n\t\treturn new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => {\n\t\t\t\t\tif (typeof obj.weekDays == \"string\")\n\t\t\t\t\t\tobj.weekDays = obj.weekDays.split(\",\").map(a => 1 * a);\n\t\t\t\t\tif (obj.holidays) {\n\t\t\t\t\t\tif (typeof obj.holidays == \"string\")\n\t\t\t\t\t\t\tobj.holidays = obj.holidays.split(\",\");\n\t\t\t\t\t\tobj.holidays = obj.holidays.map(d =>\n\t\t\t\t\t\t\twebix.Date.datePart(new Date(d))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Marks all tasks as critical or not\n\t * @param {Boolean} clean - pass true if you want to remove existing critical path markers\n\t */\n\tshowCriticalPath(clean) {\n\t\tif (clean) {\n\t\t\tthis._tasks.data.order.forEach(id => {\n\t\t\t\tconst task = this._tasks.getItem(id);\n\t\t\t\tdelete task.$critical;\n\t\t\t});\n\t\t} else {\n\t\t\tconst all = this._tasks.data.getRange().sort((a, b) => {\n\t\t\t\treturn (\n\t\t\t\t\tb.end_date - a.end_date ||\n\t\t\t\t\t(a.parent == b.id ? 1 : b.parent == a.id ? -1 : 0) ||\n\t\t\t\t\tb.start_date - a.start_date\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tlet latestDate = webix.Date.copy(all[0].end_date);\n\t\t\tall.forEach(task => {\n\t\t\t\ttask.$critical = this.isTaskCritical(task, latestDate);\n\t\t\t});\n\t\t}\n\t\tthis._tasks.data.callEvent(\"onStoreUpdated\", [null, null, \"paint\"]);\n\t}\n\t/**\n\t * Decides if a task is a part of the critical path\n\t * @param {Object} task - task data\n\t * @param {Date} latestDate - the date by which all tasks end\n\t * @returns {Boolean}\n\t */\n\tisTaskCritical(task, latestDate) {\n\t\tif (latestDate && webix.Date.equal(latestDate, task.end_date)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconst links = this._links.find(l => l.source == task.id && l.type == 0);\n\t\t\tfor (let i = 0; i < links.length; ++i) {\n\t\t\t\t// a task is critical if its end is linked to the start of a critical task\n\t\t\t\t// and there is no slack time between them\n\t\t\t\tconst dependent = this._tasks.getItem(links[i].target);\n\t\t\t\tif (\n\t\t\t\t\tdependent.$critical &&\n\t\t\t\t\tthis.isNoSlack(dependent.start_date, task.end_date, task.id)\n\t\t\t\t)\n\t\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (task.parent != 0) {\n\t\t\t\tconst parent = this._tasks.getItem(task.parent);\n\t\t\t\treturn parent.$critical && task.end_date >= parent.end_date;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Checks if there is slack between 2 linked tasks\n\t * @param {Date} nextStart - the start date of the next linked task\n\t * @param {Date} currentEnd - the end date of the currently checked task\n\t * @param {String} taskId - the id of the currently checked task (optional, resourceCalendar related)\n\t * @returns {Boolean} the result of the check; true if there is no slack\n\t */\n\tisNoSlack(nextStart, currentEnd, taskId) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tif (currentEnd >= nextStart) return true;\n\n\t\t\tfor (let date = webix.Date.copy(currentEnd); date < nextStart; ) {\n\t\t\t\tif (!this.isHoliday(date, taskId)) return false;\n\t\t\t\twebix.Date.add(date, 1, \"day\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn currentEnd >= nextStart;\n\t}\n\n\t/**\n\t * Decides if a link is a part of the critical path\n\t * @param {Object} link - the data object of a link\n\t * @returns {Boolean} the result of the check; true if the link connects critical tasks\n\t */\n\tisLinkCritical(link) {\n\t\tlet critical = false;\n\t\tif (link.type == 0) {\n\t\t\tconst tasks = this.tasks();\n\t\t\tconst s = tasks.getItem(link.source);\n\t\t\tconst t = tasks.getItem(link.target);\n\t\t\tcritical = s && t && s.$critical && t.$critical;\n\t\t}\n\t\treturn critical;\n\t}\n\n\t/**\n\t * Gets visible tasks collection\n\t * @param {boolean} tasks - if true, the method will return the main collection regardless of the current display mode\n\t * @returns {object} webix.TreeCollection\n\t */\n\tgetVisibleTasksCollection(tasks) {\n\t\tif (!tasks && this.state.display == \"resources\") {\n\t\t\tconst g = this.app.getService(\"grouping\");\n\t\t\treturn g ? g.getResourceTree() : null;\n\t\t}\n\t\treturn this._tasks;\n\t}\n\n\ttaskCalendarMap(now, force) {\n\t\tif (now) return this._calendarMap || null;\n\n\t\tif (!this._calendarMap) {\n\t\t\tthis.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.resources().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t\tthis.calendars().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\t\tthis.refreshCalendarMap();\n\t\t\t});\n\t\t}\n\n\t\tconst waitArr = [\n\t\t\tthis.assignments(force).waitData,\n\t\t\tthis.resources(force).waitData,\n\t\t];\n\n\t\t// forced from resources\n\t\tif (!force) {\n\t\t\twaitArr.push(this.calendars().waitData);\n\t\t}\n\n\t\treturn webix.promise.all(waitArr).then(() => {\n\t\t\tif (!this._calendarMap) this.refreshCalendarMap();\n\t\t\treturn this._calendarMap;\n\t\t});\n\t}\n\trefreshCalendarMap() {\n\t\tconst resources = this.resources();\n\t\tconst calendars = this.calendars();\n\t\tlet data = {};\n\t\tthis.assignments().data.each(obj => {\n\t\t\tconst resource = resources.getItem(obj.resource);\n\t\t\tif (resource) {\n\t\t\t\tconst id = resource.calendar_id;\n\t\t\t\tconst cal = id ? calendars.getItem(id) : null;\n\t\t\t\tif (cal && !data[obj.task]) data[obj.task] = cal;\n\t\t\t}\n\t\t});\n\t\treturn (this._calendarMap = data);\n\t}\n\n\tgetTaskCalendar(taskId) {\n\t\tconst map = this.taskCalendarMap(true);\n\t\treturn map ? map[taskId] : null;\n\t}\n\tisHoliday(date, taskId) {\n\t\tif (taskId && this._calendarMap) {\n\t\t\tconst calendar = this._calendarMap[taskId];\n\t\t\tif (calendar) return this.Helpers.isResourceHoliday(date, calendar);\n\t\t}\n\t\treturn this.app.config.isHoliday(date);\n\t}\n\n\t/**\n\t * Clears all existing data collections; resets aggregated data, state, and scales\n\t */\n\tclearAll() {\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\n\t\t\t\"tasks\",\n\t\t\t\"links\",\n\t\t\t\"resources\",\n\t\t\t\"categories\",\n\t\t\t\"assignments\",\n\t\t\t\"calendars\",\n\t\t];\n\n\t\tthis.state.$batch({\n\t\t\tedit: null,\n\t\t\tselected: null,\n\t\t\tsort: null,\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tconst rdCollection = grouping.getRDCollection();\n\t\t\trdCollection.clearAll();\n\t\t}\n\n\t\tif (this.app.config.resources) {\n\t\t\tconst rCollection = grouping.getResourceTree();\n\t\t\trCollection.clearAll();\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst key = \"_\" + name;\n\t\t\tif (this[key]) this[key].clearAll();\n\t\t});\n\n\t\tthis.resetScales();\n\t}\n\n\t/**\n\t * Completely reloads data in the component; repaints application with new data\n\t */\n\treload() {\n\t\tthis.clearAll();\n\n\t\tconst grouping = this.app.getService(\"grouping\");\n\t\tconst collections = [\"tasks\", \"links\"];\n\t\tconst waitArr = [];\n\n\t\tif (this.app.config.resources && !this.app.config.resourceCalendars) {\n\t\t\tcollections.push(\"resources\", \"assignments\");\n\t\t}\n\n\t\tcollections.forEach(name => {\n\t\t\tconst collection = this[name](true);\n\t\t\twaitArr.push(collection.waitData);\n\t\t});\n\n\t\tif (this.app.config.resourcesDiagram) {\n\t\t\tgrouping.getRDCollection(true);\n\t\t}\n\n\t\twebix.promise.all(waitArr).then(() => {\n\t\t\tthis.app.refresh();\n\t\t});\n\t}\n\tupdateScaleMinMax(tasks) {\n\t\tlet min = Infinity;\n\t\tlet max = -Infinity;\n\t\ttasks.data.each(d => {\n\t\t\tif (d.start_date < min) min = d.start_date;\n\t\t\tif (d.end_date > max) max = d.end_date;\n\t\t\tif (this.state.baseline && d.planned_start && d.planned_end) {\n\t\t\t\tif (d.planned_start < min) min = d.planned_start;\n\t\t\t\tif (d.planned_end > max) max = d.planned_end;\n\t\t\t}\n\t\t});\n\t\tif (typeof min === \"object\") {\n\t\t\tconst s = this.getScales();\n\t\t\tthis.setScales(\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, min, -1),\n\t\t\t\tthis.Helpers.addUnit(s.minUnit, max, 1),\n\t\t\t\ts.precise\n\t\t\t);\n\t\t}\n\t}\n}\n","export default class Backend {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t * @param {string} url - server url\n\t */\n\tconstructor(app, url) {\n\t\tthis.app = app;\n\t\tthis._url = url;\n\t}\n\t/**\n\t * Returns absolute url based on relative one\n\t * @param {string} path - relative url\n\t * @returns {string} absolute url\n\t */\n\turl(path) {\n\t\treturn this._url + path;\n\t}\n\t/**\n\t * Loads tasks\n\t * @returns {promise} promise that resolves with tasks array\n\t */\n\ttasks() {\n\t\treturn webix.ajax(this.url(\"tasks\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads links\n\t * @returns {promise} promise that resolves with links array\n\t */\n\tlinks() {\n\t\treturn webix.ajax(this.url(\"links\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resources\n\t * @returns {promise} promise that resolves with resources array\n\t */\n\tresources() {\n\t\treturn webix.ajax(this.url(\"resources\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads resource categories\n\t * @returns {promise} promise that resolves with categories data\n\t */\n\tcategories() {\n\t\treturn webix.ajax(this.url(\"categories\")).then(res => res.json());\n\t}\n\t/**\n\t * Loads task-resource data\n\t * @returns {promise} promise that resolves with array of task-resource assignments\n\t */\n\tassignments() {\n\t\treturn webix.ajax(this.url(\"assignments\")).then(res => res.json());\n\t}\n\t/**\n\t * Returns calendars collection for resources\n\t * @returns {object} calendars Data Collection\n\t */\n\tcalendars() {\n\t\treturn webix.ajax(this.url(\"calendars\")).then(res => res.json());\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - the relative position of the new task in a branch: \"first\", \"last\", \"after\"\n\t * @param {(string|number)} parent - parent task id, can be \"0\" for root\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddTask(obj, mode, parent) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"tasks\"), { ...obj, mode, parent })\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"tasks/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates task\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - object with task fields\n\t * @param {Boolean} split - flag that indicates that this is a splitting of a task\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\tupdateTask(id, obj, split) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + (split ? \"/split\" : \"\")), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\n\t/**\n\t * Changes order of tasks\n\t * @param {(string|number)} id - task id\n\t * @param {Object} obj - task position\n\t * @returns {Promise} promise that resolves with with server response\n\t */\n\treorderTask(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"tasks/\" + id + \"/position\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\taddLink(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"links\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with with server response\n\t */\n\tupdateLink(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"links/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"links/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Adds a new resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource task\n\t */\n\taddAssignment(obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.post(this.url(\"assignments\"), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Updates resource assignment\n\t * @param {string, number} id -  an id of a task resource record\n\t * @param {object} obj - an object with record fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.put(this.url(\"assignments/\" + id), obj)\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n\t/**\n\t * Removes resource assignment\n\t * @param {string, number} id - an id of an assignment record\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tremoveAssignment(id) {\n\t\tconst inProgress = webix\n\t\t\t.ajax()\n\t\t\t.del(this.url(\"assignments/\" + id))\n\t\t\t.then(res => res.json());\n\t\tthis.app.callEvent(\"backend:operation\", [inProgress]);\n\t\treturn inProgress;\n\t}\n}\n","export default class Operations {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis._local = this.app.getService(\"local\");\n\t\tthis._helpers = this.app.getService(\"helpers\");\n\t\tthis._back = this.app.getService(\"backend\");\n\t\tthis._state = this.app.getState();\n\t}\n\t/**\n\t * Adds task\n\t * @param {object} obj - object with task fields\n\t * @param {number} index - index within a parent branch, 0 or -1\n\t * @param {string, number} parent - parent task id, can be \"0\" for root\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @returns {promise} promise that resolves with task object\n\t */\n\taddTask(obj, index, parent, mode) {\n\t\tthis.updateTaskDuration(obj, mode);\n\t\tif (obj.planned_start) this.updatePlannedTaskDuration(obj, mode);\n\n\t\tconst addMode = index == 0 ? \"first\" : \"last\";\n\t\treturn this._back\n\t\t\t.addTask(this.cleanData(obj), addMode, parent)\n\t\t\t.then(added => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.add({ ...obj, id: added.id, parent }, index, parent);\n\n\t\t\t\treturn this.completeAdd(parent, added);\n\t\t\t});\n\t}\n\n\t/**\n\t * Splits a task via dnd (adds a subtask that will be rendered in the same line)\n\t * @param {Object} obj - data of a new subtask\n\t * @param {number} index - the index of a new subtask\n\t * @param {(string|number)} parent - the ID of the parent task\n\t * @param {Object} row - data of the parent task\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tsplitTaskWithDnd(obj, index, parent, row) {\n\t\tthis.updateTaskDuration(obj);\n\t\treturn this._back\n\t\t\t.updateTask(parent, { ...obj, position: index, parent }, true)\n\t\t\t.then(res => {\n\t\t\t\tthis._local.adjustScale(obj);\n\n\t\t\t\tconst tasks = this._local.tasks();\n\t\t\t\ttasks.updateItem(parent, {\n\t\t\t\t\ttype: \"split\",\n\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t});\n\t\t\t\tif (\n\t\t\t\t\t(res.sibling && res.sibling != 0) ||\n\t\t\t\t\t!tasks.find(t => t.parent == parent, true)\n\t\t\t\t) {\n\t\t\t\t\ttasks.add(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...row,\n\t\t\t\t\t\t\ttype: \"task\",\n\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\tid: res.sibling,\n\t\t\t\t\t\t\tduration: row.duration || 1,\n\t\t\t\t\t\t\tprogress: row.progress || 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tparent\n\t\t\t\t\t);\n\t\t\t\t\t++index;\n\t\t\t\t}\n\n\t\t\t\ttasks.add(\n\t\t\t\t\t{ ...obj, id: res.id, parent, position: index },\n\t\t\t\t\tindex,\n\t\t\t\t\tparent\n\t\t\t\t);\n\n\t\t\t\treturn this.completeAdd(parent, res, res.sibling);\n\t\t\t});\n\t}\n\n\t/**\n\t * Runs some common logic for add and split operations (see comments inside the method)\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @param {Object} added - server response (object like {id:\"some\", sibling:\"some\"} with task ids, sib;ing is optional)\n\t * @param {id} sibling - (optional) the ID of a first sibling added to split task that was ordinary before splitting\n\t * @returns {Promise<Object>} a promise that resolves with server response (object like {id:\"some\", sibling:\"some\"} with task ids)\n\t */\n\tcompleteAdd(parent, added, sibling) {\n\t\tif (parent) {\n\t\t\treturn this.syncProject(parent).then(() => {\n\t\t\t\t// critical path update\n\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\n\t\t\t\tif (sibling) added.sibling = sibling;\n\t\t\t\treturn added;\n\t\t\t});\n\t\t} else return webix.promise.resolve(added);\n\t}\n\n\t/**\n\t * Updates task\n\t * @param {string, number} id - task id\n\t * @param {object} obj - object with task fields\n\t * @param {string} mode - (optional) name of the change, \"move\", \"start\", \"end\" or \"duration\"\n\t * @param {boolean} inner - (optional) flag to mark inner logic call\n\t * @returns {promise} promise that resolves with task fields\n\t */\n\tupdateTask(id, obj, mode, inner) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst item = webix.copy(tasks.getItem(id));\n\t\tconst next = { ...item, ...obj };\n\n\t\tlet updateDates = !(\n\t\t\twebix.Date.equal(item.start_date, next.start_date) &&\n\t\t\twebix.Date.equal(item.end_date, next.end_date)\n\t\t);\n\t\tif (updateDates) {\n\t\t\tthis.updateTaskDuration(next, mode);\n\t\t}\n\t\tconst updatePlanned =\n\t\t\tnext.planned_start &&\n\t\t\t!(\n\t\t\t\twebix.Date.equal(item.planned_start, next.planned_start) &&\n\t\t\t\twebix.Date.equal(item.planned_end, next.planned_end)\n\t\t\t);\n\t\tif (updatePlanned) this.updatePlannedTaskDuration(next, mode);\n\n\t\tif (!inner && next.type == \"project\" && item.type != \"project\")\n\t\t\treturn this.syncProject(id, next);\n\n\t\treturn this._back.updateTask(id, this.cleanData(next)).then(() => {\n\t\t\t// scale must be updated before the task\n\t\t\tconst { start, end } = this._local.getScales();\n\t\t\tif (\n\t\t\t\tstart > next.start_date ||\n\t\t\t\tend < next.end_date ||\n\t\t\t\t(updatePlanned &&\n\t\t\t\t\t(start > next.planned_start || end < next.planned_end))\n\t\t\t)\n\t\t\t\tthis._local.adjustScale(next);\n\n\t\t\ttasks.updateItem(id, next);\n\n\t\t\tif (next.type != \"task\" && item.type == \"task\")\n\t\t\t\tthis.removeAssignments(next);\n\n\t\t\t//update dependent project or tasks\n\t\t\tif (\n\t\t\t\t!inner &&\n\t\t\t\t(updateDates ||\n\t\t\t\t\titem.progress != next.progress ||\n\t\t\t\t\titem.parent != next.parent)\n\t\t\t) {\n\t\t\t\tlet res;\n\t\t\t\tif (item.$count && item.type == \"project\")\n\t\t\t\t\tres = this.syncTasks(id, item.start_date, next.start_date).then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\treturn this.syncProject(item.parent);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\telse {\n\t\t\t\t\tif (item.parent != next.parent) {\n\t\t\t\t\t\tres = webix.promise.all([\n\t\t\t\t\t\t\tthis.syncProject(next.parent),\n\t\t\t\t\t\t\tthis.syncProject(item.parent),\n\t\t\t\t\t\t]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres = this.syncProject(next.parent);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// critical path update\n\t\t\t\tres.then(() => {\n\t\t\t\t\tif (this._state.criticalPath) {\n\t\t\t\t\t\ttasks.updateItem(id, { $critical: false });\n\t\t\t\t\t\tthis._local.showCriticalPath();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn next;\n\t\t});\n\t}\n\n\t/**\n\t * Normalizes task end_date and duration correspondence\n\t * @param {Object} task - a task\n\t * @param {string} mode - type of date data operation: \"move\", \"start\", \"end\", \"duration\", undefined\n\t */\n\tupdateTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tmode = mode == \"move\" ? \"start\" : mode;\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field =\n\t\t\t\t\tmode + (mode === \"start\" || mode === \"end\" ? \"_date\" : \"\");\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t\tif (mode != \"start\") mode = \"end\";\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._helpers.updateTaskDuration(task, scales, mode, dir);\n\t\t} else this._helpers.updateTaskDuration(task);\n\t}\n\n\tupdatePlannedTaskDuration(task, mode) {\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet dir;\n\t\t\tif (mode) {\n\t\t\t\tconst old = this._local.tasks().getItem(task.id);\n\t\t\t\tconst field = \"planned_\" + mode;\n\t\t\t\tdir = old[field] > task[field] ? -1 : 1;\n\t\t\t}\n\t\t\tlet scales = webix.copy(this._local.getScales());\n\t\t\tscales.isHoliday = date => {\n\t\t\t\treturn this._local.isHoliday(date, task.id);\n\t\t\t};\n\t\t\tthis._updatePlannedTaskDuration(task, scales, mode, dir);\n\t\t} else this._updatePlannedTaskDuration(task);\n\t}\n\t_updatePlannedTaskDuration(task, scales, mode, dir) {\n\t\tconst t = { ...task };\n\t\tt.start_date = task.planned_start;\n\t\tt.duration = task.planned_duration;\n\t\tt.end_date = task.planned_end;\n\t\tthis._helpers.updateTaskDuration(t, scales, mode, dir);\n\t\ttask.planned_start = t.start_date;\n\t\ttask.planned_end = t.end_date;\n\t\ttask.planned_duration = t.duration;\n\t}\n\n\t/**\n\t * Updates related tasks when project start changes\n\t * @param {string, number} id - project id\n\t * @param {Date} old - old start date\n\t * @param {Date} change - current start date\n\t */\n\tsyncTasks(id, old, change) {\n\t\tlet diff = change - old;\n\n\t\tif (this.app.config.excludeHolidays)\n\t\t\tdiff = this.getWorkDateDiff(diff, old, id);\n\n\t\tif (diff) {\n\t\t\tconst p = [];\n\t\t\tthis._local.tasks().data.eachSubItem(id, kid => {\n\t\t\t\tlet newDate = kid.start_date.valueOf() + diff;\n\t\t\t\tif (this.app.config.excludeHolidays) {\n\t\t\t\t\tconst delta =\n\t\t\t\t\t\tdiff - this.getWorkDateDiff(diff, kid.start_date, kid.id);\n\t\t\t\t\tif (delta) newDate = newDate + delta;\n\t\t\t\t}\n\n\t\t\t\tconst changedKid = {\n\t\t\t\t\t...kid,\n\t\t\t\t\tstart_date: new Date(newDate),\n\t\t\t\t\tend_date: null,\n\t\t\t\t};\n\n\t\t\t\tp.push(this.updateTask(kid.id, changedKid, \"move\", true));\n\t\t\t});\n\t\t\treturn webix.promise.all(p);\n\t\t}\n\n\t\treturn webix.promise.resolve();\n\t}\n\t/**\n\t * Extracts working days from date difference\n\t * @param {number} diff - difference in days, milliseconds\n\t * @param {Date} old - the original date\n\t * @param {string} taskId - a task id (optional, resourceCalendars related)\n\t * @returns {number} difference in working days in milliseconds\n\t */\n\tgetWorkDateDiff(diff, old, taskId) {\n\t\tconst dir = Math.sign(diff);\n\t\tconst dayLen = 86400000;\n\t\tconst ad = dir * Math.floor(diff / dayLen);\n\t\tfor (let i = 0, date = old; i < ad; ++i) {\n\t\t\twebix.Date.add(date, dir, \"day\");\n\t\t\tif (this._local.isHoliday(date, taskId)) diff = diff - dir * dayLen;\n\t\t}\n\t\treturn diff;\n\t}\n\n\t/**\n\t * Updates related project when task start or end date changes\n\t * @param {string, number} id - task id\n\t * @param {object} item - task object, if it is converted to project\n\t * @returns {Promise}\n\t */\n\tsyncProject(id, item) {\n\t\tconst tasks = this._local.tasks();\n\n\t\tif (!item) {\n\t\t\titem = tasks.getItem(id);\n\t\t\tif (this.app.config.projects && item && item.type != \"split\") {\n\t\t\t\titem.type = item.$count ? \"project\" : \"task\";\n\t\t\t\tthis.removeAssignments(item);\n\t\t\t} else {\n\t\t\t\twhile (item && item.type != \"project\") {\n\t\t\t\t\tid = tasks.getParentId(id);\n\t\t\t\t\titem = tasks.getItem(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (item && item.$count) {\n\t\t\titem = this.setProjectData(item);\n\t\t}\n\t\tif (item) {\n\t\t\treturn this.updateTask(id, item, \"start\", true).then(() => {\n\t\t\t\tthis.syncProject(item.parent);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t} else return webix.promise.resolve();\n\t}\n\t/**\n\t * Updates project with task-dependent data taken from tasks collection or an array of child items\n\t * @param {object} item - a project object\n\t * @param {Object} tasks collection (optional, local.tasks() by default)\n\t * @param {array} branch - an array of child items of a project (optional)\n\t */\n\tsetProjectData(item, tasks, branch) {\n\t\tif (!branch) item = webix.copy(item);\n\t\tlet min = Infinity,\n\t\t\tmax = 0,\n\t\t\tprogress = 0,\n\t\t\tduration = 0;\n\n\t\tconst handler = kid => {\n\t\t\tmin = kid.start_date < min ? kid.start_date : min;\n\t\t\tmax = kid.end_date > max ? kid.end_date : max;\n\t\t\tif (kid.duration && !(kid.type == \"project\" && kid.$count)) {\n\t\t\t\tprogress += kid.duration * kid.progress;\n\t\t\t\tduration += kid.duration * 1;\n\t\t\t}\n\t\t};\n\n\t\tif (branch) branch.forEach(handler);\n\t\telse {\n\t\t\tconst collection = tasks || this._local.tasks();\n\t\t\tcollection.data.eachSubItem(item.id, handler);\n\t\t}\n\n\t\tif (!webix.Date.equal(item.start_date, min)) {\n\t\t\titem.start_date = min;\n\t\t\titem.duration = null;\n\t\t}\n\t\tif (!webix.Date.equal(item.end_date, max)) {\n\t\t\titem.end_date = max;\n\t\t\titem.duration = null;\n\t\t}\n\t\titem.progress = progress ? Math.round(progress / duration) : progress;\n\t\treturn item;\n\t}\n\t/**\n\t * Updates task time after drag-n-drop\n\t * @param {string, number} id - task id\n\t * @param {string} mode - type of change: \"start\", \"end\" or \"move\"\n\t * @param {number} time - number of units by which task was shifted, can be negative\n\t * @returns {promise} promise that resolves with change object\n\t */\n\tupdateTaskTime(id, mode, time) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst task = tasks.getItem(id);\n\n\t\tconst obj = {};\n\t\tconst s = this._local.getScales();\n\n\t\tconst unit = s.precise\n\t\t\t? this._helpers.getSmallerUnit(s.minUnit)\n\t\t\t: s.minUnit;\n\t\tif (mode === \"start\" || mode === \"move\") {\n\t\t\tconst offsetDate = s.precise\n\t\t\t\t? task.start_date\n\t\t\t\t: this._helpers.getUnitStart(unit, task.start_date);\n\t\t\tobj.start_date = this._helpers.addUnit(unit, offsetDate, time);\n\t\t\tif (mode === \"start\" && obj.start_date > task.end_date)\n\t\t\t\tobj.start_date = this._helpers.addUnit(unit, task.end_date, -1);\n\t\t} else if (mode === \"end\") {\n\t\t\tconst us = this._helpers.getUnitStart(unit, task.end_date);\n\t\t\tconst offsetDate =\n\t\t\t\ts.precise || webix.Date.equal(us, task.end_date)\n\t\t\t\t\t? task.end_date\n\t\t\t\t\t: this._helpers.addUnit(unit, us, 1);\n\t\t\tobj.end_date = this._helpers.addUnit(unit, offsetDate, time);\n\n\t\t\tif (obj.end_date < task.start_date)\n\t\t\t\tobj.end_date = this._helpers.addUnit(unit, task.start_date, 1);\n\t\t}\n\n\t\tif (mode === \"move\") obj.end_date = null;\n\t\telse obj.duration = 0;\n\n\t\treturn this.updateTask(id, obj, mode);\n\t}\n\t/**\n\t * Removes task\n\t * @param {string, number} id - task id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveTask(id) {\n\t\tconst tasks = this._local.tasks();\n\t\tconst links = this._local.links();\n\n\t\t// [FIXME] - multiple redraw calls\n\t\tconst toRemove = links.find(a => a.source == id || a.target == id);\n\t\ttoRemove.forEach(a => links.remove(a.id));\n\n\t\treturn this._back.removeTask(id).then(res => {\n\t\t\tconst parent = tasks.getItem(id).parent;\n\t\t\ttasks.remove(id);\n\n\t\t\tif (\n\t\t\t\tthis.app.config.split &&\n\t\t\t\tparent != 0 &&\n\t\t\t\ttasks.getItem(parent).type === \"split\" &&\n\t\t\t\t!tasks.find(k => k.parent == parent, true)\n\t\t\t) {\n\t\t\t\treturn this.updateTask(parent, { type: \"task\" }).then(() => {\n\t\t\t\t\treturn this.completeRemoval(res, parent);\n\t\t\t\t});\n\t\t\t} else return this.completeRemoval(res, parent);\n\t\t});\n\t}\n\t/**\n\t * Synchronizes project and updates critical path after a task is removed\n\t * @param {Object} res - server response\n\t * @param {(string|number)} parent - the ID of a parent task\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tcompleteRemoval(res, parent) {\n\t\treturn this.syncProject(parent).then(() => {\n\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Adds a link\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with link object\n\t */\n\taddLink(obj) {\n\t\tif (!this.linkExists(obj)) {\n\t\t\treturn this._back.addLink(obj).then(added => {\n\t\t\t\tobj.id = added.id;\n\t\t\t\tthis._local.links().add(obj);\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.reject();\n\t}\n\n\t/**\n\t * Checks if two tasks are already connected by a link of the same type\n\t * @param {Object} obj - the data object of a link\n\t * @returns {Object, null} - the data object of the link that was found; null if nothing was found\n\t */\n\tlinkExists(obj) {\n\t\treturn this._local.links().find(l => {\n\t\t\treturn (\n\t\t\t\tl.target == obj.target && l.source == obj.source && l.type == obj.type\n\t\t\t);\n\t\t}, true);\n\t}\n\n\t/**\n\t * Updates a link\n\t * @param {string, number} id - link id\n\t * @param {object} obj - object with link fields\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tupdateLink(id, obj) {\n\t\treturn this._back.updateLink(id, obj).then(res => {\n\t\t\tconst links = this._local.links();\n\t\t\tconst duplicate = this.linkExists({ ...links.getItem(id), ...obj });\n\t\t\tlinks.updateItem(id, obj);\n\t\t\tif (duplicate) {\n\t\t\t\treturn this.removeLink(duplicate.id).then(() => res);\n\t\t\t} else return res;\n\t\t});\n\t}\n\t/**\n\t * Removes link\n\t * @param {string, number} id - link id\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveLink(id) {\n\t\treturn this._back.removeLink(id).then(res => {\n\t\t\tthis._local.links().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Moves the task to a new position within the task tree\n\t * @param {string, number} id - the ID of the task\n\t * @param {string, number} parent - the ID of the parent/branch (0 for root)\n\t * @param {number} index - the position within the target branch or root (starting from 0)\n\t * @returns {Promise} - the promise of data operation\n\t */\n\tmoveTask(id, parent, index) {\n\t\tparent = parent || 0;\n\n\t\tconst tasks = this._local.tasks();\n\t\tconst branch = tasks.data.branch[parent];\n\t\tconst oldParent = tasks.getItem(id).parent;\n\t\tconst oldIndex = tasks.data.getBranchIndex(id);\n\t\tif (\n\t\t\tparent == oldParent &&\n\t\t\t(index === oldIndex || (index === -1 && id === branch[branch.length - 1]))\n\t\t)\n\t\t\treturn webix.promise.reject();\n\n\t\ttasks.move(id, index, null, { parent });\n\n\t\treturn this._back\n\t\t\t.reorderTask(id, {\n\t\t\t\tparent,\n\t\t\t\tmode: index === 0 ? \"first\" : index === -1 ? \"last\" : \"after\",\n\t\t\t\ttarget: tasks.data.branch[parent][index - 1],\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tif (parent !== oldParent) {\n\t\t\t\t\ttasks.updateItem(id, { parent });\n\n\t\t\t\t\treturn webix.promise\n\t\t\t\t\t\t.all([this.syncProject(parent), this.syncProject(oldParent)])\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (this._state.criticalPath) this._local.showCriticalPath();\n\t\t\t\t\t\t\treturn res;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t});\n\t}\n\t/**\n\t * Updates a resource assignment\n\t * @param {string, number} id -  an id of a resource assignment\n\t * @param {object} obj - an object with updated fields\n\t * @returns {promise} a promise that is resolved with server response\n\t */\n\tupdateAssignment(id, obj) {\n\t\treturn this._back.updateAssignment(id, obj).then(res => {\n\t\t\tthis._local.assignments().updateItem(id, obj);\n\t\t\treturn res;\n\t\t});\n\t}\n\t/**\n\t * Assigns a resource assignment to a task\n\t * @param {object} obj - an object with \"task\", \"resource\" and \"value\" fields\n\t * @returns {promise} a promise that is resolved with an object of a resource assignment\n\t */\n\taddAssignment(obj) {\n\t\treturn this._back.addAssignment(obj).then(added => {\n\t\t\tobj.id = added.id;\n\t\t\tthis._local.assignments().add(obj);\n\t\t\treturn obj;\n\t\t});\n\t}\n\t/**\n\t * Removes a resource assignment\n\t * @param {string, number} id - an id of a resource assignment\n\t * @returns {promise} promise that resolves with server response\n\t */\n\tremoveAssignment(id) {\n\t\treturn this._back.removeAssignment(id).then(res => {\n\t\t\tthis._local.assignments().remove(id);\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/**\n\t * Sorts resources\n\t * @param {object} a - a resource to compare\n\t * @param {object} b - a resource to compare\n\t * @returns {number}\n\t */\n\tsortResources(a, b) {\n\t\tif (a.category == b.category) return a.name > b.name ? 1 : -1;\n\t\treturn a.category > b.category ? 1 : -1;\n\t}\n\n\t/**\n\t * Removes all assignments (if any) from a task\n\t * @param {object} task - task object\n\t * @returns {Promise}\n\t */\n\tremoveAssignments(task) {\n\t\tif (this.app.config.resources) {\n\t\t\tconst collection = this._local.assignments();\n\t\t\tlet waitArr = [];\n\t\t\treturn collection.waitData.then(() => {\n\t\t\t\tcollection.data.each(item => {\n\t\t\t\t\tif (item.task == task.id)\n\t\t\t\t\t\twaitArr.push(this.removeAssignment(item.id));\n\t\t\t\t});\n\t\t\t\tif (waitArr.length) return webix.promise.all(waitArr);\n\t\t\t\treturn webix.promise.resolve(false);\n\t\t\t});\n\t\t}\n\t\treturn webix.promise.resolve(false);\n\t}\n\n\t/**\n\t * Cleans task data from all $-fields, they are functional and locally used and should not be sent to backend\n\t * */\n\tcleanData(obj) {\n\t\tconst res = {};\n\t\tfor (let key in obj) {\n\t\t\tif (key.indexOf(\"$\") !== 0) res[key] = obj[key];\n\t\t}\n\t\treturn res;\n\t}\n\n\tupdateAssignedTaskDates(task) {\n\t\tconst obj = webix.copy(task);\n\t\tthis.updateTaskDuration(obj);\n\t\tconst updateDates = !(\n\t\t\twebix.Date.equal(task.start_date, obj.start_date) &&\n\t\t\twebix.Date.equal(task.end_date, obj.end_date)\n\t\t);\n\t\tif (updateDates) this.updateTask(task.id, obj, null, true);\n\t}\n}\n","function toInteger(dirtyNumber) {\n  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {\n    return NaN;\n  }\n\n  var number = Number(dirtyNumber);\n\n  if (isNaN(number)) {\n    return number;\n  }\n\n  return number < 0 ? Math.ceil(number) : Math.floor(number);\n}\n\nfunction requiredArgs(required, args) {\n  if (args.length < required) {\n    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');\n  }\n}\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\n\nfunction toDate(argument) {\n  requiredArgs(1, arguments);\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}\n\n/**\n * @name addDays\n * @category Day Helpers\n * @summary Add the specified number of days to the given date.\n *\n * @description\n * Add the specified number of days to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of days to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} - the new date with the days added\n * @throws {TypeError} - 2 arguments required\n *\n * @example\n * // Add 10 days to 1 September 2014:\n * const result = addDays(new Date(2014, 8, 1), 10)\n * //=> Thu Sep 11 2014 00:00:00\n */\n\nfunction addDays(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 days, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  date.setDate(date.getDate() + amount);\n  return date;\n}\n\n/**\n * @name addMonths\n * @category Month Helpers\n * @summary Add the specified number of months to the given date.\n *\n * @description\n * Add the specified number of months to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of months to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the months added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 months to 1 September 2014:\n * const result = addMonths(new Date(2014, 8, 1), 5)\n * //=> Sun Feb 01 2015 00:00:00\n */\n\nfunction addMonths(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var amount = toInteger(dirtyAmount);\n\n  if (isNaN(amount)) {\n    return new Date(NaN);\n  }\n\n  if (!amount) {\n    // If 0 months, no-op to avoid changing times in the hour before end of DST\n    return date;\n  }\n\n  var dayOfMonth = date.getDate(); // The JS Date object supports date math by accepting out-of-bounds values for\n  // month, day, etc. For example, new Date(2020, 0, 0) returns 31 Dec 2019 and\n  // new Date(2020, 13, 1) returns 1 Feb 2021.  This is *almost* the behavior we\n  // want except that dates will wrap around the end of a month, meaning that\n  // new Date(2020, 13, 31) will return 3 Mar 2021 not 28 Feb 2021 as desired. So\n  // we'll default to the end of the desired month by adding 1 to the desired\n  // month and using a date of 0 to back up one day to the end of the desired\n  // month.\n\n  var endOfDesiredMonth = new Date(date.getTime());\n  endOfDesiredMonth.setMonth(date.getMonth() + amount + 1, 0);\n  var daysInMonth = endOfDesiredMonth.getDate();\n\n  if (dayOfMonth >= daysInMonth) {\n    // If we're already at the end of the month, then this is the correct date\n    // and we're done.\n    return endOfDesiredMonth;\n  } else {\n    // Otherwise, we now know that setting the original day-of-month value won't\n    // cause an overflow, so set the desired day-of-month. Note that we can't\n    // just set the date of `endOfDesiredMonth` because that object may have had\n    // its time changed in the unusual case where where a DST transition was on\n    // the last day of the month and its local time was in the hour skipped or\n    // repeated next to a DST transition.  So we use `date` instead which is\n    // guaranteed to still have the original time.\n    date.setFullYear(endOfDesiredMonth.getFullYear(), endOfDesiredMonth.getMonth(), dayOfMonth);\n    return date;\n  }\n}\n\n/**\n * @name addMilliseconds\n * @category Millisecond Helpers\n * @summary Add the specified number of milliseconds to the given date.\n *\n * @description\n * Add the specified number of milliseconds to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the milliseconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 750 milliseconds to 10 July 2014 12:45:30.000:\n * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:30.750\n */\n\nfunction addMilliseconds(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var timestamp = toDate(dirtyDate).getTime();\n  var amount = toInteger(dirtyAmount);\n  return new Date(timestamp + amount);\n}\n\nvar MILLISECONDS_IN_HOUR = 3600000;\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * const result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\n\nfunction addHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_HOUR);\n}\n\n/**\n * @name startOfWeek\n * @category Week Helpers\n * @summary Return the start of a week for the given date.\n *\n * @description\n * Return the start of a week for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Date} the start of a week\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // The start of a week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sun Aug 31 2014 00:00:00\n *\n * @example\n * // If the week starts on Monday, the start of the week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Mon Sep 01 2014 00:00:00\n */\n\nfunction startOfWeek(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = date.getDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setDate(date.getDate() - diff);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nfunction getTimezoneOffsetInMilliseconds(date) {\n  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));\n  utcDate.setUTCFullYear(date.getFullYear());\n  return date.getTime() - utcDate.getTime();\n}\n\n/**\n * @name startOfDay\n * @category Day Helpers\n * @summary Return the start of a day for the given date.\n *\n * @description\n * Return the start of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the start of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The start of a day for 2 September 2014 11:55:00:\n * const result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 00:00:00\n */\n\nfunction startOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nvar MILLISECONDS_IN_DAY = 86400000;\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar days\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\n\nfunction differenceInCalendarDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var startOfDayLeft = startOfDay(dirtyDateLeft);\n  var startOfDayRight = startOfDay(dirtyDateRight);\n  var timestampLeft = startOfDayLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfDayLeft);\n  var timestampRight = startOfDayRight.getTime() - getTimezoneOffsetInMilliseconds(startOfDayRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a day is not constant\n  // (e.g. it's different in the day of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_DAY);\n}\n\nvar MILLISECONDS_IN_MINUTE = 60000;\n/**\n * @name addMinutes\n * @category Minute Helpers\n * @summary Add the specified number of minutes to the given date.\n *\n * @description\n * Add the specified number of minutes to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of minutes to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the minutes added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 30 minutes to 10 July 2014 12:00:00:\n * const result = addMinutes(new Date(2014, 6, 10, 12, 0), 30)\n * //=> Thu Jul 10 2014 12:30:00\n */\n\nfunction addMinutes(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_MINUTE);\n}\n\n/**\n * @name addQuarters\n * @category Quarter Helpers\n * @summary Add the specified number of year quarters to the given date.\n *\n * @description\n * Add the specified number of year quarters to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of quarters to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the quarters added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 1 quarter to 1 September 2014:\n * const result = addQuarters(new Date(2014, 8, 1), 1)\n * //=> Mon Dec 01 2014 00:00:00\n */\n\nfunction addQuarters(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var months = amount * 3;\n  return addMonths(dirtyDate, months);\n}\n\n/**\n * @name addWeeks\n * @category Week Helpers\n * @summary Add the specified number of weeks to the given date.\n *\n * @description\n * Add the specified number of week to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of weeks to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the weeks added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 4 weeks to 1 September 2014:\n * const result = addWeeks(new Date(2014, 8, 1), 4)\n * //=> Mon Sep 29 2014 00:00:00\n */\n\nfunction addWeeks(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  var days = amount * 7;\n  return addDays(dirtyDate, days);\n}\n\n/**\n * @name addYears\n * @category Year Helpers\n * @summary Add the specified number of years to the given date.\n *\n * @description\n * Add the specified number of years to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of years to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the years added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 5 years to 1 September 2014:\n * const result = addYears(new Date(2014, 8, 1), 5)\n * //=> Sun Sep 01 2019 00:00:00\n */\n\nfunction addYears(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMonths(dirtyDate, amount * 12);\n}\n\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the first date to compare\n * @param {Date|Number} dateRight - the second date to compare\n * @returns {Number} the result of the comparison\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\n\nfunction compareAsc(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var diff = dateLeft.getTime() - dateRight.getTime();\n\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1; // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}\n\n/**\n * Days in 1 week.\n *\n * @name daysInWeek\n * @constant\n * @type {number}\n * @default\n */\n/**\n * Milliseconds in 1 minute\n *\n * @name millisecondsInMinute\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInMinute = 60000;\n/**\n * Milliseconds in 1 hour\n *\n * @name millisecondsInHour\n * @constant\n * @type {number}\n * @default\n */\n\nvar millisecondsInHour = 3600000;\n\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nfunction differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}\n\nvar MILLISECONDS_IN_WEEK = 604800000;\n/**\n * @name differenceInCalendarWeeks\n * @category Week Helpers\n * @summary Get the number of calendar weeks between the given dates.\n *\n * @description\n * Get the number of calendar weeks between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Number} the number of calendar weeks\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // How many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5)\n * )\n * //=> 3\n *\n * @example\n * // If the week starts on Monday,\n * // how many calendar weeks are between 5 July 2014 and 20 July 2014?\n * const result = differenceInCalendarWeeks(\n *   new Date(2014, 6, 20),\n *   new Date(2014, 6, 5),\n *   { weekStartsOn: 1 }\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarWeeks(dirtyDateLeft, dirtyDateRight, dirtyOptions) {\n  requiredArgs(2, arguments);\n  var startOfWeekLeft = startOfWeek(dirtyDateLeft, dirtyOptions);\n  var startOfWeekRight = startOfWeek(dirtyDateRight, dirtyOptions);\n  var timestampLeft = startOfWeekLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekLeft);\n  var timestampRight = startOfWeekRight.getTime() - getTimezoneOffsetInMilliseconds(startOfWeekRight); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_WEEK);\n}\n\n/**\n * @name differenceInCalendarYears\n * @category Year Helpers\n * @summary Get the number of calendar years between the given dates.\n *\n * @description\n * Get the number of calendar years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInCalendarYears(\n *   new Date(2015, 1, 11),\n *   new Date(2013, 11, 31)\n * )\n * //=> 2\n */\n\nfunction differenceInCalendarYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  return dateLeft.getFullYear() - dateRight.getFullYear();\n}\n\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\n\nfunction differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}\n\nvar roundingMap = {\n  ceil: Math.ceil,\n  round: Math.round,\n  floor: Math.floor,\n  trunc: function (value) {\n    return value < 0 ? Math.ceil(value) : Math.floor(value);\n  } // Math.trunc is not supported by IE\n\n};\nvar defaultRoundingMethod = 'trunc';\nfunction getRoundingMethod(method) {\n  return method ? roundingMap[method] : roundingMap[defaultRoundingMethod];\n}\n\n/**\n * @name differenceInHours\n * @category Hour Helpers\n * @summary Get the number of hours between the given dates.\n *\n * @description\n * Get the number of hours between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of hours\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many hours are between 2 July 2014 06:50:00 and 2 July 2014 19:00:00?\n * const result = differenceInHours(\n *   new Date(2014, 6, 2, 19, 0),\n *   new Date(2014, 6, 2, 6, 50)\n * )\n * //=> 12\n */\n\nfunction differenceInHours(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInHour;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInMinutes\n * @category Minute Helpers\n * @summary Get the number of minutes between the given dates.\n *\n * @description\n * Get the signed number of full (rounded towards 0) minutes between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of minutes\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many minutes are between 2 July 2014 12:07:59 and 2 July 2014 12:20:00?\n * const result = differenceInMinutes(\n *   new Date(2014, 6, 2, 12, 20, 0),\n *   new Date(2014, 6, 2, 12, 7, 59)\n * )\n * //=> 12\n *\n * @example\n * // How many minutes are between 10:01:59 and 10:00:00\n * const result = differenceInMinutes(\n *   new Date(2000, 0, 1, 10, 0, 0),\n *   new Date(2000, 0, 1, 10, 1, 59)\n * )\n * //=> -1\n */\n\nfunction differenceInMinutes(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInMinute;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\n\nfunction endOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\n\nfunction endOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var month = date.getMonth();\n  date.setFullYear(date.getFullYear(), month + 1, 0);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}\n\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to check\n * @returns {Boolean} the date is the last day of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * var result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\n\nfunction isLastDayOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  return endOfDay(date).getTime() === endOfMonth(date).getTime();\n}\n\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates using trunc as a default rounding method.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\n\nfunction differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  var result; // Check for the difference of less than month\n\n  if (difference < 1) {\n    result = 0;\n  } else {\n    if (dateLeft.getMonth() === 1 && dateLeft.getDate() > 27) {\n      // This will check if the date is end of Feb and assign a higher end of month date\n      // to compare it with Jan\n      dateLeft.setDate(30);\n    }\n\n    dateLeft.setMonth(dateLeft.getMonth() - sign * difference); // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n    // If so, result must be decreased by 1 in absolute value\n\n    var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign; // Check for cases of one full calendar month\n\n    if (isLastDayOfMonth(toDate(dirtyDateLeft)) && difference === 1 && compareAsc(dirtyDateLeft, dateRight) === 1) {\n      isLastMonthNotFull = false;\n    }\n\n    result = sign * (difference - Number(isLastMonthNotFull));\n  } // Prevent negative zero\n\n\n  return result === 0 ? 0 : result;\n}\n\n/**\n * @name differenceInQuarters\n * @category Quarter Helpers\n * @summary Get the number of quarters between the given dates.\n *\n * @description\n * Get the number of quarters between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of full quarters\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full quarters are between 31 December 2013 and 2 July 2014?\n * const result = differenceInQuarters(new Date(2014, 6, 2), new Date(2013, 11, 31))\n * //=> 2\n */\n\nfunction differenceInQuarters(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMonths(dateLeft, dateRight) / 3;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}\n\n/**\n * @name differenceInYears\n * @category Year Helpers\n * @summary Get the number of full years between the given dates.\n *\n * @description\n * Get the number of full years between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInYears(new Date(2015, 1, 11), new Date(2013, 11, 31))\n * //=> 1\n */\n\nfunction differenceInYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarYears(dateLeft, dateRight)); // Set both dates to a valid leap year for accurate comparison when dealing\n  // with leap days\n\n  dateLeft.setFullYear(1584);\n  dateRight.setFullYear(1584); // Math.abs(diff in full years - diff in calendar years) === 1 if last calendar year is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastYearNotFull = compareAsc(dateLeft, dateRight) === -sign;\n  var result = sign * (difference - Number(isLastYearNotFull)); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}\n\nfunction getDatePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    // workaround for non-existent hours\n    const d = new Date(date.valueOf());\n    d.setHours(0);\n    if (d.getDate() != date.getDate()) {\n        date.setHours(1);\n    }\n    else {\n        date.setHours(0);\n    }\n    date.setMinutes(0);\n    date.setSeconds(0);\n    date.setMilliseconds(0);\n    return date;\n}\nfunction getTimePart(date, copy) {\n    if (copy)\n        date = new Date(date.valueOf());\n    return (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n}\nfunction differenceInWeeks(a, b, startOnMonday) {\n    const weekStartsOn = startOnMonday ? 1 : 0;\n    return differenceInCalendarWeeks(a, b, { weekStartsOn });\n}\nfunction getDay(date, startOnMonday) {\n    let shift = date.getDay();\n    if (startOnMonday) {\n        if (shift === 0)\n            shift = 6;\n        else\n            shift--;\n    }\n    return shift;\n}\n\nconst diff = {\n    year: differenceInYears,\n    quarter: differenceInQuarters,\n    month: differenceInMonths,\n    week: differenceInWeeks,\n    day: differenceInCalendarDays,\n    hour: differenceInHours,\n    minute: differenceInMinutes,\n};\nfunction countDaysInMonth(date) {\n    if (!date)\n        return 30;\n    const m = date.getMonth();\n    if (m === 1) {\n        const y = date.getFullYear();\n        if (y % 4)\n            return 28;\n        if (y % 100)\n            return 29;\n        if (y % 400)\n            return 28;\n        return 29;\n    }\n    if ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\n        return 30;\n    }\n    return 31;\n}\nconst smallerCount = {\n    year: [\"quarter\", 4],\n    quarter: [\"month\", 3],\n    month: [\"day\", countDaysInMonth],\n    week: [\"day\", 7],\n    day: [\"hour\", 24],\n    hour: [\"minute\", 60],\n    minute: [\"minute\", 1],\n};\nconst add = {\n    year: addYears,\n    quarter: addQuarters,\n    month: addMonths,\n    week: addWeeks,\n    day: addDays,\n    hour: addHours,\n    minute: addMinutes,\n};\n/**\n * Calculates the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @param {Date} next - a later date\n * @param {Date} prev - an earlier date\n * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\n * @param {boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - an int (if precise is false) or a float number\n */\nfunction innerDiff(unit, next, prev, startOnMonday, precise, wt) {\n    let minUnit = unit;\n    if (precise) {\n        const u = smallerCount[unit][0];\n        if (typeof u !== \"number\" && typeof u !== \"function\")\n            minUnit = u;\n    }\n    let start = prev;\n    let end = next;\n    if (wt) {\n        start = getUnitStart(minUnit, start, startOnMonday);\n        end = getUnitStart(minUnit, end, startOnMonday);\n        if (end < next)\n            end = addUnit(minUnit)(end, 1);\n    }\n    if (precise) {\n        const filled = diff[minUnit](end, start);\n        const count = smallerCount[unit][1];\n        let all = 0;\n        if (typeof count === \"function\")\n            all = count(prev);\n        else if (typeof count === \"number\")\n            all = count;\n        return filled / all;\n    }\n    else {\n        return diff[minUnit](end, start, startOnMonday);\n    }\n}\n/**\n * Returns a function for calculating the difference between two dates in units\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\n * @returns {function} - details below\n */\nfunction getDiff(unit) {\n    /**\n     * the returned function calculates the difference between two dates based on passed parameters\n     * @param {Date} next - first date\n     * @param {Date} prev - second date\n     * @param {boolean} startOnMonday - true if week starts on Monday, false otherwise\n     * @param {boolean} precise false by default, true when used to count x-position\n     * and width of tasks with 'step-1' precision\n     * @param {boolean} wt - marker that diff is used to count width of a task;\n     * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\n     * and will be displayed incorrectly\n     * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\n     */\n    return (next, prev, startOnMonday, precise, wt) => {\n        if (unit === \"month\" && precise) {\n            return getMonthDayDiff(next, prev, wt);\n        }\n        else {\n            return innerDiff(unit, next, prev, startOnMonday, precise, wt);\n        }\n    };\n}\n/**\n * Calculates the difference in months between two days for a scale with precision setting\n * This is a specific case of diff counting, because a month can have 28-31 days\n * @param {Date} end - a later date\n * @param {Date} start - an earlier date\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\n * @returns {number} - a float number\n */\nfunction getMonthDayDiff(end, start, wt) {\n    if (sameMonth(start, end)) {\n        return innerDiff(\"month\", end, start, null, true, wt);\n    }\n    // if starts not on 1st day\n    let daysOfFirstMonth = 0;\n    if (start.getDate() > 1) {\n        const me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\n        daysOfFirstMonth = innerDiff(\"month\", me, start, null, true);\n        start = me;\n    }\n    // if lasts 1+ whole months\n    let months = 0;\n    if (!sameMonth(start, end)) {\n        months = innerDiff(\"month\", getUnitStart(\"month\", end), start); // int part\n        start = addUnit(\"month\")(start, months);\n    }\n    // all above plus days of last month if any\n    return daysOfFirstMonth + months + innerDiff(\"month\", end, start, null, true);\n}\nfunction sameMonth(a, b) {\n    return (getUnitStart(\"month\", a).valueOf() === getUnitStart(\"month\", b).valueOf());\n}\nfunction addUnit(unit) {\n    return add[unit];\n}\nfunction getUnitStart(unit, start, startOnMonday) {\n    let t;\n    switch (unit) {\n        case \"year\":\n            return new Date(start.getFullYear(), 0, 1);\n        case \"quarter\":\n            return new Date(start.getFullYear(), Math.floor(start.getMonth() / 3) * 3, 1);\n        case \"month\":\n            return new Date(start.getFullYear(), start.getMonth(), 1);\n        case \"week\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setDate(start.getDate() - getDay(start, startOnMonday));\n            return t;\n        case \"day\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(0, 0, 0, 0);\n            return t;\n        case \"hour\":\n            t = new Date(start.getFullYear(), start.getMonth(), start.getDate());\n            t.setHours(start.getHours(), 0, 0, 0);\n            return t;\n        default:\n            return new Date(start);\n    }\n}\n\nfunction getMinUnit(scales) {\n    const start = new Date();\n    return scales\n        .map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\n        .sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\n}\n/**\n * Resets scales to new parameters and returns the object that stores related constants and functions\n * @param {Date} start - start date\n * @param {Date} end - end date\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\n * @param {number} width - width of smallest cell unit\n * @param {number} height - height of scale cell\n * @param {Array} scales - a set of scales (objects)\n * @param {function} isHoliday - the function that checks if a day is a holiday\n * @param {boolean} startOnMonday - flag that defines whether the week starts on Monday\n * @returns {Object} scales\n */\nfunction resetScales(start, end, precise, width, height, scales, isHoliday, startOnMonday) {\n    // console.log(\"[x] reset scales\");\n    const minUnit = getMinUnit(scales);\n    const diff = getDiff(minUnit);\n    const tempEnd = getUnitStart(minUnit, end, startOnMonday);\n    start = getUnitStart(minUnit, start, startOnMonday);\n    end = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\n    const fullWidth = diff(end, start, startOnMonday) * width;\n    const fullHeight = height * scales.length;\n    const rows = scales.map(line => {\n        const cells = [];\n        const add = addUnit(line.unit);\n        const step = line.step || 1;\n        const countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\n        let date = getUnitStart(line.unit, start, startOnMonday);\n        while (date < end) {\n            let next = add(date, step);\n            if (date < start)\n                date = start;\n            if (next > end)\n                next = end;\n            /**\n             * Special handling for counting width of greater units in weeks\n             * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\n             * if start day is Thursday+, then this greater unit should not count this week as its own\n             * if end day is Thursday+, then this greater unit should count this week as its own\n             */\n            let cdate = date;\n            let cnext = next;\n            if (countInWeeks) {\n                if (getDay(date, startOnMonday) > 3) {\n                    cdate = addUnit(\"week\")(date, 1);\n                }\n                if (getDay(next, startOnMonday) > 3) {\n                    cnext = addUnit(\"week\")(next, 1);\n                }\n            }\n            const cellWidth = (diff(cnext, cdate, startOnMonday) || 1) * width;\n            let css = \"\";\n            if (line.css)\n                css += typeof line.css === \"function\" ? line.css(date) : line.css;\n            cells.push({\n                width: cellWidth,\n                css,\n                date,\n                format: line.format,\n            });\n            date = next;\n        }\n        return { cells, add, height, type: line.unit, step: line.step || 1 };\n    });\n    precise = !!(minUnit === \"day\" ? precise : precise != false);\n    return {\n        rows,\n        width: fullWidth,\n        height: fullHeight,\n        cellWidth: width,\n        cellHeight: height,\n        diff,\n        start,\n        end,\n        minUnit,\n        precise,\n        isHoliday,\n        startOnMonday,\n    };\n}\nfunction grid(width, height, color) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.setAttribute(\"width\", width + \"\");\n    canvas.setAttribute(\"height\", height + \"\");\n    const ctx = canvas.getContext(\"2d\");\n    ctx.strokeStyle = color;\n    ctx.moveTo(0, height);\n    ctx.lineTo(width, height);\n    ctx.lineTo(width, 0);\n    ctx.stroke();\n    return canvas.toDataURL();\n}\n\n/**\n * Prepares dimensional coordinates for a task\n * @param {Object} task - task data object\n * @param {number} i - the index of the task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} taskHeight - the height of a task bar\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\n * @returns {Object} task data object\n */\nfunction updateTask(task, i, scales, taskHeight, y) {\n    if (task.type === \"split\" && task.$data && task.$data.length) {\n        task.$data.forEach(k => setSizes(k, i, scales, taskHeight));\n    }\n    else {\n        setSizes(task, i, scales, taskHeight, y);\n    }\n    return task;\n}\nfunction setSizes(task, i, scales, taskHeight, y) {\n    const { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\n    const startDate = task.start_date < start ? start : task.start_date;\n    const endDate = task.end_date > end ? end : task.end_date;\n    const astart = getUnitStart(minUnit, start, scales.startOnMonday);\n    const ms = task.type == \"milestone\";\n    task.$h = taskHeight;\n    task.$x =\n        Math.round(diff(startDate, astart, scales.startOnMonday, precise) * cellWidth) - (ms ? task.$h / 2 : 0);\n    task.$w = ms\n        ? task.$h\n        : Math.round(diff(endDate, startDate, scales.startOnMonday, precise, true) *\n            cellWidth);\n    task.$y =\n        typeof y === \"undefined\"\n            ? cellHeight * i + (cellHeight - taskHeight) / 2\n            : y;\n}\n/**\n * Updates start, end and duration fields of tasks during initial loading and updating\n * @param {Object} task - task data object\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction updateTaskDuration(task, scales, mode, dir) {\n    if (task.start_date &&\n        task.end_date &&\n        task.start_date.valueOf() >= task.end_date.valueOf()) {\n        task.end_date = null;\n        task.duration = 1;\n        if (mode)\n            mode = \"move\";\n    }\n    if (scales) {\n        excludeHolidays(task, scales, mode, dir);\n    }\n    else {\n        if (task.type == \"milestone\") {\n            getMilestone(task);\n        }\n        else {\n            if (!task.duration) {\n                task.duration = getDuration(task);\n            }\n            if (!task.end_date) {\n                task.end_date = getEnd(task);\n            }\n        }\n    }\n}\n/**\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\n */\nfunction excludeHolidays(task, scales, mode, dir) {\n    if (task.type == \"milestone\") {\n        task.start_date = mode\n            ? toWorkday(task.start_date, false, scales, dir)\n            : toClosestWorkday(task.start_date, scales); //on load\n        return getMilestone(task);\n    }\n    if (!mode) {\n        //on load\n        task.start_date = toClosestWorkday(task.start_date, scales);\n        task.end_date = getEndWorkday(task, scales);\n        task.duration = getDuration(task, scales);\n    }\n    else {\n        if (mode == \"start\" || mode == \"move\") {\n            task.start_date = toWorkday(task.start_date, false, scales, dir);\n            if (!task.duration)\n                task.duration = getDuration(task, scales);\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n        }\n        else {\n            //end, duration\n            if (!task.end_date)\n                task.end_date = getEndWorkday(task, scales);\n            if (!task.duration) {\n                task.end_date = toWorkday(task.end_date, true, scales, dir);\n                task.duration = getDuration(task, scales);\n            }\n        }\n    }\n}\nfunction getMilestone(task) {\n    task.duration = 0;\n    task.end_date = task.start_date;\n}\n/**\n * Returns the end date of a task\n * @param {Object} task - task data object\n */\nfunction getEnd(task) {\n    if (task.duration < 1)\n        return addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\n    else\n        return addUnit(\"day\")(task.start_date, task.duration);\n}\n/**\n * Returns end date excluding holidays from duration\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} end date\n */\nfunction getEndWorkday(task, scales) {\n    if (task.duration < 1)\n        return getEnd(task);\n    let date = getDatePart(task.start_date);\n    for (let w = 0, d = 0; w < task.duration;) {\n        if (!scales.isHoliday(date)) {\n            ++w;\n            d = 0;\n        }\n        else {\n            if (++d === 30)\n                holidayGuard();\n        }\n        date = addUnit(\"day\")(date, 1);\n    }\n    return date;\n}\n/**\n * Calculates the duration of a task\n * @param {Object} task - task data object\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {number} task duration\n */\nfunction getDuration(task, scales) {\n    const d = getDiff(\"day\")(task.end_date, task.start_date, true);\n    // allow float duration for tasks smaller than day\n    if (d < 1)\n        return parseFloat(d.toFixed(2));\n    if (!scales)\n        return Math.floor(d);\n    let date = task.start_date;\n    let duration = 0;\n    while (date < task.end_date) {\n        if (!scales.isHoliday(date))\n            ++duration;\n        date = addUnit(\"day\")(date, 1);\n    }\n    return duration;\n}\n/**\n * Moves a date from a holiday to the closest working day (priority to the future)\n * @param {Date} date - original date\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @returns {Date} the date of a closest work day\n */\nfunction toClosestWorkday(date, scales) {\n    let left = date;\n    let right = date;\n    let notRight;\n    let d = 0;\n    while (d < 30 &&\n        (notRight = scales.isHoliday(right)) &&\n        scales.isHoliday(left)) {\n        left = addUnit(\"day\")(left, -1);\n        right = addUnit(\"day\")(right, 1);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return !notRight ? right : left;\n}\nfunction holidayGuard() {\n    alert(\"No work days found within 30 days, check your isHoliday function!\");\n    throw \"Wrong isHoliday function\";\n}\n/**\n * Moves a date from a holiday to a working day in the given direction\n * @param {Date} date - the current date\n * @param {Boolean} end - indicates if this is the end of a task\n * @param {Object} scales - the data for current scales; the return value of resetScales()\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\n * @returns {Date} the date of a working day\n */\nfunction toWorkday(date, end, scales, dir) {\n    let d = 0;\n    while (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\n        date = addUnit(\"day\")(date, dir);\n        d++;\n    }\n    if (d === 30)\n        holidayGuard();\n    return date;\n}\n/**\n * Returns the date for a holiday check\n * @param {Date} date - the date\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\n * @returns {Date} the date that will be used for a check\n */\nfunction getCheckDate(date, end) {\n    return end && !getTimePart(date) ? addUnit(\"day\")(date, -1) : date;\n}\n\nconst delta = 20;\nfunction updateLink(link, startTask, endTask, height) {\n    const dy = Math.round(height / 2);\n    if (!startTask || !endTask) {\n        link.$p = \"\";\n        return link;\n    }\n    let s_start = false;\n    let e_start = false;\n    switch (link.type) {\n        case 0:\n            e_start = true;\n            break;\n        case 1:\n            s_start = true;\n            e_start = true;\n            break;\n        case 3:\n            s_start = true;\n            break;\n    }\n    const sx = s_start ? startTask.$x : startTask.$x + startTask.$w;\n    const sy = startTask.$y;\n    const ex = e_start ? endTask.$x : endTask.$x + endTask.$w;\n    const ey = endTask.$y;\n    if (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\n        const lineCoords = getLineCoords(sx, sy + dy, ex, ey + dy, s_start, e_start, 38 / 2);\n        const arrowCoords = getArrowCoords(ex, ey + dy, e_start);\n        link.$p = `${lineCoords},${arrowCoords}`;\n    }\n    else {\n        link.$p = \"\";\n    }\n    return link;\n}\nfunction differentX(startTask, endTask, sx, ex, height) {\n    if (startTask.type === \"milestone\" || endTask.type === \"milestone\")\n        return Math.abs(sx - ex) > height / 2;\n    return sx !== ex;\n}\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\n    const shift = delta * (s_start ? -1 : 1);\n    const backshift = delta * (e_start ? -1 : 1);\n    const sx1 = sx + shift;\n    const ex1 = ex + backshift;\n    const line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\n    const dx = ex1 - sx1;\n    let dy = ey - sy;\n    const same = e_start === s_start;\n    if (!same && ((ex1 <= sx + delta - 2 && e_start) || (ex1 > sx && !e_start))) {\n        dy -= gapp;\n    }\n    if ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\n        line[4] = line[2] + dx;\n        line[5] = line[3];\n        line[6] = line[4];\n        line[7] = line[5] + dy;\n    }\n    else {\n        line[4] = line[2];\n        line[5] = line[3] + dy;\n        line[6] = line[4] + dx;\n        line[7] = line[5];\n    }\n    return line.join(\",\");\n}\nfunction getArrowCoords(x, y, start) {\n    if (start) {\n        return `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\n    }\n    else {\n        return `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\n    }\n}\nfunction newLink(box, start, end) {\n    if (start && end) {\n        const width = end.x - start.x;\n        const height = end.y - start.y;\n        const left = (width > 0 ? start.x : end.x) - box.left;\n        const top = (height > 0 ? start.y : end.y) - box.top;\n        const p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${width > 0 ? width : 0},${height > 0 ? height : 0}`;\n        return { width: Math.abs(width), height: Math.abs(height), left, top, p };\n    }\n    else {\n        return null;\n    }\n}\n\nexport { addUnit, getDiff, getUnitStart, grid, newLink, resetScales, smallerCount, updateLink, updateTask, updateTaskDuration };\n//# sourceMappingURL=wgantt.es6.js.map\n","import {\n\taddUnit,\n\tgetDiff,\n\tgetUnitStart,\n\tgrid,\n\tnewLink,\n\tresetScales,\n\tsmallerCount,\n\tupdateLink,\n\tupdateTask,\n\tupdateTaskDuration,\n} from \"@xbs/webix-gantt-lib\";\n\nexport default class Helpers {\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.defaultResourceUnit = \"hour\";\n\t\tthis.defaultResourceValues = {\n\t\t\thour: 8,\n\t\t};\n\t\tthis.resourceValueRanges = {\n\t\t\thour: [0.5, 24],\n\t\t};\n\t\tthis.resourceValueSteps = {\n\t\t\thour: 0.5,\n\t\t};\n\t\tthis.unitLoadNorm = {\n\t\t\tday: 8,\n\t\t\tweek: 40,\n\t\t\tmonth: 170,\n\t\t\tquarter: 510,\n\t\t\tyear: 2040,\n\t\t};\n\t}\n\n\t/**\n\t * Get name initials\n\t * @param {string} name - resource name\n\t * @returns {string} name initials\n\t */\n\tinitials(name) {\n\t\tlet initials = name.match(/\\b\\w/g) || [];\n\t\tif (initials.length == 1)\n\t\t\treturn name.charAt(0).toUpperCase() + name.charAt(1);\n\t\treturn ((initials.shift() || \"\") + (initials.pop() || \"\")).toUpperCase();\n\t}\n\n\t/**\n\t * Get an additional css class for resource avatar\n\t * @param {string} name - a resource name\n\t * @returns {string} a css class\n\t */\n\tavatarCss(name) {\n\t\treturn (\n\t\t\t\" webix_gantt_person_avatar_\" +\n\t\t\t((name.charCodeAt(1) + (name.length % 10)) % 10)\n\t\t);\n\t}\n\n\t/**\n\t * A template for an assignment avatar\n\t * @param {object} resource - a resource object\n\t * @param {string} cssClass - an addition css class for the avatar\n\t * @param {boolean} withTooltip - specifies whether  an avatar should get tooltip\n\t * @returns {string} html string for assignment avatar\n\t */\n\tresourceAvatar(resource, cssClass, withTooltip) {\n\t\tlet css = \"webix_gantt_person_avatar\";\n\t\tif (typeof cssClass == \"string\") css += \" \" + cssClass;\n\t\tif (resource.avatar)\n\t\t\treturn `<img class=\"${css}\" src=\"${resource.avatar}\" webix_tooltip=\"${\n\t\t\t\twithTooltip ? resource.name : \"\"\n\t\t\t}\"/>`;\n\t\tconst txt = resource.name;\n\t\treturn `<div class='${css} ${\n\t\t\ttxt ? this.avatarCss(txt) : \"\"\n\t\t}' webix_tooltip=\"${withTooltip ? resource.name : \"\"}\">${\n\t\t\ttxt ? this.initials(txt) : \"\"\n\t\t}</div>`;\n\t}\n\n\t/**\n\t * Get the default value for the resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {any} the default resource\n\t */\n\tgetDefaultResourceValue(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.defaultResourceValues[unit];\n\t}\n\n\t/**\n\t * Get a resource unit\n\t * @param {object} obj - a resource object\n\t * @returns {string} a resource unit\n\t */\n\tgetResourceUnit(obj) {\n\t\treturn obj.unit || this.defaultResourceUnit;\n\t}\n\t/**\n\t * Get a resource value range\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value range\n\t */\n\tgetResourceValueRange(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueRanges[unit] || [1, 100];\n\t}\n\t/**\n\t * Get a resource value step\n\t * @param {object} obj - a resource object\n\t * @returns {array} a resource value step\n\t */\n\tgetResourceValueStep(obj) {\n\t\tconst unit = this.getResourceUnit(obj);\n\t\treturn this.resourceValueSteps[unit] || null;\n\t}\n\t/**\n\t * Check if a date is a holiday for an assigned resource\n\t * @param {date} date - Date object\n\t * @param {object} cal - a calendar object of a resource\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tisResourceHoliday(date, cal) {\n\t\tlet result = false;\n\t\tif (cal.holidays)\n\t\t\tresult = cal.holidays.find(d => d.getTime() == date.getTime());\n\t\tif (cal.weekDays)\n\t\t\tresult = result || cal.weekDays.indexOf(date.getDay()) == -1;\n\t\treturn result;\n\t}\n\n\t/* wrappers for gantt-lib functions */\n\n\taddUnit(unit, date, inc) {\n\t\treturn addUnit(unit)(date, inc);\n\t}\n\n\tgetDifference(unit, next, prev) {\n\t\treturn getDiff(unit)(next, prev, webix.Date.startOnMonday);\n\t}\n\n\tgetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date, webix.Date.startOnMonday);\n\t}\n\n\tupdateTask(task, index) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateTask(task, index, local.getScales(), local.getTaskHeight());\n\t}\n\n\tsetScales(start, end, precise, width, height, scales) {\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tprecise,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tscales,\n\t\t\tthis.app.config.isHoliday,\n\t\t\twebix.Date.startOnMonday\n\t\t);\n\t}\n\n\tupdateLink(link, start, end) {\n\t\tconst local = this.app.getService(\"local\");\n\t\treturn updateLink(link, start, end, local.getTaskHeight());\n\t}\n\n\tupdateTaskDuration(task, scales, mode, dir) {\n\t\treturn updateTaskDuration(task, scales, mode, dir);\n\t}\n\n\tgetSmallerUnit(unit) {\n\t\treturn smallerCount[unit][0];\n\t}\n\n\tgetSmallerCount(unit) {\n\t\treturn smallerCount[unit][1];\n\t}\n\n\tnewLink(box, start, end) {\n\t\treturn newLink(box, start, end);\n\t}\n\n\tdrawGridInner(width, height, color) {\n\t\treturn grid(width, height, color);\n\t}\n}\n","import { arrayEquals } from \"helpers/common\";\n\nexport default class Grouping {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis.app = app;\n\t\tthis.local = app.getService(\"local\");\n\t\tthis.helpers = app.getService(\"helpers\");\n\t\tthis.closedResources = null;\n\t}\n\n\t/* Grouping for Tasks View*/\n\n\t/***\n\t * Get tasks tree data (grouped by parent)\n\t * @param {array} data - a data array\n\t * @param {string} id - a branch id\n\t * @returns {array} a data array for webix.TreeCollection\n\t */\n\tgetTreeData(data, id) {\n\t\tconst tree = data.filter(a => a.parent == id);\n\t\ttree.forEach(a => {\n\t\t\tconst temp = this.getTreeData(data, a.id);\n\t\t\tif (temp) a.data = temp;\n\t\t});\n\n\t\treturn tree;\n\t}\n\n\t/* Grouping for Resource Diagram */\n\n\t/**\n\t * Webix TreeCollection\n\t * @typedef {Object} TreeCollection\n\t */\n\n\t/**\n\t * Collects data for resource diagram (hierarchical structure)\n\t * @returns {TreeCollection}\n\t */\n\tgetRDCollection(force) {\n\t\tif (this._rdCollection && !force) return this._rdCollection;\n\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst resources = this.local.resources();\n\t\tif (!this._rdCollection) {\n\t\t\tthis._rdCollection = new webix.TreeCollection({});\n\t\t\twebix.extend(this._rdCollection, webix.Group);\n\n\t\t\tthis.syncRDWithData();\n\t\t} else {\n\t\t\tthis._rdCollection.clearAll();\n\t\t}\n\n\t\twebix.promise\n\t\t\t.all([tasks.waitData, assignments.waitData, resources.waitData])\n\t\t\t.then(() => {\n\t\t\t\tconst data = [];\n\t\t\t\tconst scales = this.local.getScales();\n\t\t\t\tassignments.data.each(obj => {\n\t\t\t\t\tconst res = this.getDiagramItemData(obj, scales);\n\t\t\t\t\tif (res) data.push(res);\n\t\t\t\t});\n\t\t\t\tthis._rdCollection.parse(data);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t});\n\n\t\treturn this._rdCollection;\n\t}\n\n\t/**\n\t * Synchs RD collection with main collections and scale changes\n\t */\n\tsyncRDWithData() {\n\t\tthis.app.on(\"onScalesUpdate\", (v, o) => {\n\t\t\tif (this._rdCollection && this._rdCollection.data.order.length) {\n\t\t\t\tthis.refreshTaskDiagram();\n\n\t\t\t\tif (v.minUnit !== o.minUnit) {\n\t\t\t\t\tthis.updateUnitDurations();\n\t\t\t\t\tthis.groupResourceDiagram();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst tasks = this.local.tasks();\n\t\ttasks.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (\n\t\t\t\tmode &&\n\t\t\t\tobj &&\n\t\t\t\t(mode == \"update\" ||\n\t\t\t\t\tmode == \"delete\" ||\n\t\t\t\t\tthis.local.assignments().find(a => a.task === obj.id, true))\n\t\t\t) {\n\t\t\t\tthis.updateTaskDiagram(obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t\tconst assignments = this.local.assignments();\n\t\tassignments.data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (id) {\n\t\t\t\tthis.refreshResourceDiagram(id, obj, mode);\n\t\t\t\tthis.groupResourceDiagram();\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateUnitDurations() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst assignments = this.local.assignments();\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(obj => {\n\t\t\tif (obj.task) {\n\t\t\t\tconst task = tasks.getItem(obj.task);\n\t\t\t\tconst assignment = assignments.getItem(obj.id);\n\t\t\t\tif (task && assignment) {\n\t\t\t\t\tobj.duration = this.calculateUnitDuration(task, scales);\n\t\t\t\t\tobj.value = this.calculateLoad(\n\t\t\t\t\t\t{ ...task, ...assignment },\n\t\t\t\t\t\tscales.minUnit\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param {Object} task\n\t */\n\tcalculateUnitDuration(task, scales) {\n\t\treturn scales.minUnit === \"day\"\n\t\t\t? task.duration\n\t\t\t: scales.diff(\n\t\t\t\t\ttask.end_date,\n\t\t\t\t\ttask.start_date,\n\t\t\t\t\twebix.Date.startOnMonday,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue\n\t\t\t  );\n\t}\n\n\t/**\n\t * Collects data on assignment from all related tables (tasks and resources) for resources diagram\n\t * @param {Object} obj - assignment data object\n\t * @returns {Object} all data about assignment\n\t */\n\tgetDiagramItemData(obj, scales) {\n\t\tconst task = this.local.tasks().getItem(obj.task);\n\n\t\tif (task) {\n\t\t\tif (!this.local._isTaskVisible(task, true)) {\n\t\t\t\tthis.helpers.updateTask(task, 0);\n\t\t\t}\n\n\t\t\tconst resource = this.local.resources().getItem(obj.resource);\n\t\t\tconst res = { ...task, ...resource, ...obj };\n\t\t\tres.duration = this.calculateUnitDuration(task, scales);\n\t\t\tres.value = this.calculateLoad(res, scales.minUnit);\n\n\t\t\t// diagram renders 1 workload markers per min unit\n\t\t\tres.$x = this.truncateX(res.$x, scales);\n\n\t\t\treturn res;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Calculates workload per current min scale unit\n\t * @param {Object} data - data object for resource diagram (at least must have values from tasks and resources)\n\t * @param {string} unit - the min scale unit of the current scale (\"day\", \"week\", etc)\n\t * @returns {Array} load per 1st and last units if they are not fully occupied, and a fully occupied unit load. e.g. [1,0,8]\n\t */\n\tcalculateLoad(data, unit) {\n\t\tconst num = this.getUnitLoad(data);\n\n\t\tif (unit === \"hour\") return [0, 0, num / 24];\n\n\t\tif (unit === \"day\") return [0, 0, num];\n\n\t\tconst load = [];\n\n\t\tlet start = webix.Date.copy(data.start_date);\n\t\tconst startUnitStart = this.helpers.getUnitStart(unit, start);\n\t\tlet end = webix.Date.copy(data.end_date);\n\t\tconst endUnitStart = this.helpers.getUnitStart(unit, end);\n\t\tlet startUnitEnd;\n\n\t\tif (webix.Date.datePart(start, true) > startUnitStart) {\n\t\t\tstartUnitEnd = this.helpers.addUnit(unit, startUnitStart, 1);\n\t\t\tif (end > startUnitEnd) {\n\t\t\t\t// find duration in days for the first not-fully occupied unit\n\t\t\t\tconst days = this.findUnitDuration(start, startUnitEnd, data);\n\t\t\t\tload.push(days);\n\t\t\t\tstart = startUnitEnd;\n\t\t\t} else load.push(0);\n\t\t} else load.push(0);\n\n\t\tif (\n\t\t\t!webix.Date.equal(startUnitStart, endUnitStart) &&\n\t\t\twebix.Date.datePart(end, true) >= endUnitStart\n\t\t) {\n\t\t\t// find duration in days for the last not fully-occupied unit\n\t\t\tconst days = this.findUnitDuration(endUnitStart, end, data);\n\t\t\tload.push(days);\n\t\t\tend = endUnitStart;\n\t\t} else load.push(0);\n\n\t\t// find duration in days for a fully-occupied unit\n\t\tconst plusUnit = this.helpers.addUnit(unit, start, 1);\n\t\tconst days = this.findUnitDuration(\n\t\t\tstart,\n\t\t\tnew Date(Math.min(plusUnit, end)),\n\t\t\tdata\n\t\t);\n\t\tload.push(days);\n\n\t\treturn load.map(l => l * num);\n\t}\n\n\t/**\n\t * Finds unit duration in days ( to calculate work load per init )\n\t * @param start {Date} start date\n\t * @param end {Date} end date\n\t * @param data {object} data object\n\t * @returns {number} days number\n\t */\n\tfindUnitDuration(start, end, data) {\n\t\tlet days = this.helpers.getDifference(\"day\", end, start);\n\t\tif (this.app.config.excludeHolidays) {\n\t\t\tlet i,\n\t\t\t\td = webix.Date.copy(start),\n\t\t\t\tn = days;\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\tif (this.checkHoliday(d, data)) days--;\n\t\t\t\twebix.Date.add(d, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\treturn days;\n\t}\n\n\t/**\n\t * Check if date is a holiday\n\t * @param d {Date} date to check\n\t * @param data {object} data object (resource calendar check)\n\t * @returns {boolean} true if date is a holiday\n\t */\n\tcheckHoliday(d, data) {\n\t\tif (this.app.config.resourceCalendars) {\n\t\t\tconst calendarId = this.local.resources().getItem(data.resource)\n\t\t\t\t.calendar_id;\n\t\t\tif (calendarId) {\n\t\t\t\tconst calendar = this.local.calendars().getItem(calendarId);\n\t\t\t\treturn this.helpers.isResourceHoliday(d, calendar);\n\t\t\t}\n\t\t}\n\t\treturn this.app.config.isHoliday(d);\n\t}\n\n\t/**\n\t * Returns resource load per unit\n\t * @param {Object} data - data object from Resource Diagram collection\n\t * @returns {number} load per unit (by default hours, but can be anything)\n\t */\n\tgetUnitLoad(data) {\n\t\treturn data.value;\n\t}\n\n\t/**\n\t * Cuts X coordinate down to unit start if precision setting was set for the scale,\n\t * because diagram renders 1 workload marker per min unit in the middle\n\t * @param {number} x - the X coordinate of a task bar on a date scale\n\t * @param {Object} scales - the data object of current scales\n\t * @returns {number} altered X\n\t */\n\ttruncateX(x, scales) {\n\t\tif (scales.precise !== false) {\n\t\t\treturn Math.floor(x / scales.cellWidth) * scales.cellWidth;\n\t\t}\n\t\treturn x;\n\t}\n\n\t/**\n\t * Refreshes data in diagram collection if a resource was (un)assigned or load per day changed\n\t * @param {(string|number)} id - the ID of an assignment record\n\t * @param {Object} obj - data object of an assignment\n\t * @param {string} mode - operation mode (\"add\", \"update\", \"delete\")\n\t */\n\trefreshResourceDiagram(id, obj, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\t\tswitch (mode) {\n\t\t\tcase \"update\":\n\t\t\t\tif (data.exists(id)) {\n\t\t\t\t\tconst task = this.local.tasks().getItem(obj.task);\n\t\t\t\t\tconst resource = { ...this.local.resources().getItem(obj.resource) };\n\t\t\t\t\tdelete resource.id;\n\t\t\t\t\tconst value = this.calculateLoad({ ...task, ...obj }, scales.minUnit);\n\t\t\t\t\tdata.updateItem(id, { ...obj, ...resource, value });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"add\":\n\t\t\t\tdata.add(this.getDiagramItemData(obj, scales));\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tif (data.exists(id)) data.remove(id);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Removed all related data records in diagram collection if an assigned task was removed\n\t * @param {Object} task - the ID of a task\n\t * @param {string} mode - operation type (add, delete, update)\n\t */\n\tupdateTaskDiagram(task, mode) {\n\t\tconst data = this._rdCollection;\n\t\tconst scales = this.local.getScales();\n\n\t\tif (mode === \"delete\") {\n\t\t\tthis.pruneDiagram();\n\t\t} else if (mode === \"add\") {\n\t\t\tconst rec = this.local.assignments().find(a => a.task === task.id, true);\n\t\t\tdata.add(this.getDiagramItemData(rec, scales));\n\t\t} else if (mode === \"update\") {\n\t\t\tconst assignments = data.find(a => a.task === task.id);\n\t\t\tassignments.forEach(a => {\n\t\t\t\tconst oa = this.local.assignments().getItem(a.id);\n\t\t\t\tdata.updateItem(a.id, {\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tid: a.id,\n\t\t\t\t\tduration: this.calculateUnitDuration(task, scales),\n\t\t\t\t\t$x: this.truncateX(task.$x, scales),\n\t\t\t\t\tvalue: this.calculateLoad({ ...task, ...oa }, scales.minUnit),\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Cleans removed tasks from resource diagram\n\t * (it's not enough to remove 1 removed task because the removed task can have kids,\n\t * and they go together with their parent and there is no event about each of them)\n\t */\n\tpruneDiagram() {\n\t\tconst tasks = this.local.tasks();\n\t\tconst toRemove = [];\n\t\tthis._rdCollection.data.eachLeaf(0, d => {\n\t\t\tif (!tasks.exists(d.task)) toRemove.push(d.id);\n\t\t});\n\t\tif (toRemove.length) this._rdCollection.remove(toRemove);\n\t}\n\n\t/**\n\t * Updates $x coordinates for tasks after scale changes\n\t */\n\trefreshTaskDiagram() {\n\t\tconst scales = this.local.getScales();\n\t\tthis._rdCollection.data.each(a => {\n\t\t\tconst task = this.local.tasks().getItem(a.task);\n\t\t\tif (task) a.$x = this.truncateX(task.$x, scales);\n\t\t});\n\t}\n\n\t/**\n\t * Groups data for resource diagram\n\t */\n\tgroupResourceDiagram() {\n\t\tconst collection = this._rdCollection;\n\t\tcollection.group({\n\t\t\tby: obj => obj.name + \"-\" + obj.category,\n\t\t\tmap: {\n\t\t\t\tresource_id: [\"resource\"],\n\t\t\t\tvalue: [\"name\"],\n\t\t\t\tname: [\"name\"],\n\t\t\t\tcategory: [\"category\"],\n\t\t\t\tavatar: [\"avatar\"],\n\t\t\t\tload: [\"value\", calculateLoad],\n\t\t\t\tduration: [\"duration\", collect], // num of workload markers\n\t\t\t\tunits: [\"value\", collect], // number on a workload marker\n\t\t\t\t$x: [\"$x\", collect], // start of a task\n\t\t\t\tcount: [\"value\", \"count\"],\n\t\t\t\tstart_date: [\"start_date\", collect],\n\t\t\t},\n\t\t});\n\t\tcollection.group(\n\t\t\t{\n\t\t\t\tby: \"category\",\n\t\t\t\tmap: {\n\t\t\t\t\tvalue: [\"category\"],\n\t\t\t\t\tname: [\"category\"],\n\t\t\t\t\tduration: [\"duration\", \"sum\"],\n\t\t\t\t\tload: [\"load\", \"sum\"],\n\t\t\t\t\tcount: [\"count\", \"sum\"],\n\t\t\t\t},\n\t\t\t},\n\t\t\t0\n\t\t);\n\t}\n\n\t/* Grouping for Resource View*/\n\n\t/**\n\t * Resource-task collection (shown when \"display\" state property equals \"resources\")\n\t * @returns {object} TreeCollection|webix.TreeCollection\n\t */\n\tgetResourceTree() {\n\t\tif (this._resourcesTree) return this._resourcesTree;\n\n\t\tthis._resourcesTree = new webix.TreeCollection({\n\t\t\ton: {\n\t\t\t\t\"data->onStoreUpdated\": (id, obj, mode) => {\n\t\t\t\t\tid = mode == \"update\" || mode == \"paint\" ? id : null;\n\t\t\t\t\tthis.refreshResourceTasks(id);\n\t\t\t\t\tthis.local.refreshLinks();\n\t\t\t\t},\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$sort: {\n\t\t\t\t\tby: \"start_date\",\n\t\t\t\t\tdir: \"asc\",\n\t\t\t\t\tas: \"int\",\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis._resourcesTree.parse(\n\t\t\tthis.resourceTaskLoader().finally(() => {\n\t\t\t\tthis.syncResourceTree();\n\t\t\t})\n\t\t);\n\n\t\treturn this._resourcesTree;\n\t}\n\n\t/**\n\t * Load task data and extend each task item with the \"resources\" property -\n\t * an array of task resources or null\n\t * @returns {Promise} promise that is resolved with a data array\n\t */\n\ttasksWithResources() {\n\t\treturn webix.promise\n\t\t\t.all([this.local.tasks().waitData, this.local.assignments().waitData])\n\t\t\t.then(() => {\n\t\t\t\tlet data = [];\n\t\t\t\tthis.local.tasks().data.each(\n\t\t\t\t\tt => {\n\t\t\t\t\t\tif (t.type == \"task\" || !t.type) {\n\t\t\t\t\t\t\tlet task = Object.assign({}, t);\n\t\t\t\t\t\t\tconst result = this.local\n\t\t\t\t\t\t\t\t.assignments()\n\t\t\t\t\t\t\t\t.data.find(a => a.task == task.id);\n\t\t\t\t\t\t\ttask.resources = result.length\n\t\t\t\t\t\t\t\t? result.map(item => item.resource)\n\t\t\t\t\t\t\t\t: null;\n\t\t\t\t\t\t\tdata.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"\",\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * tasks and resources loader\n\t * @returns {Promise<[]>} promise that is resolved with a data array\n\t * @private\n\t */\n\tresourceTaskLoader() {\n\t\tconst Ops = this.app.getService(\"operations\");\n\t\treturn webix.promise\n\t\t\t.all([this.tasksWithResources(), this.local.resources().waitData])\n\t\t\t.then(d => {\n\t\t\t\tlet data = this.getResourceTaskData(d[0]);\n\t\t\t\tdata.forEach(r => {\n\t\t\t\t\tOps.setProjectData(r, null, r.data);\n\t\t\t\t});\n\t\t\t\treturn data;\n\t\t\t});\n\t}\n\n\t/**\n\t * Updates Resource TreeCollection, called on tasks() TreeCollection update\n\t */\n\trefreshResourceTree() {\n\t\tif (this._resourcesTree.count()) {\n\t\t\t// get closed branches\n\t\t\tthis.closedResources = [];\n\t\t\tthis._resourcesTree.data.eachChild(\"0\", item => {\n\t\t\t\tif (!item.open) this.closedResources.push(item.resources);\n\t\t\t});\n\t\t} else this.closedResources = null;\n\t\tthis.resourceTaskLoader().then(data => {\n\t\t\t// reload data\n\t\t\tthis._resourcesTree.clearAll();\n\t\t\tthis._resourcesTree.parse(data);\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tsyncResourceTree() {\n\t\tconst tree = this._resourcesTree;\n\t\tthis.local.tasks().data.attachEvent(\"onStoreUpdated\", (id, obj, mode) => {\n\t\t\tif (mode == \"update\") {\n\t\t\t\tconst inTree = tree.exists(id) && tree.getItem(id).type == \"task\";\n\t\t\t\tconst becomesTask = obj.type == \"task\";\n\n\t\t\t\tif (inTree && becomesTask) {\n\t\t\t\t\ttree.updateItem(id, {\n\t\t\t\t\t\ttext: obj.text,\n\t\t\t\t\t\tdetails: obj.details,\n\t\t\t\t\t\tstart_date: obj.start_date,\n\t\t\t\t\t\tend_date: obj.end_date,\n\t\t\t\t\t\tduration: obj.duration,\n\t\t\t\t\t\tprogress: obj.progress,\n\t\t\t\t\t});\n\t\t\t\t\tconst pId = tree.getParentId(id);\n\t\t\t\t\tlet item = tree.getItem(pId);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\titem = this.app.getService(\"operations\").setProjectData(item, tree);\n\t\t\t\t\t\ttree.updateItem(pId, item);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t} else if (inTree ^ becomesTask) {\n\t\t\t\t\tthis.refreshResourceTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.refreshResourceTree();\n\t\t\t}\n\t\t});\n\t\tthis.local.assignments().data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tthis.refreshResourceTree();\n\t\t});\n\t}\n\n\t/**\n\t * Get data for resource Tree collection ( tasks grouped by resources )\n\t * @param {array} tasks - an tasks array where each item contains\n\t * \"resources\" property (an array of ids or null)\n\t * @returns {array} data array\n\t */\n\tgetResourceTaskData(tasks) {\n\t\tlet data = [];\n\t\tlet unassignedBranch = null;\n\t\tconst Ops = this.app.getService(\"operations\");\n\n\t\ttasks.forEach(t => {\n\t\t\tconst { resources } = t;\n\t\t\tlet item;\n\t\t\tif (!resources) item = unassignedBranch ? unassignedBranch : null;\n\t\t\telse item = data.find(item => arrayEquals(item.resources, resources));\n\t\t\tif (!item) {\n\t\t\t\titem = {\n\t\t\t\t\tid: resources ? webix.uid() : \"unassigned\",\n\t\t\t\t\ttype: \"project\",\n\t\t\t\t\ttext: \"\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\t// $group needed for faster checks\n\t\t\t\t\t$group: true,\n\t\t\t\t\t// restore open/closed state\n\t\t\t\t\topen: this.checkResourceOpen(resources),\n\t\t\t\t};\n\t\t\t\titem.resources = resources;\n\t\t\t\tif (resources)\n\t\t\t\t\titem.text = resources\n\t\t\t\t\t\t.map(id => this.local.resources().getItem(id))\n\t\t\t\t\t\t.sort(Ops.sortResources)\n\t\t\t\t\t\t.map(item => item.name)\n\t\t\t\t\t\t.join(\", \");\n\n\t\t\t\tif (resources) data.push(item);\n\t\t\t\telse {\n\t\t\t\t\titem.id = \"unassigned\";\n\t\t\t\t\tunassignedBranch = item;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.data.push(webix.copy(t));\n\t\t});\n\t\tif (unassignedBranch) data.push(unassignedBranch);\n\t\treturn data;\n\t}\n\n\t/**\n\t * Set task(s) properties that are needed to define size and position\n\t * @param {string} updID - task id (optional)\n\t * @param {number} i - task index (optional)\n\t */\n\trefreshResourceTasks(updID, i) {\n\t\tconst tree = this._resourcesTree;\n\t\tif (!updID) {\n\t\t\ttree.data.order.forEach((id, i) => {\n\t\t\t\tthis.refreshResourceTasks(id, i);\n\t\t\t});\n\t\t} else {\n\t\t\tconst t = tree.getItem(updID);\n\t\t\ti = !webix.isUndefined(i) ? i : tree.getIndexById(updID);\n\t\t\tthis.helpers.updateTask(t, i);\n\t\t}\n\t}\n\t/**\n\t * Checks whether this resource group needs to be open\n\t * @param {array} resources - array of resources in the group or null for Unassigned\n\t * @returns {boolean} result of the check\n\t */\n\tcheckResourceOpen(resources) {\n\t\tif (!this.closedResources) return true;\n\t\tif (!resources) return this.closedResources.indexOf(null) == -1;\n\t\treturn this.closedResources.find(arr => arrayEquals(arr, resources))\n\t\t\t? false\n\t\t\t: true;\n\t}\n}\n\n/**\n * An aggregation function for data grouping that collects column values (any) into an array\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {Array} the resulting array\n */\nfunction collect(property, data) {\n\tconst ws = [];\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tws.push(property(data[i]));\n\t}\n\n\treturn ws;\n}\n\n/**\n * @param {string} property - the name of the data field (column)\n * @param {Array} data - the data objects of the items from the data set\n * @returns {number}\n */\nfunction calculateLoad(property, data) {\n\tlet sum = 0;\n\n\tfor (let i = 0; i < data.length; i++) {\n\t\tconst units = property(data[i]);\n\t\tlet duration = parseInt(data[i].duration);\n\t\tconst last = units.length - 1;\n\t\tfor (let j = 0; j < units.length; ++j) {\n\t\t\tconst num = units[j];\n\t\t\tif (num) {\n\t\t\t\tsum += (j === last ? duration : 1) * num;\n\t\t\t\tduration--;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn sum;\n}\n","import { JetApp, plugins, EmptyRouter } from \"webix-jet\";\nimport { initJetWin } from \"@xbs/jet-helpers\";\nimport { createState, link } from \"jet-restate\";\n\nimport views from \"./export_views\";\nimport en from \"locales/en\";\n\n// services\nimport Local from \"./models/Local\";\nimport Backend from \"./models/Backend\";\nimport Operations from \"./models/Operations\";\nimport Helpers from \"./models/Helpers\";\nimport Grouping from \"models/Grouping\";\n\nexport class App extends JetApp {\n\tconstructor(config) {\n\t\t// widget state\n\t\tconst state = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tselected: null,\n\t\t\tedit: null,\n\t\t\treadonly: config.readonly || false,\n\t\t\tsort: null,\n\t\t\tdisplay:\n\t\t\t\tconfig.resources && config.display == \"resources\"\n\t\t\t\t\t? \"resources\"\n\t\t\t\t\t: \"tasks\",\n\t\t\tcriticalPath: config.criticalPath || false,\n\t\t\tresourcesDiagram: !!(config.resources && config.resourcesDiagram),\n\t\t\ttreeWidth: config.treeWidth || (config.resources ? 400 : 500),\n\t\t\tbaseline: config.baseline || false,\n\t\t});\n\n\t\tconst isHoliday =\n\t\t\tconfig.isHoliday ||\n\t\t\tfunction(date) {\n\t\t\t\tconst d = date.getDay();\n\t\t\t\treturn d === 0 || d === 6;\n\t\t\t};\n\n\t\tconst defaults = {\n\t\t\trouter: EmptyRouter,\n\t\t\tversion: VERSION,\n\t\t\tdebug: DEBUG,\n\t\t\tstart: \"/top\",\n\t\t\tcompactWidth: 650,\n\t\t\tmarkers: [{ css: \"webix_gantt_today_marker\", now: true }],\n\t\t\tparams: { state, forceCompact: config.compact },\n\t\t\tlinks: true,\n\t\t\tisHoliday,\n\t\t};\n\n\t\tsuper({ ...defaults, ...config });\n\n\t\tconst dynamic = obj =>\n\t\t\tthis.config.override ? this.config.override.get(obj) || obj : obj;\n\n\t\t//order matters\n\t\tthis.setService(\"helpers\", new (dynamic(Helpers))(this, config));\n\t\tthis.setService(\"local\", new (dynamic(Local))(this, config));\n\t\tthis.setService(\"backend\", new (dynamic(Backend))(this, config.url));\n\t\tthis.setService(\"operations\", new (dynamic(Operations))(this));\n\t\tthis.setService(\"grouping\", new (dynamic(Grouping))(this));\n\t\tinitJetWin(this);\n\n\t\tthis.use(\n\t\t\tplugins.Locale,\n\t\t\tthis.config.locale || {\n\t\t\t\tlang: \"en\",\n\t\t\t\twebix: {\n\t\t\t\t\ten: \"en-US\",\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\trequire(type, name) {\n\t\tif (type === \"jet-views\") return views[name];\n\t\telse if (type === \"jet-locales\") return locales[name];\n\n\t\treturn null;\n\t}\n\n\t// for external users\n\tgetState() {\n\t\treturn this.config.params.state;\n\t}\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"gantt\",\n\t\tapp: App,\n\t\tgetState() {\n\t\t\treturn this.$app.getState();\n\t\t},\n\t\tgetService(name) {\n\t\t\treturn this.$app.getService(name);\n\t\t},\n\t\t$init() {\n\t\t\tconst state = this.$app.getState();\n\t\t\tfor (let key in state) {\n\t\t\t\tlink(state, this.config, key);\n\t\t\t}\n\n\t\t\tthis.$app.attachEvent(\"bars:beforedrag\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrag\", [item, ctx])\n\t\t\t);\n\t\t\tthis.$app.attachEvent(\"bars:beforedrop\", (item, ctx) =>\n\t\t\t\tthis.callEvent(\"onBeforeDrop\", [item, ctx])\n\t\t\t);\n\t\t},\n\t\t$exportView: function(options) {\n\t\t\tif (\n\t\t\t\toptions.export_mode === \"png\" ||\n\t\t\t\t(options.export_mode === \"pdf\" && options.display === \"image\")\n\t\t\t)\n\t\t\t\treturn this.$app.getRoot();\n\t\t\treturn this.$app.getService(\"local\").tasks();\n\t\t},\n\t\tclearAll() {\n\t\t\tthis.$app.getService(\"local\").clearAll();\n\t\t},\n\t\treload() {\n\t\t\tthis.$app.getService(\"local\").reload();\n\t\t},\n\t},\n\twebix.ui.jetapp\n);\n\n// re-export for customization\nconst services = { Local, Backend, Operations, Helpers, Grouping };\nconst locales = { en };\nexport { views, locales, services };\n","export default {\n\tEdit: \"Edit\",\n\tDone: \"Done\",\n\t\"Delete task\": \"Delete task\",\n\t\"Delete link\": \"Delete link\",\n\t\"The task will be deleted permanently, are you sure?\":\n\t\t\"The task will be deleted permanently, are you sure?\",\n\t\"The link will be deleted permanently, are you sure?\":\n\t\t\"The link will be deleted permanently, are you sure?\",\n\tPredecessors: \"Predecessors\",\n\tSuccessors: \"Successors\",\n\n\tTitle: \"Title\",\n\t\"Start date\": \"Start date\",\n\t\"End date\": \"End date\",\n\tDuration: \"Duration\",\n\tProgress: \"Progress\",\n\tNotes: \"Notes\",\n\tType: \"Type\",\n\tProject: \"Project\",\n\tMilestone: \"Milestone\",\n\t\"Add task\": \"Add task\",\n\t\"Add project\": \"Add project\",\n\t\"(no title)\": \"(no title)\",\n\t\"Save changes?\": \"Save changes?\",\n\n\t\"Related tasks\": \"Related tasks\",\n\tTask: \"Task\",\n\tLink: \"Link\",\n\t\"End to start\": \"End to start\",\n\t\"Start to start\": \"Start to start\",\n\t\"End to end\": \"End to end\",\n\t\"Start to end\": \"Start to end\",\n\n\tLasts: \"Lasts\",\n\tday: \"day\",\n\tdays: \"days\",\n\n\t\"Add assignment\": \"Add assignment\",\n\tAssignment: \"Assignment\",\n\tAssignments: \"Assignments\",\n\tAssigned: \"Assigned\",\n\t\"Delete assignment\": \"Delete assignment\",\n\t\"Are you sure to delete this assignment?\":\n\t\t\"Are you sure to delete this assignment?\",\n\t\"No resources to add\": \"No resources to add\",\n\tUnassigned: \"Unassigned\",\n\n\thour: \"h\",\n\t\"Hours per\": \"Hours per\",\n\t\"Tasks per\": \"Tasks per\",\n\tName: \"Name\",\n\tHours: \"Hours\",\n\tTasks: \"Tasks\",\n\tmonth: \"month\",\n\tweek: \"week\",\n\tquarter: \"quarter\",\n\tyear: \"year\",\n\n\t\"Split task\": \"Split task\",\n\t\"Planned dates\": \"Planned dates\",\n\t\"Planned dates will be removed, are you sure?\":\n\t\t\"Planned dates will be removed, are you sure?\",\n\t\"Add dates\": \"Add dates\",\n\t\"Remove dates\": \"Remove dates\",\n};\n","webix.protoUI({\n\tname:\"kanbanheader\",\n\t$kanban:true,\n\t$skin:function(){\n\t\tthis.defaults.height = webix.skin.$active.barHeight;\n\t\tthis._template_types.sub.height = webix.skin.$active.barHeight - 12;\n\t},\n\t$init:function(config){\n\t\tlet subtype = this._template_types[config.type];\n\t\tif (subtype)\n\t\t\twebix.extend(config, subtype);\n\t},\n\tdefaults:{\n\t\tcss:\"webix_kanban_header\",\n\t\tborderless:true,\n\t\ttemplate:function(){\n\t\t\tlet icon = this.icon||(this.link?\"webix_kanban_icon kbi-plus-circle\":\"\");\n\t\t\treturn (icon ? \"<span class='webix_icon \"+(this.link?\"webix_kanban_add_icon \":\"\")+icon+\"'></span>\" : \"\") +\n\t\t\t\t\"<span class='webix_strong' style='line-height:\"+this.height+\"px'>\"+(this.label||\"\")+\"</span>\";\n\t\t},\n\t},\n\t_template_types:{\n\t\t\"sub\":{\n\t\t\tcss:\"webix_kanban_sub_header\"\n\t\t}\n\t},\n\ton_click:{\n\t\t\"webix_kanban_add_icon\":function(){\n\t\t\tlet obj = { text:\"\" };\n\t\t\tlet kanban = this.getKanban();\n\t\t\tlet list = kanban.queryView({id:this.config.link});\n\n\t\t\tif (list && this.callEvent(\"onBeforeCardAdd\",[obj, list])){\n\t\t\t\tkanban.setListStatus(obj, list);\n\t\t\t\tkanban.add(obj);\n\t\t\t}\n\t\t}\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n}, webix.MouseEvents, webix.ui.template);","const images = { jpg:true, jpeg:true, png:true, gif:true };\n\nconst icons = { ppt:\"-powerpoint\", pptx:\"-powerpoint\", pptm:\"-powerpoint\", pps:\"-powerpoint\", ppsx:\"-powerpoint\", ppsm:\"-powerpoint\",\n\tdoc:\"-word\", docx:\"-word\", docm:\"-word\", xls:\"-excel\", xlsx:\"-excel\", xlsm:\"-excel\", xlsb:\"-excel\", pdf:\"-pdf\",\n\twav:\"-audio\", aif:\"-audio\", mp3:\"-audio\", mid:\"-audio\", mpg:\"-video\", mov:\"-video\", wmv:\"-video\", avi:\"-video\", mp4:\"-video\",\n\tzip:\"-archive\", jar:\"-archive\", rar:\"-archive\", gz:\"-archive\", jpg:\"-image\", jpeg:\"-image\", png:\"-image\", gif:\"-image\"\n};\n\nexport function isImage(key){\n\treturn images[key.toString().toLowerCase()];\n}\n\nexport function getIconName(key){\n\treturn icons[key.toString().toLowerCase()] || \"\";\n}","import {isImage} from \"./helpers/image\";\n\nexport var type = {\n\theight:\"auto\",\n\ticons:[\n\t\t{ id:\"attachments\", icon:\"webix_kanban_icon kbi-file\", show:function(obj) { return obj.attachments? obj.attachments.length: false; }, template:\"#attachments.length#\"},\n\t\t{ id:\"comments\", icon:\"webix_kanban_icon kbi-comment\" , show:function(obj,kanban) { return !!kanban.config.comments; },\n\t\t\ttemplate:function(obj) { return obj.comments?(obj.comments.length||\"\"):\"\"; }\n\t\t},\n\t\t{ id:\"editor\", icon:\"webix_kanban_icon kbi-pencil\", show:function(obj,kanban) { return (kanban.config.editor && !kanban.config.cardActions);} },\n\t\t{ id:\"menu\", icon:\"webix_kanban_icon kbi-cogs\", show:function(obj,kanban) { return !!kanban.config.cardActions;} }\n\t],\n\ttemplateTags: function(obj,common,kanban){\n\t\tlet res = [];\n\t\tif(obj.tags){\n\t\t\tlet tags = kanban._tags;\n\t\t\tfor (let i = 0; i < obj.tags.length; i++){\n\t\t\t\tlet tag = obj.tags[i];\n\t\t\t\tif (tags.exists(tag))\n\t\t\t\t\ttag = tags.getItem(tag).value;\n\t\t\t\tres.push(\"<span class='webix_kanban_tag'>\"+tag+\"</span>\");\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_tags'>\" +(res.length?res.join(\"\"):\"&nbsp;\")+\"</div>\";\n\t},\n\ttemplateIcons: function(obj,common,kanban){\n\t\tvar icons = [];\n\t\tvar icon = null;\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < common.icons.length; i++){\n\t\t\ticon = common.icons[i];\n\t\t\tif(!icon.show || icon.show(obj,kanban)){\n\t\t\t\thtml = \"<span webix_icon_id='\"+(icon.id||icon.icon||icon)+\"' class='webix_kanban_footer_icon' title='\"+(icon.tooltip||\"\")+\"'>\";\n\t\t\t\thtml += \"<span class='\"+(icon.icon||icon)+\" webix_icon'></span>\";\n\n\t\t\t\tif(icon.template){\n\t\t\t\t\thtml += \"<span class='webix_kanban_icon_text'>\"+webix.template(icon.template)(obj)+\"</span>\";\n\t\t\t\t}\n\t\t\t\thtml += \"</span>\";\n\t\t\t\ticons.push(html);\n\t\t\t}\n\t\t}\n\t\treturn \"<div  class='webix_kanban_footer_icons'>\" + icons.join(\" \") + \"</div>\";\n\t},\n\ttemplateAvatar: function(obj,common,kanban){\n\t\tlet users = kanban._users;\n\t\tlet user = (obj.user_id && users.exists(obj.user_id)) ? users.getItem(obj.user_id) : {};\n\t\tif (user.image)\n\t\t\treturn \"<img class='webix_kanban_avatar' src='\"+user.image+\"' title='\"+(user.value||\"\")+\"'>\";\n\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account' title='\"+(user.value||\"\")+\"'></span>\";\n\t},\n\ttemplateBody: function(obj){\n\t\treturn obj.text;\n\t},\n\ttemplateAttachments: function(obj){\n\t\tif(obj.attachments){\n\t\t\tfor (let i in obj.attachments){\n\t\t\t\tlet v = obj.attachments[i];\n\t\t\t\tlet type = v.link.split(\".\").pop();\n\t\t\t\tif (isImage(type))\n\t\t\t\t\treturn \"<img class='webix_kanban_attachment' src='\"+v.link+\"'/>\";\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t},\n\ttemplateFooter: function(obj,common,kanban){\n\t\tvar tags = common.templateTags(obj,common,kanban);\n\t\treturn (tags?tags:\"&nbsp;\") + common.templateIcons(obj,common,kanban);\n\t},\n\ttemplateStart:webix.template(\"<div webix_l_id='#id#' class='{common.classname()} webix_kanban_list_item' style='width:{common.width}px; height:{common.height}px;'>\"),\n\ttemplate:function(obj, common){\n\t\tlet kanban = webix.$$(common.master);\n\n\t\tvar color = kanban._colors.exists(obj.color) ? kanban._colors.getItem(obj.color).color : obj.color;\n\t\tvar avatar = \"<div class='webix_kanban_user_avatar' webix_icon_id='$avatar'>\"+common.templateAvatar(obj,common,kanban)+\"</div>\";\n\t\tvar body = \"<div class='webix_kanban_body'>\"+common.templateBody(obj,common,kanban)+avatar+\"</div>\";\n\t\tvar attachments = kanban.config.attachments ? common.templateAttachments(obj,common,kanban) : \"\";\n\t\tvar footer = \"<div class='webix_kanban_footer'>\"+common.templateFooter(obj,common,kanban)+ \"</div>\";\n\t\treturn \"<div class='webix_kanban_list_content'\"+(color ? \" style='border-left-color:\"+color+\"'\" : \"\")+\">\"+attachments+body+footer+\"</div>\";\n\t}\n};\n\nwebix.KanbanView = {\n\t$kanban:true,\n\ton_context:{},\n\t$skin:function(){\n\t\t// prevent default list's item skin height\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\t_kanban_event(s, t, i){\n\t\tthis.attachEvent(s,function(...rest){\n\t\t\trest[i] = this;\n\t\t\treturn  this.getKanban().callEvent(t, rest);\n\t\t});\n\t},\n\t_fixOrder(){\n\t\tthis.data.each((a,i) => a.$index = i+1);\n\t},\n\tmove(sid,tindex,tobj, details){\n\t\ttobj = tobj || this;\n\t\tdetails = details || {};\n\t\t// normally only one item is dragged\n\t\t// still, it possible to enable multi-selection through API\n\t\tif (webix.isArray(sid)){\n\t\t\treturn webix.DataMove.move.call(this, sid,tindex,tobj, details);\n\t\t}\n\n\t\tconst statusChange = (tobj !== this);\n\t\tconst kanban = this.getKanban();\n\t\tconst item = kanban.getItem(sid);\n\t\tconst dp = webix.dp.$$(kanban.config.id);\n\n\t\tif (statusChange){\n\t\t\tif (!kanban.callEvent(\"onBeforeStatusChange\", [sid,tobj.config.status,tobj])) return;\n\n\t\t\tkanban.setListStatus(item, tobj);\n\n\t\t\tif (dp){\n\t\t\t\tdp.ignore(() => kanban.updateItem(sid));\n\t\t\t} else kanban.updateItem(sid);\n\t\t}\n\n\t\twebix.DataMove.move.call(tobj, sid, tindex);\n\n\t\tthis._fixOrder();\n\t\tif (this !== tobj) tobj._fixOrder();\n\n\t\t// trigger data saving\n\t\tif (dp){\n\t\t\tconst update = webix.copy(item);\n\t\t\tupdate.webix_move_index = tindex;\n\t\t\tupdate.webix_move_id = tobj.data.order[tindex+1];\n\t\t\t// we need to identify the target list on server side\n\t\t\t// when we have a complex status ( object or function )\n\t\t\t// use separate property\n\t\t\tupdate.webix_move_parent = tobj.config.serverStatus || tobj.config.status;\n\t\t\tdp.save(sid, \"update\", update);\n\t\t}\n\n\t\tif (statusChange)\n\t\t\tkanban.callEvent(\"onAfterStatusChange\", [sid,tobj.config.status,tobj]);\n\n\t\treturn sid;\n\t},\n\t_setHandlers(){\n\t\tthis.attachEvent(\"onAfterSelect\", function(){\n\t\t\tthis.eachOtherList(function(list){\n\t\t\t\tlist.unselect();\n\t\t\t});\n\t\t});\n\n\t\tthis._kanban_event(\"onBeforeSelect\", \"onListBeforeSelect\", 2);\n\t\tthis._kanban_event(\"onAfterSelect\", \"onListAfterSelect\", 1);\n\t\tthis._kanban_event(\"onBeforeContextMenu\", \"onListBeforeContextMenu\", 3);\n\t\tthis._kanban_event(\"onAfterContextMenu\", \"onListAfterContextMenu\", 3);\n\t\tthis._kanban_event(\"onItemClick\", \"onListItemClick\", 3);\n\t\tthis._kanban_event(\"onItemDblClick\", \"onListItemDblClick\", 3);\n\t\tthis._kanban_event(\"onBeforeDrag\", \"onListBeforeDrag\", 2);\n\t\tthis._kanban_event(\"onBeforeDrop\", \"onListBeforeDrop\", 2);\n\t\tthis._kanban_event(\"onAfterDrop\",\"onListAfterDrop\", 2);\n\t\tthis._kanban_event(\"onBeforeDragIn\", \"onListBeforeDragIn\", 2);\n\t\tthis._kanban_event(\"onDragOut\", \"onListDragOut\", 2);\n\n\t\tthis.on_click.webix_kanban_user_avatar = this._handle_icons;\n\t\tthis.on_click.webix_kanban_footer_icon = this._handle_icons;\n\t},\n\t_handle_icons(e,id,node){\n\t\tvar icon = node.getAttribute(\"webix_icon_id\");\n\t\tvar all = this.type.icons;\n\n\t\t//per-icon click handlers\n\t\tif (all){\n\t\t\tfor (var i=0; i<all.length; i++){\n\t\t\t\tif (typeof all[i] === \"object\" && (all[i].id || all[i].icon) === icon){\n\t\t\t\t\tif (all[i].click){\n\t\t\t\t\t\tall[i].click.call(this,id,e,node,this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (icon === \"$avatar\")\n\t\t\tthis.getKanban().callEvent(\"onAvatarClick\", [id, e, node, this]);\n\t\telse\n\t\t\tthis.getKanban().callEvent(\"onListIconClick\", [icon, id, e, node, this]);\n\t},\n\t$dragCreate: function(a,e){\n\t\tconst text = webix.DragControl.$drag(a,e);\n\t\tif (!text) return false;\n\n\t\t// hide context menus\n\t\twebix.callEvent(\"onClick\", []);\n\n\t\tconst drag_container = document.createElement(\"DIV\");\n\t\tdrag_container.innerHTML = text;\n\t\tdrag_container.className = \"webix_drag_zone webix_kanban_drag_zone\";\n\t\tdocument.body.appendChild(drag_container);\n\t\treturn drag_container;\n\t},\n\t$dropHTML: function(){\n\t\treturn \"<div class='webix_kanban_drop_inner'></div>\";\n\t},\n\teachOtherList:function(code){\n\t\tvar self = this.config.id;\n\t\tvar master = this.getKanban();\n\n\t\tmaster.eachList(function(view){\n\t\t\tif (view.config.id != self)\n\t\t\t\tcode.call(webix.$$(self), view);\n\t\t});\n\t},\n\tdefaults:{\n\t\tdrag:\"move\",\n\t\tselect:true\n\t}\n};","import {type} from \"./common\";\n\nwebix.protoUI({\n\tname:\"kanbanlist\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tscroll:\"auto\",\n\t},\n\ttype: type\n}, webix.ui.list, webix.KanbanView);","import {type} from \"./common\";\n\nvar dtype = webix.copy(type);\ndtype.width = 200;\n\nwebix.protoUI({\n\tname:\"kanbandataview\",\n\t$init(){\n\t\tthis.$view.className += \" webix_kanban_list\";\n\t\tthis.$ready.push(webix.bind(this._setHandlers,this));\n\t},\n\tdefaults:{\n\t\tprerender:true,\n\t},\n\ttype:dtype\n}, webix.ui.dataview, webix.KanbanView);","import {isImage, getIconName} from \"./helpers/image\";\n\nwebix.protoUI({\n\tname:\"kanbanuploader\",\n\t$init(){\n\t\tthis.files.data.scheme({\n\t\t\t$init:(obj) =>{\n\t\t\t\tif (typeof obj.link === \"string\" && obj.link){\n\t\t\t\t\tobj.name = obj.name || obj.link.split(\"/\").pop();\n\t\t\t\t\tobj.type = obj.type || obj.name.split(\".\").pop();\n\t\t\t\t\tobj.status = obj.status || \"server\";\n\t\t\t\t}\n\t\t\t\tobj.sizetext = obj.sizetext || this._format_size(obj.size);\n\t\t\t}\n\t\t});\n\n\t\tthis.files.data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tlet view = webix.$$(this.config.link);\n\t\t\tlet html = \"<span class='webix_strong'>\" + (webix.i18n.kanban.dnd||\"\") + \"</span>\";\n\t\t\tif (!this.files.data.count())\n\t\t\t\tview.showOverlay(html);\n\t\t\telse view.hideOverlay();\n\t\t});\n\t},\n\tdefaults:{\n\t\ticon:\"webix_kanban_icon kbi-upload\",\n\t},\n\tgetValue(){\n\t\tlet data = [];\n\t\tthis.files.data.each(function(obj){\n\t\t\tif (obj.status === \"server\")\n\t\t\t\tdata.push( {id:obj.id, link:obj.link, size:obj.size} );\n\t\t});\n\t\treturn data;\n\t},\n\t_format_size(size){\n\t\tlet index = 0;\n\t\twhile (size > 1024){\n\t\t\tindex++;\n\t\t\tsize = size/1024;\n\t\t}\n\t\treturn Math.round(size*100)/100 + \" \" + webix.i18n.fileSize[index];\n\t}\n}, webix.ui.uploader);\n\nwebix.type(webix.ui.dataview, {\n\tname:\"uploader\",\n\theight:91,\n\twidth:161,\n\ttemplate:(obj, common) => {\n\t\treturn `<a${(obj.status === \"server\") ? ` href=\"${obj.link}\" download=\"${obj.name}\"` : \"\"}></a>\n\t\t\t\t${common.body(obj)}\n\t\t\t\t${common.title(obj,common)}\n\t\t\t\t${common.removeIcon(obj)}`;\n\t},\n\tbody:function(obj){\n\t\tif (obj.status === \"server\" && isImage(obj.type))\n\t\t\treturn `<div class=\"webix_kanban_uploader_body\"><img src=\"${obj.link}\"></div>`;\n\n\t\treturn `<div class='webix_kanban_uploader_body'>\n\t\t\t\t\t<span class='webix_icon webix_kanban_icon kbi-file${getIconName(obj.type)}'></span>\n\t\t\t\t</div>`;\n\t},\n\ttitle:function(obj,common){\n\t\treturn `<div class=\"webix_kanban_uploader_title\" title=\"${obj.name}\">\n\t\t\t\t\t${common.progress(obj)}\n\t\t\t\t\t<div class=\"webix_kanban_uploader_label\">${obj.name}</div>\n\t\t\t\t</div>`;\n\t},\n\tprogress:function(obj){\n\t\tswitch(obj.status){\n\t\t\tcase \"client\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.sizetext+\"</span>\";\n\t\t\tcase \"transfer\": return \"<span class='webix_kanban_uploader_progress'>\"+obj.percent+\"%</span>\";\n\t\t\tcase \"server\": return \"<span class='webix_kanban_uploader_progress_server'>\"+obj.sizetext+\"</span>\";\n\t\t\tdefault: return \"<span class='webix_kanban_uploader_progress_error'>ERROR</span>\";\n\t\t}\n\t},\n\tremoveIcon:function(){\n\t\treturn \"<div class='webix_kanban_remove_upload'><span class='webix_icon wxi-close'></span></div>\";\n\t},\n\ton_click:{\n\t\t\"webix_kanban_remove_upload\":function(ev, id){\n\t\t\twebix.$$(this.config.uploader).files.remove(id);\n\t\t\treturn webix.html.preventEvent(ev);\n\t\t}\n\t}\n});","import \"./header\";\nimport \"./list\";\nimport \"./dataview\";\nimport \"./editor\";\nimport \"./userlist\";\nimport \"./menu\";\nimport \"./comments\";\n\nimport \"./locale\";\n\nfunction defaultSetter(a, sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\"){\n\t\tfor (var key in status)\n\t\t\ta[key] = status[key];\n\t} else if (typeof status === \"function\"){\n\t\tstatus.call(sub, a, true);\n\t} else {\n\t\ta.status = status;\n\t}\n}\nfunction defaultFilter(sub){\n\tvar status = sub.config.status;\n\n\tif (typeof status === \"object\")\n\t\treturn function(a){\n\t\t\tfor (var key in status){\n\t\t\t\tif (a[key] != status[key])\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\tif (typeof status === \"function\")\n\t\treturn function(a){ return status.call(sub, a); };\n\n\treturn function(a){ return a.status === status; };\n}\n\nwebix.protoUI({\n\tname:\"kanban\",\n\tdefaults:{\n\t\tdelimiter:\",\"\n\t},\n\t$skin:function(){\n\t\tthis.defaults.type = \"space\";\n\t},\n\t$init(config){\n\t\tthis.$view.className += \" webix_kanban\";\n\n\t\tthis.data.provideApi(this, true);\n\t\tthis.data.scheme({\n\t\t\t$change:(obj) =>{\n\t\t\t\tif (typeof obj.tags === \"string\")\n\t\t\t\t\tobj.tags = this._strToArr(obj.tags);\n\t\t\t}\n\t\t});\n\t\tthis._destroy_with_me = [];\n\n\t\tthis._statuses = new webix.DataCollection();\n\t\tthis._destroy_with_me.push(this._statuses);\n\n\t\tthis._tags = this._data_unification(config.tags);\n\t\tthis._users = this._data_unification(config.users);\n\t\tthis._colors = this._data_unification(config.colors);\n\t\tthis.$ready.push(function(){\n\t\t\tthis.reconstruct();\n\t\t\tthis._initEditor();\n\t\t\tthis._initUserList();\n\t\t\tthis._initMenu();\n\t\t\tthis._initComments();\n\t\t\tthis.data.attachEvent(\"onStoreUpdated\",\n\t\t\t\t(id, data, mode) => this._applyOrder(id, data, mode));\n\t\t\tthis.data.attachEvent(\"onIdChange\",\n\t\t\t\t(oldid, newid) => {\n\t\t\t\t\tthis.getOwnerList(oldid).data.changeId(oldid, newid);\n\t\t\t\t});\n\t\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\t\tfor (let i = 0; i < this._destroy_with_me.length; i++)\n\t\t\t\t\tthis._destroy_with_me[i].destructor();\n\t\t\t});\n\t\t});\n\n\t\t//override default api of datastore\n\t\tthis.serialize = this._serialize;\n\t},\n\t_strToArr(value){\n\t\tif (value){\n\t\t\treturn value.split(this.config.delimiter);\n\t\t}\n\t\treturn [];\n\t},\n\tgetTags(){\n\t\treturn this._tags;\n\t},\n\tgetUsers(){\n\t\treturn this._users;\n\t},\n\tgetColors(){\n\t\treturn this._colors;\n\t},\n\tgetStatuses(){\n\t\treturn this._statuses.serialize();\n\t},\n\tcardActions_setter(value){\n\t\tif (value === true) value = [\"edit\", \"copy\", \"remove\"];\n\t\tif (webix.isArray(value)){\n\t\t\treturn value.map((v) => {\n\t\t\t\treturn { id:v, value:webix.i18n.kanban.menu[v]||v };\n\t\t\t});\n\t\t}\n\t},\n\tshowEditor(obj){\n\t\tlet editor = this.getEditor();\n\t\tif (this.callEvent(\"onBeforeEditorShow\", [editor, obj]) && editor){\n\t\t\teditor.setValues(obj);\n\t\t\teditor.show();\n\t\t\tthis.callEvent(\"onAfterEditorShow\", [editor, obj]);\n\t\t}\n\t},\n\tcopy(id){\n\t\tif (this.callEvent(\"onBeforeCopy\", [id])){\n\t\t\tlet item = webix.copy(this.getItem(id));\n\t\t\tdelete item.id;\n\t\t\titem.text = webix.i18n.kanban.copy + \" \" + (item.text || \"\");\n\t\t\tlet sid = this.add(item);\n\t\t\tlet list = this.getOwnerList(sid);\n\t\t\tlist.move(sid, list.getIndexById(id)+1, list);\n\n\t\t\tthis.callEvent(\"onAfterCopy\", [id]);\n\t\t}\n\t},\n\t_removeCard(id){\n\t\tvar promise = webix.promise.defer();\n\n\t\tif (webix.i18n.kanban.confirm){\n\t\t\twebix.confirm({\n\t\t\t\ttext:webix.i18n.kanban.confirm,\n\t\t\t\tcallback:(result) => {\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tthis.remove(id);\n\t\t\t\t\t\tpromise.resolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.remove(id);\n\t\t\tpromise.resolve();\n\t\t}\n\n\t\treturn promise;\n\t},\n\t_data_unification(value){\n\t\tif (value && value.getItem)\n\t\t\treturn value;\n\t\telse {\n\t\t\tlet data = new webix.DataCollection();\n\t\t\tthis._destroy_with_me.push(data);\n\t\t\tif(value && typeof value === \"string\")\n\t\t\t\tdata.load(value);\n\t\t\telse\n\t\t\t\tdata.parse(value||[]);\n\t\t\treturn data;\n\t\t}\n\t},\n\tgetEditor(){\n\t\treturn webix.$$(this._editor);\n\t},\n\tgetUserList(){\n\t\treturn webix.$$(this._userList);\n\t},\n\tgetMenu(){\n\t\treturn webix.$$(this._menu);\n\t},\n\tgetComments(){\n\t\treturn webix.$$(this._comments);\n\t},\n\t_initEditor(){\n\t\tif (this.config.editor){\n\t\t\tlet editor = webix.ui( {view:\"kanbaneditor\", master:this.config.id} );\n\n\t\t\tthis._editor = editor.config.id;\n\t\t\tthis._destroy_with_me.push(editor);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id) => {\n\t\t\t\tif (icon === \"editor\") this.showEditor(webix.copy( this.getItem(id) ));\n\t\t\t});\n\t\t\tthis.attachEvent(\"onListItemDblClick\", (id) => this.showEditor(webix.copy( this.getItem(id) )));\n\t\t}\n\t},\n\t_initUserList(){\n\t\tif (this.config.userList){\n\t\t\tlet userlist = typeof this.config.userList === \"object\"?this.config.userList:{};\n\t\t\twebix.extend(userlist, {view:\"kanbanuserlist\", masterId:this.config.id, data:this._users}, true);\n\t\t\tuserlist = webix.ui(userlist);\n\n\t\t\tthis._userList = userlist.config.id;\n\t\t\tthis._destroy_with_me.push(userlist);\n\t\t\t\n\t\t\tthis.attachEvent(\"onAvatarClick\", (id, e, node) => {\n\t\t\t\tlet userList = this.getUserList();\n\t\t\t\tuserList.setContext({id:id, user_id:this.getItem(id).user_id});\n\t\t\t\tuserList.show(node);\n\t\t\t});\n\t\t}\n\t},\n\t_initMenu(){\n\t\tif (this.config.cardActions){\n\t\t\tlet menu = webix.ui( {view:\"kanbanmenu\", data:this.config.cardActions, masterId:this.config.id} );\n\n\t\t\tthis._menu = menu.config.id;\n\t\t\tthis._destroy_with_me.push(menu);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"menu\"){\n\t\t\t\t\tlet menu = this.getMenu();\n\t\t\t\t\tmenu.setContext( {id:id} );\n\t\t\t\t\tmenu.show(node);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_initComments(){\n\t\tif (this.config.comments){\n\t\t\tlet body = typeof this.config.comments === \"object\"?this.config.comments:{};\n\t\t\tbody = webix.extend({width:400, height:400}, body, true);\n\t\t\twebix.extend(body, { view:\"comments\", users:this._users }, true);\n\t\t\tlet comments = webix.ui( {view:\"kanbanchat\", body:body, masterId:this.config.id} );\n\n\t\t\tthis._comments = comments.config.id;\n\t\t\tthis._destroy_with_me.push(comments);\n\n\t\t\tthis.attachEvent(\"onListIconClick\", (icon, id, e, node) => {\n\t\t\t\tif (icon === \"comments\" && this.callEvent(\"onBeforeCommentsShow\", [id, e, node])){\n\t\t\t\t\tlet chat = this.getComments();\n\t\t\t\t\tlet pos = webix.html.offset(node);\n\t\t\t\t\tpos.y += pos.height;\n\t\t\t\t\t\n\t\t\t\t\tchat.hide();\n\t\t\t\t\tlet comments = chat.getBody();\n\t\t\t\t\tlet data = this.getItem(id).comments || [];\n\n\t\t\t\t\tcomments.parse( webix.copy(data) );\n\t\t\t\t\tchat.setContext( {id:id} );\n\t\t\t\t\tchat.show(pos);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\t_serialize(){\n\t\tvar d = [];\n\t\tthis.eachList(function(l){ d = d.concat(l.serialize()); });\n\t\treturn d;\n\t},\n\t_applyOrder(id, data, mode){\n\t\tif (!id) return this._syncData();\n\n\t\tswitch(mode){\n\t\t\tcase \"add\":\n\t\t\t\tif (this._assignList(data) >= 0){\n\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t\tdata.$index = this._sublists[data.$list].count();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\": {\n\t\t\t\tconst subList = this._sublists[data.$list];\n\t\t\t\tif (subList && subList.exists(id))\n\t\t\t\t\tsubList.remove(id);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"paint\":\n\t\t\tcase \"update\": {\n\t\t\t\tif (this.getIndexById(id) === -1) break;\n\n\t\t\t\tconst prevList = data.$list;\n\t\t\t\tconst list = this._assignList(data);\n\n\t\t\t\tif (prevList === list){\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).updateItem(id, data);\n\t\t\t\t} else {\n\t\t\t\t\tif (this._sublists[prevList])\n\t\t\t\t\t\tthis._sublists[prevList].remove(id);\n\t\t\t\t\tif (list >= 0)\n\t\t\t\t\t\tthis.getOwnerList(id).add(data);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tsetListStatus(obj, list){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tif (this._sublists[i] === list){\n\t\t\t\tdefaultSetter(obj, list);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\treconstruct(){\n\t\tthis._prepareLists();\n\t\tthis._syncData();\n\t},\n\t_prepareLists(){\n\t\tthis._sublists = [];\n\t\tthis._subfilters = [];\n\t\tlet statuses = [];\n\t\tlet views = this.queryView(a => a.$kanban, \"all\");\n\n\t\tfor (let i = 0; i < views.length; i++) {\n\t\t\tlet sub = views[i];\n\t\t\tif ( sub.config.view !== \"kanbanheader\")\n\t\t\t\tthis._sublists.push(sub);\n\t\t\telse sub.config.master = this.config.id;\n\t\t}\n\n\t\tfor (let i = 0; i < this._sublists.length; i++) {\n\t\t\tlet sub = this._sublists[i];\n\t\t\tthis._subfilters[i] = defaultFilter(sub);\n\n\t\t\tif (this.config.icons){\n\t\t\t\tsub.type.icons = sub.type.icons || this.config.icons;\n\t\t\t}\n\n\t\t\tlet value = sub.config.name || (typeof sub.config.status === \"string\" && sub.config.status ?\n\t\t\t\tsub.config.status[0].toUpperCase() + sub.config.status.slice(1) : sub.config.id);\n\t\t\tstatuses.push( {id:i.toString(), value:value} );\n\n\t\t\tsub.config.master = this.config.id;\n\t\t\tsub.type.master = this.config.id;\n\t\t}\n\n\t\tthis._statuses.clearAll();\n\t\tthis._statuses.parse(statuses);\n\t},\n\t_syncData(){\n\t\tconst sets = [];\n\t\tfor (let i=0; i<this._sublists.length; i++) sets[i] = [];\n\n\t\tthis.data.each(function(item){\n\t\t\tlet j = this._assignList(item);\n\t\t\tif (j >= 0)\n\t\t\t\tsets[j].push(item);\n\t\t}, this);\n\n\t\tfor (let i=0; i<this._sublists.length; i++){\n\t\t\tconst data = sets[i];\n\n\t\t\tif (data.length > 1 && data[0].$index)\n\t\t\t\tdata.sort( (a,b) => a.$index > b.$index ? 1 : -1 );\n\n\t\t\tthis._sublists[i].clearAll();\n\t\t\tthis._sublists[i].data.importData(data);\n\t\t\tthis._sublists[i]._fixOrder();\n\t\t}\n\t},\n\t_assignList(data){\n\t\tfor (var i = 0; i < this._sublists.length; i++) {\n\t\t\tif (this._subfilters[i](data)){\n\t\t\t\treturn data.$list = i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\tgetSelectedId(){\n\t\tvar selected = null;\n\t\tthis.eachList(function(list){ selected = list.getSelectedId() || selected; });\n\t\treturn selected;\n\t},\n\tselect(id){\n\t\tthis.getOwnerList(id).select(id);\n\t},\n\tgetOwnerList(id){\n\t\tvar item = this.getItem(id);\n\t\treturn item ? this._sublists[item.$list] : null;\n\t},\n\teachList(code){\n\t\tfor (var i=0; i<this._sublists.length; i++){\n\t\t\tcode.call(this, this._sublists[i], this._sublists[i].config.status);\n\t\t}\n\t}\n}, webix.DataLoader, webix.EventSystem, webix.ui.headerlayout );","import en from \"./locales/en\";\nwebix.i18n.kanban = en;","import \"./uploader\";\n\nimport \"./locale\";\n\nwebix.protoUI({\n\tname:\"kanbaneditor\",\n\tdefaults:{\n\t\twidth:534,\n\t\tposition:\"center\",\n\t\tcss:\"webix_kanban_editor\",\n\t\tmodal:true,\n\t\tmove:true\n\t},\n\t$init(config){\n\t\tlet kanban = webix.$$(config.master);\n\n\t\tconfig.head = {\n\t\t\tview:\"toolbar\", paddingX:17, paddingY:8,\n\t\t\telements:[\n\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.add, localId:\"$kanban_header\"},\n\t\t\t\t{ view:\"icon\", icon:\"wxi-close\", click:() => this._close()}\n\t\t\t]\n\t\t};\n\n\t\tlet c = kanban.config.editor;\n\t\tlet form = { view:\"form\", borderless:true, padding:0, elementsConfig:{ labelPosition:\"top\" } };\n\t\tlet elements = [\n\t\t\t{ view:\"textarea\", label:webix.i18n.kanban.editor.text, name:\"text\", height:90},\n\t\t\t{ view:\"multicombo\", label:webix.i18n.kanban.editor.tags, name:\"tags\", options:kanban._tags, $hide:true},\n\t\t\t{ margin:8,\n\t\t\t\tcols:[\n\t\t\t\t\t{ view:\"combo\", label:webix.i18n.kanban.editor.assign, name:\"user_id\", $hide:true, options:{\n\t\t\t\t\t\tbody:{ data:kanban._users, yCount:5 }\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.color,  name:\"color\", $hide:true, options:{\n\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\tyCount:5, data:kanban._colors, css:\"webix_kanban_colorpicker\",\n\t\t\t\t\t\t\ttemplate:\"<span class='webix_kanban_color_item' style='background-color: #color#'></span>#value#\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"richselect\", label:webix.i18n.kanban.editor.status, name:\"$list\", options:{\n\t\t\t\t\t\tbody:{ data:kanban._statuses, yCount:5 }\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\t\tif (webix.isArray(c))\n\t\t\tform.elements = c;\n\t\telse if (typeof c === \"object\"){\n\t\t\tform = webix.extend(form, c, true);\n\t\t\tform.view = \"form\";\n\t\t\tform.elements = form.elements || form.rows || (form.cols ? [{cols:form.cols}] : elements);\n\t\t\tdelete form.rows; delete form.cols;\n\t\t} else form.elements = elements;\n\n\t\tif (kanban.config.attachments)\n\t\t\tform.elements.push({ margin:0, rows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"label\", label:webix.i18n.kanban.editor.attachments },\n\t\t\t\t\t\t{ view:\"kanbanuploader\", label:webix.i18n.kanban.editor.upload, upload:kanban.config.attachments,\n\t\t\t\t\t\t\tname:\"attachments\", autowidth:true, css:\"webix_transparent webix_kanban_uploader\", type:\"icon\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ view:\"dataview\", localId:\"$kanban_dataview_uploader\", yCount:1, borderless:true,\n\t\t\t\t\ttype:\"uploader\", css:\"webix_kanban_dataview_uploader\",\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonItemDblClick:(id, e, node) => {\n\t\t\t\t\t\t\tlet link = node.getElementsByTagName(\"a\")[0];\n\t\t\t\t\t\t\tlink.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]});\n\n\t\tconfig.body = { paddingX:17, paddingY:0, margin:16,\n\t\t\trows:[\n\t\t\t\tform,\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.remove, type:\"danger\", autowidth:true,\n\t\t\t\t\t\t\thidden:true, localId:\"$kanban_remove\",\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"remove\", this, values])) return;\n\n\t\t\t\t\t\t\t\tkanban._removeCard(values.id).then(() => this._close());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:webix.i18n.kanban.save, type:\"form\", autowidth:true,\n\t\t\t\t\t\t\tclick:() => {\n\t\t\t\t\t\t\t\tlet values = this.getValues({hidden:false});\n\t\t\t\t\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\t\t\t\t\tif (!kanban.callEvent(\"onBeforeEditorAction\", [\"save\", this, values])) return;\n\n\t\t\t\t\t\t\t\tthis._fixStatus(values, kanban);\n\t\t\t\t\t\t\t\tif ( kanban.exists(values.id) ){\n\t\t\t\t\t\t\t\t\tvalues.$list = kanban.getItem(values.id).$list;\n\t\t\t\t\t\t\t\t\tkanban.updateItem(values.id, values);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse kanban.add(values);\n\t\t\t\t\t\t\t\tthis._close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{ height:1 }\n\t\t\t]\n\n\t\t};\n\n\t\tthis.$ready.push(this._afterInit);\n\t},\n\t_afterInit:function(){\n\t\tthis._form = this.queryView({view:\"form\"});\n\t\tthis._removeBtn = this.queryView({localId:\"$kanban_remove\"});\n\t\tthis._header = this.queryView({localId:\"$kanban_header\"});\n\n\t\tlet uploader = this.queryView({view:\"kanbanuploader\"});\n\t\tif (uploader){\n\t\t\tlet dataview = this.queryView({localId:\"$kanban_dataview_uploader\"});\n\t\t\tuploader.define( \"link\", dataview.config.id );\n\t\t\tuploader.addDropZone(dataview.$view);\n\t\t\twebix.extend(dataview, webix.OverlayBox);\n\t\t}\n\n\t\tlet views = this.queryView({$hide:true}, \"all\");\n\t\tif (views.length)\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tfor (let i=0; i<views.length; i++)\n\t\t\t\t\tif (views[i].getList().count())\n\t\t\t\t\t\tviews[i].show();\n\t\t\t\t\telse views[i].hide();\n\t\t\t});\n\t},\n\t_fixStatus(values, kanban){\n\t\tvalues.$list = Number(values.$list) || 0;\n\t\tif (kanban._sublists[values.$list])\n\t\t\tkanban.setListStatus(values, kanban._sublists[values.$list]);\n\t},\n\tgetForm(){\n\t\treturn this._form;\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.master);\n\t},\n\tsetValues(values){\n\t\tif (typeof values !== \"object\" || !values)\n\t\t\tvalues = {};\n\t\tlet kanban = this.getKanban();\n\t\tlet listIndex = kanban._assignList(values);\n\t\tvalues.$list = values.$list || (listIndex !== -1 ? listIndex : 0);\n\n\t\tthis._prepareEditor(kanban, values.id);\n\t\tthis._form.setValues(values);\n\t},\n\tgetValues(details){\n\t\treturn this._form.getValues(details);\n\t},\n\t_prepareEditor(kanban, id){\n\t\tif (id && kanban.exists(id)){\n\t\t\tthis._removeBtn.show();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.edit);\n\t\t} else {\n\t\t\tthis._removeBtn.hide();\n\t\t\tthis._header.define(\"label\", webix.i18n.kanban.editor.add);\n\t\t}\n\t\tthis._header.refresh();\n\t},\n\t_close(){\n\t\tthis.hide();\n\t\tthis._form.clear();\n\t\tthis._prepareEditor();\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname:\"kanbanuserlist\",\n\tdefaults:{\n\t\twidth:300,\n\t\tlayout:\"y\",\n\t\tscroll:true,\n\t\tyCount:4,\n\t\tautoheight:false,\n\t\tselect:true,\n\t\ttemplate:function(obj){\n\t\t\tif (obj.image)\n\t\t\t\treturn \"<img class='webix_kanban_list_avatar' src='\"+obj.image+\"'>\"+obj.value;\n\n\t\t\treturn \"<span class='webix_icon webix_kanban_icon kbi-account webix_kanban_list_avatar'></span>\"+obj.value;\n\t\t}\n\t},\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onShow\", () => {\n\t\t\t\tlet user_id = this.getContext().user_id;\n\n\t\t\t\tif ( user_id && this.exists(user_id) ){\n\t\t\t\t\tthis.select(user_id);\n\t\t\t\t\tthis.showItem(user_id);\n\t\t\t\t} else this.unselectAll();\n\t\t\t});\n\n\t\t\tthis.attachEvent(\"onMenuItemClick\", (id) => {\n\t\t\t\tlet kanban = this.getKanban();\n\t\t\t\tlet selectedTask = this.getContext().id;\n\n\t\t\t\tkanban.updateItem(selectedTask, {user_id:id});\n\t\t\t});\n\n\t\t\tthis.type.master = this.config.masterId;\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);\n","webix.protoUI({\n\tname:\"kanbanmenu\",\n\t$init(){\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\t\tlet cid = this.getContext().id;\n\t\t\t\tlet kanban = this.getKanban();\n\n\t\t\t\tif ( kanban.callEvent(\"onBeforeCardAction\", [id, cid]) ){\n\t\t\t\t\tswitch(id){\n\t\t\t\t\t\tcase \"edit\":\n\t\t\t\t\t\t\tkanban.showEditor(webix.copy( kanban.getItem(cid) ));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"copy\":\n\t\t\t\t\t\t\tkanban.copy(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"remove\":\n\t\t\t\t\t\t\tkanban._removeCard(cid);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.contextmenu);","webix.protoUI({\n\tname:\"kanbanchat\",\n\t$init(config){\n\t\tconfig.padding = 0;\n\n\t\tthis.$ready.push(function(){\n\t\t\tthis.attachEvent(\"onHide\", this._hide_chat);\n\n\t\t\tlet list = this.queryView({view:\"list\"});\n\t\t\tlist.data.attachEvent(\"onStoreUpdated\", (id, obj, mode)=>{\n\t\t\t\tif (mode && mode !== \"paint\")\n\t\t\t\t\tthis._save();\n\t\t\t});\n\t\t});\n\t},\n\t_save(){\n\t\tlet context = this.getContext();\n\t\tlet comments = this.getBody();\n\t\tlet kanban = this.getKanban();\n\n\t\tif (context && kanban.exists(context.id))\n\t\t\tkanban.updateItem(context.id, {comments:comments.serialize()});\n\t},\n\t_hide_chat(){\n\t\tlet comments = this.getBody();\n\t\tcomments.queryView({view:\"form\"}).clear();\n\t\tcomments.queryView({view:\"list\"}).clearAll();\n\t},\n\tgetKanban(){\n\t\treturn webix.$$(this.config.masterId);\n\t}\n}, webix.ui.context);\n","webix.protoUI(\n\t{\n\t\tname: \"pivot-portlet\",\n\t\t$reorderOnly: true,\n\t\t$drag: function(object) {\n\t\t\twebix.html.addCss(this.$view, \"portlet_in_drag\");\n\t\t\tconst ctx = webix.DragControl.getContext();\n\t\t\tctx.source = ctx.from = object;\n\n\t\t\t// hide suggests\n\t\t\twebix.callEvent(\"onClick\", []);\n\n\t\t\tconst local = this.$scope.app.getService(\"local\");\n\t\t\tconst values = this.getChildViews()[0].getValues();\n\n\t\t\tlet text = \"\";\n\n\t\t\tif (values.operation == \"complex\") text = local.fixMath(values.math);\n\t\t\telse {\n\t\t\t\ttext = values.name ? local.getField(values.name).value : \"\";\n\n\t\t\t\tif (values.name2)\n\t\t\t\t\ttext += (text ? \", \" : \"\") + local.getField(values.name2).value;\n\t\t\t\telse if (!text) {\n\t\t\t\t\tconst _ = this.$scope.app.getService(\"locale\")._;\n\t\t\t\t\ttext = _(\"Field not defined\");\n\t\t\t\t} else if (values.operation) text += ` (${values.operation})`;\n\t\t\t}\n\n\t\t\tconst askin = webix.skin.$active;\n\t\t\tconst style = `width:${this.$width - askin.inputHeight}px;height:${\n\t\t\t\tthis.$height\n\t\t\t}px;`;\n\t\t\treturn `<div class=\"webix_pivot_portlet_drag\" style=\"${style}\">\n\t\t\t\t<span class=\"webix_icon ${this.config.icon}\"></span>${text}\n\t\t\t</div>`;\n\t\t},\n\t},\n\twebix.ui.portlet\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"helpers/portlet\";\n\nexport default class Property extends JetView {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name);\n\n\t\tif (!config) config = {};\n\n\t\tthis.plusLabel = config.plusLabel;\n\t\tthis.field = config.field;\n\t}\n\tconfig() {\n\t\tconst askin = webix.skin.$active;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpaddingY: 8,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"forms\",\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttemplate: `<div class=\"webix_pivot_handle_add_value\">\n\t\t\t\t\t\t<span class=\"webix_icon wxi-plus-circle\"></span><span>${this.plusLabel}</span>\n\t\t\t\t\t</div>`,\n\t\t\t\t\tcss: \"webix_pivot_add_value\",\n\t\t\t\t\theight: askin.inputHeight - 2 * askin.inputPadding,\n\t\t\t\t\tlocalId: \"addValue\",\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_pivot_handle_add_value: () => {\n\t\t\t\t\t\t\tconst forms = this.$$(\"forms\").getChildViews();\n\n\t\t\t\t\t\t\tthis.Add(null, forms.length);\n\t\t\t\t\t\t\tconst input = forms[forms.length - 1].queryView({ name: \"name\" });\n\n\t\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\twebix.html.triggerEvent(\n\t\t\t\t\t\t\t\t\tinput.getInputNode(),\n\t\t\t\t\t\t\t\t\t\"MouseEvent\",\n\t\t\t\t\t\t\t\t\t\"click\"\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.field != \"values\" &&\n\t\t\t\t\t\t\t\tforms.length == this.app.getState().fields.length\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tthis.$$(\"addValue\").hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.on(webix, \"onAfterPortletMove\", source => {\n\t\t\tif (source == this.$$(\"forms\"))\n\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, this.GetValue()]);\n\t\t});\n\t\tthis.on(webix, \"onPortletDrag\", function(active, target) {\n\t\t\tif (active.$reorderOnly)\n\t\t\t\treturn active.getParentView() === target.getParentView();\n\t\t});\n\t}\n\tListTemplate(obj) {\n\t\tconst input = this._activeInput;\n\n\t\t//wavg - complex operation, no need to correct inputs\n\t\tconst wavg =\n\t\t\tthis.field == \"values\" &&\n\t\t\tinput &&\n\t\t\t!input.$destructed && // CorrectInputs calls SetValue, which recreates inputs\n\t\t\tinput.getFormView().elements.operation.getValue() == \"wavg\";\n\n\t\tconst corrections = this.getParentView().GetCorrections()[this.field];\n\t\tconst value = obj.value;\n\n\t\tif (!wavg && corrections) {\n\t\t\tconst includes = this.CheckCorrections(corrections, obj.id);\n\n\t\t\tlet css = \"webix_pivot_list_marker\";\n\t\t\tif (includes) css += \" webix_pivot_list_marker_fill\";\n\n\t\t\treturn `<div class=\"${css}\"> ${value}</div>`;\n\t\t} else return value;\n\t}\n\tCheckCorrections(corrections, id) {\n\t\tif (this._activeInput && id == this._activeInput.getValue()) return true;\n\n\t\tconst structure = this.app.getStructure();\n\n\t\tfor (let i = 0; i < corrections.length; i++) {\n\t\t\tconst name = corrections[i];\n\t\t\tconst val = structure[name];\n\n\t\t\tif (val) {\n\t\t\t\tif (typeof val == \"string\") {\n\t\t\t\t\tif (val == id) return true;\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < val.length; j++) {\n\t\t\t\t\t\tlet value = val[j];\n\t\t\t\t\t\tif (value.name) value = value.name;\n\n\t\t\t\t\t\tif (value == id) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tlet arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst val = form.getChildViews()[0].getValues().name;\n\n\t\t\tif (val) arr.push(val);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tSetValue(val) {\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = forms.length - 1; i >= 0; i--) layout.removeView(forms[i]);\n\t\tfor (let i = 0; i < val.length; i++) {\n\t\t\tif (!val[i].external) this.Add(val[i], i);\n\t\t}\n\t}\n\tAdd(val, i) {\n\t\tthis.$$(\"forms\").addView({\n\t\t\tview: \"pivot-portlet\",\n\t\t\tmode: \"replace\",\n\t\t\tborderless: true,\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tpaddingY: 0,\n\t\t\t\tpaddingX: 2,\n\t\t\t\telements: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\tcols: this.ItemConfig(val, i),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonChange: (val, old, config) => {\n\t\t\t\t\t\tif (config == \"user\")\n\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [\n\t\t\t\t\t\t\t\tthis.field,\n\t\t\t\t\t\t\t\tthis.GetValue(),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\tItemConfig(val) {\n\t\treturn [\n\t\t\t{ width: webix.skin.$active.inputHeight }, //for portlet icon\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"name\",\n\t\t\t\tvalue: this.PrepareValue(val),\n\t\t\t\thidden: val && val.operation == \"complex\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tconst input = webix.$$(this.config.master);\n\t\t\t\t\t\t\tconst master = input.$scope;\n\n\t\t\t\t\t\t\tconst data = master.GetValue();\n\t\t\t\t\t\t\tmaster._activeInput = input;\n\n\t\t\t\t\t\t\tthis.getList().filter(val =>\n\t\t\t\t\t\t\t\tmaster.FilterSuggest(data, input.getValue(), val)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-close\",\n\t\t\t\tcss: \"webix_pivot_close_icon\",\n\t\t\t\tpivotPropertyRemove: true,\n\t\t\t\tclick: function() {\n\t\t\t\t\tconst master = this.$scope;\n\t\t\t\t\tmaster.$$(\"addValue\").show();\n\t\t\t\t\tmaster\n\t\t\t\t\t\t.$$(\"forms\")\n\t\t\t\t\t\t.removeView(this.queryView(\"pivot-portlet\", \"parent\"));\n\t\t\t\t\tmaster.app.callEvent(\"property:change\", [\n\t\t\t\t\t\tmaster.field,\n\t\t\t\t\t\tmaster.GetValue(),\n\t\t\t\t\t]);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\tPrepareValue(val) {\n\t\tif (val) {\n\t\t\tif (typeof val == \"object\") val = val.name;\n\t\t\tif (webix.isArray(val)) val = val[0];\n\t\t} else val = \"\";\n\n\t\treturn val;\n\t}\n\tFilterSuggest(data, activeVal, val) {\n\t\tval = val.id;\n\n\t\tif (val == activeVal) return true;\n\n\t\treturn !data.find(item => {\n\t\t\tif (item.name) item = item.name;\n\n\t\t\treturn val == item;\n\t\t});\n\t}\n}\n","function isSymbolAllowed(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? (code >= 48 && code <= 57) || code >= 65 : code > 191;\n}\n\nfunction getLastSymbolIndex(str, right) {\n\tif (right) {\n\t\tfor (let i = 0; i < str.length; i++) if (!isSymbolAllowed(str[i])) return i;\n\t\treturn str.length;\n\t} else\n\t\tfor (let i = str.length - 1; i >= 0; i--)\n\t\t\tif (!isSymbolAllowed(str[i])) return i + 1;\n\n\treturn 0;\n}\n\nfunction startsWith(text, start) {\n\treturn text.toLowerCase().indexOf(start.toLowerCase()) === 0;\n}\n\nwebix.protoUI(\n\t{\n\t\tname: \"suggest-math\",\n\t\t$enterKey() {\n\t\t\tconst list = this.getList();\n\t\t\tif (this.isVisible() && !list.getSelectedId() && list.count()) {\n\t\t\t\tlist.select(list.data.order[1]);\n\t\t\t\tthis._addFirst = 1;\n\t\t\t}\n\n\t\t\twebix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tdelete this._addFirst; //wait for input node change event\n\t\t\t});\n\t\t},\n\t\tdefaults: {\n\t\t\tfilter(item, value) {\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\t\tconst str = value.substring(0, cursor);\n\t\t\t\tconst search = str.substring(getLastSymbolIndex(str));\n\t\t\t\tconst nextSymbol = value.charAt(cursor);\n\n\t\t\t\tif (search && (cursor === value.length || !isSymbolAllowed(nextSymbol)))\n\t\t\t\t\tvalue = search;\n\n\t\t\t\t//groups\n\t\t\t\tif (item.disabled) {\n\t\t\t\t\tconst app = editor.$scope.app;\n\n\t\t\t\t\tif (item.id == \"$fields\") {\n\t\t\t\t\t\tconst fields = app.getState().fields;\n\t\t\t\t\t\treturn !!fields.find(obj => startsWith(obj.value, value));\n\t\t\t\t\t} else if (item.id == \"$methods\") {\n\t\t\t\t\t\tconst _ = app.getService(\"locale\")._;\n\t\t\t\t\t\tconst operations = app.getService(\"local\").operations;\n\t\t\t\t\t\treturn !!operations.find(method => startsWith(_(method.id), value));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn startsWith(item.value, value);\n\t\t\t},\n\t\t},\n\t},\n\twebix.ui.suggest\n);\n\nwebix.protoUI(\n\t{\n\t\tname: \"math-editor\",\n\t\t$init() {\n\t\t\tthis.$view.className += \" webix_el_text\";\n\t\t},\n\t\t$onBlur() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\tconst suggestClick = suggest.$view.contains(document.activeElement);\n\n\t\t\twebix.delay(() => {\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\t\t\t\tif (focus && focus.config.pivotPropertyRemove) return;\n\n\t\t\t\tif (!suggestClick)\n\t\t\t\t\tthis.callEvent(\"onChange\", [this.getValue(), null, \"user\"]);\n\t\t\t});\n\t\t},\n\t\tsetValue() {\n\t\t\tconst suggest = webix.$$(this.config.suggest);\n\n\t\t\t//handle clicks on suggest items and add first suggest value via enter\n\t\t\tif (suggest.isVisible() || suggest._addFirst) return;\n\n\t\t\twebix.ui.text.prototype.setValue.apply(this, arguments);\n\t\t},\n\t\t$setValueHere(value) {\n\t\t\tthis.setValueHere(value);\n\t\t},\n\t\tsetValueHere(value) {\n\t\t\tconst formula = this.getValue();\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst lastSymbol = getLastSymbolIndex(str2, true);\n\t\t\tstr1 += str2.substring(0, lastSymbol);\n\t\t\tstr2 = str2.substring(lastSymbol);\n\n\t\t\tif (str1[str1.length - 1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length - 1);\n\n\t\t\tstr1 = str1.substring(0, getLastSymbolIndex(str1)) + value;\n\n\t\t\tconst operations = this.$scope.app.getService(\"local\").operations;\n\t\t\tconst isMethod = operations.find(obj => obj.value == value);\n\n\t\t\tif (isMethod)\n\t\t\t\t//suggest called via up/down key\n\t\t\t\tstr1 += str2[0] == \"(\" ? \"\" : \"(\";\n\n\t\t\tthis.$setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t},\n\t},\n\twebix.ui.text\n);\n","import \"helpers/complex\";\nimport Property from \"views/config/properties\";\n\nexport default class ValuesProperty extends Property {\n\tconstructor(app, name, config) {\n\t\tsuper(app, name, config);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tthis._ = this.app.getService(\"locale\")._;\n\n\t\tthis.typeName = \"operation\";\n\t\tthis.plusLabel = this._(\"Add value\");\n\t\tthis.field = \"values\";\n\n\t\tthis.operations = this.Local.operations;\n\n\t\tthis.operations.map(operation => {\n\t\t\toperation.value = this._(operation.id);\n\t\t\treturn operation;\n\t\t});\n\t}\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.State.$changes, \"mode\", () => {\n\t\t\tthis.ToggleColors();\n\t\t});\n\t}\n\tGetValue() {\n\t\tconst forms = this.$$(\"forms\").getChildViews();\n\t\tconst arr = [];\n\n\t\tforms.forEach(form => {\n\t\t\tconst values = form.getChildViews()[0].getValues({ hidden: false });\n\t\t\tif (!webix.isUndefined(values.name2)) {\n\t\t\t\t//wavg\n\t\t\t\tif (values.name && values.name2) {\n\t\t\t\t\tvalues.name = [values.name, values.name2];\n\t\t\t\t\tdelete values.name2;\n\t\t\t\t} else values.name = \"\";\n\t\t\t}\n\n\t\t\tif (values.name == \"\" || values.math == \"\") return;\n\t\t\tif (values.math) values.math = this.OutComplexMath(values.math);\n\t\t\tarr.push(values);\n\t\t});\n\n\t\treturn arr;\n\t}\n\tItemConfig(val, i) {\n\t\tconst config = super.ItemConfig(val);\n\n\t\tlet operation;\n\t\tif (val) operation = val.operation;\n\t\telse {\n\t\t\tconst def = this.app.config.defaultOperation;\n\t\t\tconst defIndex = Math.max(this.operations.findIndex(a => a.id == def), 0);\n\t\t\toperation = this.operations[defIndex].id;\n\t\t}\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\tname: \"operation\",\n\t\t\twidth: 110,\n\t\t\tvalue: operation,\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.operations.filter(\n\t\t\t\t\tobj => obj.fields <= 2 || obj.id == \"complex\"\n\t\t\t\t),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: function(v) {\n\t\t\t\t\tthis.$scope.SetOperation(v, this);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tconfig.splice(2, 0, {\n\t\t\tview: \"richselect\",\n\t\t\thidden: this.Local.getOperation(operation).fields != 2,\n\t\t\tvalue: val && webix.isArray(val.name) ? val.name[1] : \"\",\n\t\t\tname: \"name2\",\n\t\t\toptions: {\n\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\tdata: this.app.getState().fields,\n\t\t\t},\n\t\t});\n\n\t\t//custom math\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"math-editor\",\n\t\t\tname: \"math\",\n\t\t\thidden: !val || val.operation != \"complex\",\n\t\t\tvalue: val && val.math ? this.Local.fixMath(val.math) : \"\",\n\t\t\tsuggest: {\n\t\t\t\tview: \"suggest-math\",\n\t\t\t\tdata: this.SuggestData(),\n\t\t\t},\n\t\t});\n\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst palette = this.Local.getPalette();\n\t\tconst color = (val && val.color) || this.Local.getValueColor(i);\n\n\t\tconfig.splice(1, 0, {\n\t\t\tview: \"colorpicker\",\n\t\t\thidden: this.State.mode != \"chart\",\n\t\t\tname: \"color\",\n\t\t\tcss: \"webix_pivot_value_color\",\n\t\t\tvalue: color,\n\t\t\twidth: mini ? 30 : 38,\n\t\t\tsuggest: {\n\t\t\t\ttype: \"colorboard\",\n\t\t\t\tbody: {\n\t\t\t\t\twidth: 150,\n\t\t\t\t\theight: 150,\n\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\tpalette,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn config;\n\t}\n\tToggleColors() {\n\t\tconst mode = this.State.mode;\n\n\t\tconst layout = this.$$(\"forms\");\n\t\tconst forms = layout.getChildViews();\n\n\t\tfor (let i = 0; i < forms.length; i++) {\n\t\t\tconst input = forms[i].getChildViews()[0].elements.color;\n\t\t\tif (mode == \"chart\") input.show();\n\t\t\telse input.hide();\n\t\t}\n\t}\n\tFilterSuggest() {\n\t\treturn true;\n\t}\n\tSetOperation(val, view) {\n\t\tconst form = view.getFormView();\n\t\tconst elements = form.elements;\n\n\t\tif (val == \"complex\") {\n\t\t\telements.name.hide();\n\t\t\telements.name2.hide();\n\t\t\telements.math.show();\n\n\t\t\telements.name.setValue();\n\t\t\telements.name2.setValue();\n\t\t} else if (this.Local.getOperation(val).fields == 2) {\n\t\t\telements.name.show();\n\t\t\telements.name2.show();\n\t\t\telements.math.hide();\n\t\t} else {\n\t\t\telements.name.show();\n\t\t\telements.name2.hide();\n\t\t\telements.math.hide();\n\t\t}\n\t}\n\tSuggestData() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: this._(\"Fields\"),\n\t\t\t\tid: \"$fields\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.app.getState().fields,\n\t\t\t{\n\t\t\t\tvalue: this._(\"Methods\"),\n\t\t\t\tid: \"$methods\",\n\t\t\t\tdisabled: true,\n\t\t\t\t$css: \"webix_pivot_values_section\",\n\t\t\t},\n\t\t\t...this.operations.filter(obj => obj.id != \"complex\"),\n\t\t];\n\t}\n\tOutComplexMath(math) {\n\t\tconst fields = this.app.getState().fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\t\"(\\\\(|\\\\s|,|^)(\" +\n\t\t\t\tfields\n\t\t\t\t\t.map(field => field.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\"))\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")(\\\\)|\\\\s|,|$)\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst fieldsMatch = Array.from(math.matchAll(fieldsRegex));\n\t\tfor (let i = fieldsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = fieldsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tfields.find(obj => obj.value == match[2]).id +\n\t\t\t\tmath.substring(\n\t\t\t\t\tmatch.index + match[0].length - match[3].length,\n\t\t\t\t\tmath.length\n\t\t\t\t);\n\t\t}\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\tmethods\n\t\t\t\t\t.map(method =>\n\t\t\t\t\t\tmethod.value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\")\n\t\t\t\t\t)\n\t\t\t\t\t.join(\"|\") +\n\t\t\t\t\")\\\\(\",\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\tthis.operations.find(operation => operation.value == match[2]).id +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\n\t\treturn math;\n\t}\n}\n","import Property from \"views/config/properties\";\n\nexport default class GroupProperty extends Property {\n\tconstructor(app, name) {\n\t\tsuper(app, name);\n\n\t\tthis.field = \"groupBy\";\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tpadding: 10,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"group\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: this.app.getState().fields,\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\ttemplate: obj => this.ListTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonBeforeShow: () => {\n\t\t\t\t\t\t\t\tthis._activeInput = this.$$(\"group\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\t\t\tif (source == \"user\")\n\t\t\t\t\t\t\t\tthis.app.callEvent(\"property:change\", [this.field, value]);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t}\n\tGetValue() {\n\t\treturn this.$$(\"group\").getValue();\n\t}\n\tSetValue(val) {\n\t\tthis.$$(\"group\").setValue(val);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tcomplexData: true,\n\t\t\tpadding: 10,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"type\",\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tvalue: \"bar\",\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcss: \"webix_pivot_suggest\",\n\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t{ id: \"bar\", value: _(\"Bar\") },\n\t\t\t\t\t\t\t{ id: \"line\", value: _(\"Line\") },\n\t\t\t\t\t\t\t{ id: \"radar\", value: _(\"Radar\") },\n\t\t\t\t\t\t\t{ id: \"area\", value: _(\"Area\") },\n\t\t\t\t\t\t\t{ id: \"spline\", value: _(\"Spline\") },\n\t\t\t\t\t\t\t{ id: \"splineArea\", value: _(\"Spline Area\") },\n\t\t\t\t\t\t\t{ id: \"pie\", value: _(\"Pie\") },\n\t\t\t\t\t\t\t{ id: \"donut\", value: _(\"Donut\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"xAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"X axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.title\",\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tlabel: _(\"Y axis title\"),\n\t\t\t\t\tbatch: \"axis\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scaleColor\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\teditable: true,\n\t\t\t\t\tlabel: _(\"Scale color\"),\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tview: \"colorboard\",\n\t\t\t\t\t\t\tpalette: this.app.getService(\"local\").getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"3D\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"3D\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"pieInnerText\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"pie\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Show values inside\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"stacked\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"stacked\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Stacked\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"horizontal\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"bar\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Horizontal\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"scale\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tcheckValue: \"logarithmic\",\n\t\t\t\t\tuncheckValue: \"linear\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Logarithmic scale\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"yAxis.lineShape\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tbatch: \"radar\",\n\t\t\t\t\tcheckValue: \"arc\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Circled lines\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: \"lines\",\n\t\t\t\t\tbatch: \"scale\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Lines\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.chart = Object.assign({}, out);\n\t\t\t\t\t\tthis.HandleVisibility();\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"chart\", chart => {\n\t\t\tif (!this.innerChange) {\n\t\t\t\tthis.getRoot().setValues(this.InValues(chart));\n\t\t\t\tthis.HandleVisibility();\n\t\t\t}\n\t\t});\n\t}\n\tHandleVisibility() {\n\t\tconst form = this.getRoot();\n\t\tconst type = form.getValues().type;\n\t\tconst pieBased = type == \"pie\" || type == \"donut\";\n\n\t\tif (pieBased) form.showBatch(\"pie\");\n\t\telse {\n\t\t\tform.showBatch(\"scale\");\n\t\t\tif (type == \"radar\") form.showBatch(\"radar\", true);\n\t\t\telse {\n\t\t\t\tform.showBatch(\"axis\", true);\n\t\t\t\tconst bar = type == \"bar\";\n\t\t\t\tif (bar || type == \"area\") {\n\t\t\t\t\tif (bar) form.showBatch(\"bar\", true);\n\t\t\t\t\tform.showBatch(\"stacked\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\t\tconst type = values.type.toLowerCase();\n\t\tconst stackedArea = type == \"stackedarea\";\n\n\t\tif (type.indexOf(\"bar\") != -1 || stackedArea) {\n\t\t\tif (type.indexOf(\"stacked\") != -1) values.stacked = 1;\n\t\t\tif (type.indexOf(\"h\") != -1) values.horizontal = 1;\n\t\t\tvalues.type = stackedArea ? \"area\" : \"bar\";\n\t\t}\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tconst bar = values.type == \"bar\";\n\t\tif (bar || values.type == \"area\") {\n\t\t\tif (bar && values.horizontal) {\n\t\t\t\tvalues.type += \"H\";\n\t\t\t\tdelete values.horizontal;\n\t\t\t}\n\t\t\tif (values.stacked) {\n\t\t\t\tvalues.type =\n\t\t\t\t\t\"stacked\" + values.type[0].toUpperCase() + values.type.slice(1);\n\t\t\t\tdelete values.stacked;\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableSettings extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tpadding: 10,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tname: \"cleanRows\",\n\t\t\t\t\tlocalId: \"cleanRows\",\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"Clean rows\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Highlight\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxX\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max X\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"minY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Min Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"maxY\",\n\t\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tlabelRight: _(\"Max Y\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Footer\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"footer\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tlabel: _(\"Total Column\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tname: \"totalColumn\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: 1, value: _(\"Off\") },\n\t\t\t\t\t\t{ id: 2, value: _(\"On\") },\n\t\t\t\t\t\t{ id: 3, value: _(\"Sum Only\") },\n\t\t\t\t\t],\n\t\t\t\t\tvalue: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (value, oldValue, source) => {\n\t\t\t\t\tif (source == \"user\") {\n\t\t\t\t\t\tconst out = this.OutValues(this.getRoot().getValues());\n\n\t\t\t\t\t\tthis.innerChange = true;\n\t\t\t\t\t\tthis.State.datatable = Object.assign({}, out);\n\t\t\t\t\t\tdelete this.innerChange;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"datatable\", datatable => {\n\t\t\tif (!this.innerChange) this.getRoot().setValues(this.InValues(datatable));\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tif (mode == \"table\") this.$$(\"cleanRows\").show();\n\t\t\telse this.$$(\"cleanRows\").hide();\n\t\t});\n\t}\n\tInValues(values) {\n\t\tvalues = webix.copy(values);\n\n\t\tif (values.footer) values.footer = values.footer == \"sumOnly\" ? 3 : 2;\n\t\telse values.footer = 1;\n\n\t\tif (values.totalColumn)\n\t\t\tvalues.totalColumn = values.totalColumn == \"sumOnly\" ? 3 : 2;\n\t\telse values.totalColumn = 1;\n\n\t\treturn values;\n\t}\n\tOutValues(values) {\n\t\tswitch (values.footer) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.footer;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.footer = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.footer = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch (values.totalColumn) {\n\t\t\tcase \"1\":\n\t\t\t\tdelete values.totalColumn;\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tvalues.totalColumn = true;\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\t\tvalues.totalColumn = \"sumOnly\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FilterView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss: \"webix_pivot_filter_popup\",\n\t\t\ttemplate: item => item.label,\n\t\t\tbody: {\n\t\t\t\tview: \"filter\",\n\t\t\t\tfield: \"value\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: config => {\n\t\t\t\t\t\tif (config == \"user\") {\n\t\t\t\t\t\t\tconst state = this.app.getState();\n\t\t\t\t\t\t\tconst structure = webix.copy(state.structure);\n\n\t\t\t\t\t\t\tlet value;\n\t\t\t\t\t\t\tstructure.filters = structure.filters.filter(filter => {\n\t\t\t\t\t\t\t\tconst exists = filter.name == this.field;\n\t\t\t\t\t\t\t\tconst inner = exists && !filter.external;\n\n\t\t\t\t\t\t\t\tif (inner) value = filter.value = this.filter.getValue();\n\n\t\t\t\t\t\t\t\treturn !exists || inner;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tstate.structure = structure;\n\n\t\t\t\t\t\t\tthis.app.callEvent(\"filter:change\", [this.field, value]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tShow(pos, filterObj) {\n\t\tconst popup = this.getRoot();\n\t\tconst filter = (this.filter = popup.getBody());\n\t\tthis.field = filterObj.name;\n\t\tconst list = filter.getChildViews()[2];\n\n\t\tconst field = this.Local.getField(this.field);\n\n\t\tthis.Local.collectFieldValues(this.field).then(values => {\n\t\t\tlist.clearAll();\n\t\t\tlist.parse(webix.copy(values));\n\n\t\t\tfilter.define({ mode: field.type });\n\t\t\tfilter.config.value = \"\";\n\t\t\tfilter.setValue(webix.copy(filterObj.value || {}));\n\n\t\t\tpopup.show(pos);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ModeView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst mini = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n\t\tconst config = {\n\t\t\theight: askin.toolbarHeight,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"segmented\",\n\t\t\t\t\tlocalId: \"modes\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tinputHeight: askin.inputHeight - askin.inputPadding * (mini ? 0 : 2),\n\t\t\t\t\toptionWidth: 80,\n\t\t\t\t\twidth: 244,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"table\", value: _(\"Table\") },\n\t\t\t\t\t\t{ id: \"tree\", value: _(\"Tree\") },\n\t\t\t\t\t\t{ id: \"chart\", value: _(\"Chart\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: (v, o, c) => {\n\t\t\t\t\t\t\tif (c == \"user\") this.SetMode(v);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ width: askin.dataPadding },\n\t\t\t],\n\t\t};\n\n\t\tif (this.Compact) {\n\t\t\tconfig.css = \"webix_pivot_footer\";\n\t\t\tconfig.cols[1].width = 0;\n\t\t\tconfig.cols.unshift({});\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tthis.on(this.State.$changes, \"mode\", mode => {\n\t\t\tthis.$$(\"modes\").setValue(mode);\n\t\t});\n\t}\n\n\t/**\n\t * Sets Pivot mode\n\t * @param {string} desired mode (\"table\", \"tree\", \"data\")\n\t */\n\tSetMode(value) {\n\t\tthis.State.mode = value;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport filterPopup from \"views/filter\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\");\n\t\tthis.State = this.getParam(\"state\");\n\n\t\tlet config;\n\t\tif (this.Compact) {\n\t\t\tconfig = {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"pt-settings\",\n\t\t\t\tinputHeight: webix.skin.$active.buttonHeight,\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tconst label = _(\"Configure Pivot\");\n\t\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t\t// 20px icon width and 8px additional padding\n\t\t\tconst width = 20 + 8 + webix.html.getTextSize(label, css).width;\n\t\t\tconfig = {\n\t\t\t\tview: \"template\",\n\t\t\t\tborderless: true,\n\t\t\t\twidth,\n\t\t\t\ttemplate: () => {\n\t\t\t\t\treturn `\n\t\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t\t<span class=\"pt-settings webix_pivot_toolbar_icon\"></span>`;\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_pivot_settings: () => this.ToggleConfig(),\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t\tconfig.localId = \"config\";\n\t\tconfig.css = \"webix_pivot_settings\";\n\t\tconfig.tooltip = _(\"Click to configure\");\n\n\t\tconst scrollSize = webix.env.$customScroll ? 0 : this._GetScrollWidth();\n\t\tconst height = webix.skin.$active.toolbarHeight + scrollSize;\n\n\t\tlet css = \"webix_pivot_toolbar\";\n\t\tif (scrollSize) {\n\t\t\twebix.html.addStyle(\n\t\t\t\t`.webix_pivot_bar_with_scroll .webix_pivot_settings>.webix_template{ line-height: ${height}px; }`\n\t\t\t);\n\t\t\tcss += \" webix_pivot_bar_with_scroll\";\n\t\t}\n\n\t\tconst result = {\n\t\t\tcss,\n\t\t\tmargin: this.Compact ? 12 : 0,\n\t\t\tpadding: {\n\t\t\t\tleft: this.Compact ? webix.skin.$active.inputPadding : 0,\n\t\t\t},\n\t\t\theight,\n\t\t\tcols: [config, this.GetFilters()],\n\t\t};\n\n\t\tif (!this.Compact) result.cols.push(ModeView);\n\n\t\treturn result;\n\t}\n\n\tinit() {\n\t\tthis.filterPopup = this.ui(filterPopup);\n\n\t\tthis.on(this.State.$changes, \"fields\", fields => {\n\t\t\tif (fields.length) {\n\t\t\t\t// render filters after fields set\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old && this.FiltersChanged(structure, old)) {\n\t\t\t\tconst filtersView = this.$$(\"filters\").getParentView();\n\t\t\t\twebix.ui(this.GetFilters(), filtersView);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", val => {\n\t\t\tthis.ToggleReadonly(val);\n\t\t});\n\t}\n\t/**\n\t * Compares filters when structure changes\n\t * @param {Object} structure - current structure\n\t * @param {Object} oldStructure - previous structure\n\t * @returns {boolean} result of comparison\n\t */\n\tFiltersChanged(structure, oldStructure) {\n\t\tif (structure.filters.length == oldStructure.filters.length) {\n\t\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\t\tconst filter = structure.filters[i];\n\t\t\t\tconst old = oldStructure.filters[i];\n\t\t\t\tif (filter.name != old.name || filter.external != old.external)\n\t\t\t\t\treturn true;\n\t\t\t\tif (JSON.stringify(filter.value) != JSON.stringify(old.value))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t} else return true;\n\n\t\treturn false;\n\t}\n\t/**\n\t * Toggles the configuration window\n\t */\n\tToggleConfig() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/**\n\t * Controls visibility of a button with Pivot settings\n\t * @param {boolean} val - indicates whether Pivot is in a readonly mode\n\t */\n\tToggleReadonly(val) {\n\t\tif (val) this.$$(\"config\").hide();\n\t\telse this.$$(\"config\").show();\n\t}\n\t/**\n\t * Gets configuration for toolbar filters\n\t * @returns {Object} layout with all filters\n\t */\n\tGetFilters() {\n\t\tconst structure = this.State.structure;\n\t\tconst filters = [];\n\n\t\tif (this.State.fields.length)\n\t\t\t// toolbar renders before fields set\n\t\t\tstructure.filters.forEach(filter => {\n\t\t\t\tif (!filter.external) filters.push(this.FilterConfig(filter));\n\t\t\t});\n\n\t\tconst askin = webix.skin.$active;\n\t\tconst padding = (askin.toolbarHeight - askin.buttonHeight) / 2;\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tborderless: true,\n\t\t\tscroll: \"x\",\n\t\t\tbody: {\n\t\t\t\tmargin: 8,\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: this.Compact ? 0 : 8,\n\t\t\t\t\ttop: padding + askin.inputPadding,\n\t\t\t\t\tbottom: padding + askin.inputPadding,\n\t\t\t\t},\n\t\t\t\tlocalId: \"filters\",\n\t\t\t\tcols: filters,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Gets configuration a single toolbar filter\n\t * @param {Object} filter - filter object from structure\n\t * @returns {Object} filter UI\n\t */\n\tFilterConfig(filter) {\n\t\tconst label = this.app.getService(\"local\").getField(filter.name).value;\n\t\tconst css = \"webix_template webix_pivot_measure_size\";\n\n\t\t// 20px icon width and 8px additional padding\n\t\tconst width =\n\t\t\t(this.Compact ? 0 : 20 + 8) + webix.html.getTextSize(label, css).width;\n\t\treturn {\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\twidth,\n\t\t\tcss: \"webix_pivot_filter\",\n\t\t\ttemplate: () => {\n\t\t\t\tconst value = filter.value;\n\t\t\t\tconst activeCss =\n\t\t\t\t\tvalue && (value.includes || value.condition.filter)\n\t\t\t\t\t\t? \"webix_pivot_active_filter\"\n\t\t\t\t\t\t: \"\";\n\t\t\t\tconst icon = !this.Compact\n\t\t\t\t\t? \"<span class='pt-filter webix_pivot_toolbar_icon'></span>\"\n\t\t\t\t\t: \"\";\n\t\t\t\treturn `<div class=\"webix_pivot_filter_inner ${activeCss}\">\n\t\t\t\t\t<span>${label}</span>\n\t\t\t\t\t${icon}\n\t\t\t\t</div>`;\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_pivot_filter: function() {\n\t\t\t\t\tthis.$scope.filterPopup.Show(this.$view, filter);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t_GetScrollWidth() {\n\t\tconst outer = webix.html.create(\"DIV\", {\n\t\t\tstyle: \"visibility:hidden;overflow:scroll;\",\n\t\t});\n\t\tconst inner = webix.html.create(\"DIV\");\n\n\t\tdocument.body.appendChild(outer);\n\t\touter.appendChild(inner);\n\n\t\tconst scrollbarWidth = outer.offsetWidth - inner.offsetWidth;\n\n\t\touter.parentNode.removeChild(outer);\n\t\treturn scrollbarWidth;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst chart = {\n\t\t\tview: \"chart\",\n\t\t\t$mainView: true,\n\t\t\tborderless: true,\n\t\t\tlocalId: \"data\",\n\t\t\txAxis: {},\n\t\t\tyAxis: {},\n\t\t};\n\n\t\twebix.extend(chart, webix.copy(state.chart), true);\n\n\t\tconst type = chart.type;\n\t\tif (type == \"barH\" || type == \"stackedBarH\") {\n\t\t\tif (!chart.yAxis.template)\n\t\t\t\tchart.yAxis.template = obj => obj[obj.length - 1];\n\t\t} else if (!chart.xAxis.template)\n\t\t\tchart.xAxis.template = obj => obj[obj.length - 1];\n\n\t\tconst commonAxisSettings = {\n\t\t\tlines: chart.lines,\n\t\t};\n\n\t\t//save default chart line color\n\t\tif (chart.scaleColor)\n\t\t\tcommonAxisSettings.color = commonAxisSettings.lineColor =\n\t\t\t\tchart.scaleColor;\n\n\t\twebix.extend(chart.xAxis, commonAxisSettings, true);\n\t\twebix.extend(chart.yAxis, commonAxisSettings, true);\n\n\t\tif (this.IsPieBased()) {\n\t\t\twebix.extend(\n\t\t\t\tchart,\n\t\t\t\t{\n\t\t\t\t\tmultilevel: true,\n\t\t\t\t\ttooltip: this.ValueFormat,\n\t\t\t\t\tcolor: \"#color#\",\n\t\t\t\t\ttype: type + (chart[\"3D\"] ? \"3D\" : \"\"),\n\t\t\t\t\tpieInnerText: chart[\"pieInnerText\"] ? this.ValueFormat : \"\",\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\treturn chart;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"chart\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a chart\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateChart(data);\n\t\t});\n\t}\n\t/**\n\t * Updates chart data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateChart(data) {\n\t\tthis.$$(\"data\").clearAll();\n\n\t\tif (!this.IsPieBased()) {\n\t\t\tthis.$$(\"data\").removeAllSeries();\n\t\t\tthis.SetSeries(data.values);\n\t\t}\n\n\t\tthis.SetLegend(data.values);\n\t\tthis.$$(\"data\").parse(data.data);\n\t}\n\t/**\n\t * Checks if chart is pie based\n\t * @param {string} type (optional) - chart type\n\t * @returns {boolean} is pie based\n\t */\n\tIsPieBased(type) {\n\t\tif (!type) type = this.State.chart.type;\n\t\treturn type == \"pie\" || type == \"donut\";\n\t}\n\t/**\n\t * Sets chart series\n\t * @param {Array} values - array of values for series\n\t */\n\tSetSeries(values) {\n\t\tfor (let i = 0; i < values.length; i++)\n\t\t\tthis.$$(\"data\").addSeries(this.GetSeriesConfig(values[i], i));\n\t}\n\t/**\n\t * Prepares chart series\n\t * @param {object} settings - values for series\n\t * @param {number} i - index\n\t * @param {string} type - chart type (customizations)\n\t */\n\tGetSeriesConfig(settings, i, type) {\n\t\ttype = type || this.State.chart.type;\n\t\treturn {\n\t\t\ttype,\n\t\t\tvalue: obj => obj[i],\n\t\t\talpha: type == \"area\" || type == \"splineArea\" ? 0.7 : 1,\n\t\t\tcolor: settings.color,\n\t\t\ttooltip: obj => this.ValueFormat({ value: obj[i] }),\n\t\t\titem: {\n\t\t\t\tcolor: settings.color,\n\t\t\t\tborderColor: settings.color,\n\t\t\t},\n\t\t\tline: {\n\t\t\t\tcolor: settings.color,\n\t\t\t},\n\t\t};\n\t}\n\t/**\n\t * Prepares and sets chart legend\n\t * @param {Array} values - array of values for legend\n\t */\n\tSetLegend(values) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tvalues = values.map(v => {\n\t\t\tconst operation = v.operation;\n\t\t\tlet text = v.text;\n\t\t\tif (operation == \"complex\") text = this.Local.fixMath(text);\n\t\t\telse if (operation) {\n\t\t\t\ttext = text\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.map(t => this.Local.getField(t).value)\n\t\t\t\t\t.join(\", \");\n\t\t\t\ttext = `${text} (${_(operation)})`;\n\t\t\t}\n\t\t\treturn { color: v.color, text };\n\t\t});\n\n\t\tconst legend = webix.extend(\n\t\t\t{\n\t\t\t\tvalues,\n\t\t\t\tvalign: \"middle\",\n\t\t\t\talign: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t},\n\t\t\tthis.State.chart.legend || {},\n\t\t\ttrue\n\t\t);\n\t\tthis.$$(\"data\").define({ legend });\n\t}\n\t/**\n\t * Formats tooltip values / inner text\n\t * @param {object} item - data item\n\t * @returns {number} formatted value\n\t */\n\tValueFormat(item) {\n\t\treturn item.text || parseFloat(item.value || 0).toFixed(3);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Property from \"views/config/properties\";\nimport ValuesProperty from \"views/config/properties/values\";\nimport GroupProperty from \"views/config/properties/group\";\nimport ChartSettings from \"views/config/properties/chart\";\nimport TableSettings from \"views/config/properties/table\";\n\nexport default class ConfigView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tthis.State = this.app.getState();\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst toolbar = {\n\t\t\ttype: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: 16,\n\t\t\t\tright: 14, //button\n\t\t\t\ttop: 8,\n\t\t\t\tbottom: 4,\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Done\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tautowidth: true,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: () => this.ToggleForm(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst structure = {\n\t\t\tborderless: true,\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tbody: {\n\t\t\t\tview: \"accordion\",\n\t\t\t\tcss: \"webix_pivot_configuration\",\n\t\t\t\tlocalId: \"settings\",\n\t\t\t\tmulti: true,\n\t\t\t\ttype: \"space\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: 16,\n\t\t\t\t\tright: 16,\n\t\t\t\t\ttop: 4,\n\t\t\t\t\tbottom: 16,\n\t\t\t\t},\n\t\t\t\tmargin: 20,\n\t\t\t\trows: [\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Rows\"),\n\t\t\t\t\t\t\"pt-rows\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"rows\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"rows\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add row\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Columns\"),\n\t\t\t\t\t\t\"pt-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"columns\",\n\t\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\t\tfield: \"columns\",\n\t\t\t\t\t\t\t\tplusLabel: _(\"Add column\"),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Values\"), \"pt-values\", {\n\t\t\t\t\t\tname: \"values\",\n\t\t\t\t\t\t$subview: ValuesProperty,\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Group By\"),\n\t\t\t\t\t\t\"pt-group\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"groupBy\",\n\t\t\t\t\t\t\t$subview: GroupProperty,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(_(\"Filters\"), \"pt-filter\", {\n\t\t\t\t\t\tname: \"filters\",\n\t\t\t\t\t\t$subview: new Property(this.app, \"\", {\n\t\t\t\t\t\t\tfield: \"filters\",\n\t\t\t\t\t\t\tplusLabel: _(\"Add filter\"),\n\t\t\t\t\t\t}),\n\t\t\t\t\t}),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Chart\"),\n\t\t\t\t\t\t\"pt-chart\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: ChartSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"chart\"\n\t\t\t\t\t),\n\t\t\t\t\tthis.GroupConfig(\n\t\t\t\t\t\t_(\"Table\"),\n\t\t\t\t\t\t\"wxi-columns\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$subview: TableSettings,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t),\n\t\t\t\t\t{},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows: [toolbar, structure],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.ToggleForm();\n\t\t});\n\t}\n\n\tready() {\n\t\tthis.on(this.app, \"property:change\", (field, value) => {\n\t\t\tthis.HandleFieldChange(field, value);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"structure\", () => {\n\t\t\tif (!this.innerChange) this.SetValues();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (mode, oldMode) => {\n\t\t\tconst isChart = mode == \"chart\";\n\n\t\t\tthis.$$(\"settings\").showBatch(isChart ? \"chart\" : \"table\");\n\n\t\t\t//columns can be updated in structure via groupBy\n\t\t\tif (oldMode && (isChart || oldMode == \"chart\")) this.SetValues();\n\t\t});\n\t}\n\t/** Toggles configuration form */\n\tToggleForm() {\n\t\tthis.State.config = !this.State.config;\n\t}\n\t/** Sets values into a  configuration form */\n\tSetValues() {\n\t\tconst structure = this.State.structure;\n\t\tconst inputs = [\"rows\", \"columns\", \"values\", \"filters\", \"groupBy\"];\n\n\t\tinputs.forEach(input => {\n\t\t\tconst value = structure[input] || this.State[input];\n\t\t\tconst view = this.getSubView(input);\n\t\t\tview.SetValue(value);\n\t\t});\n\t}\n\t/**\n\t * Applies changes in form fields to data structure\n\t * @param {string} field - field name\n\t * @param {string|Array} value - field value\n\t */\n\tHandleFieldChange(field, value) {\n\t\tconst structure = webix.copy(this.State.structure);\n\n\t\tif (field == \"filters\") value = this.CorrectFilters(structure, value);\n\t\telse this.CorrectInputs(structure, field, value);\n\n\t\tstructure[field] = value;\n\t\tthis.innerChange = true;\n\t\tthis.app.setStructure(structure);\n\t\tdelete this.innerChange;\n\t}\n\t/**\n\t * Prepares configuration for an accordion item with form fields\n\t * @param {string} name - accordion item header name\n\t * @param {string} icon - accordion item icon\n\t * @param {Object} config - object with form fields for this accordion item\n\t * @param {string} batch - batch name, used to control visibility\n\t * @returns {Object} configuration of the accordion item body\n\t */\n\tGroupConfig(name, icon, config, batch) {\n\t\treturn {\n\t\t\tbatch,\n\t\t\theader: `\n\t\t\t\t<span class=\"webix_icon webix_pivot_config_icon ${icon}\"></span>\n\t\t\t\t<span class=\"webix_pivot_config_label\">${name}</span>\n\t\t\t`,\n\t\t\tbody: config,\n\t\t\tborderless: true,\n\t\t};\n\t}\n\t/** Returns an object with fields that need to be corrected when some field changes */\n\tGetCorrections() {\n\t\treturn {\n\t\t\trows: [\"columns\", \"values\", \"groupBy\"],\n\t\t\tcolumns: [\"rows\", \"values\"],\n\t\t\tvalues: [\"rows\", \"columns\", \"groupBy\"],\n\t\t\tgroupBy: [\"rows\", \"values\"],\n\t\t};\n\t}\n\t/**\n\t * Prepares filters before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {Array} value - \"filters\" field value\n\t */\n\tCorrectFilters(structure, value) {\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst active = structure.filters.find(filter => {\n\t\t\t\tif (filter.name == value[i]) return true;\n\t\t\t});\n\t\t\tvalue[i] = { name: value[i] };\n\t\t\tif (active && !active.external) value[i].value = active.value;\n\t\t}\n\n\t\tconst external = structure.filters.filter(filter => filter.external);\n\t\tvalue = value.concat(external);\n\n\t\treturn value;\n\t}\n\t/**\n\t * Prepares form fields before applying them to data structure\n\t * @param {Object} structure - a copy of the current data structure\n\t * @param {string} field -  field name\n\t * @param {string|Array} value -  field value\n\t */\n\tCorrectInputs(structure, field, value) {\n\t\tconst inputs = this.GetCorrections()[field];\n\n\t\tif (inputs) {\n\t\t\tif (typeof value == \"string\") value = [value];\n\n\t\t\tvalue = value.map(v => (v.name ? v.name : v));\n\n\t\t\tinputs.forEach(input => {\n\t\t\t\tconst view = this.getSubView(input);\n\t\t\t\tlet values = view.GetValue();\n\n\t\t\t\tif (typeof values == \"string\") {\n\t\t\t\t\tif (value.find(v => v == values)) values = \"\";\n\t\t\t\t} else\n\t\t\t\t\tvalues = values.filter(v => {\n\t\t\t\t\t\tif (v.name) v = v.name;\n\n\t\t\t\t\t\treturn value.indexOf(v) == -1;\n\t\t\t\t\t});\n\n\t\t\t\tstructure[input] = values;\n\t\t\t\tview.SetValue(values);\n\t\t\t});\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class Popup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tborderless: true,\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ModeView from \"views/mode\";\nimport ToolbarView from \"views/toolbar\";\n\nimport { initRLayout } from \"@xbs/jet-helpers\";\n\nexport default class MainView extends JetView {\n\tconfig() {\n\t\tinitRLayout();\n\n\t\tconst fCompact = this.getParam(\"forceCompact\");\n\t\tif (!webix.isUndefined(fCompact)) this.setParam(\"compact\", fCompact);\n\t\tthis.Compact = this.getParam(\"compact\");\n\n\t\tconst rows = [\n\t\t\tToolbarView,\n\t\t\t{\n\t\t\t\tview: \"r-layout\",\n\t\t\t\tlocalId: \"main\",\n\t\t\t\tcols: [{ $subview: true }],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows.push(ModeView, {\n\t\t\t\t$subview: true,\n\t\t\t\tname: \"edit\",\n\t\t\t\tpopup: true,\n\t\t\t});\n\t\t} else {\n\t\t\trows[1].cols.push({\n\t\t\t\tview: \"proxy\",\n\t\t\t\tmaxWidth: 450,\n\t\t\t\tlocalId: \"edit\",\n\t\t\t\tcss: \"webix_pivot_config_container webix_shadow_medium\",\n\t\t\t\tborderless: true,\n\t\t\t\thidden: true,\n\t\t\t\tbody: { $subview: true, name: \"edit\" },\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tmargin: 0,\n\t\t\trows,\n\t\t\tview: webix.isUndefined(fCompact) ? \"r-layout\" : \"layout\",\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst state = this.getParam(\"state\");\n\n\t\tthis.$$(\"main\").sizeTrigger(\n\t\t\tthis.app,\n\t\t\tmode => this.SetCompactMode(mode),\n\t\t\t!!this.Compact\n\t\t);\n\n\t\tthis.on(state.$changes, \"mode\", mode => {\n\t\t\tthis.show(\"./\" + (mode == \"chart\" ? \"chart\" : \"table\"));\n\t\t});\n\n\t\tthis.on(state.$changes, \"config\", val => {\n\t\t\tif (val) this.ShowConfig();\n\t\t\telse this.HideConfig();\n\t\t});\n\t}\n\n\t/** Shows configuration window*/\n\tShowConfig() {\n\t\tif (this.Compact) {\n\t\t\tthis.show(\"config.popup/config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$$(\"edit\").show();\n\t\t\tthis.show(\"config\", {\n\t\t\t\ttarget: \"edit\",\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Hides configuration window*/\n\tHideConfig() {\n\t\t// we need to destroy the view inside first\n\t\tthis.show(\"_blank\", { target: \"edit\" });\n\n\t\tif (!this.Compact) this.$$(\"edit\").hide();\n\t}\n\n\tSetCompactMode(mode) {\n\t\t//let it render, then recreate\n\t\twebix.delay(() => {\n\t\t\tthis.setParam(\"compact\", mode);\n\t\t\tif (!mode) webix.fullscreen.exit();\n\t\t\tthis.refresh();\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst rows = state.structure.rows.length;\n\n\t\tconst table = {\n\t\t\tview: \"treetable\",\n\t\t\t$mainView: true,\n\t\t\tlocalId: \"data\",\n\t\t\tcss: \"webix_data_border webix_header_border\",\n\t\t\tselect: true,\n\t\t\tleftSplit: state.mode == \"table\" ? rows : rows ? 1 : 0,\n\t\t\tresizeColumn: true,\n\t\t\tborderless: true,\n\t\t\tcolumns: [],\n\t\t\tfooter: state.datatable.footer,\n\t\t};\n\n\t\twebix.extend(table, state.datatable, true);\n\n\t\treturn table;\n\t}\n\n\tinit() {\n\t\tthis.LoadData();\n\n\t\tthis.on(this.State.$changes, \"structure\", (structure, old) => {\n\t\t\tif (old) this.LoadData();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"datatable\", (val, o) => {\n\t\t\tif (o) this.refresh();\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"mode\", (val, o) => {\n\t\t\tif (o && o != \"chart\" && val != \"chart\") this.refresh();\n\t\t});\n\t}\n\t/**\n\t * Loads data to a table\n\t * @returns {Promise} promise that resolves when data is parsed\n\t */\n\tLoadData() {\n\t\treturn this.Local.getData().then(data => {\n\t\t\tthis.UpdateTable(data);\n\t\t});\n\t}\n\t/**\n\t * Updates table data\n\t * @param {Array} data - array of data\n\t */\n\tUpdateTable(data) {\n\t\tconst state = this.State;\n\t\tconst structure = state.structure;\n\n\t\tconst freeze = this.CheckFreeze();\n\n\t\tlet rightSplit = 0;\n\t\tconst totalCols = state.datatable.totalColumn;\n\t\tlet totalOps;\n\t\tif (totalCols) {\n\t\t\tconst vals = structure.values;\n\t\t\ttotalOps =\n\t\t\t\ttotalCols == \"sumOnly\" ? vals.filter(v => v.operation == \"sum\") : vals;\n\t\t\tif (freeze) rightSplit = totalOps.length;\n\t\t}\n\n\t\tlet leftSplit = 0;\n\t\tif (freeze) {\n\t\t\tconst rows = structure.rows.length;\n\t\t\tleftSplit = state.mode == \"table\" ? rows : rows ? 1 : 0;\n\t\t}\n\n\t\tif (!data.$ready) {\n\t\t\tconst total = data.totalColumn;\n\t\t\tlet lastId;\n\n\t\t\tif (total) {\n\t\t\t\tlastId = data.header[data.header.length - 1].id;\n\n\t\t\t\tfor (let i = 0; i < totalOps.length; i++) {\n\t\t\t\t\tlet name = totalOps[i].name;\n\t\t\t\t\tif (webix.isArray(name)) name = name.join();\n\n\t\t\t\t\tdata.header.push({\n\t\t\t\t\t\theader: [\n\t\t\t\t\t\t\t{ name: \"total\", colspan: rightSplit },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: name || totalOps[i].operation,\n\t\t\t\t\t\t\t\toperation: totalOps[i].operation,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tid: lastId + i + 1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst totalIndex = { i: 0 };\n\t\t\tdata = this.Local._store = {\n\t\t\t\tdata: data.data.map(item =>\n\t\t\t\t\tthis._prepareData(item, total, totalIndex, lastId)\n\t\t\t\t),\n\t\t\t\tcolumns: this.SetColumns(data.header, data.footer, data.marks),\n\t\t\t\t$ready: 1,\n\t\t\t};\n\t\t}\n\n\t\tconst table = this.$$(\"data\");\n\t\ttable.clearAll();\n\t\ttable.define({ leftSplit, rightSplit }, true);\n\t\ttable.refreshColumns(data.columns);\n\t\ttable.parse(data.data);\n\t}\n\t/**\n\t * Prepares table item (updates id, adds total cols, etc.)\n\t * @param {Array} obj - data item\n\t * @param {Array} total - array with total values for columns\n\t * @param {Object} index - current total index\n\t * @param {number} lastId - last column id\n\t * @returns {Proxy} prepared item\n\t */\n\t_prepareData(obj, total, index, lastId) {\n\t\tconst table = this.State.mode == \"table\";\n\t\tlet totalIndex;\n\n\t\tif (table || (total && !obj.data)) totalIndex = index.i++;\n\n\t\tconst item = new Proxy(obj, {\n\t\t\tget: (item, prop) => {\n\t\t\t\tif (prop == \"data\") return item.vals;\n\t\t\t\tif (table && prop == \"id\") return totalIndex + 1;\n\n\t\t\t\tconst id = prop * 1;\n\t\t\t\tif (!isNaN(id)) {\n\t\t\t\t\tconst vals = typeof item.values == \"object\" ? item.values : item;\n\n\t\t\t\t\tif (total && id > lastId && (totalIndex || totalIndex === 0)) {\n\t\t\t\t\t\treturn total[totalIndex][id - lastId - 1];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn vals[id - 1];\n\t\t\t\t}\n\n\t\t\t\treturn item[prop];\n\t\t\t},\n\t\t});\n\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.vals = obj.data.map(r => {\n\t\t\t\treturn this._prepareData(r, total, index, lastId);\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\t/**\n\t * Checks if columns should be frozen\n\t */\n\tCheckFreeze() {\n\t\tconst freezeColumns = this.app.config.freezeColumns;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn webix.isUndefined(freezeColumns) ? !compact : freezeColumns;\n\t}\n\t/**\n\t * Prepares table columns\n\t * @param {Array} columns - array with columns\n\t * @param {Array} footer - array with total values for columns\n\t * @param {Array} marks - array with min/max marks for columns\n\t * @returns {Array} column configurations\n\t */\n\tSetColumns(columns, footer, marks) {\n\t\tcolumns = webix.copy(columns);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst rows = this.State.structure.rows.length;\n\t\tconst left = this.State.mode == \"table\" ? rows : rows ? 1 : 0;\n\n\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\tif (i < left) {\n\t\t\t\tthis.SetFirstColumn(columns[i], !i && this.State.datatable.footer, _);\n\t\t\t} else {\n\t\t\t\tcolumns[i].sort = \"int\";\n\n\t\t\t\tif (!columns[i].format) columns[i].format = this.CellFormat;\n\n\t\t\t\tif (marks.length)\n\t\t\t\t\tcolumns[i].cssFormat = (v, row, rid, cid) => {\n\t\t\t\t\t\tconst col = marks[rid - 1];\n\t\t\t\t\t\tconst css = col ? col[cid - 1] : null;\n\t\t\t\t\t\treturn css ? css.join(\" \") : \"\";\n\t\t\t\t\t};\n\n\t\t\t\tconst header = columns[i].header;\n\t\t\t\tfor (let j = 0; j < header.length; j++) {\n\t\t\t\t\tlet h = header[j];\n\t\t\t\t\tif (h) {\n\t\t\t\t\t\tif (!j && h.name == \"total\") {\n\t\t\t\t\t\t\th.text = _(\"Total\");\n\t\t\t\t\t\t} else if (j == header.length - 1) {\n\t\t\t\t\t\t\th.text = this.HeaderTemplate(h, _);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (footer.length) {\n\t\t\t\t\tcolumns[i].footer = this.CellFormat(footer[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn columns;\n\t}\n\t/**\n\t * Prepares first column\n\t * @param {Object} column - column configuration\n\t * @param {boolean} footer - column with footer name\n\t * @param {function} _ - function for translating text labels\n\t */\n\tSetFirstColumn(column, footer, _) {\n\t\tif (this.State.mode == \"tree\") {\n\t\t\tcolumn.header = {\n\t\t\t\ttext: this.State.structure.rows\n\t\t\t\t\t.map(field => this.Local.getField(field).value)\n\t\t\t\t\t.join(\"<span class='webix_icon wxi-angle-right'></span>\"),\n\t\t\t\tcss: \"webix_pivot_tree_header\",\n\t\t\t};\n\t\t\tcolumn.width = 300;\n\t\t\tcolumn.template = (obj, common) => {\n\t\t\t\treturn common.treetable(obj, common) + obj[1];\n\t\t\t};\n\t\t} else {\n\t\t\tcolumn.header = this.Local.getField(column.header[0].text).value;\n\t\t\tcolumn.width = 200;\n\t\t}\n\t\tif (footer) column.footer = _(\"Total\");\n\t}\n\t/**\n\t * Sets a template for column header\n\t * @param {Object} line - object with header line properties\n\t * @param {function} _ - function for translating text labels\n\t * @returns {string} string with header text\n\t */\n\tHeaderTemplate(line, _) {\n\t\tif (!line.operation || line.operation == \"complex\")\n\t\t\treturn this.Local.fixMath(line.text);\n\t\telse {\n\t\t\tlet text = line.text.split(\",\");\n\t\t\ttext = text.map(t => this.Local.getField(t).value).join(\", \");\n\t\t\treturn `${text} <span class=\"webix_pivot_operation\">${_(\n\t\t\t\tline.operation\n\t\t\t)}</span>`;\n\t\t}\n\t}\n\t/**\n\t * Formats a cell value\n\t * @param {(number|string)} value - raw value\n\t * @returns {(number|string)} formatted value\n\t */\n\tCellFormat(value) {\n\t\tif (!value) value = value === 0 ? \"0\" : \"\";\n\n\t\treturn value ? parseFloat(value).toFixed(3) : value;\n\t}\n}\n","const asc = (a, b) => (a.key > b.key ? 1 : -1);\nconst desc = (a, b) => (a.key < b.key ? 1 : -1);\nclass DataDimension {\n    constructor(table, getValue, label, meta, sort) {\n        if (sort === \"desc\") {\n            this._sort = desc;\n        }\n        else if (sort === \"asc\") {\n            this._sort = asc;\n        }\n        else if (sort) {\n            this._sort = (a, b) => sort(a.key, b.key);\n        }\n        this._label = label;\n        this._meta = meta || null;\n        this._table = table;\n        this._getter = getValue;\n        this._prepared = 0;\n    }\n    getIndexes() {\n        return this._indexes;\n    }\n    getValue(i) {\n        return this._values[i].key;\n    }\n    getSize() {\n        return this._values.length;\n    }\n    getLabel() {\n        return this._label;\n    }\n    getOptions() {\n        this._prepareOptions();\n        return this._values.map(a => a.key);\n    }\n    getMeta() {\n        return this._meta;\n    }\n    reset() {\n        this._prepared = 0;\n    }\n    prepare() {\n        // eslint-disable-next-line\n        if (this._prepared & 1)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 1;\n        this._prepareOptions();\n        const { _table, _getter, _keys } = this;\n        const fSize = _table.count();\n        this._values.forEach((a, i) => (a.index = i));\n        const indexes = (this._indexes = new Array(fSize));\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            indexes[i] = _keys.get(key).index;\n        }\n    }\n    _prepareOptions() {\n        // eslint-disable-next-line\n        if (this._prepared & 2)\n            return;\n        // eslint-disable-next-line\n        this._prepared = this._prepared | 2;\n        const { _table, _getter } = this;\n        const fSize = _table.count();\n        const keys = (this._keys = new Map());\n        const values = (this._values = []);\n        for (let i = 0; i < fSize; i++) {\n            const key = _getter(i);\n            const index = keys.get(key);\n            if (typeof index === \"undefined\") {\n                keys.set(key, (values[values.length] = { key, index: 0 }));\n            }\n        }\n        if (this._sort)\n            values.sort(this._sort);\n    }\n}\n\nclass DataExport {\n    constructor(pivot) {\n        this._pivot = pivot;\n    }\n    toArray({ cleanRows, filters, ops }) {\n        const out = [];\n        const limit = this._pivot.getLimit();\n        const maxRow = limit.rows || 0;\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        let count = 0;\n        const header = new Set();\n        const rAggr = new Map();\n        const rowData = [];\n        // eslint-disable-next-line\n        while (true) {\n            const cAggr = {};\n            const row = this._pivot.next(header, out.length, rAggr, cAggr);\n            if (!row)\n                break;\n            out.push(row);\n            rowData.push(cAggr);\n            count++;\n            if (maxRow === count)\n                break;\n        }\n        const [scaleWidth, width] = this._pivot.getWidth();\n        if (cleanRows)\n            this._cleanRows(out, scaleWidth);\n        const result = {\n            data: out,\n            columns: Array.from(header).sort((a, b) => (a > b ? 1 : -1)),\n            width: width + scaleWidth,\n            scaleWidth,\n            rowData,\n        };\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toNested({ filters, ops }) {\n        this._pivot.filter(filters);\n        this._pivot.operations(ops);\n        this._pivot.resetCursor();\n        const rAggr = new Map();\n        const result = this._pivot.nested(rAggr);\n        result.columnData = this._pivot.aggregateColumns(result, rAggr);\n        result.marks = this._pivot.mark(result, rAggr);\n        return result;\n    }\n    toXHeader(data, config) {\n        return this._pivot.getXHeader(data, config);\n    }\n    _cleanRows(data, rowsLength) {\n        const count = data.length;\n        const prev = new Array(rowsLength);\n        for (let j = 0; j < count; j++) {\n            const row = data[j];\n            for (let i = 0; i < rowsLength; i++) {\n                if (prev[i] !== row[i]) {\n                    for (let j = i; j < rowsLength; j++)\n                        prev[j] = row[j];\n                    break;\n                }\n                row[i] = \"\";\n            }\n        }\n    }\n}\n\nfunction t(t,e){let n=\"\";const o=t.length;let r=0,i=!1,s=!1,u=0;for(;r<o;){const o=t[r];if(r++,'\"'===o)i?n+=t.substr(u,r-u):u=r-1,i=!i;else {if(i)continue;const c=\",\"===o||\"/\"===o||\"*\"===o||\"+\"===o||\"-\"===o||\"(\"===o||\")\"===o,f=\" \"===o||\"\\t\"===o||\" \\n\"===o||\"\\r\"===o;if(s){if(!c&&!f)continue;{const i=t.substr(u,r-u-1);n+=\"(\"===o?e.method(i):e.property(i),s=!1;}}if(f)continue;if(c)n+=o;else {\"0\"===o||\"1\"===o||\"2\"===o||\"3\"===o||\"4\"===o||\"5\"===o||\"6\"===o||\"7\"===o||\"8\"===o||\"9\"===o?n+=o:(s=!0,u=r-1);}}}return s&&(n+=e.property(t.substr(u,r-u))),n}function e(e,n){return new Function(n.propertyName,n.methodName,n.contextName,\"return \"+t(e,n))}\n\nfunction optimize(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        from: 0,\n        to: 0,\n        array: (i, c) => {\n            const size = c.to - c.from;\n            const temp = new Array(size);\n            const getter = cache[i];\n            for (let j = 0; j < size; j++) {\n                temp[j] = getter(c.order[j + c.from]);\n            }\n            return temp;\n        },\n    };\n    return function (from, to) {\n        ctx.from = from;\n        ctx.to = to;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeRangeGroup(table, order, code, allMath) {\n    const math = getMath(table, code);\n    const ctx = {\n        table,\n        order,\n        range: [],\n        array: (i, c) => {\n            const size = ctx.range.length;\n            const temp = [];\n            const getter = cache[i];\n            for (let j = 0; j < size; j += 2) {\n                const from = ctx.range[j];\n                const to = ctx.range[j + 1];\n                for (let i = from; i < to; i++) {\n                    temp.push(getter(c.order[i]));\n                }\n            }\n            return temp;\n        },\n    };\n    return function (range) {\n        ctx.range = range;\n        return math(0, allMath, ctx);\n    };\n}\nfunction optimizeGroup(code, allMath) {\n    const math = getGroupMath(code);\n    return function (v) {\n        return math(v, allMath, null);\n    };\n}\nlet id = 0;\nconst cache = [];\nfunction getMath(table, rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: (a) => {\n            const i = id;\n            cache[i] = table.getColumn(a).getter;\n            id += 1;\n            return `c.array(\"${i}\", c)`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\nfunction getGroupMath(rule) {\n    return e(rule, {\n        propertyName: \"d\",\n        methodName: \"m\",\n        contextName: \"c\",\n        property: () => {\n            return `d`;\n        },\n        method: (a) => {\n            return `m.${a.toLowerCase()}`;\n        },\n    });\n}\n\nconst and = (a, b) => c => a(c) && b(c);\nfunction buildFinder(data, key, value, context) {\n    const getValue = context.getter(data, key);\n    if (typeof value !== \"object\") {\n        const check = context.compare[\"eq\"](value);\n        return i => check(getValue(i));\n    }\n    else {\n        const ops = Object.keys(value);\n        let result = null;\n        for (let i = 0; i < ops.length; i++) {\n            const check = context.compare[ops[i].toLowerCase()](value[ops[i]]);\n            const step = i => check(getValue(i));\n            result = result ? and(result, step) : step;\n        }\n        return result;\n    }\n}\nfunction build(table, rule, context) {\n    const keys = Object.keys(rule);\n    let result = null;\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        const step = buildFinder(table, key, rule[key], context);\n        result = result ? and(result, step) : step;\n    }\n    return result;\n}\nfunction filter(order, table, rule, context) {\n    const filter = build(table, rule, context);\n    return order.filter(n => filter(n));\n}\n\nclass DataPivot {\n    constructor(table, rows, cols, filters, config) {\n        this._rows = rows;\n        this._cols = cols;\n        this._dims = rows.concat(cols);\n        this._table = table;\n        this._context = config;\n        this._cursor = -1;\n        this._order = this._base_order = this._sort();\n        this._data = this._dims.map(a => a.getIndexes());\n        this.filter(filters, true);\n    }\n    resetCursor() {\n        this._cursor = 0;\n        this._group = this._dims.map(() => null);\n        if (this._order.length) {\n            if (this._rows.length)\n                this._nextRow();\n            if (this._cols.length)\n                this._nextColumn();\n        }\n    }\n    next(header, index, rAggr, cAggr) {\n        const { _cursor, _cols, _order, _group, _ops, _rows } = this;\n        if (this._cursor >= _order.length)\n            return null;\n        const dimsSize = _rows.length;\n        const out = new Array(dimsSize + _ops.length * _cols.length);\n        // dimensions\n        for (let i = 0; i < dimsSize; i++)\n            out[i] = _rows[i].getValue(_group[i]);\n        // get end of next line ( all dataset for columns mode )\n        const to = this._rows.length\n            ? this._nextRow(_cols.length > 0)\n            : _order.length;\n        this._fillRow(out, index, _cursor, to, dimsSize, header, rAggr, cAggr);\n        this._cursor = to;\n        return out;\n    }\n    nested(rAggr) {\n        const { _cols, _order, _rows } = this;\n        const header = new Set();\n        const dimSize = _rows.length;\n        const dimOutSize = dimSize > 0 ? 1 : 0;\n        const levels = [{ data: [], values: [] }];\n        const data = [];\n        let prev = [];\n        let now = [];\n        let from = this._cursor;\n        let count = 0;\n        const { _groupOps } = this;\n        const _groupLength = [{}].concat(_rows.map(() => ({})));\n        const rowData = [];\n        const limit = this._context.limit.rows;\n        const width = Math.min(this._context.limit.columns, (_cols.length ? this._sizes[0] * _cols[0].getSize() : 0) + dimOutSize);\n        const closeLevels = function (j) {\n            // ignore not created, during first iteration\n            if (!levels[j])\n                return;\n            // each sub-level\n            for (; j < dimSize; j++) {\n                // get all known columns\n                for (const [kAgr, vAgr] of rAggr) {\n                    // get start of related rows\n                    const prev = _groupLength[j][kAgr] || 0;\n                    // if have new rows\n                    if (prev === 0 || vAgr.length > prev) {\n                        // check and calcualte op\n                        for (let z = 0; z < _groupOps.length; z++) {\n                            const math = _groupOps[z];\n                            if (math) {\n                                levels[j].values[dimOutSize + kAgr + z] = math(vAgr.slice(prev + 1));\n                                _groupLength[j][kAgr] = vAgr.length - 1;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        while (this._cursor < _order.length) {\n            const out = new Array(width);\n            prev = now;\n            now = [].concat(this._group);\n            // get end of next line ( all dataset for columns mode )\n            const to = this._rows.length\n                ? this._nextRow(_cols.length > 0)\n                : _order.length;\n            // calculate finished branches\n            if (_groupOps !== null) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        closeLevels(level + 1);\n                        break;\n                    }\n                }\n            }\n            const cAggr = {};\n            this._fillRow(out, data.length, from, to, dimOutSize, header, rAggr, cAggr);\n            rowData.push(cAggr);\n            // if we have row-dimensions\n            if (dimSize > 0) {\n                for (let level = 0; level < dimSize; level++) {\n                    // find level at which route differs\n                    if (now[level] != prev[level]) {\n                        // starting from that level and below\n                        for (let j = level; j < dimSize; j++) {\n                            const index = j + 1;\n                            const last = index === dimSize;\n                            // create new nodes\n                            const obj = (levels[index] = {\n                                id: last ? data.length + 1 : 0,\n                                data: last ? null : [],\n                                values: last ? out : [_rows[j].getValue(now[j])],\n                            });\n                            // store node in the parents branch\n                            levels[j].data.push(obj);\n                        }\n                        break;\n                    }\n                }\n                // store scale value in the first cell of the new row\n                out[0] = _rows[dimSize - 1].getValue(now[dimSize - 1]);\n                // store value line of the pivot ( leaf of the tree )\n                levels[dimSize].values = out;\n            }\n            else {\n                // if we have not row-dimensions, store plain data only\n                levels[0].data.push({ data: null, values: out });\n            }\n            data.push(out);\n            count++;\n            if (count >= limit)\n                break;\n            this._cursor = from = to;\n        }\n        if (_groupOps !== null) {\n            closeLevels(1);\n        }\n        const columns = Array.from(header).sort((a, b) => (a > b ? 1 : -1));\n        const result = {\n            tree: levels[0].data,\n            data,\n            width,\n            scaleWidth: dimOutSize,\n            columns,\n            rowData,\n        };\n        this._fillGroupRow(levels[0], result, rAggr, _rows.length - 1);\n        return result;\n    }\n    getLimit() {\n        return this._context.limit;\n    }\n    getWidth() {\n        return [\n            this._rows.length,\n            this._cols.length && this._ops.length\n                ? this._cols[0].getSize() * this._sizes[0]\n                : 0,\n            this._ops.length,\n        ];\n    }\n    getXHeader(result, hConfig) {\n        const { _cols, _rows, _ops, _opInfo } = this;\n        const { nonEmpty, meta } = hConfig || {};\n        const isNested = result.tree;\n        // compressed line\n        const line = [];\n        // rows prefix\n        const rpref = result.tree ? Math.min(_rows.length, 1) : _rows.length;\n        // count of operations, repeat step of bottom scale\n        const ostep = _ops.length;\n        // how many scale units in one parent\n        const unitsInParent = _cols.map(a => a.getSize());\n        // calculate full width of data\n        const length = unitsInParent.reduce((prev, value) => prev * value, ostep);\n        const columns = result.columns;\n        const fullLength = rpref +\n            Math.min(nonEmpty ? columns.length * ostep : length, this._context.limit.columns);\n        // how many data points per unit\n        let temp = length;\n        const unitSizes = unitsInParent.map(a => (temp = temp / a));\n        // result header\n        const out = [];\n        this._cols.forEach(() => out.push(new Array(fullLength)));\n        // build compressed order\n        if (nonEmpty) {\n            //check all cells, include columns of cells with data\n            for (let i = 0; i < rpref; i++)\n                line.push(i);\n            for (let j = 0; j < columns.length; j++) {\n                const base = rpref + columns[j];\n                for (let i = 0; i < ostep; i++)\n                    line.push(base + i);\n            }\n            // now check each scale line\n            for (let j = 0; j < _cols.length; j++) {\n                const step = unitSizes[j];\n                let start = -1;\n                let end = 0;\n                let colspan = 0;\n                let text;\n                // against each non-empty column\n                for (let i = rpref; i < line.length; i += ostep) {\n                    const test = line[i];\n                    // if we inside of span\n                    if (test < end) {\n                        colspan += ostep;\n                    }\n                    else {\n                        // we have reached the new span\n                        // setting old one if any\n                        if (colspan !== 0) {\n                            out[j][start] = { colspan, text };\n                        }\n                        // store position of new span\n                        const ind = Math.floor((test - rpref) / step);\n                        start = i;\n                        end = (ind + 1) * step + rpref;\n                        colspan = ostep;\n                        // store related text\n                        text = _cols[j].getValue(ind % unitsInParent[j]);\n                    }\n                }\n                // setting last span\n                if (colspan !== 0)\n                    out[j][start] = { colspan, text };\n            }\n        }\n        else {\n            // for each scale\n            for (let i = 0; i < _cols.length; i++) {\n                const size = unitsInParent[i];\n                const step = unitSizes[i];\n                let ind = 0;\n                // set value at n-th cell\n                for (let j = rpref; j < fullLength; j += step) {\n                    if (step === 1) {\n                        out[i][j] = _cols[i].getValue(ind++);\n                    }\n                    else {\n                        out[i][j] = { text: _cols[i].getValue(ind++), colspan: step };\n                    }\n                    // repeat dimension values\n                    if (ind >= size)\n                        ind = 0;\n                }\n            }\n        }\n        // add bottom line, with operations\n        if (this._ops) {\n            const opNames = new Array(fullLength);\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    opNames[j + z] = _opInfo[z].label;\n            out.push(opNames);\n        }\n        // prepend row labels\n        for (let i = 0; i < rpref; i++) {\n            const rowspan = _cols.length + (this._ops ? 1 : 0);\n            if (isNested) {\n                out[0][0] = { text: \"\", rowspan };\n                break;\n            }\n            const text = _rows[i].getLabel();\n            out[0][i] = rowspan > 1 ? { text, rowspan } : text;\n        }\n        const res = { data: out };\n        // add compression line to output\n        if (nonEmpty)\n            res.nonEmpty = line;\n        if (meta) {\n            const metaLine = new Array(fullLength);\n            for (let i = 0; i < rpref; i++)\n                metaLine[i] = _rows[i].getMeta();\n            const step = _ops.length;\n            for (let j = rpref; j < fullLength; j += step)\n                for (let z = 0; z < step; z++)\n                    metaLine[j + z] = _opInfo[z].meta;\n            res.meta = metaLine;\n        }\n        return res;\n    }\n    filter(rules, master) {\n        if (!rules || Object.keys(rules).length === 0) {\n            if (!master && this._masterRules)\n                rules = Object.assign(Object.assign({}, this._masterRules), rules);\n            else {\n                this._order = this._base_order;\n                return;\n            }\n        }\n        if (master)\n            this._masterRules = rules;\n        this._order = filter(this._base_order, this._table, rules, this._context);\n    }\n    operations(ops) {\n        const { _table, _order, _context } = this;\n        ops = ops || [];\n        this._ops = ops.map(p => optimize(_table, _order, typeof p === \"string\" ? p : p.math, _context.math));\n        this._groupResultOps = ops.map(p => p.branchMode === \"result\"\n            ? optimizeGroup(typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupResultOps.find(a => a !== null))\n            this._groupResultOps = null;\n        this._groupOps = ops.map(p => p.branchMode === \"raw\"\n            ? optimizeRangeGroup(_table, _order, typeof p === \"string\" ? p : p.branchMath || p.math, _context.math)\n            : null);\n        if (!this._groupOps.find(a => a !== null))\n            this._groupOps = null;\n        this._opInfo = ops.map(p => {\n            if (typeof p === \"string\") {\n                return { label: p, math: p };\n            }\n            else {\n                return Object.assign(Object.assign({}, p), { label: p.label || p.math });\n            }\n        });\n        this._rowResultOps = compactOps(ops, \"row\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._rowOps = compactOps(ops, \"row\", \"raw\", (x, name) => ({\n            name,\n            op: optimize(_table, _order, x, _context.math),\n        }));\n        this._colResultOps = compactOps(ops, \"column\", \"result\", (x, name) => ({\n            name,\n            op: optimizeGroup(x, _context.math),\n        }));\n        this._colOps = compactOps(ops, \"column\", \"raw\", (x, name) => ({\n            name,\n            op: optimizeRangeGroup(_table, _order, x, _context.math),\n        }));\n        this._marks = ops.map(a => a.marks || null);\n        if (!this._marks.find(a => a !== null))\n            this._marks = null;\n        this._setSizes();\n    }\n    aggregateColumns(result, rAggr) {\n        const { _colOps, _colResultOps } = this;\n        const { columns, data, scaleWidth } = result;\n        if (!_colOps && !_colResultOps)\n            return [];\n        const step = this._ops.length;\n        const out = [];\n        for (let i = 0; i < columns.length; i++) {\n            const ind = columns[i];\n            const dmr = rAggr.get(ind);\n            if (!dmr)\n                continue;\n            const keys = Array.from(dmr[0].keys());\n            for (let j = 0; j < step; j++) {\n                const column = {};\n                if (_colResultOps) {\n                    const op = _colResultOps[j];\n                    if (op) {\n                        const values = keys.map(a => data[a][ind + j + scaleWidth]);\n                        op.forEach(x => (column[x.name] = x.op(values)));\n                    }\n                }\n                if (_colOps) {\n                    const op = _colOps[j];\n                    if (op) {\n                        op.forEach(x => (column[x.name] = x.op(dmr.slice(1))));\n                    }\n                }\n                out[scaleWidth + ind + j] = column;\n            }\n        }\n        return out;\n    }\n    _optimizeGroup(ops) {\n        const config = {};\n        let exit = true;\n        for (const key in ops) {\n            const test = ops[key];\n            config[key] = optimizeGroup(test, this._context.math);\n            exit = false;\n        }\n        return exit ? null : config;\n    }\n    mark(result, rAggr) {\n        const out = [];\n        const { _marks, _ops } = this;\n        if (!_marks)\n            return out;\n        const opsLength = _ops.length;\n        const { scaleWidth, data, columnData, rowData } = result;\n        for (const [k, v] of rAggr) {\n            const r = v[0];\n            for (let i = 0; i < opsLength; i++) {\n                const marks = this._marks[i];\n                if (marks === null)\n                    continue;\n                for (const z of r) {\n                    const cid = k + i + scaleWidth;\n                    const rid = z;\n                    const cell = [];\n                    for (let j = 0; j < marks.length; j++) {\n                        if (marks[j].check(data[rid][cid], columnData[cid] || {}, rowData[rid] || {}))\n                            cell.push(marks[j].name);\n                    }\n                    if (cell.length) {\n                        let rarr = out[rid];\n                        if (typeof rarr === \"undefined\")\n                            rarr = out[rid] = [];\n                        rarr[cid] = cell;\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    __getHeaderStub() {\n        return {};\n    }\n    _fillGroupRow(obj, result, rAggr, level) {\n        const { _groupResultOps } = this;\n        const { columns, scaleWidth } = result;\n        if (_groupResultOps) {\n            for (let i = 0; i < columns.length; i++) {\n                const ind = columns[i];\n                for (let j = 0; j < _groupResultOps.length; j++) {\n                    const op = _groupResultOps[j];\n                    if (!op)\n                        continue;\n                    if (level > 0)\n                        this._fillGroupRowInner(obj, op, ind + j + scaleWidth, level);\n                }\n            }\n        }\n    }\n    _fillGroupRowInner(obj, op, ind, level) {\n        const arr = [];\n        if (level > 0) {\n            obj.data.forEach(a => {\n                const res = this._fillGroupRowInner(a, op, ind, level - 1);\n                if (res !== null) {\n                    arr.push(res);\n                }\n            });\n        }\n        else {\n            for (let i = 0; i < obj.data.length; i++) {\n                const test = obj.data[i].values[ind];\n                if (typeof test !== \"undefined\")\n                    arr.push(test);\n            }\n        }\n        if (arr.length)\n            return (obj.values[ind] = op(arr));\n        return null;\n    }\n    _fillRow(out, index, from, to, dimsSize, header, rAggr, cAggr) {\n        const { _cols, _group, _ops, _sizes, _rows, _rowResultOps, _rowOps } = this;\n        const rl = _rows.length;\n        const collectRaggr = this._colResultOps !== null ||\n            this._colOps !== null ||\n            this._marks !== null;\n        let ctemp = [];\n        if (_rowResultOps !== null)\n            ctemp = _rowResultOps.map(() => []);\n        // calculations\n        if (_ops.length) {\n            if (_cols.length) {\n                let cfrom = from;\n                while (cfrom < to) {\n                    let cind = 0;\n                    for (let i = 0; i < _cols.length; i++)\n                        cind += _sizes[i] * _group[rl + i];\n                    const cto = this._nextColumn();\n                    for (let i = 0; i < _ops.length; i++) {\n                        const temp = (out[cind + dimsSize + i] = _ops[i](cfrom, cto));\n                        if (_rowResultOps !== null)\n                            ctemp[i].push(temp);\n                    }\n                    if (collectRaggr) {\n                        let arr = rAggr.get(cind);\n                        if (!arr)\n                            rAggr.set(cind, (arr = [new Set(), cfrom, cto]));\n                        else\n                            arr.push(cfrom, cto);\n                        arr[0].add(index);\n                    }\n                    header.add(cind);\n                    this._cursor = cfrom = cto;\n                }\n            }\n            else {\n                for (let i = 0; i < _ops.length; i++) {\n                    out[i + dimsSize] = _ops[i](from, to);\n                }\n                if (collectRaggr) {\n                    let arr = rAggr.get(0);\n                    if (!arr)\n                        rAggr.set(0, (arr = [new Set(), from, to]));\n                    else\n                        arr.push(from, to);\n                    arr[0].add(index);\n                }\n                header.add(0);\n            }\n        }\n        if (_rowResultOps !== null) {\n            _rowResultOps.forEach((opset, i) => {\n                const dataset = ctemp[i];\n                if (opset && dataset.length)\n                    opset.forEach(op => {\n                        cAggr[op.name] = op.op(ctemp[i]);\n                    });\n            });\n        }\n        if (_rowOps !== null) {\n            _rowOps.forEach(opset => {\n                opset === null || opset === void 0 ? void 0 : opset.forEach(op => {\n                    cAggr[op.name] = op.op(from, to);\n                });\n            });\n        }\n    }\n    _sort() {\n        const { _table, _dims } = this;\n        const size = Math.min(_table.count(), this._context.limit.raws);\n        const order = new Array(size);\n        for (let i = 0; i < size; i++) {\n            order[i] = i;\n        }\n        const dimsSize = _dims.length;\n        const dimsData = _dims.map(a => a.getIndexes());\n        order.sort((a, b) => {\n            for (let j = 0; j < dimsSize; j++) {\n                const left = dimsData[j][a];\n                const right = dimsData[j][b];\n                if (left > right)\n                    return 1;\n                if (left < right)\n                    return -1;\n            }\n            return 0;\n        });\n        return order;\n    }\n    _nextRow(silent) {\n        const { _data, _order, _group, _rows } = this;\n        const dimsSize = _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    if (!silent)\n                        _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _nextColumn() {\n        const { _data, _order, _group, _rows, _cols } = this;\n        const dimsSize = _cols.length + _rows.length;\n        let ok = true;\n        let to = this._cursor;\n        // eslint-disable-next-line\n        while (true) {\n            const ind = _order[to];\n            for (let i = 0; i < dimsSize; i++) {\n                if (_data[i][ind] != _group[i]) {\n                    _group[i] = _data[i][ind];\n                    ok = false;\n                }\n            }\n            if (!ok)\n                break;\n            to++;\n        }\n        return to;\n    }\n    _setSizes() {\n        const sizes = this._cols.map(a => a.getSize());\n        let sum = this._ops.length || 1;\n        for (let i = sizes.length - 1; i >= 0; i--) {\n            const now = sum;\n            sum *= sizes[i];\n            sizes[i] = now;\n        }\n        this._sizes = sizes;\n    }\n}\nfunction compactOps(ops, kind, mode, optimizer) {\n    const result = ops.map(p => {\n        const row = p[kind];\n        if (!row)\n            return null;\n        const out = row\n            .map(op => {\n            const source = op.source || \"raw\";\n            if (source === mode)\n                if (typeof op === \"string\")\n                    return optimizer(op, getName(op));\n                else\n                    return optimizer(op.math, op.as || getName(op.math));\n            return null;\n        })\n            .filter(a => a !== null);\n        if (!out.length)\n            return null;\n        return out;\n    });\n    if (!result.find(a => !!a))\n        return null;\n    return result;\n}\nfunction getName(x) {\n    const end = x.indexOf(\"(\");\n    if (end === -1)\n        return x.trim();\n    return x.substring(0, end).trim();\n}\n\nclass RawTable {\n    constructor(config) {\n        this._columns = config.fields;\n        this.parse(config.data);\n    }\n    parse(data) {\n        this._raw = data;\n        this._parse_inner();\n    }\n    prepare() {\n        if (this._prepared)\n            return;\n        this._prepared = true;\n        const data = this._raw;\n        const fields = this._columns;\n        const cols = fields.filter(a => a.type === 3);\n        if (!data || !cols.length)\n            return;\n        const dataLength = data.length;\n        const columnsLength = cols.length;\n        for (let i = 0; i < dataLength; i++) {\n            for (let j = 0; j < columnsLength; j++) {\n                const col = cols[j];\n                const text = col.getter(i);\n                if (typeof text === \"string\")\n                    col.setter(i, new Date(text));\n            }\n        }\n    }\n    _parse_inner() {\n        this._columns.forEach(a => {\n            const key = a.id;\n            a.getter = i => this._raw[i][key];\n            a.setter = (i, v) => (this._raw[i][key] = v);\n        });\n    }\n    getColumn(id) {\n        return this._columns.find(a => a.id === id);\n    }\n    count() {\n        return this._raw.length;\n    }\n}\n\nclass ColumnTable extends RawTable {\n    parse(data) {\n        this._parse_init(data.length);\n        const dataLength = data.length;\n        const columnsLength = this._columns.length;\n        for (let i = 0; i < dataLength; i++) {\n            const obj = data[i];\n            for (let j = 0; j < columnsLength; j++) {\n                const col = this._columns[j];\n                col.data[i] = obj[col.id];\n            }\n        }\n    }\n    _parse_init(n) {\n        this._columns.forEach(a => {\n            const data = (a.data = new Array(n));\n            a.getter = i => data[i];\n            a.setter = (i, v) => (data[i] = v);\n        });\n    }\n    count() {\n        return this._columns[0].data.length;\n    }\n}\n\nconst methods = {\n    round: (v) => Math.round(v),\n    sum: (arr) => arr.reduce((acc, a) => acc + a, 0),\n    min: (arr) => arr.reduce((acc, a) => (a < acc ? a : acc), arr.length ? arr[0] : 0),\n    max: (arr) => arr.reduce((acc, a) => (a > acc ? a : acc), arr.length ? arr[0] : 0),\n    avg: (arr) => arr.length ? arr.reduce((acc, a) => acc + a, 0) / arr.length : 0,\n    wavg: (arr, w) => {\n        if (!arr.length)\n            return 0;\n        let count = 0;\n        let summ = 0;\n        for (let i = arr.length - 1; i >= 0; i--) {\n            count += w[i];\n            summ += arr[i] * w[i];\n        }\n        return summ / count;\n    },\n    count: (arr) => arr.length,\n    any: (arr) => (arr.length ? arr[0] : null),\n};\nconst filters = {\n    eq: (v) => (x) => x == v,\n    neq: (v) => (x) => x != v,\n    gt: (v) => (x) => x > v,\n    gte: (v) => (x) => x >= v,\n    lt: (v) => (x) => x < v,\n    lte: (v) => (x) => x <= v,\n    in: (v) => (x) => v[x],\n    hasPrefix: (v) => (x) => x.indexOf(v) === 0,\n    contains: (v) => (x) => x.indexOf(v) !== -1,\n};\nconst predicates = {\n    year: (v) => v.getFullYear(),\n    month: (v) => v.getMonth(),\n    day: (v) => v.getDate(),\n    hour: (v) => v.getHours(),\n    minute: (v) => v.getMinutes(),\n};\n\nclass Analytic {\n    constructor(cfg) {\n        this._tables = {};\n        this._dimensions = {};\n        this._preds = Object.assign({}, predicates);\n        this._maths = Object.assign({}, methods);\n        this._comps = Object.assign({}, filters);\n        if (cfg && cfg.tables)\n            cfg.tables.forEach(s => this.addTable(s));\n        if (cfg && cfg.dimensions)\n            cfg.dimensions.forEach(s => this.addDimension(s));\n    }\n    addPredicate(name, code) {\n        this._preds[name.toLowerCase()] = code;\n    }\n    addMath(name, code) {\n        this._maths[name.toLowerCase()] = code;\n    }\n    addComparator(name, code) {\n        this._comps[name.toLowerCase()] = code;\n    }\n    getDimension(id) {\n        return this._dimensions[id];\n    }\n    addDimension(s) {\n        if (this._dimensions[s.id])\n            return;\n        const table = this._tables[s.table];\n        const getter = this._predicateGetter(table, s.rule.by);\n        this._dimensions[s.id] = new DataDimension(table, getter, s.label || s.id, s.meta || s, s.sort);\n    }\n    resetDimensions(s, preserve) {\n        const prev = this._dimensions;\n        this._dimensions = {};\n        if (s)\n            s.forEach(a => {\n                const used = prev[a.id];\n                if (preserve && used)\n                    this._dimensions[a.id] = used;\n                else\n                    this.addDimension(a);\n            });\n    }\n    addTable(s) {\n        const driver = (s.driver || \"raw\") === \"raw\" ? RawTable : ColumnTable;\n        const t = (this._tables[s.id] = new driver(s));\n        if (s.prepare)\n            t.prepare();\n    }\n    getTable(id) {\n        return this._tables[id];\n    }\n    compact(table, config) {\n        const { rows, cols, filters, limit } = config;\n        const base = this._tables[table];\n        const rDims = rows ? rows.map(a => this._dimensions[a]) : [];\n        const cDims = cols ? cols.map(a => this._dimensions[a]) : [];\n        [...rDims, ...cDims].forEach(a => a.prepare());\n        const pivot = new DataPivot(base, rDims, cDims, filters, {\n            getter: this._predicateGetter.bind(this),\n            math: this._maths,\n            compare: this._comps,\n            limit: Object.assign({ rows: 10000, columns: 5000, raws: Infinity }, (limit || {})),\n        });\n        return new DataExport(pivot);\n    }\n    _predicateGetter(table, key) {\n        const find = key.indexOf(\"(\");\n        if (find !== -1) {\n            const fn = this._preds[key.substr(0, find).toLowerCase()];\n            key = key.substr(find + 1, key.length - find - 2);\n            const getter = table.getColumn(key).getter;\n            return i => fn(getter(i));\n        }\n        else {\n            return table.getColumn(key).getter;\n        }\n    }\n}\n\nexport { Analytic };\n//# sourceMappingURL=rengine.es6.js.map\n","import * as rengine from \"@xbs/rengine\";\n\nexport default class LocalData {\n\t/**\n\t * @constructor\n\t * @param {App} app - Jet App instance\n\t */\n\tconstructor(app) {\n\t\tthis._app = app;\n\t\tthis._store = {}; //aggregated data\n\n\t\tthis._filtersHash = {};\n\t\tthis._state = app.getState();\n\n\t\tif (app.config.externalProcessing) this._setOperations();\n\t\telse {\n\t\t\tthis._data = [];\n\t\t\tthis._initRengine();\n\t\t}\n\t}\n\t/** Set list of avaible operations; adds custom operations from config */\n\t_setOperations() {\n\t\tthis.operations = [\n\t\t\t{ id: \"sum\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"min\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"max\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"avg\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"wavg\", fields: 2, branchMode: \"raw\" },\n\t\t\t{ id: \"count\", fields: 1, branchMode: \"raw\" },\n\t\t\t{ id: \"any\", fields: 1, branchMode: \"result\" },\n\t\t\t{ id: \"complex\" },\n\t\t];\n\n\t\tconst config = this._app.config;\n\t\tconst extraOperations = this._app.config.operations;\n\t\tif (extraOperations) {\n\t\t\tif (config.externalProcessing)\n\t\t\t\tthis.operations = this.operations.concat(extraOperations);\n\t\t\telse\n\t\t\t\tfor (let name in extraOperations) {\n\t\t\t\t\tlet operation = extraOperations[name];\n\t\t\t\t\tlet fields, branchMode, hidden;\n\n\t\t\t\t\tif (typeof operation == \"object\") {\n\t\t\t\t\t\tfields = operation.fields || operation.handler.length;\n\t\t\t\t\t\tbranchMode = operation.branchMode;\n\t\t\t\t\t\thidden = operation.hidden;\n\t\t\t\t\t\toperation = operation.handler;\n\t\t\t\t\t} else fields = operation.length;\n\n\t\t\t\t\tthis._reng.addMath(name, operation);\n\n\t\t\t\t\tif (!hidden)\n\t\t\t\t\t\tthis.operations.push({\n\t\t\t\t\t\t\tid: name,\n\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\tbranchMode,\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t}\n\t}\n\t/** Set list of avaible total operations */\n\t_setTotalOperations() {\n\t\tthis.totalOperations = {};\n\t\tconst totalOps = this._app.config.totalOperations;\n\n\t\tif (totalOps)\n\t\t\tfor (let name in totalOps) {\n\t\t\t\tconst op = totalOps[name];\n\t\t\t\tconst all = typeof totalOps[name] == \"string\";\n\t\t\t\t[\"footer\", \"group\", \"column\"].forEach(type => {\n\t\t\t\t\tif (all || op[type]) {\n\t\t\t\t\t\tif (!this.totalOperations[type]) this.totalOperations[type] = {};\n\t\t\t\t\t\tthis.totalOperations[type][name] = all ? op : op[type];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t}\n\t/** Sets default filter rules */\n\t_setFilters() {\n\t\tfor (let type in webix.filters) {\n\t\t\tthis._reng.addComparator(type, v => test => {\n\t\t\t\tif (type == \"date\") test = test.valueOf();\n\n\t\t\t\tif (!v) return true;\n\t\t\t\telse if (v.includes) return v.includes.indexOf(test) != -1;\n\t\t\t\telse if (!v.condition.filter) return true;\n\t\t\t\telse\n\t\t\t\t\treturn webix.filters[type][v.condition.type](\n\t\t\t\t\t\ttest,\n\t\t\t\t\t\tv.condition.filter\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\t/** Adds predicates from config */\n\t_setPredicates() {\n\t\tconst predicates = this._app.config.predicates;\n\t\tif (predicates)\n\t\t\tfor (let name in predicates)\n\t\t\t\tthis._reng.addPredicate(name, predicates[name]);\n\t}\n\t/**\n\t * Returns fields that contain data\n\t * @param {object} firstRow - first row in data\n\t * @returns {array} data fields\n\t */\n\tgetFields(firstRow) {\n\t\tlet fields = this._app.config.fields;\n\n\t\tif (!fields) {\n\t\t\tfields = [];\n\n\t\t\tfor (let i in firstRow) {\n\t\t\t\tlet type;\n\n\t\t\t\tconst dataType = typeof firstRow[i];\n\t\t\t\tswitch (dataType) {\n\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\ttype = \"text\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\ttype = dataType;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttype = \"date\";\n\t\t\t\t}\n\n\t\t\t\tfields.push({ id: i, value: i, type });\n\t\t\t}\n\t\t}\n\n\t\treturn fields;\n\t}\n\t/**\n\t * Loads data and populates store\n\t * @param {boolean} force - if true, data will be reloaded\n\t * @returns {Promise} promise that resolves with store array\n\t */\n\tgetData(force) {\n\t\tif (!force && this.useOldData())\n\t\t\treturn this._dataLoad || webix.promise.resolve(this._store);\n\n\t\tconst externalProcessing = this._app.config.externalProcessing;\n\t\tif (externalProcessing || !Object.keys(this._store).length || force) {\n\t\t\treturn (this._dataLoad = this._app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.data()\n\t\t\t\t.then(data => {\n\t\t\t\t\tif (externalProcessing)\n\t\t\t\t\t\tthis._store = this._rengineToWebix(data.result, data.header);\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._table = this.getTable(data);\n\t\t\t\t\t\tthis._reng.addTable(this._table);\n\t\t\t\t\t\tthis._store = this.getPivotData();\n\t\t\t\t\t}\n\t\t\t\t\tthis._filtersHash = {};\n\t\t\t\t\treturn this._store;\n\t\t\t\t})\n\t\t\t\t.catch(error => this.loadError(error))\n\t\t\t\t.finally(() => delete this._dataLoad));\n\t\t} else {\n\t\t\tthis._store = this.getPivotData();\n\t\t\treturn webix.promise.resolve(this._store);\n\t\t}\n\t}\n\t/** Checks if pivot should use last aggregated data **/\n\tuseOldData() {\n\t\tconst state = this._state;\n\t\tlet newConfig = `${state.mode}|${JSON.stringify(state.structure)}`;\n\t\tif (state.mode == \"chart\") {\n\t\t\tconst type = state.chart.type;\n\t\t\tnewConfig += `|${type == \"pie\" || type == \"donut\"}`;\n\t\t} else newConfig += `|${JSON.stringify(state.datatable)}`;\n\n\t\tconst refresh = this._old == newConfig;\n\t\tthis._old = newConfig;\n\t\treturn refresh;\n\t}\n\t/** Inits math module */\n\t_initRengine() {\n\t\tthis._reng = new rengine.Analytic();\n\n\t\tthis._setFilters();\n\t\tthis._setOperations();\n\t\tthis._setTotalOperations();\n\t\tthis._setPredicates();\n\t}\n\t/**\n\t * Сonverts data to pivot readable form\n\t * @returns {Object} object with aggregated data and its parameters\n\t */\n\tgetPivotData() {\n\t\tif (!this._table)\n\t\t\treturn {\n\t\t\t\tdata: [],\n\t\t\t\theader: [],\n\t\t\t\ttotal: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\tconst structure = this._state.structure;\n\t\tconst mode = this._state.mode;\n\t\tconst table = this._state.datatable;\n\n\t\tthis.setDimensions();\n\n\t\tconst filters = {};\n\t\tfor (let i = 0; i < structure.filters.length; i++) {\n\t\t\tconst filter = structure.filters[i];\n\n\t\t\tconst fields = this._state.fields;\n\t\t\tconst field = fields.find(field => field.id == filter.name);\n\n\t\t\tfilters[filter.name] = { [field.type]: filter.value };\n\t\t}\n\n\t\t//groups data\n\t\tconst res = this._reng.compact(this._table.id, {\n\t\t\trows: this.getRows(),\n\t\t\tcols: this.getColumns(),\n\t\t\tlimit: this.getLimits(),\n\t\t});\n\n\t\tconst ops = this.getOps();\n\n\t\ttry {\n\t\t\tlet result;\n\n\t\t\t//plain data\n\t\t\tif (mode == \"table\")\n\t\t\t\tresult = res.toArray({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t\t//remove repetitions in 'parent' col in 'table' mode\n\t\t\t\t\tcleanRows: table.cleanRows,\n\t\t\t\t});\n\t\t\t//groupped data\n\t\t\telse\n\t\t\t\tresult = res.toNested({\n\t\t\t\t\tfilters,\n\t\t\t\t\tops,\n\t\t\t\t});\n\n\t\t\tlet headerConfig;\n\t\t\tif (mode != \"chart\") headerConfig = { meta: true, nonEmpty: true };\n\n\t\t\treturn this._rengineToWebix(result, res.toXHeader(result, headerConfig));\n\t\t} catch (e) {\n\t\t\treturn this.loadError();\n\t\t}\n\t}\n\t/**\n\t * Updates math with custom total methods\n\t * @param {string} type - total operation type (group/footer/total)\n\t * @param {string} math - operation math\n\t * @param {Array} methodsMatch - math methods pos\n\t * @returns {string} updated math\n\t */\n\t_updateTotalMath(type, math, methodsMatch) {\n\t\tfor (let i = methodsMatch.length - 1; i >= 0; i--) {\n\t\t\tconst match = methodsMatch[i];\n\t\t\tmath =\n\t\t\t\tmath.substring(0, match.index + match[1].length) +\n\t\t\t\t(this.totalOperations[type][match[2]] || match[2]) +\n\t\t\t\tmath.substring(match.index + match[0].length - 1, math.length);\n\t\t}\n\t\treturn math;\n\t}\n\t/**\n\t * Applies math operations to data and groups\n\t * @returns {Object} ops\n\t */\n\tgetOps() {\n\t\tconst state = this._state;\n\t\tconst table = state.datatable;\n\t\tconst mode = state.mode;\n\t\tconst vals = state.structure.values;\n\t\tconst ops = [];\n\n\t\tfor (let i = 0; i < vals.length; i++) {\n\t\t\tconst format = vals[i].format;\n\t\t\tconst operation = vals[i].operation;\n\t\t\tconst color = vals[i].color;\n\n\t\t\tconst isComplex = operation == \"complex\";\n\t\t\tlet name = isComplex ? vals[i].math : vals[i].name;\n\t\t\tname = webix.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tconst math = isComplex ? name : `${operation}(${name})`;\n\n\t\t\tlet branchMode;\n\t\t\tif (!isComplex) branchMode = this.getOperation(operation).branchMode;\n\n\t\t\tconst op = {\n\t\t\t\tmath,\n\t\t\t\tbranchMode: branchMode || \"raw\",\n\t\t\t\tlabel: name,\n\t\t\t\tmeta: { operation, format, color },\n\t\t\t\tcolumn: [],\n\t\t\t\trow: [],\n\t\t\t\tmarks: [],\n\t\t\t};\n\n\t\t\tconst total = this.totalOperations;\n\t\t\tlet methodsMatch;\n\t\t\tif (Object.keys(total).length) {\n\t\t\t\tconst methodsRegex = new RegExp(\n\t\t\t\t\t\"(\\\\(|,|\\\\+|-|\\\\/|\\\\*|\\\\s|^)(\" +\n\t\t\t\t\t\tthis.operations.map(method => method.id).join(\"|\") +\n\t\t\t\t\t\t\")\\\\(\",\n\t\t\t\t\t\"g\"\n\t\t\t\t);\n\t\t\t\tmethodsMatch = Array.from(math.matchAll(methodsRegex));\n\t\t\t}\n\n\t\t\tif (total.group)\n\t\t\t\top.branchMath = this._updateTotalMath(\"group\", math, methodsMatch);\n\n\t\t\tif (mode != \"chart\") {\n\t\t\t\tif (\n\t\t\t\t\ttable.footer &&\n\t\t\t\t\t((table.footer == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.footer != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tmath: total.footer\n\t\t\t\t\t\t\t? this._updateTotalMath(\"footer\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"value\",\n\t\t\t\t\t});\n\n\t\t\t\tif (\n\t\t\t\t\ttable.totalColumn &&\n\t\t\t\t\t((table.totalColumn == \"sumOnly\" && operation == \"sum\") ||\n\t\t\t\t\t\ttable.totalColumn != \"sumOnly\")\n\t\t\t\t)\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tmath: total.column\n\t\t\t\t\t\t\t? this._updateTotalMath(\"column\", math, methodsMatch)\n\t\t\t\t\t\t\t: math,\n\t\t\t\t\t\tas: \"\" + i,\n\t\t\t\t\t});\n\n\t\t\t\tif (table.minY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"minY\",\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.minY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxY) {\n\t\t\t\t\top.column.push({\n\t\t\t\t\t\tas: \"maxY\",\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_y\",\n\t\t\t\t\t\tcheck: (v, column) => v == column.maxY,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.minX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"minX\" + math,\n\t\t\t\t\t\tmath: \"min(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_min_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"minX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (table.maxX) {\n\t\t\t\t\top.row.push({\n\t\t\t\t\t\tas: \"maxX\" + math,\n\t\t\t\t\t\tmath: \"max(group)\",\n\t\t\t\t\t\tsource: \"result\",\n\t\t\t\t\t});\n\t\t\t\t\top.marks.push({\n\t\t\t\t\t\tname: \"webix_max_x\",\n\t\t\t\t\t\tcheck: (v, column, row) => v == row[\"maxX\" + math],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tops.push(op);\n\t\t}\n\t\treturn ops;\n\t}\n\t/** Convert rengine output data to pivot readable form **/\n\t_rengineToWebix(result, header) {\n\t\tconst state = this._state;\n\n\t\tif (state.mode == \"chart\") return this.getChartData(result, header);\n\n\t\tconst footer = header.nonEmpty.map(i =>\n\t\t\tresult.columnData[i] ? result.columnData[i].value : \"\"\n\t\t);\n\n\t\theader = this.getHeader(header);\n\n\t\tlet column;\n\t\tif (state.datatable.totalColumn) {\n\t\t\tcolumn = result.rowData.map(obj => {\n\t\t\t\tconst res = [];\n\t\t\t\tfor (let key in obj) {\n\t\t\t\t\tif (key.indexOf(\"minX\") == -1 && key.indexOf(\"maxX\") == -1)\n\t\t\t\t\t\tres[key] = obj[key];\n\t\t\t\t}\n\t\t\t\treturn res.filter(v => v || v === 0);\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tdata: result.tree || result.data,\n\t\t\theader,\n\t\t\tmarks: result.marks,\n\t\t\tfooter,\n\t\t\ttotalColumn: column,\n\t\t};\n\t}\n\t/**\n\t * Handle load error\n\t * @param {XMLHttpRequest} server error (customizations)\n\t * @returns {Object} empty data\n\t */\n\tloadError() {\n\t\twebix.message({\n\t\t\ttext: this._app.getService(\"locale\")._(\"Incorrect formula in values\"),\n\t\t\ttype: \"error\",\n\t\t});\n\n\t\treturn {\n\t\t\tdata: [],\n\t\t\tvalues: [],\n\t\t\theader: [],\n\t\t\tmarks: [],\n\t\t\tfooter: [],\n\t\t\ttotalColumn: [],\n\t\t};\n\t}\n\t/**\n\t * Prepares data for tree nodes\n\t * @param {Object} obj - item data as returted by Pivot engine\n\t * @returns {Object} item data ready for parsing in Webix Tree\n\t */\n\t_toTree(obj) {\n\t\tlet item = obj.values;\n\n\t\t// server returns object\n\t\tif (!webix.isArray(item)) {\n\t\t\tlet arr = [];\n\t\t\tfor (let name in item) arr[name] = item[name];\n\t\t\titem = arr;\n\t\t}\n\n\t\titem.unshift(\"\"); //header ids start from 1\n\t\tif (obj.data) {\n\t\t\titem.open = true;\n\t\t\titem.data = obj.data.map(r => {\n\t\t\t\treturn this._toTree(r);\n\t\t\t});\n\t\t} else item.id = obj.id; //row ids\n\t\treturn item;\n\t}\n\t/**\n\t * Prepares a storage for raw data before aggregation\n\t * @param {Array} data - initial data set\n\t * @returns {Object} object with storage data and parameters\n\t */\n\tgetTable(data) {\n\t\tconst fields = this.getFields(data[0]);\n\t\tthis._state.fields = fields;\n\t\tthis._data = data = this.prepareData(data, fields);\n\n\t\treturn {\n\t\t\tid: \"webixpivot\",\n\t\t\tprepare: true,\n\t\t\tdriver: \"raw\", //or \"columns\"\n\t\t\tfields: webix.copy(fields),\n\t\t\tdata,\n\t\t};\n\t}\n\t/**\n\t * Prepares data: parse dates, values template\n\t * @param {Array} data - initial data set\n\t * @returns {Array} data ready to parse\n\t */\n\tprepareData(data, fields) {\n\t\tfields = fields.filter(field => field.prepare || field.type == \"date\");\n\n\t\tif (fields.length) {\n\t\t\tdata = data.map(item => {\n\t\t\t\tfields.forEach(field => {\n\t\t\t\t\titem[field.id] = field.prepare\n\t\t\t\t\t\t? field.prepare(item[field.id])\n\t\t\t\t\t\t: new Date(item[field.id]);\n\t\t\t\t});\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\t/**\n\t * Gets field values\n\t * @param {string} field name\n\t * @returns {Promise} promise that resolves with field values\n\t */\n\tcollectFieldValues(field) {\n\t\tif (this._filtersHash[field])\n\t\t\treturn webix.promise.resolve(this._filtersHash[field]);\n\n\t\tconst app = this._app;\n\t\tif (app.config.externalProcessing)\n\t\t\treturn (this._filtersHash[field] = app\n\t\t\t\t.getService(\"backend\")\n\t\t\t\t.collectFieldValues(field));\n\n\t\tconst fieldObj = this.getField(field);\n\n\t\tconst hash = {};\n\t\tconst values = [];\n\t\tfor (let i = 0; i < this._data.length; i++) {\n\t\t\tlet value = this._data[i][field];\n\t\t\tif (value || value === 0) {\n\t\t\t\tlet label = value;\n\n\t\t\t\tif (fieldObj.type == \"date\") value = value.valueOf();\n\n\t\t\t\tif (!hash[value]) {\n\t\t\t\t\thash[value] = true;\n\n\t\t\t\t\tif (fieldObj.predicate)\n\t\t\t\t\t\tlabel = app.config.predicates[fieldObj.predicate](label);\n\n\t\t\t\t\tvalues.push({ value, id: value, label });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._filtersHash[field] = values;\n\t\treturn webix.promise.resolve(values);\n\t}\n\t/**\n\t * Apply custom fields names and methods locale to complex math\n\t * @param {String} complex math\n\t * @returns {String} complex math with correct fields and math methods names\n\t */\n\tfixMath(math) {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\n\t\tconst fields = this._state.fields;\n\t\tconst fieldsRegex = new RegExp(\n\t\t\tfields.map(field => \"\\\\b\" + field.id + \"\\\\b(?!\\\\()\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\tconst methods = this.operations;\n\t\tconst methodsRegex = new RegExp(\n\t\t\tmethods.map(method => \"\\\\b\" + method.id + \"\\\\b\\\\(\").join(\"|\"),\n\t\t\t\"g\"\n\t\t);\n\n\t\treturn math\n\t\t\t.replaceAll(fieldsRegex, id => fields.find(obj => obj.id == id).value)\n\t\t\t.replaceAll(\n\t\t\t\tmethodsRegex,\n\t\t\t\tmethod => _(method.substring(0, method.length - 1)) + \"(\"\n\t\t\t);\n\t}\n\t/**\n\t * Finds field\n\t * @param {String} field id\n\t * @returns {Object} field\n\t */\n\tgetField(id) {\n\t\treturn this._state.fields.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Finds operation\n\t * @param {String} operation id\n\t * @returns {Object} operation\n\t */\n\tgetOperation(id) {\n\t\treturn this.operations.find(obj => obj.id == id);\n\t}\n\t/**\n\t * Returns columns for aggregation\n\t * @returns {Array} array of field names for columns\n\t */\n\tgetColumns() {\n\t\tconst struct = this._state.structure;\n\t\tif (this._state.mode == \"chart\" && struct.groupBy) return [struct.groupBy];\n\t\telse return struct.columns;\n\t}\n\t/**\n\t * Returns for aggregation\n\t * @returns {Array} array of field names for rows\n\t */\n\tgetRows() {\n\t\treturn this._state.mode == \"chart\" ? [] : this._state.structure.rows;\n\t}\n\t/** Sets limits for raw and output data\n\t * @returns {Object} object with limits. By default math engine uses\n\t * { rows: 10000, columns: 5000, raws: Infinity }\n\t */\n\tgetLimits() {\n\t\treturn {};\n\t}\n\t/**\n\t * Prepares table header\n\t * @param {Object} hdata - object with header config\n\t * @returns {Array} array with header lines\n\t */\n\tgetHeader(hdata) {\n\t\tconst header = hdata.data;\n\t\tconst rows = [];\n\n\t\thdata.nonEmpty.forEach((v, i) => {\n\t\t\trows.push({\n\t\t\t\tid: v + 1,\n\t\t\t\theader: header.map(h => {\n\t\t\t\t\th =\n\t\t\t\t\t\th[i] && !webix.isUndefined(h[i].text) ? h[i] : { text: h[i] || \"\" };\n\t\t\t\t\tconst op = hdata.meta[i] && hdata.meta[i].operation;\n\t\t\t\t\tif (op) h.operation = op;\n\t\t\t\t\treturn h;\n\t\t\t\t}),\n\t\t\t\tformat: hdata.meta[i] && hdata.meta[i].format,\n\t\t\t});\n\t\t});\n\n\t\treturn rows;\n\t}\n\t/**\n\t * Sets dimensions based on rows/columns from structure\n\t */\n\tsetDimensions() {\n\t\tthis._reng.resetDimensions();\n\t\tconst columns = this.getColumns();\n\t\tconst fields = columns.concat(this.getRows() || []);\n\n\t\tfor (let i = 0; i < fields.length; i++) {\n\t\t\tconst field = this.getField(fields[i]);\n\t\t\tthis._reng.addDimension({\n\t\t\t\tid: fields[i],\n\t\t\t\ttable: this._table.id,\n\t\t\t\tlabel: fields[i],\n\t\t\t\trule: {\n\t\t\t\t\tby: field.predicate ? `${field.predicate}(${fields[i]})` : fields[i],\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\t/**\n\t * Prepares chart data\n\t * @param {Object} res - object with groupped data\n\t * @param {Object} result - object with aggregated data and its parameters\n\t * @returns {Array} array with chart data\n\t */\n\tgetChartData(result, header) {\n\t\tconst state = this._state;\n\t\tconst ops = state.structure.values;\n\n\t\tlet data = [];\n\t\tlet values = [];\n\n\t\tif (result.data.length) {\n\t\t\tconst chartType = state.chart.type;\n\t\t\tconst groupBy = state.structure.groupBy;\n\n\t\t\tconst first = webix.copy(result.data[0]);\n\t\t\tconst axis = groupBy ? header.data[0] : first.map(() => \"\");\n\n\t\t\tlet count = 0;\n\t\t\twhile (first.length) {\n\t\t\t\tlet item = first.splice(0, ops.length);\n\t\t\t\tif (item.length) {\n\t\t\t\t\tlet text = axis[count].text;\n\t\t\t\t\tif (text === 0) text = \"0\";\n\n\t\t\t\t\tif (chartType == \"pie\" || chartType == \"donut\") {\n\t\t\t\t\t\tfor (let i = 0; i < item.length; i++)\n\t\t\t\t\t\t\titem[i] = { value: item[i], color: ops[i].color };\n\n\t\t\t\t\t\tif (groupBy)\n\t\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\t\ttext: text || axis[count],\n\t\t\t\t\t\t\t\tcolor: this.getValueColor(count / ops.length, true),\n\t\t\t\t\t\t\t\tdata: item,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\telse data = item;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.push(text || axis[count]);\n\t\t\t\t\t\tdata.push(item);\n\t\t\t\t\t}\n\t\t\t\t\tcount += ops.length;\n\t\t\t\t} else break;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < ops.length; i++) {\n\t\t\tconst op = ops[i];\n\n\t\t\tlet name = op.operation == \"complex\" ? op.math : op.name;\n\t\t\tname = Array.isArray(name) ? name.join(\",\") : name;\n\n\t\t\tvalues.push({\n\t\t\t\ttext: name || op.operation,\n\t\t\t\toperation: op.operation,\n\t\t\t\tcolor: op.color,\n\t\t\t});\n\t\t}\n\n\t\treturn { data, values };\n\t}\n\t/**\n\t * Gets built-in colors for chart values\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {Array} color palette\n\t */\n\tgetPalette() {\n\t\treturn [\n\t\t\t[\"#e33fc7\", \"#a244ea\", \"#476cee\", \"#36abee\", \"#58dccd\", \"#a7ee70\"],\n\t\t\t[\"#d3ee36\", \"#eed236\", \"#ee9336\", \"#ee4339\", \"#595959\", \"#b85981\"],\n\t\t\t[\"#c670b8\", \"#9984ce\", \"#b9b9e2\", \"#b0cdfa\", \"#a0e4eb\", \"#7faf1b\"],\n\t\t\t[\"#b4d9a4\", \"#f2f79a\", \"#ffaa7d\", \"#d6806f\", \"#939393\", \"#d9b0d1\"],\n\t\t\t[\"#780e3b\", \"#684da9\", \"#242464\", \"#205793\", \"#5199a4\", \"#065c27\"],\n\t\t\t[\"#54b15a\", \"#ecf125\", \"#c65000\", \"#990001\", \"#363636\", \"#800f3e\"],\n\t\t];\n\t}\n\t/**\n\t * Gets a color from the palette\n\t * @param {number} i - row number of the required value\n\t * @param {boolean} pieGroup - is palette for pie group (customizations)\n\t * @returns {string} HEX color\n\t */\n\tgetValueColor(i, pieGroup) {\n\t\tconst palette = this.getPalette(pieGroup);\n\t\tlet rowIndex = i / palette[0].length;\n\t\trowIndex = rowIndex == palette.length ? 0 : parseInt(rowIndex, 10);\n\t\tconst columnIndex = i % palette[0].length;\n\t\treturn palette[rowIndex][columnIndex];\n\t}\n\n\tclearAll() {\n\t\t// fields\n\t\tthis._app.config.fields = null;\n\t\tthis._state.fields = [];\n\t\t// structure\n\t\tthis._app.setStructure({});\n\t\t// reset aggregated data/table config\n\t\tdelete this._table;\n\t\tthis._store = this.getPivotData();\n\t\tthis._data = [];\n\t\tthis._filtersHash = {};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseExportView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tsubMenuPos: \"right\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\tborderless: true,\n\t\t\t\ttype: {\n\t\t\t\t\tsubsign: true,\n\t\t\t\t},\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\twidth: 160,\n\t\t\t\tsubmenuConfig: {\n\t\t\t\t\tpoint: false,\n\t\t\t\t\twidth: 190,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t},\n\t\t\t\tautowidth: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: this.GetData(),\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: (id, e) => this.PopupAction(id, e),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To PNG\"), id: \"png\" },\n\t\t\t{ value: _(\"To PDF\"), id: \"pdf\" },\n\t\t];\n\t}\n\t/**\n\t * Calls \"exportModule\" event for app\n\t * @param {number} id - the ID of clicked menu option\n\t */\n\tPopupAction(id) {\n\t\tthis.app.callEvent(\"exportModule\", [id]);\n\t\tthis.getRoot().hide();\n\t}\n\t/**\n\t * Returns html template menu option\n\t * @param {Object} obj - data of menu option\n\t * @returns {String} - a string with html for an option\n\t */\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\t/**\n\t * Shows menu\n\t * @param {Object} node - html node where menu should be shown\n\t */\n\tShow(node) {\n\t\tif (this.getRoot().isVisible()) return;\n\t\tthis.webix.delay(() => this.getRoot().show(node));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport ExportMenu from \"./export\";\n\nexport default class BaseToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: id => this.ShowExportPopup(id),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { createState, withContext } from \"jet-restate\";\n\nexport function bind(obj, key, ctrl, view) {\n\tbindOut(obj, key, ctrl);\n\treturn bindIn(obj, key, ctrl, view);\n}\n\nfunction bindIn(obj, key, ctrl, view) {\n\tconst handler = (v, o, k, meta) => {\n\t\tif (k === \"*\") {\n\t\t\tvar els = ctrl.elements;\n\t\t\tfor (var subkey in els) {\n\t\t\t\tif (typeof v[subkey] !== \"undefined\") els[subkey].setValue(v[subkey]);\n\t\t\t}\n\t\t} else if (key === \"*\") {\n\t\t\tvar el = ctrl.elements[k];\n\t\t\tif (el && el != meta) el.setValue(v);\n\t\t} else if (meta != ctrl) ctrl.setValue(v);\n\t};\n\n\treturn view\n\t\t? view.on(obj.$changes, key, handler)\n\t\t: obj.$changes.attachEvent(key, handler);\n}\n\nfunction bindOut(obj, key, ctrl) {\n\tif (key === \"*\") {\n\t\tvar els = ctrl.elements;\n\t\tfor (var subkey in els) {\n\t\t\tif (typeof obj[subkey] !== \"undefined\") bindOut(obj, subkey, els[subkey]);\n\t\t}\n\t\treturn;\n\t}\n\n\tconst trigger = function(newValue) {\n\t\tconst oldValue = obj[key];\n\t\tif (newValue !== oldValue) {\n\t\t\tobj[key] = newValue;\n\t\t}\n\t};\n\n\tif (!ctrl.getList)\n\t\tctrl.attachEvent(\"onTimedKeyPress\", function() {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (this.config.value !== newValue) {\n\t\t\t\tthis.config.value = newValue;\n\t\t\t\tthis.callEvent(\"onChange\", [newValue]);\n\t\t\t}\n\t\t});\n\n\tctrl.attachEvent(\"onChange\", function() {\n\t\twithContext(this, () => {\n\t\t\ttrigger(this.getValue());\n\t\t});\n\t});\n}\n\nexport function track(obj) {\n\tif (!obj.$changes) obj = createState(obj);\n\n\tvar observe = function(key, ctrl) {\n\t\treturn bind(obj, key, ctrl, ctrl);\n\t};\n\n\tvar observeEnd = function(id) {\n\t\tobj.$changes.detachEvent(id);\n\t};\n\n\treturn {\n\t\tattachEvent: observe,\n\t\tdetachEvent: observeEnd,\n\t};\n}\n","webix.protoUI(\n\t{\n\t\tname: \"input-list\",\n\t\tgetValue() {\n\t\t\treturn this._value || [];\n\t\t},\n\t\tsetValue(data) {\n\t\t\tthis._value = data;\n\n\t\t\tthis.clearAll();\n\t\t\tthis.parse([].concat(data));\n\t\t},\n\t},\n\twebix.ui.list\n);\n","export const menu = \"<span class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const edit =\n\t\"<span class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const remove =\n\t\"<span class='webix_icon webix_rpt_action_remove rpi-trash-can-outline'></span>\";\n\nexport const menuRight =\n\t\"<span style='float:right' class='webix_icon action-menu mdi mdi-menu'></span>\";\nexport const editRight =\n\t\"<span style='float:right' class='webix_icon action-edit mdi mdi-pencil'></span>\";\nexport const removeRight =\n\t\"<span style='float:right' class='webix_icon webix_rpt_action_remove rpi-delete'></span>\";\n\nexport const visible =\n\t\"<span class='webix_icon action-visible mdi mdi-eye'></span>\";\nexport const hidden =\n\t\"<span class='webix_icon action-hidden mdi mdi-eye-off-outline'></span>\";\n\nexport const checked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-marked-outline'></span>\";\nexport const notChecked =\n\t\"<span class='webix_icon wbx-action_check mdi mdi-checkbox-blank-outline'></span>\";\n\nexport const sortAsc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-ascending'></span>\";\nexport const sortDesc =\n\t\"<span class='webix_icon rpi-sort-alphabetical-descending'></span>\";\n\nexport const types = {\n\ttable: \"<span class='rpi-table'></span>\",\n\tchart: \"<span class='rpi-poll'></span>\",\n\theatmap: \"<span class='rpi-chart-tree'></span>\",\n};\n\nexport const empty = {\n\tmain:\n\t\t\"<svg  xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320'><path class='webix_rpt_cls1' d='M369.51,182.77c-23.18-52.39,32-103.23,13.74-148.28s-77.61-39.42-162.07-20S78.47-6.35,34.66,14.46c-29.39,14-27.27,58.82-5,107,38.95,84.29-51.86,117.32-24.38,166s118.91-.95,183.37,4.22c37.62.59,62.88,6.26,109.52,21.27C387.63,341.7,412.41,279.75,369.51,182.77Z'/><rect class='webix_rpt_cls2' x='111.53' y='226.04' width='212.47' height='0.91'/><rect class='webix_rpt_cls3' x='97' y='89.51' width='212' height='151.96'/><rect class='webix_rpt_cls4' x='67' y='159.96' width='136.33' height='81.98' rx='2'/><polygon class='webix_rpt_cls5' points='199.32 235.55 72.61 235.55 72.61 165.28 71.01 165.28 71.01 235.55 71.01 237.68 71.01 237.68 72.61 237.68 72.61 237.68 199.32 237.68 199.32 235.55'/><rect class='webix_rpt_cls6' x='84.64' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='97.47' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='110.3' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='123.14' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='135.97' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='148.8' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='161.63' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='174.46' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='187.29' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='111.53' y='94.41' width='212.47' height='132.54'/><rect class='webix_rpt_cls8' x='111.53' y='109.85' width='212.47' height='0.91'/><path class='webix_rpt_cls9' d='M111.53,94.41H324v15.44H111.53Z'/><path class='webix_rpt_cls7' d='M111.53,79H324V94.41H111.53Z'/><path class='webix_rpt_cls2' d='M324,125.28v-.91H287.68V109.84h-.91v14.53H250.45V109.84h-.91v14.53H213.22V109.84h-.9v14.53H176V109.85h-.91v14.52H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56V197H111.53v.91h63.56v13.62H111.53v.9h63.56V227H176V212.42h36.32V227h.9V212.42h36.32V227h.91V212.42h36.32V227h.91V212.42H324v-.9H287.68V197.9H324V197H287.68V183.38H324v-.91H287.68V168.85H324v-.91H287.68V154.33H324v-.91H287.68V139.8H324v-.91H287.68V125.28Zm-74.46,0v13.61H213.22V125.28Zm-36.32,57.19V168.85h36.32v13.62Zm36.32.91V197H213.22V183.38Zm-36.32-15.44V154.33h36.32v13.61Zm0-14.52V139.8h36.32v13.62ZM176,125.28h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32V197H176Zm0,28.14V197.9h36.32v13.62Zm37.22,0V197.9h36.32v13.62Zm73.55,0H250.45V197.9h36.32Zm0-14.53H250.45V183.38h36.32Zm0-14.52H250.45V168.85h36.32Zm0-14.53H250.45V154.33h36.32Zm0-14.52H250.45V139.8h36.32Zm0-14.53H250.45V125.28h36.32Z'/><rect class='webix_rpt_cls2' x='175.09' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='212.32' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='249.54' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='286.77' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls9' x='118.79' y='84.43' width='21.79' height='5.45'/><rect class='webix_rpt_cls9' x='250.45' y='84.43' width='66.28' height='5.45'/></svg>\",\n\talt:\n\t\t\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320' fill='none'><g clip-path='url(#clip0_4706_8889)'><path d='M369.502 182.763C346.322 130.373 401.502 79.5332 383.242 34.4832C364.982 -10.5668 305.632 -4.93676 221.172 14.4832C136.712 33.9032 78.4622 -6.35676 34.6522 14.4532C5.26223 28.4532 7.38222 73.2732 29.6522 121.453C68.6022 205.743 -22.2078 238.773 5.27222 287.453C32.7522 336.133 124.182 286.503 188.642 291.673C226.262 292.263 251.522 297.933 298.162 312.943C387.622 341.693 412.402 279.743 369.502 182.763Z' class='webix_rpt_cls1'/><path d='M112.545 76.0479C112.545 74.9421 113.475 74.0457 114.622 74.0457H215.368L256.913 114.09V251.238C256.913 252.344 255.983 253.241 254.836 253.241H114.622C113.475 253.241 112.545 252.344 112.545 251.238V76.0479Z' class='webix_rpt_cls6'/><path d='M128.322 60.5902C128.322 59.4844 129.252 58.588 130.399 58.588H231.145L272.69 98.6313V235.781C272.69 236.887 271.76 237.783 270.612 237.783H130.399C129.252 237.783 128.322 236.887 128.322 235.781V60.5902Z' class='webix_rpt_cls4'/><path fill-rule='evenodd' clip-rule='evenodd' d='M130.399 59.588C129.769 59.588 129.322 60.0708 129.322 60.5902V235.781C129.322 236.3 129.769 236.783 130.399 236.783H270.612C271.243 236.783 271.69 236.299 271.69 235.781V99.0563L230.742 59.588H130.399ZM231.145 58.588H130.399C129.252 58.588 128.322 59.4844 128.322 60.5902V235.781C128.322 236.887 129.252 237.783 130.399 237.783H270.612C271.76 237.783 272.69 236.887 272.69 235.781V98.6313L231.145 58.588Z' class='webix_rpt_cls3'/><path d='M231.146 96.6297V58.588L272.69 98.6313H233.222C232.075 98.6313 231.146 97.7353 231.146 96.6297Z' class='webix_rpt_cls3'/><path d='M184.729 74.0457H143.184C142.323 74.0457 141.626 74.718 141.626 75.5473V75.5473C141.626 76.3766 142.323 77.0489 143.184 77.0489H184.729C185.589 77.0489 186.287 76.3766 186.287 75.5473C186.287 74.718 185.589 74.0457 184.729 74.0457Z' class='webix_rpt_cls2'/><path d='M184.729 87.0457H143.184C142.323 87.0457 141.626 87.718 141.626 88.5473V88.5473C141.626 89.3766 142.323 90.0489 143.184 90.0489H184.729C185.589 90.0489 186.287 89.3766 186.287 88.5473C186.287 87.718 185.589 87.0457 184.729 87.0457Z' class='webix_rpt_cls2'/><path d='M222.443 101H143.557C142.697 101 142 101.672 142 102.5C142 103.328 142.697 104 143.557 104H222.443C223.303 104 224 103.328 224 102.5C224 101.672 223.303 101 222.443 101Z' class='webix_rpt_cls2'/><path d='M222.443 115H143.557C142.697 115 142 115.672 142 116.5V116.5C142 117.328 142.697 118 143.557 118H222.443C223.303 118 224 117.328 224 116.5C224 115.672 223.303 115 222.443 115Z' class='webix_rpt_cls2'/><path fill-rule='evenodd' clip-rule='evenodd' d='M218 223C240.644 223 259 204.644 259 182C259 159.356 240.644 141 218 141C195.356 141 177 159.356 177 182C177 204.644 195.356 223 218 223ZM218 227C242.853 227 263 206.853 263 182C263 157.147 242.853 137 218 137C193.147 137 173 157.147 173 182C173 206.853 193.147 227 218 227Z' class='webix_rpt_cls4'/><path d='M219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134ZM219.686 148.057C202.114 148.057 188.057 162.114 188.057 179.686C188.057 197.257 202.114 211.314 219.686 211.314C237.257 211.314 251.314 197.257 251.314 179.686C251.314 162.114 237.257 148.057 219.686 148.057Z' class='webix_rpt_cls5'/><path fill-rule='evenodd' clip-rule='evenodd' d='M253.047 209.471L253.645 208.769C260.316 200.928 264.371 190.754 264.371 179.686C264.371 167.834 259.663 156.468 251.283 148.088C242.903 139.708 231.537 135 219.686 135C207.834 135 196.468 139.708 188.088 148.088C179.708 156.468 175 167.834 175 179.686C175 191.537 179.708 202.903 188.088 211.283C196.468 219.663 207.834 224.371 219.686 224.371C230.754 224.371 240.928 220.316 248.769 213.645L249.471 213.047L252.314 215.89V221.443L286.457 255.586L295.586 246.457L261.443 212.314H255.89L253.047 209.471ZM261.857 211.314L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857ZM187.057 179.686C187.057 161.562 201.562 147.057 219.686 147.057C237.809 147.057 252.314 161.562 252.314 179.686C252.314 197.809 237.809 212.314 219.686 212.314C201.562 212.314 187.057 197.809 187.057 179.686ZM188.057 179.686C188.057 162.114 202.114 148.057 219.686 148.057C237.257 148.057 251.314 162.114 251.314 179.686C251.314 197.257 237.257 211.314 219.686 211.314C202.114 211.314 188.057 197.257 188.057 179.686Z' class='webix_rpt_cls3'/><path d='M236.083 167.231L232.852 164L220.042 176.81L207.231 164L204 167.231L216.81 180.042L204 192.852L207.231 196.083L220.042 183.273L232.852 196.083L236.083 192.852L223.273 180.042L236.083 167.231Z' class='webix_rpt_cls3'/></g><defs><clipPath id='clip0_4706_8889'><rect width='390' height='320' class='webix_rpt_cls4'/></clipPath></defs></svg>\",\n};\n","/*\n@license\nWebix Query v.10.0.9\nThis software is covered by Webix Commercial License.\nUsage without proper license is prohibited.\n(c) XB Software Ltd.\n*/\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = global || self, factory(global.query = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var NavigationBlocked = (function () {\n        function NavigationBlocked() {\n        }\n        return NavigationBlocked;\n    }());\n    var JetBase = (function () {\n        function JetBase(webix, config) {\n            this.webixJet = true;\n            this.webix = webix;\n            this._events = [];\n            this._subs = {};\n            this._data = {};\n            if (config && config.params)\n                webix.extend(this._data, config.params);\n        }\n        JetBase.prototype.getRoot = function () {\n            return this._root;\n        };\n        JetBase.prototype.destructor = function () {\n            this._detachEvents();\n            this._destroySubs();\n            this._events = this._container = this.app = this._parent = this._root = null;\n        };\n        JetBase.prototype.setParam = function (id, value, url) {\n            if (this._data[id] !== value) {\n                this._data[id] = value;\n                this._segment.update(id, value, 0);\n                if (url) {\n                    return this.show(null);\n                }\n            }\n        };\n        JetBase.prototype.getParam = function (id, parent) {\n            var value = this._data[id];\n            if (typeof value !== \"undefined\" || !parent) {\n                return value;\n            }\n            var view = this.getParentView();\n            if (view) {\n                return view.getParam(id, parent);\n            }\n        };\n        JetBase.prototype.getUrl = function () {\n            return this._segment.suburl();\n        };\n        JetBase.prototype.getUrlString = function () {\n            return this._segment.toString();\n        };\n        JetBase.prototype.getParentView = function () {\n            return this._parent;\n        };\n        JetBase.prototype.$$ = function (id) {\n            if (typeof id === \"string\") {\n                var root_1 = this.getRoot();\n                return root_1.queryView((function (obj) { return (obj.config.id === id || obj.config.localId === id) &&\n                    (obj.$scope === root_1.$scope); }), \"self\");\n            }\n            else {\n                return id;\n            }\n        };\n        JetBase.prototype.on = function (obj, name, code) {\n            var id = obj.attachEvent(name, code);\n            this._events.push({ obj: obj, id: id });\n            return id;\n        };\n        JetBase.prototype.contains = function (view) {\n            for (var key in this._subs) {\n                var kid = this._subs[key].view;\n                if (kid === view || kid.contains(view)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        JetBase.prototype.getSubView = function (name) {\n            var sub = this.getSubViewInfo(name);\n            if (sub) {\n                return sub.subview.view;\n            }\n        };\n        JetBase.prototype.getSubViewInfo = function (name) {\n            var sub = this._subs[name || \"default\"];\n            if (sub) {\n                return { subview: sub, parent: this };\n            }\n            if (name === \"_top\") {\n                this._subs[name] = { url: \"\", id: null, popup: true };\n                return this.getSubViewInfo(name);\n            }\n            if (this._parent) {\n                return this._parent.getSubViewInfo(name);\n            }\n            return null;\n        };\n        JetBase.prototype._detachEvents = function () {\n            var events = this._events;\n            for (var i = events.length - 1; i >= 0; i--) {\n                events[i].obj.detachEvent(events[i].id);\n            }\n        };\n        JetBase.prototype._destroySubs = function () {\n            for (var key in this._subs) {\n                var subView = this._subs[key].view;\n                if (subView) {\n                    subView.destructor();\n                }\n            }\n            this._subs = {};\n        };\n        JetBase.prototype._init_url_data = function () {\n            var url = this._segment.current();\n            this._data = {};\n            this.webix.extend(this._data, url.params, true);\n        };\n        JetBase.prototype._getDefaultSub = function () {\n            if (this._subs.default) {\n                return this._subs.default;\n            }\n            for (var key in this._subs) {\n                var sub = this._subs[key];\n                if (!sub.branch && sub.view && key !== \"_top\") {\n                    var child = sub.view._getDefaultSub();\n                    if (child) {\n                        return child;\n                    }\n                }\n            }\n        };\n        JetBase.prototype._routed_view = function () {\n            var parent = this.getParentView();\n            if (!parent) {\n                return true;\n            }\n            var sub = parent._getDefaultSub();\n            if (!sub && sub !== this) {\n                return false;\n            }\n            return parent._routed_view();\n        };\n        return JetBase;\n    }());\n    function parse(url) {\n        if (url[0] === \"/\") {\n            url = url.substr(1);\n        }\n        var parts = url.split(\"/\");\n        var chunks = [];\n        for (var i = 0; i < parts.length; i++) {\n            var test = parts[i];\n            var result = {};\n            var pos = test.indexOf(\":\");\n            if (pos === -1) {\n                pos = test.indexOf(\"?\");\n            }\n            if (pos !== -1) {\n                var params = test.substr(pos + 1).split(/[\\:\\?\\&]/g);\n                for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n                    var param = params_1[_i];\n                    var dchunk = param.split(\"=\");\n                    result[dchunk[0]] = decodeURIComponent(dchunk[1]);\n                }\n            }\n            chunks[i] = {\n                page: (pos > -1 ? test.substr(0, pos) : test),\n                params: result,\n                isNew: true\n            };\n        }\n        return chunks;\n    }\n    function url2str(stack) {\n        var url = [];\n        for (var _i = 0, stack_1 = stack; _i < stack_1.length; _i++) {\n            var chunk = stack_1[_i];\n            url.push(\"/\" + chunk.page);\n            var params = obj2str(chunk.params);\n            if (params) {\n                url.push(\"?\" + params);\n            }\n        }\n        return url.join(\"\");\n    }\n    function obj2str(obj) {\n        var str = [];\n        for (var key in obj) {\n            if (typeof obj[key] === \"object\")\n                continue;\n            if (str.length) {\n                str.push(\"&\");\n            }\n            str.push(key + \"=\" + encodeURIComponent(obj[key]));\n        }\n        return str.join(\"\");\n    }\n    var Route = (function () {\n        function Route(route, index) {\n            this._next = 1;\n            if (typeof route === \"string\") {\n                this.route = {\n                    url: parse(route),\n                    path: route\n                };\n            }\n            else {\n                this.route = route;\n            }\n            this.index = index;\n        }\n        Route.prototype.current = function () {\n            return this.route.url[this.index];\n        };\n        Route.prototype.next = function () {\n            return this.route.url[this.index + this._next];\n        };\n        Route.prototype.suburl = function () {\n            return this.route.url.slice(this.index);\n        };\n        Route.prototype.shift = function (params) {\n            var route = new Route(this.route, this.index + this._next);\n            route.setParams(route.route.url, params, route.index);\n            return route;\n        };\n        Route.prototype.setParams = function (url, params, index) {\n            if (params) {\n                var old = url[index].params;\n                for (var key in params)\n                    old[key] = params[key];\n            }\n        };\n        Route.prototype.refresh = function () {\n            var url = this.route.url;\n            for (var i = this.index + 1; i < url.length; i++) {\n                url[i].isNew = true;\n            }\n        };\n        Route.prototype.toString = function () {\n            var str = url2str(this.suburl());\n            return str ? str.substr(1) : \"\";\n        };\n        Route.prototype._join = function (path, kids) {\n            var url = this.route.url;\n            if (path === null) {\n                return url;\n            }\n            var old = this.route.url;\n            var reset = true;\n            url = old.slice(0, this.index + (kids ? this._next : 0));\n            if (path) {\n                url = url.concat(parse(path));\n                for (var i = 0; i < url.length; i++) {\n                    if (old[i]) {\n                        url[i].view = old[i].view;\n                    }\n                    if (reset && old[i] && url[i].page === old[i].page) {\n                        url[i].isNew = false;\n                    }\n                    else if (url[i].isNew) {\n                        reset = false;\n                    }\n                }\n            }\n            return url;\n        };\n        Route.prototype.append = function (path) {\n            var url = this._join(path, true);\n            this.route.path = url2str(url);\n            this.route.url = url;\n            return this.route.path;\n        };\n        Route.prototype.show = function (path, view, kids) {\n            var _this = this;\n            var url = this._join(path.url, kids);\n            this.setParams(url, path.params, this.index + (kids ? this._next : 0));\n            return new Promise(function (res, rej) {\n                var redirect = url2str(url);\n                var obj = {\n                    url: url,\n                    redirect: redirect,\n                    confirm: Promise.resolve()\n                };\n                var app = view ? view.app : null;\n                if (app) {\n                    var result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n                    if (!result) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                }\n                obj.confirm.catch(function (err) { return rej(err); }).then(function () {\n                    if (obj.redirect === null) {\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    if (obj.redirect !== redirect) {\n                        app.show(obj.redirect);\n                        rej(new NavigationBlocked());\n                        return;\n                    }\n                    _this.route.path = redirect;\n                    _this.route.url = url;\n                    res();\n                });\n            });\n        };\n        Route.prototype.size = function (n) {\n            this._next = n;\n        };\n        Route.prototype.split = function () {\n            var route = {\n                url: this.route.url.slice(this.index + 1),\n                path: \"\"\n            };\n            if (route.url.length) {\n                route.path = url2str(route.url);\n            }\n            return new Route(route, 0);\n        };\n        Route.prototype.update = function (name, value, index) {\n            var chunk = this.route.url[this.index + (index || 0)];\n            if (!chunk) {\n                this.route.url.push({ page: \"\", params: {} });\n                return this.update(name, value, index);\n            }\n            if (name === \"\") {\n                chunk.page = value;\n            }\n            else {\n                chunk.params[name] = value;\n            }\n            this.route.path = url2str(this.route.url);\n        };\n        return Route;\n    }());\n    var JetView = (function (_super) {\n        __extends(JetView, _super);\n        function JetView(app, config) {\n            var _this = _super.call(this, app.webix) || this;\n            _this.app = app;\n            _this._children = [];\n            return _this;\n        }\n        JetView.prototype.ui = function (ui, config) {\n            config = config || {};\n            var container = config.container || ui.container;\n            var jetview = this.app.createView(ui);\n            this._children.push(jetview);\n            jetview.render(container, this._segment, this);\n            if (typeof ui !== \"object\" || (ui instanceof JetBase)) {\n                return jetview;\n            }\n            else {\n                return jetview.getRoot();\n            }\n        };\n        JetView.prototype.show = function (path, config) {\n            config = config || {};\n            if (typeof path === \"object\") {\n                for (var key in path) {\n                    this.setParam(key, path[key]);\n                }\n                path = null;\n            }\n            else {\n                if (path.substr(0, 1) === \"/\") {\n                    return this.app.show(path, config);\n                }\n                if (path.indexOf(\"./\") === 0) {\n                    path = path.substr(2);\n                }\n                if (path.indexOf(\"../\") === 0) {\n                    var parent_1 = this.getParentView();\n                    if (parent_1) {\n                        return parent_1.show(path.substr(3), config);\n                    }\n                    else {\n                        return this.app.show(\"/\" + path.substr(3));\n                    }\n                }\n                var sub = this.getSubViewInfo(config.target);\n                if (sub) {\n                    if (sub.parent !== this) {\n                        return sub.parent.show(path, config);\n                    }\n                    else if (config.target && config.target !== \"default\") {\n                        return this._renderFrameLock(config.target, sub.subview, {\n                            url: path,\n                            params: config.params,\n                        });\n                    }\n                }\n                else {\n                    if (path) {\n                        return this.app.show(\"/\" + path, config);\n                    }\n                }\n            }\n            return this._show(this._segment, { url: path, params: config.params }, this);\n        };\n        JetView.prototype._show = function (segment, path, view) {\n            var _this = this;\n            return segment.show(path, view, true).then(function () {\n                _this._init_url_data();\n                return _this._urlChange();\n            }).then(function () {\n                if (segment.route.linkRouter) {\n                    _this.app.getRouter().set(segment.route.path, { silent: true });\n                    _this.app.callEvent(\"app:route\", [segment.route.path]);\n                }\n            });\n        };\n        JetView.prototype.init = function (_$view, _$) {\n        };\n        JetView.prototype.ready = function (_$view, _$url) {\n        };\n        JetView.prototype.config = function () {\n            this.app.webix.message(\"View:Config is not implemented\");\n        };\n        JetView.prototype.urlChange = function (_$view, _$url) {\n        };\n        JetView.prototype.destroy = function () {\n        };\n        JetView.prototype.destructor = function () {\n            this.destroy();\n            this._destroyKids();\n            if (this._root) {\n                this._root.destructor();\n                _super.prototype.destructor.call(this);\n            }\n        };\n        JetView.prototype.use = function (plugin, config) {\n            plugin(this.app, this, config);\n        };\n        JetView.prototype.refresh = function () {\n            var url = this.getUrl();\n            this.destroy();\n            this._destroyKids();\n            this._destroySubs();\n            this._detachEvents();\n            if (this._container.tagName) {\n                this._root.destructor();\n            }\n            this._segment.refresh();\n            return this._render(this._segment);\n        };\n        JetView.prototype.render = function (root, url, parent) {\n            var _this = this;\n            if (typeof url === \"string\") {\n                url = new Route(url, 0);\n            }\n            this._segment = url;\n            this._parent = parent;\n            this._init_url_data();\n            root = root || document.body;\n            var _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n            if (this._container !== _container) {\n                this._container = _container;\n                return this._render(url);\n            }\n            else {\n                return this._urlChange().then(function () { return _this.getRoot(); });\n            }\n        };\n        JetView.prototype._render = function (url) {\n            var _this = this;\n            var config = this.config();\n            if (config.then) {\n                return config.then(function (cfg) { return _this._render_final(cfg, url); });\n            }\n            else {\n                return this._render_final(config, url);\n            }\n        };\n        JetView.prototype._render_final = function (config, url) {\n            var _this = this;\n            var slot = null;\n            var container = null;\n            var show = false;\n            if (!this._container.tagName) {\n                slot = this._container;\n                if (slot.popup) {\n                    container = document.body;\n                    show = true;\n                }\n                else {\n                    container = this.webix.$$(slot.id);\n                }\n            }\n            else {\n                container = this._container;\n            }\n            if (!this.app || !container) {\n                return Promise.reject(null);\n            }\n            var response;\n            var current = this._segment.current();\n            var result = { ui: {} };\n            this.app.copyConfig(config, result.ui, this._subs);\n            this.app.callEvent(\"app:render\", [this, url, result]);\n            result.ui.$scope = this;\n            if (!slot && current.isNew && current.view) {\n                current.view.destructor();\n            }\n            try {\n                if (slot && !show) {\n                    var oldui = container;\n                    var parent_2 = oldui.getParentView();\n                    if (parent_2 && parent_2.name === \"multiview\" && !result.ui.id) {\n                        result.ui.id = oldui.config.id;\n                    }\n                }\n                this._root = this.app.webix.ui(result.ui, container);\n                var asWin = this._root;\n                if (show && asWin.setPosition && !asWin.isVisible()) {\n                    asWin.show();\n                }\n                if (slot) {\n                    if (slot.view && slot.view !== this && slot.view !== this.app) {\n                        slot.view.destructor();\n                    }\n                    slot.id = this._root.config.id;\n                    if (this.getParentView() || !this.app.app)\n                        slot.view = this;\n                    else {\n                        slot.view = this.app;\n                    }\n                }\n                if (current.isNew) {\n                    current.view = this;\n                    current.isNew = false;\n                }\n                response = Promise.resolve(this._init(this._root, url)).then(function () {\n                    return _this._urlChange().then(function () {\n                        _this._initUrl = null;\n                        return _this.ready(_this._root, url.suburl());\n                    });\n                });\n            }\n            catch (e) {\n                response = Promise.reject(e);\n            }\n            return response.catch(function (err) { return _this._initError(_this, err); });\n        };\n        JetView.prototype._init = function (view, url) {\n            return this.init(view, url.suburl());\n        };\n        JetView.prototype._urlChange = function () {\n            var _this = this;\n            this.app.callEvent(\"app:urlchange\", [this, this._segment]);\n            var waits = [];\n            for (var key in this._subs) {\n                var frame = this._subs[key];\n                var wait = this._renderFrameLock(key, frame, null);\n                if (wait) {\n                    waits.push(wait);\n                }\n            }\n            return Promise.all(waits).then(function () {\n                return _this.urlChange(_this._root, _this._segment.suburl());\n            });\n        };\n        JetView.prototype._renderFrameLock = function (key, frame, path) {\n            if (!frame.lock) {\n                var lock = this._renderFrame(key, frame, path);\n                if (lock) {\n                    frame.lock = lock.then(function () { return frame.lock = null; }, function () { return frame.lock = null; });\n                }\n            }\n            return frame.lock;\n        };\n        JetView.prototype._renderFrame = function (key, frame, path) {\n            var _this = this;\n            if (key === \"default\") {\n                if (this._segment.next()) {\n                    var params = path ? path.params : null;\n                    if (frame.params) {\n                        params = this.webix.extend(params || {}, frame.params);\n                    }\n                    return this._createSubView(frame, this._segment.shift(params));\n                }\n                else if (frame.view && frame.popup) {\n                    frame.view.destructor();\n                    frame.view = null;\n                }\n            }\n            if (path !== null) {\n                frame.url = path.url;\n                if (frame.params) {\n                    path.params = this.webix.extend(path.params || {}, frame.params);\n                }\n            }\n            if (frame.route) {\n                if (path !== null) {\n                    return frame.route.show(path, frame.view).then(function () {\n                        return _this._createSubView(frame, frame.route);\n                    });\n                }\n                if (frame.branch) {\n                    return;\n                }\n            }\n            var view = frame.view;\n            if (!view && frame.url) {\n                if (typeof frame.url === \"string\") {\n                    frame.route = new Route(frame.url, 0);\n                    if (path)\n                        frame.route.setParams(frame.route.route.url, path.params, 0);\n                    if (frame.params)\n                        frame.route.setParams(frame.route.route.url, frame.params, 0);\n                    return this._createSubView(frame, frame.route);\n                }\n                else {\n                    if (typeof frame.url === \"function\" && !(view instanceof frame.url)) {\n                        view = new (this.app._override(frame.url))(this.app, \"\");\n                    }\n                    if (!view) {\n                        view = frame.url;\n                    }\n                }\n            }\n            if (view) {\n                return view.render(frame, (frame.route || this._segment), this);\n            }\n        };\n        JetView.prototype._initError = function (view, err) {\n            if (this.app) {\n                this.app.error(\"app:error:initview\", [err, view]);\n            }\n            return true;\n        };\n        JetView.prototype._createSubView = function (sub, suburl) {\n            var _this = this;\n            return this.app.createFromURL(suburl.current()).then(function (view) {\n                return view.render(sub, suburl, _this);\n            });\n        };\n        JetView.prototype._destroyKids = function () {\n            var uis = this._children;\n            for (var i = uis.length - 1; i >= 0; i--) {\n                if (uis[i] && uis[i].destructor) {\n                    uis[i].destructor();\n                }\n            }\n            this._children = [];\n        };\n        return JetView;\n    }(JetBase));\n    var JetViewRaw = (function (_super) {\n        __extends(JetViewRaw, _super);\n        function JetViewRaw(app, config) {\n            var _this = _super.call(this, app, config) || this;\n            _this._ui = config.ui;\n            return _this;\n        }\n        JetViewRaw.prototype.config = function () {\n            return this._ui;\n        };\n        return JetViewRaw;\n    }(JetView));\n    var SubRouter = (function () {\n        function SubRouter(cb, config, app) {\n            this.path = \"\";\n            this.app = app;\n        }\n        SubRouter.prototype.set = function (path, config) {\n            this.path = path;\n            var a = this.app;\n            a.app.getRouter().set(a._segment.append(this.path), { silent: true });\n        };\n        SubRouter.prototype.get = function () {\n            return this.path;\n        };\n        return SubRouter;\n    }());\n    var _once = true;\n    var JetAppBase = (function (_super) {\n        __extends(JetAppBase, _super);\n        function JetAppBase(config) {\n            var _this = this;\n            var webix = (config || {}).webix || window.webix;\n            config = webix.extend({\n                name: \"App\",\n                version: \"1.0\",\n                start: \"/home\"\n            }, config, true);\n            _this = _super.call(this, webix, config) || this;\n            _this.config = config;\n            _this.app = _this.config.app;\n            _this.ready = Promise.resolve();\n            _this._services = {};\n            _this.webix.extend(_this, _this.webix.EventSystem);\n            return _this;\n        }\n        JetAppBase.prototype.getUrl = function () {\n            return this._subSegment.suburl();\n        };\n        JetAppBase.prototype.getUrlString = function () {\n            return this._subSegment.toString();\n        };\n        JetAppBase.prototype.getService = function (name) {\n            var obj = this._services[name];\n            if (typeof obj === \"function\") {\n                obj = this._services[name] = obj(this);\n            }\n            return obj;\n        };\n        JetAppBase.prototype.setService = function (name, handler) {\n            this._services[name] = handler;\n        };\n        JetAppBase.prototype.destructor = function () {\n            this.getSubView().destructor();\n            _super.prototype.destructor.call(this);\n        };\n        JetAppBase.prototype.copyConfig = function (obj, target, config) {\n            if (obj instanceof JetBase ||\n                (typeof obj === \"function\" && obj.prototype instanceof JetBase)) {\n                obj = { $subview: obj };\n            }\n            if (typeof obj.$subview != \"undefined\") {\n                return this.addSubView(obj, target, config);\n            }\n            var isArray = obj instanceof Array;\n            target = target || (isArray ? [] : {});\n            for (var method in obj) {\n                var point = obj[method];\n                if (typeof point === \"function\" && point.prototype instanceof JetBase) {\n                    point = { $subview: point };\n                }\n                if (point && typeof point === \"object\" &&\n                    !(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n                    if (point instanceof Date) {\n                        target[method] = new Date(point);\n                    }\n                    else {\n                        var copy = this.copyConfig(point, (point instanceof Array ? [] : {}), config);\n                        if (copy !== null) {\n                            if (isArray)\n                                target.push(copy);\n                            else\n                                target[method] = copy;\n                        }\n                    }\n                }\n                else {\n                    target[method] = point;\n                }\n            }\n            return target;\n        };\n        JetAppBase.prototype.getRouter = function () {\n            return this.$router;\n        };\n        JetAppBase.prototype.clickHandler = function (e, target) {\n            if (e) {\n                target = target || (e.target || e.srcElement);\n                if (target && target.getAttribute) {\n                    var trigger_1 = target.getAttribute(\"trigger\");\n                    if (trigger_1) {\n                        this._forView(target, function (view) { return view.app.trigger(trigger_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                    var route_1 = target.getAttribute(\"route\");\n                    if (route_1) {\n                        this._forView(target, function (view) { return view.show(route_1); });\n                        e.cancelBubble = true;\n                        return e.preventDefault();\n                    }\n                }\n            }\n            var parent = target.parentNode;\n            if (parent) {\n                this.clickHandler(e, parent);\n            }\n        };\n        JetAppBase.prototype.getRoot = function () {\n            return this.getSubView().getRoot();\n        };\n        JetAppBase.prototype.refresh = function () {\n            var _this = this;\n            if (!this._subSegment) {\n                return Promise.resolve(null);\n            }\n            return this.getSubView().refresh().then(function (view) {\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return view;\n            });\n        };\n        JetAppBase.prototype.loadView = function (url) {\n            var _this = this;\n            var views = this.config.views;\n            var result = null;\n            if (url === \"\") {\n                return Promise.resolve(this._loadError(\"\", new Error(\"Webix Jet: Empty url segment\")));\n            }\n            try {\n                if (views) {\n                    if (typeof views === \"function\") {\n                        result = views(url);\n                    }\n                    else {\n                        result = views[url];\n                    }\n                    if (typeof result === \"string\") {\n                        url = result;\n                        result = null;\n                    }\n                }\n                if (!result) {\n                    if (url === \"_hidden\") {\n                        result = { hidden: true };\n                    }\n                    else if (url === \"_blank\") {\n                        result = {};\n                    }\n                    else {\n                        url = url.replace(/\\./g, \"/\");\n                        result = this.require(\"jet-views\", url);\n                    }\n                }\n            }\n            catch (e) {\n                result = this._loadError(url, e);\n            }\n            if (!result.then) {\n                result = Promise.resolve(result);\n            }\n            result = result\n                .then(function (module) { return module.__esModule ? module.default : module; })\n                .catch(function (err) { return _this._loadError(url, err); });\n            return result;\n        };\n        JetAppBase.prototype._forView = function (target, handler) {\n            var view = this.webix.$$(target);\n            if (view) {\n                handler(view.$scope);\n            }\n        };\n        JetAppBase.prototype._loadViewDynamic = function (url) {\n            return null;\n        };\n        JetAppBase.prototype.createFromURL = function (chunk) {\n            var _this = this;\n            var view;\n            if (chunk.isNew || !chunk.view) {\n                view = this.loadView(chunk.page)\n                    .then(function (ui) { return _this.createView(ui, name, chunk.params); });\n            }\n            else {\n                view = Promise.resolve(chunk.view);\n            }\n            return view;\n        };\n        JetAppBase.prototype._override = function (ui) {\n            var over = this.config.override;\n            if (over) {\n                var dv = void 0;\n                while (ui) {\n                    dv = ui;\n                    ui = over.get(ui);\n                }\n                return dv;\n            }\n            return ui;\n        };\n        JetAppBase.prototype.createView = function (ui, name, params) {\n            ui = this._override(ui);\n            var obj;\n            if (typeof ui === \"function\") {\n                if (ui.prototype instanceof JetAppBase) {\n                    return new ui({ app: this, name: name, params: params, router: SubRouter });\n                }\n                else if (ui.prototype instanceof JetBase) {\n                    return new ui(this, { name: name, params: params });\n                }\n                else {\n                    ui = ui(this);\n                }\n            }\n            if (ui instanceof JetBase) {\n                obj = ui;\n            }\n            else {\n                obj = new JetViewRaw(this, { name: name, ui: ui });\n            }\n            return obj;\n        };\n        JetAppBase.prototype.show = function (url, config) {\n            if (url && this.app && url.indexOf(\"//\") == 0)\n                return this.app.show(url.substr(1), config);\n            return this.render(this._container, url || this.config.start, config);\n        };\n        JetAppBase.prototype.trigger = function (name) {\n            var rest = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                rest[_i - 1] = arguments[_i];\n            }\n            this.apply(name, rest);\n        };\n        JetAppBase.prototype.apply = function (name, data) {\n            this.callEvent(name, data);\n        };\n        JetAppBase.prototype.action = function (name) {\n            return this.webix.bind(function () {\n                var rest = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    rest[_i] = arguments[_i];\n                }\n                this.apply(name, rest);\n            }, this);\n        };\n        JetAppBase.prototype.on = function (name, handler) {\n            this.attachEvent(name, handler);\n        };\n        JetAppBase.prototype.use = function (plugin, config) {\n            plugin(this, null, config);\n        };\n        JetAppBase.prototype.error = function (name, er) {\n            this.callEvent(name, er);\n            this.callEvent(\"app:error\", er);\n            if (this.config.debug) {\n                for (var i = 0; i < er.length; i++) {\n                    console.error(er[i]);\n                    if (er[i] instanceof Error) {\n                        var text = er[i].message;\n                        if (text.indexOf(\"Module build failed\") === 0) {\n                            text = text.replace(/\\x1b\\[[0-9;]*m/g, \"\");\n                            document.body.innerHTML = \"<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>\" + text + \"</pre>\";\n                        }\n                        else {\n                            text += \"<br><br>Check console for more details\";\n                            this.webix.message({ type: \"error\", text: text, expire: -1 });\n                        }\n                    }\n                }\n                debugger;\n            }\n        };\n        JetAppBase.prototype.render = function (root, url, config) {\n            var _this = this;\n            this._container = (typeof root === \"string\") ?\n                this.webix.toNode(root) :\n                (root || document.body);\n            var firstInit = !this.$router;\n            var path = null;\n            if (firstInit) {\n                if (_once && \"tagName\" in this._container) {\n                    this.webix.event(document.body, \"click\", function (e) { return _this.clickHandler(e); });\n                    _once = false;\n                }\n                if (typeof url === \"string\") {\n                    url = new Route(url, 0);\n                }\n                this._subSegment = this._first_start(url);\n                this._subSegment.route.linkRouter = true;\n            }\n            else {\n                if (typeof url === \"string\") {\n                    path = url;\n                }\n                else {\n                    if (this.app) {\n                        path = url.split().route.path || this.config.start;\n                    }\n                    else {\n                        path = url.toString();\n                    }\n                }\n            }\n            var params = config ? config.params : this.config.params || null;\n            var top = this.getSubView();\n            var segment = this._subSegment;\n            var ready = segment\n                .show({ url: path, params: params }, top)\n                .then(function () { return _this.createFromURL(segment.current()); })\n                .then(function (view) { return view.render(root, segment); })\n                .then(function (base) {\n                _this.$router.set(segment.route.path, { silent: true });\n                _this.callEvent(\"app:route\", [_this.getUrl()]);\n                return base;\n            });\n            this.ready = this.ready.then(function () { return ready; });\n            return ready;\n        };\n        JetAppBase.prototype.getSubView = function () {\n            if (this._subSegment) {\n                var view = this._subSegment.current().view;\n                if (view)\n                    return view;\n            }\n            return new JetView(this, {});\n        };\n        JetAppBase.prototype.require = function (type, url) { return null; };\n        JetAppBase.prototype._first_start = function (route) {\n            var _this = this;\n            this._segment = route;\n            var cb = function (a) { return setTimeout(function () {\n                _this.show(a).catch(function (e) {\n                    if (!(e instanceof NavigationBlocked))\n                        throw e;\n                });\n            }, 1); };\n            this.$router = new (this.config.router)(cb, this.config, this);\n            if (this._container === document.body && this.config.animation !== false) {\n                var node_1 = this._container;\n                this.webix.html.addCss(node_1, \"webixappstart\");\n                setTimeout(function () {\n                    _this.webix.html.removeCss(node_1, \"webixappstart\");\n                    _this.webix.html.addCss(node_1, \"webixapp\");\n                }, 10);\n            }\n            if (!route) {\n                var urlString = this.$router.get();\n                if (!urlString) {\n                    urlString = this.config.start;\n                    this.$router.set(urlString, { silent: true });\n                }\n                route = new Route(urlString, 0);\n            }\n            else if (this.app) {\n                var now = route.current().view;\n                route.current().view = this;\n                if (route.next()) {\n                    route.refresh();\n                    route = route.split();\n                }\n                else {\n                    route = new Route(this.config.start, 0);\n                }\n                route.current().view = now;\n            }\n            return route;\n        };\n        JetAppBase.prototype._loadError = function (url, err) {\n            this.error(\"app:error:resolve\", [err, url]);\n            return { template: \" \" };\n        };\n        JetAppBase.prototype.addSubView = function (obj, target, config) {\n            var url = obj.$subview !== true ? obj.$subview : null;\n            var name = obj.name || (url ? this.webix.uid() : \"default\");\n            target.id = obj.id || \"s\" + this.webix.uid();\n            var view = config[name] = {\n                id: target.id,\n                url: url,\n                branch: obj.branch,\n                popup: obj.popup,\n                params: obj.params\n            };\n            return view.popup ? null : target;\n        };\n        return JetAppBase;\n    }(JetBase));\n    var HashRouter = (function () {\n        function HashRouter(cb, config) {\n            var _this = this;\n            this.config = config || {};\n            this._detectPrefix();\n            this.cb = cb;\n            window.onpopstate = function () { return _this.cb(_this.get()); };\n        }\n        HashRouter.prototype.set = function (path, config) {\n            var _this = this;\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                for (var key in this.config.routes) {\n                    if (this.config.routes[key] === compare[0]) {\n                        path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                        break;\n                    }\n                }\n            }\n            if (this.get() !== path) {\n                window.history.pushState(null, null, this.prefix + this.sufix + path);\n            }\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        HashRouter.prototype.get = function () {\n            var path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n            path = (path !== \"/\" && path !== \"#\") ? path : \"\";\n            if (this.config.routes) {\n                var compare = path.split(\"?\", 2);\n                var key = this.config.routes[compare[0]];\n                if (key) {\n                    path = key + (compare.length > 1 ? \"?\" + compare[1] : \"\");\n                }\n            }\n            return path;\n        };\n        HashRouter.prototype._detectPrefix = function () {\n            var sufix = this.config.routerPrefix;\n            this.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n            this.prefix = document.location.href.split(\"#\", 2)[0];\n        };\n        HashRouter.prototype._getRaw = function () {\n            return document.location.href;\n        };\n        return HashRouter;\n    }());\n    var isPatched = false;\n    function patch(w) {\n        if (isPatched || !w) {\n            return;\n        }\n        isPatched = true;\n        var win = window;\n        if (!win.Promise) {\n            win.Promise = w.promise;\n        }\n        var version = w.version.split(\".\");\n        if (version[0] * 10 + version[1] * 1 < 53) {\n            w.ui.freeze = function (handler) {\n                var res = handler();\n                if (res && res.then) {\n                    res.then(function (some) {\n                        w.ui.$freeze = false;\n                        w.ui.resize();\n                        return some;\n                    });\n                }\n                else {\n                    w.ui.$freeze = false;\n                    w.ui.resize();\n                }\n                return res;\n            };\n        }\n        var baseAdd = w.ui.baselayout.prototype.addView;\n        var baseRemove = w.ui.baselayout.prototype.removeView;\n        var config = {\n            addView: function (view, index) {\n                if (this.$scope && this.$scope.webixJet && !view.queryView) {\n                    var jview_1 = this.$scope;\n                    var subs_1 = {};\n                    view = jview_1.app.copyConfig(view, {}, subs_1);\n                    baseAdd.apply(this, [view, index]);\n                    var _loop_1 = function (key) {\n                        jview_1._renderFrame(key, subs_1[key], null).then(function () {\n                            jview_1._subs[key] = subs_1[key];\n                        });\n                    };\n                    for (var key in subs_1) {\n                        _loop_1(key);\n                    }\n                    return view.id;\n                }\n                else {\n                    return baseAdd.apply(this, arguments);\n                }\n            },\n            removeView: function () {\n                baseRemove.apply(this, arguments);\n                if (this.$scope && this.$scope.webixJet) {\n                    var subs = this.$scope._subs;\n                    for (var key in subs) {\n                        var test = subs[key];\n                        if (!w.$$(test.id)) {\n                            test.view.destructor();\n                            delete subs[key];\n                        }\n                    }\n                }\n            }\n        };\n        w.extend(w.ui.layout.prototype, config, true);\n        w.extend(w.ui.baselayout.prototype, config, true);\n        w.protoUI({\n            name: \"jetapp\",\n            $init: function (cfg) {\n                this.$app = new this.app(cfg);\n                var id = w.uid().toString();\n                cfg.body = { id: id };\n                this.$ready.push(function () {\n                    this.callEvent(\"onInit\", [this.$app]);\n                    this.$app.render({ id: id });\n                });\n            }\n        }, w.ui.proxy, w.EventSystem);\n    }\n    var JetApp = (function (_super) {\n        __extends(JetApp, _super);\n        function JetApp(config) {\n            var _this = this;\n            config.router = config.router || HashRouter;\n            _this = _super.call(this, config) || this;\n            patch(_this.webix);\n            return _this;\n        }\n        JetApp.prototype.require = function (type, url) {\n            return require(type + \"/\" + url);\n        };\n        return JetApp;\n    }(JetAppBase));\n    var UrlRouter = (function (_super) {\n        __extends(UrlRouter, _super);\n        function UrlRouter() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        UrlRouter.prototype._detectPrefix = function () {\n            this.prefix = \"\";\n            this.sufix = this.config.routerPrefix || \"\";\n        };\n        UrlRouter.prototype._getRaw = function () {\n            return document.location.pathname + (document.location.search || \"\");\n        };\n        return UrlRouter;\n    }(HashRouter));\n    var EmptyRouter = (function () {\n        function EmptyRouter(cb, _$config) {\n            this.path = \"\";\n            this.cb = cb;\n        }\n        EmptyRouter.prototype.set = function (path, config) {\n            var _this = this;\n            this.path = path;\n            if (!config || !config.silent) {\n                setTimeout(function () { return _this.cb(path); }, 1);\n            }\n        };\n        EmptyRouter.prototype.get = function () {\n            return this.path;\n        };\n        return EmptyRouter;\n    }());\n    function UnloadGuard(app, view, config) {\n        view.on(app, \"app:guard\", function (_$url, point, promise) {\n            if (point === view || point.contains(view)) {\n                var res_1 = config();\n                if (res_1 === false) {\n                    promise.confirm = Promise.reject(new NavigationBlocked());\n                }\n                else {\n                    promise.confirm = promise.confirm.then(function () { return res_1; });\n                }\n            }\n        });\n    }\n    function has(store, key) {\n        return Object.prototype.hasOwnProperty.call(store, key);\n    }\n    function forEach(obj, handler, context) {\n        for (var key in obj) {\n            if (has(obj, key)) {\n                handler.call((context || obj), obj[key], key, obj);\n            }\n        }\n    }\n    function trim(str) {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n    function warn(message) {\n        message = 'Warning: ' + message;\n        if (typeof console !== 'undefined') {\n            console.error(message);\n        }\n        try {\n            throw new Error(message);\n        }\n        catch (x) { }\n    }\n    var replace = String.prototype.replace;\n    var split = String.prototype.split;\n    var delimiter = '||||';\n    var russianPluralGroups = function (n) {\n        var end = n % 10;\n        if (n !== 11 && end === 1) {\n            return 0;\n        }\n        if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n            return 1;\n        }\n        return 2;\n    };\n    var pluralTypes = {\n        arabic: function (n) {\n            if (n < 3) {\n                return n;\n            }\n            var lastTwo = n % 100;\n            if (lastTwo >= 3 && lastTwo <= 10)\n                return 3;\n            return lastTwo >= 11 ? 4 : 5;\n        },\n        bosnian_serbian: russianPluralGroups,\n        chinese: function () { return 0; },\n        croatian: russianPluralGroups,\n        french: function (n) { return n > 1 ? 1 : 0; },\n        german: function (n) { return n !== 1 ? 1 : 0; },\n        russian: russianPluralGroups,\n        lithuanian: function (n) {\n            if (n % 10 === 1 && n % 100 !== 11) {\n                return 0;\n            }\n            return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n        },\n        czech: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            return (n >= 2 && n <= 4) ? 1 : 2;\n        },\n        polish: function (n) {\n            if (n === 1) {\n                return 0;\n            }\n            var end = n % 10;\n            return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n        },\n        icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n        slovenian: function (n) {\n            var lastTwo = n % 100;\n            if (lastTwo === 1) {\n                return 0;\n            }\n            if (lastTwo === 2) {\n                return 1;\n            }\n            if (lastTwo === 3 || lastTwo === 4) {\n                return 2;\n            }\n            return 3;\n        }\n    };\n    var pluralTypeToLanguages = {\n        arabic: ['ar'],\n        bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n        chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n        croatian: ['hr', 'hr-HR'],\n        german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n        french: ['fr', 'tl', 'pt-br'],\n        russian: ['ru', 'ru-RU'],\n        lithuanian: ['lt'],\n        czech: ['cs', 'cs-CZ', 'sk'],\n        polish: ['pl'],\n        icelandic: ['is'],\n        slovenian: ['sl-SL']\n    };\n    function langToTypeMap(mapping) {\n        var ret = {};\n        forEach(mapping, function (langs, type) {\n            forEach(langs, function (lang) {\n                ret[lang] = type;\n            });\n        });\n        return ret;\n    }\n    function pluralTypeName(locale) {\n        var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n        return langToPluralType[locale]\n            || langToPluralType[split.call(locale, /-/, 1)[0]]\n            || langToPluralType.en;\n    }\n    function pluralTypeIndex(locale, count) {\n        return pluralTypes[pluralTypeName(locale)](count);\n    }\n    function escape(token) {\n        return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    function constructTokenRegex(opts) {\n        var prefix = (opts && opts.prefix) || '%{';\n        var suffix = (opts && opts.suffix) || '}';\n        if (prefix === delimiter || suffix === delimiter) {\n            throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n        }\n        return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n    }\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$';\n    var defaultTokenRegex = /%\\{(.*?)\\}/g;\n    function transformPhrase(phrase, substitutions, locale, tokenRegex) {\n        if (typeof phrase !== 'string') {\n            throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n        }\n        if (substitutions == null) {\n            return phrase;\n        }\n        var result = phrase;\n        var interpolationRegex = tokenRegex || defaultTokenRegex;\n        var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n        if (options.smart_count != null && result) {\n            var texts = split.call(result, delimiter);\n            result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n        }\n        result = replace.call(result, interpolationRegex, function (expression, argument) {\n            if (!has(options, argument) || options[argument] == null) {\n                return expression;\n            }\n            return replace.call(options[argument], dollarRegex, dollarBillsYall);\n        });\n        return result;\n    }\n    function Polyglot(options) {\n        var opts = options || {};\n        this.phrases = {};\n        this.extend(opts.phrases || {});\n        this.currentLocale = opts.locale || 'en';\n        var allowMissing = opts.allowMissing ? transformPhrase : null;\n        this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n        this.warn = opts.warn || warn;\n        this.tokenRegex = constructTokenRegex(opts.interpolation);\n    }\n    Polyglot.prototype.locale = function (newLocale) {\n        if (newLocale)\n            this.currentLocale = newLocale;\n        return this.currentLocale;\n    };\n    Polyglot.prototype.extend = function (morePhrases, prefix) {\n        forEach(morePhrases, function (phrase, key) {\n            var prefixedKey = prefix ? prefix + '.' + key : key;\n            if (typeof phrase === 'object') {\n                this.extend(phrase, prefixedKey);\n            }\n            else {\n                this.phrases[prefixedKey] = phrase;\n            }\n        }, this);\n    };\n    Polyglot.prototype.unset = function (morePhrases, prefix) {\n        if (typeof morePhrases === 'string') {\n            delete this.phrases[morePhrases];\n        }\n        else {\n            forEach(morePhrases, function (phrase, key) {\n                var prefixedKey = prefix ? prefix + '.' + key : key;\n                if (typeof phrase === 'object') {\n                    this.unset(phrase, prefixedKey);\n                }\n                else {\n                    delete this.phrases[prefixedKey];\n                }\n            }, this);\n        }\n    };\n    Polyglot.prototype.clear = function () {\n        this.phrases = {};\n    };\n    Polyglot.prototype.replace = function (newPhrases) {\n        this.clear();\n        this.extend(newPhrases);\n    };\n    Polyglot.prototype.t = function (key, options) {\n        var phrase, result;\n        var opts = options == null ? {} : options;\n        if (typeof this.phrases[key] === 'string') {\n            phrase = this.phrases[key];\n        }\n        else if (typeof opts._ === 'string') {\n            phrase = opts._;\n        }\n        else if (this.onMissingKey) {\n            var onMissingKey = this.onMissingKey;\n            result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n        }\n        else {\n            this.warn('Missing translation for key: \"' + key + '\"');\n            result = key;\n        }\n        if (typeof phrase === 'string') {\n            result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n        }\n        return result;\n    };\n    Polyglot.prototype.has = function (key) {\n        return has(this.phrases, key);\n    };\n    Polyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n        return transformPhrase(phrase, substitutions, locale);\n    };\n    var webixPolyglot = Polyglot;\n    function Locale(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n        function setLangData(name, data, silent) {\n            if (data.__esModule) {\n                data = data.default;\n            }\n            var pconfig = { phrases: data };\n            if (config.polyglot) {\n                app.webix.extend(pconfig, config.polyglot);\n            }\n            var poly = service.polyglot = new webixPolyglot(pconfig);\n            poly.locale(name);\n            service._ = app.webix.bind(poly.t, poly);\n            lang = name;\n            if (storage) {\n                storage.put(\"lang\", lang);\n            }\n            if (config.webix) {\n                var locName = config.webix[name];\n                if (locName) {\n                    app.webix.i18n.setLocale(locName);\n                }\n            }\n            if (!silent) {\n                return app.refresh();\n            }\n            return Promise.resolve();\n        }\n        function getLang() { return lang; }\n        function setLang(name, silent) {\n            if (config.path === false) {\n                return;\n            }\n            var path = (config.path ? config.path + \"/\" : \"\") + name;\n            var data = app.require(\"jet-locales\", path);\n            setLangData(name, data, silent);\n        }\n        var service = {\n            getLang: getLang, setLang: setLang, setLangData: setLangData, _: null, polyglot: null\n        };\n        app.setService(\"locale\", service);\n        setLang(lang, true);\n    }\n    function show(view, config, value) {\n        var _a;\n        if (config.urls) {\n            value = config.urls[value] || value;\n        }\n        else if (config.param) {\n            value = (_a = {}, _a[config.param] = value, _a);\n        }\n        view.show(value);\n    }\n    function Menu(app, view, config) {\n        var frame = view.getSubViewInfo().parent;\n        var ui = view.$$(config.id || config);\n        var silent = false;\n        ui.attachEvent(\"onchange\", function () {\n            if (!silent) {\n                show(frame, config, this.getValue());\n            }\n        });\n        ui.attachEvent(\"onafterselect\", function () {\n            if (!silent) {\n                var id = null;\n                if (ui.setValue) {\n                    id = this.getValue();\n                }\n                else if (ui.getSelectedId) {\n                    id = ui.getSelectedId();\n                }\n                show(frame, config, id);\n            }\n        });\n        view.on(app, \"app:route\", function () {\n            var name = \"\";\n            if (config.param) {\n                name = view.getParam(config.param, true);\n            }\n            else {\n                var segment = frame.getUrl()[1];\n                if (segment) {\n                    name = segment.page;\n                }\n            }\n            if (name) {\n                silent = true;\n                if (ui.setValue && ui.getValue() !== name) {\n                    ui.setValue(name);\n                }\n                else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name) {\n                    ui.select(name);\n                }\n                silent = false;\n            }\n        });\n    }\n    var baseicons = {\n        good: \"check\",\n        error: \"warning\",\n        saving: \"refresh fa-spin\"\n    };\n    var basetext = {\n        good: \"Ok\",\n        error: \"Error\",\n        saving: \"Connecting...\"\n    };\n    function Status(app, view, config) {\n        var status = \"good\";\n        var count = 0;\n        var iserror = false;\n        var expireDelay = config.expire;\n        if (!expireDelay && expireDelay !== false) {\n            expireDelay = 2000;\n        }\n        var texts = config.texts || basetext;\n        var icons = config.icons || baseicons;\n        if (typeof config === \"string\") {\n            config = { target: config };\n        }\n        function refresh(content) {\n            var area = view.$$(config.target);\n            if (area) {\n                if (!content) {\n                    content = \"<div class='status_\" +\n                        status +\n                        \"'><span class='webix_icon fa-\" +\n                        icons[status] + \"'></span> \" + texts[status] + \"</div>\";\n                }\n                area.setHTML(content);\n            }\n        }\n        function success() {\n            count--;\n            setStatus(\"good\");\n        }\n        function fail(err) {\n            count--;\n            setStatus(\"error\", err);\n        }\n        function start(promise) {\n            count++;\n            setStatus(\"saving\");\n            if (promise && promise.then) {\n                promise.then(success, fail);\n            }\n        }\n        function getStatus() {\n            return status;\n        }\n        function hideStatus() {\n            if (count === 0) {\n                refresh(\" \");\n            }\n        }\n        function setStatus(mode, err) {\n            if (count < 0) {\n                count = 0;\n            }\n            if (mode === \"saving\") {\n                status = \"saving\";\n                refresh();\n            }\n            else {\n                iserror = (mode === \"error\");\n                if (count === 0) {\n                    status = iserror ? \"error\" : \"good\";\n                    if (iserror) {\n                        app.error(\"app:error:server\", [err.responseText || err]);\n                    }\n                    else {\n                        if (expireDelay) {\n                            setTimeout(hideStatus, expireDelay);\n                        }\n                    }\n                    refresh();\n                }\n            }\n        }\n        function track(data) {\n            var dp = app.webix.dp(data);\n            if (dp) {\n                view.on(dp, \"onAfterDataSend\", start);\n                view.on(dp, \"onAfterSaveError\", function (_id, _obj, response) { return fail(response); });\n                view.on(dp, \"onAfterSave\", success);\n            }\n        }\n        app.setService(\"status\", {\n            getStatus: getStatus,\n            setStatus: setStatus,\n            track: track\n        });\n        if (config.remote) {\n            view.on(app.webix, \"onRemoteCall\", start);\n        }\n        if (config.ajax) {\n            view.on(app.webix, \"onBeforeAjax\", function (_mode, _url, _data, _request, _headers, _files, promise) {\n                start(promise);\n            });\n        }\n        if (config.data) {\n            track(config.data);\n        }\n    }\n    function Theme(app, _view, config) {\n        config = config || {};\n        var storage = config.storage;\n        var theme = storage ?\n            (storage.get(\"theme\") || \"flat-default\")\n            :\n                (config.theme || \"flat-default\");\n        var service = {\n            getTheme: function () { return theme; },\n            setTheme: function (name, silent) {\n                var parts = name.split(\"-\");\n                var links = document.getElementsByTagName(\"link\");\n                for (var i = 0; i < links.length; i++) {\n                    var lname = links[i].getAttribute(\"title\");\n                    if (lname) {\n                        if (lname === name || lname === parts[0]) {\n                            links[i].disabled = false;\n                        }\n                        else {\n                            links[i].disabled = true;\n                        }\n                    }\n                }\n                app.webix.skin.set(parts[0]);\n                app.webix.html.removeCss(document.body, \"theme-\" + theme);\n                app.webix.html.addCss(document.body, \"theme-\" + name);\n                theme = name;\n                if (storage) {\n                    storage.put(\"theme\", name);\n                }\n                if (!silent) {\n                    app.refresh();\n                }\n            }\n        };\n        app.setService(\"theme\", service);\n        service.setTheme(theme, true);\n    }\n    function copyParams(data, url, route) {\n        for (var i = 0; i < route.length; i++) {\n            data[route[i]] = url[i + 1] ? url[i + 1].page : \"\";\n        }\n    }\n    function UrlParam(app, view, config) {\n        var route = config.route || config;\n        var data = {};\n        view.on(app, \"app:urlchange\", function (subview, segment) {\n            if (view === subview) {\n                copyParams(data, segment.suburl(), route);\n                segment.size(route.length + 1);\n            }\n        });\n        var os = view.setParam;\n        var og = view.getParam;\n        view.setParam = function (name, value, show) {\n            var index = route.indexOf(name);\n            if (index >= 0) {\n                data[name] = value;\n                this._segment.update(\"\", value, index + 1);\n                if (show) {\n                    return view.show(null);\n                }\n            }\n            else {\n                return os.call(this, name, value, show);\n            }\n        };\n        view.getParam = function (key, mode) {\n            var val = data[key];\n            if (typeof val !== \"undefined\") {\n                return val;\n            }\n            return og.call(this, key, mode);\n        };\n        copyParams(data, view.getUrl(), route);\n    }\n    function User(app, _view, config) {\n        config = config || {};\n        var login = config.login || \"/login\";\n        var logout = config.logout || \"/logout\";\n        var afterLogin = config.afterLogin || app.config.start;\n        var afterLogout = config.afterLogout || \"/login\";\n        var ping = config.ping || 5 * 60 * 1000;\n        var model = config.model;\n        var user = config.user;\n        var service = {\n            getUser: function () {\n                return user;\n            },\n            getStatus: function (server) {\n                if (!server) {\n                    return user !== null;\n                }\n                return model.status().catch(function () { return null; }).then(function (data) {\n                    user = data;\n                });\n            },\n            login: function (name, pass) {\n                return model.login(name, pass).then(function (data) {\n                    user = data;\n                    if (!data) {\n                        throw new Error(\"Access denied\");\n                    }\n                    app.callEvent(\"app:user:login\", [user]);\n                    app.show(afterLogin);\n                });\n            },\n            logout: function () {\n                user = null;\n                return model.logout().then(function (res) {\n                    app.callEvent(\"app:user:logout\", []);\n                    return res;\n                });\n            }\n        };\n        function canNavigate(url, obj) {\n            if (url === logout) {\n                service.logout();\n                obj.redirect = afterLogout;\n            }\n            else if (url !== login && !service.getStatus()) {\n                obj.redirect = login;\n            }\n        }\n        app.setService(\"user\", service);\n        app.attachEvent(\"app:guard\", function (url, _$root, obj) {\n            if (config.public && config.public(url)) {\n                return true;\n            }\n            if (typeof user === \"undefined\") {\n                obj.confirm = service.getStatus(true).then(function () { return canNavigate(url, obj); });\n            }\n            return canNavigate(url, obj);\n        });\n        if (ping) {\n            setInterval(function () { return service.getStatus(true); }, ping);\n        }\n    }\n    var webix$1 = window.webix;\n    if (webix$1) {\n        patch(webix$1);\n    }\n    var plugins = {\n        UnloadGuard: UnloadGuard, Locale: Locale, Menu: Menu, Theme: Theme, User: User, Status: Status, UrlParam: UrlParam\n    };\n    var w = window;\n    if (!w.Promise) {\n        w.Promise = w.webix.promise;\n    }\n\n    var index = 1;\n    function uid() {\n        return index++;\n    }\n    var empty = undefined;\n    function ignoreInitial(code) {\n        var init = false;\n        return function () {\n            if (init)\n                return code.apply(this, arguments);\n            else\n                init = true;\n        };\n    }\n    var context = null;\n    function link(source, target, key) {\n        Object.defineProperty(target, key, {\n            get: function () { return source[key]; },\n            set: function (value) { return (source[key] = value); },\n        });\n    }\n    function createState(data, config) {\n        config = config || {};\n        var handlers = {};\n        var out = {};\n        var observe = function (mask, handler) {\n            var key = uid();\n            handlers[key] = { mask: mask, handler: handler };\n            if (mask === \"*\")\n                handler(out, empty, mask);\n            else\n                handler(out[mask], empty, mask);\n            return key;\n        };\n        var observeEnd = function (id) {\n            delete handlers[id];\n        };\n        var queue = [];\n        var waitInQueue = false;\n        var batch = function (code) {\n            if (typeof code !== \"function\") {\n                var values_1 = code;\n                code = function () {\n                    for (var key in values_1)\n                        out[key] = values_1[key];\n                };\n            }\n            waitInQueue = true;\n            code(out);\n            waitInQueue = false;\n            while (queue.length) {\n                var obj = queue.shift();\n                notify.apply(this, obj);\n            }\n        };\n        var notify = function (key, old, value, meta) {\n            if (waitInQueue) {\n                queue.push([key, old, value, meta]);\n                return;\n            }\n            var list = Object.keys(handlers);\n            for (var i = 0; i < list.length; i++) {\n                var obj = handlers[list[i]];\n                if (!obj)\n                    continue;\n                if (obj.mask === \"*\" || obj.mask === key) {\n                    obj.handler(value, old, key, meta);\n                }\n            }\n        };\n        for (var key2 in data) {\n            if (data.hasOwnProperty(key2)) {\n                var test = data[key2];\n                if (config.nested && typeof test === \"object\" && test) {\n                    out[key2] = createState(test, config);\n                }\n                else {\n                    reactive(out, test, key2, notify);\n                }\n            }\n        }\n        Object.defineProperty(out, \"$changes\", {\n            value: {\n                attachEvent: observe,\n                detachEvent: observeEnd,\n            },\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$observe\", {\n            value: observe,\n            enumerable: false,\n            configurable: false,\n        });\n        Object.defineProperty(out, \"$batch\", {\n            value: batch,\n            enumerable: false,\n            configurable: false,\n        });\n        return out;\n    }\n    function reactive(obj, val, key, notify) {\n        Object.defineProperty(obj, key, {\n            get: function () {\n                return val;\n            },\n            set: function (value) {\n                var changed = false;\n                if (val === null || value === null) {\n                    changed = val !== value;\n                }\n                else {\n                    changed = val.valueOf() != value.valueOf();\n                }\n                if (changed) {\n                    var old = val;\n                    val = value;\n                    notify(key, old, value, context);\n                }\n            },\n            enumerable: true,\n            configurable: false,\n        });\n    }\n\n    var ActionsPopupView = (function (_super) {\n        __extends(ActionsPopupView, _super);\n        function ActionsPopupView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        ActionsPopupView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            return {\n                view: \"popup\",\n                point: false,\n                body: {\n                    view: \"list\",\n                    yCount: 4,\n                    width: 120,\n                    borderless: true,\n                    data: [\n                        { id: \"edit\", value: _(\"Edit\") },\n                        { id: \"add-filter\", value: _(\"Add Filter\") },\n                        { id: \"add-group\", value: _(\"Add Group\") },\n                        { id: \"delete\", value: _(\"Delete\") },\n                    ],\n                    click: function (id) {\n                        _this.app.callEvent(\"action\", [id, _this.Item]);\n                        _this.Hide();\n                    },\n                },\n            };\n        };\n        ActionsPopupView.prototype.Hide = function () {\n            this.getRoot().hide();\n        };\n        ActionsPopupView.prototype.Show = function (node, item) {\n            this.Item = item;\n            var pos = webix.html.offset(node);\n            this.getRoot().show({\n                x: pos.x + pos.width + webix.skin.$active.dataPadding,\n                y: pos.y - 10,\n            });\n        };\n        return ActionsPopupView;\n    }(JetView));\n\n    var menuRight = \"<span style='float:right' class='webix_icon action-menu wxi-dots'></span>\";\n    var menuClose = \"<span style='float:right' class='webix_icon action-close wxi-close'></span>\";\n\n    var BaseView = (function (_super) {\n        __extends(BaseView, _super);\n        function BaseView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        BaseView.prototype.GetButton = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var button = {\n                view: \"button\",\n                value: _(\"Add filter\"),\n                localId: \"button\",\n                css: \"webix_primary\",\n                click: function () { return _this.Add(null, null); },\n            };\n            return button;\n        };\n        BaseView.prototype.GetList = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var simple = this.getParam(\"simple\");\n            var icon = simple ? menuClose : menuRight;\n            var AND = _(\"and\");\n            var OR = _(\"or\");\n            var GLUE = function (obj) { return (obj.glue == \"and\" ? AND : OR); };\n            var list = {\n                view: \"tree\",\n                borderless: true,\n                localId: \"list\",\n                glue: \"and\",\n                css: \"wbq-query_list\",\n                scheme: {\n                    $serialize: function (obj) {\n                        if (obj.group) {\n                            return { group: obj.group, glue: obj.glue };\n                        }\n                        var out = {\n                            glue: obj.glue,\n                            field: obj.field,\n                            condition: obj.condition,\n                        };\n                        if (obj.includes && obj.includes.length)\n                            out.includes = obj.includes;\n                        return out;\n                    },\n                    $init: function (obj) {\n                        if (obj.group) {\n                            obj.$css = \"group\";\n                            obj.open = true;\n                        }\n                    },\n                },\n                type: {\n                    template: function (obj) {\n                        if (obj.group) {\n                            var editCss = _this.DisableSwitch\n                                ? \"wbq-filter_join_disabled\"\n                                : \"\";\n                            return \"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \" \" + editCss + \"'>\" + GLUE(obj) + \"</div>\";\n                        }\n                        return (_this.Template(obj, _this.app.config.fields, icon, _) +\n                            (\"<div class='wbq-filter_join wbq-filter_join_\" + obj.glue + \"'>\" + GLUE(obj) + \"</div>\"));\n                    },\n                },\n                onClick: {\n                    \"action-menu\": function (e, id) {\n                        this.$scope.Actions.Show(e.target, id);\n                    },\n                    \"action-close\": function (e, id) {\n                        _this.Delete(id);\n                    },\n                    \"wbq-filter_join\": function (e, id) {\n                        _this.SwitchGlue(id);\n                    },\n                },\n                on: {\n                    onItemDblClick: function (id) {\n                        _this.EditStart(id);\n                    },\n                },\n            };\n            return list;\n        };\n        BaseView.prototype.init = function () {\n            var _this = this;\n            this.Actions = this.ui(ActionsPopupView);\n            this.on(this.app, \"applyFilter\", function (v) { return _this.EditStop(v); });\n            this.on(this.app, \"action\", function (type, id) {\n                if (type === \"delete\") {\n                    _this.Delete(id);\n                }\n                else if (type === \"add-filter\") {\n                    _this.Add(null, id);\n                }\n                else if (type === \"add-group\") {\n                    _this.AddGroup(null, id);\n                }\n                else if (type === \"edit\") {\n                    webix.delay(function () { return _this.EditStart(id); });\n                }\n            });\n            this.State = this.getParam(\"state\");\n            this.on(this.State.$changes, \"value\", function (v) {\n                _this.LastValue = JSON.stringify(v);\n                _this.EditStop();\n                _this.$$(\"list\").clearAll();\n                if (v) {\n                    _this.$$(\"list\").parse(_this.ConvertTo(v));\n                }\n            });\n        };\n        BaseView.prototype.ConvertTo = function (v, glue) {\n            var _this = this;\n            if (v.rules) {\n                var data = v.rules.map(function (a) { return _this.ConvertTo(a, v.glue); });\n                if (!glue)\n                    return data;\n                return { group: true, glue: glue, data: data };\n            }\n            var out = __assign(__assign({}, v), { glue: glue });\n            return out;\n        };\n        BaseView.prototype.ConvertFrom = function (id, source) {\n            var _this = this;\n            var glue = \"and\";\n            var branch = source.getBranch(id);\n            var rules = branch.map(function (_a) {\n                var id = _a.id, field = _a.field, type = _a.type, condition = _a.condition, includes = _a.includes;\n                if (field)\n                    return { field: field, type: type, condition: condition, includes: includes };\n                return _this.ConvertFrom(id, source);\n            });\n            if (!rules.length)\n                return null;\n            glue = branch[0].glue;\n            return { glue: glue, rules: rules };\n        };\n        BaseView.prototype.Add = function (obj, after) {\n            this.EditStop();\n            obj = obj || { field: \"\" };\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            if (!after && list.count())\n                after = list.getFirstId();\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            obj.glue = glue;\n            var id = list.add(obj, index, parent);\n            this.EditStart(id);\n            this.CreateMode = true;\n        };\n        BaseView.prototype.SwitchGlue = function (id) {\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var branch = list.data.getBranch(list.getParentId(id));\n            for (var i = 0; i < branch.length; i++) {\n                list.updateItem(branch[i].id, {\n                    glue: branch[i].glue == \"and\" ? \"or\" : \"and\",\n                });\n            }\n            this.Save();\n        };\n        BaseView.prototype.AddGroup = function (obj, after) {\n            this.EditStop();\n            obj = obj || {};\n            var list = this.$$(\"list\");\n            var parent = after ? list.getParentId(after) : 0;\n            var index = after ? list.getBranchIndex(after) + 1 : -1;\n            var node = { id: webix.uid(), group: true };\n            var glue = after ? list.getItem(after).glue : list.config.glue;\n            node.glue = glue;\n            obj.glue = node.glue == \"and\" ? \"or\" : \"and\";\n            this.DisableSwitch = true;\n            list.add(node, index, parent);\n            var id = list.add(obj, null, node.id);\n            this.EditStart(id);\n            this.DisableSwitch = false;\n            this.CreateMode = true;\n        };\n        BaseView.prototype.Delete = function (id) {\n            this.EditStop();\n            this.DeleteSilent(id);\n            this.Save();\n        };\n        BaseView.prototype.DeleteSilent = function (id) {\n            var list = this.$$(\"list\");\n            if (!list.exists(id))\n                return null;\n            var parent = list.getParentId(id);\n            list.remove(id);\n            var branch = list.data.branch[parent];\n            if (parent && !branch) {\n                this.DeleteSilent(parent);\n            }\n            else if (branch.length == 1 && list.getItem(branch[0]).group) {\n                var sub = branch[0];\n                if (parent) {\n                    var grand = list.getParentId(parent);\n                    var pIndex = list.getBranchIndex(parent, grand);\n                    list.move(sub, pIndex, list, { parent: grand });\n                    this.DeleteSilent(parent);\n                }\n                else {\n                    var pIndex = list.getBranchIndex(sub, 0);\n                    var kids = [].concat(list.data.branch[sub]);\n                    list.move(kids, pIndex, list, { parent: 0 });\n                    this.DeleteSilent(sub);\n                }\n            }\n        };\n        BaseView.prototype.EditStop = function (v) {\n            if (!this.Active)\n                return;\n            var list = this.$$(\"list\");\n            if (!v) {\n                if (this.CreateMode)\n                    this.DeleteSilent(this.ActiveId);\n                else\n                    list.refresh(this.ActiveId);\n            }\n            else {\n                v = v || this.Active.GetValue();\n                v.includes = v.includes || [];\n                list.updateItem(this.ActiveId, __assign({}, v));\n            }\n            var t = this.Active;\n            this.Active = null;\n            this.ActiveId = null;\n            t.destructor();\n            this.Save();\n        };\n        BaseView.prototype.Save = function () {\n            var v = this.ConvertFrom(0, this.$$(\"list\").data);\n            var asString = JSON.stringify(v);\n            if (this.LastValue !== asString) {\n                this.State.value = v;\n            }\n        };\n        BaseView.prototype.Template = function (obj, fields, icon, _) {\n            var op = \"&nbsp;\";\n            var field = fields.find(function (a) { return a.id === obj.field; }) || { value: \"\" };\n            if (obj.includes && obj.includes.length) {\n                op = _(\"in\") + \" \";\n                for (var i = 0; i < obj.includes.length; i++) {\n                    op +=\n                        (i > 0 ? \", \" : \"\") +\n                            (\"<span class='wbq-field-value'>\" + obj.includes[i] + \"</span>\");\n                }\n            }\n            else {\n                if (obj.condition && obj.condition.type) {\n                    op = _(obj.condition.type) + \" <span class='wbq-field-value'>\" + this.Format(obj.condition.filter, field.format, field.type) + \"</span>\";\n                }\n            }\n            return \"<span class='wbq-field-box'><span class='wbq-field-name'>\" + field.value + \"</span> \" + op + \" </span>\" + icon;\n        };\n        BaseView.prototype.Format = function (value, format, type) {\n            if (!value)\n                return \"\";\n            if (value.start)\n                value =\n                    this.Format(value.start, format, type) +\n                        (value.end ? \" - \" + this.Format(value.end, format, type) : \"\");\n            else {\n                var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                if (parser)\n                    value = parser(value);\n            }\n            return value;\n        };\n        return BaseView;\n    }(JetView));\n\n    var FilterView = (function (_super) {\n        __extends(FilterView, _super);\n        function FilterView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterView.prototype.config = function () {\n            var _this = this;\n            var _ = this.app.getService(\"locale\")._;\n            var fieldselect = {\n                view: \"richselect\",\n                options: [],\n                localId: \"field\",\n                on: {\n                    onChange: function () { return _this.AdjustToField(); },\n                },\n            };\n            var filter = { localId: \"filter\" };\n            var bottombar = {\n                type: \"clean\",\n                cols: [\n                    {\n                        view: \"button\",\n                        value: _(\"Cancel\"),\n                        width: 100,\n                        click: function () { return _this.Hide(); },\n                    },\n                    {},\n                    {\n                        view: \"button\",\n                        value: _(\"Apply\"),\n                        width: 100,\n                        css: \"webix_primary\",\n                        click: function () { return _this.ApplyFilter(); },\n                    },\n                ],\n            };\n            return {\n                padding: 10,\n                margin: 6,\n                css: \"webix_shadow_small\",\n                rows: [fieldselect, filter, bottombar],\n            };\n        };\n        FilterView.prototype.GetField = function () {\n            var fselect = this.$$(\"field\");\n            return fselect.getList().getItem(fselect.getValue());\n        };\n        FilterView.prototype.AdjustToField = function () {\n            var field = this.GetField();\n            this.CreateFilter(field.id, field.type, field.format, field.conditions, this.$$(\"filter\"));\n        };\n        FilterView.prototype.CreateFilter = function (field, type, format, conditions, place) {\n            var ui = {\n                view: \"filter\",\n                localId: \"filter\",\n                conditions: conditions,\n                field: field,\n                mode: type,\n                template: function (o) {\n                    var str = o[field];\n                    var parser = format || (type == \"date\" ? webix.i18n.dateFormatStr : null);\n                    if (parser)\n                        str = parser(str);\n                    return str;\n                },\n                margin: 6,\n            };\n            var filter = webix.ui(ui, place);\n            var data = this.app.getService(\"backend\").data(field);\n            filter.parse(data);\n            return filter;\n        };\n        FilterView.prototype.ApplyFilter = function () {\n            this.app.callEvent(\"applyFilter\", [this.GetValue()]);\n        };\n        FilterView.prototype.GetValue = function () {\n            var field = this.GetField();\n            var rule = __assign(__assign({}, this.$$(\"filter\").getValue()), { field: field.id, type: field.type });\n            if (rule.condition.filter == \"\" &&\n                (!rule.includes || !rule.includes.length))\n                rule = null;\n            return rule;\n        };\n        FilterView.prototype.Hide = function () {\n            this.app.callEvent(\"applyFilter\", [null]);\n        };\n        FilterView.prototype.Show = function (value, fields) {\n            var fselect = this.$$(\"field\");\n            fselect.getList().parse(fields);\n            if (value.field) {\n                fselect.setValue(value.field);\n            }\n            else {\n                fselect.setValue(fields[0].id);\n            }\n            this.$$(\"filter\").setValue(webix.copy(value));\n        };\n        return FilterView;\n    }(JetView));\n\n    var FilterPopup = (function (_super) {\n        __extends(FilterPopup, _super);\n        function FilterPopup() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        FilterPopup.prototype.config = function () {\n            return {\n                view: \"popup\",\n                point: false,\n                body: { $subview: FilterView, name: \"body\" },\n            };\n        };\n        FilterPopup.prototype.Show = function (value, fields, at) {\n            var _this = this;\n            setTimeout(function () {\n                _this.getRoot().show(at);\n                _this.getSubView(\"body\").Show(value, fields);\n            }, 100);\n        };\n        return FilterPopup;\n    }(JetView));\n\n    var TopBarView = (function (_super) {\n        __extends(TopBarView, _super);\n        function TopBarView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopBarView.prototype.config = function () {\n            var button = this.GetButton();\n            button.width = 100;\n            var list = this.GetList();\n            list.scroll = this.app.config.scroll !== false ? \"x\" : \"\";\n            list.borderless = true;\n            list.css = \"wbq-query_bar\";\n            var small = webix.skin.$name == \"mini\" || webix.skin.$name == \"compact\";\n            var padding = 8, height = 58;\n            if (small) {\n                padding = 4;\n                height = 50;\n            }\n            if (list.scroll)\n                height += webix.env.scrollSize;\n            return {\n                view: \"toolbar\",\n                paddingX: padding * 2,\n                paddingY: padding,\n                height: height,\n                borderless: true,\n                cols: [list, button],\n            };\n        };\n        TopBarView.prototype.EditStart = function (id) {\n            var _this = this;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            this.ActiveId = id;\n            this.Active = this.ui(FilterPopup);\n            this.Active.getRoot().attachEvent(\"onHide\", function () {\n                if (_this.Active)\n                    _this.EditStop();\n            });\n            var at = webix.html.offset(list.getItemNode(id));\n            this.Active.Show(list.getItem(id), this.app.config.fields, at);\n            this.CreateMode = false;\n        };\n        return TopBarView;\n    }(BaseView));\n\n    var TopListView = (function (_super) {\n        __extends(TopListView, _super);\n        function TopListView() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        TopListView.prototype.config = function () {\n            return {\n                paddingX: 16,\n                paddingY: 8,\n                margin: 0,\n                rows: [this.GetButton(), this.GetList()],\n            };\n        };\n        TopListView.prototype.EditStart = function (id) {\n            var _this = this;\n            if (this.ActiveId && this.ActiveId == id)\n                return;\n            this.EditStop();\n            var list = this.$$(\"list\");\n            var container = list.getItemNode(id);\n            container.classList.add(\"active-editor\");\n            container.innerHTML = \"\";\n            this.ActiveId = id;\n            this.Active = this.ui(FilterView, { container: container });\n            this.$$(\"list\").attachEvent(\"onAfterRender\", function () { return _this.EditStop(); });\n            this.Active.Show(list.getItem(id), this.app.config.fields);\n            this.CreateMode = false;\n        };\n        return TopListView;\n    }(BaseView));\n\n    var views = { JetView: JetView };\n    views[\"actions\"] = ActionsPopupView;\n    views[\"bar\"] = TopBarView;\n    views[\"base\"] = BaseView;\n    views[\"filter\"] = FilterView;\n    views[\"list\"] = TopListView;\n    views[\"popup\"] = FilterPopup;\n\n    var en = {\n        \"Add filter\": \"Add filter\",\n        in: \"=\",\n        equal: \"=\",\n        notEqual: \"<>\",\n        less: \"<\",\n        greater: \">\",\n        greaterOrEqual: \">=\",\n        lessOrEqual: \"<=\",\n        contains: \"contains\",\n        notContains: \"not contains\",\n        beginsWith: \"begins\",\n        notBeginsWith: \"not begings\",\n        endsWith: \"ends\",\n        notEndsWith: \"not ends\",\n        between: \"between\",\n        notBetween: \"not between\",\n        and: \"and\",\n        or: \"or\",\n        Edit: \"Edit\",\n        \"Add Filter\": \"Add Filter\",\n        \"Add Group\": \"Add Group\",\n        Delete: \"Delete\",\n        Apply: \"Apply\",\n        Cancel: \"Cancel\",\n    };\n\n    var Backend = (function () {\n        function Backend(app) {\n            this._app = app;\n        }\n        Backend.prototype.data = function (field) {\n            var data = this._app.config.data;\n            if (typeof data == \"function\")\n                return Promise.resolve(data(field)).then(function (a) {\n                    return a.map(function (b) {\n                        var _a;\n                        return (_a = {}, _a[field] = b, _a);\n                    });\n                });\n            return Promise.resolve(data);\n        };\n        Backend.prototype.save = function (v) {\n            console.log(v);\n        };\n        return Backend;\n    }());\n\n    function query(query, fields) {\n        var ops = webix.filters;\n        var types = {};\n        fields.forEach(function (a) {\n            if (a.conditions)\n                a.conditions.forEach(function (op) {\n                    if (typeof op === \"object\") {\n                        ops[op.id] = op.handler;\n                    }\n                });\n            if (a.type)\n                types[a.id] = a.type;\n        });\n        return queryToFilter(query, ops, types);\n    }\n    function queryToFilter(query, ops, types) {\n        if (!query || !query.rules.length)\n            return function () { return true; };\n        var filters = query.rules.map(function (a) { return singleFilter(a, ops, types); });\n        return (query.glue === \"or\" ? glueOr : glueAnd)(filters);\n    }\n    function glueAnd(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (!f[i](v))\n                    return false;\n            }\n            return true;\n        };\n    }\n    function glueOr(f) {\n        return function (v) {\n            for (var i = 0; i < f.length; i++) {\n                if (f[i](v))\n                    return true;\n            }\n            return false;\n        };\n    }\n    function singleFilter(rule, ops, types) {\n        if (rule.rules) {\n            return queryToFilter(rule, ops, types);\n        }\n        return function (v) {\n            var test = v[rule.field];\n            if (rule.includes && rule.includes.length) {\n                return rule.includes.findIndex(function (a) { return a === test; }) !== -1;\n            }\n            if (!webix.isUndefined(test)) {\n                var con = rule.condition.type;\n                var filter = ops[con] || ops[types[rule.field]][con];\n                return filter(test, rule.condition.filter);\n            }\n            return false;\n        };\n    }\n\n    var App = (function (_super) {\n        __extends(App, _super);\n        function App(config) {\n            var _this = this;\n            var state = createState({\n                value: config.value || null,\n            });\n            var defaults = {\n                router: EmptyRouter,\n                version: \"10.0.9\",\n                debug: true,\n            };\n            _this = _super.call(this, __assign(__assign({}, defaults), config)) || this;\n            _this.config.start = config.type === \"bar\" ? \"/bar\" : \"/list\";\n            _this.config.params = { state: state, simple: config.simple === true };\n            _this.setService(\"backend\", new (_this.dynamic(Backend))(_this));\n            _this.use(plugins.Locale, _this.config.locale || {\n                lang: \"en\",\n                webix: {\n                    en: \"en-US\",\n                },\n            });\n            return _this;\n        }\n        App.prototype.dynamic = function (obj) {\n            return this.config.override ? this.config.override.get(obj) || obj : obj;\n        };\n        App.prototype.require = function (type, name) {\n            if (type === \"jet-views\")\n                return views[name];\n            else if (type === \"jet-locales\")\n                return locales[name];\n            return null;\n        };\n        App.prototype.getState = function () {\n            return this.config.params.state;\n        };\n        App.prototype.GetFilter = function () {\n            return query(this.config.params.state.value, this.config.fields);\n        };\n        return App;\n    }(JetApp));\n    webix.protoUI({\n        name: \"query\",\n        app: App,\n        getState: function () {\n            return this.$app.getState();\n        },\n        getService: function (name) {\n            return this.$app.getService(name);\n        },\n        $init: function () {\n            var _this = this;\n            var state = this.getState();\n            for (var key in state) {\n                link(state, this.config, key);\n            }\n            state.$changes.attachEvent(\"value\", ignoreInitial(function (v, o) { return _this.callEvent(\"onChange\", v, o); }));\n        },\n        getFilterFunction: function () {\n            return this.$app.GetFilter();\n        },\n    }, webix.ui.jetapp);\n    var services = { Backend: Backend };\n    var locales = { en: en };\n\n    exports.App = App;\n    exports.locales = locales;\n    exports.services = services;\n    exports.views = views;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\nimport \"../../helpers/inputlist\";\nimport { removeRight } from \"../../helpers/icons\";\n\nexport default class CommonView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tlet form = {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 130,\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Report name\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\tlocalId: \"name\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Description\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\theight: 150,\n\t\t\t\t\t\t\tname: \"desc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{ view: \"label\", label: _(\"Data source\") },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"combo\",\n\t\t\t\t\t\t\tname: \"data\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"input-list\",\n\t\t\t\t\tname: \"joins\",\n\t\t\t\t\ttemplate: this.JoinListTemplate.bind(this),\n\t\t\t\t\tdata: [],\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_rpt_action_remove: (ev, id) => this.RemoveJoin(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tlabel: _(\"Join data\"),\n\t\t\t\t\tclick: () => this.ShowJoins(),\n\t\t\t\t},\n\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlabel: _(\"Delete report\"),\n\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\tinputWidth: 170,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tcss: \"webix_rpt_delete\",\n\t\t\t\t\tclick: () => this.app.callEvent(\"onMenuAction\", [null, \"delete\"]),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tconst els = this.getRoot().elements;\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.AppState = this.app.getParam(\"state\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Models = this.Local.getModels(true);\n\n\t\tconst keys = Object.keys(this.Models);\n\t\tconst combo = els.data;\n\t\tcombo.getList().parse(\n\t\t\tkeys.map(a => {\n\t\t\t\tconst m = this.Models[a];\n\t\t\t\treturn { id: m.id, value: m.name };\n\t\t\t})\n\t\t);\n\n\t\tbind(this.State, \"*\", this.getRoot(), this);\n\t\tthis.on(this.State.$changes, \"id\", v => this.ShowDeleteButton(v));\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowDeleteButton(v));\n\n\t\tthis.SourcesList = this.ui({\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tautoheight: true,\n\t\t\t\ttype: {\n\t\t\t\t\ttemplate: this.JoinTemplate.bind(this),\n\t\t\t\t},\n\t\t\t\tclick: id => {\n\t\t\t\t\tconst item = this.SourcesList.getBody().getItem(id);\n\t\t\t\t\tthis.AddJoin(item);\n\t\t\t\t\tthis.SourcesList.hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tAddJoin(item) {\n\t\tconst batch = this.Local.addJoin(item.tid, this.State);\n\t\tbatch.joins = [...this.State.joins, item];\n\t\tthis.State.$batch(batch);\n\t}\n\n\tRemoveJoin(id) {\n\t\tconst next = this.Local.cleanLinkedModels(id, this.State);\n\n\t\tif (!next.block) this.State.$batch(next);\n\t\telse {\n\t\t\tif (next.block.filter)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related query filter first\"),\n\t\t\t\t});\n\t\t\tif (next.block.group)\n\t\t\t\twebix.alert({\n\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\ttext: this._(\"Please delete the related group rule first\"),\n\t\t\t\t});\n\t\t}\n\t}\n\n\tJoinTemplate(obj) {\n\t\tconst s = this.Models[obj.sid];\n\t\tconst t = this.Models[obj.tid];\n\t\tconst f = obj.sf || obj.tf;\n\t\tconst n = (obj.sf ? s : t).data.find(a => a.id === f).name;\n\t\treturn `${t.name} <span class='webix_rpt_sources_path'>${s.name}${\n\t\t\tobj.sf ? ` (${n})` : \"\"\n\t\t} -> ${t.name}${obj.tf ? ` (${n})` : \"\"}</span>`;\n\t}\n\n\tJoinListTemplate(obj) {\n\t\treturn removeRight + this.JoinTemplate(obj);\n\t}\n\n\tShowJoins() {\n\t\tconst data = this.Local.getLinkedModels(\n\t\t\t[this.State.data].concat(this.State.joins.map(a => a.tid)),\n\t\t\ttrue\n\t\t);\n\t\tif (!data.length) return;\n\n\t\tconst list = this.SourcesList.getBody();\n\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.SourcesList.show(this.$$(\"add\").$view);\n\t}\n\n\tShowDeleteButton() {\n\t\tif (this.State.id && this.AppState.toolbar) this.$$(\"delete\").show();\n\t\telse this.$$(\"delete\").hide();\n\t}\n}\n","export function prompt(config, app) {\n\tconst result = new webix.promise.defer();\n\n\twebix\n\t\t.ui(\n\t\t\tapp.getService(\"jet-win\").updateConfig({\n\t\t\t\tview: \"window\",\n\t\t\t\thead: {\n\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\tpadding: { left: 12, right: 4 },\n\t\t\t\t\tborderless: true,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{ view: \"label\", label: config.text },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\tresult.reject(\"prompt cancelled\");\n\t\t\t\t\t\t\t\tthis.getTopParentView().close();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"form\",\n\t\t\t\t\tpadding: { top: 5, left: 20, right: 20, bottom: 20 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 10,\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\t\t\t\tvalue: config.value,\n\t\t\t\t\t\t\t\t\twidth: 230,\n\t\t\t\t\t\t\t\t\tcss: \"fm-prompt-input\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tvalue: config.button,\n\t\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t\tconst popup = this.getTopParentView();\n\t\t\t\t\t\t\t\t\t\tconst newname = popup.getBody().getValues().name;\n\t\t\t\t\t\t\t\t\t\tresult.resolve(newname);\n\t\t\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tconst input = this.getBody().elements.name.getInputNode();\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\tif (config.selectMask) config.selectMask(input);\n\t\t\t\t\t\telse input.select();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t})\n\t\t)\n\t\t.show();\n\n\treturn result;\n}\n","webix.protoUI(\n\t{\n\t\tname: \"query-select\",\n\t\t$cssName: \"richselect\",\n\n\t\t$init() {\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_qselect_icon: function() {\n\t\t\t\t\tthis.callEvent(\"onClearClick\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\twebix.ui.richselect\n);\n","import { JetView } from \"webix-jet\";\n\nimport \"@xbs/query/codebase/query\";\n\nexport default class QueryView extends JetView {\n\tconfig() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tconst local = this.app.getService(\"local\");\n\n\t\treturn {\n\t\t\tview: \"query\",\n\t\t\tlocalId: \"query\",\n\t\t\tcss: \"webix_rpt_query\",\n\t\t\tlocale: { lang: this.app.getService(\"locale\").getLang() },\n\t\t\tdata: field => {\n\t\t\t\tconst column = this.State.fields.find(a => a.id === field);\n\t\t\t\tif (column.type === \"boolean\") return [0, 1];\n\t\t\t\treturn local.getFieldData(field, column.type);\n\t\t\t},\n\t\t\tfields: this.State.fields\n\t\t\t\t.filter(a => a.type !== \"reference\" && a.type !== \"picklist\")\n\t\t\t\t.map(a => {\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tid: a.id,\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\ta.name +\n\t\t\t\t\t\t\t\" \" +\n\t\t\t\t\t\t\t(a.model\n\t\t\t\t\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + a.model + \"</span>\"\n\t\t\t\t\t\t\t\t: \"\"),\n\t\t\t\t\t\ttype: a.type,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (obj.type === \"boolean\") {\n\t\t\t\t\t\tobj.conditions = [\"equal\"];\n\t\t\t\t\t\tobj.type = \"number\";\n\t\t\t\t\t}\n\n\t\t\t\t\treturn obj;\n\t\t\t\t}),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst query = this.getRoot();\n\n\t\tthis.on(this.State.$changes, \"query\", value => {\n\t\t\tquery.$app.callEvent(\"applyFilter\", [null]);\n\t\t\tquery.config.value = value ? fixDates(JSON.parse(value)) : null;\n\t\t});\n\t\tquery.getState().$observe(\"value\", v => {\n\t\t\tthis.State.query = v ? JSON.stringify(v) : \"\";\n\t\t});\n\t}\n}\n\nfunction fixDates(value) {\n\tif (value.rules) value.rules.forEach(fixDates);\n\telse {\n\t\tif (value.type === \"date\") {\n\t\t\tvar c = value.condition;\n\t\t\tif (c.filter && typeof value.condition.filter === \"string\")\n\t\t\t\tc.filter = new Date(c.filter);\n\t\t\tif (c.filter.start && typeof c.filter.start === \"string\")\n\t\t\t\tc.filter.start = new Date(c.filter.start);\n\t\t\tif (c.filter.end && typeof c.filter.end === \"string\")\n\t\t\t\tc.filter.end = new Date(c.filter.end);\n\t\t}\n\t}\n\n\treturn value;\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport { bind } from \"jet-restate-bind\";\nimport { prompt } from \"../../helpers/prompt\";\nimport \"../../helpers/queryselect\";\n\nimport Query from \"./query\";\n\nexport default class QueryBuilderView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst querySelect = {\n\t\t\tlocalId: \"qblock\",\n\t\t\ttype: \"clean\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\ttype: \"form\",\n\t\t\t\t\tmargin: 5,\n\t\t\t\t\tpadding: { bottom: 5 },\n\t\t\t\t\trows: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlocalId: \"queryBar\",\n\t\t\t\t\t\t\tvisibleBatch: \"def\",\n\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t{ view: \"label\", label: _(\"Filtering query\"), width: 120 },\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"delete\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Delete\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.DeleteQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"copy\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Create copy\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.CopyQuery(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbatch: \"query\",\n\t\t\t\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\t\t\t\tlocalId: \"rename\",\n\t\t\t\t\t\t\t\t\ticon: \"rpi-pencil\",\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Rename\"),\n\t\t\t\t\t\t\t\t\tclick: () => this.RenameQuery(),\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\t\t\t\tlocalId: \"save\",\n\t\t\t\t\t\t\t\t\tlabel: _(\"Save\"),\n\t\t\t\t\t\t\t\t\ttooltip: _(\"Save query\"),\n\t\t\t\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\t\t\t\tclick: () => this.SaveQuery(null),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"query-select\",\n\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\tname: \"id\",\n\t\t\t\t\t\t\tcss: \"webix_rpt_qselect\",\n\t\t\t\t\t\t\tlocalId: \"qselect\",\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\tcss: \"webix_rpt_qselect_suggest\",\n\t\t\t\t\t\t\t\ttemplate: item => this.QSelectTemplate(item),\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\tminHeight: 25,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonShow: function() {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!this.getBody().$view.firstChild.getAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\"\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\tthis.getBody().$view.firstChild.setAttribute(\n\t\t\t\t\t\t\t\t\t\t\t\t\"placeholder\",\n\t\t\t\t\t\t\t\t\t\t\t\t_(\"No saved queries\")\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonClearClick: () => this.NewQuery(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\ttemplate: _(\"Save filter to use it in other reports\"),\n\t\t\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tQuery,\n\t\t\t],\n\t\t};\n\n\t\treturn querySelect;\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\t\tconst qData = (this.Queries = this.Local.getQueries());\n\n\t\tthis.LocalState = createState({ id: \"\", saved: true });\n\n\t\tqData.waitData.then(() => {\n\t\t\tconst now = this.State.query;\n\t\t\tconst ctrl = this.$$(\"qselect\");\n\t\t\tconst list = ctrl.getList();\n\n\t\t\tconst tables = { [this.State.data]: 1 };\n\t\t\tthis.State.joins.forEach(a => (tables[a.tid] = 1));\n\n\t\t\tqData.filter(a => {\n\t\t\t\tlet res = true;\n\t\t\t\ta.models.forEach(m => {\n\t\t\t\t\tif (!tables[m]) res = false;\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t});\n\t\t\tlist.sync(qData);\n\n\t\t\tqData.data.each(v => {\n\t\t\t\tif (v.text == now) ctrl.setValue(v.id);\n\t\t\t});\n\n\t\t\tthis.on(state.$changes, \"query\", v => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tconst changed = (!id && v) || (id && qData.getItem(id).text != v);\n\t\t\t\tthis.LocalState.saved = !changed;\n\t\t\t});\n\t\t});\n\n\t\tbind(this.LocalState, \"id\", this.$$(\"qselect\"), this);\n\n\t\tconst saveBtn = this.$$(\"save\");\n\t\tthis.on(this.LocalState.$changes, \"saved\", v => {\n\t\t\tif (v) saveBtn.disable();\n\t\t\telse saveBtn.enable();\n\t\t});\n\n\t\tthis.on(this.LocalState.$changes, \"id\", v => {\n\t\t\tif (v) {\n\t\t\t\tconst item = qData.getItem(v);\n\t\t\t\tthis.State.query = item.text;\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"query\");\n\t\t\t} else {\n\t\t\t\tthis.$$(\"queryBar\").showBatch(\"def\");\n\t\t\t}\n\t\t});\n\t}\n\n\tNewQuery() {\n\t\tthis.LocalState.id = null;\n\t\tthis.LocalState.saved = true;\n\t\tthis.State.query = null;\n\t}\n\n\tSaveQuery(name) {\n\t\tconst id = this.LocalState.id;\n\t\tconst text = this.State.query;\n\n\t\tif (id) {\n\t\t\tif (name === null) name = this.Queries.getItem(id).name;\n\t\t\tthis.Operations.updateQuery(id, { name, text }).then(() => {\n\t\t\t\tthis.$$(\"qselect\").setValue(id);\n\t\t\t\tthis.LocalState.saved = true;\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t\tvalue: \"\",\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (name) {\n\t\t\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\t\t\tthis.LocalState.saved = true;\n\t\t\t\t\tthis.LocalState.id = id;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tRenameQuery() {\n\t\tconst id = this.LocalState.id;\n\t\tconst { name } = this.Queries.getItem(id);\n\n\t\tprompt(\n\t\t\t{\n\t\t\t\ttext: this._(\"Enter query name\"),\n\t\t\t\tvalue: name,\n\t\t\t\tbutton: this._(\"Save\"),\n\t\t\t},\n\t\t\tthis.app\n\t\t).then(name => {\n\t\t\tif (!name) return;\n\n\t\t\tthis.SaveQuery(name);\n\t\t});\n\t}\n\n\tCopyQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet { name, text } = this.Queries.getItem(this.LocalState.id);\n\t\tname = _(\"Copy of\") + \" \" + name;\n\t\tthis.Operations.addQuery({ name, text }).then(id => {\n\t\t\tthis.LocalState.id = id;\n\t\t});\n\t}\n\n\tDeleteQuery() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\tok: _(\"Delete\"),\n\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\ttext: _(\"Are you sure to delete this query?\"),\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst id = this.LocalState.id;\n\t\t\t\tthis.Operations.deleteQuery(id).then(() => {\n\t\t\t\t\tthis.LocalState.$batch({ saved: true, id: null });\n\t\t\t\t\tthis.State.query = null;\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tGetMenuOptions() {\n\t\treturn [\n\t\t\t{ id: \"copy\", value: \"Copy\", icon: \"rpi-content-copy\" },\n\t\t\t{ id: \"rename\", value: \"Rename\", icon: \"rpi-pencil\" },\n\t\t\t{ id: \"delete\", value: \"Delete\", icon: \"rpi-delete\" },\n\t\t];\n\t}\n\n\tGetMenuTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span>${obj.value}`;\n\t}\n\n\tApplyQueryAction(id) {\n\t\tthis.QueryMenu.hide();\n\t\tswitch (id) {\n\t\t\tcase \"rename\":\n\t\t\t\tthis.RenameQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"copy\":\n\t\t\t\tthis.CopyQuery();\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\t\tthis.DeleteQuery();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tQSelectTemplate(obj) {\n\t\treturn `${obj.value} <span class='webix_icon wxi-close webix_rpt_qselect_icon'></span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { withContext, createState, debounce } from \"jet-restate\";\n\nexport default class TopView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\toptionWidth: 102,\n\t\t\ttabMinWidth: 102,\n\t\t\tview: \"tabbar\",\n\t\t\tlocalId: \"tabbar\",\n\t\t\tcss: \"webix_rpt_editor_tabbar\",\n\t\t\tborderless: true,\n\t\t\toptions: [\n\t\t\t\t{ id: \"common\", value: _(\"Common\") },\n\t\t\t\t{ id: \"data\", value: _(\"Query\") },\n\t\t\t\t{ id: \"other\", value: _(\"Data\") },\n\t\t\t\t{ id: \"structure\", value: _(\"View\") },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ShowView(v),\n\t\t\t},\n\t\t};\n\n\t\tconst skin = webix.skin.$name;\n\t\tif (skin == \"flat\" || skin == \"compact\" || skin == \"contrast\")\n\t\t\ttabbar.type = \"bottom\";\n\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: { left: 13, top: 0, bottom: 0 },\n\t\t\t//padding: { left: 13, top: webix.skin.$active.layoutPadding.toolbar, bottom: webix.skin.$active.layoutPadding.toolbar },\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tscroll: false,\n\t\t\tcols: [\n\t\t\t\ttabbar,\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\twidth: 40,\n\t\t\t\t\tlocalId: \"closeBtn\",\n\t\t\t\t\ticon: \"rpi-close\",\n\t\t\t\t\tclick: () => this.Hide(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 490,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Operations = this.app.getService(\"operations\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn this.Local.ready(ui);\n\t}\n\n\tinit() {\n\t\tthis.AppState = this.app.getParam(\"state\");\n\n\t\tconst initial = this.Local.newModule();\n\t\tinitial.id = -1; // mark as temporary\n\n\t\tconst state = (this.State = createState(initial));\n\t\tthis.setParam(\"state\", this.State);\n\n\t\tthis.on(this.AppState.$changes, \"moduleId\", v => this.ChangeModule(v));\n\t\tthis.on(this.State.$changes, \"data\", (id, o, k, ctx) => {\n\t\t\tif (id && (!ctx || !ctx.load)) this.ChangeModel(id);\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"toolbar\", v => this.ShowHideButton(v));\n\n\t\tthis.on(\n\t\t\tthis.State.$changes,\n\t\t\t\"*\",\n\t\t\tdebounce(() => {\n\t\t\t\tif (this.State.id === -1) return;\n\n\t\t\t\tthis.TrackChanges();\n\t\t\t\tthis.AppState.module = Object.assign({}, this.State);\n\t\t\t})\n\t\t);\n\n\t\tthis.on(state.$changes, \"group\", (v, old, _key, ctx) => {\n\t\t\tif (!v && old) {\n\t\t\t\t// revert back\n\t\t\t\tconst columns =\n\t\t\t\t\tstate.oldColumns ||\n\t\t\t\t\tthis.Local.getFields(state.data, state.joins, true);\n\t\t\t\tconst numColumns = webix\n\t\t\t\t\t.copy(columns)\n\t\t\t\t\t.filter(a => a.type == \"number\" && !a.key);\n\t\t\t\tconst meta = this.UpdateMeta(numColumns, columns);\n\t\t\t\tstate.$batch({\n\t\t\t\t\tpublicFields: null,\n\t\t\t\t\tcolumns,\n\t\t\t\t\tmeta,\n\t\t\t\t});\n\t\t\t} else if (v) {\n\t\t\t\tlet prev = [];\n\t\t\t\tif (!ctx || !ctx.load) {\n\t\t\t\t\tif (!old) state.oldColumns = state.columns;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (JSON.stringify(v) == JSON.stringify(old)) return;\n\t\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tprev = [...this.State.columns];\n\t\t\t\t}\n\n\t\t\t\t// group mode changed, add new columns\n\t\t\t\tlet columns = v.columns.map(a => ({\n\t\t\t\t\tid: `${a.op}.${a.id}`,\n\t\t\t\t\tname: a.name,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\tmeta: {},\n\t\t\t\t\tmodel: \"\",\n\t\t\t\t}));\n\t\t\t\tconst groupColumns = webix.copy(columns);\n\t\t\t\tif (v.by)\n\t\t\t\t\tcolumns = columns.concat(\n\t\t\t\t\t\tv.by.map(a => {\n\t\t\t\t\t\t\tconst base = this.State.fields.find(b => b.id == a.id);\n\t\t\t\t\t\t\tconst id = a.mod ? `${a.mod}.${a.id}` : a.id;\n\t\t\t\t\t\t\tconst obj = { ...base, id };\n\t\t\t\t\t\t\tif (a.mod) obj.type = \"text\";\n\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t// apply modifications\n\t\t\t\tconst was = {};\n\t\t\t\t(state.publicFields || state.columns).forEach(a => (was[a.id] = 1));\n\t\t\t\tconst now = {};\n\t\t\t\t// add new / rename\n\t\t\t\tcolumns.forEach(a => {\n\t\t\t\t\tnow[a.id] = 1;\n\t\t\t\t\tif (!was[a.id]) prev.push(a);\n\t\t\t\t\telse {\n\t\t\t\t\t\t// rename a column if needed\n\t\t\t\t\t\tlet column = prev.find(b => b.id == a.id);\n\t\t\t\t\t\tif (column && column.name != a.name) column.name = a.name;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//remove old\n\t\t\t\tprev = prev.filter(a => now[a.id]);\n\n\t\t\t\tconst meta = this.UpdateMeta(groupColumns, columns);\n\t\t\t\tif (meta.freeze && meta.freeze >= prev.length) delete meta.freeze;\n\t\t\t\tstate.$batch({ publicFields: columns, columns: prev, meta });\n\t\t\t}\n\t\t});\n\n\t\tthis.on(this.app, \"saveModule\", () => this.Save());\n\n\t\tthis.on(this.app, \"resetModule\", () => this.Reset());\n\n\t\tthis.on(this.app, \"onColumnResize\", (id, width) => {\n\t\t\tvar next = [...this.State.columns];\n\t\t\tnext.find(a => a.id == id).width = width;\n\t\t\tthis.State.columns = next;\n\t\t});\n\n\t\tthis.on(this.AppState.$changes, \"readonly\", mod => {\n\t\t\tif (mod) this.Reset();\n\t\t});\n\n\t\tthis.show(\"./editor.common\");\n\t}\n\n\tSave() {\n\t\tconst save = this.Operations.getModuleSaveData(this.State);\n\t\tconst data = {\n\t\t\tname: this.State.name,\n\t\t\ttext: JSON.stringify(save),\n\t\t};\n\n\t\tif (this.AppState.moduleId)\n\t\t\tthis.Operations.updateModule(this.AppState.moduleId, data).then(id =>\n\t\t\t\tthis.SaveCallback(id)\n\t\t\t);\n\t\telse this.Operations.addModule(data).then(id => this.SaveCallback(id));\n\t}\n\tSaveCallback(id) {\n\t\tthis.AppState.$batch({\n\t\t\tmoduleId: id,\n\t\t\tmode: \"view\",\n\t\t\tmodule: Object.assign({}, this.AppState.module),\n\t\t\tsaved: true,\n\t\t});\n\t}\n\n\tShowView(v) {\n\t\tthis.$$(\"tabbar\").setValue(v);\n\t\tthis.show(\"editor.\" + v);\n\t}\n\n\tHide() {\n\t\tthis.Reset();\n\t}\n\n\tReset() {\n\t\tconst id = this.AppState.moduleId;\n\t\tif (!id) {\n\t\t\tthis.AppState.$batch({ mode: \"list\", module: null, saved: true });\n\t\t} else\n\t\t\tthis.Local.getModule(id).then(mod => {\n\t\t\t\tthis.AppState.$batch({\n\t\t\t\t\tmode: \"view\",\n\t\t\t\t\tmodule: Object.assign({}, JSON.parse(mod.text)),\n\t\t\t\t\tsaved: true,\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tChangeModel(id) {\n\t\tif (id) this.State.$batch(this.Local.setDataSource(id));\n\t}\n\n\tChangeModule(id) {\n\t\tthis.InitStateValue = \"\";\n\t\tif (id) {\n\t\t\tthis.Local.getModule(id).then(item => {\n\t\t\t\tconst obj = JSON.parse(item.text);\n\n\t\t\t\tthis.InitStateValue = item.text;\n\t\t\t\tthis.InitName = obj.name = item.name;\n\n\t\t\t\tobj.id = item.id;\n\t\t\t\tobj.saved = true;\n\t\t\t\tobj.fields = this.Local.getFields(obj.data, obj.joins);\n\n\t\t\t\twithContext({ load: true }, () => this.State.$batch(obj));\n\t\t\t\tthis.AppState.saved = true;\n\t\t\t});\n\t\t} else {\n\t\t\tthis.InitStateValue = null; // we need to have an always active Save button\n\t\t\tthis.State.$batch(this.Local.newModule());\n\t\t\tthis.State.fields = this.Local.getFields(\n\t\t\t\tthis.State.data,\n\t\t\t\tthis.State.joins\n\t\t\t);\n\t\t\tthis.AppState.saved = false;\n\t\t}\n\t}\n\tTrackChanges() {\n\t\tthis.AppState.saved =\n\t\t\tJSON.stringify(this.Operations.getModuleSaveData(this.State)) ==\n\t\t\t\tthis.InitStateValue && this.State.name == this.InitName;\n\t}\n\n\tShowHideButton(v) {\n\t\tif (v) this.$$(\"closeBtn\").show();\n\t\telse this.$$(\"closeBtn\").hide();\n\t}\n\n\tUpdateMeta(numColumns, columns) {\n\t\tlet meta = this.State.meta;\n\t\tconst state = this.State;\n\t\tif (numColumns.length) {\n\t\t\tif (state.type == \"chart\") {\n\t\t\t\tnumColumns = numColumns.map(a => {\n\t\t\t\t\tconst c = { ...a, value: a.name };\n\t\t\t\t\tdelete c.name;\n\t\t\t\t\treturn c;\n\t\t\t\t});\n\t\t\t\tmeta.chart.series = this.app\n\t\t\t\t\t.getService(\"charts\")\n\t\t\t\t\t.getSeries(numColumns, state.chartType);\n\t\t\t} else if (state.type == \"heatmap\") {\n\t\t\t\tmeta.value = numColumns[0].id;\n\t\t\t\tmeta.label = state.publicFields\n\t\t\t\t\t? columns[columns.length - 1].id\n\t\t\t\t\t: columns[0].id;\n\t\t\t\tif (meta.color && !numColumns.find(a => a.id == meta.color))\n\t\t\t\t\tmeta.color = numColumns[0].id;\n\t\t\t}\n\t\t}\n\t\treturn meta;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, masterName) {\n\t\tsuper(app);\n\t\tthis.Name = masterName;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.ClickHandler(id);\n\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t},\n\t\t\t\tdata: this.GetOptions(),\n\t\t\t},\n\t\t};\n\t}\n\n\tClickHandler(id) {\n\t\tthis.getParentView().ApplyAction(id);\n\t}\n\tShow(node, data, index) {\n\t\tthis.SetActionStates(data, index);\n\t\tthis.getRoot().show(node);\n\t}\n\tGetOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [{ id: \"delete\", value: _(\"Delete\"), icon: \"rpi-delete\" }];\n\t}\n\tSetActionStates(data) {\n\t\tconst popup = this.getRoot();\n\t\tconst list = popup.getBody();\n\t\tlist.data.each(action => {\n\t\t\tif (data.length == 1) list.disableItem(action.id);\n\t\t\telse list.enableItem(action.id);\n\t\t});\n\t}\n\tGetTemplate(obj) {\n\t\treturn `<span class='webix_icon ${obj.icon}'></span> ${obj.value}`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class BucketView extends JetView {\n\tconstructor(app, state, pstate) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.ParentState = pstate;\n\t}\n\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.ValueSeparator = \",\";\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tpadding: { top: 0, bottom: 0, left: 0, right: 0 },\n\t\t\tlocalId: \"forms\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\telements: [],\n\t\t};\n\t\tconst other = {\n\t\t\tlocalId: \"other\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tname: \"name\",\n\t\t\t\t\twidth: 150,\n\t\t\t\t\tplaceholder: _(\"Bucket name\"),\n\t\t\t\t\tvalue: _(\"Other\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.Changed(\"other\", \"name\", v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\tlabel: _(\"Other values\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t};\n\t\tconst padding = webix.skin.$active.layoutPadding.form;\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\t\t\tpadding: { top: padding, bottom: padding, left: 0, right: 0 },\n\t\t\tcss: \"webix_rpt_subview\",\n\t\t\trows: [\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\tother,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add bucket\"),\n\t\t\t\t\tinputWidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewBucket(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis.Forms = this.$$(\"forms\");\n\t\tthis.GetRowKeys(this.State.id).then(data => {\n\t\t\tthis.Data = data.sort((a, b) => this.Sort(a, b));\n\t\t\tthis.CreateForm();\n\t\t});\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (name == \"bucket\" && action == \"focus\" && id == this.State.id)\n\t\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.ParentState.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetColumnData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\tGetColumnData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = [baseColumn];\n\t\tdelete moduleConfig.buckets;\n\t\tdelete moduleConfig.group;\n\t\tlet waitData = [\n\t\t\tthis.Local.getData(moduleConfig),\n\t\t\tthis.Local.getOptionsList(baseColumn),\n\t\t];\n\t\treturn Promise.all(waitData);\n\t}\n\n\tCreateForm() {\n\t\tconst options = this.State.options;\n\t\tif (options && options.length) this.LoadBuckets(options);\n\t\telse this.AddNewBucket();\n\t\twebix.delay(() => {\n\t\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"resize\", this.State.id]);\n\t\t\tthis.Focus(0);\n\t\t});\n\t}\n\n\tAddNewBucket() {\n\t\tthis.AddBucket();\n\t\tthis.Changed();\n\t\tthis.Focus();\n\t}\n\n\tLoadBuckets(data) {\n\t\tdata.forEach(bucket => {\n\t\t\tif (!bucket.values) this.LoadOther(bucket);\n\t\t\telse this.AddBucket(bucket);\n\t\t});\n\t\tthis.Changed();\n\t}\n\tLoadOther(b) {\n\t\tconst other = this.$$(\"other\");\n\t\tother.setValues({ name: b.id });\n\t}\n\tAddBucket(bucket) {\n\t\tbucket = bucket || {};\n\t\tthis.Forms.addView(this.GetRowForm(webix.uid(), bucket));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\tname: \"name\",\n\t\t\t\t\t\tvalue: data.id || null,\n\t\t\t\t\t\tplaceholder: this._(\"Bucket name\"),\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: v => this.Changed(id, \"name\", v),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"multicombo\",\n\t\t\t\tname: \"values\",\n\t\t\t\tplaceholder: this._(\"Bucket values\"),\n\t\t\t\tcss: \"webix_multilist webix_rpt_multicombo\",\n\t\t\t\tseparator: this.ValueSeparator,\n\t\t\t\tsuggest: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_multilist webix_rpt_bucket_values\",\n\t\t\t\t\t\tdata: this.Data,\n\t\t\t\t\t\ttemplate: obj => this.OptionTemplate(id, obj),\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonBeforeShow: function() {\n\t\t\t\t\t\t\tthis.getList().refresh();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tvalue: data.values || null,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"values\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"icon\",\n\t\t\t\t\t\ticon: \"wxi-dots\",\n\t\t\t\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tname: webix.rules.isNotEmpty,\n\t\t\t\tvalues: webix.rules.isNotEmpty,\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"bucket\"));\n\t\tconst form = webix\n\t\t\t.$$(id)\n\t\t\t.getParentView()\n\t\t\t.getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetValues(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\tGetValidBuckets() {\n\t\tconst otherForm = this.$$(\"other\");\n\t\tconst otherName = otherForm.elements.name.getValue();\n\t\totherForm.validate();\n\t\tconst names = {};\n\t\tif (otherName) names[otherName] = [otherForm];\n\t\tconst options = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tform.validate();\n\t\t\tlet values = form.getValues();\n\t\t\tlet n = values.name;\n\t\t\tif (n) {\n\t\t\t\tif (names[n]) {\n\t\t\t\t\tthis.$$(names[n]).forEach(f => f.markInvalid(\"name\", true));\n\t\t\t\t\tform.markInvalid(\"name\", true);\n\t\t\t\t} else if (values.values.length)\n\t\t\t\t\toptions.push({ id: n, values: values.values.split(\",\") });\n\t\t\t\tif (!names[n]) names[n] = [];\n\t\t\t\tnames[n].push(form);\n\t\t\t}\n\t\t});\n\t\tif (options.length && otherName) options.push({ id: otherName });\n\t\treturn options;\n\t}\n\tChanged(id, name, value) {\n\t\tif (name == \"values\") this.CorrectValues(id, value);\n\t\tconst options = this.GetValidBuckets();\n\t\tthis.State.options = options;\n\t}\n\n\tOptionTemplate(id, obj) {\n\t\tlet selected =\n\t\t\t!obj.$checked &&\n\t\t\tthis.GetValues().find(\n\t\t\t\tbucket => bucket.id != id && bucket.values.indexOf(obj.value) > -1\n\t\t\t);\n\t\tconst css =\n\t\t\t\"webix_rpt_bucket_value\" +\n\t\t\t(selected ? \" webix_rpt_bucket_value_selected\" : \"\");\n\t\treturn (\n\t\t\t\"<div class='\" +\n\t\t\tcss +\n\t\t\t\"'>\" +\n\t\t\tobj.value +\n\t\t\t\"</div>\" +\n\t\t\t(selected\n\t\t\t\t? \"<span class='webix_rpt_bucket_icon webix_icon rpi-pail-outline'></span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\tGetValues() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tconst v = form.getValues();\n\t\t\tv.id = form.config.localId;\n\t\t\tdata.push(v);\n\t\t});\n\t\treturn data;\n\t}\n\tForEachFormRow(handler) {\n\t\tthis.Forms.getChildViews().forEach(form => {\n\t\t\tif (form && form.elements) {\n\t\t\t\thandler(form);\n\t\t\t}\n\t\t});\n\t}\n\tCorrectValues(id, v) {\n\t\tthis.ForEachFormRow(form => {\n\t\t\tif (form.config.localId != id) {\n\t\t\t\tlet values = form.getValues().values.split(\",\");\n\t\t\t\tvalues = values.filter(a => v.indexOf(a) == -1);\n\t\t\t\tform.elements.values.setValue(values);\n\t\t\t}\n\t\t});\n\t}\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteBucket(this.ActiveForm);\n\t}\n\n\tDeleteBucket(form) {\n\t\tthis.Forms.removeView(form);\n\t\tthis.Changed();\n\t}\n\tSort(a, b) {\n\t\tconst type = this.ParentState.fields.find(c => c.id == this.State.id).type;\n\t\ta = a.value;\n\t\tb = b.value;\n\t\tif (type == \"number\") {\n\t\t\ta = a * 1;\n\t\t\tb = b * 1;\n\t\t\tif (isNaN(b)) return 1;\n\t\t\tif (isNaN(a)) return -1;\n\t\t} else {\n\t\t\tif (!b) return 1;\n\t\t\tif (!a) return -1;\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t}\n\t\treturn a > b ? 1 : a < b ? -1 : 0;\n\t}\n\tFocus(index) {\n\t\twebix.delay(\n\t\t\t() => {\n\t\t\t\tconst forms = this.Forms.getChildViews();\n\t\t\t\tif (typeof index == \"undefined\") index = forms.length - 1;\n\t\t\t\tconst form = forms[index];\n\t\t\t\tif (form) form.elements.name.focus();\n\t\t\t},\n\t\t\tnull,\n\t\t\tnull,\n\t\t\t100\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class SummaryPopupView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tautoheight: true,\n\t\t\tfitMaster: true,\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpadding: { top: 5, bottom: 5, left: 10, right: 10 },\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\t\t\t\tplaceholder: _(\"Search\"),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\tscroll: true,\n\t\t\t\t\t\tyCount: 5,\n\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\ttemplate: obj => this.GetTemplate(obj),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\t\t\tconst item = this.List.getItem(id);\n\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\tthis.View.hide();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonEnter: () => {\n\t\t\t\t\t\t\t\tconst item = this.List.getSelectedItem();\n\t\t\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\t\t\tthis.AddColumn(item);\n\t\t\t\t\t\t\t\t\twebix.delay(() => this.View.hide());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.View = this.getRoot();\n\t\tconst views = this.View.getBody().getChildViews();\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.BucketState = this.getParam(\"buckets\", true);\n\t\tthis.Text = views[0].getChildViews()[0];\n\t\tthis.List = views[1];\n\t\tthis.Text.attachEvent(\"onTimedKeyPress\", () => {\n\t\t\tthis.Find(this.Text.getValue());\n\t\t});\n\t}\n\tAddColumn(column) {\n\t\tconst t = [...this.BucketState.buckets];\n\t\tt.push({ column: column.id, options: [] });\n\t\tthis.BucketState.buckets = t;\n\t}\n\tShow(node) {\n\t\tnode = node.firstChild.firstChild;\n\t\tthis.View.config.width = node.offsetWidth - 2;\n\t\tthis.View.adjust();\n\t\tthis.View.show(node);\n\t\tthis.Text.focus();\n\t\tthis.List.clearAll();\n\t\tthis.List.parse(this.GetColumns());\n\t}\n\tGetColumns() {\n\t\tlet columns = this.State.fields;\n\t\tif (this.State.publicFields)\n\t\t\tcolumns = columns.filter(a =>\n\t\t\t\tthis.State.publicFields.find(b => b.id == a.id)\n\t\t\t);\n\t\treturn columns.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t\tdisabled:\n\t\t\t\tthis.BucketState.buckets &&\n\t\t\t\tthis.BucketState.buckets.find(b => b.column == a.id),\n\t\t}));\n\t}\n\n\tGetTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tFind(value) {\n\t\tvalue = value.toLowerCase();\n\t\tif (value)\n\t\t\tthis.List.filter(item => item.value.toLowerCase().indexOf(value) > -1);\n\t\telse this.List.filter(\"\");\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"groupselect\",\n\t\t$cssName: \"text webix_rpt_groupselect\",\n\t\tdefaults: {\n\t\t\tselectIcon: true,\n\t\t\tmodifiers: {},\n\t\t},\n\t\trenderModifier(id) {\n\t\t\tconst mid = this._modifiers[id];\n\t\t\tif (mid) {\n\t\t\t\tconst option = this.config.modifiers.find(a => a.id === mid);\n\t\t\t\treturn (\n\t\t\t\t\t\"<div class='webix_rpt_date_selector'>\" +\n\t\t\t\t\t(option ? option.value : \"\") +\n\t\t\t\t\t(this.config.selectIcon\n\t\t\t\t\t\t? \"<span class='webix_icon wxi-angle-down'></span>\"\n\t\t\t\t\t\t: \"\") +\n\t\t\t\t\t\"</div> <span class='webix_rpt_groupselect_sep'> | </span> \"\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\t$renderTag(text, width, height, value) {\n\t\t\tlet content = this.renderModifier(value);\n\t\t\tcontent +=\n\t\t\t\t\"<span>\" +\n\t\t\t\ttext +\n\t\t\t\t\"</span><span class='webix_multicombo_delete webix_rpt_groupselect_delete' role='button' aria-label='\" +\n\t\t\t\twebix.i18n.aria.removeItem +\n\t\t\t\t\"'></span>\";\n\t\t\treturn (\n\t\t\t\t\"<li class='webix_multicombo_value' style='line-height:\" +\n\t\t\t\theight +\n\t\t\t\t\"px;' optvalue='\" +\n\t\t\t\twebix.template.escape(value) +\n\t\t\t\t\"'>\" +\n\t\t\t\tcontent +\n\t\t\t\t\"</li>\"\n\t\t\t);\n\t\t},\n\t\t$init() {\n\t\t\tthis._modifiers = {};\n\t\t\twebix.extend(this.on_click, {\n\t\t\t\twebix_rpt_date_selector: function(e, id, node) {\n\t\t\t\t\tlet value = webix.html.locate(e, \"optvalue\");\n\t\t\t\t\tthis.callEvent(\"onModifierClick\", [value, e, node]);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value) {\n\t\t\tif (value) {\n\t\t\t\tif (typeof value !== \"string\" && typeof value[0] !== \"string\") {\n\t\t\t\t\tthis._modifiers = {};\n\t\t\t\t\tvalue = value.map(a => {\n\t\t\t\t\t\tthis._modifiers[a.id] = a.mod || null;\n\t\t\t\t\t\treturn a.id;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t\t} else {\n\t\t\t\tthis._modifiers = {};\n\t\t\t}\n\n\t\t\treturn webix.ui.multicombo.prototype.setValue.call(this, value);\n\t\t},\n\t\tgetModifier(id) {\n\t\t\treturn this._modifiers[id];\n\t\t},\n\t\tsetModifier(id, value, silent) {\n\t\t\tthis._modifiers[id] = value;\n\t\t\tif (!silent) this.callEvent(\"onChange\", []);\n\t\t\tthis.refresh();\n\t\t},\n\t\t// [FIXME] bug in multicombo repainting during view replacing\n\t\t$setSize: function(x, y) {\n\t\t\tvar config = this.config;\n\n\t\t\tconst [px, py] = this._custom_last_size || [0, 0];\n\t\t\tif (x == px && y == py) return;\n\t\t\tthis._custom_last_size = [x, y];\n\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tif (!x || !y) return;\n\t\t\t\tif (config.labelPosition == \"top\") {\n\t\t\t\t\tconfig.labelWidth = 0;\n\t\t\t\t}\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t},\n\t},\n\twebix.ui.multicombo\n);\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport \"../../../helpers/groupselect\";\nimport BucketView from \"./bucket\";\nimport BucketPopup from \"./bucketpopup\";\n\nexport default class BucketSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Views = {};\n\t\tconst columns = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns and their data buckets\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\tlocalId: \"addColumn\",\n\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\tclick: () => this.ShowColumns(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list webix_rpt_bcols\",\n\t\t\tlocalId: \"table\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst buckets = createState({\n\t\t\t\t\tid: obj.id,\n\t\t\t\t\toptions: obj.options,\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tbuckets.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, buckets);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = (this.Views[obj.id] = new BucketView(\n\t\t\t\t\tthis.app,\n\t\t\t\t\tbuckets,\n\t\t\t\t\tthis.State\n\t\t\t\t));\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ToggleSub(id),\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_bucket_delete: (e, id) => {\n\t\t\t\t\twebix\n\t\t\t\t\t\t.confirm({\n\t\t\t\t\t\t\ttitle: _(\"Delete\"),\n\t\t\t\t\t\t\tok: _(\"Delete\"),\n\t\t\t\t\t\t\tcancel: _(\"Cancel\"),\n\t\t\t\t\t\t\ttext: _(\"Are you sure to delete?\"),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => this.RemoveColumn(id));\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [columns, buckets],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Table = this.$$(\"table\");\n\t\tconst buckets = this.State.buckets || [];\n\n\t\tthis.BucketState = createState({ buckets, newColumn: null });\n\t\tthis.LoadBuckets();\n\t\tthis.setParam(\"buckets\", this.BucketState);\n\t\tthis.on(\n\t\t\tthis.BucketState.$changes,\n\t\t\t\"*\",\n\t\t\tignoreInitial((v, o) => this.Changed(v, o))\n\t\t);\n\t\tthis.on(this.app, \"onAction\", (name, action, id) => {\n\t\t\tif (this.getRoot() && name == \"bucket\" && action == \"resize\")\n\t\t\t\tthis.Table.refresh(id);\n\t\t});\n\t}\n\tShowColumns() {\n\t\tif (!this.ColumnList || !this.ColumnList.$view)\n\t\t\tthis.ColumnList = this.ui(BucketPopup, this.State);\n\t\tthis.ColumnList.Show(this.$$(\"addColumn\").$view);\n\t}\n\n\tLoadBuckets() {\n\t\tconst tableData = this.BucketState.buckets\n\t\t\t? this.BucketState.buckets.map(a => {\n\t\t\t\t\tconst field = this.State.fields.find(f => f.id == a.column);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: a.column,\n\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\tmodel: field.model || null,\n\t\t\t\t\t\toptions: a.options,\n\t\t\t\t\t};\n\t\t\t  })\n\t\t\t: [];\n\t\tthis.Table.clearAll();\n\t\tthis.Table.parse(tableData);\n\t\tif (!tableData.length) this.Table.hide();\n\t}\n\tAddColumn(id) {\n\t\tif (this.Table.config.hidden) this.Table.show();\n\t\tconst field = this.State.fields.find(f => f.id == id);\n\t\tthis.Table.add({\n\t\t\tid,\n\t\t\tname: field.name,\n\t\t\tmodel: field.model || null,\n\t\t\toptions: [],\n\t\t});\n\t}\n\tRemoveColumn(id) {\n\t\tthis.Table.remove(id);\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst i = buckets.findIndex(a => a.column == id);\n\t\tbuckets.splice(i, 1);\n\t\tthis.BucketState.buckets = buckets;\n\t\tif (!buckets.length) this.Table.hide();\n\t\tif (this._ActiveEditor && String(id) == String(this._ActiveEditor))\n\t\t\tthis.ResetEditor();\n\t\tthis.Views[id].destructor();\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChanged(newV, oldV) {\n\t\tif (newV.length > oldV.length) {\n\t\t\tconst id = newV[newV.length - 1].column;\n\t\t\tthis.AddColumn(id);\n\t\t\tthis.Table.openSub(id);\n\t\t}\n\t\tconst buckets = this.BucketState.buckets.filter(b => b.options.length);\n\t\tthis.State.buckets = buckets;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tconst html = `<div class='webix_rpt_config_row'>\n\t\t\t<span class='webix_rpt_buckets_num'>\n\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"buckets\")}: </span>\n\t\t\t\t\t${item.options.length}\n\t\t\t\t</span>\n\t\t\t\t<div class='webix_rpt_config_row_name'>\n\t\t\t\t\t<span class='webix_rpt_bucket_sublabel'>${this._(\"column\")}: </span>\n\t\t\t\t\t${item.name}${\n\t\t\titem.model\n\t\t\t\t? `<span class='webix_rpt_sources_path'>${item.model}</span>`\n\t\t\t\t: \"\"\n\t\t}\n\t\t\t\t</div>\n\t\t\t\t<span class='webix_icon rpi-delete webix_rpt_bucket_delete'></span>\n\t\t\t\t${common.subrow(item, common)}\n\t\t\n\t\t</div>`;\n\n\t\treturn html;\n\t}\n\n\tHideAllEditors(id) {\n\t\tconst prevId = this._ActiveEditor;\n\t\tif (prevId && this.Table.getItem(prevId)) this.Table.closeSub(prevId);\n\n\t\tthis._ActiveEditor = id;\n\t\tif (id) this.FocusEditor();\n\t}\n\tFocusEditor() {\n\t\tthis.app.callEvent(\"onAction\", [\"bucket\", \"focus\", this._ActiveEditor]);\n\t}\n\n\tResetEditor() {\n\t\tthis._ActiveEditor = null;\n\t}\n\n\tToggleSub(id) {\n\t\tvar row = this.Table.getItem(id);\n\t\tif (row.$subopen) this.Table.closeSub(id);\n\t\telse this.Table.openSub(id);\n\t}\n\tUpdate(id, data) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst buckets = [...this.BucketState.buckets];\n\t\tconst column = this.BucketState.buckets.find(b => b.column == id);\n\t\tcolumn.options = data.options;\n\t\tthis.BucketState.buckets = buckets;\n\t\tthis.Table.updateItem(id, { options: column.options });\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconstructor(app, master) {\n\t\tsuper(app);\n\t\tthis.Master = master;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tcss: \"webix_rpt_grouppopup\",\n\t\t\t\ttemplate: obj => this.GetPopupTemplate(obj),\n\t\t\t\tdata: this.Master.config.modifiers,\n\t\t\t\tclick: id => {\n\t\t\t\t\tthis.Master.setModifier(this.ActiveGroup, id);\n\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\t$init() {\n\t\tthis.ActiveGroup = null;\n\t}\n\tGetPopupTemplate(obj) {\n\t\tconst isSelected = obj.id == this.Master.getModifier(this.ActiveGroup);\n\t\treturn `${obj.value} <span class='webix_icon wxi-radiobox-${\n\t\t\tisSelected ? \"marked\" : \"blank\"\n\t\t}'></span>`;\n\t}\n\tShow(node, id) {\n\t\tthis.ActiveGroup = id;\n\t\tthis.getRoot().show(node, { x: -10 });\n\t\tthis.getRoot()\n\t\t\t.getBody()\n\t\t\t.refresh();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Popup from \"./summarypopup\";\n\nexport default class Summaries extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst labels = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Function\"),\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Column\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"New column name\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twidth: 38,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst inputs = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tlocalId: \"summaries\",\n\t\t\tview: \"form\",\n\t\t\ttype: \"clean\",\n\t\t\tcss: \"webix_rpt_summary_form\",\n\t\t\telements: [],\n\t\t};\n\n\t\treturn {\n\t\t\tborderless: true,\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [{ view: \"label\", label: _(\"Group summaries\") }],\n\t\t\t\t},\n\t\t\t\tlabels,\n\t\t\t\tinputs,\n\t\t\t\t{\n\t\t\t\t\theight: webix.skin.$active.layoutMargin.form,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ticon: \"wxi-plus\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\tlabel: _(\"Add column\"),\n\t\t\t\t\twidth: 210,\n\t\t\t\t\talign: \"left\",\n\t\t\t\t\tclick: () => this.AddNewAggregation(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.GroupState = this.getParam(\"group\", true);\n\n\t\tthis.SummaryColumns = this.State.fields\n\t\t\t.filter(column => {\n\t\t\t\treturn (\n\t\t\t\t\t(column.type == \"number\" || column.type == \"date\") && !column.key\n\t\t\t\t);\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\tthis.CreateForm();\n\t\tthis.on(this.GroupState.$changes, \"by\", () => this.ValidateFormData());\n\t}\n\n\tCreateForm() {\n\t\tconst aggregate = this.GroupState.columns;\n\t\tif (aggregate && aggregate.length) this.LoadAggregations(aggregate);\n\t\telse this.AddNewAggregation();\n\n\t\tif (!this.SummaryColumns.length) {\n\t\t\tthis.ApplyOneRowMode();\n\t\t}\n\t}\n\tApplyOneRowMode() {\n\t\tconst rows = this.getRoot().getChildViews();\n\t\trows[3].hide();\n\t\trows[4].hide();\n\t}\n\n\tAddNewAggregation() {\n\t\tthis.AddAggregation();\n\t\tthis.Changed();\n\t}\n\n\tLoadAggregations(data) {\n\t\tdata.forEach(summary => {\n\t\t\tthis.AddAggregation(summary);\n\t\t});\n\t\tthis.Changed();\n\t}\n\n\tAddAggregation(aggregation) {\n\t\taggregation = aggregation || this.GetDefaultFormData();\n\t\tif (!aggregation) return false;\n\t\tconst formId = aggregation.id || \"form\" + webix.uid();\n\t\tthis.$$(\"summaries\").addView(this.GetRowForm(formId, aggregation));\n\t}\n\n\tGetRowForm(id, data) {\n\t\tlet cols = [\n\t\t\t{\n\t\t\t\twidth: 100,\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"op\",\n\t\t\t\tvalue: data.op || null,\n\t\t\t\toptions: this.GetOperations(),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"op\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"id\",\n\t\t\t\tdisabled: data.op == \"count\",\n\t\t\t\tvalue: data.id || null,\n\t\t\t\toptions: this.SummaryColumns,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: v => this.Changed(id, \"id\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tvalue: data.name || null,\n\t\t\t\tname: \"name\",\n\t\t\t\ton: {\n\t\t\t\t\tonTimedKeypress: v => this.Changed(id, \"name\", v),\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tcols.push({\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-dots\",\n\t\t\tclick: (id, ev) => this.ShowPopup(id, ev),\n\t\t});\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tlocalId: id,\n\t\t\ttype: \"clean\",\n\t\t\tborderless: true,\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\trules: {\n\t\t\t\tid: value => {\n\t\t\t\t\tconst groupBy = this.GroupState.by;\n\t\t\t\t\treturn !groupBy || groupBy.indexOf(value) < 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tcols: cols,\n\t\t};\n\t}\n\n\tGetDefaultFormData() {\n\t\tconst data = this.GetData();\n\t\tconst columns = this.SummaryColumns;\n\t\tconst operations = this.GetOperations();\n\t\tif (!columns.length) {\n\t\t\tconst op = !data.length ? operations.find(op => op.id == \"count\") : null;\n\t\t\treturn op\n\t\t\t\t? {\n\t\t\t\t\t\top: \"count\",\n\t\t\t\t\t\tid: \"\",\n\t\t\t\t\t\tname: this.NewColumnTemplate(op),\n\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t  }\n\t\t\t\t: null;\n\t\t} else {\n\t\t\tfor (let i = 0; i < operations.length; i++) {\n\t\t\t\tfor (let j = 0; j < columns.length; j++) {\n\t\t\t\t\tconst op = operations[i];\n\t\t\t\t\tif (\n\t\t\t\t\t\t!data.find(\n\t\t\t\t\t\t\trow =>\n\t\t\t\t\t\t\t\trow.op == op.id && (op.id == \"count\" || row.id == columns[j].id)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\top: op.id,\n\t\t\t\t\t\t\tid: op.id != \"count\" ? columns[j].id : null,\n\t\t\t\t\t\t\tname: this.NewColumnTemplate(op, columns[j]),\n\t\t\t\t\t\t\ttype: columns[j].type,\n\t\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tNewColumnTemplate(operation, column) {\n\t\treturn operation.id == \"count\"\n\t\t\t? operation.value\n\t\t\t: operation.value + \" \" + column.value;\n\t}\n\n\tShowPopup(id, ev) {\n\t\tif (!this.Popup || !this.Popup.$view)\n\t\t\tthis.Popup = this.ui(new Popup(this.app, \"summary\"));\n\t\tconst form = webix.$$(id).getParentView();\n\t\tthis.ActiveForm = form;\n\t\tthis.Popup.Show(\n\t\t\tev.target,\n\t\t\tthis.GetData(),\n\t\t\tform.getParentView().index(form)\n\t\t);\n\t}\n\n\tApplyAction(id) {\n\t\tif (id == \"delete\") this.DeleteAggregation();\n\t}\n\n\tDeleteAggregation(form) {\n\t\tform = form || this.ActiveForm;\n\t\tconst formList = form.getParentView();\n\t\tif (formList.getChildViews().length > 1) formList.removeView(form);\n\t\telse form.setValues({});\n\t\tthis.Changed();\n\t}\n\n\tGetOperations() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"sum\", value: _(\"Sum\") },\n\t\t\t{ id: \"count\", value: _(\"Count\") },\n\t\t\t{ id: \"avg\", value: _(\"Average\") },\n\t\t\t{ id: \"max\", value: _(\"Max\") },\n\t\t\t{ id: \"min\", value: _(\"Min\") },\n\t\t];\n\t}\n\n\tGetData() {\n\t\tlet data = [];\n\t\tthis.ForEachFormRow(form => {\n\t\t\tdata.push(form.getValues());\n\t\t});\n\t\treturn data;\n\t}\n\n\tForEachFormRow(handler) {\n\t\tthis.$$(\"summaries\")\n\t\t\t.getChildViews()\n\t\t\t.forEach(form => {\n\t\t\t\tif (form && form.elements) {\n\t\t\t\t\thandler(form);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tValidateFormData() {\n\t\tlet valid = true;\n\t\tthis.ForEachFormRow(form => (valid = form.validate() && valid));\n\t\treturn valid;\n\t}\n\n\tChangeNewColumnName(formId) {\n\t\tconst form = this.$$(formId).elements;\n\t\tconst oId = form.op.getValue();\n\t\tconst cId = form.id.getValue();\n\t\tconst operations = this.GetOperations();\n\n\t\tif (oId) {\n\t\t\tif (oId == \"count\")\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(operations.find(o => o.id == oId))\n\t\t\t\t);\n\t\t\telse if (cId)\n\t\t\t\tform.name.setValue(\n\t\t\t\t\tthis.NewColumnTemplate(\n\t\t\t\t\t\toperations.find(o => o.id == oId),\n\t\t\t\t\t\tthis.SummaryColumns.find(c => c.id == cId)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t}\n\t}\n\n\tChanged(formId, name, value) {\n\t\tif (name == \"op\" || name == \"id\") this.ChangeNewColumnName(formId);\n\t\tif (name == \"op\" && value == \"count\") {\n\t\t\tthis.$$(formId).elements.id.setValue(null);\n\t\t\tthis.$$(formId).elements.id.disable();\n\t\t} else {\n\t\t\tif (formId && name) this.$$(formId).elements.id.enable();\n\t\t}\n\n\t\tthis.ValidateFormData();\n\t\tconst columns = this.GetData();\n\t\tcolumns.forEach(\n\t\t\ta =>\n\t\t\t\t(a.type = (\n\t\t\t\t\tthis.SummaryColumns.find(b => b.id == a.id) || { type: \"number\" }\n\t\t\t\t).type)\n\t\t);\n\t\tthis.GroupState.columns = columns;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState, ignoreInitial } from \"jet-restate\";\nimport Summaries from \"./summary\";\nimport \"../../../helpers/groupselect\";\nimport DatePopupView from \"./datepopup\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupBy = {\n\t\t\tmargin: 5,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\ttemplate: _(\"Specify columns to group by and output(s)\"),\n\t\t\t\t\tcss: \"webix_rpt_description\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"groupBy\",\n\t\t\t\t\tmodifiers: this.GetDateOptions(),\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeGroupBy(),\n\t\t\t\t\t\tonModifierClick: (id, e, node) =>\n\t\t\t\t\t\t\tthis.ShowModifierPopup(id, e, node),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\tpadding: 0,\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"groupByLayout\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\trows: [groupBy, Summaries],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst groupState = this.State.group || {};\n\t\tthis.GroupState = createState({\n\t\t\tby: groupState.by || null,\n\t\t\tcolumns: groupState.columns || null,\n\t\t});\n\n\t\tthis.LoadColumns();\n\n\t\tthis.setParam(\"group\", this.GroupState);\n\t\tthis.on(this.GroupState.$changes, \"*\", ignoreInitial(() => this.Apply()));\n\t}\n\n\tChangeGroupBy() {\n\t\tconst group = this.$$(\"groupBy\");\n\t\tconst list = group.getPopup().getList();\n\t\tlet arr = group.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tthis.GroupState.by = arr.map(a => {\n\t\t\tlet mod = group.getModifier(a);\n\t\t\tif (list.getItem(a).type === \"date\" && !mod) {\n\t\t\t\tmod = \"year\";\n\t\t\t\tgroup.setModifier(a, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id: a };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\t}\n\n\tFilterGroupByColumns(column) {\n\t\treturn column.id != \"id\";\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = this.State.fields.map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\t\tconst groupBy = this.$$(\"groupBy\");\n\t\tconst list = groupBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.parse(columns);\n\n\t\tthis.$$(\"groupBy\").setValue(this.GroupState.by);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tShowModifierPopup(id, e, node) {\n\t\tif (!this.DatePopup)\n\t\t\tthis.DatePopup = this.ui(new DatePopupView(this.app, this.$$(\"groupBy\")));\n\t\twebix.delay(() => this.DatePopup.Show(node, id));\n\t}\n\n\tGetDateOptions() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t{ id: \"yearmonth\", value: _(\"Year\") + \"/\" + _(\"Month\") },\n\t\t\t{\n\t\t\t\tid: \"yearmonthday\",\n\t\t\t\tvalue: _(\"Year\") + \"/\" + _(\"Month\") + \"/\" + _(\"Day\"),\n\t\t\t},\n\t\t];\n\t}\n\tApply() {\n\t\tconst s = this.GroupState;\n\t\tthis.State.group = {\n\t\t\tby: s.by || null,\n\t\t\tcolumns: s.columns || [],\n\t\t};\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst groupByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"groupBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleGroupBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Group\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst buckets = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"bucketsSwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleBuckets(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Data buckets\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst sortByMode = {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"switch\",\n\t\t\t\t\tlocalId: \"sortBySwitch\",\n\t\t\t\t\tcss: \"webix_rpt_title\",\n\t\t\t\t\twidth: 65,\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleSortBy(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Sort\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\trows: [\n\t\t\t\t\tgroupByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"group\" },\n\t\t\t\t\tbuckets,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"buckets\" },\n\t\t\t\t\tsortByMode,\n\t\t\t\t\t{ $subview: \"_hidden\", name: \"sort\" },\n\t\t\t\t\t{ gravity: 0.000001 },\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"groupBySwitch\").setValue(!!this.State.group);\n\t\tthis.$$(\"sortBySwitch\").setValue(!!this.State.sort);\n\t\tthis.$$(\"bucketsSwitch\").setValue(!!this.State.buckets);\n\t}\n\n\tToggleGroupBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.groups\", { target: \"group\" });\n\t\t} else {\n\t\t\tthis.State.group = null;\n\t\t\tthis.show(\"_hidden\", { target: \"group\" });\n\t\t}\n\t}\n\n\tToggleSortBy(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.sorts\", { target: \"sort\" });\n\t\t} else {\n\t\t\tthis.State.sort = null;\n\t\t\tthis.show(\"_hidden\", { target: \"sort\" });\n\t\t}\n\t}\n\tToggleBuckets(v) {\n\t\tif (v) {\n\t\t\tthis.show(\"./editor.other.buckets\", { target: \"buckets\" });\n\t\t} else {\n\t\t\tthis.State.buckets = null;\n\t\t\tthis.show(\"_hidden\", { target: \"buckets\" });\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { sortAsc, sortDesc } from \"helpers/icons\";\nimport \"../../../helpers/groupselect\";\n\nexport default class OtherSettingsView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst sortBy = {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: _(\"Specify columns to sort by\"),\n\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"groupselect\",\n\t\t\t\t\tlocalId: \"sortBy\",\n\t\t\t\t\tselectIcon: false,\n\t\t\t\t\tcss: \"webix_rpt_sort_selector\",\n\t\t\t\t\tmodifiers: [\n\t\t\t\t\t\t{ id: \"asc\", value: sortAsc },\n\t\t\t\t\t\t{ id: \"desc\", value: sortDesc },\n\t\t\t\t\t],\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: () => this.ChangeSortBy(),\n\t\t\t\t\t\tonModifierClick: id => this.ChangeDirection(id),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn sortBy;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.on(this.State.$changes, \"publicFields\", v => {\n\t\t\tif (v) this.LoadColumns();\n\t\t});\n\t\tthis.on(this.State.$changes, \"fields\", () => {\n\t\t\tif (!this.State.publicFields) this.LoadColumns();\n\t\t});\n\t}\n\n\tLoadColumns() {\n\t\tconst columns = (this.State.publicFields || this.State.fields).map(a => ({\n\t\t\tid: a.id,\n\t\t\tvalue: a.name,\n\t\t\ttype: a.type,\n\t\t\tmodel: a.model,\n\t\t}));\n\n\t\tconst sortBy = this.$$(\"sortBy\");\n\t\tconst list = sortBy.getPopup().getList();\n\t\tlist.type.template = obj => this.ListTemplate(obj);\n\t\tlist.clearAll();\n\t\tlist.parse(columns);\n\n\t\tlet sort = this.State.sort;\n\t\tif (sort) sort = sort.filter(a => !!columns.find(b => b.id == a.id));\n\t\tsortBy.setValue(sort);\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.value +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n\n\tChangeSortBy() {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tlet arr = ui.getValue();\n\t\tarr = arr ? (typeof arr === \"string\" ? arr.split(\",\") : arr) : [];\n\n\t\tconst state = arr.map(id => {\n\t\t\tlet mod = ui.getModifier(id);\n\t\t\tif (!mod) {\n\t\t\t\tmod = \"asc\";\n\t\t\t\tui.setModifier(id, mod, true);\n\t\t\t}\n\n\t\t\tconst obj = { id };\n\t\t\tif (mod) obj.mod = mod;\n\n\t\t\treturn obj;\n\t\t});\n\n\t\tthis.State.sort = state.length ? state : null;\n\t}\n\n\tChangeDirection(id) {\n\t\tconst ui = this.$$(\"sortBy\");\n\t\tui.setModifier(id, ui.getModifier(id) === \"asc\" ? \"desc\" : \"asc\");\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class AxisPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Axis = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabel: _(\"Logarithmic scale\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"logarithmic\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"title\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabelWidth: 190,\n\t\t\t\t\t\tlabel: _(\"Gridlines\"),\n\t\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\t\tname: \"lines\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tname: \"lineColor\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tlabel: _(\"Vertical labels\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"verticalLabels\",\n\t\t\t\thidden: true,\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabelWidth: 190,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.on(this.Axis.$changes, \"id\", id => {\n\t\t\tif (id == \"y\") this.ApplyYAxis();\n\t\t\telse this.ApplyXAxis();\n\t\t});\n\t\tthis.on(this.Axis.$changes, \"lines\", v => {\n\t\t\tconst lineColor = this.getRoot().elements[\"lineColor\"];\n\t\t\tif (v) lineColor.show();\n\t\t\telse lineColor.hide();\n\t\t});\n\t\tbind(this.Axis, \"*\", this.getRoot());\n\t}\n\n\tApplyYAxis() {\n\t\tthis.getRoot().elements[\"logarithmic\"].show();\n\t}\n\tApplyXAxis() {\n\t\tthis.getRoot().elements[\"verticalLabels\"].show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BaseStructureView extends JetView {\n\tHideField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: false });\n\t\tthis.SaveOrder();\n\t}\n\n\tShowField(id) {\n\t\tthis.$$(\"fields\").updateItem(id, { show: true });\n\t\tthis.SaveOrder();\n\t}\n\n\tHideAllEditors(id, name) {\n\t\tif (!name) name = \"fields\";\n\t\tif (this._ActiveEditor[name])\n\t\t\tthis.$$(name).closeSub(this._ActiveEditor[name]);\n\n\t\tthis._ActiveEditor[name] = id;\n\t\tif (id) {\n\t\t\twebix.delay(\n\t\t\t\t() => {\n\t\t\t\t\tconst subView = this.$$(name).getSubView(id);\n\t\t\t\t\tif (subView) subView.focus();\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\t100\n\t\t\t);\n\t\t}\n\t}\n\n\tResetEditor(name) {\n\t\tthis._ActiveEditor[name || \"fields\"] = null;\n\t}\n\n\tToggleSub(id, name) {\n\t\tconst table = this.$$(name || \"fields\");\n\t\tvar row = table.getItem(id);\n\t\tif (row.$subopen) table.closeSub(id);\n\t\telse table.openSub(id);\n\t}\n\n\tSaveOrder() {}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ColorPopupView extends JetView {\n\tconstructor(app, state) {\n\t\tsuper(app);\n\t\tthis.State = state;\n\t\tthis.Id = null;\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"colorselect\",\n\t\t\t\tbutton: true,\n\t\t\t\ton: {\n\t\t\t\t\tonColorSelect: color => {\n\t\t\t\t\t\tlet s = this.GetSeries(this.Id);\n\t\t\t\t\t\tif (s) s.meta.color = color;\n\t\t\t\t\t\tthis.State.updatedSeries = this.Id;\n\t\t\t\t\t\tthis.getRoot().close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tShow(node, id) {\n\t\tconst popup = this.getRoot();\n\t\tthis.Id = id;\n\t\tpopup.show(node);\n\t\tpopup.getBody().setValue(this.GetSeries(id).meta.color);\n\t}\n\n\tGetSeries(id) {\n\t\treturn this.State.series.find(s => s.id == id);\n\t}\n}\n","webix.protoUI(\n\t{\n\t\tname: \"text-search\",\n\t\t$cssName: \"search\",\n\t\tdefaults: {\n\t\t\tcloseIcon: \"wxi-close\",\n\t\t\ttemplate: function(obj, common) {\n\t\t\t\tvar text = common.$renderInput(obj);\n\t\t\t\tif (obj.badge || obj.badge === 0)\n\t\t\t\t\ttext = text.replace(\n\t\t\t\t\t\tnew RegExp(\"</div>$\"),\n\t\t\t\t\t\t\"<span class='webix_badge'>\" + obj.badge + \"</span></div>\"\n\t\t\t\t\t);\n\t\t\t\treturn text;\n\t\t\t},\n\t\t},\n\n\t\ton_click: {\n\t\t\twebix_input_icon: function(e) {\n\t\t\t\tconst css = e.target.className;\n\t\t\t\tthis.getInputNode().focus();\n\n\t\t\t\tif (css.indexOf(this.config.closeIcon) > -1) {\n\t\t\t\t\tthis.setValue(\"\");\n\t\t\t\t\tthis.callEvent(\"onCloseIconClick\", [e]);\n\t\t\t\t\tthis.hideCloseIcon();\n\t\t\t\t} else {\n\t\t\t\t\tthis.callEvent(\"onSearchIconClick\", [e]);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t$init() {\n\t\t\tthis.attachEvent(\"onTimedKeyPress\", () => this._onSearch());\n\t\t\tthis.attachEvent(\"onChange\", () => this._onSearch());\n\t\t},\n\t\t_onSearch() {\n\t\t\tconst v = this.getValue();\n\t\t\tif (v) this.showCloseIcon();\n\t\t\telse this.hideCloseIcon();\n\n\t\t\tthis.callEvent(\"onSearchChange\", [v]);\n\t\t},\n\t\tsetIcon(icon) {\n\t\t\tconst nodes = this.$view.getElementsByClassName(\"webix_input_icon\");\n\t\t\tif (nodes.length) nodes[0].className = \"webix_input_icon \" + icon;\n\t\t},\n\t\tshowCloseIcon() {\n\t\t\tthis.setIcon(this.config.closeIcon);\n\t\t},\n\t\thideCloseIcon() {\n\t\t\tthis.setIcon(this.config.icon);\n\t\t},\n\t\tsetBadge(value) {\n\t\t\tlet node = this.$view.querySelector(\".webix_badge\");\n\t\t\tif (value || value === 0) {\n\t\t\t\tif (!node) {\n\t\t\t\t\tnode = webix.html.create(\n\t\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t\t{ class: \"webix_badge\" },\n\t\t\t\t\t\t\"\" + value\n\t\t\t\t\t);\n\t\t\t\t\tthis.$view.querySelector(\".webix_el_box\").appendChild(node);\n\t\t\t\t} else node.innerHTML = \"\" + value;\n\t\t\t} else if (node) webix.html.remove(node);\n\t\t\tthis.config.badge = value;\n\t\t},\n\t},\n\twebix.ui.search\n);\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class SeriesPropertiesView extends JetView {\n\tconstructor(app, data, chartState) {\n\t\tsuper(app);\n\t\tthis.Series = data;\n\t\tthis.ChartState = chartState;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\tview: \"colorpicker\",\n\t\t\t\tname: \"color\",\n\t\t\t\tcss: \"webix_rpt_colorpicker\",\n\t\t\t\tsuggest: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\ttype: \"colorselect\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tbutton: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Marker type\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tcss: \"webix_rpt_markerselect\",\n\t\t\t\tname: \"markerType\",\n\t\t\t\toptions: {\n\t\t\t\t\tpadding: 0, //for Flat skins\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcss: \"webix_rpt_markerselect_list\",\n\t\t\t\t\t\ttemplate: item => this.ItemListTemplate(item),\n\t\t\t\t\t\tdata: this.Charts.getItemTypes(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Fill marker\"),\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"fillMarker\",\n\t\t\t\tbatch: \"marker\",\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 170,\n\t\t\t},\n\t\t\tvisibleBatch: \"default\",\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Series, \"*\", this.getRoot());\n\t\tif (this.Charts.itemSupport.indexOf(this.ChartState.chartType) > -1)\n\t\t\tthis.getRoot().showBatch(\"marker\");\n\n\t\tthis.on(this.Series.$changes, \"color\", () => {\n\t\t\tconst markerType = this.getRoot().elements[\"markerType\"];\n\t\t\tmarkerType.refresh();\n\t\t\tmarkerType.getList().refresh();\n\t\t});\n\t}\n\n\tItemListTemplate(item) {\n\t\treturn `<div class=\"webix_rpt_config_row\">${item.value} <span class='webix_icon ${item.icon}' style='color:${this.Series.color}'></span></div>`;\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\nimport ColorPopup from \"./colorpopup\";\nimport BaseView from \"./baseview\";\nimport \"../../../helpers/rsearch\";\nimport SeriesProperties from \"./chartseries\";\nimport AxisProperties from \"./axis\";\n//import LegendProperties from \"./legend\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis.Charts = this.app.getService(\"charts\");\n\t\tthis.Local = this.app.getService(\"local\");\n\t\tthis._ActiveEditor = {};\n\t\tconst type = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: this._(\"Chart type\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"type\",\n\t\t\t\t\toptions: this.Charts.getTypes(),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => (this.ChartState.chartType = v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"X axis column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlocalId: \"labelColumn\",\n\t\t\t\t\toptions: [],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLabelField(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueFields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\teditable: true,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tif (!this.SubState) this.SubState = {};\n\t\t\t\tconst series = (this.SubState[obj.id] = createState({\n\t\t\t\t\tname: obj.meta.name,\n\t\t\t\t\tcolor: obj.meta.color,\n\t\t\t\t\ttype: obj.meta.type || null,\n\t\t\t\t\tmarkerType: obj.meta.markerType || null,\n\t\t\t\t\tfillMarker: obj.meta.fillMarker || null,\n\t\t\t\t}));\n\t\t\t\tthis.on(\n\t\t\t\t\tseries.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.UpdateSeries(obj.id, series);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new SeriesProperties(this.app, series, this.ChartState);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tthis.openSub(id);\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => this.SaveOrder(),\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\t\"data->onClearAll\": () => this.ResetEditor(),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_chart_color: (e, id) => this.ShowColorPopup(e, id),\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\t\tconst axisFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Axes\") },\n\n\t\t\t\t{\n\t\t\t\t\tview: \"datatable\",\n\t\t\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\t\t\tlocalId: \"axisFields\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\theader: false,\n\t\t\t\t\tselect: false,\n\t\t\t\t\tsubview: (obj, target) => {\n\t\t\t\t\t\tconst axis = createState({ id: obj.id, ...obj.meta });\n\t\t\t\t\t\tthis.on(\n\t\t\t\t\t\t\taxis.$changes,\n\t\t\t\t\t\t\t\"*\",\n\t\t\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\t\t\tthis.UpdateAxis(obj.id, axis);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst sub = new AxisProperties(this.app, axis, this.ChartState);\n\t\t\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\t\t\treturn sub.getRoot();\n\t\t\t\t\t},\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t\ttemplate: (item, common) => this.AxisRowTemplate(item, common),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: id => this.ToggleSub(id, \"axisFields\"),\n\t\t\t\t\t\tonAfterRender: () => {\n\t\t\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tel &&\n\t\t\t\t\t\t\t\t\tdocument.contains(el) &&\n\t\t\t\t\t\t\t\t\tel !== document.activeElement\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id, \"axisFields\"),\n\t\t\t\t\t\tonSubViewClose: () => this.ResetEditor(\"axisFields\"),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst legendFields = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Legend\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"radio\",\n\t\t\t\t\tlocalId: \"legendPosition\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"bottom\", value: _(\"Bottom\") },\n\t\t\t\t\t\t{ id: \"right\", value: _(\"Right\") },\n\t\t\t\t\t\t{ id: \"none\", value: _(\"None\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeLegend(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tcss: \"webix_rpt_chart_config\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\ttype,\n\t\t\t\tlabelField,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"dataInputs\",\n\t\t\t\t\trows: this.GetDataInputs(),\n\t\t\t\t},\n\t\t\t\tvalueFields,\n\t\t\t\taxisFields,\n\t\t\t\tlegendFields,\n\t\t\t\t{},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Types = this.Charts.getTypes();\n\n\t\tlet fields = [];\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tfields.push({ ...a });\n\t\t});\n\n\t\t// options with all fields\n\t\tthis.Fields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn !field.key;\n\t\t\t})\n\t\t\t.sort((a, b) => (a.type < b.type ? 1 : -1))\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type }));\n\n\t\t// Options with numeric fields\n\t\tthis.ValueFields = fields\n\t\t\t.filter(field => {\n\t\t\t\treturn field.type == \"number\" && !field.key;\n\t\t\t})\n\t\t\t.map(a => ({ id: a.id, value: a.name, type: a.type, model: a.model }));\n\n\t\tthis.ChartState = createState(this.GetInitState());\n\n\t\tthis.on(this.ChartState.$changes, \"*\", () => {\n\t\t\tthis.UpdateModuleState();\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"chartType\", (type, prev) => {\n\t\t\tthis.ApplyChartType(type, prev);\n\t\t});\n\t\tthis.on(this.ChartState.$changes, \"seriesFrom\", (value, prev) => {\n\t\t\tthis.ApplySeriesFrom(value, prev);\n\t\t});\n\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"baseColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\t\tthis.on(\n\t\t\tthis.ChartState.$changes,\n\t\t\t\"dataColumn\",\n\t\t\tignoreInitial(() => {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t})\n\t\t);\n\n\t\tthis.on(this.ChartState.$changes, \"updatedSeries\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.$$(\"fields\").refresh(v);\n\t\t\t\tif (this.SubState && this.SubState[v])\n\t\t\t\t\tthis.SubState[v].color = this.ChartState.series.find(\n\t\t\t\t\t\ts => s.id == v\n\t\t\t\t\t).meta.color;\n\t\t\t\tthis.ChartState.updatedSeries = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.$$(\"type\").setValue(this.ChartState.chartType);\n\n\t\tthis.$$(\"labelColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"labelColumn\").setValue(this.ChartState.labelColumn);\n\n\t\tthis.$$(\"seriesFrom\").setValue(this.ChartState.seriesFrom);\n\n\t\tthis.$$(\"baseColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.Fields);\n\t\tthis.$$(\"baseColumn\").setValue(this.ChartState.baseColumn);\n\n\t\tthis.$$(\"dataColumn\")\n\t\t\t.getList()\n\t\t\t.parse(this.ValueFields);\n\t\tthis.$$(\"dataColumn\").setValue(this.ChartState.dataColumn);\n\n\t\tthis.$$(\"legendPosition\").setValue(this.ChartState.legendPosition);\n\t}\n\n\tChangeLabelField(label) {\n\t\tthis.ChartState.labelColumn = label;\n\t}\n\tChangeLegend(v) {\n\t\tthis.ChartState.legendPosition = v;\n\t}\n\n\tGetInitState() {\n\t\tconst meta = this.State.meta.chart || {};\n\t\treturn {\n\t\t\tchartType: meta.chartType || this.Charts.type,\n\t\t\tlabelColumn: meta.labelColumn || null,\n\t\t\tupdatedSeries: null,\n\t\t\tseriesFrom: meta.seriesFrom || \"columns\",\n\t\t\tbaseColumn: meta.baseColumn || null,\n\t\t\tdataColumn: meta.dataColumn || null,\n\t\t\tseries: meta.series || null,\n\t\t\tlegend: meta.legend || { layout: \"x\" },\n\t\t\taxises: meta.axises || null,\n\t\t\tlegendPosition: meta.legendPosition || \"bottom\",\n\t\t};\n\t}\n\n\t/*\n\t * Called when chart type changed.\n\t * */\n\tApplyChartType(type, prevType) {\n\t\tthis.ShowAxisInputs(type);\n\t\tthis.RenderSeries(prevType);\n\t}\n\n\t/*\n\t * Renders chart series. Loads init state values\n\t * or generates new series depending on selected type\n\t * */\n\tRenderSeries(prevType) {\n\t\tconst series = this.ChartState.series;\n\t\tif (series && typeof prevType == \"undefined\") this.LoadSeries(series);\n\t\telse this.GenerateSeries();\n\t}\n\n\t// Loads axis data\n\tShowAxisInputs(type) {\n\t\tconst isAxises = this.Charts.noAxisSupport.indexOf(type);\n\t\tif (isAxises) {\n\t\t\tif (!this.ChartState.axises) {\n\t\t\t\tthis.ChartState.axises = {\n\t\t\t\t\tx: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tverticalLabels: true,\n\t\t\t\t\t},\n\t\t\t\t\ty: {\n\t\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t\tcolor: \"#edeff0\",\n\t\t\t\t\t\tlineColor: \"#edeff0\",\n\t\t\t\t\t\tlines: true,\n\t\t\t\t\t\tlogarithmic: false,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (!this.$$(\"axisFields\").data.count())\n\t\t\t\tthis.$$(\"axisFields\").parse([\n\t\t\t\t\t{ id: \"x\", meta: { ...this.ChartState.axises.x } },\n\t\t\t\t\t{ id: \"y\", meta: { ...this.ChartState.axises.y } },\n\t\t\t\t]);\n\t\t} else {\n\t\t\tthis.ChartState.axises = null;\n\t\t\tthis.$$(\"axisFields\").clearAll();\n\t\t}\n\t}\n\tGetDataInputs() {\n\t\treturn [\n\t\t\t{\n\t\t\t\trows: [\n\t\t\t\t\t{ view: \"label\", label: this._(\"Data series\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Extract series from\"),\n\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\t\t\t\t\tlocalId: \"seriesFrom\",\n\t\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"columns\", value: this._(\"columns\") },\n\t\t\t\t\t\t\t\t\t\t\t{ id: \"rows\", value: this._(\"rows\") },\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.seriesFrom = v),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\tlocalId: \"baseColumnLayout\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Keys column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"baseColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition: \"top\",\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.baseColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: this._(\"Values column\"),\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\t\t\t\tcss: \"webix_rpdataColumnt_subtitle\",\n\t\t\t\t\t\t\t\t\t\t\t\tlocalId: \"dataColumn\",\n\t\t\t\t\t\t\t\t\t\t\t\toptions: [],\n\t\t\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange: v => (this.ChartState.dataColumn = v),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\t}\n\n\t/*\n\t * Generates series and loads these data\n\t * params:\n\t * - an array of fields/ keys options\n\t * */\n\tApplySeriesKeys(sourceArray) {\n\t\tconst data = this.Charts.getSeries(sourceArray, this.ChartState.type);\n\t\tthis.ChartState.series = data;\n\t\tthis.LoadSeries(data);\n\t}\n\n\tLoadSeries(data) {\n\t\tif (!data.length) this.$$(\"fields\").hide();\n\t\telse this.$$(\"fields\").show();\n\n\t\tthis.$$(\"fields\").clearAll();\n\t\tthis.$$(\"fields\").parse(data);\n\t}\n\t/*\n\t * Gets row keys (requires data loading)\n\t * params:\n\t * - the field / column id where keys need to be found\n\t * Returns a promise\n\t * */\n\tGetRowKeys(base) {\n\t\tif (base && this.State.columns.length) {\n\t\t\tlet keys = [];\n\t\t\treturn this.GetData(base).then(([data, baseOptions]) => {\n\t\t\t\tdata.forEach(row => {\n\t\t\t\t\tconst key = row[base];\n\t\t\t\t\tif (keys.indexOf(key) == -1) keys.push(key);\n\t\t\t\t});\n\n\t\t\t\tif (baseOptions)\n\t\t\t\t\treturn keys.map(key => {\n\t\t\t\t\t\tconst keyOption =\n\t\t\t\t\t\t\tbaseOptions.data.find(option => option.id == key) || null;\n\t\t\t\t\t\treturn { id: key, value: keyOption ? keyOption.value : key };\n\t\t\t\t\t});\n\t\t\t\treturn keys.map(key => ({ id: key, value: key }));\n\t\t\t});\n\t\t} else return Promise.resolve([]);\n\t}\n\n\tGenerateSeries() {\n\t\tconst from = this.ChartState.seriesFrom;\n\t\tif (from == \"columns\") this.ApplySeriesKeys([...this.ValueFields], null);\n\t\telse {\n\t\t\tthis.ChartState.dataColumn = this.$$(\"dataColumn\").getValue();\n\t\t\tconst base = (this.ChartState.baseColumn = this.$$(\n\t\t\t\t\"baseColumn\"\n\t\t\t).getValue());\n\t\t\tthis.GetRowKeys(base).then(arr => this.ApplySeriesKeys(arr, base));\n\t\t}\n\t}\n\n\tApplySeriesFrom(v, prevValue) {\n\t\tif (this.$$(\"baseColumnLayout\")) {\n\t\t\tif (v == \"columns\") {\n\t\t\t\tthis.$$(\"baseColumnLayout\").hide();\n\t\t\t\tthis.$$(\"baseColumn\").setValue(null);\n\t\t\t} else this.$$(\"baseColumnLayout\").show();\n\t\t\tif (prevValue) {\n\t\t\t\tthis.GenerateSeries();\n\t\t\t}\n\t\t}\n\t}\n\n\tUpdateSeries(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst series = [...this.ChartState.series];\n\t\tconst ind = series.findIndex(a => a.id == id);\n\t\tObject.assign(series[ind].meta, update);\n\t\tthis.ChartState.series = series;\n\t\tthis.$$(\"fields\").refresh(id);\n\t}\n\n\tUpdateAxis(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tlet axises = { ...this.ChartState.axises };\n\t\tObject.assign(axises[id], update);\n\t\tthis.ChartState.axises = axises;\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\t\"<span class='webix_icon \" +\n\t\t\t(item.show\n\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\"'></span>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_chart_color' style='background:\" +\n\t\t\titem.meta.color +\n\t\t\t\"'> </div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n\n\tGetData(baseColumn) {\n\t\tconst appState = this.app.getParam(\"state\");\n\t\tlet moduleConfig = this.Local.getDataConfig(appState.module);\n\t\tmoduleConfig.columns = this.State.columns.map(c => c.id);\n\t\tlet waitData = [this.Local.getData(moduleConfig)];\n\t\tif (baseColumn) waitData.push(this.Local.getOptionsList(baseColumn));\n\t\treturn Promise.all(waitData);\n\t}\n\n\tShowColorPopup(e, id) {\n\t\tif (!this.ColorPopup || !this.ColorPopup.$view)\n\t\t\tthis.ColorPopup = this.ui(new ColorPopup(this.app, this.ChartState));\n\t\tthis.ActiveSeries = id;\n\t\tthis.ColorPopup.Show(e.target, id);\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\t\tthis.ChartState.series = table.serialize();\n\t}\n\n\tUpdateModuleState() {\n\t\tconst state = this.ChartState;\n\t\tconst columns = [];\n\n\t\tif (state.labelColumn) this.AddColumn(columns, state.labelColumn);\n\t\tif (state.seriesFrom == \"columns\") {\n\t\t\tif (state.series)\n\t\t\t\tstate.series.forEach(a => {\n\t\t\t\t\tif (a.show) this.AddColumn(columns, a.id);\n\t\t\t\t});\n\t\t} else {\n\t\t\tif (state.baseColumn) this.AddColumn(columns, state.baseColumn);\n\t\t\tif (state.dataColumn) this.AddColumn(columns, state.dataColumn);\n\t\t}\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, chart: this.ChartState },\n\t\t});\n\t}\n\n\tAddColumn(columns, id) {\n\t\tconst col = (this.State.publicFields || this.State.fields).find(\n\t\t\tb => b.id === id\n\t\t);\n\t\tif (col) columns.push(col);\n\t}\n\n\tAxisRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'>\" +\n\t\t\tthis._(item.id == \"x\" ? \"X Axis\" : \"Y Axis\");\n\t\thtml += common.subrow(item, common);\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { bind } from \"jet-restate-bind\";\n\nexport default class ColumnPropertiesView extends JetView {\n\tconstructor(app, data) {\n\t\tsuper(app);\n\t\tthis.Column = data;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst inputs = [\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Title\"),\n\t\t\t\tview: \"text\",\n\t\t\t\tname: \"name\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabelAlign: \"right\",\n\t\t\t\tlabel: _(\"Filter\"),\n\t\t\t\tview: \"richselect\",\n\t\t\t\tname: \"header\",\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: \"none\", value: _(\"No filter\") },\n\t\t\t\t\t{ id: \"text\", value: _(\"Text\") },\n\t\t\t\t\t{ id: \"select\", value: _(\"Select\") },\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tborderless: true,\n\t\t\telementsConfig: {\n\t\t\t\tlabelWidth: 120,\n\t\t\t},\n\t\t\trows: inputs,\n\t\t};\n\t}\n\n\tinit() {\n\t\tbind(this.Column, \"*\", this.getRoot());\n\t}\n}\n","import BaseView from \"./baseview\";\n\nexport default class ChartView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\n\t\tconst labelField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Labels column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"label\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst valueField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Values column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"value\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst colorField = {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Color column\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\toptions: [],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: false,\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [valueField, labelField, colorField, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\n\t\tlet fields = (this.Fields = (\n\t\t\tthis.State.publicFields || this.State.fields\n\t\t).map(a => ({\n\t\t\t...a,\n\t\t})));\n\t\tlet valueFields = fields.filter(\n\t\t\tfield => field.type == \"number\" && !field.key\n\t\t);\n\t\tif (!valueFields.length)\n\t\t\tvalueFields = fields.filter(field => field.type == \"number\");\n\t\tconst els = this.getRoot().elements;\n\n\t\tconst lc = els.label;\n\t\tlc.getList().parse(fields);\n\t\tlc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tlc.setValue(this.State.meta.label || fields[0].id);\n\n\t\tconst vc = els.value;\n\t\tvc.getList().parse(valueFields);\n\t\tvc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tvc.setValue(this.State.meta.value || valueFields[0].id);\n\n\t\tconst cc = els.color;\n\t\tcc.getList().parse(valueFields);\n\t\tcc.getList().type.template = obj => this.ListTemplate(obj);\n\t\tcc.setValue(this.State.meta.color || valueFields[0].id);\n\n\t\tthis.getRoot().attachEvent(\"onChange\", () => this.OnChange());\n\t\tif (!this.State.meta.value) this.OnChange();\n\t}\n\n\tOnChange() {\n\t\tthis.Apply({ ...this.State.meta, ...this.getRoot().getValues() });\n\t}\n\n\tApply(meta) {\n\t\tconst check = [meta.value, meta.label, meta.color];\n\t\tconst columns = this.Fields.filter(a => check.indexOf(a.id) !== -1);\n\n\t\tthis.State.$batch({\n\t\t\tmeta,\n\t\t\tcolumns,\n\t\t});\n\t}\n\n\tListTemplate(obj) {\n\t\treturn (\n\t\t\tobj.name +\n\t\t\t(obj.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + obj.model + \"</span>\"\n\t\t\t\t: \"\")\n\t\t);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { types } from \"../../../helpers/icons\";\n\nexport default class StructureView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst tabbar = {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"select\",\n\t\t\tborderless: true,\n\t\t\talign: \"left\",\n\t\t\tinputWidth: 170,\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tid: \"table\",\n\t\t\t\t\tvalue: types.table + \" \" + _(\"Table\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"chart\",\n\t\t\t\t\tvalue: types.chart + \" \" + _(\"Chart\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"heatmap\",\n\t\t\t\t\tvalue: types.heatmap + \" \" + _(\"Heatmap\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: v => this.ChangeReportType(v),\n\t\t\t},\n\t\t};\n\n\t\tconst toolbar = {\n\t\t\tview: \"form\",\n\t\t\tpadding: {\n\t\t\t\tleft: webix.skin.$active.layoutPadding.form,\n\t\t\t\ttop: 5,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tcols: [tabbar],\n\t\t};\n\n\t\tconst ui = {\n\t\t\twidth: 480,\n\t\t\thidden: false,\n\t\t\tlocalId: \"settings\",\n\t\t\ttype: \"clean\",\n\n\t\t\trows: [toolbar, { $subview: true }],\n\t\t};\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tthis.on(this.State.$changes, \"type\", v => {\n\t\t\tthis.show(\"editor.structure.\" + v);\n\t\t});\n\t\tthis.$$(\"select\").setValue(this.State.type);\n\t}\n\n\tChangeReportType(type) {\n\t\tif (this.State.type != type) this.State.$batch({ type, meta: {} });\n\t}\n}\n","import { createState, ignoreInitial } from \"jet-restate\";\n\nimport ColumnProperties from \"./column\";\n\nimport \"../../../helpers/rsearch\";\nimport BaseView from \"./baseview\";\n\nexport default class ColumnsView extends BaseView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tthis._ActiveEditor = {};\n\t\tconst header = {\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"Columns\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonSearchChange: () => this.FilterFields(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst fields = {\n\t\t\tview: \"datatable\",\n\t\t\tcss: \"webix_rpt_columns_list\",\n\t\t\tlocalId: \"fields\",\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\theader: false,\n\t\t\tselect: false,\n\t\t\tsubview: (obj, target) => {\n\t\t\t\tconst column = createState({\n\t\t\t\t\tname: obj.meta.name || obj.name,\n\t\t\t\t\theader: obj.meta.header || \"none\",\n\t\t\t\t});\n\t\t\t\tthis.on(\n\t\t\t\t\tcolumn.$changes,\n\t\t\t\t\t\"*\",\n\t\t\t\t\tignoreInitial(() => {\n\t\t\t\t\t\tthis.Update(obj.id, column);\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tconst sub = new ColumnProperties(this.app, column);\n\t\t\t\tthis.ui(sub, { container: target });\n\t\t\t\treturn sub.getRoot();\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{\n\t\t\t\t\tfillspace: true,\n\t\t\t\t\ttemplate: (item, common) => this.RowTemplate(item, common),\n\t\t\t\t},\n\t\t\t],\n\t\t\tdrag: \"order\",\n\t\t\ton: {\n\t\t\t\tonItemDblClick: function(id) {\n\t\t\t\t\tif (id.row !== \"$freeze\") this.openSub(id);\n\t\t\t\t},\n\t\t\t\tonBeforeDrag: ctx => {\n\t\t\t\t\tthis.HideAllEditors();\n\t\t\t\t\tconst list = this.$$(\"fields\");\n\t\t\t\t\twebix.html.addCss(list.$view, \"webix_rpt_drag\");\n\n\t\t\t\t\tif (ctx.start === \"$freeze\") {\n\t\t\t\t\t\tctx.html = `<div class=\"webix_drag_zone\"><div class=\"webix_dd_drag wbx-mark_frozen\" style=\"width:${\n\t\t\t\t\t\t\tlist.$width\n\t\t\t\t\t\t}px;\"><div>${this.FrozenTemplate()}</div></div></div>`;\n\t\t\t\t\t} else if (!list.getItem(ctx.start).show) return false;\n\t\t\t\t},\n\t\t\t\tonAfterRender: () => {\n\t\t\t\t\tif (this._hasFocus) {\n\t\t\t\t\t\tconst el = this._hasFocus;\n\t\t\t\t\t\tthis._hasFocus = null;\n\n\t\t\t\t\t\tif (el && document.contains(el) && el !== document.activeElement)\n\t\t\t\t\t\t\tel.focus();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonAfterDrop: () => {\n\t\t\t\t\twebix.html.removeCss(this.$$(\"fields\").$view, \"webix_rpt_drag\");\n\t\t\t\t\tthis.SaveOrder();\n\t\t\t\t},\n\t\t\t\tonSubViewOpen: id => this.HideAllEditors(id),\n\t\t\t\tonSubViewClose: () => this.ResetEditor(),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\t\"action-visible\": (e, id) => this.HideField(id),\n\t\t\t\t\"action-hidden\": (e, id) => this.ShowField(id),\n\t\t\t\twebix_rpt_config_row_name: (e, id) => this.ToggleSub(id),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tscroll: \"auto\",\n\t\t\tpadding: { top: webix.skin.$active.layoutPadding.toolbar },\n\t\t\trows: [header, fields],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\n\t\tconst table = this.$$(\"fields\");\n\t\tconst has = {};\n\t\tconst columns = this.State.columns.map(a => {\n\t\t\thas[a.id] = 1;\n\t\t\treturn { ...a, show: true };\n\t\t});\n\n\t\t(this.State.publicFields || this.State.fields).forEach(a => {\n\t\t\tif (!has[a.id]) columns.push({ ...a, show: false });\n\t\t});\n\n\t\tcolumns.splice(this.State.meta.freeze || 0, 0, {\n\t\t\tid: \"$freeze\",\n\t\t\t$css: \"wbx-mark_frozen\",\n\t\t\tname: this.FrozenTemplate(),\n\t\t});\n\t\ttable.parse(columns);\n\t}\n\n\tFilterFields() {\n\t\tconst f = this.$$(\"search\")\n\t\t\t.getValue()\n\t\t\t.toLowerCase();\n\t\tthis.$$(\"fields\").filter(a => a.name.toLowerCase().indexOf(f) !== -1);\n\t}\n\n\tUpdate(id, update) {\n\t\tthis._hasFocus = document.activeElement;\n\t\tconst columns = [...this.State.columns];\n\t\tconst ind = columns.findIndex(a => a.id == id);\n\t\tObject.assign(columns[ind].meta, update);\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tGetFreeze() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst order = table.data.order;\n\n\t\tlet freezeColumn = 0;\n\t\tfor (var i = 0; i < order.length; i++) {\n\t\t\tif (order[i] === \"$freeze\") break;\n\t\t\tfreezeColumn += table.getItem(order[i]).show ? 1 : 0;\n\t\t}\n\n\t\treturn freezeColumn;\n\t}\n\n\tSaveOrder() {\n\t\tconst table = this.$$(\"fields\");\n\t\tconst columns = [];\n\t\ttable.data.each(a => {\n\t\t\tif (a.show)\n\t\t\t\tcolumns.push(\n\t\t\t\t\t(this.State.publicFields || this.State.fields).find(\n\t\t\t\t\t\tb => b.id === a.id\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t});\n\n\t\tthis.State.$batch({\n\t\t\tcolumns,\n\t\t\tmeta: { ...this.State.meta, freeze: this.GetFreeze() },\n\t\t});\n\t}\n\n\tFrozenTemplate() {\n\t\treturn (\n\t\t\t\"<span class='webix_rpt_frozen webix_icon rpi-arrow-horizontal-lock'></span><span>\" +\n\t\t\tthis._(\"Frozen columns above\") +\n\t\t\t\"</span>\"\n\t\t);\n\t}\n\n\tRowTemplate(item, common) {\n\t\tlet html =\n\t\t\t\"<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>\";\n\t\thtml +=\n\t\t\titem.id !== \"$freeze\"\n\t\t\t\t? \"<span class='webix_icon \" +\n\t\t\t\t  (item.show\n\t\t\t\t\t\t? \"action-visible rpi-eye\"\n\t\t\t\t\t\t: \"action-hidden rpi-eye-off-outline\") +\n\t\t\t\t  \"'></span>\"\n\t\t\t\t: \"\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_config_row_name'>\" +\n\t\t\titem.name +\n\t\t\t(item.model\n\t\t\t\t? \"<span class='webix_rpt_sources_path'>\" + item.model + \"</span>\"\n\t\t\t\t: \"\") +\n\t\t\t\"</div>\";\n\t\thtml += item.id !== \"$freeze\" ? common.subrow(item, common) : \"\";\n\t\treturn html + \"</div>\";\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { empty } from \"../helpers/icons\";\n\nexport default class EmptyView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tcss: \"webix_rpt_empty\",\n\t\t\tview: \"template\",\n\t\t\tborderless: true,\n\t\t\ttemplate: value => this.GetTemplate(value),\n\t\t};\n\t}\n\tinit() {\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tmods.waitData.then(() => {\n\t\t\tconst text = this.GetText(mods.data.count());\n\t\t\tthis.getRoot().setValues({ text });\n\t\t});\n\t}\n\tGetText(count) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn count\n\t\t\t? _(\"Select any report from the list\")\n\t\t\t: _(\"Click 'New' button to add a new report\");\n\t}\n\tGetSVG() {\n\t\tconst skin = webix.skin.$name;\n\t\tconst icon = skin == \"willow\" || skin == \"dark\" ? \"alt\" : \"main\";\n\t\treturn empty[icon];\n\t}\n\tGetTemplate(value) {\n\t\tconst text =\n\t\t\t\"<div class='webix_rpt_empty_placeholder'>\" +\n\t\t\t(value.text || \"\") +\n\t\t\t\"</div>\";\n\t\treturn text + this.GetSVG();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport Toolbar from \"./common/toolbar\";\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.meta.value && mod.type === \"heatmap\") {\n\t\t\tconst config = this.GetChartConfig(mod);\n\t\t\tif (!config.view) return;\n\t\t\tthis.Bar.show();\n\t\t\tthis.GetChartData(mod).then(([data, options]) => {\n\t\t\t\tconfig.data = this.FormatLabels(webix.copy(data), options);\n\t\t\t\tif (data.length && mod.meta.color)\n\t\t\t\t\tconfig.type.cssClass = this.CssFactory(data, mod.meta.color);\n\n\t\t\t\twebix.ui([config], host);\n\t\t\t\tthis.Chart = host.getChildViews()[0];\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{ template: \" \" }], host);\n\t\t\tthis.Bar.hide();\n\t\t\tthis.Chart = null;\n\t\t}\n\t}\n\n\tGetChartConfig(mod) {\n\t\tconst { meta, columns } = mod;\n\n\t\tconst obj = {\n\t\t\tview: \"treemap\",\n\t\t\tcss: \"webix_rpt\",\n\t\t\tvalue: obj => obj[meta.value],\n\t\t\ttooltip: this.TooltipFactory(meta, columns),\n\t\t\ttype: {},\n\t\t};\n\n\t\tif (meta.label) obj.type.template = obj => obj[meta.label];\n\n\t\treturn obj;\n\t}\n\n\tGetChartData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tCssFactory(data, prop) {\n\t\tvar min = Infinity;\n\t\tvar max = -Infinity;\n\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tconst v = data[i][prop];\n\t\t\tif (v > max) max = v * 1;\n\t\t\tif (v < min) min = v * 1;\n\t\t}\n\n\t\tconst step = (max - min) / 4;\n\t\tconst bases = [max - step, max - step * 2, max - step * 3, min];\n\n\t\treturn function(obj) {\n\t\t\tconst v = obj[prop];\n\t\t\tfor (var i = 0; i < bases.length; i++) if (v >= bases[i]) return \"l\" + i;\n\t\t};\n\t}\n\n\tTooltipFactory(obj, columns) {\n\t\tconst valueColumn = columns.find(a => a.id === obj.value);\n\t\tconst colorColumn = columns.find(a => a.id === obj.color);\n\t\tif (!valueColumn || !colorColumn) return \"\";\n\t\tconst props = [obj.value, valueColumn.name];\n\t\tif (obj.color && obj.color != obj.value)\n\t\t\tprops.push(obj.color, colorColumn.name);\n\n\t\treturn function(obj) {\n\t\t\tlet out = \"\";\n\t\t\tfor (let i = 0; i < props.length; i += 2) {\n\t\t\t\tout += (i ? \", \" : \"\") + props[i + 1] + \": \" + obj[props[i]];\n\t\t\t}\n\n\t\t\treturn out;\n\t\t};\n\t}\n\t/**\n\t * Exports chart to png image or PDF\n\t * @param {String} mode - export mode ( \"png\" or PDF \"table\"/\"image\"/\"all\"),\n\t */\n\tExport(mode) {\n\t\tif (this.Chart) {\n\t\t\tif (mode == \"png\") webix.toPNG(this.Chart);\n\t\t\telse if (mode == \"pdf\") {\n\t\t\t\tlet params = { autowidth: true, display: \"image\" };\n\t\t\t\twebix.toPDF(this.Chart, params);\n\t\t\t}\n\t\t}\n\t}\n\tFormatLabels(data, options) {\n\t\tconst labelColumn = this.State.module.meta.label;\n\t\tconst labelOptions =\n\t\t\tlabelColumn && options.length\n\t\t\t\t? options.find(op => op.field == labelColumn)\n\t\t\t\t: null;\n\n\t\tif (labelOptions)\n\t\t\tdata.forEach(item => {\n\t\t\t\tconst option = labelOptions.data.find(o => o.id == item[labelColumn]);\n\t\t\t\titem[labelColumn] = option ? option.value : item[labelColumn];\n\t\t\t});\n\t\telse {\n\t\t\tconst field = this.State.module.fields.find(\n\t\t\t\tfield => field.id == labelColumn\n\t\t\t);\n\t\t\tif (field && field.type == \"date\") {\n\t\t\t\tdata.forEach(item => {\n\t\t\t\t\titem[labelColumn] = webix.i18n.dateFormatStr(\n\t\t\t\t\t\tnew Date(item[labelColumn])\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MenuPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tpadding: 0,\n\t\t\tpoint: false,\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tborderless: true,\n\t\t\t\tcss: \"webix_rpt_popup_menu\",\n\t\t\t\ttemplate: obj =>\n\t\t\t\t\t`<span class='webix_icon ${obj.icon}'></span>${obj.value}`,\n\t\t\t\twidth: 160,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Edit\"),\n\t\t\t\t\t\tid: \"edit\",\n\t\t\t\t\t\ticon: \"rpi-square-edit-outline\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Create copy\"),\n\t\t\t\t\t\tid: \"copy\",\n\t\t\t\t\t\ticon: \"rpi-content-copy\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\t\t\tid: \"delete\",\n\t\t\t\t\t\ticon: \"rpi-delete\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: id => {\n\t\t\t\t\t\tthis.app.callEvent(\"onMenuAction\", [this.ID, id]);\n\t\t\t\t\t\tthis.getRoot().hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\tinit() {}\n\n\tShow(trg, id) {\n\t\tthis.ID = id;\n\t\twebix.delay(() => {\n\t\t\tif (this.getRoot()) this.getRoot().show(trg);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../helpers/rsearch\";\nimport MenuPopup from \"./menu\";\nimport { types } from \"../helpers/icons\";\n\nexport default class GridsView extends JetView {\n\tconfig() {\n\t\tconst _ = (this._ = this.app.getService(\"locale\")._);\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\tpadding: { left: 10, right: 10, top: 5, bottom: 5 },\n\t\t\tmargin: 0,\n\t\t\tlocalId: \"bar\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"Reports\") },\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"nameSorting\",\n\t\t\t\t\ticon: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon webix_rpt_btn_active\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-alphabetical-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-alphabetical-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"name\"),\n\t\t\t\t},\n\t\t\t\t{ width: 4 },\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\tlocalId: \"updatedSorting\",\n\t\t\t\t\tcss: \"webix_rpt_sort_icon\",\n\t\t\t\t\ticon: \"rpi-sort-calendar-descending\",\n\t\t\t\t\ticons: {\n\t\t\t\t\t\tasc: \"rpi-sort-calendar-ascending\",\n\t\t\t\t\t\tdesc: \"rpi-sort-calendar-descending\",\n\t\t\t\t\t},\n\t\t\t\t\tclick: () => this.Sort(\"updated\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst menu = {\n\t\t\tview: \"form\",\n\t\t\tpadding: { left: 10, right: 10, top: 2, bottom: 4 },\n\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tconst table = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"list\",\n\t\t\tscroll: true,\n\t\t\tselect: true,\n\t\t\tcss: \"webix_rpt_list\",\n\t\t\ttype: {\n\t\t\t\theight: webix.skin.$active.rowHeight + 24,\n\t\t\t\ttemplate: data => this.GetListTemplate(data),\n\t\t\t},\n\t\t\tscheme: {\n\t\t\t\t$change: function(obj) {\n\t\t\t\t\tif (obj.date && typeof obj.date === \"string\")\n\t\t\t\t\t\tobj.date = new Date(obj.date);\n\t\t\t\t},\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_rpt_action_menu: (e, id) => {\n\t\t\t\t\tthis.Menu.Show(e, id);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t},\n\t\t\tonDblClick: {},\n\t\t\ton: {\n\t\t\t\tonAfterSelect: id => this.LoadModule(id, null),\n\t\t\t\tonItemDblClick: id => this.LoadModule(id, \"edit\"),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\twidth: 320,\n\t\t\ttype: \"clean\",\n\t\t\trows: [bar, { type: \"clean\", rows: [menu, table] }],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.Menu = this.ui(MenuPopup);\n\n\t\tconst list = this.$$(\"list\");\n\t\tlist.$view.firstChild.setAttribute(\"placeholder\", this._(\"No reports\"));\n\n\t\tconst mods = this.app.getService(\"local\").getModules();\n\t\tlist.sync(mods);\n\t\tmods.waitData.then(() => {\n\t\t\tif (this.State.moduleId) list.select(this.State.moduleId);\n\t\t});\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.$$(\"list\").refresh());\n\n\t\tthis.$$(\"search\").attachEvent(\"onSearchChange\", v => this.Find(v));\n\n\t\tthis.Sorting = { by: \"name\", dir: \"asc\" };\n\t}\n\n\tLoadModule(id, mode) {\n\t\tthis.app.callEvent(\"loadModule\", [id, mode]);\n\t}\n\n\tHide() {\n\t\tthis.app.callEvent(\"hideModuleList\");\n\t}\n\n\tFind() {\n\t\tlet text = this.$$(\"search\").getValue();\n\t\tconst list = this.$$(\"list\");\n\t\tif (text) {\n\t\t\ttext = text.toLowerCase();\n\t\t\tlist.filter(data => this.SearchCompare(text, data));\n\t\t} else {\n\t\t\tlist.filter();\n\t\t}\n\t}\n\tSearchCompare(value, item) {\n\t\treturn item.name.toLowerCase().indexOf(value) > -1;\n\t}\n\n\tGetListTemplate(item) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tlet html = \"<div class='webix_rpt_list_block'>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_name'>\" +\n\t\t\ttypes[item.parsed.type] +\n\t\t\t\" \" +\n\t\t\titem.name +\n\t\t\t\"</div>\";\n\t\thtml +=\n\t\t\t\"<div class='webix_rpt_list_report_date'>\" +\n\t\t\t_(\"Last modified\") +\n\t\t\t\": \" +\n\t\t\twebix.i18n.longDateFormatStr(item.updated || new Date()) +\n\t\t\t\"</div>\";\n\t\tif (!this.State.readonly)\n\t\t\thtml +=\n\t\t\t\t\"<span class='webix_icon webix_rpt_action_menu rpi-dots-vertical'></span>\";\n\t\treturn html + \"</div>\";\n\t}\n\n\tSort(by) {\n\t\tlet sState = this.Sorting;\n\t\tconst prevState = webix.copy(sState);\n\t\tif (sState.by == by) sState.dir = sState.dir == \"desc\" ? \"asc\" : \"desc\";\n\t\telse {\n\t\t\tsState.by = by;\n\t\t\tsState.dir = \"desc\";\n\t\t}\n\t\tsState.as = by == \"updated\" ? \"date\" : \"string\";\n\t\tthis.ChangeSortButtons(sState, prevState);\n\t\tthis.$$(\"list\").sort(sState);\n\t}\n\n\tChangeSortButtons(state, prevState) {\n\t\tconst btn = this.$$(state.by + \"Sorting\");\n\n\t\tthis.webix.html.addCss(btn.$view, \"webix_rpt_btn_active\");\n\t\tbtn.config.icon = btn.config.icons[state.dir];\n\t\tbtn.refresh();\n\t\tif (state.by != prevState.by) {\n\t\t\tconst prevBtn = this.$$(prevState.by + \"Sorting\");\n\t\t\tthis.webix.html.removeCss(prevBtn.$view, \"webix_rpt_btn_active\");\n\t\t}\n\t}\n}\n","import BaseExportView from \"../common/export\";\n\nexport default class ExportView extends BaseExportView {\n\t/** Returns menu data */\n\tGetData() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{ value: _(\"To Excel\"), id: \"excel\" },\n\t\t\t{ value: _(\"To CSV\"), id: \"csv\" },\n\t\t];\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport \"../../helpers/rsearch\";\nimport ExportMenu from \"./export\";\n\nexport default class ToolbarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst bar = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"toolbar\",\n\t\t\theight: webix.skin.$active.barHeight + 6,\n\t\t\thidden: true,\n\t\t\tpadding: { left: 10, right: 10, top: 6, bottom: 6 },\n\t\t\tmargin: 10,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\twidth: 140,\n\t\t\t\t\tlabel: _(\"Export\"),\n\t\t\t\t\ticon: \"rpi-export\",\n\t\t\t\t\tclick: viewId => this.ShowExportPopup(viewId),\n\t\t\t\t},\n\t\t\t\t{},\n\n\t\t\t\t{\n\t\t\t\t\tview: \"text-search\",\n\t\t\t\t\tlocalId: \"search\",\n\t\t\t\t\tplaceholder: _(\"Type to search\"),\n\t\t\t\t\tmaxWidth: 600,\n\t\t\t\t\tminWidth: 200,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\treturn bar;\n\t}\n\n\tready() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.$$(\"search\").attachEvent(\n\t\t\t\"onSearchChange\",\n\t\t\tv => (this.State.search = v)\n\t\t);\n\t\tthis.on(this.app, \"onRecordsSearch\", (value, result) => {\n\t\t\tif (value) this.$$(\"search\").setBadge(result.length);\n\t\t\telse this.$$(\"search\").setBadge(null);\n\t\t});\n\t}\n\t/**\n\t * Shows menu\n\t * @param {String} viewId - webix view id\n\t */\n\tShowExportPopup(viewId) {\n\t\tif (!this.ExportMenu || !this.ExportMenu.$view)\n\t\t\tthis.ExportMenu = this.ui(ExportMenu);\n\t\tconst node = webix.$$(viewId);\n\t\tthis.ExportMenu.Show(node.$view);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { createState } from \"jet-restate\";\nimport Toolbar from \"./toolbar\";\n\nconst typeToSort = {\n\tnumber: \"int\",\n\tdate: \"date\",\n\ttext: \"string\",\n\tboolean: \"number\",\n\tpicklist: \"text\",\n\treference: \"text\",\n};\n\nexport default class TableView extends JetView {\n\tconfig() {\n\t\tconst page = {\n\t\t\ttype: \"wide\",\n\t\t\tmargin: 5,\n\t\t\tcols: [{}],\n\t\t};\n\n\t\treturn { rows: [Toolbar, page] };\n\t}\n\n\tinit() {\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.LocalState = createState({ search: \"\" });\n\t\tthis.setParam(\"state\", this.LocalState);\n\n\t\tthis.Local = this.app.getService(\"local\");\n\t}\n\tready() {\n\t\tconst parts = this.getRoot().getChildViews();\n\t\tthis.Bar = parts[0];\n\t\tthis.Host = parts[1];\n\n\t\tthis.on(this.State.$changes, \"module\", mod => this.Show(mod));\n\t\tthis.on(this.app, \"exportModule\", mode => this.Export(mode));\n\t\tthis.on(this.LocalState.$changes, \"search\", v => this.Find(v));\n\t}\n\n\tExport(mode) {\n\t\tconst params = {\n\t\t\tignore: { $selection: true },\n\t\t\tplainOutput: true,\n\t\t\tfilterHTML: true,\n\t\t};\n\t\tif (this.Table) {\n\t\t\tif (mode == \"excel\") webix.toExcel(this.Table, params);\n\t\t\telse if (mode == \"csv\") webix.toCSV(this.Table, params);\n\t\t}\n\t}\n\n\tShow(mod) {\n\t\tconst host = this.Host;\n\t\tif (mod && mod.columns.length && mod.type === \"table\") {\n\t\t\tconst config = this.GetTableConfig(mod);\n\t\t\tif (!config) return;\n\n\t\t\tthis.Bar.show();\n\t\t\twebix.ui([config], host);\n\t\t\tconst table = (this.Table = host.getChildViews()[0]);\n\n\t\t\tthis.GetTableData(mod).then(([data, options]) => {\n\t\t\t\t// table already reconstructed on moment of data loading\n\t\t\t\tif (table.$destructed) return;\n\t\t\t\toptions.forEach(({ field, data }) => {\n\t\t\t\t\tif (!this.IsBucketColumn(field))\n\t\t\t\t\t\ttable.getColumnConfig(field).collection.parse(data);\n\t\t\t\t});\n\t\t\t\ttable.parse(data);\n\t\t\t});\n\t\t} else {\n\t\t\twebix.ui([{}], host);\n\t\t\tthis.Table = null;\n\t\t\tthis.Bar.hide();\n\t\t}\n\t}\n\tIsBucketColumn(field, module) {\n\t\tmodule = module || this.State.module;\n\t\treturn module.buckets && module.buckets.find(b => b.column == field);\n\t}\n\tGetTableConfig(mod) {\n\t\tconst { groups, columns, meta } = mod;\n\t\tif (!columns) return null;\n\t\tlet dateColumns = [];\n\t\tconst gColumns = columns.map(a => {\n\t\t\tif (a.type == \"date\") dateColumns.push(a.id);\n\t\t\treturn this.GetColumnConfig(a);\n\t\t});\n\n\t\tconst edit = this.State.mode === \"edit\";\n\t\tconst grid = {\n\t\t\tview: groups ? \"treetable\" : \"datatable\",\n\t\t\tcolumns: gColumns,\n\t\t\tresizeColumn: edit ? { headerOnly: true } : false,\n\t\t\tleftSplit: meta.freeze ? meta.freeze : 0,\n\t\t\tcss: edit ? \"webix_header_border\" : \"\",\n\t\t\ton: {\n\t\t\t\tonColumnResize: (id, width, old, byUser) =>\n\t\t\t\t\tthis.SetColWidth(id, width, old, byUser),\n\t\t\t},\n\t\t};\n\n\t\tif (dateColumns.length)\n\t\t\tgrid.scheme = {\n\t\t\t\t$change: row =>\n\t\t\t\t\tdateColumns.forEach(cId => (row[cId] = new Date(row[cId]))),\n\t\t\t};\n\n\t\treturn grid;\n\t}\n\n\tGetColumnConfig(a) {\n\t\tlet column = {\n\t\t\tid: a.id,\n\t\t\theader:\n\t\t\t\t!a.meta.header || a.meta.header === \"none\"\n\t\t\t\t\t? a.meta.name || a.name\n\t\t\t\t\t: [\n\t\t\t\t\t\t\ta.meta.name || a.name,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t\t\ta.meta.header === \"text\" ? \"textFilter\" : \"richSelectFilter\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ],\n\t\t\ttype: a.type,\n\t\t\tsort: typeToSort[a.type],\n\t\t\twidth: a.width || 200,\n\t\t};\n\n\t\tif (a.type === \"date\") column.format = webix.i18n.dateFormatStr;\n\t\tif (a.type === \"boolean\") {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tcolumn.template = obj => (obj[a.id] == 1 ? _(\"True\") : _(\"False\"));\n\t\t}\n\t\tif (\n\t\t\t(a.type === \"reference\" || a.type === \"picklist\") &&\n\t\t\t!this.IsBucketColumn(a.id)\n\t\t)\n\t\t\tcolumn.options = [];\n\n\t\treturn column;\n\t}\n\n\tSetColWidth(id, width, old, byUser) {\n\t\tif (byUser) {\n\t\t\tif (id === \"$selection\" || id === \"$subrow\") {\n\t\t\t\tconst table = this.Tbl;\n\t\t\t\ttable.blockEvent();\n\t\t\t\ttable.setColumnWidth(id, old);\n\t\t\t\ttable.unblockEvent();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.app.callEvent(\"onColumnResize\", [id, width]);\n\t\t}\n\t}\n\n\tGetTableData(mod) {\n\t\treturn Promise.all([\n\t\t\tthis.Local.getData(\n\t\t\t\tthis.Local.getDataConfig(mod),\n\t\t\t\tthis.State.mode == \"edit\"\n\t\t\t),\n\t\t\tthis.Local.getOptions(mod.columns),\n\t\t]);\n\t}\n\n\tFind(value) {\n\t\tconst h = this.app.getService(\"helpers\");\n\t\tconst table = this.Table;\n\t\tlet result = [];\n\t\tif (!table) return;\n\t\ttable.clearCss(\"webix_rpt_found_record\", true);\n\n\t\tif (value) {\n\t\t\tconst ignoreDateNumber = h.hasNonDigits(value);\n\t\t\tconst regexp = new RegExp(h.wildToRegexp(value), \"gi\");\n\t\t\tconst fields = table.config.columns.filter(\n\t\t\t\tc =>\n\t\t\t\t\t!(c.id === \"$selection\" || c.id === \"$subrow\") &&\n\t\t\t\t\t(!ignoreDateNumber || !(c.type === \"number\" || c.type === \"date\"))\n\t\t\t);\n\n\t\t\tconst matchers = [];\n\n\t\t\tfor (let i = 0; i < fields.length; ++i) {\n\t\t\t\tconst type = fields[i].type || \"text\";\n\t\t\t\tconst colId = fields[i].id;\n\t\t\t\tif (type === \"text\" || type === \"number\") {\n\t\t\t\t\tmatchers.push(o => regexp.test(o[colId]));\n\t\t\t\t} else if (type === \"reference\" || type === \"picklist\") {\n\t\t\t\t\tconst collection = table.getColumnConfig(colId).collection;\n\n\t\t\t\t\tconst optionsMatch = h.findOptions(collection, regexp);\n\t\t\t\t\tmatchers.push(h.matchPerColumn(colId, a => optionsMatch[a]));\n\t\t\t\t} else if (type === \"bool\") {\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase \"true\":\n\t\t\t\t\t\t\tmatchers.push(o => o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"false\":\n\t\t\t\t\t\t\tmatchers.push(o => !o[colId]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else if (type === \"date\") {\n\t\t\t\t\tconst dateFormats = table.getColumnConfig(colId).format;\n\t\t\t\t\tmatchers.push(o => regexp.test(dateFormats(o[colId])));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet found = false;\n\t\t\tresult = table.find(obj => {\n\t\t\t\tfor (let i = 0; i < matchers.length; ++i) {\n\t\t\t\t\tif (matchers[i](obj)) {\n\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\ttable.showItem(obj.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.addCss(obj.id, \"webix_rpt_found_record\", true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\ttable.refresh();\n\t\tthis.app.callEvent(\"onRecordsSearch\", [value, result]);\n\t}\n}\n","export default function handler(view) {\n\treturn {\n\t\tattachEvent: (key, handler) => {\n\t\t\twebix.UIManager.addHotKey(key, handler, view);\n\t\t\treturn { key, handler };\n\t\t},\n\t\tdetachEvent: ({ key, handler }) =>\n\t\t\twebix.UIManager.removeHotKey(key, handler, view),\n\t};\n}\n","export default class Charts {\n\tconstructor(_app) {\n\t\tthis._app = _app;\n\t\tthis.type = \"line\";\n\t\tthis.type = \"line\";\n\t\tthis.colors = [\n\t\t\t\"#FF9700\",\n\t\t\t\"#4CB050\",\n\t\t\t\"#00BCD4\",\n\t\t\t\"#3F51B5\",\n\t\t\t\"#9C28B1\",\n\t\t\t\"#F34336\",\n\t\t\t\"#FFEA3B\",\n\t\t\t\"#009788\",\n\t\t\t\"#2196F3\",\n\t\t\t\"#673BB7\",\n\t\t\t\"#EA1E63\",\n\t\t];\n\t\tthis.itemSupport = [\"line\", \"spline\", \"radar\"];\n\t\tthis.noAxisSupport = [\"pie\", \"donut\"];\n\t\tthis.lineTypes = [\"line\", \"spline\"];\n\t\tthis.multiTypeSupport = [\n\t\t\t\"bar\",\n\t\t\t\"stackedBar\",\n\t\t\t\"area\",\n\t\t\t\"stackedArea\",\n\t\t\t\"splineArea\",\n\t\t];\n\t\tthis.numLimit = 30;\n\t}\n\t/*\n\tGet chart type data.\n\tCreate an array of objects {id, value}\n\tand return this array.\n\t*/\n\tgetTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.types)\n\t\t\tthis.types = [\n\t\t\t\t{ id: \"line\", value: _(\"Line\"), icon: \"rpi-chart-line\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"spline\",\n\t\t\t\t\tvalue: _(\"Spline\"),\n\t\t\t\t\ticon: \"rpi-chart-bell-curve-cumulative\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"area\",\n\t\t\t\t\tvalue: _(\"Area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedArea\",\n\t\t\t\t\tvalue: _(\"Stacked area\"),\n\t\t\t\t\ticon: \"rpi-chart-line-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"splineArea\",\n\t\t\t\t\tvalue: _(\"Spline area\"),\n\t\t\t\t\ticon: \"rpi-chart-areaspline-variant\",\n\t\t\t\t},\n\n\t\t\t\t{ id: \"bar\", value: _(\"Bar\"), icon: \"rpi-chart-bar\" },\n\t\t\t\t{\n\t\t\t\t\tid: \"stackedBar\",\n\t\t\t\t\tvalue: _(\"Stacked bar\"),\n\t\t\t\t\ticon: \"rpi-chart-bar-stacked\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"radar\",\n\t\t\t\t\tvalue: _(\"Radar\"),\n\t\t\t\t\ticon: \"rpi-vector-triangle\",\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.types;\n\t}\n\n\tgetItemTypes() {\n\t\tconst _ = this._app.getService(\"locale\")._;\n\t\tif (!this.itemTypes)\n\t\t\tthis.itemTypes = [\n\t\t\t\t{\n\t\t\t\t\tid: \"r\",\n\t\t\t\t\tvalue: _(\"circle\"),\n\t\t\t\t\ticon: \"rpi-circle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"s\",\n\t\t\t\t\tvalue: _(\"square\"),\n\t\t\t\t\ticon: \"rpi-square-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"t\",\n\t\t\t\t\tvalue: _(\"triangle\"),\n\t\t\t\t\ticon: \"rpi-triangle-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"d\",\n\t\t\t\t\tvalue: _(\"diamond\"),\n\t\t\t\t\ticon: \"rpi-rhombus-outline\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"no\",\n\t\t\t\t\tvalue: _(\"no markers\"),\n\t\t\t\t},\n\t\t\t];\n\t\treturn this.itemTypes;\n\t}\n\n\tgetSeries(fiedls, type) {\n\t\tlet data = [];\n\t\tlet colorIndex = 0;\n\t\tfiedls.forEach(field => {\n\t\t\tlet series = {\n\t\t\t\tid: field.id,\n\t\t\t\tname: field.value,\n\t\t\t\tmodel: field.model || null,\n\t\t\t\tshow: true,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: field.value,\n\t\t\t\t\tcolor: this.colors[colorIndex] || this.colors[0],\n\t\t\t\t},\n\t\t\t};\n\t\t\tcolorIndex++;\n\n\t\t\tif (this.itemSupport.indexOf(type) != -1) {\n\t\t\t\tseries.meta.markerType = \"r\";\n\t\t\t\tseries.meta.fillMarker = false;\n\t\t\t}\n\t\t\tdata.push(series);\n\t\t});\n\t\treturn data;\n\t}\n}\n","export function waitVisible(view){\n\tconst promise = webix.promise.defer();\n\n\tconst interval = setInterval(()=> {\n\t\tconst destructed = view.$destructed;\n\t\tif(destructed || view.isVisible()){\n\t\t\tif(destructed)\n\t\t\t\tpromise.reject();\n\t\t\telse\n\t\t\t\tpromise.resolve();\n\t\t\tclearInterval(interval);\n\t\t}\n\t}, 300);\n\n\treturn promise;\n}","import { JetView } from \"webix-jet\";\n\nexport default class AddView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst cals = this.app.config.calendars;\n\n\t\tconst ui = {\n\t\t\tview: compact ? \"icon\" : \"button\",\n\t\t\ttype: \"icon\",\n\t\t\ticon: \"wxi-plus\",\n\t\t\tcss: \"webix_primary\",\n\t\t\tlabel: _(\"Create\"),\n\t\t\twidth: compact ? 50 : cals ? 185 : 100,\n\t\t\theight: compact ? 50 : webix.skin.$active.inputHeight,\n\t\t\ton: {\n\t\t\t\tonItemClick: () => this.AddEvent(),\n\t\t\t},\n\t\t};\n\n\t\treturn { view: \"align\", body: ui, align: \"middle\" };\n\t}\n\n\tAddEvent() {\n\t\tthis.app.getState().selected = { id: \"0\" };\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class DateView extends JetView {\n\tconfig() {\n\t\tconst toolbar = [\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-left\",\n\t\t\t\ttooltip: () => this.NavLabel(-1),\n\t\t\t\talign: \"left\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(-1) },\n\t\t\t},\n\t\t\t{ view: \"label\", localId: \"title\", align: \"center\", width: 160 },\n\t\t\t{\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-angle-right\",\n\t\t\t\ttooltip: () => this.NavLabel(1),\n\t\t\t\talign: \"right\",\n\t\t\t\ton: { onItemClick: () => this.ChangeDate(1) },\n\t\t\t},\n\t\t];\n\n\t\treturn {\n\t\t\tcols: toolbar,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"date\", () => this.DateLabel());\n\t\tthis.on(this.State.$changes, \"mode\", () => this.DateLabel());\n\t\tif (this.app.config.timeline)\n\t\t\tthis.on(this.State.$changes, \"timelineMode\", () => this.DateLabel());\n\t}\n\n\tChangeDate(dir) {\n\t\tconst state = this.State;\n\t\tconst step = this.GetStep(state.mode);\n\t\tconst next = webix.Date.add(state.date, dir, step, true);\n\n\t\t// fix navigation in month mode when last day of month is selected\n\t\tif (state.mode === \"month\") {\n\t\t\tconst diff = Math.abs(state.date.getMonth() - next.getMonth());\n\t\t\tif (diff != 1 && diff < 6) next.setDate(0);\n\t\t}\n\n\t\tstate.$batch({\n\t\t\tdate: next,\n\t\t\tselected: null,\n\t\t});\n\t}\n\n\tGetStep(mode) {\n\t\tswitch (mode) {\n\t\t\tcase \"agenda\":\n\t\t\t\treturn \"month\";\n\t\t\tcase \"units\":\n\t\t\t\treturn \"day\";\n\t\t\tcase \"timeline\":\n\t\t\t\treturn this.State.timelineMode;\n\t\t\tdefault:\n\t\t\t\treturn mode;\n\t\t}\n\t}\n\n\tDateLabel() {\n\t\tconst date = this.State.date;\n\t\tconst mode = this.State.mode;\n\t\tlet format = webix.Date.dateToStr(\"%F %Y\");\n\t\tif (mode === \"year\") format = webix.Date.dateToStr(\"%Y\");\n\t\telse if (\n\t\t\tmode == \"day\" ||\n\t\t\tmode == \"units\" ||\n\t\t\t(mode == \"timeline\" && this.State.timelineMode == \"day\")\n\t\t)\n\t\t\tformat = webix.i18n.longDateFormatStr;\n\n\t\tthis.$$(\"title\").setHTML(format(date));\n\t}\n\n\tNavLabel(dir) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst modes = [\"month\", \"week\", \"day\"];\n\t\tlet mode = this.State.mode;\n\t\tmode = modes.indexOf(mode) !== -1 ? ` ${mode}` : \"\";\n\n\t\tdir = dir > 0 ? \"Next\" : \"Previous\";\n\n\t\treturn _(dir + mode);\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class NavBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst toolbar = {\n\t\t\thidden: compact,\n\t\t\tview: \"tabbar\",\n\t\t\tbottomOffset: 0,\n\t\t\tlocalId: \"buttons\",\n\t\t\tborderless: true,\n\t\t\twidth: 320,\n\t\t\toptionWidth: 80,\n\t\t\toptions: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\") },\n\t\t\t\t{ id: \"year\", value: _(\"Year\") },\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.timeline) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"timeline\", value: _(\"Timeline\") });\n\t\t}\n\n\t\tif (!compact) {\n\t\t\ttoolbar.on = { onChange: val => this.SetMode(val) };\n\t\t}\n\n\t\tif (units) {\n\t\t\ttoolbar.width += 80;\n\t\t\ttoolbar.options.push({ id: \"units\", value: _(\"Units\") });\n\t\t}\n\n\t\treturn toolbar;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.on(this.State.$changes, \"mode\", val => {\n\t\t\tthis.$$(\"buttons\").setValue(val);\n\t\t});\n\t}\n\tSetMode(val) {\n\t\tthis.State.$batch({\n\t\t\tmode: val,\n\t\t\tselected: null,\n\t\t});\n\t}\n}\n","const defaultPalette = [\n\t[\"#61AEE6\", \"#01C2A5\", \"#E88DD9\", \"#D2FB9E\", \"#6BA8CB\", \"#61BBA5\", \"#CF89D5\"],\n\t[\"#EF9C80\", \"#8289EE\", \"#74B1A7\", \"#DD89AF\", \"#E48882\", \"#997CEB\", \"#ADD579\"],\n\t[\"#F68896\", \"#FFE999\", \"#6D4BCE\", \"#99CA58\", \"#D352BE\", \"#F7CC34\", \"#DA5C53\"],\n];\nconst modernPalette = [\n\t[\"#5890DC\", \"#3AA3E3\", \"#045AA3\", \"#014593\", \"#01C2A5\", \"#61A649\", \"#157B7A\"],\n\t[\"#04864F\", \"#AD44AB\", \"#CB61C8\", \"#AC3C6E\", \"#BA282E\", \"#BD4E1B\", \"#B87728\"],\n\t[\"#B65F06\", \"#7A67EB\", \"#4536AD\", \"#282A8A\", \"#36337E\", \"#585B85\", \"#2A2F50\"],\n];\nconst palettes = {\n\tmaterial: defaultPalette,\n\tmini: defaultPalette,\n\tflat: defaultPalette,\n\tcompact: defaultPalette,\n\tcontrast: defaultPalette,\n\twillow: modernPalette,\n\tdark: modernPalette,\n};\n\nexport default function getPalette() {\n\tconst aSkin = webix.skin.$active;\n\treturn {\n\t\tview: \"colorboard\",\n\t\tcss: \"webix_scheduler_palette\",\n\t\theight: aSkin.optionHeight * 3 + 4,\n\t\twidth: aSkin.optionHeight * 7 + 4,\n\t\tpalette: palettes[webix.skin.$name],\n\t};\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst save = {\n\t\t\tview: \"button\",\n\t\t\tvalue: _(\"Save\"),\n\t\t\talign: \"right\",\n\t\t\tinputWidth: 100,\n\t\t\tcss: \"webix_primary\",\n\t\t\tclick: () => this.Save(),\n\t\t};\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst compactBar = {\n\t\t\tview: \"toolbar\",\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: aSkin.layoutPadding.form,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"icon\", icon: \"wxi-close\", click: () => this.getRoot().hide() },\n\t\t\t\t{},\n\t\t\t\tsave,\n\t\t\t],\n\t\t};\n\n\t\tconst controls = [\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"removeBtn\",\n\t\t\t\tvalue: _(\"Delete\"),\n\t\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\t\thidden: true,\n\t\t\t\talign: compact ? \"center\" : \"left\",\n\t\t\t\tinputWidth: compact ? 330 : 100,\n\t\t\t\tclick: () => this.Delete(),\n\t\t\t},\n\t\t];\n\n\t\tif (!compact) controls.push(save);\n\n\t\tconst ui = this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\twidth: 400,\n\t\t\tclose: true,\n\t\t\tborderless: compact,\n\t\t\tfullscreen: compact,\n\t\t\tcss: \"webix_scheduler_cal_popup\",\n\t\t\thead: compact ? compactBar : _(\"Edit calendar\"),\n\t\t\tbody: {\n\t\t\t\tview: \"form\",\n\t\t\t\tlocalId: \"calendars:form\",\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"text\", label: _(\"Title\"), name: \"text\" },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\t\tname: \"color\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{ view: \"checkbox\", label: _(\"Active\"), name: \"active\" },\n\t\t\t\t\t{ cols: controls },\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tthis.Form.clear();\n\t\t\t\t\tthis.$$(\"removeBtn\").hide();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (compact) ui.body.elements.splice(3, 0, {});\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.Cals = this.app.getService(\"local\").calendars(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\t\tthis.Form = this.$$(\"calendars:form\");\n\t}\n\n\tShow(id) {\n\t\tif (id) {\n\t\t\tconst obj = this.Cals.getItem(id);\n\t\t\tthis.Form.setValues(obj);\n\t\t\tthis.$$(\"removeBtn\").show();\n\t\t} else {\n\t\t\tthis.Form.setValues({\n\t\t\t\tcolor: \"#997CEB\",\n\t\t\t\tactive: 1,\n\t\t\t});\n\t\t}\n\t\tthis.getRoot().show();\n\t\tthis.Form.focus();\n\t}\n\n\tSave() {\n\t\tconst obj = this.Form.getValues();\n\t\tif (obj.id) this.Ops.updateCalendar(obj.id, obj);\n\t\telse this.Ops.addCalendar(obj);\n\t\tthis.getRoot().hide();\n\t}\n\n\tDelete() {\n\t\tconst obj = this.Form.getValues();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttext: _(\"Do you really want to remove this calendar?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.Ops.removeCalendar(obj.id);\n\t\t\t\tthis.getRoot().hide();\n\t\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport EditorView from \"./editor\";\nimport getPalette from \"helpers/palette\";\nimport { waitVisible } from \"@xbs/jet-helpers\";\n\nexport default class SidePopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst ui = {\n\t\t\tview: \"popup\",\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\trows: [\n\t\t\t\t\twebix.extend(getPalette(), {\n\t\t\t\t\t\tlocalId: \"colors\",\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonItemClick: val => this.UpdateColor(val),\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\tcss: \"webix_scheduler_settings\",\n\t\t\t\t\t\ttemplate: _(\"Settings\"),\n\t\t\t\t\t\theight: webix.skin.$active.inputHeight,\n\t\t\t\t\t\tonClick: {\n\t\t\t\t\t\t\twebix_template: () => this.ShowEditor(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => this.app.callEvent(\"side:popup:hide\", []),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\twaitVisible(this.getRoot()).then(() => {\n\t\t\tthis.Editor = this.ui(EditorView);\n\t\t});\n\t}\n\n\tShow(id, node, color) {\n\t\tthis.Cid = id;\n\t\tthis.getRoot().show(node);\n\t\tthis.$$(\"colors\").setValue(color);\n\t}\n\n\tShowEditor() {\n\t\tthis.Editor.Show(this.Cid);\n\t\tthis.getRoot().hide();\n\t}\n\n\tUpdateColor(val) {\n\t\tthis.app.getService(\"operations\").updateCalendar(this.Cid, {\n\t\t\tcolor: val,\n\t\t});\n\t\tthis.getRoot().hide();\n\t}\n\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport PopupView from \"./popup\";\nimport EditorView from \"./editor\";\n\nexport default class SideView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.app.getState();\n\n\t\tconst calendar = {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\theight: 276,\n\t\t\tmonthSelect: false,\n\t\t\ton: {\n\t\t\t\tonAfterDateSelect: date => {\n\t\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"calendars\",\n\t\t\ttype: this.ListType(_, state),\n\t\t\tborderless: true,\n\t\t\tautoheight: true,\n\t\t\tyCount: 5,\n\t\t\teditable: true,\n\t\t\teditValue: \"text\",\n\t\t\teditaction: \"custom\",\n\t\t\teditor: \"text\",\n\t\t\tcss: \"webix_scheduler_cal_list\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_cal_edit: (e, id) => this.ShowPopup(e, id),\n\t\t\t\twebix_scheduler_cal_title: (e, id) => this.ToggleCalendar(id),\n\t\t\t\twebix_scheduler_active: (e, id) => this.ToggleCalendar(id),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonBeforeEditStop: (v, editor) => this.SetTitle(editor.id, v.value),\n\t\t\t},\n\t\t};\n\n\t\tconst rows = [\n\t\t\t{ maxHeight: 100 },\n\t\t\tlist,\n\t\t\t{\n\t\t\t\tview: \"button\",\n\t\t\t\tlocalId: \"add\",\n\t\t\t\tvalue: _(\"Add calendar\"),\n\t\t\t\thidden: !state.readonly,\n\t\t\t\tinputWidth: 190,\n\t\t\t\talign: \"center\",\n\t\t\t\tclick: () => this.AddCalendar(),\n\t\t\t},\n\t\t\t{},\n\t\t];\n\n\t\tlet side = {\n\t\t\ttype: \"form\",\n\t\t\tpadding: { top: 8 },\n\t\t\trows: rows,\n\t\t};\n\n\t\tif (!this.Compact) {\n\t\t\tlist.on.onAfterScroll = () => this.Popup.Hide();\n\t\t\tside = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [calendar, side],\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn side;\n\t}\n\n\tinit() {\n\t\tthis.Cals = this.$$(\"calendars\");\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\tthis.Popup = this.Compact ? this.ui(EditorView) : this.ui(PopupView);\n\t\twebix.extend(this.Cals, webix.EditAbility);\n\n\t\tthis.Data.calendars().then(data => this.Cals.parse(data));\n\n\t\tconst state = this.app.getState();\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"date\", value => {\n\t\t\t\tthis.$$(\"calendar\").setValue(value);\n\t\t\t});\n\t\t\tthis.on(this.app, \"side:popup:hide\", () => {\n\t\t\t\tthis.Cals.unselectAll();\n\t\t\t});\n\t\t}\n\n\t\tthis.on(state.$changes, \"readonly\", value => this.ToggleState(value));\n\t}\n\n\tListType(_, state) {\n\t\treturn {\n\t\t\tcheckbox: function(obj) {\n\t\t\t\tconst icon =\n\t\t\t\t\tobj.active * 1 ? \"wxi-checkbox-marked\" : \"wxi-checkbox-blank\";\n\t\t\t\treturn `<span style=\"color:${obj.color};\" \n\t\t\t\t\trole=\"checkbox\" tabindex=\"-1\" \n\t\t\t\t\taria-checked=\"${obj.active ? \"true\" : \"false\"}\" \n\t\t\t\t\tclass=\"webix_icon webix_scheduler_active ${icon}\">\n\t\t\t\t</span>`;\n\t\t\t},\n\t\t\ttemplate: (obj, common) => {\n\t\t\t\tconst edit = `\n\t\t\t\t\t<span\n\t\t\t\t\t\twebix_tooltip=\"${_(\"Edit calendar\")}\" \n\t\t\t\t\t\tclass=\"webix_icon wxi-dots webix_scheduler_cal_edit \n\t\t\t\t\t\t\t${webix.env.touch ? \" webix_scheduler_cal_visible\" : \"\"}\n\t\t\t\t\t\t\">\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\n\t\t\t\treturn `\n\t\t\t\t\t${common.checkbox(obj)}\n\t\t\t\t\t<span class=\"webix_scheduler_cal_title\">${obj.text || _(\"(no title)\")}</span>\n\t\t\t\t\t${state.readonly ? \"\" : edit}\n\t\t\t\t`;\n\t\t\t},\n\t\t};\n\t}\n\n\tAddCalendar() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Ops.addCalendar().then(id => {\n\t\t\tthis.Cals.edit(id);\n\t\t\tthis.Cals.getEditor()\n\t\t\t\t.getInputNode()\n\t\t\t\t.setAttribute(\"placeholder\", _(\"(no title)\"));\n\t\t});\n\t}\n\n\tShowPopup(e, id) {\n\t\tif (!this.Compact) {\n\t\t\tthis.Cals.select(id);\n\n\t\t\tconst color = this.Cals.getItem(id).color;\n\t\t\tthis.Popup.Show(id, this.Cals.getItemNode(id), color);\n\t\t} else this.Popup.Show(id);\n\t}\n\n\tToggleCalendar(id) {\n\t\tconst obj = this.Cals.getItem(id);\n\t\tthis.Ops.updateCalendar(id, { active: obj.active ^ 1 });\n\t}\n\n\tToggleState(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse add.show();\n\n\t\tthis.Cals.refresh();\n\t}\n\n\tSetTitle(id, text) {\n\t\tthis.Ops.updateCalendar(id, { text }).then(\n\t\t\t() => this.EditStopSilent(),\n\t\t\t() => this.EditStopSilent(true)\n\t\t);\n\t\treturn false;\n\t}\n\n\tEditStopSilent(fail) {\n\t\tthis.Cals.blockEvent();\n\t\tif (fail) this.Cals.editCancel();\n\t\telse this.Cals.editStop();\n\t\tthis.Cals.unblockEvent();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport side from \"views/side\";\n\nexport default class NavPopupView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst units = !!this.app.config.units;\n\n\t\tconst list = {\n\t\t\tview: \"list\",\n\t\t\tcss: \"webix_scheduler_navlist\",\n\t\t\tlocalId: \"modes\",\n\t\t\tautoheight: true,\n\t\t\tdata: [\n\t\t\t\t{ id: \"day\", value: _(\"Day\"), icon: \"shi-day\" },\n\t\t\t\t{ id: \"week\", value: _(\"Week\"), icon: \"shi-week\" },\n\t\t\t\t{ id: \"month\", value: _(\"Month\"), icon: \"shi-month\" },\n\t\t\t\t{ id: \"agenda\", value: _(\"Agenda\"), icon: \"shi-agenda\" },\n\t\t\t\t{ id: \"year\", value: _(\"Year\"), icon: \"shi-year\" },\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.SetMode(id),\n\t\t\t},\n\t\t};\n\n\t\tif (units) {\n\t\t\tlist.data.push({ id: \"units\", value: _(\"Units\"), icon: \"shi-units\" });\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlist.data.push({\n\t\t\t\tid: \"timeline\",\n\t\t\t\tvalue: _(\"Timeline\"),\n\t\t\t\ticon: \"shi-timeline\",\n\t\t\t});\n\t\t}\n\n\t\tconst ui = {\n\t\t\tview: \"sidemenu\",\n\t\t\tanimate: false,\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_scheduler_sidemenu\",\n\t\t\twidth: 300,\n\t\t\tstate: state => {\n\t\t\t\tconst tHeight = webix.skin.$active.tabbarHeight + 10;\n\t\t\t\tstate.left = this.Parent.left;\n\t\t\t\tstate.top = this.Parent.top + tHeight + 2;\n\t\t\t\tstate.height = this.Parent.height - tHeight - 2;\n\t\t\t},\n\t\t\tbody: list,\n\t\t};\n\n\t\tif (this.app.config.calendars)\n\t\t\tui.body = {\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tbody: {\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [list, side],\n\t\t\t\t},\n\t\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tthis.on(this.app, \"view:resize\", () => {\n\t\t\tif (this.getRoot().isVisible()) this.Show(true);\n\t\t});\n\t}\n\tShow(updatePos) {\n\t\tif (!updatePos && this.getRoot().isVisible()) return;\n\n\t\tthis.Parent = this.app.getRoot().$view.getBoundingClientRect();\n\t\tthis.$$(\"modes\").select(this.State.mode);\n\t\tthis.getRoot().show();\n\t}\n\tSetMode(value) {\n\t\tthis.getRoot().hide();\n\n\t\t//wait until hide animation is complete\n\t\tsetTimeout(() => this.State.$batch({ mode: value, selected: null }), 500);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport NavBarView from \"views/bars/nav\";\nimport DateView from \"views/bars/date\";\nimport AddView from \"views/bars/add\";\nimport NavPopupView from \"views/bars/navpopup\";\n\nexport default class TopBarView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst todayIcon = {\n\t\t\tview: \"icon\",\n\t\t\ticon: \"wxi-calendar\",\n\t\t\tbatch: \"compact\",\n\t\t\ttooltip: _(\"Today\"),\n\t\t\tclick: () => this.SetToday(),\n\t\t};\n\t\tconst todayBtn = {\n\t\t\tview: \"align\",\n\t\t\talign: \"middle\",\n\t\t\tbatch: \"full\",\n\t\t\tbody: {\n\t\t\t\twidth: 80,\n\t\t\t\tview: \"button\",\n\t\t\t\tcss: \"webix_transparent\",\n\t\t\t\tvalue: _(\"Today\"),\n\t\t\t\tclick: () => this.SetToday(),\n\t\t\t},\n\t\t};\n\n\t\tconst ui = {\n\t\t\tview: \"toolbar\",\n\t\t\tcss: \"webix_scheduler_toolbar webix_dark\",\n\t\t\tresponsive: true,\n\t\t\tpaddingY: 0,\n\t\t\tpaddingX: 4,\n\t\t\theight: webix.skin.$active.tabbarHeight + 10,\n\t\t\tvisibleBatch: this.Compact ? \"compact\" : \"full\",\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"shi-menu\",\n\t\t\t\t\tclick: () => this.ShowNav(),\n\t\t\t\t\thidden: !this.Compact && !this.app.config.calendars,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tlocalId: \"add\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: AddView,\n\t\t\t\t\tbatch: \"full\",\n\t\t\t\t\t//[ToDO] makes sence to hide it on medium screens to allows smaller compactWidth\n\t\t\t\t\t//in this case click-to-add behaviour for modes must be implemenetd\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"proxy\",\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tbody: DateView,\n\t\t\t\t\tresponsiveCell: false,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\ttodayBtn,\n\t\t\t\t{ width: 12 },\n\t\t\t\tNavBarView,\n\t\t\t\ttodayIcon,\n\t\t\t],\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\n\t\tif (this.Compact) this.NavPopup = this.ui(NavPopupView);\n\n\t\tthis.on(this.State.$changes, \"readonly\", value => {\n\t\t\tthis.ToggleAdd(value);\n\t\t});\n\t}\n\tSetToday() {\n\t\tthis.State.date = webix.Date.dayStart(new Date());\n\t}\n\tShowNav() {\n\t\tif (this.Compact) this.NavPopup.Show();\n\t\telse this.app.callEvent(\"show:panel\");\n\t}\n\tToggleAdd(value) {\n\t\tconst add = this.$$(\"add\");\n\t\tif (value) add.hide();\n\t\telse if (!this.Compact) add.show();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionMenu extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tbody: {\n\t\t\t\tview: \"menu\",\n\t\t\t\tlayout: \"y\",\n\t\t\t\twidth: 220,\n\t\t\t\tautoheight: true,\n\t\t\t\tdata: [\n\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonMenuItemClick: id => {\n\t\t\t\t\t\tif (this.Result) this.Result.resolve(id);\n\t\t\t\t\t\tthis.Result = null;\n\t\t\t\t\t\tthis.Root.hide();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => {\n\t\t\t\t\tif (this.Result) this.Result.reject();\n\t\t\t\t\tthis.Result = null;\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(node) {\n\t\tthis.Result = webix.promise.defer();\n\t\tthis.Root.show(node);\n\t\treturn this.Result;\n\t}\n}\n","export function shrinkTo(start, end) {\n\treturn ev => {\n\t\tconst before = ev.start_date <= start;\n\t\tconst after = ev.end_date >= end;\n\n\t\tif (before || after) {\n\t\t\tconst t = webix.copy(ev);\n\t\t\tif (before) t.start_date = start;\n\t\t\tif (after) t.end_date = end;\n\t\t\treturn t;\n\t\t}\n\n\t\treturn ev;\n\t};\n}\n\nexport function isToday(date) {\n\treturn webix.Date.equal(\n\t\twebix.Date.datePart(date),\n\t\twebix.Date.datePart(new Date())\n\t);\n}\n\nexport function isMultiDay(ev) {\n\treturn (\n\t\tev.all_day ||\n\t\t(ev.start_date.getDate() != ev.end_date.getDate() &&\n\t\t\tev.end_date - ev.start_date >= 1000 * 60 * 60 * 24 * 1)\n\t);\n}\n\n/**\n * Returns the difference between dates\n * @param {Date} start - date 1\n * @param {Date} end - date 2\n * @returns {number} difference between dates in days\n */\nexport function daysBetweenInclusive(start, end) {\n\tconst millisecondsPerDay = 24 * 60 * 60 * 1000;\n\treturn Math.round(\n\t\t(webix.Date.dayStart(end) - webix.Date.dayStart(start)) / millisecondsPerDay\n\t);\n}\n\n/**\n * Checks if the dates are the same\n * @param {Date} adate\n * @param {Date} bdate\n * @returns {Boolean}\n */\nexport function isSameDate(adate, bdate) {\n\treturn webix.Date.equal(\n\t\twebix.Date.dayStart(adate),\n\t\twebix.Date.dayStart(bdate)\n\t);\n}\n\nexport function getYearDay(date) {\n\tconst start = webix.Date.yearStart(date);\n\treturn (date - start) / 1000 / 60 / 60 / 24 + 1;\n}\n","const icalFormat = webix.Date.dateToStr(\"%Y%m%dT000000Z\");\n\nexport function parse(string) {\n\t//FREQ=DAILY;INTERVAL=2\n\tconst parts = string.split(\";\");\n\tconst config = {};\n\tfor (let i = 0; i < parts.length; i++) {\n\t\tconst [code, name] = parts[i].split(\"=\");\n\t\tconfig[code] = name;\n\t}\n\n\tif (config.UNTIL) config.UNTIL = strToDate(config.UNTIL);\n\tif (config.EXDATE) {\n\t\tconfig.EXDATE = config.EXDATE.split(\",\").map(d => strToDate(d));\n\t}\n\n\treturn config;\n}\n\nfunction strToDate(str) {\n\treturn new Date(\n\t\tstr.substr(0, 4) * 1,\n\t\tstr.substr(4, 2) * 1 - 1,\n\t\tstr.substr(6, 2) * 1\n\t);\n}\n\nexport function serialize(config) {\n\tconst str = [];\n\tfor (let key in config) {\n\t\tlet value = config[key];\n\t\tif (key === \"UNTIL\") value = icalFormat(value);\n\n\t\tif (key === \"EXDATE\") {\n\t\t\tvalue = value.map(d => icalFormat(d));\n\t\t\tvalue = value.join(\",\");\n\t\t}\n\t\tif (value) str.push(`${key}=${value}`);\n\t}\n\n\treturn str.join(\";\");\n}\n","import { serialize, parse } from \"helpers/ical\";\nexport const WEEKDAYS = [\"SU\", \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\"];\n\nexport const FREQUENCE = {\n\tDAILY: \"day\",\n\tWEEKLY: \"week\",\n\tMONTHLY: \"month\",\n\tYEARLY: \"year\",\n};\n\n/**\n * Splits each recurring event into a series of events and returns the resulting array\n * @param {Date} sdate - the start date\n * @param {Date} edate - the end date\n * @param {Object} ev - the event data object\n * @returns {Array} with recurring events split into occurrences\n */\nexport function explodeEvent(sdate, edate, ev) {\n\tconst mode = ev.$recurring;\n\n\tconst consts = {};\n\tconst res = [];\n\n\t// when we use week-days in recurring mode, convert structure\n\t// list of days => list of steps to the next allowed day\n\tfillWdays(mode, consts);\n\n\tconst xdate = new Date(ev.start_date);\n\tconst length = ev.end_date - ev.start_date;\n\n\t// occurrences before active window\n\tlet count = 1;\n\twhile (\n\t\t(sdate - xdate >= (length || 1) &&\n\t\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t\t(!mode.COUNT || count <= mode.COUNT)) ||\n\t\tfindDate(mode.EXDATE, xdate)\n\t) {\n\t\t++count;\n\t\tnext(xdate, mode, consts);\n\t}\n\n\t// occurrences inside of window\n\twhile (\n\t\tedate > xdate &&\n\t\t(!mode.UNTIL || xdate < mode.UNTIL) &&\n\t\t(!mode.COUNT || count <= mode.COUNT)\n\t) {\n\t\t// make copy of recurring event\n\t\tif (!findDate(mode.EXDATE, xdate)) {\n\t\t\tconst copy = webix.copy(ev);\n\n\t\t\txdate.setHours(ev.start_date.getHours());\n\t\t\tcopy.start_date = new Date(xdate);\n\t\t\tcopy.end_date = new Date(xdate * 1 + length);\n\n\t\t\tcopy.$id = ev.id;\n\t\t\tcopy.id = copy.start_date.valueOf() + \"_\" + ev.id;\n\t\t\tres.push(copy);\n\t\t}\n\t\tcount++;\n\n\t\tnext(xdate, mode, consts);\n\t}\n\treturn res;\n}\n\n// IE support\n/**\n * Finds a date in an array of dates\n * @param {Array} arr - all dates\n * @param {Date} date - the date to be checked\n * @returns {Boolean}\n */\nfunction findDate(arr, date) {\n\tif (!arr) return false;\n\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (webix.Date.equal(webix.Date.dayStart(date), arr[i])) return true;\n\t}\n\treturn false;\n}\n\n/**\n * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n * @typedef {Object} Recurring\n * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n * @property {(number|string)} INTERVAL - how many steps are between occurrences\n * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n * @property {(number|string)} BYMONTH - the number or a month (1-12)\n * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n * @property {(number|string)} BYSETPOS - the number of the week day within a month\n * @property {string} UNTIL - a date like 19970902T090000\n * @property {(number|string)} COUNT - how many times the event repeats\n * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n */\n\n/**\n * Fills the list of steps to the next allowed day for recurring events that repeat by certain week days\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function fillWdays(mode, consts) {\n\tif (mode.BYDAY) {\n\t\tconst diff = (consts.wdays = [0, 0, 0, 0, 0, 0, 0]);\n\t\tconst line = mode.BYDAY.split(\",\")\n\t\t\t.map(a => WEEKDAYS.indexOf(a))\n\t\t\t.sort();\n\n\t\t// for each allowed day, fill range with steps\n\t\tfor (let i = 0; i < line.length; i++) {\n\t\t\tconst s = line[i];\n\t\t\tconst e = line[i + 1] || line[0] + 7;\n\n\t\t\tfor (let j = s; j < e; j++) {\n\t\t\t\tdiff[j % 7] = e - j;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Calculates the date of the next occurrence of a repeating event\n * @param {Date} date - the current date\n * @param {Recurring} mode - the object with the recurring pattern\n * @param {Object} consts - (for events that have BYDAY in their pattern) stores wdays (Array) - the list of steps to the next allowed day\n */\nexport function next(date, mode, consts) {\n\tlet interval = (mode.INTERVAL || 1) * 1;\n\n\tlet now, step;\n\tswitch (mode.FREQ) {\n\t\tcase \"DAILY\":\n\t\t\tdate.setDate(date.getDate() + interval);\n\t\t\tbreak;\n\t\tcase \"WEEKLY\":\n\t\t\tnow = date.getDay();\n\t\t\tstep = consts.wdays ? consts.wdays[now] : 7;\n\t\t\tif (step + now > 6 && interval > 1) {\n\t\t\t\t// when new day is on the different week\n\t\t\t\t// add week interval as well\n\t\t\t\tstep += 7 * (interval - 1);\n\t\t\t}\n\t\t\tdate.setDate(date.getDate() + step);\n\t\t\tbreak;\n\t\tcase \"YEARLY\": {\n\t\t\tif (mode.BYYEARDAY) {\n\t\t\t\tdate.setFullYear(date.getFullYear() + interval);\n\t\t\t\tdate.setMonth(0);\n\t\t\t\tdate.setDate(1);\n\t\t\t\tdate.setDate(mode.BYYEARDAY);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tinterval *= 12;\n\t\t\t// falls through\n\t\t}\n\t\t/*eslint no-fallthrough: \"error\"*/\n\t\tcase \"MONTHLY\":\n\t\t\tnow = date.getMonth();\n\t\t\tdate.setDate(1);\n\t\t\tdate.setMonth(now + interval);\n\t\t\tif (mode.BYMONTHDAY) {\n\t\t\t\tdate.setDate(mode.BYMONTHDAY);\n\t\t\t\t// when date is outside of month bounds, switch to last day of month\n\t\t\t\tif ((now + interval) % 12 != date.getMonth()) date.setDate(0);\n\t\t\t} else if (mode.BYSETPOS) {\n\t\t\t\t// go to last day of month before one in question\n\t\t\t\tdate.setDate(0);\n\t\t\t\t// find the matching day\n\t\t\t\tfor (let i = 0; i < mode.BYSETPOS; i++) {\n\t\t\t\t\tstep = consts.wdays[date.getDay()];\n\t\t\t\t\tdate.setDate(date.getDate() + step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn date;\n}\n\n/**\n * Defines the result of the check if a date fits a BYDAY pattern\n * @typedef {Object} weekdayCheckResult\n * @property {Boolean} result true if the date fits the BYDAY pattern, false otherwise\n * @property {Date} start - the copy of the start date\n * @property {Array} days - BYDAY pattern as an array of strings\n * @property {string} oldDay - the week day of the start date\n */\n/**\n * Checks if the start day fits the recurring BYDAY pattern\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {weekdayCheckResult} the result of the check\n */\nfunction checkDay(sdate, mode) {\n\tconst start = new Date(sdate);\n\tconst days = mode.BYDAY.split(\",\");\n\tconst oldDay = WEEKDAYS[start.getDay()];\n\tconst result = days.indexOf(oldDay) !== -1;\n\n\treturn { result, start, days, oldDay };\n}\n\n/**\n * Synchronizes the start and end dates to the BYDAY recurring pattern\n * @param {Date} sdate\n * @param {Date} edate\n * @param {Recurring} mode - the object with the recurring pattern\n * @return {Array} - the start and end dates of an event\n */\nexport function datesToWeekdays(sdate, edate, mode) {\n\tconst { result, start, days } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn [sdate, edate];\n\t}\n\n\tconst diff = WEEKDAYS.indexOf(days[0]) - start.getDay();\n\tstart.setDate(start.getDate() + diff);\n\n\tconst end = new Date(edate);\n\tend.setDate(end.getDate() + diff);\n\n\treturn [start, end];\n}\n\n/**\n * Synchronizes BYDAY recurring pattern with the date of an event\n * @param {Date} sdate - the start date of an event\n * @param {Recurring} mode - the object with the recurring pattern\n * @returns {string} with the new BYDAY pattern\n */\nexport function WeekdaysToDates(sdate, mode) {\n\tlet { result, days, oldDay } = checkDay(sdate, mode);\n\tif (result) {\n\t\treturn mode.BYDAY;\n\t}\n\n\tif (mode.FREQ === \"WEEKLY\") {\n\t\tdays.splice(WEEKDAYS.indexOf(days[0]), 0, oldDay);\n\t} else {\n\t\tdays = [oldDay];\n\t}\n\treturn days.join(\",\");\n}\n\n/**\n * Returns selection parameters for the global state\n * @param {Object} obj - the event data object\n * @returns {Object} with selection parameters\n */\nexport function getParams(obj) {\n\treturn { id: obj.$id || obj.id, date: obj.$recurring ? obj.id : null };\n}\n\n/**\n * Defines the selection.date parameter of the global state\n * @typedef {(Date|string)} SDate - a Date object or the ID of an event occurrence that consists of a timestamp and the event ID from DB, separated with _\n */\n\n/**\n * Gets a date from the selection.date parameter of the global state\n * @param {(SDate)} sdate\n * @returns {Date}\n */\nexport function extractDate(sdate) {\n\treturn webix.Date.dayStart(\n\t\tsdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1)\n\t);\n}\n\n/**\n * Updates the end of a recurring event sequence\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @param {Boolean} block\n * @returns {string} - serialized recurrence pattern\n */\nexport function clipSequence(sdate, ev, block) {\n\tconst date = extractDate(sdate);\n\n\tif (!block || (!ev.$recurring.UNTIL || ev.$recurring.UNTIL > date))\n\t\tev.$recurring.UNTIL = date;\n\n\tif (ev.$recurring.COUNT) delete ev.$recurring.COUNT;\n\n\tif (ev.$recurring.EXDATE) {\n\t\tev.$recurring.EXDATE = ev.$recurring.EXDATE.filter(d => d < date);\n\t}\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Removes the specified date from the recurrence pattern\n * @param {SDate} sdate\n * @param {Object} ev - the event data object\n * @returns {string} - serialized recurrence pattern\n */\nexport function cutOccurrence(sdate, ev) {\n\tconst date = extractDate(sdate);\n\n\tif (!ev.$recurring.EXDATE) ev.$recurring.EXDATE = [];\n\tev.$recurring.EXDATE.push(date);\n\n\treturn serialize(ev.$recurring);\n}\n\n/**\n * Gets the start and end dates for a particular occurrence from a series\n * @param {Object} obj - the event data object\n * @param {SDate} sdate\n * @returns {Object} with start_date and end_date\n */\nexport function separateSequence(obj, sdate) {\n\tconst start_date =\n\t\ttypeof sdate === \"string\"\n\t\t\t? new Date(sdate.split(\"_\")[0] * 1)\n\t\t\t: new Date(sdate);\n\tconst len = (obj.end_date - obj.start_date) / 1000 / 60; // mins\n\tconst end_date = webix.Date.add(start_date, len, \"minute\", true);\n\treturn { start_date, end_date };\n}\n\n/**\n * Checks if this is the first occurrence of a series\n * @param {SDate} sdate\n * @param {Date} evStart\n * @returns {Boolean}\n */\nexport function isFirstOccurrence(sdate, evStart) {\n\t// editing 'this' event as next\n\tif (!sdate) return false;\n\n\tconst od = sdate.getDate ? sdate : new Date(sdate.split(\"_\")[0] * 1);\n\treturn od <= evStart;\n}\n\n/**\n * Corrects the edit mode for specific cases (depending on which occurrence was selected)\n * @param {Object} obj - the event data object\n * @param {string} mode - \"all\", \"next\", \"this\"\n * @returns {string}\n */\nexport function correctMode(obj, mode) {\n\tif (!obj.origin_id || !obj.recurring) {\n\t\tmode = \"all\";\n\t} else {\n\t\t// if this is 1st occ in 'next' which is the last part of 'all'\n\t\tif (this.app.getService(\"local\").isLastPart(obj)) {\n\t\t\tmode = \"\";\n\t\t}\n\t}\n\treturn mode;\n}\n\nconst dayLength = 86400000;\n/**\n * Moves a recurrence pattern if a recurring event was moved to another date\n * @param {Recurring} rec\n * @param {Object} newEvent - the new event data object\n * @param {Object} oldEvent - the old event data object\n * @returns {Recurring}\n */\nexport function movePattern(rec, newEvent, oldEvent) {\n\tlet days =\n\t\t(webix.Date.dayStart(newEvent.start_date) -\n\t\t\twebix.Date.dayStart(oldEvent.start_date)) /\n\t\tdayLength;\n\n\tif (days) {\n\t\tif (rec.UNTIL) {\n\t\t\tconst until = webix.Date.add(rec.UNTIL, days, \"day\", true);\n\n\t\t\tif (until > newEvent.end_date) rec.UNTIL = until;\n\t\t\telse\n\t\t\t\trec.UNTIL = webix.Date.dayStart(\n\t\t\t\t\twebix.Date.add(newEvent.end_date, 1, \"day\", true)\n\t\t\t\t);\n\t\t}\n\n\t\t// day of start_date changed and pattern doesn't have in anymore\n\t\tif (rec.BYDAY) {\n\t\t\tdays %= 7;\n\t\t\tif (days < 0) days += 7;\n\t\t\trec.BYDAY = rec.BYDAY.split(\",\")\n\t\t\t\t.map(d => WEEKDAYS[(WEEKDAYS.indexOf(d) + days) % 7])\n\t\t\t\t.join(\",\");\n\t\t}\n\n\t\t// in case day of start_date changed in monthly or yearly\n\t\tif (rec.BYMONTHDAY) {\n\t\t\tconst nmd = newEvent.start_date.getDate();\n\t\t\tif (nmd != rec.BYMONTHDAY) {\n\t\t\t\trec.BYMONTHDAY = nmd;\n\t\t\t}\n\t\t}\n\t}\n\n\t// week number of start_date changed in yearly or monthly\n\tif (rec.BYSETPOS) {\n\t\tconst nwn = getWeekNum(newEvent.start_date);\n\t\tif (rec.BYSETPOS != nwn) rec.BYSETPOS = nwn;\n\t}\n\n\t// month of start_date changed in a yearly event\n\tif (rec.BYMONTH) {\n\t\tconst nm = newEvent.start_date.getMonth() + 1;\n\t\tif (nm != rec.BYMONTH) rec.BYMONTH = nm;\n\t}\n\n\treturn rec;\n}\n\n/**\n * Returns the number of a week day within a month (e.g. 3rd Wednesday)\n * @param {Date} date\n * @returns {number}\n */\nexport function getWeekNum(date) {\n\tconst day = date.getDate();\n\treturn Math.floor(day / 7) + (day % 7 ? 1 : 0);\n}\n\n/**\n * Fills incomplete recurring patterns and ensures that they are consistent with the dates of events\n * @param {Object} ev - data object of an event\n */\nexport function checkPattern(ev) {\n\tconst mode = ev.$recurring || parse(ev.recurring);\n\n\t// when exact date not configured, fill recurring config\n\tif (mode.FREQ === \"WEEKLY\" && !mode.BYDAY) {\n\t\tmode.BYDAY = WEEKDAYS[ev.start_date.getDay()];\n\t\treturn;\n\t}\n\n\tif (\n\t\t(mode.FREQ === \"MONTHLY\" || mode.FREQ === \"YEARLY\") &&\n\t\t!mode.BYSETPOS &&\n\t\t!mode.BYMONTHDAY &&\n\t\t!mode.BYYEARDAY\n\t) {\n\t\tmode.BYMONTHDAY = ev.start_date.getDate();\n\t\treturn;\n\t}\n\n\tif (mode.FREQ === \"YEARLY\" && !mode.BYMONTH && !mode.BYYEARDAY) {\n\t\tmode.BYMONTH = ev.start_date.getMonth();\n\t\treturn;\n\t}\n\n\t// in case config is wrong, fix it\n\tif (mode.BYDAY) mode.BYDAY = WeekdaysToDates(ev.start_date, mode);\n\tif (mode.BYMONTHDAY) mode.BYMONTHDAY = ev.start_date.getDate();\n\tif (mode.BYMONTH) mode.BYMONTH = ev.start_date.getMonth() + 1;\n\tif (mode.BYSETPOS) mode.BYSETPOS = getWeekNum(ev.start_date);\n\n\tev.recurring = serialize(mode);\n}\n","import { JetView } from \"webix-jet\";\nimport { WEEKDAYS, fillWdays, next } from \"helpers/recurring\";\n\nexport default class RecurringFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"recurringForm\",\n\t\t\thidden: true,\n\t\t\telementsConfig: { labelPosition: \"left\" },\n\t\t\tpadding: {\n\t\t\t\ttop: aSkin.layoutPadding.form,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: compact ? aSkin.layoutPadding.form : 0,\n\t\t\t\tright: compact ? 14 : 0,\n\t\t\t},\n\t\t\tborderless: true,\n\t\t\trows: [\n\t\t\t\tthis.CreateIntervalControls(_),\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"customRecControls\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\trows: [this.CreateCheckboxes(_), this.CreateSelect(_)],\n\t\t\t\t},\n\t\t\t\tthis.CreateRadio(_),\n\t\t\t],\n\t\t};\n\n\t\tif (!compact) {\n\t\t\tform.on = {\n\t\t\t\tonChange: (o, v, m) => this.UpdateEvent(m),\n\t\t\t};\n\t\t}\n\n\t\treturn form;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"recurringForm\");\n\t\tthis.Events = this.app.getService(\"local\").events(true);\n\n\t\t// commonly called controls\n\t\tthis.CheckBoxContainer = this.$$(\"weekly\");\n\t\tthis.Checkboxes = this.CheckBoxContainer.getChildViews().slice(1);\n\t\tthis.Checkboxes.pop();\n\t\tthis.PatternSelect = this.$$(\"patternSelect\");\n\t\tthis.UntilDateContainer = this.$$(\"untilDate\");\n\t\tthis.UntilDateCalendar = this.Form.elements.untilDate.getPopup().getBody();\n\t\tthis.UntilNumContainer = this.$$(\"untilCount\");\n\t\tthis.UntilNum = this.UntilNumContainer.getBody();\n\t\tthis.CustomRecControls = this.$$(\"customRecControls\");\n\t}\n\n\t// methods of main controls: counter of INTERVAL and richselect of FREQ\n\n\t/**\n\t * Returns the config object for interval counter and recurrence frequency selection\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateIntervalControls(_) {\n\t\treturn {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"counter\",\n\t\t\t\t\tlabel: _(\"Every\"),\n\t\t\t\t\tlabelWidth: 50,\n\t\t\t\t\tmin: 1,\n\t\t\t\t\tname: \"INTERVAL\",\n\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tname: \"FREQ\",\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"DAILY\", value: _(\"day\") },\n\t\t\t\t\t\t{ id: \"WEEKLY\", value: _(\"week\") },\n\t\t\t\t\t\t{ id: \"MONTHLY\", value: _(\"month\") },\n\t\t\t\t\t\t{ id: \"YEARLY\", value: _(\"year\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ChangeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for detailed recurrence pattern selection depending on the frequency\n\t * @param {string} v - recurrence frequency\n\t */\n\tChangeControls(v) {\n\t\tthis._freq = v;\n\t\tif (v === \"DAILY\") {\n\t\t\tthis.CustomRecControls.hide();\n\t\t} else {\n\t\t\tthis.CustomRecControls.show();\n\t\t\tif (v === \"WEEKLY\") {\n\t\t\t\tthis.CheckBoxContainer.show();\n\t\t\t\tthis.PatternSelect.hide();\n\t\t\t} else {\n\t\t\t\tthis.CheckBoxContainer.hide();\n\t\t\t\tif (v === \"MONTHLY\" && this.PatternSelect.getValue() == 3)\n\t\t\t\t\tthis.PatternSelect.setValue(1);\n\t\t\t\tthis.PatternSelect.show();\n\t\t\t\tthis.PatternSelect.getList().refresh();\n\t\t\t\tthis.PatternSelect.refresh();\n\t\t\t}\n\t\t}\n\t}\n\n\t// methods of checkboxes for WEEKLY\n\n\t/**\n\t * Returns the config object for week day checkboxes\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateCheckboxes(_) {\n\t\tconst days = [];\n\t\tfor (let i = 0; i < 7; ++i) {\n\t\t\tdays.push({\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tlabel: webix.i18n.calendar.dayShort[i],\n\t\t\t\tlabelPosition: \"top\",\n\t\t\t\tlabelAlign: \"center\",\n\t\t\t\tcss: \"webix_scheduler_day_checkbox\",\n\t\t\t\tinputWidth: 26,\n\t\t\t\twidth: 45,\n\t\t\t\talign: \"center\",\n\t\t\t\tname: WEEKDAYS[i],\n\t\t\t\ton: {\n\t\t\t\t\tonChange(v, o) {\n\t\t\t\t\t\tthis.$scope.CheckboxGuard(this.config.name, v, o);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tlocalId: \"weekly\",\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: _(\"on\"), width: 45 },\n\t\t\t\t...days,\n\t\t\t\t{ gravity: 0.00001 },\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Prevents the user from unchecking the only checked weekday checkbox\n\t * @param {string} day - the name of the related checkbox (SU, MO, TU, WE, TH, FR, or SA)\n\t * @param {(Boolean|number)} v - the new value of a checkbox (false/0 or true/1)\n\t * @param {(Boolean|number)} o - the old value of a checkbox (false/0 or true/1)\n\t */\n\tCheckboxGuard(day, v, o) {\n\t\tif (!webix.isUndefined(o) && !v && !this.GetBYDAY()) {\n\t\t\tthis.Form.setValues({ [day]: 1 }, true);\n\t\t}\n\t}\n\n\t/**\n\t * Sets values to weekday checkboxes according to BYDAY recurrence pattern (week days)\n\t * @param {Object} values - values from the form\n\t */\n\tSetBYDAY(values) {\n\t\tconst days = values.BYDAY.split(\",\");\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tvalues[check.config.name] = !!days.find(d => d == check.config.name);\n\t\t});\n\t}\n\n\t/**\n\t * Gets the BYDAY pattern from checkbox values\n\t * @returns {string}\n\t */\n\tGetBYDAY() {\n\t\tconst BYDAY = [];\n\t\tthis.Checkboxes.forEach(check => {\n\t\t\tif (check.getValue()) {\n\t\t\t\tBYDAY.push(check.config.name);\n\t\t\t}\n\t\t});\n\t\treturn BYDAY.join(\",\");\n\t}\n\n\t// methods of richselect with MONTHLY and YEARLY patterns\n\n\t/**\n\t * Returns the config object for a dropdown list with monthly/yearly recurrence patterns\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateSelect(_) {\n\t\treturn {\n\t\t\tview: \"richselect\",\n\t\t\tlocalId: \"patternSelect\",\n\t\t\tname: \"rec_pattern\",\n\t\t\tsuggest: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\tif (this._freq === \"YEARLY\" && obj.BYYEARDAY) {\n\t\t\t\t\t\t\treturn `${_(\"Every\")} ${obj.BYYEARDAY} ${_(\"day of year\")}`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst byDay = [];\n\t\t\t\t\t\tif (obj.BYDAY) {\n\t\t\t\t\t\t\tobj.BYDAY.forEach(d =>\n\t\t\t\t\t\t\t\tbyDay.push(webix.i18n.calendar.dayFull[d])\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet text = `${_(\"Every\")} ${obj.BYMONTHDAY || obj.BYSETPOS} ${\n\t\t\t\t\t\t\tobj.BYDAY ? byDay.join(\", \") : \"\"\n\t\t\t\t\t\t}`;\n\t\t\t\t\t\tif (this._freq === \"YEARLY\")\n\t\t\t\t\t\t\ttext += ` ${_(\"of\")} ${\n\t\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[obj.BYMONTH - 1]\n\t\t\t\t\t\t\t}`;\n\t\t\t\t\t\treturn text;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonShow() {\n\t\t\t\t\t\tthis.getList().filter(\n\t\t\t\t\t\t\tobj => this.$scope._freq === \"YEARLY\" || obj.id != 3\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Sets pattern options for the dropdown list (monthly and yearly events)\n\t * @param {Object} ev - values from the form\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t */\n\tSetPatternOptions(ev, calculated) {\n\t\tthis.PatternSelect.getList().parse([\n\t\t\t{\n\t\t\t\tid: 1,\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t\tBYMONTHDAY: ev.BYMONTHDAY || calculated.day,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 2,\n\t\t\t\tBYSETPOS: ev.BYSETPOS || calculated.weekNum,\n\t\t\t\tBYDAY: [calculated.weekday],\n\t\t\t\tBYMONTH: ev.BYMONTH || calculated.month + 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 3,\n\t\t\t\tBYYEARDAY: ev.BYYEARDAY || calculated.yearday,\n\t\t\t},\n\t\t]);\n\t\tthis.PatternSelect.refresh();\n\t\tthis._freq = ev.FREQ;\n\n\t\tev.rec_pattern = ev.BYSETPOS ? 2 : ev.BYYEARDAY ? 3 : 1;\n\t}\n\n\t/**\n\t *\n\t * @param {Object} values - values from the form\n\t */\n\tGetRecPattern(values) {\n\t\tconst data = webix.copy(\n\t\t\tthis.PatternSelect.getList().getItem(values.rec_pattern)\n\t\t);\n\n\t\tif (this._freq === \"MONTHLY\") delete data.BYMONTH;\n\t\tif (data.BYDAY) data.BYDAY = data.BYDAY.map(d => WEEKDAYS[d]).join(\",\");\n\t\tdelete data.id;\n\n\t\treturn data;\n\t}\n\n\t// methods of radio for UNTIL\n\n\t/**\n\t * Returns the config object for the radio with options for setting the end of repetition\n\t * @param {function} _ - the translator method of the Locale plugin\n\t * @returns {Object}\n\t */\n\tCreateRadio(_) {\n\t\tconst selectors = {\n\t\t\twidth: 130,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilDate\",\n\t\t\t\t\talign: \"middle\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\tname: \"untilDate\",\n\t\t\t\t\t\ticons: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"untilCount\",\n\t\t\t\t\tview: \"align\",\n\t\t\t\t\talign: \"bottom\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tname: \"untilCount\",\n\t\t\t\t\t\tview: \"counter\",\n\t\t\t\t\t\tcss: \"webix_scheduler_counter\",\n\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{ view: \"label\", label: _(\"End repeat\") },\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\tname: \"until\",\n\t\t\t\t\t\t\tlocalId: \"until\",\n\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{ id: 1, value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: 2, value: _(\"date\") },\n\t\t\t\t\t\t\t\t{ id: 3, value: _(\"after several occurrences\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\tonChange: v => this.ChangeSelectors(v),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectors,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t/**\n\t * Switches controls for dates or numbers for setting the end of repetition\n\t * @param {(number|string)} v - the value of the radio that sets the type of repetition end (1,2,3)\n\t */\n\tChangeSelectors(v) {\n\t\tthis.UntilDateContainer[v === \"2\" ? \"show\" : \"hide\"]();\n\t\tthis.UntilNumContainer[v === \"3\" ? \"show\" : \"hide\"]();\n\t}\n\n\t/**\n\t * Sets the values of controls that are used to choose the end of repetition\n\t * @param {Object} values - values from the form\n\t */\n\tSetUNTIL(values) {\n\t\tconst start = this._StartDate;\n\t\tvalues.until = values.COUNT ? 3 : values.UNTIL ? 2 : 1;\n\t\tvalues.untilDate = values.UNTIL || webix.Date.add(start, 1, \"year\", true);\n\t\tvalues.untilCount = values.COUNT || this.CountNum(values);\n\t\tthis.UntilDateCalendar.define({ minDate: start });\n\t}\n\n\t/**\n\t * Calculates the number of occurrences based on the end date of repetition (UNTIL)\n\t * @param {Object} values - values from the form\n\t */\n\tCountNum(values) {\n\t\tlet res = 0;\n\n\t\tif (values.UNTIL) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\n\t\t\twhile (date <= values.UNTIL) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t\tres++;\n\t\t\t}\n\t\t} else {\n\t\t\tres = 3;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t// subform methods\n\n\t/**\n\t * Sets values into this form\n\t * @param {Object} event - the event data object\n\t * @param {DateInfo} calculated - calculated constants of a date\n\t * @param {Boolean} silent - if true, the form is marked as 'saved' (containing no unsaved values)\n\t */\n\tSetValues(event, calculated, silent) {\n\t\tif (!calculated) return this.Form.setValues(event, true);\n\n\t\tthis._StartDate = event.start_date;\n\t\tlet values = event.$recurring;\n\n\t\tif (!values) {\n\t\t\tvalues = { FREQ: \"DAILY\" };\n\t\t}\n\n\t\tif (!values.INTERVAL) values.INTERVAL = 1;\n\t\tif (!values.BYDAY) {\n\t\t\tvalues.BYDAY = WEEKDAYS[calculated.weekday];\n\t\t}\n\n\t\t// for a reset\n\t\tif (!values.EXDATE) values.EXDATE = [];\n\n\t\tthis.SetUNTIL(values);\n\t\tthis.SetBYDAY(values);\n\t\tthis.SetPatternOptions(values, calculated);\n\t\tthis.Form.setValues(values, true);\n\t\tif (silent) this.Form.setDirty();\n\t}\n\n\t/**\n\t * Defines the object that stores the recurring pattern, for more details please refer to the iCalendar docs https://icalendar.org/iCalendar-RFC-5545/3-8-5-3-recurrence-rule.html\n\t * @typedef {Object} Recurring\n\t * @property {string} FREQ - the step of repetition: DAILY, WEEKLY, MONTHLY, YEARLY\n\t * @property {(number|string)} INTERVAL - how many steps are between occurrences\n\t * @property {string} BYDAY - week days, e.g. SU,MO,TU,WE,TH,FR,SA\n\t * @property {(number|string)} BYMONTH - the number or a month (1-12)\n\t * @property {(number|string)} BYMONTHDAY - the date (day of a month)\n\t * @property {(number|string)} BYSETPOS - the number of the week day within a month\n\t * @property {string} UNTIL - a date like 19970902T090000\n\t * @property {(number|string)} COUNT - how many times the event repeats\n\t * @property {string} EXDATE - string with 1 or more dates, on which the event does not repeat, e.g. 19960402T010000Z,19960403T010000Z,19960404T010000Z\n\t */\n\n\t/**\n\t * Collects recurrence pattern object from form values and returns it\n\t * @returns {Recurring} the object that stores the recurring pattern\n\t */\n\tGetValues() {\n\t\tlet values = this.Form.getValues();\n\n\t\tlet res = {\n\t\t\tFREQ: values.FREQ,\n\t\t\tINTERVAL: values.INTERVAL,\n\t\t\tUNTIL: values.until == 2 ? values.untilDate : this.GetUntil(values),\n\t\t\tCOUNT: values.until == 3 ? values.untilCount : null,\n\t\t\tEXDATE: values.EXDATE || [],\n\t\t};\n\n\t\tif (values.FREQ === \"WEEKLY\") {\n\t\t\tres.BYDAY = this.GetBYDAY(values);\n\t\t} else if (values.FREQ === \"MONTHLY\" || values.FREQ === \"YEARLY\") {\n\t\t\tres = webix.extend(res, this.GetRecPattern(values));\n\t\t}\n\n\t\tthis.Form.setDirty();\n\n\t\treturn res;\n\t}\n\n\t/**\n\t * Calculates the end of repetition as date based on COUNT\n\t * @param {Object} values - values from the form\n\t * @returns {Date}\n\t */\n\tGetUntil(values) {\n\t\tif (values.until == 3) {\n\t\t\tconst consts = {};\n\t\t\tfillWdays(values, consts);\n\t\t\tlet date = webix.Date.copy(this._StartDate);\n\t\t\tfor (let i = 1; i < values.untilCount; ++i) {\n\t\t\t\tdate = next(date, values, consts);\n\t\t\t}\n\t\t\tdate = webix.Date.add(date, 1, \"day\", true);\n\t\t\tthis.Form.setValues({ untilDate: date }, true);\n\t\t\treturn date;\n\t\t} else return null;\n\t}\n\n\t/**\n\t * Collects all values and sends them to the master form for event update (via global app event)\n\t * @param {string} mode - \"user\" means that the change was made via UI\n\t */\n\tUpdateEvent(mode) {\n\t\tif (mode === \"user\") {\n\t\t\tconst change = this.GetValues();\n\t\t\tthis.app.callEvent(\"form:update:recurring\", [{ $recurring: change }]);\n\t\t\tthis.Form.setDirty();\n\t\t}\n\t}\n\n\t/**\n\t * Checks if this form has changed values\n\t * @returns {Boolean}\n\t */\n\tIsDirty() {\n\t\treturn this.Form.isDirty();\n\t}\n\n\t/**\n\t * Shows this form\n\t */\n\tShow() {\n\t\tthis.getRoot().show();\n\t}\n\n\t/**\n\t * Hides this form\n\t */\n\tHide() {\n\t\tthis.getRoot().hide();\n\t}\n}\n","import {\n\tisFirstOccurrence,\n\tcorrectMode,\n\textractDate,\n\tFREQUENCE,\n\tfillWdays,\n\tnext,\n} from \"./recurring\";\n\n/* public functions */\n\n/**\n * Changes the mode if the user selected the 1st occurrence in whole sequence or in 'next'\n * @param {string} mode - the mode of editing a recurring event (\"all\", \"next\", \"this\")\n * @param {object} obj - the event object\n * @param {Date} start - the start date of the event\n * @param {Date, string} date_id - the ID of an occurrence of a repeated event or the date of this occurrence\n */\nfunction changeMode(mode, obj, start, date_id) {\n\tif (mode && mode === \"next\" && isFirstOccurrence(date_id, start)) {\n\t\tmode = correctMode.call(this, obj, mode);\n\t}\n\n\treturn mode;\n}\n\n/**\n * Corrects recurring.COUNT or recurring.UNTIL based on all sub-events that are included in the edited range\n * @param {Object} obj - the event data\n * @param {string} mode - the mode of recurring editing (\"all\", \"next\")\n * @param {Date} sdate - the date of the currently selected event occurrence\n * @param {Object} collection - DataCollection of events\n */\nfunction correctCountUntil(obj, mode, sdate, collection) {\n\tconst oid = obj.origin_id || obj.$id || obj.id;\n\tconst parts = collection\n\t\t.find(e => {\n\t\t\treturn oid == e.origin_id && sdate < e.start_date;\n\t\t})\n\t\t.sort((a, b) => {\n\t\t\tif (a.start_date > b.start_date) return -1;\n\t\t\tif (a.start_date < b.start_date) return 1;\n\t\t\treturn 0;\n\t\t});\n\n\tconst rec = webix.copy(obj.$recurring);\n\n\tfor (let i = 0, last; i < parts.length; ++i) {\n\t\tlast = parts[i];\n\n\t\tif (last.$recurring) {\n\t\t\tif (last.$recurring.COUNT) {\n\t\t\t\tif (rec.COUNT && obj.$id != last.id) {\n\t\t\t\t\trec.COUNT = rec.COUNT * 1 + last.$recurring.COUNT * 1;\n\t\t\t\t} else {\n\t\t\t\t\trec.UNTIL = countToUntil(last);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trec.UNTIL = last.$recurring.UNTIL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (mode === \"next\" && !parts.length) {\n\t\tif (rec.COUNT) {\n\t\t\trec.COUNT = cutCount(obj, sdate);\n\t\t} else if (rec.UNTIL && obj.start_date >= rec.UNTIL) {\n\t\t\trec.UNTIL = webix.Date.add(\n\t\t\t\twebix.Date.dayStart(obj.start_date),\n\t\t\t\t1,\n\t\t\t\tFREQUENCE[rec.FREQ],\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\treturn rec;\n}\n\n/**\n * Checks if the selected repeating event has only 1 occurrence\n * @param {Object} obj - the event data\n */\nfunction hasOneOccurrence(obj) {\n\t// as this a 'this' event\n\tif (!obj.recurring) return true;\n\n\t// as 'this' any occurrence in unedited sequence\n\tif (!obj.$recurring.UNTIL) return false;\n\n\tconst end = webix.Date.dayStart(webix.Date.add(obj.end_date, 1, \"day\", true));\n\treturn webix.Date.equal(end, obj.$recurring.UNTIL);\n}\n\n/* EO public functions */\n\n/* private functions */\nfunction countToUntil(last) {\n\tconst lr = last.$recurring;\n\tlet step = lr.COUNT * 1; // !\n\tif (lr.FREQ === \"WEEKLY\") {\n\t\tstep = Math.floor((lr.BYDAY.split(\",\").length / 7) * lr.COUNT);\n\t}\n\treturn webix.Date.add(last.start_date, step, FREQUENCE[lr.FREQ], true);\n}\n\nfunction cutCount(obj, sdate) {\n\tconst date = extractDate(sdate);\n\n\tconst consts = {};\n\tfillWdays(obj.$recurring, consts);\n\tlet nexto = webix.Date.dayStart(obj.start_date);\n\tlet count = 0;\n\twhile (nexto < date) {\n\t\tcount++;\n\t\tnexto = next(nexto, obj.$recurring, consts);\n\t}\n\treturn obj.$recurring.COUNT - count;\n}\n/* EO private functions */\n\nexport default function EditRecurringMixin(child) {\n\tchild.ChangeMode = changeMode;\n\tchild.CorrectCountUntil = correctCountUntil;\n\tchild.HasOneOccurrence = hasOneOccurrence;\n}\n","import { JetView } from \"webix-jet\";\nimport getPalette from \"helpers/palette\";\nimport { getYearDay } from \"helpers/dates\";\n\nimport {\n\tWEEKDAYS,\n\tfillWdays,\n\tnext,\n\tdatesToWeekdays,\n\tWeekdaysToDates,\n\tclipSequence,\n\tcutOccurrence,\n\tseparateSequence,\n} from \"helpers/recurring\";\nimport { serialize } from \"helpers/ical\";\nimport RecurringFormView from \"./recurringform\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class EventFormView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst toolbar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\ttooltip: _(\"Close\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Close(),\n\t\t\t\t},\n\t\t\t\t{ view: \"label\", label: _(\"Edit event\") },\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\thotkey: \"Ctrl+Enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst form = {\n\t\t\tview: \"form\",\n\t\t\tlocalId: \"form\",\n\t\t\tscroll: true,\n\t\t\tborderless: true,\n\t\t\tpadding: { right: 14 },\n\t\t\telementsConfig: { labelPosition: \"top\" },\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", label: _(\"Event\"), name: \"text\" },\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.GetDateTime(\"start\", _, aSkin),\n\t\t\t\t\t\tthis.GetDateTime(\"end\", _, aSkin),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"checkbox\",\n\t\t\t\t\tname: \"all_day\",\n\t\t\t\t\tlabelPosition: \"left\",\n\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\tlabelRight: _(\"All Day\"),\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => this.ToggleTimeControls(v),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.CreateCalendarColor(_),\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tlabel: _(\"Notes\"),\n\t\t\t\t\tname: \"details\",\n\t\t\t\t\theight: 150,\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t],\n\t\t\ton: {\n\t\t\t\tonChange: (v, o, m) => {\n\t\t\t\t\t// some fields need preprocessing\n\t\t\t\t\tconst change = this.Form.getDirtyValues();\n\t\t\t\t\tif (Object.keys(change).length) this.PrepareChange(change);\n\t\t\t\t\tif (!this.Compact && m === \"user\")\n\t\t\t\t\t\tthis.Wait(() => this.UpdateEvent(change));\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tif (this.app.config.recurring)\n\t\t\tform.elements.splice(3, 0, this.CreateRepeat(_, aSkin));\n\n\t\tif (this.app.config.units) {\n\t\t\tconst index = this.app.config.recurring ? 5 : 4;\n\t\t\tform.elements.splice(index, 0, this.CreateUnitSelector(_));\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tlet index = this.app.config.recurring ? 5 : 4;\n\t\t\tif (this.app.config.units) index++;\n\t\t\tform.elements.splice(index, 0, this.CreateSectionSelector(_));\n\t\t}\n\n\t\tconst config = {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [toolbar, form],\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.Form = this.$$(\"form\");\n\t\tthis.Local = this.app.getService(\"local\").events(true);\n\t\tthis.Ops = this.app.getService(\"operations\");\n\n\t\t// extending this class with common methods for editing of recurring events\n\t\tEditRecurringMixin(this);\n\n\t\t// most commonly called controls\n\t\tthis.RecurringOptions = this.$$(\"recOption\");\n\t\tthis.StartTime = this.$$(\"startTime\");\n\t\tthis.EndTime = this.$$(\"endTime\");\n\n\t\tthis.on(this.State.$changes, \"readonly\", (_v, o) => {\n\t\t\tif (!webix.isUndefined(o)) this.Close();\n\t\t});\n\n\t\tthis.on(this.app, \"form:update:recurring\", update => {\n\t\t\t// 'update' as imitated dirty value\n\t\t\tif (Object.keys(update).length) this.PrepareChange(update);\n\t\t\tthis.UpdateEvent(update);\n\t\t});\n\n\t\t// parse lists that are not data dependable\n\t\tconst local = this.app.getService(\"local\");\n\t\tif (this.app.config.calendars) {\n\t\t\tthis.Calendars = local.calendars(true);\n\t\t\tthis.$$(\"calendar\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Calendars);\n\t\t}\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = local.units();\n\t\t\tconst combo = this.Form.elements[\"units\"];\n\t\t\twaitUnits.then(units => {\n\t\t\t\tcombo.getList().parse(units);\n\t\t\t\tcombo.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tthis.Sections = local.sections(true);\n\t\t\tthis.$$(\"sections\")\n\t\t\t\t.getList()\n\t\t\t\t.parse(this.Sections);\n\t\t}\n\t}\n\n\tready() {\n\t\tthis.SubForm = this.getSubView(\"recurringForm\");\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.ClearTempEvent(); // support double clicks and 'Create' at any moment\n\t\t\t\tthis.Wait(() => this.FillForm(v));\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy() {\n\t\tthis.ClearTempEvent();\n\t}\n\n\t/**\n\t * Returns the config controls for editing recurring patterns of events\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tCreateRepeat(_, aSkin) {\n\t\tconst rows = [\n\t\t\t{ view: \"label\", label: _(\"Repeat\"), height: aSkin.labelTopHeight },\n\t\t\t{\n\t\t\t\tmargin: 4,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\tlocalId: \"recOption\",\n\t\t\t\t\t\tname: \"rec_option\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{ id: \"none\", value: _(\"never\") },\n\t\t\t\t\t\t\t\t{ id: \"daily\", value: _(\"daily\") },\n\t\t\t\t\t\t\t\t{ id: \"weekly\" },\n\t\t\t\t\t\t\t\t{ id: \"monthly\" },\n\t\t\t\t\t\t\t\t{ id: \"yearly\" },\n\t\t\t\t\t\t\t\t{ id: \"work\", value: _(\"every working day\") },\n\t\t\t\t\t\t\t\t{ id: \"custom\", value: _(\"custom\") },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: (v, o) => this.ToggleSubform(v, o),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\tif (this.Compact) {\n\t\t\trows[1].cols.push({\n\t\t\t\tlocalId: \"editCustomRec\",\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"wxi-pencil\",\n\t\t\t\ttooltip: _(\"Change recurring pattern\"),\n\t\t\t\thidden: true,\n\t\t\t\tclick: () => this.ShowSubForm(),\n\t\t\t});\n\t\t}\n\n\t\trows.push({ $subview: RecurringFormView, name: \"recurringForm\" });\n\n\t\treturn { localId: \"repeatControls\", rows: rows };\n\t}\n\n\t/**\n\t * Hides or shows time selectors\n\t * @param {number} v - the value of 'all day' checkbox (1 or 0)\n\t */\n\tToggleTimeControls(v) {\n\t\tif (v == 1) {\n\t\t\tthis.StartTime.hide();\n\t\t\tthis.EndTime.hide();\n\t\t} else {\n\t\t\tthis.StartTime.show();\n\t\t\tthis.EndTime.show();\n\t\t}\n\t}\n\n\t/**\n\t * Shows or hides the subform for editing recurring pattern; the subform is shown when v is 'custom'\n\t * @param {string} v - the new recurring pattern option\n\t * @param {string} o  - the new recurring pattern option\n\t */\n\tToggleSubform(v, o) {\n\t\tif (v === \"custom\") {\n\t\t\tif (this.Compact) {\n\t\t\t\tthis.$$(\"editCustomRec\").show();\n\t\t\t\tif (o) this.ShowSubForm();\n\t\t\t} else {\n\t\t\t\tthis.SubForm.Show();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.SubForm.Hide();\n\t\t\tif (this.Compact) this.$$(\"editCustomRec\").hide();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateCalendarColor(_) {\n\t\tconst ui = {\n\t\t\tmargin: 8,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"colorpicker\",\n\t\t\t\t\tlabel: _(\"Color\"),\n\t\t\t\t\tname: \"color\",\n\t\t\t\t\tvalue: \"#1abc9c\",\n\t\t\t\t\tsuggest: {\n\t\t\t\t\t\ttype: \"colorboard\",\n\t\t\t\t\t\tpadding: 3,\n\t\t\t\t\t\tbody: getPalette(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tif (this.app.config.calendars) {\n\t\t\tui.cols.unshift({\n\t\t\t\tview: \"richselect\",\n\t\t\t\tlocalId: \"calendar\",\n\t\t\t\tlabel: _(\"Calendar\"),\n\t\t\t\tname: \"calendar\",\n\t\t\t\tcss: \"webix_scheduler_cal_color\",\n\t\t\t\toptions: {\n\t\t\t\t\tcss: \"webix_scheduler_cal_color_suggest\",\n\t\t\t\t\tdata: [],\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttooltip: () => \"\",\n\t\t\t\t\t\ttemplate: function(obj) {\n\t\t\t\t\t\t\tconst active = obj.active * 1;\n\t\t\t\t\t\t\tconst css = active ? \"\" : \"class='webix_scheduler_cal_disabled'\";\n\t\t\t\t\t\t\tconst tooltip = active\n\t\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t\t: `webix_tooltip=\"${_(\"Inactive calendar\")}\"`;\n\n\t\t\t\t\t\t\treturn `<div style=\"overflow: hidden;\" ${tooltip} ${css}>${obj.text ||\n\t\t\t\t\t\t\t\t_(\"(no title)\")}\n\t\t\t\t\t\t\t\t<span class=\"webix_scheduler_cal_marker\" style=\"background-color:${obj.color};\">\n\t\t\t\t\t\t\t</span></div>`;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of two controls: a selector of calendar and event color\n\t * @param {function} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t */\n\tCreateUnitSelector(_) {\n\t\tconst ui = {\n\t\t\tview: \"multicombo\",\n\t\t\tname: \"units\",\n\t\t\tlabel: _(\"Units\"),\n\t\t\toptions: [],\n\t\t};\n\t\treturn ui;\n\t}\n\n\t/**\n\t * Returns the config of controls for selecting date and time\n\t * @param {string} type - \"start\" or \"end\"\n\t * @param {function*} _ - the method of the Locale plugin used to translate labels according to the current locale\n\t * @param {Object} aSkin - stores sizes and colors of a currently active Webix skin\n\t */\n\tGetDateTime(type, _, aSkin) {\n\t\treturn {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\theight: aSkin.labelTopHeight,\n\t\t\t\t\tlabel: type === \"start\" ? _(\"Start\") : _(\"End\"),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 8,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tname: `${type}_date`,\n\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\ttype: \"calendar\",\n\t\t\t\t\t\t\t\ticons: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"datepicker\",\n\t\t\t\t\t\t\tlocalId: `${type}Time`,\n\t\t\t\t\t\t\tname: `${type}_time`,\n\t\t\t\t\t\t\ttype: \"time\",\n\t\t\t\t\t\t\tformat: \"%H:%i\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tCreateSectionSelector(_) {\n\t\treturn {\n\t\t\tlocalId: \"sections\",\n\t\t\tview: \"richselect\",\n\t\t\tlabel: _(\"Section\"),\n\t\t\tname: \"section\",\n\t\t\toptions: {\n\t\t\t\tdata: [],\n\t\t\t\tbody: {\n\t\t\t\t\ttemplate: \"#text#\",\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t// general form tasks\n\n\t/**\n\t * Fills the form with relevant values for editing of a selected event or adding a new event\n\t * @param {Object} ev - the current state.selected\n\t */\n\tFillForm(ev) {\n\t\tthis.Id = ev.id;\n\n\t\tthis.Form.focus();\n\t\tthis.Date = ev.date;\n\t\tif (typeof this.Date === \"string\") {\n\t\t\tthis.Date = new Date(this.Date.slice(0, this.Date.indexOf(\"_\")) * 1);\n\t\t}\n\n\t\tlet obj;\n\n\t\t// new record or a new copy of a record\n\t\tif (ev.id == \"0\") {\n\t\t\tif (this.State.clipboard && this.State.clipboard.selected) {\n\t\t\t\tobj = this.State.clipboard.selected;\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t} else {\n\t\t\t\tobj = this.NewEvent(ev);\n\t\t\t}\n\n\t\t\tif (obj.then) {\n\t\t\t\treturn obj.then(res => {\n\t\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(res) });\n\t\t\t\t\tthis.FillFormContinue(res);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.Local.add({ id: ev.id, ...webix.copy(obj) });\n\t\t\t}\n\t\t} else {\n\t\t\tobj = webix.copy(this.Local.getItem(ev.id));\n\n\t\t\tconst mode = this.getParam(\"mode\", true);\n\t\t\tif (mode) obj = this.AdaptObjToMode(mode, obj);\n\t\t}\n\n\t\tthis.FillFormContinue(obj);\n\t}\n\n\t/**\n\t * Fills the event object with relevant values according to the mode of editing\n\t * @param {string} mode - mode in which a recurring event will be edited (\"all\", \"next\", \"this\")\n\t * @param {Object} obj - event data\n\t */\n\tAdaptObjToMode(mode, obj) {\n\t\tmode = this.ChangeMode(\n\t\t\tmode,\n\t\t\tobj,\n\t\t\tobj.recurring\n\t\t\t\t? obj.start_date\n\t\t\t\t: this.Local.getItem(obj.origin_id).start_date,\n\t\t\tobj.recurring ? this.State.selected.date : obj.start_date\n\t\t);\n\t\tthis.setParam(\"mode\", mode, true);\n\n\t\tif (mode === \"all\" || mode === \"next\") {\n\t\t\tif (mode === \"all\" && obj.origin_id) {\n\t\t\t\tobj = webix.copy(this.Local.getItem(obj.origin_id));\n\t\t\t}\n\n\t\t\t// if this is a \"this\" sub-event\n\t\t\tif (!obj.$recurring)\n\t\t\t\tobj.$recurring = webix.copy(\n\t\t\t\t\tthis.Local.getItem(obj.origin_id).$recurring\n\t\t\t\t);\n\n\t\t\tif (obj.$recurring.COUNT || obj.$recurring.UNTIL) {\n\t\t\t\t// [FIXME] maybe need to store total UNTIL/COUNT on backend (mostly for dynamic loading)\n\t\t\t\tobj.$recurring = this.CorrectCountUntil(\n\t\t\t\t\tobj,\n\t\t\t\t\tmode,\n\t\t\t\t\tobj.start_date,\n\t\t\t\t\tthis.Local\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (mode === \"this\" || mode === \"next\") {\n\t\t\t// split event sequence or cut out an occurrence\n\t\t\tif (this.State.selected.date)\n\t\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\n\t\t\tif (mode === \"this\") {\n\t\t\t\tobj.$recurring = null;\n\t\t\t\tobj.recurring = \"\";\n\t\t\t\tthis.$$(\"repeatControls\").hide();\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Splits start and end dates into date and time parts and fills the form with values\n\t * @param {Object} obj - the event data\n\t */\n\tFillFormContinue(obj) {\n\t\tobj.start_time = webix.Date.copy(obj.start_date);\n\t\tobj.end_time = webix.Date.copy(obj.end_date);\n\n\t\tobj.start_date = webix.Date.datePart(obj.start_date);\n\t\tobj.end_date = webix.Date.datePart(obj.end_date);\n\n\t\tif (this.app.config.recurring) this.SetRecurring(obj);\n\n\t\tthis.Form.setValues(obj);\n\t}\n\n\t/**\n\t * Describes calculated constants of a date\n\t * @typedef {Object} DateInfo\n\t * @property {number} day - the date (day of month)\n\t * @property {number} weekday - the number of a weekday (0-6)\n\t * @property {number} month - the number of month (0-11)\n\t * @property {number} weekNum - the number of a weekday within a month (e.g. 4th Friday)\n\t */\n\n\t/**\n\t * Calculates constants related to the start date of an event\n\t * @param {Date} start - the start date of an event\n\t * @returns {DateInfo}\n\t */\n\tGetFromStartDate(start) {\n\t\tconst res = {\n\t\t\tweekday: start.getDay(),\n\t\t\tday: start.getDate(),\n\t\t\tmonth: start.getMonth(),\n\t\t\tyearday: getYearDay(start),\n\t\t};\n\t\tres.weekNum = Math.floor(res.day / 7) + (res.day % 7 ? 1 : 0);\n\t\treturn res;\n\t}\n\n\t/**\n\t * Sets controls and their values for recurring patterns\n\t * @param {Object} obj - the event data\n\t */\n\tSetRecurring(obj) {\n\t\tconst today = this.GetFromStartDate(obj.start_date);\n\t\tconst roptions = this.ResetRecurringOptions(today);\n\t\tthis.RecurringOptions.getList().parse(roptions);\n\n\t\tthis.SubForm.SetValues(webix.copy(obj), today, true);\n\n\t\tif (!obj.$recurring) {\n\t\t\tobj.rec_option = \"none\";\n\t\t} else if (obj.$recurring.BYDAY === \"MO,TU,WE,TH,FR\") {\n\t\t\tobj.rec_option = \"work\";\n\t\t} else if (\n\t\t\t!obj.$recurring.UNTIL &&\n\t\t\t!obj.$recurring.COUNT &&\n\t\t\t(!obj.$recurring.INTERVAL || obj.$recurring.INTERVAL == 1) &&\n\t\t\t(obj.$recurring.FREQ === \"DAILY\" ||\n\t\t\t\t(obj.$recurring.FREQ === \"WEEKLY\" &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"MONTHLY\" &&\n\t\t\t\t\tobj.$recurring.BYSETPOS &&\n\t\t\t\t\tobj.$recurring.BYSETPOS == today.weekNum &&\n\t\t\t\t\tobj.$recurring.BYDAY == WEEKDAYS[today.weekday]) ||\n\t\t\t\t(obj.$recurring.FREQ === \"YEARLY\" &&\n\t\t\t\t\tobj.$recurring.BYMONTH == today.month + 1 &&\n\t\t\t\t\tobj.$recurring.BYMONTHDAY == today.day))\n\t\t) {\n\t\t\tobj.rec_option = obj.$recurring.FREQ.toLowerCase();\n\t\t} else {\n\t\t\tobj.rec_option = \"custom\";\n\t\t}\n\t}\n\n\t/**\n\t * Returns date-dependent options for recurring pattern select list\n\t * @param {Date} start - the start date of an event\n\t */\n\tResetRecurringOptions(start) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: \"weekly\",\n\t\t\t\tvalue: `${_(\"weekly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"monthly\",\n\t\t\t\tvalue: `${_(\"monthly, every\")} ${start.weekNum} ${_(\"week on\")} ${\n\t\t\t\t\twebix.i18n.calendar.dayFull[start.weekday]\n\t\t\t\t}`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"yearly\",\n\t\t\t\tvalue: `${_(\"yearly, every\")} ${\n\t\t\t\t\twebix.i18n.calendar.monthFull[start.month]\n\t\t\t\t} ${start.day}`,\n\t\t\t},\n\t\t];\n\t}\n\n\t/**\n\t * Joins date and time into one Date object\n\t * @param {Date} date - a date without a time part\n\t * @param {Date} time - a date with a time part\n\t */\n\tJoin(date, time) {\n\t\treturn webix.Date.add(date, webix.Date.timePart(time) / 60, \"minute\", true);\n\t}\n\n\t/**\n\t * Returns an object with values for adding a new event\n\t * @param {Object} params - current state.selected property\n\t */\n\tNewEvent(params) {\n\t\tconst start = this.GetStartDate();\n\t\tconst end =\n\t\t\tthis.State.selected.end_date || webix.Date.add(start, 1, \"hour\", true);\n\n\t\tconst obj = {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\ttext: \"\",\n\t\t\tdetails: \"\",\n\t\t};\n\t\tif (this.app.config.recurring) obj.recurring = \"\";\n\t\tif (this.app.config.timeline) {\n\t\t\tobj.section = params.section || this.Sections.getFirstId();\n\t\t}\n\n\t\tif (this.app.config.calendars) {\n\t\t\tlet active = this.State.active[0];\n\t\t\tif (!active) {\n\t\t\t\tconst first = this.Calendars.getFirstId();\n\t\t\t\tconst wait = first\n\t\t\t\t\t? this.Ops.updateCalendar(first, { active: 1 })\n\t\t\t\t\t: this.Ops.addCalendar();\n\n\t\t\t\treturn wait.then(() => {\n\t\t\t\t\tobj.calendar = this.State.active[0];\n\t\t\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t\t\t\treturn obj;\n\t\t\t\t});\n\t\t\t}\n\t\t\tobj.calendar = active;\n\t\t\tobj.$color = this.Calendars.getItem(obj.calendar).color;\n\t\t} else obj.$color = \"#01C2A5\"; //same for default color in datacollection\n\n\t\tif (this.app.config.calendars && params.unit) {\n\t\t\tobj.units = params.unit;\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Returns a start date of a new object based on:\n\t * 1) the origin of the double click of the user\n\t * 2) the current date and time\n\t */\n\tGetStartDate() {\n\t\tif (this.Date) {\n\t\t\treturn webix.Date.copy(this.Date);\n\t\t} else {\n\t\t\tconst date = new Date();\n\t\t\tconst minutes = Math.ceil(date.getMinutes() / 30) * 30;\n\t\t\tconst res = webix.Date.copy(this.State.date);\n\t\t\tres.setHours(date.getHours(), minutes);\n\t\t\treturn res;\n\t\t}\n\t}\n\n\t/**\n\t * Launches saving of changes made in the form\n\t * @param {Object} change - an object with changed values\n\t */\n\tUpdateEvent(change) {\n\t\t// clear 'dirty' flag so that next change will definitely be 'dirty'\n\t\tthis.Form.setDirty();\n\n\t\tif (this.Id === \"0\") {\n\t\t\tconst data = this.PrepareOut(change);\n\t\t\tthis._inProgress = this.Ops.addEvent(data, true, this.Id);\n\t\t} else if (Object.keys(change).length) {\n\t\t\tthis._inProgress = this.UpdateExisting(this.Id, change);\n\t\t}\n\n\t\tif (this._inProgress) {\n\t\t\tthis.app.callEvent(\"backend:operation\", [this._inProgress]);\n\t\t\tthis._inProgress\n\t\t\t\t.then(id => {\n\t\t\t\t\tif (id) this.UpdateSelection(id);\n\n\t\t\t\t\t// make event visible if new dates are outside currently selected dates\n\t\t\t\t\tthis.ChangeDate(change, this.Form.getValues());\n\n\t\t\t\t\t// continue editing in simple mode\n\t\t\t\t\tthis.setParam(\"mode\", \"\", true);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis._inProgress = null;\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._inProgress || webix.promise.resolve();\n\t}\n\n\t/**\n\t * Updates an existing event\n\t * @param {(string|number)} sid - the ID of the event\n\t * @param {Object} change - the new data\n\t * @returns {Promise}\n\t */\n\tUpdateExisting(sid, change) {\n\t\tlet mode = this.getParam(\"mode\", true);\n\t\tconst obj = this.Local.getItem(sid);\n\n\t\tif ((mode === \"this\" && !this.HasOneOccurrence(obj)) || mode === \"next\") {\n\t\t\t// cut out occurrence or split event sequence and save as separate events\n\t\t\tchange.origin_id = obj.origin_id || obj.id;\n\t\t\tconst newEvent = this.PrepareOut(change);\n\n\t\t\tlet recurring = \"\";\n\t\t\tif (mode === \"this\") {\n\t\t\t\trecurring = cutOccurrence(this.State.selected.date, obj);\n\t\t\t} else {\n\t\t\t\tlet params;\n\t\t\t\tif (obj.recurring) {\n\t\t\t\t\tparams = [this.State.selected.date, obj];\n\t\t\t\t} else {\n\t\t\t\t\tsid = obj.origin_id;\n\t\t\t\t\tparams = [newEvent.start_date, this.Local.getItem(sid)];\n\t\t\t\t}\n\t\t\t\trecurring = clipSequence(...params);\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(\n\t\t\t\tsid,\n\t\t\t\t{ recurring },\n\t\t\t\tmode,\n\t\t\t\twebix.Date.dayStart(newEvent.start_date),\n\t\t\t\ttrue\n\t\t\t).then(() => {\n\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\treturn this.Ops.addEvent(newEvent, true);\n\t\t\t});\n\t\t} else {\n\t\t\t// non-recurring and recurring in mode \"all\"\n\n\t\t\tif (mode === \"all\") {\n\t\t\t\tconst recVals = this.Form.getValues().$recurring;\n\t\t\t\tif (recVals && webix.isUndefined(change.recurring)) {\n\t\t\t\t\tdelete recVals.EXDATE;\n\t\t\t\t\tchange.recurring = serialize(recVals); // plus all that's been updated in form silently in FillForm\n\n\t\t\t\t\tthis.Form.setValues(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$recurring: recVals,\n\t\t\t\t\t\t\trecurring: change.recurring,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t\tthis.SubForm.SetValues({ EXDATE: null });\n\t\t\t\t}\n\n\t\t\t\tif (obj.origin_id) this.Id = this.State.selected.id = obj.origin_id;\n\t\t\t}\n\n\t\t\treturn this.Ops.updateEvent(this.Id, change, mode, undefined, true).then(\n\t\t\t\t() => {\n\t\t\t\t\tif (change.rec_option === \"none\") this.State.selected.date = null;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * if event was saved as new, update selected silently to avoid triggering listeners\n\t * @param {(string|number)} id - the ID of the event\n\t */\n\tUpdateSelection(id) {\n\t\tthis.State.selected.id = this.Id = id;\n\t\tconst sdate = this.State.selected.date;\n\t\tif (sdate instanceof Date) {\n\t\t\tthis.State.selected.date = null;\n\t\t} else if (sdate) {\n\t\t\tconst fvals = this.Form.getValues();\n\t\t\tthis.State.selected.date =\n\t\t\t\tthis.Join(fvals.start_date, fvals.start_time).valueOf() + \"_\" + id;\n\t\t}\n\t}\n\n\t/**\n\t * Processes changes made in the form and prepares values for saving to the server\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareChange(change) {\n\t\tif (change.rec_option) this.ProcessRecurringOption(change);\n\t\telse if (!webix.isUndefined(change.$recurring)) {\n\t\t\tthis.ProcessRecurringPattern(change);\n\t\t}\n\n\t\tthis.ProcessDates(change);\n\n\t\tif (this.app.config.recurring && change.start_date)\n\t\t\tthis.ApplyDatechangeToRecurring(change);\n\n\t\tthis.ProcessText(change, \"text\");\n\t\tthis.ProcessText(change, \"details\");\n\n\t\tthis._changedValues = change;\n\t}\n\n\t/**\n\t * Gets recurring pattern according to the new recurring option\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringOption(change) {\n\t\tconst fvals = this.Form.getValues();\n\n\t\tif (change.rec_option === \"none\") {\n\t\t\tchange.recurring = \"\";\n\t\t\tchange.series_end_date = \"\";\n\t\t} else if (change.rec_option === \"custom\") {\n\t\t\tif (fvals.$recurring) {\n\t\t\t\tthis.SubForm.SetValues(\n\t\t\t\t\t{ ...fvals, ...change },\n\t\t\t\t\tthis.GetFromStartDate(fvals.start_date)\n\t\t\t\t);\n\t\t\t}\n\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\tthis.ProcessRecurringPattern(change);\n\n\t\t\tif (!fvals.$recurring) {\n\t\t\t\tthis.Form.setValues({ $recurring: change.$recurring }, true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.GetRecurring(change.rec_option, change, fvals.start_date);\n\t\t\tchange.series_end_date = \"\";\n\t\t}\n\n\t\tdelete change.rec_option;\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Serializes recurring pattern object and synchronizes dates with the new pattern\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessRecurringPattern(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst recurring = serialize(change.$recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.recurring = recurring;\n\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\n\t\t\tif (change.$recurring.BYDAY) {\n\t\t\t\t[change.start_date, change.end_date] = datesToWeekdays(\n\t\t\t\t\tfvals.start_date,\n\t\t\t\t\tfvals.end_date,\n\t\t\t\t\tchange.$recurring\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.Form.setValues(change, true);\n\t\t}\n\t\tdelete change.$recurring;\n\t}\n\n\t/**\n\t * Sums up dates and time depending on the changes in dates, time and all_day flag\n\t * @param {Object} change - an object with changed values\n\t */\n\tProcessDates(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tif (webix.isUndefined(change.all_day)) {\n\t\t\tif ((change.start_date || change.start_time) && fvals.all_day == 0) {\n\t\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\t}\n\t\t\tif ((change.end_date || change.end_time) && fvals.all_day == 0) {\n\t\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t\t}\n\t\t} else if (change.all_day == 1) {\n\t\t\tchange.start_date = fvals.start_date;\n\t\t\tchange.end_date = fvals.end_date;\n\t\t} else if (change.all_day == 0) {\n\t\t\tchange.start_date = this.Join(fvals.start_date, fvals.start_time);\n\t\t\tchange.end_date = this.Join(fvals.end_date, fvals.end_time);\n\t\t}\n\n\t\tif (change.start_date || change.end_date) this.CorrectDateTime(change);\n\t}\n\n\t/**\n\t * Corrects the unchanged field if start > end or end < start\n\t * @param {Object} change - an object with changed values\n\t */\n\tCorrectDateTime(change) {\n\t\tconst fvals = this.Form.getValues();\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\t\tconst ev_length = (old.end_date - old.start_date) / 1000 / 60; // minutes\n\n\t\tconst type = change.start_date ? \"start\" : \"end\";\n\t\tconst opposite = type === \"start\" ? \"end\" : \"start\";\n\n\t\tconst start = change.start_date || old.start_date;\n\t\tconst end = change.end_date || old.end_date;\n\n\t\tif ((start >= end && !fvals.all_day) || start > end) {\n\t\t\tchange[opposite + \"_date\"] = webix.Date.add(\n\t\t\t\tchange[type + \"_date\"],\n\t\t\t\t(type === \"start\" ? 1 : -1) * (ev_length || 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\t// apply also to form\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\tstart_date: webix.Date.datePart(change.start_date, true),\n\t\t\t\t\tend_date: webix.Date.datePart(change.end_date, true),\n\t\t\t\t\tstart_time: change.start_time || webix.Date.copy(change.start_date),\n\t\t\t\t\tend_time: change.end_time || webix.Date.copy(change.end_date),\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tdelete change.start_time;\n\t\tdelete change.end_time;\n\t}\n\n\t/**\n\t * Removes trailing spaces from input text\n\t * @param {Object} change - an object with changed values\n\t * @param {string} field - the name of a text field ('text', 'details')\n\t */\n\tProcessText(change, field) {\n\t\tif (!this.webix.isUndefined(change[field])) {\n\t\t\tchange[field] = change[field].replace(/(<[^>]+>|^\\s+|\\s+$)/gi, \"\");\n\t\t\tconst prev = this.Local.getItem(this.State.selected.id)[field] || \"\";\n\t\t\tif (change[field] === prev.trim()) delete change[field];\n\t\t}\n\t}\n\n\t/**\n\t * Synchronizes recurring pattern with new start date\n\t * @param {Object} change - an object with changed values\n\t */\n\tApplyDatechangeToRecurring(change) {\n\t\tconst today = this.GetFromStartDate(change.start_date);\n\t\t// if date was changed after subform change, ignore\n\t\tconst fvals = this.Form.getValues();\n\t\tif (!change.recurring && fvals.$recurring) {\n\t\t\tif (fvals.rec_option === \"custom\") {\n\t\t\t\tconst recurring = fvals.$recurring;\n\n\t\t\t\tif (recurring.BYYEARDAY) {\n\t\t\t\t\trecurring.BYYEARDAY = today.yearday;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTH) {\n\t\t\t\t\trecurring.BYMONTH = today.month + 1;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYMONTHDAY) {\n\t\t\t\t\trecurring.BYMONTHDAY = today.day;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYSETPOS) {\n\t\t\t\t\trecurring.BYSETPOS = today.weekNum;\n\t\t\t\t}\n\t\t\t\tif (recurring.BYDAY) {\n\t\t\t\t\trecurring.BYDAY = WeekdaysToDates(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tfvals.$recurring\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (recurring.UNTIL && recurring.UNTIL < change.start_date) {\n\t\t\t\t\tconst oldStart = this.Local.getItem(this.State.selected.id)\n\t\t\t\t\t\t.start_date;\n\t\t\t\t\tconst length = (fvals.$recurring.UNTIL - oldStart) / 1000 / 60; // minutes\n\t\t\t\t\trecurring.UNTIL = webix.Date.add(\n\t\t\t\t\t\tchange.start_date,\n\t\t\t\t\t\tlength,\n\t\t\t\t\t\t\"minute\",\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tchange.recurring = serialize(recurring);\n\n\t\t\t\tthis.SubForm.SetValues({ ...fvals, ...change }, today);\n\t\t\t} else {\n\t\t\t\tthis.GetRecurring(fvals.rec_option, change, fvals.start_date);\n\t\t\t\tdelete change.$recurring;\n\t\t\t}\n\t\t}\n\t\tthis.RecurringOptions.getList().parse(this.ResetRecurringOptions(today));\n\t\tthis.RecurringOptions.refresh();\n\t}\n\n\t/**\n\t * Assigns recurring pattern according to a preset\n\t * @param {string} r the ID of a recurring pattern option\n\t * @param {Object} change - an object with changed values\n\t * @param {Date} start - the start date of the event\n\t */\n\tGetRecurring(r, change, start) {\n\t\tlet $recurring = this.GetRecurringPreset(r, start);\n\n\t\tif (r === \"work\" && change.start_date) {\n\t\t\tconst BYDAY = WeekdaysToDates(change.start_date, $recurring);\n\t\t\tif ($recurring.BYDAY !== BYDAY) {\n\t\t\t\t$recurring.BYDAY = BYDAY;\n\t\t\t\tr = \"custom\";\n\t\t\t}\n\t\t}\n\n\t\tconst recurring = serialize($recurring);\n\t\tconst old = this.Local.getItem(this.State.selected.id);\n\n\t\t// check if switch from a preset to custom and back and the pattern is the same\n\t\tif (!old || recurring !== old.recurring) {\n\t\t\tchange.$recurring = $recurring;\n\t\t\tchange.recurring = recurring;\n\t\t\tthis.Form.setValues(\n\t\t\t\t{\n\t\t\t\t\t$recurring: change.$recurring,\n\t\t\t\t\trecurring,\n\t\t\t\t\trec_option: r,\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Gets a recurring pattern object for a pattern preset based on the start date of the event\n\t * @param {string} r - a recurring option (accepted values: \"daily\", \"weekly\", \"work\", \"monthly\", \"yearly\")\n\t * @param {Date} start - the start date of an event\n\t * @returns {Object} - $recurring\n\t */\n\tGetRecurringPreset(r, start) {\n\t\tconst today = this.GetFromStartDate(start);\n\t\tswitch (r) {\n\t\t\tcase \"daily\":\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t\tcase \"weekly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"work\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"WEEKLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYDAY: \"MO,TU,WE,TH,FR\",\n\t\t\t\t};\n\t\t\tcase \"monthly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"MONTHLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYSETPOS: today.weekNum,\n\t\t\t\t\tBYDAY: WEEKDAYS[today.weekday],\n\t\t\t\t};\n\t\t\tcase \"yearly\":\n\t\t\t\treturn {\n\t\t\t\t\tFREQ: \"YEARLY\",\n\t\t\t\t\tINTERVAL: 1,\n\t\t\t\t\tBYMONTH: today.month + 1,\n\t\t\t\t\tBYMONTHDAY: today.day,\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn { FREQ: \"DAILY\", INTERVAL: 1 };\n\t\t}\n\t}\n\n\t/**\n\t * Switches Scheduler to another date if the event after change is no longer visible\n\t * @param {Object} dirty - an object with changed values\n\t * @param {Object} fvals - an object with all current form values\n\t */\n\tChangeDate(dirty, fvals) {\n\t\tif (dirty) {\n\t\t\t// start date of non-repeating event changed or repeating event became non-repeating\n\t\t\tif ((dirty.start_date && !fvals.recurring) || dirty.recurring === \"\") {\n\t\t\t\tthis.State.selected.date = null;\n\t\t\t\tthis.UpdateStateDate(dirty.start_date || fvals.start_date);\n\t\t\t} else if (dirty.start_date || dirty.recurring) {\n\t\t\t\tconst date = this.GetClosestOccurrenceDate(dirty, fvals);\n\t\t\t\tthis.State.selected.date =\n\t\t\t\t\tdate.valueOf() + \"_\" + this.State.selected.id;\n\t\t\t\tthis.UpdateStateDate(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns the next closest occurrence date when dates or recurring pattern of an event was changed\n\t * @param {Object} dirty - an object with changed data\n\t * @param {Object} fvals - an object of all event form values\n\t * @returns {Date} the date of the next closest occurrence\n\t */\n\tGetClosestOccurrenceDate(dirty, fvals) {\n\t\tlet date = dirty.start_date\n\t\t\t? webix.Date.copy(dirty.start_date)\n\t\t\t: this.Join(fvals.start_date, fvals.start_time);\n\t\tlet end = webix.Date.dayStart(\n\t\t\tthis.State.selected.date\n\t\t\t\t? new Date(this.State.selected.date.split(\"_\")[0] * 1)\n\t\t\t\t: date\n\t\t);\n\t\tif (fvals.series_end_date) {\n\t\t\tend = new Date(\n\t\t\t\tMath.min(webix.Date.add(fvals.series_end_date, -1, \"day\", true), end)\n\t\t\t);\n\t\t}\n\n\t\tconst consts = {};\n\t\tfillWdays(fvals.$recurring, consts);\n\t\tlet temp = webix.Date.copy(date);\n\t\twhile (webix.Date.dayStart(temp) < end) {\n\t\t\ttemp = next(temp, fvals.$recurring, consts);\n\t\t\tif (Math.abs(end - temp) < Math.abs(end - date)) {\n\t\t\t\tdate = webix.Date.copy(temp);\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t}\n\n\t/**\n\t * Updates state.date according to state.mode\n\t * @param {Date} date - new state.date\n\t */\n\tUpdateStateDate(date) {\n\t\tdate = webix.Date.dayStart(date);\n\t\tconst state = this.State;\n\t\tif (\n\t\t\tstate.mode === \"day\" ||\n\t\t\tstate.mode === \"units\" ||\n\t\t\t(state.mode === \"timeline\" && state.timelineMode === \"day\")\n\t\t) {\n\t\t\tconst sdate = webix.Date.dayStart(state.date);\n\t\t\tif (!webix.Date.equal(date, sdate)) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t} else {\n\t\t\tconst { start, end } = this.GetModeBounds();\n\t\t\tif (date < start || date >= end) {\n\t\t\t\tstate.date = webix.Date.dayStart(date);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns start and end dates of a currently displayed period\n\t */\n\tGetModeBounds() {\n\t\tconst state = this.State;\n\t\tlet mode = state.mode;\n\t\tif (mode === \"timeline\") mode = state.timelineMode;\n\t\telse if (mode === \"agenda\") mode = \"month\";\n\t\tlet start = webix.Date[mode + \"Start\"](state.date);\n\t\tlet end = webix.Date.add(start, 1, mode, true);\n\n\t\tif (state.mode === \"month\") {\n\t\t\tstart = webix.Date.weekStart(start);\n\t\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\t\t}\n\n\t\treturn { start, end };\n\t}\n\n\t/**\n\t * Unites changed and unchanged fields into 1 object for saving newly added events\n\t * @param {Object} change - an object with changed values\n\t */\n\tPrepareOut(change) {\n\t\tlet obj = this.Form.getValues();\n\n\t\tif (!obj.all_day) {\n\t\t\tobj.start_date = this.Join(obj.start_date, obj.start_time);\n\t\t\tobj.end_date = this.Join(obj.end_date, obj.end_time);\n\t\t}\n\n\t\tobj = webix.extend(obj, change || {}, true);\n\n\t\tif (!(change && change.recurring) && obj.$recurring) {\n\t\t\tobj.$recurring.EXDATE = [];\n\t\t\tobj.recurring = serialize(obj.$recurring);\n\t\t}\n\n\t\tif (!obj.origin_id) obj.origin_id = 0;\n\n\t\t// go backend wants a number\n\t\tif (this.app.config.timeline && !obj.section) obj.section = 0;\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Removes a temporary local event\n\t */\n\tClearTempEvent() {\n\t\tconst sid = this.Id;\n\t\tif (sid === \"0\" && this.Local.exists(sid)) {\n\t\t\tthis.Local.remove(sid);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form and either the whole right panel with it or returns to Info\n\t * @param {boolean} close - if true, the right panel is closed\n\t */\n\tBack(close) {\n\t\tthis.Form.clear();\n\n\t\tif (close || this.State.selected.id === \"0\") {\n\t\t\tthis.State.selected = null;\n\t\t} else {\n\t\t\tconst path = this.Compact ? \"event.formpopup/\" : \"../\";\n\t\t\tthis.show(path + \"event.info\", { target: \"edit\" });\n\t\t}\n\t}\n\n\t/**\n\t * Closes the right panel\n\t */\n\tClose() {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t\t} else {\n\t\t\tconst dirty =\n\t\t\t\tthis.Form.isDirty() || (this.Subform && this.SubForm.IsDirty());\n\t\t\tif (this.Compact && dirty) {\n\t\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\t\twebix\n\t\t\t\t\t.confirm({\n\t\t\t\t\t\ttext: _(\"Save changes?\"),\n\t\t\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.Done(true))\n\t\t\t\t\t.catch(() => this.Back(true));\n\t\t\t} else this.Back(true);\n\t\t}\n\t}\n\n\t/**\n\t * Closes the form\n\t * @param {boolean} close\n\t */\n\tDone(close) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(() => {\n\t\t\t\tthis.Back();\n\t\t\t});\n\t\t} else if (this.State.selected.id === \"0\" || this.Compact) {\n\t\t\tlet change = {};\n\t\t\tif (this.Compact) {\n\t\t\t\tif (this._changedValues) change = this._changedValues;\n\n\t\t\t\tif (this.SubForm.IsDirty()) {\n\t\t\t\t\tchange.$recurring = this.SubForm.GetValues();\n\t\t\t\t\tchange.series_end_date = change.$recurring.UNTIL;\n\t\t\t\t\tdelete change.rec_option;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.UpdateEvent(change).then(() => this.Back(close));\n\t\t} else {\n\t\t\tthis.Back();\n\t\t}\n\t}\n\n\t/**\n\t * Waits until some asynchronous operation finishes (if there's any) and then executes 'handler'\n\t * @param {function} handler - the code that will be executed\n\t */\n\tWait(handler) {\n\t\tif (this._inProgress) {\n\t\t\tthis._inProgress.then(handler);\n\t\t} else {\n\t\t\thandler.call();\n\t\t}\n\t}\n\n\t// compact\n\n\t/**\n\t * Shows a subform with controls for editing recurring pattern in a window\n\t */\n\tShowSubForm() {\n\t\tthis.SubForm.Show();\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst subform = this.SubForm.getRoot();\n\n\t\tconst aSkin = webix.skin.$active;\n\t\twebix.fullscreen.set(subform, {\n\t\t\thead: {\n\t\t\t\tview: \"toolbar\",\n\t\t\t\tpadding: {\n\t\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\t\tright: 14,\n\t\t\t\t},\n\t\t\t\telements: [\n\t\t\t\t\t{ view: \"icon\", icon: \"shi-back\", click: () => this.HideSubPop() },\n\t\t\t\t\t{ view: \"label\", label: _(\"Change recurring pattern\") },\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\tvalue: _(\"Done\"),\n\t\t\t\t\t\twidth: 130,\n\t\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\t\tclick: () => this.HideSubPop(),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst win = subform.getTopParentView();\n\t\twin.define({ css: \"webix_scheduler_subform_popup\" });\n\t}\n\n\t/**\n\t * Hides the window with the subform\n\t */\n\tHideSubPop() {\n\t\tthis.SubForm.Hide();\n\t\twebix.fullscreen.exit();\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class FormPopup extends JetView {\n\tconfig() {\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\tfullscreen: true,\n\t\t\thead: false,\n\t\t\tbody: { $subview: true },\n\t\t});\n\t}\n}\n","import { cutOccurrence } from \"helpers/recurring\";\nimport hotkey from \"jet-hotkey\";\n\n/**\n * Common function used to prepare data of a copied event\n * @param {Object} newEvent\n */\nexport function cleanEventData(newEvent) {\n\t// in recurring event, copy only this event and make sure it stays a part of the series\n\tconst isRecurring = newEvent.recurring || newEvent.$id || newEvent.origin_id;\n\tif (isRecurring) {\n\t\tnewEvent.recurring = \"\";\n\t\tdelete newEvent.$recurring;\n\t\tif (!newEvent.origin_id) newEvent.origin_id = newEvent.$id || newEvent.id;\n\n\t\tdelete newEvent.$id;\n\t}\n\n\tdelete newEvent.id;\n\n\tconst _ = this.app.getService(\"locale\")._;\n\tif (newEvent.text)\n\t\tnewEvent.text = `${_(\"Copy of\")} ${newEvent.text.replace(\n\t\t\t`${_(\"Copy of\")} `,\n\t\t\t\"\"\n\t\t)}`;\n}\n\n/** CopyPaste Mixin adds logic for copying and cutting events with hotkeys */\n\n/**\n * Handles events related to copying, cutting and pasting events (desktop devices)\n * @param {Object} view - a Webix data widget that is used to display events\n */\nfunction HandleCopyPaste(view) {\n\tthis.clipboardModes = [\"copy\", \"cut\"];\n\tthis.Ops = this.app.getService(\"operations\");\n\tconst ctrlKey = webix.env.isMac ? \"COMMAND\" : \"CTRL\";\n\t// when form is opened, hotkeys do not work because focus is on form, not on view\n\tthis.on(hotkey(view), `${ctrlKey}+C`, v => this.AddToClipboard(v, \"copy\"));\n\tthis.on(hotkey(view), `${ctrlKey}+X`, v => this.AddToClipboard(v, \"cut\"));\n\tthis.on(hotkey(view), `${ctrlKey}+V`, (v, e) => this.PasteFromClipboard(e));\n\tthis.on(hotkey(view), \"Esc\", (v, e) => this.PurgeClipboard(v, e));\n\n\tthis.on(this.State.$changes, \"mode\", () => {\n\t\twebix.UIManager.setFocus(view);\n\t});\n\n\tthis.on(this.State.$changes, \"clipboard\", (v, o) => {\n\t\tif (v) {\n\t\t\twebix.html.addCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t} else if (o) {\n\t\t\twebix.html.removeCss(view.$view, \"webix_scheduler_clipboard_target\");\n\t\t}\n\t});\n\n\tthis.on(this.app, \"events:rendered\", () => {\n\t\tthis.RestoreClipboardSource(view);\n\t});\n\n\tif (this.$multi) {\n\t\tthis._globalClickHandler = webix.event(this.List.$view, \"click\", () => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tthis.ChangePasteTarget(this.List.$view);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tthis.on(view, \"onItemClick\", (id, e, node) => {\n\t\t\tif (this.State.clipboard && this.State.clipboard.source) {\n\t\t\t\tif (this.State.mode === \"timeline\") {\n\t\t\t\t\tnode = this.CreatePasteTarget(view, e);\n\t\t\t\t}\n\t\t\t\tthis.ChangePasteTarget(node);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * Cleans up click handler when the view is destroyed\n */\nfunction OnDestroy() {\n\tif (this._globalClickHandler) {\n\t\twebix.eventRemove(this._globalClickHandler);\n\t\tthis._globalClickHandler = null;\n\t}\n}\n\n/**\n * Creates an HTML element that represents a paste target for widgets that do not have suitable elements (timeline mode)\n * @param {Object} view - a Webix data widget that is used to display events\n * @param {MouseEvent} e\n * @returns {HTMLElement}\n */\nfunction CreatePasteTarget(view, e) {\n\tconst scroll = view.getScrollState();\n\tconst x = e.clientX - view.$view.offsetLeft + scroll.x;\n\tconst y = e.clientY - view.$view.offsetTop + scroll.y;\n\tthis.mousePosUnit = Math.floor(x / this.Scales.cellWidth);\n\n\tconst target = webix.html.create(\"div\");\n\tconst sheight = this.GetSectionHeight();\n\ttarget.style.top = `${y - (y % sheight)}px`;\n\ttarget.style.left = `${x - (x % this.Scales.cellWidth)}px`;\n\ttarget.style.width = `${this.Scales.cellWidth}px`;\n\ttarget.style.height = `${sheight}px`;\n\ttarget.style.position = \"absolute\";\n\n\t// view.$view.firstChild.prepend(target); // when IE dies, replace with this line\n\tconst parent = view.$view.firstChild;\n\tparent.insertBefore(target, parent.childNodes[0]);\n\n\treturn target;\n}\n\n/**\n * Sets styling for a paste target and sets it to state.clipboard\n * @param {HTMLElement} node\n */\nfunction SetPasteTargetStyle(node) {\n\twebix.html.addCss(node, \"webix_scheduler_paste_target\");\n\tthis.State.clipboard.target = node;\n}\n\n/**\n * Removes styling from a paste target, cleans up its reference from state and removes it from the DOM if it was created specifically (timeline mode)\n */\nfunction ClearPasteTargetStyle() {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.target) {\n\t\twebix.html.removeCss(\n\t\t\tthis.State.clipboard.target,\n\t\t\t\"webix_scheduler_paste_target\"\n\t\t);\n\t\tif (this.State.mode === \"timeline\" && clipboard.target.parentNode) {\n\t\t\t// this.State.clipboard.target.remove(); // when IE dies, replace with this line\n\t\t\tconst target = clipboard.target;\n\t\t\ttarget.parentNode.removeChild(target);\n\t\t}\n\t\tthis.State.clipboard.target = null;\n\t}\n}\n\n/**\n * Makes another element the target for pasting\n * @param {HTMLElement} node\n */\nfunction ChangePasteTarget(node) {\n\tif (this.State.clipboard.target !== node) {\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.SetPasteTargetStyle(node);\n\t}\n}\n\n/**\n * Locates event node by event ID (checks the given one and locates it anew if the parent was re-rendered)\n * @param {HTMLElement} view - parent html element (top html element of a widget)\n * @param {HTMLElement} node - given html element of the event\n * @param {string} id - the ID of the event\n * @returns {HTMLElement}\n */\nfunction locateEvent(view, node, id) {\n\tif (node && view.contains(node)) return node;\n\treturn (\n\t\tview.querySelectorAll(`[webix_e_id=\"${id}\"]`)[0] ||\n\t\tview.querySelectorAll(`[webix_l_id=\"${id}\"]`)[0]\n\t);\n}\n\n/**\n * Adds the selected event to clipboard, sets mode, styles the node of the copied/cut event\n * @param {string} mode - \"copy\" or \"cut\"\n */\nfunction AddToClipboard(view, mode) {\n\tconst sel = this.State.selected;\n\tif (sel && sel.id !== \"0\") {\n\t\tthis.ClearPasteTargetStyle();\n\n\t\tconst source = locateEvent(view.$view, sel.node, sel.date || sel.id);\n\t\tif (source) this.SetClipboardSourceStyle(mode, source);\n\n\t\tconst event = this.GetEvent(sel.date || sel.id);\n\t\tthis.State.clipboard = {\n\t\t\tmode,\n\t\t\tselected: webix.copy(event),\n\t\t\tsource,\n\t\t};\n\t}\n}\n\n/**\n * Adds relevant styling to the node of the copied or cut event\n * @param {string} mode - \"copy\" or \"cut\"\n * @param {HTMLElement} node\n */\nfunction SetClipboardSourceStyle(mode, node) {\n\tconst css = `webix_scheduler_${mode}`;\n\tif (node.className.indexOf(css) === -1) webix.html.addCss(node, css);\n\tconst opMode = this.clipboardModes[this.clipboardModes.indexOf(mode) ^ 1];\n\tconst prevCss = `webix_scheduler_${opMode}`;\n\twebix.html.removeCss(node, prevCss);\n\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source && node != clipboard.source) {\n\t\twebix.html.removeCss(this.State.clipboard.source, css);\n\t\twebix.html.removeCss(this.State.clipboard.source, prevCss);\n\t}\n}\n\n/**\n * Locates the copied or cut event and highlights it\n * @param {Object} view - the widget that displays events\n */\nfunction RestoreClipboardSource(view) {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst source = locateEvent(view.$view, clip.source, clip.selected.id);\n\t\tif (source) {\n\t\t\tif (source !== clip.source) {\n\t\t\t\tthis.State.clipboard.source = source;\n\t\t\t}\n\t\t\tthis.SetClipboardSourceStyle(clip.mode, source);\n\t\t}\n\t}\n}\n\n/**\n * Pastes the event from clipboard to the target\n * @param {KeyboardEvent} e\n */\nfunction PasteFromClipboard(e) {\n\tconst clipboard = this.State.clipboard;\n\tif (clipboard && clipboard.source) {\n\t\tconst newEvent = this.GetEventData(clipboard, e);\n\n\t\tif (clipboard.mode === \"copy\") {\n\t\t\tthis.CopyEvent(newEvent);\n\t\t} else if (clipboard.mode === \"cut\") {\n\t\t\tthis.MoveEvent(newEvent);\n\t\t}\n\n\t\tthis.PurgeClipboard();\n\t}\n}\n\n/**\n * Collects new event data for the pasted event based on the chosen target\n * @param {Object} clipboard - clipboard property from the global app state\n * @param {KeyboardEvent} e\n * @returns {Object}\n */\nfunction GetEventData(clipboard, e) {\n\tconst newEvent = clipboard.selected;\n\n\tconst evLength =\n\t\tMath.floor(newEvent.end_date - newEvent.start_date) / (60 * 1000); // minutes\n\tnewEvent.start_date = this.GetTargetDate(e.target.getAttribute(\"webix_l_id\"));\n\tnewEvent.end_date = webix.Date.add(\n\t\tnewEvent.start_date,\n\t\tevLength,\n\t\t\"minute\",\n\t\ttrue\n\t);\n\n\tif (this.State.mode === \"units\") {\n\t\tnewEvent.units = this.Unit.id;\n\t} else if (this.State.mode === \"timeline\") {\n\t\tconst sec = e.target.getAttribute(\"webix_l_id\");\n\t\tif (sec) newEvent.section = sec;\n\t}\n\n\treturn newEvent;\n}\n\n/**\n * Saves the copy of the event\n * @param {Object} newEvent\n */\nfunction CopyEvent(newEvent) {\n\tcleanEventData.call(this, newEvent);\n\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\tthis.UpdateSelection(id, newEvent)\n\t);\n}\n\n/**\n * Saves the event to a new target\n * @param {Object} newEvent\n */\nfunction MoveEvent(newEvent) {\n\t// cut operation is either update - for normal events\n\t// or edit as 'this' - for recurring events\n\tif (newEvent.recurring) {\n\t\tconst recurring = cutOccurrence(newEvent.id, newEvent);\n\t\tconst updateId = newEvent.$id;\n\t\tcleanEventData.call(this, newEvent);\n\n\t\t// [todo] create 1 Op for updating as this because calling 2 methods (update, add) for this wasn't the best idea\n\t\tthis.Ops.updateEvent(\n\t\t\tupdateId,\n\t\t\t{ recurring },\n\t\t\t\"this\",\n\t\t\tnewEvent.start_date,\n\t\t\ttrue\n\t\t).then(() =>\n\t\t\tthis.Ops.addEvent(newEvent, true).then(id =>\n\t\t\t\tthis.UpdateSelection(id, newEvent)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tconst update = {\n\t\t\tstart_date: newEvent.start_date,\n\t\t\tend_date: newEvent.end_date,\n\t\t};\n\t\tif (newEvent.units) update.units = newEvent.units;\n\t\tif (newEvent.section) update.section = newEvent.section;\n\t\tthis.Ops.updateEvent(newEvent.id, update, null, null, true).then(() => {\n\t\t\tthis.UpdateSelection(newEvent.id, newEvent);\n\t\t});\n\t}\n}\n\nfunction PurgeClipboard() {\n\tconst clip = this.State.clipboard;\n\tif (clip) {\n\t\tconst { mode, source } = clip;\n\t\twebix.html.removeCss(source, `webix_scheduler_${mode}`);\n\n\t\tthis.ClearPasteTargetStyle();\n\t\tthis.State.clipboard = null;\n\n\t\treturn false;\n\t}\n}\n\n/**\n *\n * @param {Object} child - the object of a JetView instance\n * @param {Object} mainWidget - the main widget within a jet view\n * @param {Object} config - some config that is passed for this view (e.g. multi: true)\n */\nexport default function CopyPasteMixin(child, mainWidget, config) {\n\tchild.AddToClipboard = AddToClipboard;\n\tchild.SetClipboardSourceStyle = SetClipboardSourceStyle;\n\tchild.RestoreClipboardSource = RestoreClipboardSource;\n\tchild.PasteFromClipboard = PasteFromClipboard;\n\tchild.GetEventData = GetEventData;\n\tchild.CopyEvent = CopyEvent;\n\tchild.MoveEvent = MoveEvent;\n\tchild.ClearPasteTargetStyle = ClearPasteTargetStyle;\n\tchild.SetPasteTargetStyle = SetPasteTargetStyle;\n\tchild.ChangePasteTarget = ChangePasteTarget;\n\tchild.CreatePasteTarget = CreatePasteTarget;\n\tchild.PurgeClipboard = PurgeClipboard;\n\n\tif (config && config.multi) {\n\t\tchild.$multi = true;\n\t\tchild.destroy = OnDestroy;\n\t}\n\n\tHandleCopyPaste.call(child, mainWidget);\n}\n","/* eslint-disable indent */\n/* eslint-disable no-mixed-spaces-and-tabs */\nimport { JetView } from \"webix-jet\";\nimport { FREQUENCE, WEEKDAYS, separateSequence } from \"../../helpers/recurring\";\nimport { cleanEventData } from \"helpers/copypaste\";\n\nimport EventActionMenu from \"./actionmenu\";\n\nexport default class EventView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst aSkin = webix.skin.$active;\n\t\tconst bar = {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: {\n\t\t\t\tleft: aSkin.layoutPadding.form - (aSkin.inputHeight - 20) / 2,\n\t\t\t\tright: 14,\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{\n\t\t\t\t\tview: \"icon\",\n\t\t\t\t\ticon: \"wxi-close\",\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Back(),\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\twidth: 130,\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tlocalId: \"edit\",\n\t\t\t\t\tlabel: _(\"Edit\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\tthis.$scope.StartAction(\"Edit\", this.$view);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tif (this.app.config.copypaste) {\n\t\t\tbar.elements.splice(-1, 0, {\n\t\t\t\tview: \"icon\",\n\t\t\t\ticon: \"shi-content-copy\",\n\t\t\t\ttooltip: _(\"Copy event\"),\n\t\t\t\tclick: () => this.CopyEvent(),\n\t\t\t});\n\t\t}\n\n\t\tconst info = {\n\t\t\tlocalId: \"text\",\n\t\t\tview: \"template\",\n\t\t\tcss: \"webix_scheduler_info\",\n\t\t\ttemplate: obj => (obj.start_date ? this.InfoTemplate(obj) : \"\"),\n\t\t\tborderless: true,\n\t\t};\n\n\t\tconst deleteButton = {\n\t\t\tview: \"button\",\n\t\t\tlocalId: \"remove\",\n\t\t\tlabel: _(\"Delete event\"),\n\t\t\tcss: \"webix_danger webix_scheduler_danger\",\n\t\t\talign: \"center\",\n\t\t\tinputWidth: 330,\n\t\t\tclick: function() {\n\t\t\t\tthis.$scope.StartAction(\"Delete\", this.$view);\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"proxy\", // for borders\n\t\t\tbody: {\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\tbar,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\tpadding: { right: 14 + 2 },\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [info, deleteButton],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.UnitsLocal = this.app.getService(\"local\").units(true);\n\n\t\tthis.on(this.State.$changes, \"readonly\", v => {\n\t\t\tconst action = v ? \"hide\" : \"show\";\n\t\t\tthis.$$(\"edit\")[action]();\n\t\t\tthis.$$(\"remove\")[action]();\n\t\t});\n\n\t\tconst template = this.$$(\"text\");\n\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (v) {\n\t\t\t\tthis.EventObj = this.app\n\t\t\t\t\t.getService(\"local\")\n\t\t\t\t\t.events(true)\n\t\t\t\t\t.getItem(v.id);\n\t\t\t\ttemplate.setValues(this.EventObj);\n\t\t\t}\n\t\t});\n\n\t\tthis.Menu = this.ui(EventActionMenu);\n\n\t\tif (this.app.config.units) {\n\t\t\tconst waitUnits = this.app.getService(\"local\").units();\n\t\t\twaitUnits.then(() => {\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif (this.app.config.timeline) {\n\t\t\tconst local = this.app.getService(\"local\");\n\t\t\tlocal.sections().then(data => {\n\t\t\t\tthis.Sections = data;\n\t\t\t\ttemplate.refresh();\n\t\t\t});\n\t\t}\n\t}\n\n\tStartAction(mode, node) {\n\t\tif (\n\t\t\tthis.app.config.recurring &&\n\t\t\t(typeof this.State.selected.date === \"string\" || this.EventObj.origin_id)\n\t\t) {\n\t\t\tthis.Menu.Show(node).then(o => {\n\t\t\t\tif (mode === \"Delete\") this.DeleteEvent(o);\n\t\t\t\telse this.EditEvent(o);\n\t\t\t});\n\t\t} else {\n\t\t\tif (mode === \"Delete\") this.DeleteEvent();\n\t\t\telse this.EditEvent();\n\t\t}\n\t}\n\n\tEditEvent(o) {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst path = compact ? \"event.formpopup/\" : \"../\";\n\t\tthis.show(path + \"event.form\", { target: \"edit\", params: { mode: o } });\n\t}\n\n\tDeleteEvent(mode) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\twebix\n\t\t\t.confirm({\n\t\t\t\ttitle: _(\"Delete event\"),\n\t\t\t\ttext: _(\"The event will be deleted permanently, are you sure?\"),\n\t\t\t\tcontainer: this.app.getRoot().$view,\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tconst obj = this.EventObj;\n\t\t\t\tlet sdate = \"\";\n\t\t\t\tif (mode && mode !== \"all\") {\n\t\t\t\t\tif (this.State.selected) sdate = this.State.selected.date;\n\t\t\t\t\telse if (obj.$id) sdate = obj.id;\n\t\t\t\t}\n\t\t\t\tthis.app\n\t\t\t\t\t.getService(\"operations\")\n\t\t\t\t\t.removeEvent(this.EventObj, mode, sdate);\n\t\t\t\tthis.Back(true);\n\t\t\t});\n\t}\n\n\t/** Sets selected of the global reactive state to open form for copy creation */\n\tCopyEvent() {\n\t\tconst data = webix.copy(this.EventObj);\n\t\tcleanEventData.call(this, data);\n\t\tthis.State.$batch({\n\t\t\tselected: { id: \"0\" },\n\t\t\tclipboard: { mode: \"copy\", selected: data },\n\t\t});\n\t}\n\n\t/**\n\t * Closes the info panel\n\t * @param {Boolean} removal - indicates that the panel was closed after an event was removed\n\t */\n\tBack(removal) {\n\t\tif (removal) {\n\t\t\tconst clip = this.State.clipboard;\n\t\t\tif (\n\t\t\t\tclip &&\n\t\t\t\t(clip.selected.id === this.EventObj.id ||\n\t\t\t\t\tclip.selected.id.indexOf(\"_\" + this.EventObj.id) > -1)\n\t\t\t) {\n\t\t\t\tthis.State.clipboard = null;\n\t\t\t}\n\t\t}\n\n\t\tthis.State.selected = null;\n\t}\n\n\tInfoTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (this.app.config.recurring && this.State.selected.date) {\n\t\t\tobj = { ...obj, ...separateSequence(obj, this.State.selected.date) };\n\t\t}\n\t\tconst [start, end] = [obj.start_date, obj.end_date];\n\n\t\tconst oneday = webix.Date.equal(\n\t\t\twebix.Date.datePart(start, true),\n\t\t\twebix.Date.datePart(end, true)\n\t\t);\n\n\t\tconst allday =\n\t\t\twebix.Date.equal(webix.Date.datePart(start, true), start) &&\n\t\t\twebix.Date.equal(webix.Date.datePart(end, true), end) &&\n\t\t\tobj.all_day;\n\n\t\tconst time = webix.i18n.timeFormatStr;\n\t\tconst date = webix.i18n.longDateFormatStr;\n\n\t\tconst title = `<div class=\"webix_scheduler_event_title\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>`;\n\n\t\tconst startDate = date(start);\n\t\tconst endDate = date(end);\n\t\tconst startTime = time(start);\n\t\tconst endTime = time(end);\n\n\t\tlet fromTo = \"\";\n\t\tif (oneday) {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${startDate}</div>`;\n\t\t\tif (!allday)\n\t\t\t\tfromTo += `<div class=\"webix_scheduler_event_text\">${_(\n\t\t\t\t\t\"from\"\n\t\t\t\t)} ${startTime} ${_(\"to\")} ${endTime}</div>`;\n\t\t} else {\n\t\t\tfromTo = `<div class=\"webix_scheduler_event_text\">${_(\"from\")} ${\n\t\t\t\t!allday ? startTime : \"\"\n\t\t\t} ${startDate}</div><div class=\"webix_scheduler_event_text\">${_(\"to\")} ${\n\t\t\t\t!allday ? endTime : \"\"\n\t\t\t} ${endDate}</div>`;\n\t\t}\n\n\t\tconst recurring =\n\t\t\tthis.app.config.recurring && obj.recurring\n\t\t\t\t? this.GetRecurringText(obj, _)\n\t\t\t\t: \"\";\n\n\t\tlet units = \"\";\n\t\tif (this.app.config.units) {\n\t\t\tunits += `<div class=\"webix_scheduler_event_units_title\">${_(\n\t\t\t\t\"Assigned to units\"\n\t\t\t)}:</div><div class=\"webix_scheduler_event_units\">`;\n\t\t\tif (obj.units) {\n\t\t\t\tconst unitIDs = obj.units.split(\",\");\n\t\t\t\tunitIDs.forEach((id, index) => {\n\t\t\t\t\tconst isLast = index === unitIDs.length - 1;\n\t\t\t\t\tconst unitObj = this.UnitsLocal.getItem(id);\n\t\t\t\t\tconst unitValue =\n\t\t\t\t\t\tunitObj && unitObj.value ? unitObj.value : _(\"Unknown unit\");\n\t\t\t\t\tunits += `<div class=\"webix_scheduler_event_unit_item\">${unitValue}${\n\t\t\t\t\t\tisLast ? \"\" : \",\"\n\t\t\t\t\t}</div>`;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tunits += _(\"No units\");\n\t\t\t}\n\t\t\tunits += \"</div>\";\n\t\t}\n\n\t\tconst section =\n\t\t\tthis.app.config.timeline && this.Sections ? this.GetSection(obj, _) : \"\";\n\n\t\tlet details = \"\";\n\t\tif (obj.details)\n\t\t\tdetails = `<div class=\"webix_scheduler_event_details_title\">${_(\n\t\t\t\t\"Notes\"\n\t\t\t)}</div>\n\t\t\t\t<div class=\"webix_scheduler_event_text\">${obj.details.replace(\n\t\t\t\t\t/(?:\\r\\n|\\r|\\n)/g,\n\t\t\t\t\t\"<br>\"\n\t\t\t\t)}</div>`;\n\n\t\treturn `${title}\n\t\t\t<div class='webix_scheduler_event_from_to'>${fromTo}</div>\n\t\t\t<div class='webix_scheduler_event_recurring_pattern'>${recurring}</div>${units}${section}${details}`;\n\t}\n\n\tGetRecurringText(obj, _) {\n\t\tconst mode = obj.$recurring;\n\t\tconst interval = mode.INTERVAL && mode.INTERVAL > 1 ? mode.INTERVAL : \"\";\n\n\t\tlet pattern = \"\";\n\t\tif (mode.BYDAY) {\n\t\t\tpattern = ` ${_(\"on\")} ${mode.BYSETPOS || \"\"} ${mode.BYDAY.split(\",\")\n\t\t\t\t.map(d => webix.i18n.calendar.dayFull[WEEKDAYS.indexOf(d)])\n\t\t\t\t.join(\", \")} ${\n\t\t\t\tmode.BYMONTH\n\t\t\t\t\t? `${_(\"of\")} ${webix.i18n.calendar.monthFull[mode.BYMONTH - 1]}`\n\t\t\t\t\t: \"\"\n\t\t\t}`;\n\t\t} else if (mode.BYMONTHDAY) {\n\t\t\tpattern =\n\t\t\t\t(mode.BYMONTHDAY ? ` ${_(\"on\")} ` : \"\") +\n\t\t\t\t(mode.BYMONTH\n\t\t\t\t\t? `${mode.BYSETPOS ? _(\"of\") : \"\"} ${\n\t\t\t\t\t\t\twebix.i18n.calendar.monthFull[mode.BYMONTH - 1]\n\t\t\t\t\t  }`\n\t\t\t\t\t: \"\") +\n\t\t\t\t(mode.BYMONTHDAY ? ` ${mode.BYMONTHDAY}` : \"\");\n\t\t} else if (mode.BYYEARDAY) {\n\t\t\tpattern = `${_(\"day\")} ${mode.BYYEARDAY}`;\n\t\t}\n\n\t\treturn `${_(\"Repeats each\")} ${interval} ${_(\n\t\t\tFREQUENCE[mode.FREQ] + (interval ? \"s\" : \"\")\n\t\t)} ${pattern}${\n\t\t\tmode.COUNT\n\t\t\t\t? `, ${mode.COUNT} ${_(\"times\")}`\n\t\t\t\t: mode.UNTIL\n\t\t\t\t? ` ${_(\"till\")} ${webix.i18n.longDateFormatStr(mode.UNTIL)}`\n\t\t\t\t: \"\"\n\t\t}`;\n\t}\n\n\t/**\n\t * Returns a string with HTML for the info with the section\n\t * @param {Object} obj - data of an event\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} a string with HTML for the info with the section\n\t */\n\tGetSection(obj, _) {\n\t\tconst section = this.Sections.getItem(obj.section);\n\t\tif (section)\n\t\t\treturn `<div class=\"webix_scheduler_section_tpl\"><span class=\"webix_scheduler_section_title\">${_(\n\t\t\t\t\"Section\"\n\t\t\t)}:</span> ${section.text}</div>`;\n\t\treturn \"\";\n\t}\n}\n","let BRIGHTNESS;\nlet FONT;\nwebix.ready(() => {\n\tconst dark = webix.skin.$name === \"contrast\" || webix.skin.$name === \"dark\";\n\tBRIGHTNESS = dark ? 0.35 : 0.75;\n\tFONT = dark ? \"#9f9d9d\" : \"#ffffff\";\n});\n\n/**\n * Gets contrasting text color for the event background color\n * @param {string} color - background color\n * @returns {string} text color\n */\nexport function getContrastingColor(color) {\n\tconst rgb = webix.color.toRgb(color);\n\tconst brightness = Math.round(\n\t\t(rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000\n\t);\n\treturn brightness > 180 ? \"#475466\" : \"#ffffff\";\n}\n\nexport function getDimmedColor(color) {\n\tlet [hue, saturation] = hexToHsv(color);\n\thue *= 0.95;\n\tsaturation *= 0.4;\n\treturn `rgb(${webix.color.hsvToRgb(hue, saturation, BRIGHTNESS)})`;\n}\n\nexport function getDimmedFont() {\n\treturn FONT;\n}\n\nfunction hexToHsv(hex) {\n\tconst [red, green, blue] = webix.color.toRgb(hex);\n\treturn webix.color.rgbToHsv(red, green, blue);\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class EventActionPopup extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tconst buttons = {\n\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Cancel\"),\n\t\t\t\t\thotkey: \"esc\",\n\t\t\t\t\tclick: () => this.Cancel(),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"button\",\n\t\t\t\t\tvalue: _(\"Apply\"),\n\t\t\t\t\tcss: \"webix_primary\",\n\t\t\t\t\thotkey: \"enter\",\n\t\t\t\t\tclick: () => this.Done(),\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.app.getService(\"jet-win\").updateConfig({\n\t\t\tview: \"window\",\n\t\t\thead: _(\"Edit recurring event\"),\n\t\t\tautoheight: true,\n\t\t\tcss: \"webix_scheduler_action_popup\",\n\t\t\tbody: {\n\t\t\t\ttype: \"form\",\n\t\t\t\tpadding: { top: 0 },\n\t\t\t\twidth: 340,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\tlocalId: \"option\",\n\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ id: \"this\", value: _(\"This event\") },\n\t\t\t\t\t\t\t{ id: \"next\", value: _(\"This event and the following\") },\n\t\t\t\t\t\t\t{ id: \"all\", value: _(\"All events\") },\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\tbuttons,\n\t\t\t\t],\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonHide: () => (this.Result = null),\n\t\t\t},\n\t\t});\n\t}\n\n\tinit(view) {\n\t\tthis.Root = view;\n\t}\n\n\tShow(promise) {\n\t\tthis.Result = promise;\n\t\tthis.$$(\"option\").setValue(\"this\");\n\t\tthis.Root.show();\n\t}\n\n\tDone() {\n\t\tconst id = this.$$(\"option\").getValue();\n\t\tif (this.Result) this.Result.resolve(id);\n\t\tthis.Root.hide();\n\t}\n\n\tCancel() {\n\t\tif (this.Result) this.Result.reject();\n\t\tthis.Root.hide();\n\t}\n}\n","import { getDimmedColor, getDimmedFont } from \"./colors\";\n\nexport function marker(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `<div class=\"webix_event_marker\"><div class=\"webix_event_marker_inner\" style=\"background-color:${\n\t\tobj.$past ? getDimmedColor(color) : color\n\t};\"></div></div>`;\n}\n\nexport function events(_) {\n\treturn function(obj, common) {\n\t\treturn `<div class=\"webix_event_overall ${\n\t\t\tobj.$past ? \"webix_scheduler_past_event\" : \"\"\n\t\t}\"><div class=\"webix_event_time\">${common.timeStart(obj)}</div>${marker(\n\t\t\tobj,\n\t\t\tcommon\n\t\t)}<div class=\"webix_event_text\">${obj.text || _(\"(No title)\")}</div></div>`;\n\t};\n}\n\nexport function dayEventColor(obj) {\n\tconst color = obj.color || obj.$color;\n\treturn `border-color:${\n\t\tobj.$past ? getDimmedColor(obj.$color) : obj.$color\n\t}; background-color:${obj.$past ? getDimmedColor(color) : color}; color:${\n\t\tobj.$past ? getDimmedFont() : obj.$textColor\n\t};`;\n}\n\nexport function timeStart(start, end) {\n\treturn `<div class=\"start\">${webix.i18n.timeFormatStr(\n\t\tstart\n\t)}</div><div class=\"end\">${webix.i18n.timeFormatStr(end)}</div>`;\n}\n\nfunction fill(obj, common, size) {\n\tconst v = common.master;\n\treturn (\n\t\tv[\"$\" + size] -\n\t\t(v.config[size == \"width\" ? \"xCount\" : \"yCount\"] - 1) * common[size]\n\t);\n}\n\nexport function templateStart(obj, common, marks) {\n\tlet { width, height } = common;\n\tif (obj.right) width = fill(obj, common, \"width\");\n\tif (obj.bottom) height = fill(obj, common, \"height\");\n\treturn (\n\t\t\"<div \" +\n\t\t/*@attr*/ \"webix_l_id\" +\n\t\t`=\"${obj.id}\" class=\"${common.classname(obj, common, marks)}\" ${common.aria(\n\t\t\tobj,\n\t\t\tcommon,\n\t\t\tmarks\n\t\t)} style=\"width:${width}px; height:${height}px; float:left; overflow:hidden;\">`\n\t);\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class UnitListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\treturn {\n\t\t\tview: \"unitlist\",\n\t\t\tlocalId: \"list\",\n\t\t\tuniteBy: () => \"custom\",\n\t\t\ttype: {\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttemplateHeader: obj => this.TemplateHeader(obj),\n\t\t\t\ttimeStart: obj => this.TimeStart(obj),\n\t\t\t\theight: 50,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonUnits: () => this.SetUnits(),\n\t\t\t\tonItemClick: (id, node) => this.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"list\");\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\tShowEvent(id, node) {\n\t\tconst obj = this.List.getItem(id);\n\t\tconst sel = getParams(obj);\n\t\tsel.node = node;\n\t\tthis.State.selected = sel;\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tSetUnits() {\n\t\tlet units = this.List.units;\n\t\tconst data = this.data.all;\n\n\t\t// ignore clearAll\n\t\tif (Object.keys(units).length) {\n\t\t\tthis.List.units = {};\n\t\t\tlet start = this.data.start;\n\t\t\tconst end = this.data.end;\n\n\t\t\twhile (start < end) {\n\t\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\n\t\t\t\tlet result = data\n\t\t\t\t\t.filter(\n\t\t\t\t\t\td =>\n\t\t\t\t\t\t\td.start_date < next &&\n\t\t\t\t\t\t\t(d.end_date > start || (d.end_date >= start && d.all_day))\n\t\t\t\t\t)\n\t\t\t\t\t.map(ev => ev.id);\n\t\t\t\tif (result.length) {\n\t\t\t\t\tthis.List.units[start.valueOf()] = result;\n\t\t\t\t}\n\n\t\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t\t}\n\t\t}\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\n\nexport default class AgendaView extends UnitListView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_agenda\";\n\n\t\twebix.extend(\n\t\t\tui.type,\n\t\t\t{\n\t\t\t\theight: \"auto\",\n\t\t\t\theaderHeight: 50,\n\t\t\t\tclassname: obj => this.TemplateCss(obj),\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\twebix.extend(\n\t\t\tui.on,\n\t\t\t{\n\t\t\t\tonItemRender: obj => {\n\t\t\t\t\tif (obj.$unit) this.CurrentUnit = obj.$unit;\n\t\t\t\t},\n\t\t\t\tonItemClick: (id, e, node) => {\n\t\t\t\t\tnode = node.firstChild;\n\t\t\t\t\tthis.ShowEvent(id, node);\n\t\t\t\t\tif (!compact) this.SelectEvent(node);\n\t\t\t\t},\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tsuper.init();\n\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst events = this.Data.events(true);\n\n\t\tthis.on(this.State.$changes, \"date\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"selected\", v => {\n\t\t\tif (!v) this.SelectEvent(); //remove selection\n\t\t});\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\n\t\t// updates made in full mode by form\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t}\n\n\tRefreshData() {\n\t\tlet start = webix.Date.monthStart(this.State.date);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tthis.data = { all: data, start: start, end: end };\n\t\t\tif (this.app) {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(data.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t}\n\t\t});\n\t}\n\n\tSelectEvent(node) {\n\t\tif (node == this._selected) return;\n\n\t\tconst name = \"webix_agenda_selected\";\n\t\tif (this._selected) webix.html.removeCss(this._selected, name);\n\t\tif (node) webix.html.addCss(node, name);\n\n\t\tthis._selected = node;\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span><br><span class='webix_scheduler_dayofweek'>%l</span>`;\n\n\t\treturn webix.Date.dateToStr(fstring)(date);\n\t}\n\n\tTemplateCss(obj) {\n\t\tconst ids = this.List.getUnitList(this.CurrentUnit);\n\n\t\tlet css = \"webix_list_item\";\n\t\tif (obj.id == ids[ids.length - 1]) css += \" webix_event_last\";\n\t\tif (obj.id == ids[0]) css += \" webix_event_first\";\n\n\t\treturn css;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class HourscaleView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tborderless: true,\n\t\t\tlocalId: \"scale\",\n\t\t\tcss: \"webix_scheduler_scale\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\theightSize: (obj, common) => {\n\t\t\t\t\tconst ind = this.List.getIndexById(obj.id);\n\t\t\t\t\treturn common.height - (ind === 0 ? 17 : 0) + \"px\";\n\t\t\t\t},\n\t\t\t},\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 51,\n\t\t\ttemplate: obj => this.HourScaleItem(obj),\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"scale\");\n\t\tthis.ParseHours();\n\t}\n\n\tParseHours() {\n\t\tconst data = [];\n\t\tfor (let h = 0; h < 24; h++) {\n\t\t\tdata.push({ id: h + \"\" });\n\t\t}\n\t\tthis.List.parse(data);\n\t}\n\n\tHourScaleItem(obj) {\n\t\tif (this.List.getIndexById(obj.id) === 0) return \"\";\n\t\telse return `${(obj.id < 10 ? \"0\" : \"\") + obj.id}:00`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class MultiMoreView extends JetView {\n\tconfig() {\n\t\tconst more = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"more\",\n\t\t\twidth: 50,\n\t\t\tcss: \"webix_scheduler_multi_space\",\n\t\t\ttooltip: () => \"\",\n\t\t\tonClick: {\n\t\t\t\t\"wxi-angle-down\": () => this.ExpandData(),\n\t\t\t\t\"wxi-angle-up\": () => this.WrapData(),\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\tcols: [more, {}],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.List = this.$$(\"multiDayList\");\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\t}\n\n\t/**\n\t *\n\t * @param {*} mode\n\t */\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Sets new height and delay for animation\n\t * @param {string} mode - \"up\" or \"down\"\n\t * @param {number} height\n\t * @param {function} handler\n\t */\n\tAnimate(mode, height, handler) {\n\t\tconst delay = 150;\n\t\tthis.List.$view.style.transition = `height ${delay}ms`;\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","function _select(id, functor) {\n\tconst trgs = this.LocateSelected(id);\n\tif (trgs) {\n\t\tfor (let i = 0; i < trgs.length; i++)\n\t\t\tfunctor(trgs[i], \"webix_scheduler_event_selected\");\n\t}\n}\n\nfunction Select(id) {\n\treturn _select.call(this, id, webix.html.addCss);\n}\n\nfunction Unselect(id) {\n\treturn _select.call(this, id, webix.html.removeCss);\n}\n\nfunction HandleSelection() {\n\tconst mode = this._SelectionMode;\n\tthis.State = this.app.getState();\n\n\tthis.on(this.State.$changes, \"selected\", (v, o) => {\n\t\tif (o) this.Unselect(o.date && typeof o.date === \"string\" ? o.date : o.id);\n\n\t\tif (v) {\n\t\t\tconst id = v.id === \"0\" || !v.date ? v.id : v.date;\n\t\t\tsetTimeout(\n\t\t\t\t() => this.Select(id),\n\t\t\t\tmode !== \"multi\" && id === \"0\" ? 150 : 0\n\t\t\t);\n\t\t}\n\t});\n\n\t// reapply selection to a saved new event\n\tif (mode !== \"multi\") {\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(events.data, \"onStoreUpdated\", (id, o, operation) => {\n\t\t\tif (\n\t\t\t\toperation === \"add\" &&\n\t\t\t\tid != \"0\" &&\n\t\t\t\tthis.State.selected &&\n\t\t\t\tthis.State.selected.id === \"0\"\n\t\t\t) {\n\t\t\t\tthis.State.selected.id = id;\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction locate(inner) {\n\treturn function LocateSelected(id) {\n\t\tif (this._DataObj) {\n\t\t\treturn Array.prototype.map.call(\n\t\t\t\tthis._DataObj.querySelectorAll(\n\t\t\t\t\t`[webix_${inner ? \"l\" : \"e\"}_id=\"${id}\"]`\n\t\t\t\t),\n\t\t\t\tel => (inner ? el.firstElementChild : el)\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default function SelectionMixin(child, mode, inner) {\n\tchild._SelectionMode = mode;\n\n\tchild.Select = Select;\n\tchild.Unselect = Unselect;\n\tchild.HandleSelection = HandleSelection;\n\tchild.LocateSelected = locate(inner);\n\n\tchild.HandleSelection();\n}\n","export const Resizer = {\n\t$dragIn: function() {\n\t\tconst ctx = this.getContext();\n\n\t\tif (ctx.from.mode !== this.mode) return false;\n\t\treturn true;\n\t},\n\t$dragPos: function(pos) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst box = webix.html.offset(ctx.target);\n\t\tlet y = pos.y - box.y;\n\n\t\tif (y < ctx.y_diff) y = ctx.y_diff;\n\t\telse if (y > box.height) y = box.height;\n\n\t\tconst height = y - ctx.y_diff;\n\t\tResizer.updateNodeHeight.call(this, height);\n\n\t\tif (ctx.duration !== height) {\n\t\t\tctx.duration = height;\n\t\t\tthis.updateText(ctx);\n\t\t}\n\n\t\tpos.x = ctx.x_diff;\n\t\tpos.y = ctx.y_diff;\n\t},\n\tupdateNodeHeight: function(height) {\n\t\tconst node = webix.DragControl.getNode();\n\t\tnode.style.height = Math.max(this.master.minEventHeight, height) + \"px\";\n\t},\n\tgetActualDate: function(master, any) {\n\t\tconst ctx = this.getContext();\n\n\t\tconst date = webix.Date.copy(ctx.event.start_date);\n\t\tconst minutes =\n\t\t\t(Math.round((ctx.duration * 60) / master.List.type.height / 5) || 1) * 5;\n\n\t\twebix.Date.add(date, minutes, \"minute\");\n\n\t\tif (!any && webix.Date.equal(date, ctx.event.end_date)) return null;\n\n\t\treturn {\n\t\t\tstart_date: webix.Date.copy(ctx.event.start_date),\n\t\t\tend_date: date,\n\t\t};\n\t},\n};\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nconst d = webix.Date;\r\nfunction addMinutes(date, inc) {\r\n\treturn d.add(date, inc * 1, \"minute\", true);\r\n}\r\n\r\nfunction addHours(date, inc) {\r\n\treturn d.add(date, inc * 1, \"hour\", true);\r\n}\r\n\r\nfunction addDays(date, inc) {\r\n\treturn d.add(date, inc * 1, \"day\", true);\r\n}\r\n\r\nfunction addWeeks(date, inc) {\r\n\treturn d.add(date, inc * 1, \"week\", true);\r\n}\r\n\r\nfunction addMonths(date, inc) {\r\n\treturn d.add(date, inc * 1, \"month\", true);\r\n}\r\n\r\nfunction addQuarters(date, inc) {\r\n\treturn d.add(date, inc * 3, \"month\", true);\r\n}\r\n\r\nfunction addYears(date, inc) {\r\n\treturn d.add(date, inc * 1, \"year\", true);\r\n}\r\n\r\nfunction differenceInYears(a, b) {\r\n\treturn a.getFullYear() - b.getFullYear();\r\n}\r\n\r\nfunction differenceInMonths(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 12 + (a.getMonth() - b.getMonth())\r\n\t);\r\n}\r\n\r\nconst day_length = 86400000;\r\nfunction differenceInCalendarDays(a, b) {\r\n\ta = new Date(a);\r\n\ta.setHours(0, 0, 0, 0);\r\n\tb = new Date(b);\r\n\tb.setHours(0, 0, 0, 0);\r\n\r\n\treturn Math.round((a.getTime() - b.getTime()) / day_length);\r\n}\r\n\r\nfunction differenceInQuarters(a, b) {\r\n\treturn (\r\n\t\t(a.getFullYear() - b.getFullYear()) * 4 +\r\n\t\t(Math.floor(a.getMonth() / 3) + 1) -\r\n\t\t(Math.floor(b.getMonth() / 3) + 1)\r\n\t);\r\n}\r\n\r\nfunction differenceInWeeks(a, b) {\r\n\tconst diff = differenceInCalendarDays(a, b) / 7;\r\n\tconst end = getDay(a);\r\n\tconst start = getDay(b);\r\n\r\n\treturn Math.ceil(Math.abs(diff) - (end <= start ? 0 : 1)) * Math.sign(diff);\r\n}\r\n\r\nfunction differenceInHours(a, b) {\r\n\treturn differenceInCalendarDays(a, b) * 24 + (a.getHours() - b.getHours());\r\n}\r\n\r\nfunction differenceInMinutes(a, b) {\r\n\treturn differenceInHours(a, b) * 60 + (a.getMinutes() - b.getMinutes());\r\n}\r\n\r\nconst f_cache = {};\r\nfunction format(date, format) {\r\n\treturn formatFunction(format)(date);\r\n}\r\nfunction formatFunction(format) {\r\n\tlet cb = f_cache[format];\r\n\tif (!cb) {\r\n\t\tcb = f_cache[format] = d.dateToStr(format);\r\n\t}\r\n\r\n\treturn cb;\r\n}\r\n\r\nfunction getDay(date) {\r\n\tlet shift = date.getDay();\r\n\tif (d.startOnMonday) {\r\n\t\tif (shift === 0) shift = 6;\r\n\t\telse shift--;\r\n\t}\r\n\treturn shift;\r\n}\r\n\r\nfunction getDatePart(date) {\r\n\treturn d.datePart(date, true);\r\n}\r\n\r\nfunction getTimePart(date) {\r\n\treturn d.timePart(date);\r\n}\n\nconst diff = {\r\n\tyear: differenceInYears,\r\n\tquarter: differenceInQuarters,\r\n\tmonth: differenceInMonths,\r\n\tweek: differenceInWeeks,\r\n\tday: differenceInCalendarDays,\r\n\thour: differenceInHours,\r\n\tminute: differenceInMinutes,\r\n};\r\n\r\nfunction countDaysInMonth(sdate) {\r\n\tif (!sdate) return 30;\r\n\r\n\tconst m = sdate.getMonth();\r\n\r\n\tif (m === 1) {\r\n\t\tconst y = sdate.getFullYear();\r\n\t\tif (y % 4) return 28;\r\n\t\tif (y % 100) return 29;\r\n\t\tif (y % 400) return 28;\r\n\t\treturn 29;\r\n\t}\r\n\r\n\tif ((m % 2 && m < 7) || (!(m % 2) && m > 7)) {\r\n\t\treturn 30;\r\n\t}\r\n\r\n\treturn 31;\r\n}\r\n/**\r\n * Smaller units for task position and width for scales with precision setting:\r\n * the name of the unit and the number within a larger unit\r\n */\r\nconst smallerCount = {\r\n\tyear: [\"quarter\", 4],\r\n\tquarter: [\"month\", 3],\r\n\tmonth: [\"day\", countDaysInMonth],\r\n\tweek: [\"day\", 7],\r\n\tday: [\"hour\", 24],\r\n\thour: [\"minute\", 60],\r\n};\r\n\r\nconst add = {\r\n\tyear: addYears,\r\n\tquarter: addQuarters,\r\n\tmonth: addMonths,\r\n\tweek: addWeeks,\r\n\tday: addDays,\r\n\thour: addHours,\r\n\tminute: addMinutes,\r\n};\r\n\r\n/**\r\n * Calculates the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @param {Date} next - a later date\r\n * @param {Date} prev - an earlier date\r\n * @param {boolean} precise - current precision setting of the scales (if true, diff will be counted for smallerCount)\r\n * @param {boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - an int (if precise is false) or a float number\r\n */\r\nfunction innerDiff(unit, next, prev, precise, wt) {\r\n\tconst minUnit = precise ? smallerCount[unit][0] : unit;\r\n\r\n\tlet start = prev;\r\n\tlet end = next;\r\n\tif (wt) {\r\n\t\tstart = getUnitStart(minUnit, prev);\r\n\t\tend = getUnitStart(minUnit, next);\r\n\t\tif (end < next) end = addUnit(minUnit)(end, 1);\r\n\t}\r\n\r\n\tif (precise) {\r\n\t\tlet filled = diff[minUnit](end, start);\r\n\t\tconst all = smallerCount[unit][1];\r\n\t\treturn filled / (typeof all === \"number\" ? all : all(prev));\r\n\t} else {\r\n\t\treturn diff[minUnit](end, start);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns a function for calculating the difference between two dates in units\r\n * @param {string} unit - the minimal unit of the current scale (\"hour\"-\"year\")\r\n * @returns {function} - details below\r\n */\r\nfunction getDiff(unit) {\r\n\t/**\r\n\t * the returned function calculates the difference between two dates based on passed parameters\r\n\t * @param {Date} next - first date\r\n\t * @param {Date} prev - second date\r\n\t * @param {boolean} precise false by default, true when used to count x-position\r\n\t * and width of tasks with 'step-1' precision\r\n\t * @param {boolean} wt - marker that diff is used to count width of a task;\r\n\t * if diff returns 0, you have to add 1; otherwise tasks that are within 1 unit will have 0 width\r\n\t * and will be displayed incorrectly\r\n\t * @returns {number} - the difference between two dates in 'units'; if 'precise' is true, the number is float, otherwise int\r\n\t */\r\n\treturn (next, prev, precise, wt) => {\r\n\t\tif (unit === \"month\" && precise) {\r\n\t\t\treturn getMonthDayDiff(next, prev, wt);\r\n\t\t} else {\r\n\t\t\treturn innerDiff(unit, next, prev, precise, wt);\r\n\t\t}\r\n\t};\r\n}\r\n\r\n/**\r\n * Calculates the difference in months between two days for a scale with precision setting\r\n * This is a specific case of diff counting, because a month can have 28-31 days\r\n * @param {Date} end - a later date\r\n * @param {Date} start - an earlier date\r\n * @param {Boolean} wt - shows that diff will be counted for the width of a task\r\n * @returns {number} - a float number\r\n */\r\nfunction getMonthDayDiff(end, start, wt) {\r\n\tif (sameMonth(start, end)) {\r\n\t\treturn innerDiff(\"month\", end, start, true, wt);\r\n\t}\r\n\r\n\t// if starts not on 1st day\r\n\tlet daysOfFirstMonth = 0;\r\n\tif (start.getDate() > 1) {\r\n\t\tconst me = new Date(start.getFullYear(), start.getMonth() + 1, 1);\r\n\t\tdaysOfFirstMonth = innerDiff(\"month\", me, start, true);\r\n\t\tstart = me;\r\n\t}\r\n\r\n\t// if lasts 1+ whole months\r\n\tlet months = 0;\r\n\tif (!sameMonth(start, end)) {\r\n\t\tmonths = innerDiff(\"month\", webix.Date.monthStart(end), start); // int part\r\n\t\tstart = webix.Date.add(start, months, \"month\", true);\r\n\t}\r\n\r\n\t// all above plus days of last month if any\r\n\treturn daysOfFirstMonth + months + innerDiff(\"month\", end, start, true);\r\n}\r\n\r\nfunction sameMonth(a, b) {\r\n\treturn webix.Date.equal(webix.Date.monthStart(a), webix.Date.monthStart(b));\r\n}\r\n\r\nfunction addUnit(unit) {\r\n\treturn add[unit];\r\n}\r\n\r\nfunction getUnitStart(unit, start) {\r\n\tlet t;\r\n\tswitch (unit) {\r\n\t\tcase \"year\":\r\n\t\t\treturn new Date(start.getFullYear(), 0, 1);\r\n\t\tcase \"quarter\":\r\n\t\t\treturn new Date(\r\n\t\t\t\tstart.getFullYear(),\r\n\t\t\t\tMath.floor(start.getMonth() / 3) * 3,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\tcase \"month\":\r\n\t\t\treturn new Date(start.getFullYear(), start.getMonth(), 1);\r\n\t\tcase \"week\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setDate(start.getDate() - getDay(start));\r\n\t\t\treturn t;\r\n\t\tcase \"day\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(0, 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tcase \"hour\":\r\n\t\t\tt = new Date(start.getFullYear(), start.getMonth(), start.getDate());\r\n\t\t\tt.setHours(start.getHours(), 0, 0, 0);\r\n\t\t\treturn t;\r\n\t\tdefault:\r\n\t\t\treturn new Date(start);\r\n\t}\r\n}\n\nfunction getMinUnit(scales) {\r\n\tconst start = new Date();\r\n\treturn scales\r\n\t\t.map(item => ({ item, len: addUnit(item.unit)(start, 1) }))\r\n\t\t.sort((a, b) => (a.len < b.len ? -1 : 1))[0].item.unit;\r\n}\r\n\r\n/**\r\n * Resets scales to new parameters and returns the object that stores related constants and functions\r\n * @param {Date} start - start date\r\n * @param {Date} end - end date\r\n * @param {boolean} precise - flag that defines whether to round task position and width to a smaller unit\r\n * @param {number} width - width of smallest cell unit\r\n * @param {number} height - height of scale cell\r\n * @param {Array} scales - a set of scales (objects)\r\n * @param {function} isHoliday - the function that checks if a day is a holiday\r\n * @returns {Object} scales\r\n */\r\nfunction resetScales(\r\n\tstart,\r\n\tend,\r\n\tprecise,\r\n\twidth,\r\n\theight,\r\n\tscales,\r\n\tisHoliday\r\n) {\r\n\t// console.log(\"[x] reset scales\");\r\n\r\n\tconst minUnit = getMinUnit(scales);\r\n\tconst diff = getDiff(minUnit);\r\n\r\n\tconst tempEnd = getUnitStart(minUnit, end);\r\n\tstart = getUnitStart(minUnit, start);\r\n\tend = tempEnd < end ? addUnit(minUnit)(tempEnd, 1) : tempEnd;\r\n\r\n\tconst fullWidth = diff(end, start) * width;\r\n\tconst fullHeight = height * scales.length;\r\n\r\n\tconst rows = scales.map(line => {\r\n\t\tconst cells = [];\r\n\t\tconst add = addUnit(line.unit);\r\n\t\tconst step = line.step || 1;\r\n\t\tconst countInWeeks = minUnit === \"week\" && line.unit !== \"week\";\r\n\r\n\t\tlet date = getUnitStart(line.unit, start);\r\n\t\twhile (date < end) {\r\n\t\t\tlet next = add(date, step);\r\n\r\n\t\t\tif (date < start) date = start;\r\n\t\t\tif (next > end) next = end;\r\n\r\n\t\t\t/**\r\n\t\t\t * Special handling for counting width of greater units in weeks\r\n\t\t\t * this code decides whether a week belongs to the current greater unit based on weekdays of this unit boundaries\r\n\t\t\t * if start day is Thursday+, then this greater unit should not count this week as its own\r\n\t\t\t * if end day is Thursday+, then this greater unit should count this week as its own\r\n\t\t\t */\r\n\t\t\tlet cdate = date;\r\n\t\t\tlet cnext = next;\r\n\t\t\tif (countInWeeks) {\r\n\t\t\t\tif (getDay(date) > 3) {\r\n\t\t\t\t\tcdate = webix.Date.add(date, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t\tif (getDay(next) > 3) {\r\n\t\t\t\t\tcnext = webix.Date.add(next, 1, \"week\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst cellWidth = (diff(cnext, cdate) || 1) * width;\r\n\r\n\t\t\t/*[ToDo] suggestion\r\n\t\t\t value must not be formatted within engine as it depends on app locale\r\n\t\t\t use scales.format function to format dates in UI\r\n\t\t\t*/\r\n\r\n\t\t\tconst value =\r\n\t\t\t\ttypeof line.format === \"function\"\r\n\t\t\t\t\t? line.format(date, next)\r\n\t\t\t\t\t: format(date, line.format);\r\n\r\n\t\t\tlet css = \"\";\r\n\t\t\tif (line.css)\r\n\t\t\t\tcss += typeof line.css === \"function\" ? line.css(date) : line.css;\r\n\r\n\t\t\tcells.push({\r\n\t\t\t\twidth: cellWidth,\r\n\t\t\t\tvalue,\r\n\t\t\t\tcss,\r\n\t\t\t\tdate,\r\n\t\t\t\tformat: formatFunction(line.format),\r\n\t\t\t});\r\n\r\n\t\t\tdate = next;\r\n\t\t}\r\n\r\n\t\treturn { cells, add, height, type: line.unit, step: line.step || 1 };\r\n\t});\r\n\r\n\tprecise = !!(minUnit === \"day\" ? precise : precise != false);\r\n\r\n\treturn {\r\n\t\trows,\r\n\t\twidth: fullWidth,\r\n\t\theight: fullHeight,\r\n\t\tcellWidth: width,\r\n\t\tcellHeight: height,\r\n\t\tdiff,\r\n\t\tstart,\r\n\t\tend,\r\n\t\tminUnit,\r\n\t\tprecise,\r\n\t\tisHoliday,\r\n\t};\r\n}\r\n\r\nfunction grid(width, height, color) {\r\n\tconst canvas = document.createElement(\"canvas\");\r\n\tcanvas.setAttribute(\"width\", width);\r\n\tcanvas.setAttribute(\"height\", height);\r\n\r\n\tconst ctx = canvas.getContext(\"2d\");\r\n\tctx.strokeStyle = color;\r\n\tctx.moveTo(0, height);\r\n\tctx.lineTo(width, height);\r\n\tctx.lineTo(width, 0);\r\n\tctx.stroke();\r\n\r\n\treturn canvas.toDataURL();\r\n}\n\n/**\r\n * Prepares dimensional coordinates for a task\r\n * @param {Object} task - task data object\r\n * @param {number} i - the index of the task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} taskHeight - the height of a task bar\r\n * @param {number} y - the top position of a task after which the current task will be placed (timeline mode)\r\n * @returns {Object} task data object\r\n */\r\nfunction updateTask(task, i, scales, taskHeight, y) {\r\n\tif (task.type === \"split\" && task.$data && task.$data.length) {\r\n\t\ttask.$data.forEach(k => getSizes(k, i, scales, taskHeight));\r\n\t} else {\r\n\t\tgetSizes(task, i, scales, taskHeight, y);\r\n\t}\r\n\treturn task;\r\n}\r\n\r\nfunction getSizes(task, i, scales, taskHeight, y) {\r\n\tconst { start, end, cellWidth, cellHeight, diff, minUnit, precise } = scales;\r\n\tconst startDate = task.start_date < start ? start : task.start_date;\r\n\tconst endDate = task.end_date > end ? end : task.end_date;\r\n\tconst astart = getUnitStart(minUnit, start);\r\n\r\n\tconst ms = task.type == \"milestone\";\r\n\ttask.$h = taskHeight;\r\n\ttask.$x =\r\n\t\tMath.round(diff(startDate, astart, precise) * cellWidth) -\r\n\t\t(ms ? task.$h / 2 : 0);\r\n\ttask.$w = ms\r\n\t\t? task.$h\r\n\t\t: Math.round(diff(endDate, startDate, precise, true) * cellWidth);\r\n\ttask.$y = webix.isUndefined(y)\r\n\t\t? cellHeight * i + (cellHeight - taskHeight) / 2\r\n\t\t: y;\r\n}\r\n\r\n/**\r\n * Updates start, end and duration fields of tasks during initial loading and updating\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - (optional) the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction updateTaskDuration(task, scales, mode, dir) {\r\n\tif (\r\n\t\ttask.start_date &&\r\n\t\ttask.end_date &&\r\n\t\ttask.start_date.valueOf() >= task.end_date.valueOf()\r\n\t) {\r\n\t\ttask.end_date = null;\r\n\t\ttask.duration = 1;\r\n\r\n\t\tif (mode) mode = \"move\";\r\n\t}\r\n\r\n\tif (scales) {\r\n\t\texcludeHolidays(task, scales, mode, dir);\r\n\t} else {\r\n\t\tif (task.type == \"milestone\") {\r\n\t\t\tgetMilestone(task);\r\n\t\t} else {\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.duration = getDuration(task);\r\n\t\t\t}\r\n\t\t\tif (!task.end_date) {\r\n\t\t\t\ttask.end_date = getEnd(task);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Excludes holidays from start, end and duration of tasks (can't start or end on a holiday)\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {string} mode - (optional) update mode, \"start\" or \"end\"\r\n * @param {number} dir - (optional) direction of change (-1 is the past, 1 is the future)\r\n */\r\nfunction excludeHolidays(task, scales, mode, dir) {\r\n\tif (task.type == \"milestone\") {\r\n\t\ttask.start_date = mode\r\n\t\t\t? toWorkday(task.start_date, false, scales, dir)\r\n\t\t\t: toClosestWorkday(task.start_date, scales); //on load\r\n\t\treturn getMilestone(task);\r\n\t}\r\n\r\n\tif (!mode) {\r\n\t\t//on load\r\n\t\ttask.start_date = toClosestWorkday(task.start_date, scales);\r\n\t\ttask.end_date = getEndWorkday(task, scales);\r\n\t\ttask.duration = getDuration(task, scales);\r\n\t} else {\r\n\t\tif (mode == \"start\" || mode == \"move\") {\r\n\t\t\ttask.start_date = toWorkday(task.start_date, false, scales, dir);\r\n\t\t\tif (!task.duration) task.duration = getDuration(task, scales);\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t} else {\r\n\t\t\t//end, duration\r\n\t\t\tif (!task.end_date) task.end_date = getEndWorkday(task, scales);\r\n\t\t\tif (!task.duration) {\r\n\t\t\t\ttask.end_date = toWorkday(task.end_date, true, scales, dir);\r\n\t\t\t\ttask.duration = getDuration(task, scales);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getMilestone(task) {\r\n\ttask.duration = 0;\r\n\ttask.end_date = task.start_date;\r\n}\r\n\r\n/**\r\n * Returns the end date of a task\r\n * @param {Object} task - task data object\r\n */\r\nfunction getEnd(task) {\r\n\tif (task.duration < 1)\r\n\t\treturn addUnit(\"hour\")(task.start_date, Math.floor(24 * task.duration));\r\n\telse return addUnit(\"day\")(task.start_date, task.duration);\r\n}\r\n\r\n/**\r\n * Returns end date excluding holidays from duration\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} end date\r\n */\r\nfunction getEndWorkday(task, scales) {\r\n\tif (task.duration < 1) return getEnd(task);\r\n\r\n\tlet date = getDatePart(task.start_date);\r\n\tfor (let w = 0, d = 0; w < task.duration; ) {\r\n\t\tif (!scales.isHoliday(date)) {\r\n\t\t\t++w;\r\n\t\t\td = 0;\r\n\t\t} else {\r\n\t\t\tif (++d === 30) holidayGuard();\r\n\t\t}\r\n\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Calculates the duration of a task\r\n * @param {Object} task - task data object\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {number} task duration\r\n */\r\nfunction getDuration(task, scales) {\r\n\tconst d = getDiff(\"day\")(task.end_date, task.start_date, true);\r\n\t// allow float duration for tasks smaller than day\r\n\tif (d < 1) return parseFloat(d.toFixed(2));\r\n\r\n\tif (!scales) return Math.floor(d);\r\n\r\n\tlet date = task.start_date;\r\n\tlet duration = 0;\r\n\twhile (date < task.end_date) {\r\n\t\tif (!scales.isHoliday(date)) ++duration;\r\n\t\tdate = addDays(date, 1);\r\n\t}\r\n\treturn duration;\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to the closest working day (priority to the future)\r\n * @param {Date} date - original date\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @returns {Date} the date of a closest work day\r\n */\r\nfunction toClosestWorkday(date, scales) {\r\n\tlet left = date;\r\n\tlet right = date;\r\n\tlet notRight;\r\n\tlet d = 0;\r\n\r\n\twhile (\r\n\t\td < 30 &&\r\n\t\t(notRight = scales.isHoliday(right)) &&\r\n\t\tscales.isHoliday(left)\r\n\t) {\r\n\t\tleft = addDays(left, -1);\r\n\t\tright = addDays(right, 1);\r\n\t\td++;\r\n\t}\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn !notRight ? right : left;\r\n}\r\n\r\nfunction holidayGuard() {\r\n\talert(\r\n\t\t\"No work days found within 30 days, check your isHoliday function!\",\r\n\t\t\"error\"\r\n\t);\r\n\tthrow \"Wrong isHoliday function\";\r\n}\r\n\r\n/**\r\n * Moves a date from a holiday to a working day in the given direction\r\n * @param {Date} date - the current date\r\n * @param {Boolean} end - indicates if this is the end of a task\r\n * @param {Object} scales - the data for current scales; the return value of resetScales()\r\n * @param {number} dir - the direction in which nearest workday will be located; -1 is the past, 1 is the future\r\n * @returns {Date} the date of a working day\r\n */\r\nfunction toWorkday(date, end, scales, dir) {\r\n\tlet d = 0;\r\n\r\n\twhile (d < 30 && scales.isHoliday(getCheckDate(date, end))) {\r\n\t\tdate = addDays(date, dir);\r\n\t\td++;\r\n\t}\r\n\r\n\tif (d === 30) holidayGuard();\r\n\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Returns the date for a holiday check\r\n * @param {Date} date - the date\r\n * @param {Boolean} end - if true, means it's the end date (end dates are exclusive)\r\n * @returns {Date} the date that will be used for a check\r\n */\r\nfunction getCheckDate(date, end) {\r\n\treturn end && !getTimePart(date) ? addDays(date, -1) : date;\r\n}\n\nconst delta = 20;\r\n\r\nconst updateLink = function(link, startTask, endTask, height) {\r\n\tconst dy = Math.round(height / 2);\r\n\tif (!startTask || !endTask) {\r\n\t\tlink.$p = \"\";\r\n\t\treturn link;\r\n\t}\r\n\r\n\tlet sx, sy, ex, ey;\r\n\tlet s_start = false;\r\n\tlet e_start = false;\r\n\r\n\tswitch (link.type) {\r\n\t\tcase 0:\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 1:\r\n\t\t\ts_start = true;\r\n\t\t\te_start = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 3:\r\n\t\t\ts_start = true;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tsx = s_start ? startTask.$x : startTask.$x + startTask.$w;\r\n\tsy = startTask.$y;\r\n\tex = e_start ? endTask.$x : endTask.$x + endTask.$w;\r\n\tey = endTask.$y;\r\n\r\n\tif (differentX(startTask, endTask, sx, ex, height) || sy !== ey) {\r\n\t\tconst lineCoords = getLineCoords(\r\n\t\t\tsx,\r\n\t\t\tsy + dy,\r\n\t\t\tex,\r\n\t\t\tey + dy,\r\n\t\t\ts_start,\r\n\t\t\te_start,\r\n\t\t\t38 / 2\r\n\t\t);\r\n\r\n\t\tconst arrowCoords = getArrowCoords(ex, ey + dy, e_start);\r\n\t\tlink.$p = `${lineCoords},${arrowCoords}`;\r\n\t} else {\r\n\t\tlink.$p = \"\";\r\n\t}\r\n\r\n\treturn link;\r\n};\r\n\r\nfunction differentX(startTask, endTask, sx, ex, height) {\r\n\treturn startTask.type === \"milestone\" || endTask.type === \"milestone\"\r\n\t\t? Math.abs(sx - ex) > height / 2\r\n\t\t: sx !== ex;\r\n}\r\n\r\nfunction getLineCoords(sx, sy, ex, ey, s_start, e_start, gapp) {\r\n\tconst shift = delta * (s_start ? -1 : 1);\r\n\tconst backshift = delta * (e_start ? -1 : 1);\r\n\r\n\tconst sx1 = sx + shift;\r\n\tconst ex1 = ex + backshift;\r\n\tconst line = [sx, sy, sx1, sy, 0, 0, 0, 0, ex1, ey, ex, ey];\r\n\r\n\tconst dx = ex1 - sx1;\r\n\tlet dy = ey - sy;\r\n\r\n\tconst same = e_start === s_start;\r\n\tif (!same && ((ex1 <= sx && e_start) || (ex1 > sx && !e_start))) {\r\n\t\tdy -= gapp;\r\n\t}\r\n\r\n\tif ((same && e_start && sx1 > ex1) || (same && !e_start && sx1 < ex1)) {\r\n\t\tline[4] = line[2] + dx;\r\n\t\tline[5] = line[3];\r\n\t\tline[6] = line[4];\r\n\t\tline[7] = line[5] + dy;\r\n\t} else {\r\n\t\tline[4] = line[2];\r\n\t\tline[5] = line[3] + dy;\r\n\t\tline[6] = line[4] + dx;\r\n\t\tline[7] = line[5];\r\n\t}\r\n\r\n\treturn line.join(\",\");\r\n}\r\n\r\nfunction getArrowCoords(x, y, start) {\r\n\tif (start) {\r\n\t\treturn `${x - 5},${y - 3},${x - 5},${y + 3},${x},${y}`;\r\n\t} else {\r\n\t\treturn `${x + 5},${y + 3},${x + 5},${y - 3},${x},${y}`;\r\n\t}\r\n}\r\n\r\nfunction newLink(box, start, end) {\r\n\tif (start && end) {\r\n\t\tconst width = end.x - start.x;\r\n\t\tconst height = end.y - start.y;\r\n\t\tconst left = (width > 0 ? start.x : end.x) - box.left;\r\n\t\tconst top = (height > 0 ? start.y : end.y) - box.top;\r\n\t\tconst p = `${width > 0 ? 0 : -width},${height > 0 ? 0 : -height},${\r\n\t\t\twidth > 0 ? width : 0\r\n\t\t},${height > 0 ? height : 0}`;\r\n\t\treturn { width: Math.abs(width), height: Math.abs(height), left, top, p };\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n}\n\nexports.addUnit = addUnit;\nexports.getDiff = getDiff;\nexports.getUnitStart = getUnitStart;\nexports.grid = grid;\nexports.newLink = newLink;\nexports.resetScales = resetScales;\nexports.smallerCount = smallerCount;\nexports.updateLink = updateLink;\nexports.updateTask = updateTask;\nexports.updateTaskDuration = updateTaskDuration;\n//# sourceMappingURL=wgantt.js.map\n","import HourscaleView from \"../common/hourscale\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { shrinkTo, isToday } from \"helpers/dates\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class DayEventsView extends HourscaleView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\t// when dayevents is a part of week\n\t\tif (config) {\n\t\t\tthis.WeekDayNum = config.day;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"dayList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"dayList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"day\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.Day = webix.Date.datePart(this.State.date, true);\n\n\t\t\tif (this.WeekDayNum > -1) {\n\t\t\t\tconst weekStart = this.data.start;\n\t\t\t\tthis.Day = webix.Date.add(weekStart, this.WeekDayNum, \"day\", true);\n\t\t\t}\n\n\t\t\tconst to = webix.Date.add(this.Day, 1, \"day\", true);\n\t\t\tthis.Events = this.FilterToday(this.Day, to);\n\n\t\t\tif (this._marker_update_interval)\n\t\t\t\tthis._marker_update_interval = clearInterval(\n\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t);\n\n\t\t\tif (isToday(this.Day))\n\t\t\t\tthis._marker_update_interval = setInterval(() => {\n\t\t\t\t\tif (isToday(this.Day)) this.UpdateMarkerPosition();\n\t\t\t\t\telse {\n\t\t\t\t\t\twebix.html.remove(this._Marker);\n\t\t\t\t\t\tthis._Marker = this._marker_update_interval = clearInterval(\n\t\t\t\t\t\t\tthis._marker_update_interval\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, 5 * 60 * 1000); // 5 minutes\n\n\t\t\tthis.List.render();\n\t\t}\n\t}\n\n\tGetEvent(id) {\n\t\tfor (let i = 0; i < this.Events.length; i++)\n\t\t\tif (this.Events[i].id == id) return this.Events[i];\n\t\treturn null;\n\t}\n\n\tFilterToday(value, to) {\n\t\tif (this.WeekDayNum > -1) {\n\t\t\treturn this.data.single.filter(ev => {\n\t\t\t\treturn ev.start_date < to && ev.end_date > value;\n\t\t\t});\n\t\t}\n\t\treturn this.data.single;\n\t}\n\n\tMarkToday() {\n\t\tif (this.Day && isToday(this.Day)) {\n\t\t\tconst marker = webix.html.create(\"div\", {\n\t\t\t\tclass: \"webix_scheduler_today_marker\",\n\t\t\t});\n\t\t\tthis._Marker = this.List.$view.firstChild.appendChild(marker);\n\t\t\tthis.UpdateMarkerPosition();\n\t\t} else {\n\t\t\tthis._Marker = null;\n\t\t}\n\t}\n\n\tUpdateMarkerPosition() {\n\t\tif (this._Marker) {\n\t\t\tconst current = new Date();\n\t\t\tconst time = current.getHours() * 60 + current.getMinutes();\n\t\t\tthis._Marker.style.top =\n\t\t\t\tMath.round((time * this.List.type.height) / 60) + \"px\";\n\t\t}\n\t}\n\n\tRenderEvents() {\n\t\tconst evs = this.Events;\n\t\tif (evs && evs.length) {\n\t\t\tthis.PrepareEvents();\n\t\t\tconst container = webix.html.create(\"div\", {\n\t\t\t\trole: \"presentation\",\n\t\t\t});\n\t\t\tcontainer.innerHTML = evs.map(i => this.ToHTML(i)).join(\"\");\n\t\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t}\n\t\tthis.MarkToday();\n\t}\n\n\tPrepareEvents() {\n\t\tconst evs = this.Events;\n\t\tlet stack = [];\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\t\t\tev.$inner = false;\n\n\t\t\tlet orderSet = this.PruneStack(ev, stack);\n\n\t\t\tif (stack.length) {\n\t\t\t\tstack[stack.length - 1].$inner = true;\n\t\t\t}\n\n\t\t\tif (!orderSet) {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tev.$sorder = stack[stack.length - 1].$sorder + 1;\n\t\t\t\t\tev.$inner = false;\n\t\t\t\t} else {\n\t\t\t\t\tev.$sorder = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// insert new event into stack\n\t\t\tstack.splice(ev.$sorder, 0, ev);\n\t\t\tif (stack.length > (stack.max_count || 0)) {\n\t\t\t\tstack.max_count = stack.length;\n\t\t\t}\n\t\t}\n\n\t\tthis.SetPosition(stack, evs);\n\t}\n\n\t// returns true if new event was marked for inserting;\n\t// false if stack is empty or there is no suitable place for new event inside\n\tPruneStack(newEvent, stack) {\n\t\t// clean events from top of stack if new event starts after they end\n\t\twhile (\n\t\t\tstack.length &&\n\t\t\tthis.GetEventEndDate(stack[stack.length - 1]) <= newEvent.start_date\n\t\t) {\n\t\t\tstack.splice(stack.length - 1, 1);\n\t\t}\n\n\t\t// clean 1 event from within remaining stack if this event ends before new event starts\n\t\tfor (let j = 0; j < stack.length; j++) {\n\t\t\tif (this.GetEventEndDate(stack[j]) <= newEvent.start_date) {\n\t\t\t\tnewEvent.$sorder = stack[j].$sorder; // mark new event for this place in stack\n\t\t\t\tstack.splice(j, 1);\n\t\t\t\tnewEvent.$inner = true;\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tSetPosition(stack, evs) {\n\t\t//scale start correction\n\t\tconst delta = this.List.getFirstId() * this.List.type.height;\n\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tconst ev = evs[i];\n\n\t\t\tev.$count = stack.max_count;\n\t\t\tlet temp_width = Math.floor(this.List.$width / ev.$count);\n\t\t\tev.$left = ev.$sorder * temp_width;\n\t\t\tif (!ev.$inner) temp_width = temp_width * (ev.$count - ev.$sorder);\n\t\t\tev.$width = temp_width - 8;\n\n\t\t\tconst evCorrectedCopy = shrinkTo(\n\t\t\t\tthis.Day,\n\t\t\t\twebix.Date.add(this.Day, 1, \"day\", true)\n\t\t\t)(ev);\n\t\t\tconst sm =\n\t\t\t\tevCorrectedCopy.start_date.getHours() * 60 +\n\t\t\t\tevCorrectedCopy.start_date.getMinutes();\n\t\t\tconst em =\n\t\t\t\tevCorrectedCopy.end_date.getHours() * 60 +\n\t\t\t\t\tevCorrectedCopy.end_date.getMinutes() || 24 * 60;\n\n\t\t\tev.$top = Math.round((sm * this.List.type.height) / 60) - delta;\n\t\t\tev.$height = Math.max(\n\t\t\t\tthis.minEventHeight,\n\t\t\t\t((em - sm) * this.List.type.height) / 60\n\t\t\t);\n\t\t}\n\t}\n\n\tToHTML(obj) {\n\t\tconst content = this.EventTemplate(obj);\n\t\treturn this.EventTemplateStart(obj) + content + \"</div>\";\n\t}\n\n\tGetEventEndDate(ev) {\n\t\tlet end_date = ev.end_date;\n\t\tconst duration =\n\t\t\t(((ev.end_date - ev.start_date) / 60000) * this.List.type.height) / 60;\n\n\t\tif (duration < this.minEventHeight) {\n\t\t\tend_date = webix.Date.add(\n\t\t\t\tev.start_date,\n\t\t\t\tMath.ceil((this.minEventHeight / this.List.type.height) * 60),\n\t\t\t\t\"minute\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t\treturn end_date;\n\t}\n\n\tEventTemplateStart(obj) {\n\t\tconst css = `class=\"webix_scheduler_day_event ${\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \"webix_scheduler_event_selected\"\n\t\t\t\t: \"\"\n\t\t} ${obj.$past ? \"webix_scheduler_past_event\" : \"\"}\"`;\n\n\t\treturn `<div webix_e_id='${obj.id}' ${css} style='left:${\n\t\t\tobj.$left\n\t\t}px; top:${obj.$top}px; width:${obj.$width}px; height:${\n\t\t\tobj.$height\n\t\t}px; ${dayEventColor(obj)}'>`;\n\t}\n\n\tEventTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst resizer = this.State.readonly\n\t\t\t? \"\"\n\t\t\t: \"<div class='webix_icon webix_scheduler_resizer' webix_resizer='true'></div>\";\n\n\t\treturn `<div class=\"webix_scheduler_inner_day\"><span class=\"webix_scheduler_event_name\">${obj.text ||\n\t\t\t_(\n\t\t\t\t\"(No title)\"\n\t\t\t)}</span><div class=\"webix_scheduler_event_time\">${webix.i18n.timeFormatStr(\n\t\t\tobj.start_date\n\t\t)} - ${webix.i18n.timeFormatStr(obj.end_date)}</div></div>${resizer}`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t * @returns {Date}\n\t */\n\tGetTargetDate(h) {\n\t\tconst date = webix.Date.copy(this.Day || this.State.date);\n\t\tif (h) date.setHours(h);\n\t\treturn date;\n\t}\n\n\t/**\n\t * Sets selected in the global reactive state to display a newly created event\n\t * @param {(string|number)} h - the ID of the hour segment of the main view\n\t */\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tstate.selected = { id: \"0\", date: this.GetTargetDate(h) };\n\t\t}\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class MultidayEventList extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis.MoreIcon = this.$$(\"more\");\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.$$(\"multiDayList\"), \"onAfterRender\", () => {\n\t\t\tthis.app.callEvent(\"events:rendered\", []);\n\t\t});\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile) {\n\t\t\tEditRecurringMixin(this);\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t\t}\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tthis.LimitData(data.multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(data.multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis.SetMoreIcon(this._expandState);\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\t\t} else {\n\t\t\tthis.SetMoreIcon();\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t});\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"up\";\n\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\tthis.List.parse(this._reserve);\n\t\t}\n\t}\n\n\t// height change and delay for animation\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, 150);\n\t}\n\n\tSetMoreIcon(mode) {\n\t\tif (!mode) {\n\t\t\tthis.MoreIcon.setHTML(\"\");\n\t\t} else {\n\t\t\tthis._expandState = mode;\n\n\t\t\tconst tooltip = mode === \"up\" ? \"Collapse\" : \"Expand\";\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.MoreIcon.setHTML(\n\t\t\t\t`<div class=\"webix_scheduler_more_icon webix_icon wxi-angle-${mode}\" webix_tooltip=\"${_(\n\t\t\t\t\t`${tooltip} all-day events`\n\t\t\t\t)}\"><div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.ExpandData();\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MultidayEventList from \"./multiday\";\nimport DayEventsView from \"./events\";\nimport HourscaleView from \"../common/hourscale\";\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class DayView extends JetView {\n\tconfig() {\n\t\tconst header = {\n\t\t\tview: \"template\",\n\t\t\tlocalId: \"header\",\n\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\theight: 32,\n\t\t\ttemplate: obj => {\n\t\t\t\treturn obj.date ? webix.Date.dateToStr(\"%l\")(obj.date) : \"\";\n\t\t\t},\n\t\t};\n\n\t\tconst config = {\n\t\t\tcss: \"webix_scheduler_day\",\n\t\t\trows: [\n\t\t\t\theader,\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"multi\",\n\t\t\t\t\thidden: true,\n\t\t\t\t\tcols: [MultidayEventList],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlocalId: \"scroll\",\n\t\t\t\t\tview: \"scrollview\",\n\t\t\t\t\tcss: \"webix_scheduler_day_scroll\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tcols: [HourscaleView, DayEventsView],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn config;\n\t}\n\n\tinit() {\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tthis.on(state.$changes, \"selected\", v => {\n\t\t\tif (v && !state.clipboard) this.ScrollScale(v);\n\t\t});\n\t}\n\n\tRefreshData(value) {\n\t\tthis.$$(\"header\").setValues({ date: value });\n\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class CalendarView extends JetView {\n\tconfig() {\n\t\tthis.Events = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: (day, isOutside) => this.MarkEvent(day, isOutside),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tmonthHeader: false,\n\t\t\tskipEmptyWeeks: true,\n\t\t\twidth: 0,\n\t\t\theight: 410,\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Calendar.attachEvent(\"onAfterDateSelect\", date => {\n\t\t\tthis.app.getState().date = webix.Date.dayStart(date);\n\t\t});\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tlet { start, weeks, data } = this.data;\n\t\tconst end = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Events = {};\n\n\t\twhile (start < end) {\n\t\t\tconst next = webix.Date.add(start, 1, \"day\", true);\n\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\tif (\n\t\t\t\t\t(data[i].all_day\n\t\t\t\t\t\t? data[i].end_date >= start\n\t\t\t\t\t\t: data[i].end_date > start) &&\n\t\t\t\t\tdata[i].start_date < next\n\t\t\t\t)\n\t\t\t\t\tthis.Events[start.valueOf()] = true;\n\t\t\tstart = next;\n\t\t}\n\n\t\tthis.Calendar.setValue(this.app.getState().date);\n\t}\n\n\t// adds dots to days with events\n\tMarkEvent(day, isOutside) {\n\t\tlet css = \"\";\n\n\t\tif (!isOutside) css += webix.Date.isHoliday(day) || \"\";\n\t\tif (this.Events[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\n\t\treturn css;\n\t}\n}\n","/* eslint-disable indent */\n\nimport { JetView } from \"webix-jet\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { marker, dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreWindowView extends JetView {\n\tconstructor(app, c) {\n\t\tsuper(app);\n\t\tthis.Events = c.events;\n\t\tthis.drag = webix.isUndefined(c.drag) ? true : c.drag;\n\t}\n\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\twidth: 266,\n\t\t\tpadding: 8,\n\t\t\tminHeight: 70,\n\t\t\trelative: \"right\",\n\t\t\tbody: {\n\t\t\t\tview: \"list\",\n\t\t\t\tcss: \"webix_scheduler_more_list\",\n\t\t\t\tborderless: true,\n\t\t\t\tautoheight: true,\n\t\t\t\tyCount: 3,\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate: \"\",\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\twebix_scheduler_month_event: (e, id) => this.ShowEvent(id),\n\t\t\t\t\twebix_scheduler_month_event_single: (e, id) => this.ShowEvent(id),\n\t\t\t\t},\n\t\t\t\ttype: {\n\t\t\t\t\theight: 56,\n\t\t\t\t\ttemplate: (o, c) => this.MoreTemplate(o, c, _),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.drag) initDnD.call(this, view.getBody(), \"more\", true);\n\t}\n\n\tMoreTemplate(obj, _c, _) {\n\t\tconst i18n = webix.i18n;\n\t\tconst single = !daysBetweenInclusive(\n\t\t\tobj.start_date,\n\t\t\tobj.all_day ? webix.Date.add(obj.end_date, 1, \"day\", true) : obj.end_date\n\t\t);\n\t\tconst style = single ? \"\" : dayEventColor(obj);\n\n\t\tconst oneDay =\n\t\t\t!single && this.webix.Date.equal(obj.start_date, obj.end_date);\n\n\t\tlet css = `webix_scheduler_month_event${single ? \"_single\" : \"\"}`;\n\t\tif (obj.$past) css += \" webix_scheduler_past_event\";\n\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${style}\"\n\t\t\t>\n\t\t\t\t${single ? marker(obj) : \"\"}\n\t\t\t\t<div webix_tooltip=\"${obj.text}\" class=\"webix_event_text\">${obj.text ||\n\t\t\t_(\"(No title)\")}</div>\n\t\t\t\t<div class=\"webix_event_time\">\n\t\t\t\t\t${this.DayFormatStr(obj.start_date)}\n\t\t\t\t\t${\n\t\t\t\t\t\toneDay\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: `${i18n.timeFormatStr(obj.start_date)} -\n\t\t\t\t\t\t${single ? \"\" : \" \" + this.DayFormatStr(obj.end_date)}\n\t\t\t\t\t\t${i18n.timeFormatStr(obj.end_date)}`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tDayFormatStr(date) {\n\t\treturn webix.Date.dateToStr(\"%F %j\")(date);\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.Events.getItem(id);\n\t\tthis.app.getState().selected = getParams(obj);\n\t\tthis.HideWindow();\n\t}\n\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node);\n\t}\n\n\tHideWindow() {\n\t\tthis.Win.hide();\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MoreWindowView from \"./more\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { marker, dayEventColor, templateStart } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive, isToday } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MonthEventsView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar\",\n\t\t\tprerender: true,\n\t\t\txCount: 7,\n\t\t\tyCount: 5,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tscroll: false,\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_cal_date: (_ev, id) => this.ShowDay(id),\n\t\t\t\twebix_scheduler_month_event: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_month_event_single: ev => this.ShowEvent(ev),\n\t\t\t\twebix_scheduler_more: (_ev, id) => this.ShowMore(id),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: (_e, id) => this.ShowNew(id),\n\t\t\t},\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplate: (o, c) => this.CalendarTemplate(o, c),\n\t\t\t\ttemplateStart,\n\t\t\t\theaderHeight: 32,\n\t\t\t\teventHeight: 28,\n\t\t\t\tpadding: 8,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tthis.State = this.app.getState();\n\t\tthis.Calendar = view;\n\t\tview.type.master = this.Calendar;\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tview.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.Calendar, \"month\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, view);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\", true); // IE hack\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tCalendarTemplate(obj) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\n\t\tlet html = `<span class=\"webix_cal_date\">${obj.date.getDate()}</span>`;\n\t\tif (obj.$more && obj.$more.length) {\n\t\t\thtml += `<div class=\"webix_scheduler_more\">${obj.$more.length} ${_(\n\t\t\t\t\"more\"\n\t\t\t)}</div>`;\n\t\t}\n\t\treturn html;\n\t}\n\n\tGetDayCss(day, month) {\n\t\tlet css = \"webix_cal_day\";\n\t\tif (isToday(day)) css += \" webix_cal_today\";\n\t\tif (day.getMonth() != month) css += \" webix_cal_outside\";\n\t\telse css += \" \" + (webix.Date.isHoliday(day) || \"\");\n\t\treturn css;\n\t}\n\n\tGetMonthData() {\n\t\tconst data = [];\n\t\tconst { start, weeks } = this.data;\n\t\tconst month = webix.Date.add(start, 1, \"week\", true).getMonth();\n\n\t\tlet day = webix.Date.copy(start);\n\t\tfor (let i = 0; i < weeks * 7; i++) {\n\t\t\tconst obj = {\n\t\t\t\tdate: webix.Date.copy(day),\n\t\t\t\t$css: this.GetDayCss(day, month),\n\t\t\t};\n\n\t\t\tif ((i + 1) % 7 === 0) obj.right = true;\n\t\t\tif (i >= (weeks - 1) * 7) obj.bottom = true;\n\n\t\t\tdata.push(obj);\n\t\t\twebix.Date.add(day, 1, \"day\");\n\t\t}\n\t\treturn data;\n\t}\n\n\tRenderEvents() {\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Calendar.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t\tclass: \"webix_scheduler_month_events\",\n\t\t});\n\n\t\tconst { start } = this.data;\n\t\tconst type = this.Calendar.type;\n\t\tconst maxLines = Math.floor(\n\t\t\t(type.height - type.headerHeight + type.padding - 2) /\n\t\t\t\t(type.eventHeight + type.padding)\n\t\t);\n\n\t\tlet wStart = webix.Date.copy(start);\n\t\tlet wEnd = webix.Date.add(wStart, 1, \"week\", true);\n\n\t\tlet html = \"\";\n\t\tlet cache = {};\n\t\tconst me = this.GetTargetDate(this.Calendar.getLastId());\n\t\tconst ms = this.GetTargetDate(this.Calendar.getFirstId());\n\t\tthis.Calendar.data.each(function(day, dayIndex) {\n\t\t\t// next week\n\t\t\tif (day.date >= wEnd) {\n\t\t\t\tcache = {};\n\t\t\t\twStart = wEnd;\n\t\t\t\twEnd = webix.Date.add(wStart, 1, \"week\", true);\n\t\t\t}\n\n\t\t\tconst more = [];\n\t\t\tconst dayHTML = [];\n\t\t\tthis.Events.data.each(function(ev) {\n\t\t\t\tconst id = ev.id;\n\n\t\t\t\t// will not be this week\n\t\t\t\tif (\n\t\t\t\t\tev.start_date >= wEnd ||\n\t\t\t\t\tev.end_date < wStart ||\n\t\t\t\t\t(!ev.all_day && webix.Date.equal(ev.end_date, wStart))\n\t\t\t\t)\n\t\t\t\t\treturn;\n\n\t\t\t\t// if already processed - check and skip\n\t\t\t\tif (!webix.isUndefined(cache[id])) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(day.date <= ev.end_date && ev.all_day) ||\n\t\t\t\t\t\tday.date < ev.end_date\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (cache[id] >= maxLines) {\n\t\t\t\t\t\t\tmore.push(id);\n\t\t\t\t\t\t} else dayHTML[cache[id]] = \"\";\n\t\t\t\t\t} else delete cache[id];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// today\n\t\t\t\tif (\n\t\t\t\t\tev.start_date < webix.Date.add(day.date, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= day.date\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(dayHTML[index])) index++;\n\n\t\t\t\t\tcache[id] = index;\n\t\t\t\t\tif (index >= maxLines) return more.push(id);\n\n\t\t\t\t\tconst config = { ms, me };\n\t\t\t\t\tconfig.single = this.IsSingleDay(ev);\n\n\t\t\t\t\tconfig.length = 1;\n\t\t\t\t\tif (!config.single) {\n\t\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\t\tconfig.length += daysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(wStart, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(wEnd - 1, config.ee)))\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.index = dayIndex;\n\t\t\t\t\tdayHTML[index] = this.ToHTML(ev, index, config);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tconst prevLength = day.$more && day.$more.length;\n\t\t\tday.$more = more;\n\t\t\tif (prevLength != more.length) this.Calendar.render(day.id, day, \"paint\");\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t}, this);\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Calendar.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tIsSingleDay(ev) {\n\t\tif (ev.all_day)\n\t\t\treturn !daysBetweenInclusive(\n\t\t\t\tev.start_date,\n\t\t\t\twebix.Date.add(ev.end_date, 1, \"day\", true)\n\t\t\t);\n\n\t\tlet len = daysBetweenInclusive(ev.start_date, ev.end_date);\n\n\t\tif (\n\t\t\tlen === 1 &&\n\t\t\twebix.Date.timePart(ev.start_date) &&\n\t\t\t!webix.Date.timePart(ev.end_date)\n\t\t)\n\t\t\tlen = 0;\n\n\t\treturn !len;\n\t}\n\n\tToHTML(obj, index, c) {\n\t\tconst type = this.Calendar.type;\n\t\tconst style = c.single ? \"\" : dayEventColor(obj);\n\t\tconst width = c.length * type.width - type.padding;\n\t\tconst height = type.eventHeight;\n\t\tconst pos = this.GetPosition(type, index, c.index);\n\n\t\tlet extra = \"\";\n\t\tif (c.single) {\n\t\t\textra =\n\t\t\t\tmarker(obj) +\n\t\t\t\t`<span class=\"webix_event_time\">${webix.i18n.timeFormatStr(\n\t\t\t\t\tobj.start_date\n\t\t\t\t)}</span>`;\n\t\t}\n\t\tconst css = this.GetStyle(obj, c);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"height:${height}px;line-height:${height}px; width:${width}px; ${pos +\n\t\t\tstyle}\">\n\t\t\t\t\t${extra + (obj.text || _(\"(No title)\"))}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tlet css = `webix_scheduler_month_event${c.single ? \"_single\" : \"\"}`;\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (!c.single) {\n\t\t\tif (c.es < c.ms && webix.Date.equal(c.ms, webix.Date.dayStart(c.ls)))\n\t\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\t\telse if (\n\t\t\t\tc.ee >= webix.Date.add(c.me, 1, \"day\", true) &&\n\t\t\t\twebix.Date.equal(c.me, webix.Date.dayStart(c.le))\n\t\t\t)\n\t\t\t\tcss += \" webix_scheduler_event_break_right\";\n\t\t}\n\t\treturn css;\n\t}\n\n\tGetPosition(type, index, dayIndex) {\n\t\tconst row = Math.floor(dayIndex / this.Calendar.config.xCount);\n\t\tconst col = dayIndex % this.Calendar.config.xCount;\n\n\t\treturn `\n\t\t\ttop:${row * type.height +\n\t\t\t\ttype.headerHeight +\n\t\t\t\tindex * (type.eventHeight + type.padding)}px;\n\t\t\tleft:${col * type.width}px;\n\t\t`;\n\t}\n\n\tRefreshData() {\n\t\tconst { data, weeks } = this.data;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(data);\n\t\tthis.Events.sort(function(a, b) {\n\t\t\tconst start_a = webix.Date.dayStart(a.start_date);\n\t\t\tconst start_b = webix.Date.dayStart(b.start_date);\n\n\t\t\tif (webix.Date.equal(start_a, start_b)) {\n\t\t\t\tconst days_a = daysBetweenInclusive(a.start_date, a.end_date);\n\t\t\t\tconst days_b = daysBetweenInclusive(b.start_date, b.end_date);\n\t\t\t\treturn days_b - days_a || a.start_date - b.start_date;\n\t\t\t}\n\t\t\treturn start_a - start_b;\n\t\t});\n\n\t\tconst monthData = this.GetMonthData();\n\n\t\tthis.Calendar.clearAll();\n\t\tif (this.Calendar.config.yCount != weeks) {\n\t\t\tthis.Calendar.define(\"yCount\", weeks);\n\t\t\tthis.Calendar.resize();\n\t\t}\n\t\tthis.Calendar.parse(monthData);\n\t}\n\n\tShowMore(id) {\n\t\tthis.MoreWindow.ShowWindow(\n\t\t\tid,\n\t\t\tthis.Calendar.getItemNode(id),\n\t\t\tthis.Calendar.getItem(id).$more || []\n\t\t);\n\t\treturn false;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Calendar.$view);\n\t\tif (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tShowNew(id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetTargetDate(id);\n\t\t\tstate.selected = { id: \"0\", date };\n\t\t}\n\t}\n\n\tShowDay(id) {\n\t\tconst state = this.app.getState();\n\n\t\tstate.$batch({\n\t\t\tdate: this.GetTargetDate(id),\n\t\t\tmode: \"day\",\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of the day in the calendar\n\t * @returns\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.Calendar.getItem(id).date : this.State.date;\n\t}\n\n\t/**\n\t * Returns the data object of an event\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of the event\n\t * @param {Object} newEvent - the data of the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { templateStart } from \"helpers/templates\";\n\nexport default class MonthHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"dataview\",\n\t\t\tcss: \"webix_scheduler_calendar_header\",\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\theight: 32,\n\t\t\tscroll: false,\n\t\t\ttype: {\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: \"auto\",\n\t\t\t\ttemplateStart,\n\t\t\t},\n\t\t};\n\t}\n\n\tinit(view) {\n\t\tview.type.master = view;\n\t\tview.parse(this.GetHeaderData());\n\t}\n\n\tGetHeaderData() {\n\t\tconst data = [];\n\t\tconst k = webix.Date.startOnMonday ? 1 : 0;\n\n\t\tfor (let i = 0; i < 7; i++)\n\t\t\tdata.push({ value: webix.i18n.calendar.dayShort[(k + i) % 7] });\n\n\t\tdata[data.length - 1][\"right\"] = true;\n\t\treturn data;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { events, timeStart } from \"helpers/templates\";\nimport { shrinkTo, isMultiDay } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\n\nexport default class MonthListView extends JetView {\n\tconfig() {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst config = {\n\t\t\tview: \"list\",\n\t\t\ttype: {\n\t\t\t\theight: 50,\n\t\t\t\ttemplate: events(_),\n\t\t\t\ttimeStart: ev => this.TimeStart(ev),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonItemClick: id => this.ShowEvent(id),\n\t\t\t},\n\t\t};\n\n\t\treturn config;\n\t}\n\tinit() {\n\t\tthis.List = this.getRoot();\n\t\tthis.State = this.app.getState();\n\n\t\twebix.extend(this.List, webix.OverlayBox);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) this.RefreshData();\n\t}\n\n\tRefreshData() {\n\t\tconst start = webix.Date.datePart(this.State.date, true);\n\t\tconst end = webix.Date.add(start, 1, \"day\", true);\n\t\tthis.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tthis.List.clearAll();\n\t\t\t\tthis.List.parse(evs.map(shrinkTo(start, end)));\n\t\t\t\tthis.ToggleOverlay();\n\t\t\t});\n\t}\n\n\tToggleOverlay() {\n\t\tif (!this.List.count()) {\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis.List.showOverlay(_(\"No Events\"));\n\t\t} else {\n\t\t\tthis.List.hideOverlay();\n\t\t}\n\t}\n\n\tShowEvent(id) {\n\t\tconst obj = this.List.getItem(id);\n\t\tthis.State.selected = getParams(obj);\n\t}\n\n\tTimeStart(ev) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tif (isMultiDay(ev)) return _(\"All Day\");\n\t\telse return timeStart(ev.start_date, ev.end_date);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport MonthListView from \"./list\";\nimport CalendarView from \"./compact\";\nimport MonthEventsView from \"./events\";\nimport MonthHeaderView from \"./header\";\n\nexport default class MonthView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tconst views = compact\n\t\t\t? [CalendarView, MonthListView]\n\t\t\t: [MonthHeaderView, MonthEventsView];\n\n\t\treturn {\n\t\t\trows: views,\n\t\t};\n\t}\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tconst state = this.app.getState();\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\tRefreshData(value) {\n\t\tlet start = webix.Date.monthStart(value);\n\t\tlet end = webix.Date.add(start, 1, \"month\", true);\n\n\t\tstart = webix.Date.weekStart(\n\t\t\tnew Date(start.getFullYear(), start.getMonth(), 1)\n\t\t);\n\t\tconst weeks = Math.ceil((end - start) / (24 * 60 * 60 * 1000) / 7);\n\t\tend = webix.Date.add(start, weeks, \"week\", true);\n\n\t\tthis.Data.getEvents(start, end).then(data => {\n\t\t\tif (this.app) this.setParam(\"data\", { start, weeks, data }, true);\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class BarView extends JetView {\n\tconfig() {\n\t\tconst active = webix.skin.$active;\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst state = this.getParam(\"state\", true);\n\n\t\treturn {\n\t\t\tview: \"toolbar\",\n\t\t\theight: active.barHeight,\n\t\t\telements: [\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tlabel: _(\"Timeline scale\"),\n\t\t\t\t\tlabelWidth: 120,\n\t\t\t\t\twidth: 260,\n\t\t\t\t\tvalue: state.timelineMode,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{ id: \"day\", value: _(\"Day\") },\n\t\t\t\t\t\t{ id: \"week\", value: _(\"Week\") },\n\t\t\t\t\t\t{ id: \"month\", value: _(\"Month\") },\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: v => {\n\t\t\t\t\t\t\tstate.timelineMode = v;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n}\n","import MoreWindowView from \"../month/more\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\n\nexport default class MoreView extends MoreWindowView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.width = 360;\n\t\tui.relative = \"bottom\";\n\n\t\treturn ui;\n\t}\n\n\tinit(view) {\n\t\tthis.Win = view;\n\n\t\tEditRecurringMixin(this);\n\n\t\t// set dnd mode to timeline to allow dnd between more popup and timeline chart\n\t\tinitDnD.call(this, view.getBody(), \"timelineMore\", true);\n\t}\n\n\t/**\n\t * Show the popup with extra events\n\t * @param {(string|number)} id - the ID of a section\n\t * @param {HTMLElement} node - the HTML element of the section from left part of the timeline chart\n\t * @param {Array<Object>} data - an array of events\n\t * @returns\n\t */\n\tShowWindow(id, node, data) {\n\t\tif (this.ID === id && this.Win.isVisible()) return this.Win.hide();\n\n\t\tthis.ID = id;\n\t\tdata = data.map(v => this.Events.getItem(v));\n\n\t\tconst list = this.Win.getBody();\n\t\tlist.clearAll();\n\t\tlist.parse(data);\n\n\t\tthis.Win.show(node, { x: node.clientWidth }); // here we position the popup to the left of the node as well as bottom\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport {\n\tsmallerCount,\n\tgetUnitStart,\n\tgrid,\n\tupdateTask,\n\taddUnit,\n} from \"@xbs/webix-gantt-lib\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, switchCursor, locateEvent } from \"helpers/dnd\";\nimport { getParams } from \"helpers/recurring\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport MoreWindowView from \"./more\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class ChartView extends JetView {\n\tconfig() {\n\t\tconst height = this.GetSectionHeight();\n\t\tconst compact = this.getParam(\"compact\", true);\n\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\tview: \"treetable\",\n\t\t\t\t\tlocalId: \"sections\",\n\t\t\t\t\tcss: \"webix_scheduler_timeline_sections\",\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\theader: false,\n\t\t\t\t\tscroll: \"y\",\n\t\t\t\t\trowHeight: height,\n\t\t\t\t\tscrollAlignY: false,\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"text\",\n\t\t\t\t\t\t\theader: \"\",\n\t\t\t\t\t\t\tfillspace: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"list\",\n\t\t\t\t\tlocalId: \"list\",\n\t\t\t\t\ttype: { height, template: \"\" },\n\t\t\t\t\tcss: `webix_scheduler_timeline${\n\t\t\t\t\t\twebix.env.touch ? \"_touch\" : \"\"\n\t\t\t\t\t}_bars`,\n\t\t\t\t\tonClick: {\n\t\t\t\t\t\twebix_scheduler_timeline_event: e => this.ShowEvent(e),\n\t\t\t\t\t},\n\t\t\t\t\tonDblClick: {\n\t\t\t\t\t\twebix_list_item: (e, id) => this.ShowNew(e, id),\n\t\t\t\t\t},\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: \"\",\n\t\t\t\t\t},\n\t\t\t\t\tscroll: \"xy\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Tree = this.$$(\"sections\");\n\t\tthis.Bars = this.$$(\"list\");\n\t\tthis.State = this.getParam(\"state\", true);\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Events = new webix.DataCollection({\n\t\t\tscheme: {\n\t\t\t\t$change: obj => this.RefreshTask(obj.id),\n\t\t\t},\n\t\t});\n\n\t\tthis.MoreWindow = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t})\n\t\t);\n\n\t\tSelectionMixin(this, \"month\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis._sectionsReady = this.Data.sections().then(data => {\n\t\t\tthis.Sections = data;\n\t\t\tthis.Tree.parse(data);\n\t\t\tthis.Bars.parse(data);\n\t\t});\n\n\t\tthis.HandleScroll();\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData()\n\t\t);\n\t\t// calendars\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData());\n\t\tthis.on(this.State.$changes, \"active\", (_v, o) => o && this.RefreshData());\n\n\t\tinitDnD.call(this, this.Bars, \"timeline\");\n\t\tthis._mousemove_handler = webix.event(this.Bars.$view, \"pointermove\", e => {\n\t\t\tif (e.pointerType == \"mouse\") switchCursor(e, this.Bars.$view);\n\t\t});\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.Bars);\n\t}\n\n\turlChange() {\n\t\tconst scales = (this.Scales = this.getParam(\"scales\", true));\n\t\tthis.DrawGrid(scales);\n\t\tthis.RefreshData(scales);\n\t}\n\n\tGetSectionHeight() {\n\t\tconst active = webix.skin.$active;\n\t\tthis._sectionSize = 5;\n\t\treturn (active.barHeight - active.borderWidth * 2) * this._sectionSize;\n\t}\n\n\t/**\n\t * Reloads data into timeline\n\t * @param {Object} scales - current chart scales\n\t */\n\tRefreshData(scales) {\n\t\tif (!scales) scales = this.Scales;\n\t\twebix.promise\n\t\t\t.all([this._sectionsReady, this.Data.getEvents(scales.start, scales.end)])\n\t\t\t.then(res => {\n\t\t\t\tthis.ClearCollections();\n\n\t\t\t\tthis.Events.parse(res[1]);\n\t\t\t\tthis.RenderEvents();\n\t\t\t});\n\t}\n\n\tClearCollections() {\n\t\tthis.Events.clearAll();\n\t\tthis._processed = [];\n\t\tthis._lastRow = {};\n\t\tthis._moreEvents = {};\n\t}\n\n\t/**\n\t * Updates task object with new coordinates and allocates it to the correct position inside a section\n\t * @param {(string|number)} updID - the ID of an event\n\t */\n\tRefreshTask(updID) {\n\t\tconst t = this.GetEvent(updID);\n\n\t\tconst sectionIndex = indexOf(this.Sections.data.order, t.section);\n\t\tif (sectionIndex == -1) {\n\t\t\tt.$hide = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst type = this.State.timelineMode;\n\t\tlet unit = this.GetUnitCount(type);\n\t\tif (type !== \"day\" || type !== \"week\") unit = this.GetUnitCount(unit);\n\n\t\tconst prev = this._processed.find(obj => {\n\t\t\tif (obj.section == t.section) {\n\t\t\t\tif (type === \"day\")\n\t\t\t\t\treturn this.CheckDates(obj.end_date, t.start_date, obj.all_day);\n\n\t\t\t\tconst prev = webix.Date.timePart(obj.end_date)\n\t\t\t\t\t? this.GetUnitStart(unit, webix.Date.add(obj.end_date, 1, unit, true))\n\t\t\t\t\t: obj.end_date;\n\t\t\t\tconst next = this.GetUnitStart(unit, t.start_date);\n\t\t\t\treturn this.CheckDates(prev, next, obj.all_day);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tlet y;\n\t\tif (prev) {\n\t\t\ty = prev.$y;\n\t\t\tthis._processed.splice(\n\t\t\t\tthis._processed.findIndex(p => prev.id == p.id),\n\t\t\t\t1\n\t\t\t);\n\t\t} else {\n\t\t\tif (webix.isUndefined(this._lastRow[t.section]))\n\t\t\t\tthis._lastRow[t.section] = 0;\n\t\t\telse this._lastRow[t.section]++;\n\n\t\t\tif (this._lastRow[t.section] >= this._sectionSize - 1) t.$more = true;\n\t\t\telse t.$more = false;\n\t\t}\n\n\t\tthis.UpdateTask(t, sectionIndex, y);\n\n\t\tthis._processed.push(t);\n\t\tthis._processed.sort((a, b) => a.$y - b.$y);\n\t}\n\n\t/**\n\t * Checks if the start of one event follows the end of the previous one\n\t * @param {Date} prev - the end date of the previous event\n\t * @param {Date} next - the start date of the next event\n\t * @param {Boolean} all_day - the flag that indicates that the previous event is all-day (which means that the end date is really 1 day later)\n\t * @returns {Boolean} true if the start follows the end, false otherwise\n\t */\n\tCheckDates(prev, next, all_day) {\n\t\treturn (all_day ? webix.Date.add(prev, 1, \"day\", true) : prev) <= next;\n\t}\n\n\t/**\n\t * Creates a layer with events\n\t */\n\tRenderEvents() {\n\t\tif (this._DataObj) {\n\t\t\tthis.Bars.$view.firstChild.removeChild(this._DataObj);\n\t\t\tdelete this._DataObj;\n\t\t}\n\n\t\t// No Events, No Render\n\t\tif (!this.Events.count() || !this.Bars.count()) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\t\tlet html = \"\";\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tthis.Events.data.each(obj => {\n\t\t\tif (!obj.$hide) {\n\t\t\t\tif (!obj.$more || this._lastRow[obj.section] == 4) {\n\t\t\t\t\thtml += this.BarsTemplate(obj, _);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this._moreEvents[obj.section]) {\n\t\t\t\t\t\tthis._moreEvents[obj.section] = [];\n\n\t\t\t\t\t\thtml += this.MoreBarTemplate(obj, _);\n\t\t\t\t\t}\n\t\t\t\t\tthis._moreEvents[obj.section].push(obj.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.Bars.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\t/**\n\t * Paints a grid\n\t * @param {Object} scales - scales object as returned by this.Local.getScales()\n\t */\n\tDrawGrid(scales) {\n\t\tconst view = this.Bars;\n\t\tconst colors = { contrast: \"#808080\", dark: \"#384047\" };\n\t\tview.$view.style.backgroundImage = `url(${this.GetGrid(\n\t\t\tscales,\n\t\t\tcolors[webix.skin.$name] || \"#ddd\"\n\t\t)})`;\n\t\tview.$view.style.marginTop = \"0px\";\n\n\t\t// sync grid to scroll position\n\t\tview.$view.style.backgroundPosition = `-${this.InnerState.left}px -${this.InnerState.top}px`;\n\n\t\tthis.Resize(scales.width);\n\t}\n\n\t/**\n\t * Changes the width of the root component (list with bars)\n\t * @param {number} width\n\t */\n\tResize(width) {\n\t\tconst area = this.Bars.$view.querySelector(\".webix_scroll_cont\");\n\t\tarea.style.width = width + \"px\";\n\t\tarea.style.minHeight = \"1px\";\n\t}\n\n\t/**\n\t * Handles scrolling\n\t */\n\tHandleScroll() {\n\t\tthis.InnerState = this.getParam(\"innerState\", true);\n\n\t\tthis._scroll_handler = webix.event(this.Bars.$view, \"scroll\", ev => {\n\t\t\tconst bars = ev.target;\n\t\t\tconst top = Math.round(bars.scrollTop);\n\t\t\tconst left = Math.round(bars.scrollLeft);\n\t\t\tthis.Bars.$view.style.backgroundPosition = `-${left}px -${top}px`;\n\t\t\tthis.InnerState.$batch({ top, left });\n\t\t\tthis.Tree.scrollTo(0, top);\n\n\t\t\tthis.MoreWindow.HideWindow();\n\t\t});\n\n\t\tthis.on(this.Tree, \"onScrollY\", function() {\n\t\t\tconst y = this.getScrollState().y;\n\t\t\tthis.$scope.Bars.scrollTo(this.$scope.InnerState.left, y);\n\t\t});\n\t}\n\n\t/**\n\t * Returns a string with HTML of a task node content\n\t * @param {Object} obj - task data\n\t * @param {function} _ - the translator function of jet locale plugin, see https://webix.gitbook.io/webix-jet/part-ii-webix-jet-in-details/plugins#applying-the-locale\n\t * @returns {string} a string with HTML of an event bar\n\t */\n\tBarsTemplate(obj, _) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst scales = this.Scales;\n\n\t\tlet w = obj.$w - 2;\n\t\t// all day events last 1 day longer than their end_date\n\t\tif (obj.all_day && obj.end_date < scales.end) {\n\t\t\tw += this.GetUnitWidth(scales, obj.start_date);\n\t\t}\n\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\">${obj.text ||\n\t\t\t_(\"(no title)\")}</div>`;\n\n\t\tlet css = \"webix_scheduler_timeline_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (obj.start_date < this.Scales.start)\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\telse if (obj.end_date > this.Scales.end)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tconst tooltip = this.GetTooltip(obj);\n\t\treturn `<div webix_e_id=\"${obj.id}\" \n\t\t\twebix_tooltip=\"${tooltip}\" class=\"${css}\" \n\t\t\tstyle=\"left:${obj.$x}px;top:${obj.$y}px;width:${w}px;height:${obj.$h}px;${style}\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Returns a string with a tooltip for an event\n\t * @param {Object} obj - event data\n\t * @returns {string} a string with HTML of a tooltip\n\t */\n\tGetTooltip(obj) {\n\t\treturn obj.text;\n\t}\n\n\t/**\n\t * Defines the looks and contents of the bar that allows to see events that did not fit into a 5-line section\n\t * @param {Object} obj - the event data\n\t * @param {function} _ - the translator function of the Locale plugin\n\t * @returns {string} with the HTML of the bar\n\t */\n\tMoreBarTemplate(obj, _) {\n\t\tconst text = _(\"Show more\");\n\t\tconst content = `<div class=\"webix_scheduler_timeline_content\" webix_tooltip=\"${text}\">${text}</div>`;\n\t\tconst css = \"webix_scheduler_timeline_event webix_scheduler_multi_more\";\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" webix_r_id=\"${obj.section}\" class=\"${css}\" style=\"left:0px;top:${obj.$y}px;width:100%;height:${obj.$h}px;\">\n\t\t\t${content}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Either shows the selected event in Info or opens the list of extra events in a popup\n\t * @param {MouseEvent} e - a native browser event\n\t * @returns {Boolean} always false to prevent bubbling\n\t */\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.Bars.$view);\n\t\tif (event.id === \"$wsh_multi_more\") {\n\t\t\tconst id = event.node.getAttribute(\"webix_r_id\");\n\t\t\tthis.MoreWindow.ShowWindow(\n\t\t\t\tid,\n\t\t\t\tthis.Tree.getItemNode(id),\n\t\t\t\tthis._moreEvents[id] || []\n\t\t\t);\n\t\t} else if (event.id && event.id != \"0\") {\n\t\t\tconst obj = this.GetEvent(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initiates creating a new event\n\t * @param {MouseEvent} e - a native browser event\n\t * @param {(string|number)} id - the ID of a section\n\t */\n\tShowNew(e, id) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst scales = this.Scales;\n\t\t\tconst start = scales.start;\n\n\t\t\tconst unit = scales.precise\n\t\t\t\t? this.GetUnitCount(scales.minUnit)\n\t\t\t\t: scales.minUnit;\n\t\t\tconst n = Math.floor(e.offsetX / this.GetUnitWidth(scales));\n\t\t\tconst date = this.AddUnit(unit, start, n);\n\n\t\t\tstate.selected = { id: \"0\", date, section: id };\n\t\t}\n\t}\n\n\t/**\n\t * Returns the event data by its ID\n\t * @param {(string|id)} id - the ID of an event\n\t * @returns {Object} the event data\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Updates selected in global reactive state\n\t * @param {(string|number)} id - the ID of an event\n\t * @param {Object} newEvent - the new event that should be selected\n\t */\n\tUpdateSelection(id, newEvent) {\n\t\tif (this.State.selected) {\n\t\t\tnewEvent.id = id;\n\t\t\tthis.State.selected = getParams(newEvent);\n\t\t}\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\tconst clickedUnit = this.mousePosUnit || 0;\n\t\tconst scales = this.Scales;\n\t\treturn this.AddUnit(scales.minUnit, scales.start, clickedUnit);\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tGetUnitCount(type) {\n\t\treturn smallerCount[type][0];\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tAddUnit(unit, date, count) {\n\t\treturn addUnit(unit)(date, count);\n\t}\n\n\tGetGrid(scales, color) {\n\t\treturn grid(scales.cellWidth, scales.cellHeight, color);\n\t}\n\n\tUpdateTask(task, sectionIndex, y) {\n\t\treturn updateTask(\n\t\t\ttask,\n\t\t\tthis._lastRow[task.section] + sectionIndex * this._sectionSize,\n\t\t\tthis.Scales,\n\t\t\tthis.Scales.cellHeight - 12,\n\t\t\ty\n\t\t);\n\t}\n\n\tGetUnitWidth(scales, date) {\n\t\tif (\n\t\t\tscales.precise &&\n\t\t\t(scales.minUnit !== \"day\" || scales.minUnit !== \"month\")\n\t\t) {\n\t\t\tconst count = smallerCount[scales.minUnit][1];\n\t\t\tconst number = typeof count === \"number\" ? count : count(date);\n\t\t\treturn Math.floor(scales.cellWidth / number);\n\t\t}\n\t\treturn scales.cellWidth;\n\t}\n}\n\n/**\n * Case-insensitive indexOf\n * @param {Array<any>} arr - the array to be checked\n * @param {any} el - something that you need to find in the array\n * @returns {number} the index of the first found element or -1\n */\nfunction indexOf(arr, el) {\n\tfor (let i = 0; i < arr.length; ++i) {\n\t\tif (arr[i] == el) return i;\n\t}\n\treturn -1;\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class ScalesView extends JetView {\n\tconfig() {\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\treturn {\n\t\t\tcols: [\n\t\t\t\t{\n\t\t\t\t\twidth: compact ? 80 : 200,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_space\",\n\t\t\t\t\tborderless: false,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"template\",\n\t\t\t\t\tlocalId: \"scale\",\n\t\t\t\t\theight: 20,\n\t\t\t\t\tcss: \"webix_scheduler_timeline_scale\",\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tconst scale = this.$$(\"scale\");\n\t\tconst innerState = (this.InnerState = this.getParam(\"innerState\", true));\n\t\tthis.on(innerState.$changes, \"left\", x => scale.scrollTo(x, null));\n\t}\n\n\turlChange() {\n\t\tthis.RenderScales();\n\t}\n\n\t/**\n\t * Renders gantt scales\n\t */\n\tRenderScales() {\n\t\tconst scales = this.getParam(\"scales\", true);\n\t\tconst view = this.$$(\"scale\");\n\t\tconst html = scales.rows\n\t\t\t.map(line => {\n\t\t\t\treturn (\n\t\t\t\t\t`<div class=\"webix_scheduler_timeline_scale_row\" style='height:${line.height}px;width:${scales.width}px'>` +\n\t\t\t\t\tline.cells.map(cell => this.CellTemplate(cell, line.type)).join(\"\") +\n\t\t\t\t\t\"</div>\"\n\t\t\t\t);\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tview.config.height = scales.height;\n\t\tview.setHTML(html);\n\t\tview.resize();\n\t}\n\n\t/**\n\t * Returns the template string for a scale unit\n\t * @param {Object} cell - a scale unit\n\t * @returns {string} - the template string of the scale cell\n\t */\n\tCellTemplate(cell) {\n\t\tconst css = `webix_scheduler_timeline_scale_cell ${cell.css}`;\n\t\treturn `<div class=\"${css}\" style=\"width:${cell.width}px;\">${cell.format(\n\t\t\tcell.date\n\t\t)}</div>`;\n\t}\n\n\tDateIsToday(date) {\n\t\tconst today = webix.Date.dayStart(new Date());\n\t\treturn webix.Date.equal(today, webix.Date.dayStart(date));\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport BarView from \"./bar\";\nimport ScaleView from \"./scale\";\nimport ChartView from \"./chart\";\n\nimport {\n\taddUnit,\n\tresetScales,\n\tgetUnitStart,\n\tsmallerCount,\n} from \"@xbs/webix-gantt-lib\";\n\nimport { createState } from \"jet-restate\";\n\nexport default class TimelineView extends JetView {\n\tconfig() {\n\t\tconst ui = {\n\t\t\trows: [BarView, ScaleView, ChartView],\n\t\t};\n\n\t\treturn ui;\n\t}\n\n\tinit() {\n\t\tconst state = (this.State = this.getParam(\"state\", true));\n\n\t\tconst innerState = (this.InnerState = createState({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t}));\n\t\tthis.setParam(\"innerState\", innerState, true);\n\n\t\tthis.on(state.$changes, \"date\", v => this.SetScales(v, state.timelineMode));\n\n\t\tthis.on(state.$changes, \"timelineMode\", (t, o) => {\n\t\t\tif (o) this.SetScales(state.date, t);\n\t\t});\n\t}\n\n\tSetScales(date, type) {\n\t\tconst scales = this.ResetScales(type, date);\n\t\tthis.setParam(\"scales\", scales, true);\n\t}\n\n\tGetScalesArray(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn [{ unit: \"hour\", format: \"%H:00\" }];\n\t\t\tcase \"week\":\n\t\t\t\treturn [{ unit: \"day\", step: 1, format: \"%d\" }];\n\t\t\tcase \"month\":\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit: \"week\",\n\t\t\t\t\t\tformat: function(start) {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M\");\n\t\t\t\t\t\t\tconst wstart = webix.Date.weekStart(start);\n\t\t\t\t\t\t\tconst wend = webix.Date.add(\n\t\t\t\t\t\t\t\twebix.Date.add(wstart, 1, \"week\", true),\n\t\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t\t\t\"day\",\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn parser(wstart) + \" - \" + parser(wend);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\tdefault: {\n\t\t\t\tconst unit = this.GetDefaultScaleUnit(type);\n\t\t\t\treturn [\n\t\t\t\t\t{\n\t\t\t\t\t\tunit,\n\t\t\t\t\t\tformat: (start, end) => {\n\t\t\t\t\t\t\tconst parser = webix.Date.dateToStr(\"%d %M %YYYY\");\n\t\t\t\t\t\t\treturn parser(start) + \" - \" + parser(end);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t}\n\n\tGetScalesCellWidth(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn 80;\n\t\t\tcase \"week\":\n\t\t\t\treturn 300;\n\t\t\tcase \"month\":\n\t\t\t\treturn 400;\n\t\t\tdefault:\n\t\t\t\treturn 100;\n\t\t}\n\t}\n\n\tGetScalePrecision(type) {\n\t\tswitch (type) {\n\t\t\tcase \"day\":\n\t\t\t\treturn false;\n\t\t\tcase \"week\":\n\t\t\t\treturn false;\n\t\t\tcase \"month\":\n\t\t\t\treturn true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* Method wrappers for gantt-lib functions */\n\n\tAddUnit(unit, date, step) {\n\t\treturn addUnit(unit)(date, step);\n\t}\n\n\tGetUnitStart(unit, date) {\n\t\treturn getUnitStart(unit, date);\n\t}\n\n\tResetScales(unit, date) {\n\t\tconst start = this.GetUnitStart(unit, date);\n\t\tconst end = this.AddUnit(unit, start, 1);\n\t\tconst active = webix.skin.$active;\n\t\treturn resetScales(\n\t\t\tstart,\n\t\t\tend,\n\t\t\tthis.GetScalePrecision(unit),\n\t\t\tthis.GetScalesCellWidth(unit),\n\t\t\tactive.barHeight - active.borderWidth * 2,\n\t\t\tthis.GetScalesArray(unit)\n\t\t);\n\t}\n\n\tGetDefaultScaleUnit(type) {\n\t\treturn smallerCount[type][0] || type;\n\t}\n}\n","import DayEventsView from \"../day/events\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { initDnD } from \"helpers/dnd\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class UnitEventsView extends DayEventsView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"unitList\",\n\t\t\tcss: \"webix_scheduler_day_events\",\n\t\t\tscroll: false,\n\t\t\tautoheight: true,\n\t\t\ttemplate: \"\",\n\t\t\ttype: {\n\t\t\t\theight: 42,\n\t\t\t\tcss: \"webix_scheduler_day_scale_item\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_day_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_scheduler_day_scale_item: (_e, h) => this.ShowNew(h),\n\t\t\t},\n\t\t};\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"unitList\");\n\n\t\tSelectionMixin(this, \"scale\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.List.$setSize = function(x, y) {\n\t\t\tif (webix.ui.view.prototype.$setSize.call(this, x, y)) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\tthis.minEventHeight = 62;\n\t\tthis.ParseHours();\n\n\t\tthis.on(this.State.$changes, \"readonly\", () => this.List.render());\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"units\");\n\n\t\tconst compact = this.getParam(\"compact\", true);\n\t\tif (this.app.config.copypaste && !webix.env.mobile && !compact)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\tFilterToday(value, to) {\n\t\tconst dayEvents = super.FilterToday(value, to);\n\n\t\treturn dayEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tShowNew(h) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = webix.Date.copy(this.Day || state.date);\n\t\t\tconst unit = this.Unit.id;\n\t\t\tdate.setHours(h);\n\t\t\tstate.selected = { id: \"0\", date, unit };\n\t\t}\n\t}\n}\n","import { JetView } from \"webix-jet\";\n\nexport default class UnitsHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 1,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => obj.value,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Header = this.$$(\"header\");\n\n\t\tthis.Units = this.app.getService(\"local\").units();\n\n\t\tthis.Units.then(unitsCache => {\n\t\t\tthis.Header.sync(unitsCache, () => {\n\t\t\t\tthis.Header.define({ xCount: unitsCache.count() });\n\t\t\t\tthis.Header.resize();\n\t\t\t});\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport SelectionMixin from \"helpers/selection\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\nimport { initDnD } from \"helpers/dnd\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\n\nexport default class UnitMultidayList extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app);\n\n\t\tif (config) {\n\t\t\tthis.Unit = config.unit;\n\t\t}\n\t}\n\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"list\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tautoheight: true,\n\t\t\tscroll: false,\n\t\t\tcss: \"webix_scheduler_multilist\",\n\t\t\ttype: {\n\t\t\t\theight: 36,\n\t\t\t\ttemplate: (obj, common) => this.EventTemplate(obj, common),\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: (e, id, node) =>\n\t\t\t\t\tthis.ShowEvent(id, node),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.List = this.$$(\"multiDayList\");\n\n\t\tthis._expandState = \"down\";\n\t\tthis.maxVisibleLines = 3;\n\n\t\tthis._DataObj = this.List.$view.firstChild;\n\t\tSelectionMixin(this, \"multi\", true);\n\n\t\tthis._moreBtn = {\n\t\t\tid: \"$wsh_multi_more\",\n\t\t\t$css: \"webix_scheduler_multi_more\",\n\t\t};\n\n\t\tthis.on(this.app, \"units:multi:state\", state => {\n\t\t\tif (state !== this._expandState) {\n\t\t\t\tstate === \"down\" ? this.WrapData() : this.ExpandData();\n\t\t\t}\n\t\t});\n\n\t\tinitDnD.call(this, this.List, \"multidayUnits\");\n\t\tEditRecurringMixin(this);\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List, { multi: true });\n\t}\n\n\turlChange() {\n\t\tconst data = this.getParam(\"data\");\n\t\tif (data) {\n\t\t\tconst copy = webix.copy(data.multi);\n\t\t\tconst multi = this.FilterByUnits(copy);\n\t\t\tthis.LimitData(multi);\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(multi);\n\t\t}\n\t}\n\n\tEventTemplate(obj, common) {\n\t\tconst height = common.height - 8;\n\t\tconst size = `height:${height}px; line-height:${height}px; width:calc(100% - 5px);`;\n\t\tconst color = obj.id !== \"$wsh_multi_more\" ? dayEventColor(obj) : \"\";\n\t\tconst css = this.GetStyle(obj);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${color}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj) {\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tif (obj.id == \"$wsh_multi_more\") return css;\n\n\t\tconst date = this.State.date;\n\t\tconst end =\n\t\t\t!obj.all_day && !webix.Date.timePart(obj.end_date)\n\t\t\t\t? webix.Date.add(obj.end_date, -1, \"day\", true)\n\t\t\t\t: obj.end_date;\n\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\tif (obj.start_date < date) css += \" webix_scheduler_event_break_left\";\n\t\tif (end >= webix.Date.add(date, 1, \"day\", true))\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\treturn css;\n\t}\n\n\tLimitData(data) {\n\t\tdelete this._reserve;\n\t\tdelete this._reserveIds;\n\t\tif (data.length > this.maxVisibleLines) {\n\t\t\tconst excess = data.length - 2;\n\t\t\tconst _ = this.app.getService(\"locale\")._;\n\t\t\tthis._moreBtn.text = `${excess} ${_(\"more\")}`;\n\n\t\t\tif (this._expandState === \"down\") {\n\t\t\t\tthis._reserve = data.splice(2, excess, this._moreBtn);\n\t\t\t} else {\n\t\t\t\tthis._reserve = data.slice(2);\n\t\t\t}\n\n\t\t\tthis._reserveIds = this._reserve.map(d => d.id);\n\n\t\t\tthis.app.callEvent(\"units:multi:state\", [this._expandState, false]);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tif (this._reserveIds) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tconst height =\n\t\t\t\t\tthis.List.$height -\n\t\t\t\t\t(this._reserveIds.length - 1) * this.List.type.height;\n\t\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\t\tthis.List.add(this._moreBtn);\n\t\t\t\t\tthis.List.remove(this._reserveIds);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tExpandData() {\n\t\tconst expandable = this.List.exists(\"$wsh_multi_more\");\n\t\tif (!this._inAnimation) {\n\t\t\tthis._expandState = \"up\";\n\t\t\tif (expandable) {\n\t\t\t\tthis._inAnimation = true;\n\t\t\t\tthis.Animate(\"up\");\n\n\t\t\t\tthis.List.remove(\"$wsh_multi_more\");\n\t\t\t\tthis.List.parse(this._reserve);\n\t\t\t}\n\t\t}\n\t}\n\n\tAnimate(mode, height, handler) {\n\t\tthis.List.$view.style.transition = \"height 150ms\";\n\t\tif (height) this.List.$view.style.height = `${height}px`;\n\n\t\tsetTimeout(() => {\n\t\t\tif (handler) handler();\n\n\t\t\tthis.List.$view.style.transition = \"\";\n\t\t\tthis._inAnimation = false;\n\t\t}, 150);\n\t}\n\n\tShowEvent(id, node) {\n\t\tif (id === \"$wsh_multi_more\") {\n\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]);\n\t\t} else {\n\t\t\tconst obj = this.List.getItem(id);\n\t\t\tconst sel = getParams(obj);\n\t\t\tsel.node = node;\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tFilterByUnits(multiEvents) {\n\t\treturn multiEvents.filter(obj => {\n\t\t\tif (obj.units) {\n\t\t\t\tconst units = obj.units.split(\",\");\n\t\t\t\tconst unitID = this.Unit.id + \"\";\n\t\t\t\treturn units.indexOf(unitID) !== -1;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\t/**\n\t * Returns the event object by its ID\n\t * @param {(string|number)} id - the ID of the event\n\t * @returns {Object}\n\t */\n\tGetEvent(id) {\n\t\treturn this.List.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for the event\n\t * @returns {Date}\n\t */\n\tGetTargetDate() {\n\t\treturn this.State.date;\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport UnitMultidayList from \"./multidaylist\";\nexport default class UnitMultidayView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst more = ui.cols[0];\n\t\tmore.onClick = {\n\t\t\t\"wxi-angle-down\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"up\", true]),\n\t\t\t\"wxi-angle-up\": () =>\n\t\t\t\tthis.app.callEvent(\"units:multi:state\", [\"down\", true]),\n\t\t};\n\n\t\tui.cols[1] = { cols: [] };\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tui.cols[1].cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitMultidayList))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn ui;\n\t\t});\n\t}\n\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tthis.MoreIcon = this.$$(\"more\");\n\n\t\tthis.on(this.State.$changes, \"date\", () => {\n\t\t\tthis.SetMoreIcon();\n\t\t});\n\n\t\tthis.on(this.app, \"units:multi:state\", (state, animate) => {\n\t\t\tthis.Animate(state, animate ? 150 : 1);\n\t\t});\n\t}\n\n\t/**\n\t * Sets a delay for animation of inner views (collapse/expand)\n\t * @param {string} mode - \"up\" or \"down\" - the direction of the icon\n\t * @param {number} delay - delay in milliseconds\n\t */\n\tAnimate(mode, delay) {\n\t\tsetTimeout(() => {\n\t\t\tthis.SetMoreIcon(mode);\n\t\t}, delay);\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport HourscaleView from \"../common/hourscale\";\nimport UnitEventsView from \"./events\";\nimport UnitsHeaderView from \"./header\";\nimport UnitMultidayView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class UnitsView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\t\tconst units = this.app.getService(\"local\").units();\n\n\t\tconst multi = {\n\t\t\tlocalId: \"multi\",\n\t\t\thidden: true,\n\t\t\tcols: [UnitMultidayView],\n\t\t};\n\n\t\tconst days = {\n\t\t\tlocalId: \"scroll\",\n\t\t\tview: \"scrollview\",\n\t\t\tscroll: \"y\",\n\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\tbody: {\n\t\t\t\tcols: [HourscaleView],\n\t\t\t},\n\t\t};\n\n\t\treturn units.then(unitsCache => {\n\t\t\tconst data = unitsCache.serialize();\n\t\t\tfor (let i = 0; i < data.length; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(UnitEventsView))(this.app, {\n\t\t\t\t\t\tunit: data[i],\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [UnitsHeaderView, multi, days],\n\t\t\t};\n\t\t});\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\t}\n\n\tRefreshData(value) {\n\t\tthis.GetDay(value).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetDay(date) {\n\t\tconst end = webix.Date.add(date, 1, \"day\", true);\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(date, end)\n\t\t\t.then(evs => {\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { multi, single };\n\t\t\t});\n\t}\n}\n","import UnitListView from \"../common/unitlist\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekEventsView extends UnitListView {\n\tconfig() {\n\t\tconst ui = super.config();\n\t\tui.css = \"webix_scheduler_week\";\n\t\tui.type.headerHeight = 28;\n\n\t\treturn ui;\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.List.clearAll();\n\t\t\tthis.List.parse(this.data.all);\n\t\t\tthis.ToggleOverlay();\n\t\t}\n\t}\n\n\tTemplateHeader(datestring) {\n\t\tconst date = new Date(datestring * 1);\n\t\tconst today = isToday(date);\n\n\t\tconst fstring = `%l, %F <span class='webix_scheduler_monthday${\n\t\t\ttoday ? \" webix_scheduler_today\" : \"\"\n\t\t}'>%j</span>`;\n\n\t\treturn `<span class=\"webix_unit_header_inner\">${webix.Date.dateToStr(\n\t\t\tfstring\n\t\t)(date)}</span>`;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport { isToday } from \"helpers/dates\";\n\nexport default class WeekHeaderView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\ttype: \"clean\",\n\t\t\tcols: [\n\t\t\t\t{ borderless: false, width: 51 },\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tlocalId: \"header\",\n\t\t\t\t\tcss: \"webix_scheduler_day_header\",\n\t\t\t\t\txCount: 7,\n\t\t\t\t\tyCount: 1,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 32,\n\t\t\t\t\tscroll: false,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\theight: \"auto\",\n\t\t\t\t\t\twidth: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: obj => {\n\t\t\t\t\t\treturn `<span class=\"webix_scheduler_weekday\">${obj.day}</span> <span class=\"webix_scheduler_monthday\">${obj.date}</span>`;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.RefreshData();\n\t\t}\n\t}\n\n\tRefreshData() {\n\t\tlet start = this.data.start;\n\t\tconst data = [];\n\t\twhile (start < this.data.end) {\n\t\t\tconst obj = {\n\t\t\t\tday: webix.i18n.calendar.dayShort[start.getDay()],\n\t\t\t\tdate: start.getDate(),\n\t\t\t};\n\t\t\tif (isToday(start)) {\n\t\t\t\tobj.$css = \"webix_scheduler_list_today\";\n\t\t\t}\n\t\t\tdata.push(obj);\n\t\t\tstart = webix.Date.add(start, 1, \"day\", true);\n\t\t}\n\n\t\tconst header = this.$$(\"header\");\n\t\theader.clearAll();\n\t\theader.parse(data);\n\t}\n}\n","import MultiMoreView from \"../common/multimore\";\nimport SelectionMixin from \"helpers/selection\";\nimport EditRecurringMixin from \"helpers/editrecurring\";\nimport { dayEventColor } from \"helpers/templates\";\nimport { initDnD, locateEvent } from \"helpers/dnd\";\nimport { daysBetweenInclusive } from \"helpers/dates\";\nimport { getParams } from \"helpers/recurring\";\nimport CopyPasteMixin from \"helpers/copypaste\";\n\nexport default class MultiDayEventsView extends MultiMoreView {\n\tconfig() {\n\t\tconst ui = super.config();\n\n\t\tui.cols[1] = {\n\t\t\tview: \"dataview\",\n\t\t\tlocalId: \"multiDayList\",\n\t\t\tcss: \"webix_scheduler_multidays\",\n\t\t\tscroll: false,\n\t\t\theight: 32,\n\t\t\txCount: 7,\n\t\t\tyCount: 1,\n\t\t\twidth: 0,\n\t\t\ttype: {\n\t\t\t\twidth: \"auto\",\n\t\t\t\theight: \"auto\",\n\t\t\t\titemHeight: 36,\n\t\t\t},\n\t\t\ttemplate: \"\",\n\t\t\ttooltip: {\n\t\t\t\ttemplate: \"\",\n\t\t\t},\n\t\t\tonClick: {\n\t\t\t\twebix_scheduler_multiday_event: e => this.ShowEvent(e),\n\t\t\t},\n\t\t};\n\n\t\treturn ui;\n\t}\n\tinit() {\n\t\tthis.State = this.app.getState();\n\t\tsuper.init();\n\n\t\tSelectionMixin(this, \"multi\");\n\t\tEditRecurringMixin(this);\n\n\t\tthis.Events = new webix.DataCollection({});\n\n\t\tthis.List.attachEvent(\"onAfterRender\", () => this.RenderEvents());\n\t\tinitDnD.call(this, this.List, \"multiday\");\n\n\t\tif (this.app.config.copypaste && !webix.env.mobile)\n\t\t\tCopyPasteMixin(this, this.List);\n\t}\n\n\turlChange() {\n\t\tthis.data = this.getParam(\"data\");\n\t\tif (this.data) {\n\t\t\tthis.ParseDays(this.data.multi);\n\t\t}\n\t}\n\n\tParseDays(events) {\n\t\tif (!events.length) return;\n\n\t\tthis.Events.clearAll();\n\t\tthis.Events.parse(events);\n\n\t\tconst days = [];\n\t\tfor (let d = 0; d < 7; d++) {\n\t\t\tdays.push({\n\t\t\t\tid: d + 1,\n\t\t\t\tdate: webix.Date.add(this.data.start, d, \"day\", true),\n\t\t\t});\n\t\t}\n\t\tthis.BreakEventsByDay(days);\n\n\t\tthis.SetMoreIcon(\n\t\t\tthis._maxEvents > this.maxVisibleLines ? this._expandState : null\n\t\t);\n\n\t\tthis.List.blockEvent();\n\t\tthis.List.parse(days);\n\t\tthis.ResetListHeight();\n\t\tthis.List.unblockEvent();\n\n\t\tthis.RenderEvents();\n\t}\n\n\tBreakEventsByDay(data) {\n\t\tthis.Days = [];\n\t\tconst processed = {};\n\t\tthis._maxEvents = 0;\n\n\t\tdata.forEach((day, dayIndex) => {\n\t\t\tconst today = day.date;\n\t\t\tthis.Days.push([]);\n\n\t\t\tthis.Events.data.each(ev => {\n\t\t\t\tif (!webix.isUndefined(processed[ev.id])) {\n\t\t\t\t\tif ((today <= ev.end_date && ev.all_day) || today < ev.end_date) {\n\t\t\t\t\t\tthis.Days[dayIndex][processed[ev.id]] = \"\";\n\t\t\t\t\t} else delete processed[ev.id];\n\t\t\t\t} else if (\n\t\t\t\t\tev.start_date < webix.Date.add(today, 1, \"day\", true) &&\n\t\t\t\t\tev.end_date >= today\n\t\t\t\t) {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\t// search for the first available index\n\t\t\t\t\twhile (!webix.isUndefined(this.Days[dayIndex][index])) index++;\n\n\t\t\t\t\tprocessed[ev.id] = index;\n\n\t\t\t\t\tconst config = {};\n\t\t\t\t\tconfig.es = ev.start_date;\n\t\t\t\t\tconfig.ee =\n\t\t\t\t\t\t!ev.all_day && !webix.Date.timePart(ev.end_date)\n\t\t\t\t\t\t\t? webix.Date.add(ev.end_date, -1, \"day\", true)\n\t\t\t\t\t\t\t: ev.end_date;\n\n\t\t\t\t\tconfig.length =\n\t\t\t\t\t\t1 +\n\t\t\t\t\t\tdaysBetweenInclusive(\n\t\t\t\t\t\t\t(config.ls = new Date(Math.max(this.data.start, config.es))),\n\t\t\t\t\t\t\t(config.le = new Date(Math.min(this.data.end - 1, config.ee)))\n\t\t\t\t\t\t);\n\n\t\t\t\t\tev.$config = config;\n\t\t\t\t\tthis.Days[dayIndex][index] = ev;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.Days[dayIndex].length > this._maxEvents)\n\t\t\t\tthis._maxEvents = this.Days[dayIndex].length;\n\t\t});\n\t}\n\n\tRenderEvents() {\n\t\tconst allEvents = this.Events.count();\n\n\t\tif (!allEvents) return;\n\n\t\tconst container = webix.html.create(\"div\", {\n\t\t\trole: \"presentation\",\n\t\t});\n\n\t\tlet html = \"\";\n\t\tlet renderedEvents = 0;\n\t\tconst toHide =\n\t\t\tthis._expandState === \"down\" && this._maxEvents > this.maxVisibleLines;\n\n\t\tthis.List.data.each((_day, dayIndex) => {\n\t\t\tconst dayHTML = [];\n\t\t\tconst visible = toHide\n\t\t\t\t? this.maxVisibleLines - 1\n\t\t\t\t: this.Days[dayIndex].length;\n\n\t\t\tfor (let i = 0; i < visible; ++i) {\n\t\t\t\tdayHTML[i] = this.Days[dayIndex][i];\n\n\t\t\t\tif (dayHTML[i]) {\n\t\t\t\t\tdayHTML[i] = this.ToHTML(dayHTML[i], dayIndex, i);\n\t\t\t\t\trenderedEvents++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thtml += dayHTML.join(\"\");\n\t\t});\n\n\t\tif (toHide) {\n\t\t\thtml += this.MoreOption(allEvents - renderedEvents);\n\t\t}\n\n\t\tcontainer.innerHTML = html;\n\t\tthis._DataObj = this.List.$view.firstChild.appendChild(container);\n\t\tthis.app.callEvent(\"events:rendered\", []);\n\t}\n\n\tToHTML(obj, cIndex, rIndex) {\n\t\tconst style = dayEventColor(obj);\n\t\tconst size = this.GetSizePosition(obj.$config.length, cIndex, rIndex);\n\t\tconst css = this.GetStyle(obj, obj.$config);\n\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\treturn `\n\t\t\t<div\n\t\t\t\twebix_tooltip=\"${obj.text || _(\"(No title)\")}\"\n\t\t\t\twebix_e_id=\"${obj.id}\"\n\t\t\t\tclass=\"${css}\"\n\t\t\t\tstyle=\"${size} ${style}\">\n\t\t\t\t\t${obj.text || _(\"(No title)\")}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tGetStyle(obj, c) {\n\t\tconst { start, end } = this.data;\n\t\tlet css = \"webix_scheduler_multiday_event\";\n\t\tcss +=\n\t\t\tthis.State.selected &&\n\t\t\t(obj.id == this.State.selected.id || obj.id == this.State.selected.date)\n\t\t\t\t? \" webix_scheduler_event_selected\"\n\t\t\t\t: \"\";\n\n\t\tif (c.es < start && webix.Date.equal(start, webix.Date.dayStart(c.ls)))\n\t\t\tcss += \" webix_scheduler_event_break_left\";\n\t\tif (\n\t\t\tc.ee >= end &&\n\t\t\twebix.Date.equal(\n\t\t\t\twebix.Date.add(end, -1, \"day\", true),\n\t\t\t\twebix.Date.dayStart(c.le)\n\t\t\t)\n\t\t)\n\t\t\tcss += \" webix_scheduler_event_break_right\";\n\n\t\tcss += obj.$past ? \" webix_scheduler_past_event\" : \"\";\n\n\t\treturn css;\n\t}\n\n\tMoreOption(excess) {\n\t\tconst _ = this.app.getService(\"locale\")._;\n\t\tconst size = this.GetSizePosition(\n\t\t\tthis.List.config.xCount,\n\t\t\t0,\n\t\t\tthis.maxVisibleLines - 1\n\t\t);\n\n\t\treturn `<div webix_e_id=\"$wsh_multi_more\" class=\"webix_scheduler_multiday_event webix_scheduler_multi_more\" style=\"${size}\">${excess} ${_(\n\t\t\t\"more\"\n\t\t)}</div>`;\n\t}\n\n\tGetSizePosition(length, cIndex, rIndex) {\n\t\t// numbers are for space between events and borders of component\n\t\tconst width = length * this.List.type.width - 4;\n\t\tconst height = this.List.type.itemHeight - 8;\n\t\tconst left = this.List.type.width * cIndex + 1;\n\t\tconst top = rIndex * this.List.type.itemHeight + 4;\n\n\t\treturn `width:${width}px; height:${height}px; line-height:${height}px; left:${left}px; top:${top}px;`;\n\t}\n\n\tShowEvent(e) {\n\t\tconst event = locateEvent(e, this.List.$view);\n\t\tif (event.id) {\n\t\t\tif (event.id === \"$wsh_multi_more\") return this.ExpandData();\n\n\t\t\tconst obj = this.Events.getItem(event.id);\n\t\t\tconst sel = webix.extend(event, getParams(obj), true);\n\t\t\tthis.State.selected = sel;\n\t\t}\n\t\treturn false;\n\t}\n\n\tExpandData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\n\t\t\tthis._expandState = \"up\";\n\t\t\tthis.Animate(\"up\");\n\n\t\t\tthis.ResetListHeight(this._maxEvents);\n\t\t}\n\t}\n\n\tWrapData() {\n\t\tif (!this._inAnimation) {\n\t\t\tthis._inAnimation = true;\n\t\t\tthis._expandState = \"down\";\n\n\t\t\tconst height =\n\t\t\t\tthis.List.$height -\n\t\t\t\t(this._maxEvents - this.maxVisibleLines) * this.List.type.height;\n\t\t\tthis.Animate(\"down\", height, () => {\n\t\t\t\tthis.ResetListHeight(this.maxVisibleLines);\n\t\t\t});\n\t\t}\n\t}\n\n\tResetListHeight(count) {\n\t\tif (!count)\n\t\t\tcount =\n\t\t\t\tthis._expandState === \"down\"\n\t\t\t\t\t? Math.min(this._maxEvents, this.maxVisibleLines)\n\t\t\t\t\t: this._maxEvents;\n\n\t\tconst height = count * this.List.type.itemHeight;\n\t\tif (this.List.type.height !== height) {\n\t\t\tthis.List.type.height = height;\n\t\t\tthis.List.define(\"height\", height);\n\t\t\tthis.List.resize();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the data object for an event\n\t * @param {(string|number)} id - the ID of an event\n\t * @returns {Object} - the event object\n\t */\n\tGetEvent(id) {\n\t\treturn this.Events.getItem(id);\n\t}\n\n\t/**\n\t * Returns the target date for an event\n\t * @param {(string|number)} id - the ID of a data item of the main view (corresponds to a day)\n\t * @returns {Date}\n\t */\n\tGetTargetDate(id) {\n\t\treturn id ? this.List.getItem(id).date : this.State.date;\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport DayEventsView from \"../day/events\";\nimport WeekHeaderView from \"./header\";\nimport WeekEventsView from \"./compact\";\nimport HourscaleView from \"../common/hourscale\";\nimport MultiDayEventsView from \"./multiday\";\n\nimport { isMultiDay } from \"helpers/dates\";\n\nexport default class WeekView extends JetView {\n\tconfig() {\n\t\tthis.Compact = this.getParam(\"compact\", true);\n\n\t\tif (this.Compact) {\n\t\t\treturn {\n\t\t\t\trows: [WeekEventsView],\n\t\t\t};\n\t\t} else {\n\t\t\tconst days = {\n\t\t\t\tlocalId: \"scroll\",\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tscroll: \"y\",\n\t\t\t\tcss: \"webix_scheduler_week_days\",\n\t\t\t\tbody: {\n\t\t\t\t\tcols: [HourscaleView],\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst weekLength = 7;\n\t\t\tfor (let i = 0; i < weekLength; ++i) {\n\t\t\t\tdays.body.cols.push(\n\t\t\t\t\tnew (this.app.dynamic(DayEventsView))(this.app, {\n\t\t\t\t\t\tday: i,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\trows: [\n\t\t\t\t\tWeekHeaderView,\n\t\t\t\t\t{ localId: \"multi\", hidden: true, cols: [MultiDayEventsView] },\n\t\t\t\t\tdays,\n\t\t\t\t],\n\t\t\t};\n\t\t}\n\t}\n\tinit() {\n\t\tconst state = this.app.getState();\n\n\t\tthis.on(state.$changes, \"date\", value => this.RefreshData(value));\n\t\tthis.on(state.$changes, \"active\", () => this.RefreshData(state.date));\n\t\tthis.on(this.app, \"events:refresh\", () => this.RefreshData(state.date));\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(state.date)\n\t\t);\n\n\t\tif (!this.Compact) {\n\t\t\tthis.on(state.$changes, \"selected\", v => v && this.ScrollScale(v));\n\t\t}\n\t}\n\n\tRefreshData(date) {\n\t\tconst start = webix.Date.weekStart(date);\n\t\tconst end = webix.Date.add(start, 1, \"week\", true);\n\t\tthis.GetWeek(start, end).then(data => {\n\t\t\t// this.app will be null if compact trigger was called in main.js\n\t\t\tif (this.app) this.setParam(\"data\", data, true);\n\n\t\t\tif (data.multi.length) {\n\t\t\t\tthis.$$(\"multi\").show();\n\t\t\t} else this.$$(\"multi\").hide();\n\t\t});\n\t}\n\n\tGetWeek(start, end) {\n\t\treturn this.app\n\t\t\t.getService(\"local\")\n\t\t\t.getEvents(start, end)\n\t\t\t.then(evs => {\n\t\t\t\tif (this.Compact) {\n\t\t\t\t\treturn { start, end, all: evs };\n\t\t\t\t}\n\n\t\t\t\tconst multi = [],\n\t\t\t\t\tsingle = [];\n\n\t\t\t\tevs.forEach(ev => {\n\t\t\t\t\tif (isMultiDay(ev)) {\n\t\t\t\t\t\tmulti.push(ev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsingle.push(ev);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn { start, end, multi, single };\n\t\t\t});\n\t}\n\n\tScrollScale(v) {\n\t\tif (v.id === \"0\" && !v.date) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst y = (new Date().getHours() + 2) * 40;\n\t\t\t\tthis.$$(\"scroll\").scrollTo(0, y);\n\t\t\t}, 100);\n\t\t}\n\t}\n}\n","import { ignoreInitial } from \"jet-restate\";\nimport { JetView } from \"webix-jet\";\nimport MoreWindowView from \"../month/more\";\n\nexport default class YearCalendarView extends JetView {\n\tconstructor(app, config) {\n\t\tsuper(app, config);\n\n\t\tthis._month = config.month;\n\t}\n\n\tconfig() {\n\t\tthis.DayEvents = {};\n\n\t\treturn {\n\t\t\tview: \"calendar\",\n\t\t\tlocalId: \"calendar\",\n\t\t\tevents: day => this.MarkEvent(day),\n\t\t\ticons: false,\n\t\t\tnavigation: false,\n\t\t\tcalendarHeader: \"%F\",\n\t\t\tskipEmptyWeeks: true,\n\t\t\tborderless: true,\n\t\t\tonClick: {\n\t\t\t\twebix_cal_day_with_event: e => this.ShowEvents(e),\n\t\t\t\twebix_cal_month: () => this.ShowMonth(),\n\t\t\t},\n\t\t\tonDblClick: {\n\t\t\t\twebix_cal_day: e => this.ShowNew(e),\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tonChange: (date, mode) => mode === \"user\" && this.SetStateDate(date),\n\t\t\t},\n\t\t};\n\t}\n\n\tinit() {\n\t\tthis.Data = this.app.getService(\"local\");\n\t\tthis.Calendar = this.getRoot();\n\t\tthis.Events = new webix.DataCollection({});\n\t\tconst state = (this.State = this.app.getState());\n\n\t\tthis.on(state.$changes, \"date\", date => this.ManageDateChange(date));\n\n\t\tthis.on(\n\t\t\tstate.$changes,\n\t\t\t\"active\",\n\t\t\tignoreInitial(() => this.RefreshData(this.GetMonthStart(state.date)))\n\t\t);\n\t\tthis.on(this.app, \"events:refresh\", () =>\n\t\t\tthis.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\t// updates made in form\n\t\tconst events = this.app.getService(\"local\").events(true);\n\t\tthis.on(\n\t\t\tevents.data,\n\t\t\t\"onStoreUpdated\",\n\t\t\t(_i, _o, mode) => mode && this.RefreshData(this.GetMonthStart(state.date))\n\t\t);\n\n\t\tthis.Popup = this.ui(\n\t\t\tnew (this.app.dynamic(MoreWindowView))(this.app, {\n\t\t\t\tevents: this.Events,\n\t\t\t\tdrag: false,\n\t\t\t})\n\t\t);\n\t}\n\n\t/**\n\t * Sets the date in the global reactive state\n\t * @param {Date} date\n\t */\n\tSetStateDate(date) {\n\t\tthis.State.date = webix.Date.dayStart(date);\n\t}\n\n\t/**\n\t * Switches the calendar to a new month and gets events for it\n\t * @param {Date} date\n\t */\n\tManageDateChange(date) {\n\t\tif (!this._date || this._date.getFullYear() != date.getFullYear()) {\n\t\t\tlet monthStart = (this.MonthStart = this.GetMonthStart(date));\n\t\t\tthis.Calendar.showCalendar(monthStart);\n\t\t\tthis.RefreshData(monthStart);\n\t\t}\n\t\tif (this._month === date.getMonth()) this.Calendar.setValue(date);\n\t\telse if (this.Calendar.getValue()) this.Calendar.setValue();\n\t\tthis._date = date;\n\t}\n\n\t/**\n\t * Gets the date at the start of the current month\n\t * @param {Date} date\n\t * @returns {Date}\n\t */\n\tGetMonthStart(date) {\n\t\treturn new Date(date.getFullYear(), this._month, 1);\n\t}\n\n\t/**\n\t * Gets events for the given month\n\t * @param {Date} monthStart - the start of the month\n\t */\n\tRefreshData(monthStart) {\n\t\tthis.DayEvents = {};\n\t\tconst monthEnd = webix.Date.add(monthStart, 1, \"month\", true);\n\n\t\tthis.Data.getEvents(monthStart, monthEnd).then(data => {\n\t\t\tthis.Events.clearAll();\n\t\t\tthis.Events.parse(data);\n\t\t\twhile (monthStart < monthEnd) {\n\t\t\t\tlet next = webix.Date.add(monthStart, 1, \"day\", true);\n\t\t\t\tdata.forEach(obj => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(obj.all_day\n\t\t\t\t\t\t\t? obj.end_date >= monthStart\n\t\t\t\t\t\t\t: obj.end_date > monthStart) &&\n\t\t\t\t\t\tobj.start_date < next\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst dateKey = monthStart.valueOf();\n\t\t\t\t\t\tif (!this.DayEvents[dateKey]) this.DayEvents[dateKey] = [];\n\t\t\t\t\t\tthis.DayEvents[dateKey].push(obj.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmonthStart = next;\n\t\t\t}\n\t\t\tthis.Calendar.refresh();\n\t\t});\n\t}\n\n\t/**\n\t * Adds dots to days with events\n\t * @param {Date} day - the date\n\t * @returns {string} the name of the CSS class\n\t */\n\tMarkEvent(day) {\n\t\tlet css = webix.Date.isHoliday(day) || \"\";\n\t\tif (this.DayEvents[day.valueOf()]) css += \" webix_cal_day_with_event\";\n\t\treturn css;\n\t}\n\n\t/**\n\t * Returns a timestamp of the day that was clicked\n\t * @param {MouseEvent} e - the mouse event\n\t * @returns {number|null} the timestamp or null\n\t */\n\tGetDay(e) {\n\t\tconst day = e.target.innerHTML;\n\t\tif (day) return new Date(this.MonthStart).setDate(day * 1);\n\t\treturn null;\n\t}\n\n\t/**\n\t * Shows a popup with a list of events for the day\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowEvents(e) {\n\t\tconst date = this.GetDay(e);\n\t\tif (date) {\n\t\t\tconst data = this.DayEvents[date];\n\t\t\tthis.Popup.ShowWindow(date, e.target.parentNode, data || []);\n\t\t}\n\t}\n\n\t/**\n\t * Opens this day and opens the form with data for a new event\n\t * @param {MouseEvent} e - the mouse event\n\t */\n\tShowNew(e) {\n\t\tconst state = this.State;\n\t\tif (!state.readonly && !state.clipboard) {\n\t\t\tconst date = this.GetDay(e);\n\t\t\tif (date) {\n\t\t\t\t// no $batch because view needs to be ready\n\t\t\t\tstate.mode = \"day\";\n\t\t\t\tstate.selected = { id: \"0\", date };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Opens the month view for the selected month\n\t */\n\tShowMonth() {\n\t\tthis.State.$batch({\n\t\t\tmode: \"month\",\n\t\t\tdate: this.MonthStart,\n\t\t});\n\t}\n}\n","import { JetView } from \"webix-jet\";\nimport YearCalendarView from \"./calendar\";\n\nexport default class YearView extends JetView {\n\tconfig() {\n\t\treturn {\n\t\t\tview: \"scrollview\",\n\t\t\tbody: {\n\t\t\t\tpadding: 20,\n\t\t\t\tview: \"flexlayout\",\n\t\t\t\tcss: \"webix_scheduler_year\",\n\t\t\t\tcols: this.GetCalendars(),\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Creates 12 calendars for each month of the current year\n\t * @returns {Array} an array of calendar views\n\t */\n\tGetCalendars() {\n\t\tconst calendars = [];\n\t\tfor (let i = 0; i < 12; i++) {\n\t\t\tcalendars.push(\n\t\t\t\tnew (this.app.dynamic(YearCalendarView))(this.app, { month: i })\n\t\t\t);\n\t\t}\n\t\treturn calendars;\n\t}\n}\n","/*Thai (Thailand) locale\n * modified to use Budhist Era Years\n */\n\nwebix.i18n.locales[\"th-TH\"] = {\n   groupDelimiter: \",\",\n   groupSize: 3,\n   decimalDelimiter: \".\",\n   decimalSize: 2,\n   dateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j/%m/${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   timeFormat: \"%G:%i\",\n   longDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(`%j %F ${date.getFullYear() + 543}`);\n      return format(date);\n   },\n   fullDateFormat: (date) => {\n      if (date == null) return \"\";\n      else if (typeof date == \"string\") return date;\n\n      const format = webix.Date.dateToStr(\n         `%j %F ${date.getFullYear() + 543} %G:%i`\n      );\n      return format(date);\n   },\n   am: [\"am\", \"AM\"],\n   pm: [\"pm\", \"PM\"],\n   price: \"฿{obj}\",\n   priceSettings: {\n      groupDelimiter: \",\",\n      groupSize: 3,\n      decimalDelimiter: \".\",\n      decimalSize: 2,\n   },\n   calendar: {\n      monthFull: [\n         \"มกราคม\",\n         \"กุมภาพันธ์\",\n         \"มีนาคม\",\n         \"เมษายน\",\n         \"พฤษภาคม\",\n         \"มิถุนายน\",\n         \"กรกฎาคม\",\n         \"สิงหาคม\",\n         \"กันยายน\",\n         \"ตุลาคม\",\n         \"พฤศจิกายน\",\n         \"ธันวาคม\",\n      ],\n      monthShort: [\n         \"ม.ค.\",\n         \"ก.พ.\",\n         \"มี.ค.\",\n         \"เม.ย.\",\n         \"พ.ค.\",\n         \"มิ.ย.\",\n         \"ก.ค.\",\n         \"ส.ค.\",\n         \"ก.ย.\",\n         \"ต.ค.\",\n         \"พ.ย.\",\n         \"ธ.ค.\",\n      ],\n      dayFull: [\n         \"อาทิตย์\",\n         \"จันทร์\",\n         \"อังคาร\",\n         \"พุธ\",\n         \"พฤหัสบดี\",\n         \"ศุกร์\",\n         \"เสาร์\",\n      ],\n      dayShort: [\"อา.\", \"จ.\", \"อ.\", \"พ.\", \"พฤ.\", \"ศ.\", \"ส.\"],\n   },\n   aria: {\n      dateFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(\n            `%d %F ${date.getFullYear() + 543}`\n         );\n         return format(date);\n      },\n      monthFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`%F ${date.getFullYear() + 543}`);\n         return format(date);\n      },\n      yearFormat: (date) => {\n         if (date == null) return \"\";\n         else if (typeof date == \"string\") return date;\n\n         const format = webix.Date.dateToStr(`${date.getFullYear() + 543}`);\n         return format(date);\n      },\n   },\n};\n","/**\n * webixResources.js\n * This file should include all extra webix resources (components, locales, etc.)\n * This will be bundeled by webpack into a single file and loaded as a dynamic\n * import after webix is loaded.\n *\n * Notes:\n * - use `webpackMode: \"eager\"` comment to include the dynamic import in this\n *   package\n */\n\n// Components\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/gantt/gantt.min.js\"\n).then((gantt) => (window.gantt = gantt));\nimport \"./components/hint/hint.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/kanban/kanban.min.js\"\n).then((kanban) => (window.kanban = kanban));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/pivot/pivot.min.js\"\n).then((pivot) => (window.pivot = pivot));\nimport \"./components/query/query.min.js\";\n// Should use webix/query, querybuilder no longer maintained\n// But we still use this in some places (processing record rules, etc)\nimport \"./components/querybuilder/querybuilder.min.js\";\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/reports/reports.min.js\"\n).then((report) => (window.reports = report));\nimport(\n   /* webpackMode: \"eager\" */\n   \"./components/scheduler/scheduler.min.js\"\n).then((scheduler) => (window.scheduler = scheduler));\n\n// Locales\nimport \"./locales/th-TH.js\";\n"],"names":["webix","config","this","webixJet","_events","_subs","_data","params","extend","JetBase","_root","_detachEvents","_destroySubs","_container","app","_parent","id","value","url","_segment","update","show","parent","view","getParentView","getParam","suburl","toString","root_1","getRoot","queryView","obj","localId","$scope","name","code","attachEvent","push","key","kid","contains","sub","getSubViewInfo","subview","popup","events","i","length","detachEvent","subView","destructor","current","default","branch","child","_getDefaultSub","_routed_view","parse","substr","parts","split","chunks","test","result","pos","indexOf","params_1","_i","dchunk","decodeURIComponent","page","isNew","url2str","stack","stack_1","chunk","obj2str","join","str","encodeURIComponent","route","index","_next","path","Route","slice","setParams","old","kids","reset","concat","_join","Promise","res","rej","redirect","confirm","resolve","callEvent","NavigationBlocked","catch","err","then","_this","n","_super","_children","__extends","JetView","ui","container","jetview","createView","render","setParam","parent_1","target","_renderFrameLock","_show","segment","_init_url_data","_urlChange","linkRouter","getRouter","set","silent","_$view","_$","_$url","message","destroy","_destroyKids","plugin","getUrl","tagName","refresh","_render","root","document","body","toNode","cfg","_render_final","response","slot","$$","reject","copyConfig","oldui","parent_2","asWin","setPosition","isVisible","_init","_initUrl","ready","e","_initError","init","waits","frame","wait","all","urlChange","lock","_renderFrame","next","_createSubView","shift","_override","error","createFromURL","uis","_ui","JetViewRaw","cb","SubRouter","a","append","_once","window","version","start","_services","EventSystem","JetAppBase","_subSegment","handler","getSubView","prototype","$subview","addSubView","isArray","Array","method","point","DataCollection","RegExp","Map","Date","copy","$router","srcElement","getAttribute","trigger_1","_forView","trigger","cancelBubble","preventDefault","route_1","parentNode","clickHandler","views","_loadError","Error","hidden","replace","require","module","__esModule","loadView","over","override","dv","get","router","rest","apply","data","bind","er","debug","console","text","innerHTML","type","expire","event","_first_start","top","base","setTimeout","animation","node_1","html","addCss","removeCss","now","urlString","template","uid","_detectPrefix","onpopstate","HashRouter","routes","compare","history","pushState","prefix","sufix","_getRaw","routerPrefix","location","href","isPatched","patch","w","win","promise","freeze","some","$freeze","resize","baseAdd","baselayout","addView","baseRemove","removeView","jview_1","subs_1","arguments","subs","layout","protoUI","$init","$app","$ready","proxy","JetApp","UrlRouter","pathname","search","_$config","EmptyRouter","has","store","Object","hasOwnProperty","call","forEach","context","warn","x","String","russianPluralGroups","end","pluralTypes","arabic","lastTwo","bosnian_serbian","chinese","croatian","french","german","russian","lithuanian","czech","polish","icelandic","slovenian","pluralTypeToLanguages","pluralTypeName","locale","ret","langToPluralType","langs","lang","en","escape","token","dollarRegex","defaultTokenRegex","transformPhrase","phrase","substitutions","tokenRegex","TypeError","interpolationRegex","options","smart_count","texts","count","pluralTypeIndex","expression","argument","Polyglot","opts","phrases","currentLocale","allowMissing","onMissingKey","suffix","RangeError","constructTokenRegex","interpolation","newLocale","morePhrases","prefixedKey","unset","clear","newPhrases","t","_","webixPolyglot","plugins","_view","storage","setLangData","pconfig","polyglot","poly","service","put","locName","i18n","setLocale","setLang","getLang","setService","once","setSize","appView","appWidth","$width","appHeight","$height","_fillApp","define","width","height","left","setHandlers","$destructed","$view","enable","resizeEv","link","source","defineProperty","createState","handlers","out","observe","mask","undefined","queue","waitInQueue","notify","meta","list","keys","enumerable","configurable","values_1","sconfig","nested","reactive","$extend","val","valueOf","DragScroll","ctx","_auto_scroll_delay","delay","autoScroll","clearTimeout","yScroll","direction","xScroll","box","offset","from","autoYScroll","senseY","autoXScroll","senseX","DragControl","active","node","getNode","$dragPos","style","y","updateDragPos","sense","scroll","getScrollState","autoScrollTo","snode","Math","min","scrollWidth","mode","scrollTo","abs","initDnD","ctrl","master","Local","getService","addDrag","addDrop","getMoveMode","rect","getBoundingClientRect","p","minWidth","env","touch","delta","updateDragScrollConfig","ds","scales","getScales","round","cellWidth","cellHeight","$longTouchLimit","$dragCreate","pointer","State","readonly","getContext","$touch","locateEvent","item","getItem","$group","classList","Modes","getItemNode","isProgressDrag","scroll_1","evContext","getEventContext","step","precise","nsc","getSmallerCount","minUnit","dx","querySelector","parseInt","l","dragScroll","cloneNode","className","visibility","cursor","appendChild","display","$dragDestroy","$waitUpdate","Action","action","finally","remove","$dragIn","s","$dragOut","$drop","time","timeShift","ev","elementFromPoint","locate","changedTouches","touches","pageX","pageY","clientX","clientY","setDragOffset","x_offset","y_offset","nscroll","max","links","css","fromStart","opacity","create","toStart","linkType","targetId","move","progress","prevProgress","progressNode","updateTaskTemplate","zIndex","boxShadow","contrast","dark","skin","$name","isUndefined","DragProgressTemplate","selection","class","tb","floor","offsetX","getIdByIndex","dates","BarsView","borderless","cells","relative","BarsType","on","onItemClick","ItemClickHandler","tooltip","GetTooltip","_a","getChildViews","holidays","bars","Holidays","Links","Bars","Ops","Helpers","local","linkCollection","ldata","LinksData","Calendars","resourceCalendars","HandleScroll","HandleDrag","HandleSelection","InitMarkers","HandleHolidays","$changes","v","SyncData","refreshLinks","RefreshLinks","RenderResourceHolidays","DrawGrid","VisibleTasks","ApplySelection","o","showCriticalPath","assignments","excludeHolidays","task","tasks","updateAssignedTaskDates","updateScaleMinMax","$batch","selected","backgroundImage","drawGridInner","marginTop","state","getState","backgroundPosition","Resize","unselect","clearAll","getVisibleTasksCollection","taskCalendarMap","sync","$data","GetSplitBox","top_1","html_1","order","isLast_1","TemplateStart","BarsTemplate","TemplateEnd","templateStart","isLast","templateEnd","last","first","$x","$w","rwidth","$y","$h","h","diff","BarCSS","contentCss","ContentCss","ceil","sqrt","pow","drag","baseline","planned_start","TemplateBaseline","$x0","$w0","$critical","_mousemove_handler","pointerType","switchCursor","eventRemove","_scroll_handler","markers","m","$interval","clearInterval","temp","scrollTop","scrollLeft","holidaysContainer","containerForMarkers","lines","GetLinks","attrs","viewBox","scrollHeight","setAttribute","SetHolidaysScroll","resources","resourcesDiagram","resHolidaysContainer","selLine","insertBefore","firstChild","ind","getIndexById","exists","ScrollToTask","RenderMarkers","start_date","setInterval","GetMarkerPosition","MarkerTemplate","date","astart","getUnitStart","startOnMonday","links_1","each","$p","critical","criticalPath","isLinkCritical","LinksTemplate","setHTML","tid","find","updateLink","area","minHeight","ops","inProgress","updateTaskTime","refreshTasks","RefreshTaskLinks","updateTask","addLink","newLink","top_2","shift_1","points","map","unit","getSmallerUnit","addUnit","splitCont","sort","b","_b","RenderHolidays","func","dayStart","add","hourOffset","getHours","equal","timePart","html_2","EachScaleDate","isHoliday","HolidayTemplate","calendar","dateStart","isResourceHoliday","ResourceHolidayTemplate","ResourceWorkDayTemplate","taskId","MarkResourceHolidays","GetDateBox","parser","longDateFormatStr","tip","end_date","duration","ScalesView","RenderScales","rows","line","canMarkHolidays","cell","CellTemplate","FormatDate","format","dateToStr","ChartView","ScaleView","hide","DiagramView","WorkloadMarkersType","filterMode","showSubItems","level","LocalState","Unit","Scales","RDCollection","getRDCollection","RestoreTreeState","filter","ToggleBranch","by","dir","as","open","close","getBranch","opened","_treeOpened","clientHeight","t_1","openAll","u","common","MarkerStartTemplate","classname","aria","$level","GetMarkerData","MarkerToHTML","resId","resource_id","calendarId","calendar_id","calendars","d","hourParts","units","markerWidth","halfStep","CheckResourceHoliday","hours","overloaded","CheckOverload","marker","unitLoadNorm","day","number","localeCompare","ignorePunctuation","numeric","arrayEquals","every","includes","TreeView","compact","Compact","columns","header","TreeTemplate","fillspace","batch","tree","prerender","treeWidth","rowHeight","headerRowHeight","scrollAlignY","resizeColumn","headerOnly","size","onViewResize","Tree","onAfterOpen","onAfterClose","onAfterSort","SortTasks","onColumnResize","user","NormalizeColumns","onClick","gti-menu","ToggleColumns","ls","_unit","_collapsed","ShowInUnits","col","columnId","getColumnConfig","refreshColumns","icon","treetable","category","resourceAvatar","space","cols","lastFillspace","showColumnBatch","SetColumns","getColumnIndex","lv","isColumnVisible","cv","vis","hideColumn","showColumn","RDiagramView","elements","onChange","localState","radio","words","BaselineView","icons","autoheight","elementsConfig","labelPosition","padding","right","visibleBatch","label","suggest","autowidth","click","AddBtnClickHandler","RemoveBtnClickHandler","UpdateTaskTime","UpdateTask","Form","Tasks","FillData","showBatch","setValues","vals","f","_eventSource","$eventSource","updateDates","planned_end","planned_duration","getValues","PrepareDates","updatePlannedTaskDuration","blockEvent","unblockEvent","TableView","table","editable","hover","scheme","ttype","c","conf","collection","editor","onBeforeEditStart","onBeforeEditStop","UpdateLink","row","onAfterLoad","wxi-trash","title","DeleteLink","$active","layoutMargin","form","bottom","_id","related","getLinks","editCancel","updateItem","removeLink","editors","gantt_numeditor","inp","ResourcesView","single","IsSingle","button","editaction","ResourceTemplate","listItemHeight","r","OptionTemplate","EditorOptionTemplate","ValueTemplate","editFormat","parseFloat","editParse","isNaN","DeleteIconTemplate","Table","column","editRow","getEditor","getPopup","focus","addCellCss","resource","FilterOptions","onAfterEditStart","getInputNode","range","GetRange","ApplyEditorLimits","GetValueStep","ApplyEditorStep","removeCellCss","ApplyValueRange","UpdateAssignment","webix_gantt_remove_icon","RemoveAssignment","margin","Resources","getAssignments","assignees","GetData","disable","sortResources","tableIds","rInd","updateAssignment","CloseEditor","resourceItem","getResourceValueRange","getResourceValueStep","removeAssignment","ShowPopup","addAssignment","getDefaultResourceValue","EditorTemplate","GetUnitName","getResourceUnit","fitMaster","AddAssignment","Popup","GetPopupConfig","SetPopupPlaceholder","placeholder","getBody","FormView","isResources","aSkin","bar","layoutPadding","inputHeight","Close","Done","types","projects","splice","accItems","collapsed","accordion","multi","ToggleControls","typeSelect","SetResourceHolidays","SetBaselineVisibility","typeList","getList","$count","LimitTypeOptions","SetResourcesVisibility","RemoveTagsFromText","updateTaskDuration","_inProgress","isDirty","Back","exit","edit","arr","els","getTaskCalendar","el","TaskView","editButton","EditTask","info","InfoTemplate","deleteButton","align","inputWidth","DeleteTask","Text","FillTemplate","sources","targets","removeTask","BaseTemplate","LinkTemplate","BaselineTemplateChunk","details","DateFormat","InfoTemplateChunk","ResourcesTemplateChunk","maxWidth","s0","getTextSize","s1","avatar","dpt","TaskPopup","updateConfig","fullscreen","head","maxAvatarNumber","TitleTemplate","dateFormatStr","ResourcesTemplate","unshift","select","wxi-plus","AddTask","wxi-plus-circle","onBeforeOpen","HandleToggle","onBeforeSelect","BeforeSelectHandler","onBeforeDrag","BeforeDragHandler","onBeforeDrop","BeforeDropHandler","Mode","Assignments","pid","$dragHTML","moveTask","resDisplayed","clearEvID","RefreshData","loaders","waitData","GetLoaders","ApplySorting","getSelectedId","pdata","_isTaskVisible","showItem","setState","newTask","GetNewTask","AddTaskWithAssignment","assigned","SplitTaskWithAssignment","splitTaskWithDnd","addTask","GetDates","waitArr","getParentId","rId","sibling","aops","dataSorter","sortState","RefreshTasks","assigned_1","GetAssignmentsHTML","assignedArr","num","pop","lastStr","numStr","TopView","sizeTrigger","_compactValue","_compactHandler","_app","_forceCompact","forceCompact","_compactWidth","compactWidth","_checkTrigger","$setSize","fCompact","SetCompactMode","oid","ShowTask","HideTask","ProgressBar","showProgress","hideProgress","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","resetScales","dateToLocalStr","parseFormat","scaleStart","scaleEnd","oldScale","_scales","_scaleBase","setScales","_taskHeight","refreshResourceTasks","preciseTimeUnit","scaleCellWidth","barHeight","borderWidth","force","_tasks","createTasks","getTreeData","TreeCollection","data->onStoreLoad","data->onStoreUpdated","_links","$change","parseFormatDate","$css","$sort","$serialize","taskOut","$export","updID","k","refreshBaseline","createLinks","found","tcollection","taskParent","$parent","taskSplit","_categories","categories","_resources","rData","ctg","_assignments","aCopy","assign","_calendars","createCalendars","weekDays","datePart","clean","getRange","latestDate_1","isTaskCritical","latestDate","dependent","isNoSlack","nextStart","currentEnd","g","getResourceTree","_calendarMap","refreshCalendarMap","cal","grouping","collections","Infinity","_url","Backend","ajax","json","post","del","_local","_helpers","_back","_state","Operations","addMode","cleanData","added","adjustScale","completeAdd","position","syncProject","inner","updatePlanned","removeAssignments","syncTasks","field","_updatePlannedTaskDuration","change","getWorkDateDiff","p_1","eachSubItem","newDate","changedKid","sign","ad","setProjectData","offsetDate","us","completeRemoval","linkExists","duplicate","oldParent","oldIndex","getBranchIndex","reorderTask","collection_1","waitArr_1","toInteger","dirtyNumber","NaN","Number","requiredArgs","required","args","toDate","argStr","getTime","addDays","dirtyDate","dirtyAmount","amount","setDate","getDate","addMonths","dayOfMonth","endOfDesiredMonth","setMonth","getMonth","daysInMonth","setFullYear","getFullYear","addMilliseconds","timestamp","startOfWeek","dirtyOptions","localeWeekStartsOn","weekStartsOn","defaultWeekStartsOn","getDay","setHours","getTimezoneOffsetInMilliseconds","utcDate","UTC","getMinutes","getSeconds","getMilliseconds","setUTCFullYear","startOfDay","compareAsc","dirtyDateLeft","dirtyDateRight","dateLeft","dateRight","differenceInCalendarMonths","yearDiff","monthDiff","differenceInCalendarYears","differenceInMilliseconds","roundingMap","trunc","getRoundingMethod","endOfDay","endOfMonth","month","isLastDayOfMonth","differenceInMonths","difference","isLastMonthNotFull","year","isLastYearNotFull","quarter","roundingMethod","week","startOfWeekLeft","startOfWeekRight","timestampLeft","timestampRight","differenceInCalendarWeeks","startOfDayLeft","startOfDayRight","hour","minute","smallerCount","months","days","innerDiff","prev","wt","filled","getDiff","sameMonth","daysOfFirstMonth","me","getMonthDayDiff","len","getMinUnit","tempEnd","fullWidth","fullHeight","countInWeeks","cdate","cnext","setSizes","taskHeight","startDate","endDate","ms","toWorkday","toClosestWorkday","getMilestone","getDuration","getEndWorkday","getEnd","setMinutes","setSeconds","setMilliseconds","getDatePart","holidayGuard","toFixed","notRight","alert","getCheckDate","getTimezoneOffset","getTimePart","startTask","endTask","dy","s_start","e_start","sx","sy","ex","ey","differentX","lineCoords","gapp","sx1","ex1","same","getLineCoords","arrowCoords","defaultResourceUnit","defaultResourceValues","resourceValueRanges","resourceValueSteps","initials","match","charAt","toUpperCase","charCodeAt","cssClass","withTooltip","txt","avatarCss","inc","getTaskHeight","color","canvas","createElement","strokeStyle","moveTo","lineTo","stroke","toDataURL","grid","helpers","closedResources","Grouping","_rdCollection","Group","syncRDWithData","getDiagramItemData","groupResourceDiagram","refreshTaskDiagram","updateUnitDurations","updateTaskDiagram","refreshResourceDiagram","assignment","calculateUnitDuration","calculateLoad","truncateX","getUnitLoad","startUnitEnd","load","startUnitStart","endUnitStart","days_1","findUnitDuration","days_2","plusUnit","getDifference","checkHoliday","pruneDiagram","rec","oa","toRemove","eachLeaf","group","collect","_resourcesTree","resourceTaskLoader","syncResourceTree","task_1","tasksWithResources","getResourceTaskData","eachChild","inTree","becomesTask","pId","refreshResourceTree","unassignedBranch","checkResourceOpen","property","ws","sum","j","appId","defaults","dynamic","appNode","addStyle","firstShow","defaultHandler","onShow","use","App","locales","$exportView","export_mode","reload","jetapp","services","Edit","Delete task","Delete link","The task will be deleted permanently, are you sure?","The link will be deleted permanently, are you sure?","Predecessors","Successors","Title","Start date","End date","Duration","Progress","Notes","Type","Project","Milestone","Add task","Add project","(no title)","Save changes?","Related tasks","Task","Link","End to start","Start to start","End to end","Start to end","Lasts","Add assignment","Assignment","Assigned","Delete assignment","Are you sure to delete this assignment?","No resources to add","Unassigned","Hours per","Tasks per","Name","Hours","Split task","Planned dates","Planned dates will be removed, are you sure?","Add dates","Remove dates","$kanban","$skin","_template_types","subtype","on_click","kanban","getKanban","setListStatus","MouseEvents","images","jpg","jpeg","png","gif","ppt","pptx","pptm","pps","ppsx","ppsm","doc","docx","docm","xls","xlsx","xlsm","xlsb","pdf","wav","aif","mp3","mid","mpg","mov","wmv","avi","mp4","zip","jar","rar","gz","isImage","toLowerCase","attachments","comments","cardActions","templateTags","tags","_tags","tag","templateIcons","templateAvatar","users","_users","user_id","image","templateBody","templateAttachments","templateFooter","_colors","KanbanView","on_context","_kanban_event","_fixOrder","$index","sid","tindex","tobj","DataMove","statusChange","dp","status","ignore","webix_move_index","webix_move_id","webix_move_parent","serverStatus","save","_setHandlers","eachOtherList","webix_kanban_user_avatar","_handle_icons","webix_kanban_footer_icon","_typeof","$drag","drag_container","$dropHTML","self","eachList","dtype","dataview","files","sizetext","_format_size","dnd","hideOverlay","showOverlay","getValue","fileSize","uploader","removeIcon","getIconName","percent","preventEvent","defaultSetter","defaultFilter","modal","paddingX","paddingY","_close","$hide","yCount","_statuses","upload","onItemDblClick","getElementsByTagName","values","_removeCard","_fixStatus","$list","_afterInit","_form","_removeBtn","_header","addDropZone","OverlayBox","_sublists","getForm","listIndex","_assignList","_prepareEditor","unselectAll","selectedTask","masterId","contextmenu","cid","showEditor","_hide_chat","_save","serialize","delimiter","provideApi","_strToArr","_destroy_with_me","_data_unification","colors","reconstruct","_initEditor","_initUserList","_initMenu","_initComments","_this2","_applyOrder","oldid","newid","getOwnerList","changeId","_serialize","getTags","getUsers","getColors","getStatuses","cardActions_setter","menu","defer","callback","_this3","_editor","getUserList","_userList","getMenu","_menu","getComments","_comments","_this4","userList","userlist","_this5","setContext","_this6","_this7","chat","_syncData","subList","prevList","_prepareLists","_subfilters","statuses","sets","importData","DataLoader","headerlayout","[object Object]","param","super","jview","$reorderOnly","object","operation","fixMath","math","getField","name2","askin","portlet","Property","plusLabel","inputPadding","webix_pivot_handle_add_value","forms","Add","input","triggerEvent","fields","GetValue","_activeInput","wavg","getFormView","corrections","GetCorrections","CheckCorrections","structure","getStructure","external","ItemConfig","PrepareValue","onBeforeShow","FilterSuggest","ListTemplate","pivotPropertyRemove","activeVal","isSymbolAllowed","char","getLastSymbolIndex","startsWith","_addFirst","$enterKey","selectionStart","substring","nextSymbol","disabled","operations","suggestClick","activeElement","UIManager","getFocus","setValue","setValueHere","formula","str1","str2","lastSymbol","$setValue","setSelectionRange","ValuesProperty","typeName","ToggleColors","OutComplexMath","def","defaultOperation","defIndex","findIndex","SetOperation","getOperation","SuggestData","mini","palette","getPalette","getValueColor","fieldsRegex","fieldsMatch","matchAll","methods","methodsRegex","methodsMatch","GroupProperty","oldValue","ChartSettings","complexData","labelWidth","labelRight","checkValue","uncheckValue","OutValues","innerChange","chart","HandleVisibility","InValues","stackedArea","stacked","horizontal","TableSettings","datatable","footer","totalColumn","FilterView","filters","filterObj","collectFieldValues","ModeView","toolbarHeight","optionWidth","SetMode","dataPadding","ToolbarView","buttonHeight","ToggleConfig","webix_pivot_settings","scrollSize","$customScroll","_GetScrollWidth","GetFilters","filterPopup","filtersView","FiltersChanged","ToggleReadonly","oldStructure","JSON","stringify","FilterConfig","activeCss","condition","webix_pivot_filter","Show","outer","scrollbarWidth","offsetWidth","removeChild","$mainView","xAxis","yAxis","commonAxisSettings","scaleColor","lineColor","IsPieBased","multilevel","ValueFormat","pieInnerText","LoadData","getData","UpdateChart","removeAllSeries","SetSeries","SetLegend","addSeries","GetSeriesConfig","settings","alpha","borderColor","legend","valign","hotkey","ToggleForm","GroupConfig","_v","HandleFieldChange","SetValues","oldMode","isChart","SetValue","CorrectFilters","CorrectInputs","setStructure","groupBy","inputs","ShowConfig","HideConfig","leftSplit","UpdateTable","CheckFreeze","rightSplit","totalCols","totalOps","total","lastId","colspan","totalIndex","_store","_prepareData","marks","Proxy","prop","freezeColumns","SetFirstColumn","CellFormat","cssFormat","rid","HeaderTemplate","asc","desc","DataDimension","_sort","_label","_meta","_table","_getter","_prepared","_indexes","_values","_prepareOptions","_keys","fSize","indexes","DataExport","pivot","_pivot","cleanRows","maxRow","getLimit","resetCursor","Set","rAggr","rowData","cAggr","scaleWidth","getWidth","_cleanRows","columnData","aggregateColumns","mark","getXHeader","rowsLength","Function","propertyName","methodName","contextName","optimize","allMath","getMath","to","array","getter","cache","optimizeRangeGroup","optimizeGroup","rule","getColumn","and","buildFinder","check","build","DataPivot","_rows","_cols","_dims","_context","_cursor","_order","_base_order","getIndexes","_group","_nextRow","_nextColumn","_ops","dimsSize","_fillRow","dimSize","dimOutSize","levels","_groupOps","_groupLength","limit","_sizes","getSize","closeLevels","kAgr","vAgr","z","_fillGroupRow","hConfig","_opInfo","nonEmpty","isNested","rpref","ostep","unitsInParent","reduce","fullLength","unitSizes","opNames","rowspan","getLabel","metaLine","getMeta","rules","_masterRules","_groupResultOps","branchMode","branchMath","_rowResultOps","compactOps","op","_rowOps","_colResultOps","_colOps","_marks","_setSizes","dmr","opsLength","rarr","_fillGroupRowInner","rl","collectRaggr","ctemp","cfrom","cind","cto","opset","dataset","raws","dimsData","ok","sizes","kind","optimizer","getName","trim","RawTable","_columns","_raw","_parse_inner","dataLength","columnsLength","setter","ColumnTable","_parse_init","acc","avg","summ","any","eq","neq","gt","gte","lt","lte","in","hasPrefix","predicates","Analytic","_tables","_dimensions","_preds","_maths","_comps","tables","addTable","dimensions","addDimension","_predicateGetter","preserve","used","driver","prepare","rDims","cDims","fn","LocalData","_filtersHash","externalProcessing","_setOperations","_initRengine","extraOperations","_reng","addMath","totalOperations","addComparator","addPredicate","firstRow","dataType","useOldData","_dataLoad","_rengineToWebix","getTable","getPivotData","loadError","newConfig","_old","rengine.Analytic","_setFilters","_setTotalOperations","_setPredicates","setDimensions","getRows","getColumns","getLimits","getOps","headerConfig","toArray","toNested","toXHeader","isComplex","_updateTotalMath","minY","maxY","minX","maxX","getChartData","getHeader","_toTree","getFields","prepareData","fieldObj","hash","predicate","replaceAll","struct","hdata","resetDimensions","chartType","axis","pieGroup","rowIndex","columnIndex","scale","initJetWin","prepareStructure","initial","exportView","Chart","Click to configure","Configure Pivot","Total","Fields","Methods","Columns","Add column","Rows","Add row","Clean rows","Filters","Add filter","Group By","Chart type","Logarithmic scale","X axis title","Y axis title","Scale color","Circled lines","Horizontal","Stacked","Lines","Line","Radar","Bar","Area","Spline","Spline Area","Pie","Donut","Values","Add value","Field not defined","Highlight","Min X","Max X","Min Y","Max Y","Footer","Total Column","Off","On","Sum Only","3D","Show values inside","complex","Incorrect formula in values","ignoreInitial","withContext","BaseExportView","subMenuPos","subsign","GetTemplate","submenuConfig","onMenuItemClick","PopupAction","BaseToolbarView","ShowExportPopup","viewId","ExportMenu","Toolbar","Charts","Host","mod","Export","host","CheckColumns","config_1","GetChartConfig","GetChartData","seriesFrom","ConvertDataBySeries","FormatLabels","numLimit","labelColumn","labelOptions","option","legendPosition","series","axises","seriesConfig","ApplyTypeConfig","onAfterRender","CorrectLabels","GetLegendConfig","logarithmic","verticalLabels","itemTypes","itemSupport","markerType","getDataConfig","getOptions","fill","radius","fillMarker","disableItems","border","baseColumn","dataColumn","aRow","toPNG","toPDF","bindOut","subkey","newValue","bindIn","_value","global","factory","heatmap","empty","main","alt","CommonView","JoinListTemplate","webix_rpt_action_remove","RemoveJoin","ShowJoins","AppState","Models","getModels","ShowDeleteButton","SourcesList","JoinTemplate","AddJoin","addJoin","joins","cleanLinkedModels","block","sf","tf","getLinkedModels","toolbar","prompt","getTopParentView","newname","selectMask","$cssName","webix_rpt_qselect_icon","richselect","exports","extendStatics","setPrototypeOf","__proto__","__","constructor","__assign","getUrlString","_loadViewDynamic","_loop_1","webix$1","key2","ActionsPopupView","Item","Hide","BaseView","GetButton","GetList","AND","OR","GLUE","glue","editCss","DisableSwitch","Template","action-menu","Actions","action-close","Delete","wbq-filter_join","SwitchGlue","EditStart","EditStop","AddGroup","LastValue","ConvertTo","ConvertFrom","after","getFirstId","CreateMode","Save","DeleteSilent","grand","pIndex","Active","ActiveId","asString","Format","AdjustToField","ApplyFilter","GetField","fselect","CreateFilter","conditions","place","FilterPopup","at","TopBarView","TopListView","log","queryToFilter","query","con","singleFilter","glueOr","glueAnd","simple","GetFilter","getFilterFunction","notEqual","less","greater","greaterOrEqual","lessOrEqual","notContains","beginsWith","notBeginsWith","endsWith","notEndsWith","between","notBetween","or","Add Filter","Add Group","Apply","Cancel","amd","QueryView","getFieldData","model","fixDates","$observe","QueryBuilderView","DeleteQuery","CopyQuery","RenameQuery","SaveQuery","QSelectTemplate","onClearClick","NewQuery","Query","qData","Queries","getQueries","saved","models","changed","saveBtn","updateQuery","addQuery","cancel","deleteQuery","QueryMenu","tabbar","tabMinWidth","ShowView","newModule","ChangeModule","ChangeModel","ShowHideButton","timer","debounce","TrackChanges","_key","oldColumns","numColumns","UpdateMeta","publicFields","prev_1","groupColumns","was_1","now_1","Reset","getModuleSaveData","moduleId","updateModule","SaveCallback","addModule","getModule","setDataSource","InitStateValue","InitName","getSeries","masterName","SummaryPopupView","ClickHandler","GetOptions","ApplyAction","SetActionStates","disableItem","enableItem","pstate","ParentState","BucketView","ValueSeparator","other","Changed","isNotEmpty","AddNewBucket","Forms","GetRowKeys","Data","Sort","CreateForm","Focus","keys_1","GetColumnData","baseOptions","keyOption","appState","moduleConfig","buckets","getOptionsList","LoadBuckets","AddBucket","bucket","LoadOther","GetRowForm","separator","ActiveForm","GetValues","otherForm","otherName","validate","names","ForEachFormRow","markInvalid","CorrectValues","GetValidBuckets","$checked","DeleteBucket","Master","List","AddColumn","View","onEnter","getSelectedItem","BucketState","Find","adjust","GetColumns","selectIcon","modifiers","renderModifier","_modifiers","$renderTag","content","removeItem","webix_rpt_date_selector","multicombo","getModifier","setModifier","_custom_last_size","px","py","BucketSettingsView","Views","ShowColumns","Update","RowTemplate","ToggleSub","_hasFocus","onSubViewOpen","HideAllEditors","onSubViewClose","ResetEditor","webix_rpt_bucket_delete","RemoveColumn","newColumn","ColumnList","BucketPopup","tableData","_ActiveEditor","newV","oldV","openSub","subrow","prevId","closeSub","FocusEditor","$subopen","DateView","GetPopupTemplate","ActiveGroup","isSelected","Summaries","labels","AddNewAggregation","GroupState","SummaryColumns","ValidateFormData","aggregate","LoadAggregations","ApplyOneRowMode","AddAggregation","summary","aggregation","GetDefaultFormData","formId","GetOperations","onTimedKeypress","NewColumnTemplate","this_1","DeleteAggregation","formList","valid","oId","cId","ChangeNewColumnName","OtherSettingsView","GetDateOptions","ChangeGroupBy","onModifierClick","ShowModifierPopup","groupState","LoadColumns","DatePopup","DatePopupView","ToggleGroupBy","ToggleBuckets","ToggleSortBy","gravity","ChangeSortBy","ChangeDirection","sortBy","chartState","Axis","ChartState","AxisPropertiesView","labelAlign","ApplyYAxis","ApplyXAxis","BaseStructureView","SaveOrder","Id","ColorPopupView","onColorSelect","GetSeries","updatedSeries","closeIcon","$renderInput","badge","webix_input_icon","hideCloseIcon","_onSearch","showCloseIcon","setIcon","nodes","getElementsByClassName","setBadge","Series","SeriesPropertiesView","ItemListTemplate","getItemTypes","getTypes","labelField","ChangeLabelField","valueFields","SubState","UpdateSeries","SeriesProperties","onAfterDrop","data->onClearAll","webix_rpt_chart_color","ShowColorPopup","action-visible","HideField","action-hidden","ShowField","webix_rpt_config_row_name","axisFields","UpdateAxis","AxisProperties","AxisRowTemplate","legendFields","ChangeLegend","GetDataInputs","Types","ValueFields","GetInitState","UpdateModuleState","ApplyChartType","ApplySeriesFrom","GenerateSeries","prevType","ShowAxisInputs","RenderSeries","LoadSeries","noAxisSupport","sourceArray","ApplySeriesKeys","base_1","prevValue","ColorPopup","ActiveSeries","Column","ColumnPropertiesView","valueField","colorField","lc","vc","cc","OnChange","StructureView","ChangeReportType","ColumnsView","onSearchChange","FilterFields","ColumnProperties","FrozenTemplate","GetFreeze","freezeColumn","EmptyView","mods","getModules","GetText","GetSVG","CssFactory","TooltipFactory","bases","valueColumn","colorColumn","props","MenuPopup","ID","trg","GridsView","GetListTemplate","webix_rpt_action_menu","Menu","onDblClick","onAfterSelect","LoadModule","Sorting","SearchCompare","parsed","updated","sState","prevState","ChangeSortButtons","btn","prevBtn","ExportView","typeToSort","boolean","picklist","reference","$selection","plainOutput","filterHTML","toExcel","toCSV","GetTableConfig","table_1","GetTableData","IsBucketColumn","groups","dateColumns","gColumns","GetColumnConfig","byUser","SetColWidth","_1","Tbl","setColumnWidth","clearCss","ignoreDateNumber_1","hasNonDigits","regexp_1","wildToRegexp","matchers_1","colId","optionsMatch_1","findOptions","matchPerColumn","dateFormats_1","found_1","addHotKey","removeHotKey","offIcon","onIcon","SetVisibleButtons","newBtn","deleteModule","copyModule","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","m32","m33","_fieldData","_optionsData","_modules","modules","_models","_models_async","refs","ref","_refs","major","newField","onlyNew","getRefs","was","origin","queryObj","collectTables","check_1","_queries","q","moduleProps","replacements","wild","regexp","lineTypes","multiTypeSupport","fiedls","colorIndex","All reports","Are you sure to delete this report?","Are you sure to delete this query?","Average","Color column","Common","Copy of","Count","Created on","Data source","Day","Delete report","Description","Enter query name","To Excel","To CSV","To PNG","To PDF","Filter","Filtering query","Frozen columns above","Group summaries","Join data","Heatmap","Labels column","Max","Min","Month","New","Click 'New' button to add a new report","Select any report from the list","No reports","No saved queries","Last modified","New column name","New report","Please delete the related query filter first","Please delete the related group rule first","Rename","Report name","Reports","Save query","Specify columns to group by and output(s)","Specify columns to sort by","Sum","Type to search","Year","Axes","X Axis","Y Axis","Data series","Keys column","X axis column","Values column","Color","Marker type","Fill marker","Legend","Gridlines","Bottom","None","Right","Stacked area","Spline area","Stacked bar","Create copy","circle","square","triangle","diamond","no markers","Vertical labels","Extract series from","True","False","Save filter to use it in other reports","No filter","Select","Data buckets","Bucket name","Bucket values","Add bucket","Specify columns and their data buckets","Search","Other","Other values","Are you sure to delete?","waitVisible","interval","destructed","AddView","cals","AddEvent","NavLabel","ChangeDate","DateLabel","timeline","GetStep","timelineMode","NavBarView","bottomOffset","defaultPalette","modernPalette","palettes","material","flat","willow","optionHeight","SidePopupView","compactBar","controls","onHide","Cals","updateCalendar","addCalendar","removeCalendar","UpdateColor","webix_template","ShowEditor","Editor","EditorView","Cid","SideView","monthSelect","onAfterDateSelect","ListType","editValue","webix_scheduler_cal_edit","webix_scheduler_cal_title","ToggleCalendar","webix_scheduler_active","SetTitle","side","maxHeight","AddCalendar","onAfterScroll","PopupView","EditAbility","ToggleState","checkbox","EditStopSilent","fail","editStop","NavPopupView","animate","tHeight","tabbarHeight","Parent","updatePos","todayIcon","SetToday","todayBtn","responsive","ShowNav","responsiveCell","NavPopup","ToggleAdd","EventActionMenu","Result","Root","shrinkTo","before","isToday","isMultiDay","all_day","daysBetweenInclusive","isSameDate","adate","bdate","icalFormat","string","name_1","UNTIL","strToDate","EXDATE","WEEKDAYS","FREQUENCE","DAILY","WEEKLY","MONTHLY","YEARLY","findDate","fillWdays","consts","BYDAY","wdays","INTERVAL","FREQ","BYYEARDAY","BYMONTHDAY","BYSETPOS","checkDay","sdate","oldDay","WeekdaysToDates","getParams","$id","$recurring","extractDate","clipSequence","COUNT","cutOccurrence","separateSequence","isFirstOccurrence","evStart","correctMode","origin_id","recurring","isLastPart","movePattern","newEvent","oldEvent","until","nmd","nwn","getWeekNum","BYMONTH","nm","checkPattern","RecurringFormView","CreateIntervalControls","CreateCheckboxes","CreateSelect","CreateRadio","UpdateEvent","Events","CheckBoxContainer","Checkboxes","PatternSelect","UntilDateContainer","UntilDateCalendar","untilDate","UntilNumContainer","UntilNum","CustomRecControls","ChangeControls","_freq","dayShort","CheckboxGuard","GetBYDAY","byDay","dayFull","monthFull","calculated","weekNum","weekday","yearday","rec_pattern","vertical","ChangeSelectors","_StartDate","untilCount","CountNum","minDate","SetUNTIL","SetBYDAY","SetPatternOptions","setDirty","GetUntil","GetRecPattern","changeMode","date_id","correctCountUntil","countToUntil","nexto","cutCount","hasOneOccurrence","lr","EditRecurringMixin","ChangeMode","CorrectCountUntil","HasOneOccurrence","EventFormView","GetDateTime","ToggleTimeControls","CreateCalendarColor","getDirtyValues","PrepareChange","Wait","CreateRepeat","CreateUnitSelector","CreateSectionSelector","RecurringOptions","StartTime","EndTime","waitUnits","combo_1","Sections","sections","SubForm","ClearTempEvent","FillForm","labelTopHeight","ToggleSubform","ShowSubForm","clipboard","NewEvent","FillFormContinue","AdaptObjToMode","start_time","end_time","SetRecurring","yearStart","today","GetFromStartDate","roptions","ResetRecurringOptions","rec_option","GetStartDate","section","$color","minutes","PrepareOut","addEvent","UpdateExisting","UpdateSelection","newEvent_1","updateEvent","recVals","fvals","Join","ProcessRecurringOption","ProcessRecurringPattern","ProcessDates","ApplyDatechangeToRecurring","ProcessText","_changedValues","series_end_date","GetRecurring","edate","datesToWeekdays","CorrectDateTime","ev_length","opposite","oldStart","length_1","GetRecurringPreset","dirty","UpdateStateDate","GetClosestOccurrenceDate","GetModeBounds","weekStart","weeks","Subform","IsDirty","subform","HideSubPop","FormPopup","cleanEventData","HandleCopyPaste","clipboardModes","ctrlKey","isMac","AddToClipboard","PasteFromClipboard","PurgeClipboard","setFocus","RestoreClipboardSource","$multi","_globalClickHandler","ChangePasteTarget","CreatePasteTarget","OnDestroy","offsetLeft","offsetTop","mousePosUnit","sheight","GetSectionHeight","childNodes","SetPasteTargetStyle","ClearPasteTargetStyle","querySelectorAll","sel","SetClipboardSourceStyle","event_1","GetEvent","prevCss","clip","GetEventData","CopyEvent","MoveEvent","evLength","GetTargetDate","sec","updateId","CopyPasteMixin","mainWidget","BRIGHTNESS","FONT","EventView","StartAction","copypaste","UnitsLocal","EventObj","DeleteEvent","EditEvent","removeEvent","removal","oneday","allday","timeFormatStr","startTime","endTime","fromTo","GetRecurringText","unitIDs_1","unitObj","unitValue","GetSection","pattern","EventActionPopup","buttons","MainView","topbar","ToggleEvent","ToggleSidePanel","_dndActionPopup","ShowEvent","HideEvent","sameEvent","_sidePanel","getDimmedColor","hex","toRgb","red","green","blue","rgbToHsv","hexToHsv","hue","saturation","hsvToRgb","$past","timeStart","dayEventColor","$textColor","UnitListView","uniteBy","templateHeader","TemplateHeader","TimeStart","onUnits","SetUnits","start_1","AgendaView","headerHeight","TemplateCss","onItemRender","$unit","CurrentUnit","SelectEvent","_o","monthStart","getEvents","ToggleOverlay","_selected","datestring","fstring","ids","getUnitList","HourscaleView","heightSize","HourScaleItem","ParseHours","MultiMoreView","wxi-angle-down","ExpandData","wxi-angle-up","WrapData","MoreIcon","_expandState","maxVisibleLines","transition","_inAnimation","SetMoreIcon","_select","functor","trgs","LocateSelected","Unselect","_SelectionMode","id_1","SelectionMixin","_DataObj","firstElementChild","Resizer","y_diff","updateNodeHeight","updateText","x_diff","minEventHeight","getActualDate","differenceInCalendarDays","differenceInHours","f_cache","formatFunction","getSizes","d_1","dragOnly","modes","attr","updateSelection","editRecurring","newSubEvent","joinDateTime","shiftDate","mainDate","occDate","changeDate","ddate","dtime","$resize","moveMode","more","_waitPopup","finishOperation","copyEvent","$creation","$copy","$last_y","metaKey","dragCreate","scrollY_1","parentTopOffset","$top","$left","calId","ToHTML","getMaster","EventTemplate","noff","toff","$marked","markDropArea","drop","$extra","extra","getLastId","xCount","multiday","children","HideWindow","getEventUnits","sourceUnit","currentUnits","targetUnit","newUnits","multidayUnits","getStep","wrongDates","updateEventDates","allDay","timelineMore","offsetParent","WeekDayNum","DayEventsView","webix_scheduler_day_event","webix_scheduler_day_scale_item","_e","ShowNew","RenderEvents","mobile","FilterToday","_marker_update_interval","UpdateMarkerPosition","_Marker","evs","PrepareEvents","role","MarkToday","$inner","orderSet","PruneStack","$sorder","max_count","SetPosition","GetEventEndDate","temp_width","evCorrectedCopy","sm","em","EventTemplateStart","resizer","MultidayEventList","webix_scheduler_multiday_event","_moreBtn","LimitData","GetStyle","excess","_reserve","_reserveIds","Animate","DayView","ScrollScale","GetDay","CalendarView","isOutside","MarkEvent","navigation","monthHeader","skipEmptyWeeks","Calendar","MoreWindowView","webix_scheduler_month_event","webix_scheduler_month_event_single","MoreTemplate","Win","_c","oneDay","DayFormatStr","MonthEventsView","webix_cal_date","_ev","ShowDay","webix_scheduler_more","ShowMore","webix_cal_day","CalendarTemplate","eventHeight","MoreWindow","$more","GetDayCss","maxLines","wStart","wEnd","dayIndex","dayHTML","IsSingleDay","es","ee","le","prevLength","GetPosition","start_a","start_b","days_a","monthData","GetMonthData","ShowWindow","MonthHeaderView","GetHeaderData","MonthListView","MonthView","BarView","MoreView","clientWidth","webix_scheduler_timeline_event","webix_list_item","InnerState","RefreshTask","_sectionsReady","_sectionSize","ClearCollections","_processed","_lastRow","_moreEvents","sectionIndex","GetUnitCount","CheckDates","GetUnitStart","MoreBarTemplate","GetGrid","GetUnitWidth","AddUnit","clickedUnit","innerState","TimelineView","SetScales","ResetScales","wstart","wend","GetDefaultScaleUnit","GetScalePrecision","GetScalesCellWidth","GetScalesArray","UnitEventsView","unitID","UnitsHeaderView","Header","Units","unitsCache","UnitMultidayList","FilterByUnits","expandable","multiEvents","UnitMultidayView","UnitsView","WeekEventsView","WeekHeaderView","MultiDayEventsView","itemHeight","ParseDays","BreakEventsByDay","_maxEvents","ResetListHeight","Days","processed","$config","allEvents","renderedEvents","toHide","_day","visible","MoreOption","cIndex","rIndex","GetSizePosition","WeekView","GetWeek","_month","YearCalendarView","DayEvents","calendarHeader","webix_cal_day_with_event","ShowEvents","webix_cal_month","ShowMonth","SetStateDate","ManageDateChange","GetMonthStart","_date","MonthStart","showCalendar","monthEnd","dateKey","YearView","GetCalendars","m34","m35","m36","m37","m38","m39","m40","m41","m42","m43","createEvents","events_ready","cals_ready","createUnits","units_ready","_sections","createSections","sections_ready","utc","serverUTC","loaded_ranges","getColor","eventOut","getLocal","getDynamic","dimPastEvents","findCalendar","xdate","explodeEvent","isPast","roundTime","parseFormatStr","fromStr","sortCalendars","onAfterDelete","setActive","onAfterAdd","data->onDataUpdate","rgb","tosave","cev","isFirst","recurring_update_mode","recurring_update_date","Week","Agenda","Timeline","Today","Create","Next","Previous","Next day","Previous day","Next week","Previous week","Next month","Previous month","Add calendar","Do you really want to remove this calendar?","Edit calendar","Settings","Inactive calendar","No Events","All Day","Expand all-day events","Collapse all-day events","The event will be deleted permanently, are you sure?","Delete event","(No title)","Event","Start","End","Edit event","Assigned to units","No units","Unknown unit","never","none","daily","weekly","monthly","yearly","years","Repeat","End repeat","Repeats each","till","times","weekly, every","monthly, every","yearly, every","every working day","custom","Every","of","day of year","after several occurrences","week on","Change recurring pattern","All events","This event","This event and the following","Edit recurring event","Timeline scale","Section","Show more","Copy event"],"sourceRoot":""}