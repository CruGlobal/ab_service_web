/*! For license information please see ABDesigner.js.LICENSE.txt */
(()=>{var e={9293:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},5367:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(8081),o=i.n(n),a=i(3645),s=i.n(a)()(o());s.push([e.id,"@font-face {\n  font-family: 'bpmn';\n  src: url('../font/bpmn.eot?26374340');\n  src: url('../font/bpmn.eot?26374340#iefix') format('embedded-opentype'),\n       url('../font/bpmn.woff2?26374340') format('woff2'),\n       url('../font/bpmn.woff?26374340') format('woff'),\n       url('../font/bpmn.ttf?26374340') format('truetype'),\n       url('../font/bpmn.svg?26374340#bpmn') format('svg');\n  font-weight: normal;\n  font-style: normal;\n}\n/* Chrome hack: SVG is rendered more smooth in Windozze. 100% magic, uncomment if you need it. */\n/* Note, that will break hinting! In other OS-es font will be not as sharp as it could be */\n/*\n@media screen and (-webkit-min-device-pixel-ratio:0) {\n  @font-face {\n    font-family: 'bpmn';\n    src: url('../font/bpmn.svg?26374340#bpmn') format('svg');\n  }\n}\n*/\n\n [class^=\"bpmn-icon-\"]:before, [class*=\" bpmn-icon-\"]:before {\n  font-family: \"bpmn\";\n  font-style: normal;\n  font-weight: normal;\n  speak: never;\n\n  display: inline-block;\n  text-decoration: inherit;\n  width: 1em;\n  /* margin-right: .2em; */\n  text-align: center;\n  /* opacity: .8; */\n\n  /* For safety - reset parent styles, that can break glyph codes*/\n  font-variant: normal;\n  text-transform: none;\n\n  /* fix buttons height, for twitter bootstrap */\n  line-height: 1em;\n\n  /* Animation center compensation - margins should be symmetric */\n  /* remove if not needed */\n  /* margin-left: .2em; */\n\n  /* you can be more comfortable with increased icons size */\n  /* font-size: 120%; */\n\n  /* Font smoothing. That was taken from TWBS */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n\n  /* Uncomment for 3D effect */\n  /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */\n}\n\n.bpmn-icon-screw-wrench:before { content: '\\e800'; } /* '' */\n.bpmn-icon-trash:before { content: '\\e801'; } /* '' */\n.bpmn-icon-conditional-flow:before { content: '\\e802'; } /* '' */\n.bpmn-icon-default-flow:before { content: '\\e803'; } /* '' */\n.bpmn-icon-gateway-parallel:before { content: '\\e804'; } /* '' */\n.bpmn-icon-intermediate-event-catch-cancel:before { content: '\\e805'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-message:before { content: '\\e806'; } /* '' */\n.bpmn-icon-start-event-compensation:before { content: '\\e807'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-parallel-multiple:before { content: '\\e808'; } /* '' */\n.bpmn-icon-loop-marker:before { content: '\\e809'; } /* '' */\n.bpmn-icon-parallel-mi-marker:before { content: '\\e80a'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-signal:before { content: '\\e80b'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-timer:before { content: '\\e80c'; } /* '' */\n.bpmn-icon-intermediate-event-catch-parallel-multiple:before { content: '\\e80d'; } /* '' */\n.bpmn-icon-intermediate-event-catch-compensation:before { content: '\\e80e'; } /* '' */\n.bpmn-icon-gateway-xor:before { content: '\\e80f'; } /* '' */\n.bpmn-icon-connection:before { content: '\\e810'; } /* '' */\n.bpmn-icon-end-event-cancel:before { content: '\\e811'; } /* '' */\n.bpmn-icon-intermediate-event-catch-condition:before { content: '\\e812'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-parallel-multiple:before { content: '\\e813'; } /* '' */\n.bpmn-icon-start-event-condition:before { content: '\\e814'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-timer:before { content: '\\e815'; } /* '' */\n.bpmn-icon-sequential-mi-marker:before { content: '\\e816'; } /* '' */\n.bpmn-icon-user-task:before { content: '\\e817'; } /* '' */\n.bpmn-icon-business-rule:before { content: '\\e818'; } /* '' */\n.bpmn-icon-sub-process-marker:before { content: '\\e819'; } /* '' */\n.bpmn-icon-start-event-parallel-multiple:before { content: '\\e81a'; } /* '' */\n.bpmn-icon-start-event-error:before { content: '\\e81b'; } /* '' */\n.bpmn-icon-intermediate-event-catch-signal:before { content: '\\e81c'; } /* '' */\n.bpmn-icon-intermediate-event-catch-error:before { content: '\\e81d'; } /* '' */\n.bpmn-icon-end-event-compensation:before { content: '\\e81e'; } /* '' */\n.bpmn-icon-subprocess-collapsed:before { content: '\\e81f'; } /* '' */\n.bpmn-icon-subprocess-expanded:before { content: '\\e820'; } /* '' */\n.bpmn-icon-task:before { content: '\\e821'; } /* '' */\n.bpmn-icon-end-event-error:before { content: '\\e822'; } /* '' */\n.bpmn-icon-intermediate-event-catch-escalation:before { content: '\\e823'; } /* '' */\n.bpmn-icon-intermediate-event-catch-timer:before { content: '\\e824'; } /* '' */\n.bpmn-icon-start-event-escalation:before { content: '\\e825'; } /* '' */\n.bpmn-icon-start-event-signal:before { content: '\\e826'; } /* '' */\n.bpmn-icon-business-rule-task:before { content: '\\e827'; } /* '' */\n.bpmn-icon-manual:before { content: '\\e828'; } /* '' */\n.bpmn-icon-receive:before { content: '\\e829'; } /* '' */\n.bpmn-icon-call-activity:before { content: '\\e82a'; } /* '' */\n.bpmn-icon-start-event-timer:before { content: '\\e82b'; } /* '' */\n.bpmn-icon-start-event-message:before { content: '\\e82c'; } /* '' */\n.bpmn-icon-intermediate-event-none:before { content: '\\e82d'; } /* '' */\n.bpmn-icon-intermediate-event-catch-link:before { content: '\\e82e'; } /* '' */\n.bpmn-icon-end-event-escalation:before { content: '\\e82f'; } /* '' */\n.bpmn-icon-text-annotation:before { content: '\\e830'; } /* '' */\n.bpmn-icon-bpmn-io:before { content: '\\e831'; } /* '' */\n.bpmn-icon-gateway-complex:before { content: '\\e832'; } /* '' */\n.bpmn-icon-gateway-eventbased:before { content: '\\e833'; } /* '' */\n.bpmn-icon-gateway-none:before { content: '\\e834'; } /* '' */\n.bpmn-icon-gateway-or:before { content: '\\e835'; } /* '' */\n.bpmn-icon-end-event-terminate:before { content: '\\e836'; } /* '' */\n.bpmn-icon-end-event-signal:before { content: '\\e837'; } /* '' */\n.bpmn-icon-end-event-none:before { content: '\\e838'; } /* '' */\n.bpmn-icon-end-event-multiple:before { content: '\\e839'; } /* '' */\n.bpmn-icon-end-event-message:before { content: '\\e83a'; } /* '' */\n.bpmn-icon-end-event-link:before { content: '\\e83b'; } /* '' */\n.bpmn-icon-intermediate-event-catch-message:before { content: '\\e83c'; } /* '' */\n.bpmn-icon-intermediate-event-throw-compensation:before { content: '\\e83d'; } /* '' */\n.bpmn-icon-start-event-multiple:before { content: '\\e83e'; } /* '' */\n.bpmn-icon-script:before { content: '\\e83f'; } /* '' */\n.bpmn-icon-manual-task:before { content: '\\e840'; } /* '' */\n.bpmn-icon-send:before { content: '\\e841'; } /* '' */\n.bpmn-icon-service:before { content: '\\e842'; } /* '' */\n.bpmn-icon-receive-task:before { content: '\\e843'; } /* '' */\n.bpmn-icon-user:before { content: '\\e844'; } /* '' */\n.bpmn-icon-start-event-none:before { content: '\\e845'; } /* '' */\n.bpmn-icon-intermediate-event-throw-escalation:before { content: '\\e846'; } /* '' */\n.bpmn-icon-intermediate-event-catch-multiple:before { content: '\\e847'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-escalation:before { content: '\\e848'; } /* '' */\n.bpmn-icon-intermediate-event-throw-link:before { content: '\\e849'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-condition:before { content: '\\e84a'; } /* '' */\n.bpmn-icon-data-object:before { content: '\\e84b'; } /* '' */\n.bpmn-icon-script-task:before { content: '\\e84c'; } /* '' */\n.bpmn-icon-send-task:before { content: '\\e84d'; } /* '' */\n.bpmn-icon-data-store:before { content: '\\e84e'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-escalation:before { content: '\\e84f'; } /* '' */\n.bpmn-icon-intermediate-event-throw-message:before { content: '\\e850'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-multiple:before { content: '\\e851'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-signal:before { content: '\\e852'; } /* '' */\n.bpmn-icon-intermediate-event-throw-multiple:before { content: '\\e853'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-message:before { content: '\\e854'; } /* '' */\n.bpmn-icon-ad-hoc-marker:before { content: '\\e855'; } /* '' */\n.bpmn-icon-service-task:before { content: '\\e856'; } /* '' */\n.bpmn-icon-task-none:before { content: '\\e857'; } /* '' */\n.bpmn-icon-compensation-marker:before { content: '\\e858'; } /* '' */\n.bpmn-icon-start-event-non-interrupting-multiple:before { content: '\\e859'; } /* '' */\n.bpmn-icon-intermediate-event-throw-signal:before { content: '\\e85a'; } /* '' */\n.bpmn-icon-intermediate-event-catch-non-interrupting-condition:before { content: '\\e85b'; } /* '' */\n.bpmn-icon-participant:before { content: '\\e85c'; } /* '' */\n.bpmn-icon-event-subprocess-expanded:before { content: '\\e85d'; } /* '' */\n.bpmn-icon-lane-insert-below:before { content: '\\e85e'; } /* '' */\n.bpmn-icon-space-tool:before { content: '\\e85f'; } /* '' */\n.bpmn-icon-connection-multi:before { content: '\\e860'; } /* '' */\n.bpmn-icon-lane:before { content: '\\e861'; } /* '' */\n.bpmn-icon-lasso-tool:before { content: '\\e862'; } /* '' */\n.bpmn-icon-lane-insert-above:before { content: '\\e863'; } /* '' */\n.bpmn-icon-lane-divide-three:before { content: '\\e864'; } /* '' */\n.bpmn-icon-lane-divide-two:before { content: '\\e865'; } /* '' */\n.bpmn-icon-data-input:before { content: '\\e866'; } /* '' */\n.bpmn-icon-data-output:before { content: '\\e867'; } /* '' */\n.bpmn-icon-hand-tool:before { content: '\\e868'; } /* '' */\n.bpmn-icon-group:before { content: '\\e869'; } /* '' */\n.bpmn-icon-transaction:before { content: '\\e8c4'; } /* '' */",""]);const r=s},1629:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(8081),o=i.n(n),a=i(3645),s=i.n(a)()(o());s.push([e.id,'.bjs-container {\n  --bjs-font-family: Arial, sans-serif;\n\n  --color-grey-225-10-15: hsl(225, 10%, 15%);\n  --color-grey-225-10-35: hsl(225, 10%, 35%);\n  --color-grey-225-10-55: hsl(225, 10%, 55%);\n  --color-grey-225-10-75: hsl(225, 10%, 75%);\n  --color-grey-225-10-80: hsl(225, 10%, 80%);\n  --color-grey-225-10-85: hsl(225, 10%, 85%);\n  --color-grey-225-10-90: hsl(225, 10%, 90%);\n  --color-grey-225-10-95: hsl(225, 10%, 95%); \n  --color-grey-225-10-97: hsl(225, 10%, 97%);\n\n  --color-blue-205-100-45: hsl(205, 100%, 45%);\n  --color-blue-205-100-45-opacity-30: hsla(205, 100%, 45%, 30%);\n  --color-blue-205-100-50: hsl(205, 100%, 50%);\n  --color-blue-205-100-95: hsl(205, 100%, 95%);\n\n  --color-green-150-86-44: hsl(150, 86%, 44%);\n\n  --color-red-360-100-40: hsl(360, 100%, 40%);\n  --color-red-360-100-45: hsl(360, 100%, 45%);\n  --color-red-360-100-92: hsl(360, 100%, 92%);\n  --color-red-360-100-97: hsl(360, 100%, 97%);\n\n  --color-white: hsl(0, 0%, 100%);\n  --color-black: hsl(0, 0%, 0%); \n  --color-black-opacity-05: hsla(0, 0%, 0%, 5%); \n  --color-black-opacity-10: hsla(0, 0%, 0%, 10%);\n\n  --breadcrumbs-font-family: var(--bjs-font-family);\n  --breadcrumbs-item-color: var(--color-blue-205-100-50);\n  --breadcrumbs-arrow-color: var(--color-black);\n  --drilldown-fill-color: var(--color-white);\n  --drilldown-background-color: var(--color-blue-205-100-50);\n}\n\n.bjs-breadcrumbs {\n  position: absolute;\n  display: none;\n  flex-wrap: wrap;\n  align-items: center;\n  top: 30px;\n  left: 30px;\n  padding: 0px;\n  margin: 0px;\n  font-family: var(--breadcrumbs-font-family);\n  font-size: 16px;\n  line-height: normal;\n}\n\n.bjs-breadcrumbs-shown .bjs-breadcrumbs {\n  display: flex;\n}\n\n.djs-palette-shown .bjs-breadcrumbs {\n  left: 90px;\n}\n\n.djs-palette-shown.djs-palette-two-column .bjs-breadcrumbs {\n  left: 140px;\n}\n\n.bjs-breadcrumbs li {\n  display: inline-flex;\n  padding-bottom: 5px;\n}\n\n.bjs-breadcrumbs li a {\n  cursor: pointer;\n  color: var(--breadcrumbs-item-color);\n}\n\n.bjs-breadcrumbs li:last-of-type a {\n  color: inherit;\n  cursor: default;\n}\n\n.bjs-breadcrumbs li:not(:first-child)::before {\n  content: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" /><path d="M0 0h24v24H0z" fill="none" /></svg>\');\n  padding: 0 8px;\n  color: var(--breadcrumbs-arrow-color);\n  height: 1em;\n}\n\n.bjs-breadcrumbs .bjs-crumb {\n  display: inline-block;\n  max-width: 200px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.bjs-drilldown {\n  width: 20px;\n  height: 20px;\n\n  padding: 0px;\n  margin-left: -20px;\n\n  cursor: pointer;\n  border: none;\n  border-radius: 2px;\n  outline: none;\n\n  fill: var(--drilldown-fill-color);\n  background-color: var(--drilldown-background-color);\n}\n\n.bjs-drilldown-empty {\n  display: none;\n}\n\n.selected .bjs-drilldown-empty {\n  display: inherit;\n}',""]);const r=s},2622:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(8081),o=i.n(n),a=i(3645),s=i.n(a)()(o());s.push([e.id,"/**\n * color definitions\n */\n.djs-container {\n  --color-grey-225-10-15: hsl(225, 10%, 15%);\n  --color-grey-225-10-35: hsl(225, 10%, 35%);\n  --color-grey-225-10-55: hsl(225, 10%, 55%);\n  --color-grey-225-10-75: hsl(225, 10%, 75%);\n  --color-grey-225-10-80: hsl(225, 10%, 80%);\n  --color-grey-225-10-85: hsl(225, 10%, 85%);\n  --color-grey-225-10-90: hsl(225, 10%, 90%);\n  --color-grey-225-10-95: hsl(225, 10%, 95%); \n  --color-grey-225-10-97: hsl(225, 10%, 97%);\n\n  --color-blue-205-100-45: hsl(205, 100%, 45%);\n  --color-blue-205-100-45-opacity-30: hsla(205, 100%, 45%, 30%);\n  --color-blue-205-100-50: hsl(205, 100%, 50%);\n  --color-blue-205-100-95: hsl(205, 100%, 95%);\n\n  --color-green-150-86-44: hsl(150, 86%, 44%);\n\n  --color-red-360-100-40: hsl(360, 100%, 40%);\n  --color-red-360-100-45: hsl(360, 100%, 45%);\n  --color-red-360-100-92: hsl(360, 100%, 92%);\n  --color-red-360-100-97: hsl(360, 100%, 97%);\n\n  --color-white: hsl(0, 0%, 100%);\n  --color-black: hsl(0, 0%, 0%); \n  --color-black-opacity-05: hsla(0, 0%, 0%, 5%); \n  --color-black-opacity-10: hsla(0, 0%, 0%, 10%);\n\n  --bendpoint-fill-color: var(--color-blue-205-100-45-opacity-30);\n  --bendpoint-stroke-color: var(--color-blue-205-100-50);\n\n  --context-pad-entry-background-color: var(--color-white);\n  --context-pad-entry-hover-background-color: var(--color-grey-225-10-95);\n\n  --element-dragger-color: var(--color-blue-205-100-50);\n  --element-hover-outline-fill-color: var(--color-blue-205-100-45);\n  --element-selected-outline-stroke-color: var(--color-blue-205-100-50);\n\n  --lasso-fill-color: var(--color-black-opacity-05);\n  --lasso-stroke-color: var(--color-black);\n\n  --palette-entry-color: var(--color-grey-225-10-15);\n  --palette-entry-hover-color: var(--color-blue-205-100-45);\n  --palette-entry-selected-color: var(--color-blue-205-100-50);\n  --palette-separator-color: var(--color-grey-225-10-75);\n  --palette-toggle-hover-background-color: var(--color-grey-225-10-55);\n  --palette-background-color: var(--color-grey-225-10-97);\n  --palette-border-color: var(--color-grey-225-10-75);\n\n  --popup-body-background-color: var(--color-white);\n  --popup-header-entry-selected-color: var(--color-blue-205-100-50);\n  --popup-header-entry-selected-background-color: var(--color-black-opacity-10);\n  --popup-header-separator-color: var(--color-grey-225-10-75);\n  --popup-background-color: var(--color-grey-225-10-97);\n  --popup-border-color: var(--color-grey-225-10-75);\n\n  --resizer-fill-color: var(--color-blue-205-100-45-opacity-30);\n  --resizer-stroke-color: var(--color-blue-205-100-50);\n\n  --search-container-background-color: var(--color-grey-225-10-97);\n  --search-container-border-color: var(--color-blue-205-100-50);\n  --search-container-box-shadow-color: var(--color-blue-205-100-95);\n  --search-container-box-shadow-inset-color: var(--color-grey-225-10-80);\n  --search-input-border-color: var(--color-grey-225-10-75);\n  --search-result-border-color: var(--color-grey-225-10-75);\n  --search-result-highlight-color: var(--color-black);\n  --search-result-selected-color: var(--color-blue-205-100-45-opacity-30);\n\n  --shape-attach-allowed-stroke-color: var(--color-blue-205-100-50);\n  --shape-connect-allowed-fill-color: var(--color-grey-225-10-97);\n  --shape-drop-allowed-fill-color: var(--color-grey-225-10-97);\n  --shape-drop-not-allowed-fill-color: var(--color-red-360-100-97);\n  --shape-resize-preview-stroke-color: var(--color-blue-205-100-50);\n\n  --snap-line-stroke-color: var(--color-blue-205-100-45-opacity-30);\n\n  --space-tool-crosshair-stroke-color: var(--color-black);\n\n  --tooltip-error-background-color: var(--color-red-360-100-97);\n  --tooltip-error-border-color: var(--color-red-360-100-45);\n  --tooltip-error-color: var(--color-red-360-100-45);\n}\n\n/**\n * outline styles\n */\n\n.djs-outline {\n  fill: none;\n  visibility: hidden;\n}\n\n.djs-element.hover .djs-outline,\n.djs-element.selected .djs-outline {\n  visibility: visible;\n  shape-rendering: geometricPrecision;\n  stroke-dasharray: 3,3;\n}\n\n.djs-element.selected .djs-outline {\n  stroke: var(--element-selected-outline-stroke-color);\n  stroke-width: 1px;\n}\n\n.djs-element.hover .djs-outline {\n  stroke: var(--element-hover-outline-fill-color);\n  stroke-width: 1px;\n}\n\n.djs-shape.connect-ok .djs-visual > :nth-child(1) {\n  fill: var(--shape-connect-allowed-fill-color) !important;\n}\n\n.djs-shape.connect-not-ok .djs-visual > :nth-child(1),\n.djs-shape.drop-not-ok .djs-visual > :nth-child(1) {\n  fill: var(--shape-drop-not-allowed-fill-color) !important;\n}\n\n.djs-shape.new-parent .djs-visual > :nth-child(1) {\n  fill: var(--shape-drop-allowed-fill-color) !important;\n}\n\nsvg.drop-not-ok {\n  background: var(--shape-drop-not-allowed-fill-color) !important;\n}\n\nsvg.new-parent {\n  background: var(--shape-drop-allowed-fill-color) !important;\n}\n\n.djs-connection.connect-ok .djs-visual > :nth-child(1),\n.djs-connection.drop-ok .djs-visual > :nth-child(1) {\n  stroke: var(--shape-drop-allowed-fill-color) !important;\n}\n\n.djs-connection.connect-not-ok .djs-visual > :nth-child(1),\n.djs-connection.drop-not-ok .djs-visual > :nth-child(1) {\n  stroke: var(--shape-drop-not-allowed-fill-color) !important;\n}\n\n.drop-not-ok,\n.connect-not-ok {\n  cursor: not-allowed;\n}\n\n.djs-element.attach-ok .djs-visual > :nth-child(1) {\n  stroke-width: 5px !important;\n  stroke: var(--shape-attach-allowed-stroke-color) !important;\n}\n\n.djs-frame.connect-not-ok .djs-visual > :nth-child(1),\n.djs-frame.drop-not-ok .djs-visual > :nth-child(1) {\n  stroke-width: 3px !important;\n  stroke: var(--shape-drop-not-allowed-fill-color) !important;\n  fill: none !important;\n}\n\n/**\n* Selection box style\n*\n*/\n.djs-lasso-overlay {\n  fill: var(--lasso-fill-color);\n\n  stroke-dasharray: 5 1 3 1;\n  stroke: var(--lasso-stroke-color);\n\n  shape-rendering: geometricPrecision;\n  pointer-events: none;\n}\n\n/**\n * Resize styles\n */\n.djs-resize-overlay {\n  fill: none;\n\n  stroke-dasharray: 5 1 3 1;\n  stroke: var(--shape-resize-preview-stroke-color);\n\n  pointer-events: none;\n}\n\n.djs-resizer-hit {\n  fill: none;\n  pointer-events: all;\n}\n\n.djs-resizer-visual {\n  fill: var(--resizer-fill-color);\n  stroke-width: 1px;\n  stroke-opacity: 0.5;\n  stroke: var(--resizer-stroke-color);\n  shape-rendering: geometricprecision;\n}\n\n.djs-resizer:hover .djs-resizer-visual {\n  stroke: var(--resizer-stroke-color);\n  stroke-opacity: 1;\n}\n\n.djs-cursor-resize-ns,\n.djs-resizer-n,\n.djs-resizer-s {\n  cursor: ns-resize;\n}\n\n.djs-cursor-resize-ew,\n.djs-resizer-e,\n.djs-resizer-w {\n  cursor: ew-resize;\n}\n\n.djs-cursor-resize-nwse,\n.djs-resizer-nw,\n.djs-resizer-se {\n  cursor: nwse-resize;\n}\n\n.djs-cursor-resize-nesw,\n.djs-resizer-ne,\n.djs-resizer-sw {\n  cursor: nesw-resize;\n}\n\n.djs-shape.djs-resizing > .djs-outline {\n  visibility: hidden !important;\n}\n\n.djs-shape.djs-resizing > .djs-resizer {\n  visibility: hidden;\n}\n\n.djs-dragger > .djs-resizer {\n  visibility: hidden;\n}\n\n/**\n * drag styles\n */\n.djs-dragger * {\n  fill: none !important;\n  stroke: var(--element-dragger-color) !important;\n}\n\n.djs-dragger tspan,\n.djs-dragger text {\n  fill: var(--element-dragger-color) !important;\n  stroke: none !important;\n}\n\nmarker.djs-dragger circle,\nmarker.djs-dragger path,\nmarker.djs-dragger polygon,\nmarker.djs-dragger polyline,\nmarker.djs-dragger rect {\n  fill: var(--element-dragger-color) !important;\n  stroke: none !important;\n}\n\nmarker.djs-dragger text,\nmarker.djs-dragger tspan {\n  fill: none !important;\n  stroke: var(--element-dragger-color) !important;\n}\n\n.djs-dragging {\n  opacity: 0.3;\n}\n\n.djs-dragging,\n.djs-dragging > * {\n  pointer-events: none !important;\n}\n\n.djs-dragging .djs-context-pad,\n.djs-dragging .djs-outline {\n  display: none !important;\n}\n\n/**\n * no pointer events for visual\n */\n.djs-visual,\n.djs-outline {\n  pointer-events: none;\n}\n\n.djs-element.attach-ok .djs-hit {\n  stroke-width: 60px !important;\n}\n\n/**\n * all pointer events for hit shape\n */\n.djs-element > .djs-hit-all {\n  pointer-events: all;\n}\n\n.djs-element > .djs-hit-stroke,\n.djs-element > .djs-hit-click-stroke {\n  pointer-events: stroke;\n}\n\n/**\n * all pointer events for hit shape\n */\n.djs-drag-active .djs-element > .djs-hit-click-stroke {\n  pointer-events: all;\n}\n\n/**\n * shape / connection basic styles\n */\n.djs-connection .djs-visual {\n  stroke-width: 2px;\n  fill: none;\n}\n\n.djs-cursor-grab {\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.djs-cursor-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.djs-cursor-crosshair {\n  cursor: crosshair;\n}\n\n.djs-cursor-move {\n  cursor: move;\n}\n\n.djs-cursor-resize-ns {\n  cursor: ns-resize;\n}\n\n.djs-cursor-resize-ew {\n  cursor: ew-resize;\n}\n\n\n/**\n * snapping\n */\n.djs-snap-line {\n  stroke: var(--snap-line-stroke-color);\n  stroke-linecap: round;\n  stroke-width: 2px;\n  pointer-events: none;\n}\n\n/**\n * snapping\n */\n.djs-crosshair {\n  stroke: var(--space-tool-crosshair-stroke-color);\n  stroke-linecap: round;\n  stroke-width: 1px;\n  pointer-events: none;\n  shape-rendering: crispEdges;\n  stroke-dasharray: 5, 5;\n}\n\n/**\n * palette\n */\n\n.djs-palette {\n  position: absolute;\n  left: 20px;\n  top: 20px;\n\n  box-sizing: border-box;\n  width: 48px;\n}\n\n.djs-palette .separator {\n  margin: 0 5px;\n  padding-top: 5px;\n\n  border: none;\n  border-bottom: solid 1px var(--palette-separator-color);\n\n  clear: both;\n}\n\n.djs-palette .entry:before {\n  vertical-align: text-bottom;\n}\n\n.djs-palette .djs-palette-toggle {\n  cursor: pointer;\n}\n\n.djs-palette .entry,\n.djs-palette .djs-palette-toggle {\n  color: var(--palette-entry-color);\n  font-size: 30px;\n\n  text-align: center;\n}\n\n.djs-palette .entry {\n  float: left;\n}\n\n.djs-palette .entry img {\n  max-width: 100%;\n}\n\n.djs-palette .djs-palette-entries:after {\n  content: '';\n  display: table;\n  clear: both;\n}\n\n.djs-palette .djs-palette-toggle:hover {\n  background: var(--palette-toggle-hover-background-color);\n}\n\n.djs-palette .entry:hover {\n  color: var(--palette-entry-hover-color);\n}\n\n.djs-palette .highlighted-entry {\n  color: var(--palette-entry-selected-color) !important;\n}\n\n.djs-palette .entry,\n.djs-palette .djs-palette-toggle {\n  width: 46px;\n  height: 46px;\n  line-height: 46px;\n  cursor: default;\n}\n\n/**\n * Palette open / two-column layout is controlled via\n * classes on the palette. Events to hook into palette\n * changed life-cycle are available in addition.\n */\n.djs-palette.two-column.open {\n  width: 94px;\n}\n\n.djs-palette:not(.open) .djs-palette-entries {\n  display: none;\n}\n\n.djs-palette:not(.open) {\n  overflow: hidden;\n}\n\n.djs-palette.open .djs-palette-toggle {\n  display: none;\n}\n\n/**\n * context-pad\n */\n.djs-overlay-context-pad {\n  width: 72px;\n  z-index: 100;\n}\n\n.djs-context-pad {\n  position: absolute;\n  display: none;\n  pointer-events: none;\n}\n\n.djs-context-pad .entry {\n  width: 22px;\n  height: 22px;\n  text-align: center;\n  display: inline-block;\n  font-size: 22px;\n  margin: 0 2px 2px 0;\n\n  border-radius: 3px;\n\n  cursor: default;\n\n  background-color: var(--context-pad-entry-background-color);\n  box-shadow: 0 0 2px 1px var(--context-pad-entry-background-color);\n  pointer-events: all;\n}\n\n.djs-context-pad .entry:before {\n  vertical-align: top;\n}\n\n.djs-context-pad .entry:hover {\n  background: var(--context-pad-entry-hover-background-color);\n}\n\n.djs-context-pad.open {\n  display: block;\n}\n\n/**\n * popup styles\n */\n.djs-popup .entry {\n  line-height: 20px;\n  white-space: nowrap;\n  cursor: default;\n}\n\n/* larger font for prefixed icons */\n.djs-popup .entry:before {\n  vertical-align: middle;\n  font-size: 20px;\n}\n\n.djs-popup .entry > span {\n  vertical-align: middle;\n  font-size: 14px;\n}\n\n.djs-popup .entry:hover,\n.djs-popup .entry.active:hover {\n  background: var(--popup-header-entry-selected-background-color);\n}\n\n.djs-popup .entry.disabled {\n  background: inherit;\n}\n\n.djs-popup .djs-popup-header .entry {\n  display: inline-block;\n  padding: 2px 3px 2px 3px;\n\n  border: solid 1px transparent;\n  border-radius: 3px;\n}\n\n.djs-popup .djs-popup-header .entry.active {\n  color: var(--popup-header-entry-selected-color);\n  border: solid 1px var(--popup-header-entry-selected-color);\n  background-color: var(--popup-header-entry-selected-background-color);\n}\n\n.djs-popup-body .entry {\n  padding: 4px 10px 4px 5px;\n}\n\n.djs-popup-body .entry > span {\n  margin-left: 5px;\n}\n\n.djs-popup-body {\n  background-color: var(--popup-body-background-color);\n}\n\n.djs-popup-header {\n  border-bottom: 1px solid var(--popup-header-separator-color);\n}\n\n.djs-popup-header .entry {\n  margin: 1px;\n  margin-left: 3px;\n}\n\n.djs-popup-header .entry:last-child {\n  margin-right: 3px;\n}\n\n/**\n * popup / palette styles\n */\n.djs-palette {\n  background: var(--palette-background-color);\n  border: solid 1px var(--palette-border-color);\n  border-radius: 2px;\n}\n\n.djs-popup {\n  background: var(--popup-background-color);\n  border: solid 1px var(--popup-border-color);\n  border-radius: 2px;\n}\n\n/**\n * touch\n */\n\n.djs-shape,\n.djs-connection {\n  touch-action: none;\n}\n\n.djs-segment-dragger,\n.djs-bendpoint {\n  display: none;\n}\n\n/**\n * bendpoints\n */\n.djs-segment-dragger .djs-visual {\n  display: none;\n\n  fill: var(--bendpoint-fill-color);\n  stroke: var(--bendpoint-stroke-color);\n  stroke-width: 1px;\n  stroke-opacity: 1;\n}\n\n.djs-segment-dragger:hover .djs-visual {\n  display: block;\n}\n\n.djs-bendpoint .djs-visual {\n  fill: var(--bendpoint-fill-color);\n  stroke: var(--bendpoint-stroke-color);\n  stroke-width: 1px;\n  stroke-opacity: 0.5;\n}\n\n.djs-segment-dragger:hover,\n.djs-bendpoints.hover .djs-segment-dragger,\n.djs-bendpoints.selected .djs-segment-dragger,\n.djs-bendpoint:hover,\n.djs-bendpoints.hover .djs-bendpoint,\n.djs-bendpoints.selected .djs-bendpoint {\n  display: block;\n}\n\n.djs-drag-active .djs-bendpoints * {\n  display: none;\n}\n\n.djs-bendpoints:not(.hover) .floating {\n  display: none;\n}\n\n.djs-segment-dragger:hover .djs-visual,\n.djs-segment-dragger.djs-dragging .djs-visual,\n.djs-bendpoint:hover .djs-visual,\n.djs-bendpoint.floating .djs-visual {\n  fill: var(--bendpoint-fill-color);\n  stroke: var(--bendpoint-stroke-color);\n  stroke-opacity: 1;\n}\n\n.djs-bendpoint.floating .djs-hit {\n  pointer-events: none;\n}\n\n.djs-segment-dragger .djs-hit,\n.djs-bendpoint .djs-hit {\n  fill: none;\n  pointer-events: all;\n}\n\n.djs-segment-dragger.horizontal .djs-hit {\n  cursor: ns-resize;\n}\n\n.djs-segment-dragger.vertical .djs-hit {\n  cursor: ew-resize;\n}\n\n.djs-segment-dragger.djs-dragging .djs-hit {\n  pointer-events: none;\n}\n\n.djs-updating,\n.djs-updating > * {\n  pointer-events: none !important;\n}\n\n.djs-updating .djs-context-pad,\n.djs-updating .djs-outline,\n.djs-updating .djs-bendpoint,\n.connect-ok .djs-bendpoint,\n.connect-not-ok .djs-bendpoint,\n.drop-ok .djs-bendpoint,\n.drop-not-ok .djs-bendpoint {\n  display: none !important;\n}\n\n.djs-segment-dragger.djs-dragging,\n.djs-bendpoint.djs-dragging {\n  display: block;\n  opacity: 1.0;\n}\n\n\n/**\n * tooltips\n */\n.djs-tooltip-error {\n  width: 160px;\n  padding: 6px;\n\n  background: var(--tooltip-error-background-color);\n  border: solid 1px var(--tooltip-error-border-color);\n  border-radius: 2px;\n  color: var(--tooltip-error-color);\n  font-size: 12px;\n  line-height: 16px;\n\n  opacity: 0.75;\n}\n\n.djs-tooltip-error:hover {\n  opacity: 1;\n}\n\n\n/**\n * search pad\n */\n.djs-search-container {\n  position: absolute;\n  top: 20px;\n  left: 0;\n  right: 0;\n  margin-left: auto;\n  margin-right: auto;\n\n  width: 25%;\n  min-width: 300px;\n  max-width: 400px;\n  z-index: 10;\n\n  font-size: 1.05em;\n  opacity: 0.9;\n  background: var(--search-container-background-color);\n  border: solid 1px var(--search-container-border-color);\n  border-radius: 2px;\n  box-shadow: 0 0 0 2px var(--search-container-box-shadow-color), 0 0 0 1px var(--search-container-box-shadow-inset-color) inset;\n}\n\n.djs-search-container:not(.open) {\n  display: none;\n}\n\n.djs-search-input input {\n  font-size: 1.05em;\n  width: 100%;\n  padding: 6px 10px;\n  border: 1px solid var(--search-input-border-color);\n  box-sizing: border-box;\n}\n\n.djs-search-input input:focus {\n  outline: none;\n  border-color: var(--search-input-border-color);\n}\n\n.djs-search-results {\n  position: relative;\n  overflow-y: auto;\n  max-height: 200px;\n}\n\n.djs-search-results:hover {\n  cursor: pointer;\n}\n\n.djs-search-result {\n  width: 100%;\n  padding: 6px 10px;\n  background: white;\n  border-bottom: solid 1px var(--search-result-border-color);\n  border-radius: 1px;\n}\n\n.djs-search-highlight {\n  color: var(--search-result-highlight-color);\n}\n\n.djs-search-result-primary {\n  margin: 0 0 10px;\n}\n\n.djs-search-result-secondary {\n  font-family: monospace;\n  margin: 0;\n}\n\n.djs-search-result:hover {\n  background: var(--search-result-selected-color);\n}\n\n.djs-search-result-selected {\n  background: var(--search-result-selected-color);\n}\n\n.djs-search-result-selected:hover {\n  background: var(--search-result-selected-color);\n}\n\n.djs-search-overlay {\n  background: var(--search-result-selected-color);\n}\n\n/**\n * hidden styles\n */\n.djs-element-hidden,\n.djs-element-hidden .djs-hit,\n.djs-element-hidden .djs-outline,\n.djs-label-hidden .djs-label {\n  display: none !important;\n}\n",""]);const r=s},1597:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(8081),o=i.n(n),a=i(3645),s=i.n(a)()(o());s.push([e.id,"@keyframes pulseDark {\n   0% {\n      /* color: darkorange; */\n      transform: scale(1);\n      text-shadow: 0 0 1px rgba(0, 0, 0, 0.4);\n   }\n   50% {\n      /* color: orange; */\n   }\n   100% {\n      /* color: darkorange; */\n      transform: scale(1.25);\n      text-shadow: 0 3px 3px rgba(0, 0, 0, 0.4);\n   }\n}\n@keyframes pulseLight {\n   0% {\n      /* color: darkorange; */\n      transform: scale(1);\n      text-shadow: 0 0 1px rgba(0, 0, 0, 0.1);\n   }\n   50% {\n      /* color: orange; */\n   }\n   100% {\n      /* color: darkorange; */\n      transform: scale(1.25);\n      text-shadow: 0 3px 3px rgba(0, 0, 0, 0.1);\n   }\n}\n.pulseDark {\n   animation-name: pulseDark;\n   animation-duration: 1s;\n   animation-timing-function: ease-out;\n   animation-direction: alternate;\n   animation-iteration-count: infinite;\n   animation-play-state: running;\n   color: orange !important;\n}\n.pulseLight {\n   animation-name: pulseLight;\n   animation-duration: 1s;\n   animation-timing-function: ease-out;\n   animation-direction: alternate;\n   animation-iteration-count: infinite;\n   animation-play-state: running;\n   color: orange !important;\n}\n.smalltext {\n   font-size: small !important;\n}\n.ab-object-list-item .webix_sidebar_dir_icon {\n   margin-right: 20px;\n}\n.ab-datacollection-list-item .webix_sidebar_dir_icon {\n   margin-right: 20px;\n}\n.ab-interface-list-item .webix_sidebar_dir_icon {\n   margin-right: 20px;\n}\n.darkorange .webix_button {\n   background-color: darkorange !important;\n}\n.warningtext {\n   color: orange;\n}\n.warningslist {\n   list-style-type: none;\n   margin: 0;\n   padding: 0;\n   line-height: 28px;\n   background-color: transparent;\n   color: white;\n}\n.warningslist li {\n   border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n}\n.webix_theme_dark {\n   background-color: #4a4e58;\n}\n.lighten {\n   opacity: 0.4;\n}\n.app_form_window {\n   border-radius: 8px;\n}\n.app_form_window .webix_win_head {\n   background-color: #b8b8b8;\n}\n.app_form_window div.webix_view.webix_control.webix_el_icon.alert {\n   padding: 0px;\n}\n/* main view background (transparent by default) */\n.app_form_window .alert {\n   background-color: transparent;\n}\n/* main font color */\n.app_form_window .alert .webix_icon {\n   color: #eed202;\n}\n/* circle background (hover) */\n.app_form_window .alert .webix_icon_button:hover:before {\n   opacity: 0.8;\n}\n/* hover: font color */\n.app_form_window .alert .webix_icon_button:hover .webix_icon {\n   color: #d6bd01;\n}\n.app_form_window .webix_template {\n   font-size: 18px;\n   background-color: #b8b8b8;\n}\n.app_form_window .webix_label_right {\n   font-weight: 500;\n   color: rgb(49, 49, 49);\n   width: 340px;\n   padding-left: 10px;\n}\n.app_form_window .webix_scroll_cont .npr_smallLabels .webix_el_box {\n   font-size: 16px;\n   font-weight: 500;\n   color: #33b5e5;\n   text-align: right;\n}\n.app_form_window .webix_multicombo {\n   border: 2px solid #eee;\n   border-radius: 6px;\n}\n.app_form_window .webix_view .webix_layout_form {\n   border: 1px solid #eee;\n   border-radius: 6px;\n}\n.app_form_window div.webix_view.webix_form.no-margin.webix_layout_form {\n   background-color: #eee;\n}\n.app_form_window .webix_button {\n   border-radius: 6px;\n}\n.app_form_window_2 {\n   border-radius: 6px;\n}\n.app_form_window_2 .webix_win_head {\n   background-color: #b8b8b8;\n}\n.app_form_window_2 .webix_template {\n   font-size: 18px;\n   background-color: #b8b8b8;\n}\n/* Tab editing */\n.ab-tab-back:hover,\n.ab-tab-next:hover,\n.ab-tab-up:hover,\n.ab-tab-down:hover {\n   cursor: e-resize;\n   opacity: 1;\n}\n.ab-tab-back:hover {\n   cursor: w-resize;\n}\n.ab-tab-up:hover {\n   cursor: n-resize;\n   opacity: 1;\n}\n.ab-tab-down:hover {\n   cursor: s-resize;\n}\n.ab-tab-back,\n.ab-tab-next,\n.ab-tab-up,\n.ab-tab-down {\n   float: left;\n   margin-left: 10px;\n   background: #1ca1c1;\n   opacity: 0.8;\n   width: 20px;\n   height: 20px;\n   border-radius: 10px;\n   line-height: 20px !important;\n   padding-right: 2px;\n   color: white;\n}\n.fa-pencil-square.ab-tab-edit {\n   opacity: 0.4;\n}\n.fa-pencil.ab-tab-edit {\n   opacity: 0;\n   position: absolute;\n   left: 12px;\n   top: 12px;\n   background: #1ca1c1;\n   width: 20px;\n   height: 20px;\n   text-align: center;\n   line-height: 20px !important;\n   border-radius: 100%;\n   font-size: 11px;\n}\n.ab-tab-edit:hover {\n   opacity: 1;\n   transform: scale(1.2);\n}\n.webix_tree_item:hover .fa-pencil.ab-tab-edit {\n   opacity: 1;\n}\n.ab-tab-next {\n   float: right;\n   margin-right: 10px;\n   padding-left: 6px;\n}\n.ab-tab-up,\n.ab-tab-down {\n   /*   float: right;*/\n   /*   margin: 12px -2px 12px 15px;*/\n   /*   padding-left: 6px;*/\n   opacity: 0.2;\n   border-radius: 0 !important;\n   position: absolute;\n   right: 1px;\n   top: 0;\n   line-height: 22px !important;\n   width: 22px;\n   height: 21px;\n   text-align: center;\n   margin: 0;\n}\n.ab-tab-down {\n   top: 22px;\n}\n.webix_tree_item {\n   position: relative;\n}\n.webix_all_tabs div:nth-child(1) .ab-tab-back {\n   display: none;\n}\n.webix_all_tabs div:nth-last-child(1) .ab-tab-next {\n   display: none;\n}\n",""]);const r=s},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",n=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),n&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),n&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,n,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},8269:function(e,t,i){var n;n=void 0!==i.g?i.g:this,e.exports=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,i=String(e),n=i.length,o=-1,a="",s=i.charCodeAt(0);++o<n;)0!=(t=i.charCodeAt(o))?a+=t>=1&&t<=31||127==t||0==o&&t>=48&&t<=57||1==o&&t>=48&&t<=57&&45==s?"\\"+t.toString(16)+" ":0==o&&1==n&&45==t||!(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?"\\"+i.charAt(o):i.charAt(o):a+="�";return a};return e.CSS||(e.CSS={}),e.CSS.escape=t,t}(n)},2270:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},840:(e,t,i)=>{var n;!function(o,a,s,r){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],d=a.createElement("div"),u=Math.round,h=Math.abs,p=Date.now;function m(e,t,i){return setTimeout(x(e,i),t)}function f(e,t,i){return!!Array.isArray(e)&&(g(e,i[t],i),!0)}function g(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==r)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function v(e,t,i){var n="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=o.console&&(o.console.warn||o.console.log);return a&&a.call(o.console,n,i),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(e===r||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==r&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])}return t}:Object.assign;var b=v((function(e,t,i){for(var n=Object.keys(t),o=0;o<n.length;)(!i||i&&e[n[o]]===r)&&(e[n[o]]=t[n[o]]),o++;return e}),"extend","Use `assign`."),y=v((function(e,t){return b(e,t,!0)}),"merge","Use `assign`.");function w(e,t,i){var n,o=t.prototype;(n=e.prototype=Object.create(o)).constructor=e,n._super=o,i&&l(n,i)}function x(e,t){return function(){return e.apply(t,arguments)}}function $(e,t){return"function"==typeof e?e.apply(t&&t[0]||r,t):e}function _(e,t){return e===r?t:e}function C(e,t,i){g(A(t),(function(t){e.addEventListener(t,i,!1)}))}function E(e,t,i){g(A(t),(function(t){e.removeEventListener(t,i,!1)}))}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function k(e,t){return e.indexOf(t)>-1}function A(e){return e.trim().split(/\s+/g)}function R(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function D(e){return Array.prototype.slice.call(e,0)}function P(e,t,i){for(var n=[],o=[],a=0;a<e.length;){var s=t?e[a][t]:e[a];R(o,s)<0&&n.push(e[a]),o[a]=s,a++}return i&&(n=t?n.sort((function(e,i){return e[t]>i[t]})):n.sort()),n}function L(e,t){for(var i,n,o=t[0].toUpperCase()+t.slice(1),a=0;a<c.length;){if((n=(i=c[a])?i+o:t)in e)return n;a++}return r}var F=1;function V(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}var B="ontouchstart"in o,I=L(o,"PointerEvent")!==r,T=B&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),j="touch",O="mouse",M=["x","y"],N=["clientX","clientY"];function W(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){$(e.options.enable,[e])&&i.handler(t)},this.init()}function z(e,t,i){var n=i.pointers.length,o=i.changedPointers.length,a=1&t&&n-o==0,s=12&t&&n-o==0;i.isFirst=!!a,i.isFinal=!!s,a&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,o=n.length;i.firstInput||(i.firstInput=U(t)),o>1&&!i.firstMultiple?i.firstMultiple=U(t):1===o&&(i.firstMultiple=!1);var a=i.firstInput,s=i.firstMultiple,l=s?s.center:a.center,c=t.center=H(n);t.timeStamp=p(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=Z(l,c),t.distance=Y(l,c),function(e,t){var i=t.center,n=e.offsetDelta||{},o=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(o=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=o.x+(i.x-n.x),t.deltaY=o.y+(i.y-n.y)}(i,t),t.offsetDirection=G(t.deltaX,t.deltaY);var d,u,m=q(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=m.x,t.overallVelocityY=m.y,t.overallVelocity=h(m.x)>h(m.y)?m.x:m.y,t.scale=s?(d=s.pointers,Y((u=n)[0],u[1],N)/Y(d[0],d[1],N)):1,t.rotation=s?function(e,t){return Z(t[1],t[0],N)+Z(e[1],e[0],N)}(s.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,o,a,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(l>25||s.velocity===r)){var c=t.deltaX-s.deltaX,d=t.deltaY-s.deltaY,u=q(l,c,d);n=u.x,o=u.y,i=h(u.x)>h(u.y)?u.x:u.y,a=G(c,d),e.lastInterval=t}else i=s.velocity,n=s.velocityX,o=s.velocityY,a=s.direction;t.velocity=i,t.velocityX=n,t.velocityY=o,t.direction=a}(i,t);var f=e.element;S(t.srcEvent.target,f)&&(f=t.srcEvent.target),t.target=f}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function U(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:u(e.pointers[i].clientX),clientY:u(e.pointers[i].clientY)},i++;return{timeStamp:p(),pointers:t,center:H(t),deltaX:e.deltaX,deltaY:e.deltaY}}function H(e){var t=e.length;if(1===t)return{x:u(e[0].clientX),y:u(e[0].clientY)};for(var i=0,n=0,o=0;o<t;)i+=e[o].clientX,n+=e[o].clientY,o++;return{x:u(i/t),y:u(n/t)}}function q(e,t,i){return{x:t/e||0,y:i/e||0}}function G(e,t){return e===t?1:h(e)>=h(t)?e<0?2:4:t<0?8:16}function Y(e,t,i){i||(i=M);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return Math.sqrt(n*n+o*o)}function Z(e,t,i){i||(i=M);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return 180*Math.atan2(o,n)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(V(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(V(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4},X="mousedown",Q="mousemove mouseup";function J(){this.evEl=X,this.evWin=Q,this.pressed=!1,W.apply(this,arguments)}w(J,W,{handler:function(e){var t=K[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:O,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:j,3:"pen",4:O,5:"kinect"},ie="pointerdown",ne="pointermove pointerup pointercancel";function oe(){this.evEl=ie,this.evWin=ne,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(ie="MSPointerDown",ne="MSPointerMove MSPointerUp MSPointerCancel"),w(oe,W,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),o=ee[n],a=te[e.pointerType]||e.pointerType,s=a==j,r=R(t,e.pointerId,"pointerId");1&o&&(0===e.button||s)?r<0&&(t.push(e),r=t.length-1):12&o&&(i=!0),r<0||(t[r]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),i&&t.splice(r,1))}});var ae={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",re="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.evWin=re,this.started=!1,W.apply(this,arguments)}function ce(e,t){var i=D(e.touches),n=D(e.changedTouches);return 12&t&&(i=P(i.concat(n),"identifier",!0)),[i,n]}w(le,W,{handler:function(e){var t=ae[e.type];if(1===t&&(this.started=!0),this.started){var i=ce.call(this,e,t);12&t&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:j,srcEvent:e})}}});var de={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function he(){this.evTarget=ue,this.targetIds={},W.apply(this,arguments)}function pe(e,t){var i=D(e.touches),n=this.targetIds;if(3&t&&1===i.length)return n[i[0].identifier]=!0,[i,i];var o,a,s=D(e.changedTouches),r=[],l=this.target;if(a=i.filter((function(e){return S(e.target,l)})),1===t)for(o=0;o<a.length;)n[a[o].identifier]=!0,o++;for(o=0;o<s.length;)n[s[o].identifier]&&r.push(s[o]),12&t&&delete n[s[o].identifier],o++;return r.length?[P(a.concat(r),"identifier",!0),r]:void 0}function me(){W.apply(this,arguments);var e=x(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function fe(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ge.call(this,t)):12&e&&ge.call(this,t)}function ge(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout((function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)}),2500)}}function ve(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],a=Math.abs(t-o.x),s=Math.abs(i-o.y);if(a<=25&&s<=25)return!0}return!1}w(he,W,{handler:function(e){var t=de[e.type],i=pe.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:j,srcEvent:e})}}),w(me,W,{handler:function(e,t,i){var n=i.pointerType==j,o=i.pointerType==O;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)fe.call(this,t,i);else if(o&&ve.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var be=L(d.style,"touchAction"),ye=be!==r,we="compute",xe="auto",$e="manipulation",_e="none",Ce="pan-x",Ee="pan-y",Se=function(){if(!ye)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){e[i]=!t||o.CSS.supports("touch-action",i)})),e}();function ke(e,t){this.manager=e,this.set(t)}ke.prototype={set:function(e){e==we&&(e=this.compute()),ye&&this.manager.element.style&&Se[e]&&(this.manager.element.style[be]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){$(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(k(e,_e))return _e;var t=k(e,Ce),i=k(e,Ee);return t&&i?_e:t||i?t?Ce:Ee:k(e,$e)?$e:xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,o=k(n,_e)&&!Se.none,a=k(n,Ee)&&!Se["pan-y"],s=k(n,Ce)&&!Se["pan-x"];if(o){var r=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(r&&l&&c)return}if(!s||!a)return o||a&&6&i||s&&24&i?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ae=32;function Re(e){this.options=l({},this.defaults,e||{}),this.id=F++,this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function De(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Pe(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Le(e,t){var i=t.manager;return i?i.get(e):e}function Fe(){Re.apply(this,arguments)}function Ve(){Fe.apply(this,arguments),this.pX=null,this.pY=null}function Be(){Fe.apply(this,arguments)}function Ie(){Re.apply(this,arguments),this._timer=null,this._input=null}function Te(){Fe.apply(this,arguments)}function je(){Fe.apply(this,arguments)}function Oe(){Re.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Me(e,t){return(t=t||{}).recognizers=_(t.recognizers,Me.defaults.preset),new Ne(e,t)}function Ne(e,t){this.options=l({},Me.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(I?oe:T?he:B?me:J))(this,z),this.touchAction=new ke(this,this.options.touchAction),We(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function We(e,t){var i,n=e.element;n.style&&(g(e.options.cssProps,(function(o,a){i=L(n.style,a),t?(e.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=e.oldCssProps[i]||""})),t||(e.oldCssProps={}))}Re.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(f(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Le(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return f(e,"dropRecognizeWith",this)||(e=Le(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(f(e,"requireFailure",this))return this;var t=this.requireFail;return-1===R(t,e=Le(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(f(e,"dropRequireFailure",this))return this;e=Le(e,this);var t=R(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function n(i){t.manager.emit(i,e)}i<8&&n(t.options.event+De(i)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),i>=8&&n(t.options.event+De(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ae},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!$(this.options.enable,[this,t]))return this.reset(),void(this.state=Ae);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},w(Fe,Re,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=6&t,o=this.attrTest(e);return n&&(8&i||!o)?16|t:n||o?4&i?8|t:2&t?4|t:2:Ae}}),w(Ve,Fe,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ee),24&e&&t.push(Ce),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,o=e.direction,a=e.deltaX,s=e.deltaY;return o&t.direction||(6&t.direction?(o=0===a?1:a<0?2:4,i=a!=this.pX,n=Math.abs(e.deltaX)):(o=0===s?1:s<0?8:16,i=s!=this.pY,n=Math.abs(e.deltaY))),e.direction=o,i&&n>t.threshold&&o&t.direction},attrTest:function(e){return Fe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Pe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),w(Be,Fe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),w(Ie,Re,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!n||!i||12&e.eventType&&!o)this.reset();else if(1&e.eventType)this.reset(),this._timer=m((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Ae},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(Te,Fe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),w(je,Fe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ve.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return 30&i?t=e.overallVelocity:6&i?t=e.overallVelocityX:24&i&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&h(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Pe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),w(Oe,Re,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[$e]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&o&&i){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||Y(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=m((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Ae},failTimeout:function(){return this._timer=m((function(){this.state=Ae}),this.options.interval,this),Ae},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Me.VERSION="2.0.7",Me.defaults={domEvents:!1,touchAction:we,enable:!0,inputTarget:null,inputClass:null,preset:[[Te,{enable:!1}],[Be,{enable:!1},["rotate"]],[je,{direction:6}],[Ve,{direction:6},["swipe"]],[Oe],[Oe,{event:"doubletap",taps:2},["tap"]],[Ie]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ne.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var n=this.recognizers,o=t.curRecognizer;(!o||o&&8&o.state)&&(o=t.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],2===t.stopped||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(e),!o&&14&i.state&&(o=t.curRecognizer=i),a++}},get:function(e){if(e instanceof Re)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(f(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(f(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=R(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==r&&t!==r){var i=this.handlers;return g(A(e),(function(e){i[e]=i[e]||[],i[e].push(t)})),this}},off:function(e,t){if(e!==r){var i=this.handlers;return g(A(e),(function(e){t?i[e]&&i[e].splice(R(i[e],t),1):delete i[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var i=a.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&We(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Me,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ae,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ne,Input:W,TouchAction:ke,TouchInput:he,MouseInput:J,PointerEventInput:oe,TouchMouseInput:me,SingleTouchInput:le,Recognizer:Re,AttrRecognizer:Fe,Tap:Oe,Pan:Ve,Swipe:je,Pinch:Be,Rotate:Te,Press:Ie,on:C,off:E,each:g,merge:y,extend:b,assign:l,inherit:w,bindFn:x,prefixed:L}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=Me,(n=function(){return Me}.call(t,i,t,e))===r||(e.exports=n)}(window,document)},1235:(e,t,i)=>{e.exports=i(8302),e.exports.Collection=i(5048)},5048:e=>{"use strict";e.exports.extend=function(e,t,i,n){var o=i.inverse;return Object.defineProperty(e,"remove",{value:function(e){var i=this.indexOf(e);return-1!==i&&(this.splice(i,1),t.unset(e,o,n)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,i){var a=this.indexOf(e);if(void 0===i){if(-1!==a)return;i=this.length}-1!==a&&this.splice(a,1),this.splice(i,0,e),-1===a&&t.set(e,o,n)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},e.exports.isExtended=function(e){return!0===e.__refs_collection}},8302:(e,t,i)=>{"use strict";var n=i(5048);function o(e,t,i){var o=n.extend(i[t.name]||[],e,t,i);Object.defineProperty(i,t.name,{enumerable:t.enumerable,value:o}),o.length&&o.forEach((function(n){e.set(n,t.inverse,i)}))}function a(e,t){if(!(this instanceof a))return new a(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}a.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?o(this,t,e):function(e,t,i){var n=t.inverse,o=i[t.name];Object.defineProperty(i,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return o},set:function(t){if(t!==o){var a=o;o=null,a&&e.unset(a,n,i),o=t,e.set(o,n,i)}}})}(this,t,e)},a.prototype.ensureRefsCollection=function(e,t){var i=e[t.name];return n.isExtended(i)||o(this,t,e),i},a.prototype.ensureBound=function(e,t){(function(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)})(e,t)||this.bind(e,t)},a.prototype.unset=function(e,t,i){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(i):e[t.name]=void 0)},a.prototype.set=function(e,t,i){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(i):e[t.name]=i)},e.exports=a},2720:e=>{"use strict";var t=/,?([a-z]),?/gi,i=parseFloat,n=Math,o=n.PI,a=n.min,s=n.max,r=n.pow,l=n.abs,c=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,d=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/gi,u=Array.isArray||function(e){return e instanceof Array};function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function p(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var i in e)h(e,i)&&(t[i]=p(e[i]));return t}function m(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return e.push(e.splice(i,1)[0])}function f(e){var t=f.ps=f.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout((function(){for(var i in t)h(t,i)&&i!=e&&(t[i].sleep--,!t[i].sleep&&delete t[i])})),t[e]}function g(e,t,i,n){return 1===arguments.length&&(t=e.y,i=e.width,n=e.height,e=e.x),{x:e,y:t,width:i,height:n,x2:e+i,y2:t+n}}function v(){return this.join(",").replace(t,"$1")}function b(e){var t=p(e);return t.toString=v,t}function y(e,t,i,n,o,a,s,l,c){var d=1-c,u=r(d,3),h=r(d,2),p=c*c*c,m=u*t+3*h*c*n+3*d*c*c*a+p*l;return{x:E(u*e+3*h*c*i+3*d*c*c*o+p*s),y:E(m)}}function w(e){var t=L.apply(null,e);return g(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function x(e,t,i){return t>=e.x&&t<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function $(e,t,i,n,o){return e*(e*(-3*t+9*i-9*n+3*o)+6*t-12*i+6*n)-3*t+3*i}function _(e,t,i,o,a,s,r,l,c){null==c&&(c=1);for(var d=(c=c>1?1:c<0?0:c)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,m=0;m<12;m++){var f=d*u[m]+d,g=$(f,e,i,a,r),v=$(f,t,o,s,l),b=g*g+v*v;p+=h[m]*n.sqrt(b)}return d*p}function C(e,t,i,n,o,r,l,c){if(!(s(e,i)<a(o,l)||a(e,i)>s(o,l)||s(t,n)<a(r,c)||a(t,n)>s(r,c))){var d=(e*n-t*i)*(r-c)-(t-n)*(o*c-r*l),u=(e-i)*(r-c)-(t-n)*(o-l);if(u){var h=E(((e*n-t*i)*(o-l)-(e-i)*(o*c-r*l))/u),p=E(d/u),m=+h.toFixed(2),f=+p.toFixed(2);if(!(m<+a(e,i).toFixed(2)||m>+s(e,i).toFixed(2)||m<+a(o,l).toFixed(2)||m>+s(o,l).toFixed(2)||f<+a(t,n).toFixed(2)||f>+s(t,n).toFixed(2)||f<+a(r,c).toFixed(2)||f>+s(r,c).toFixed(2)))return{x:h,y:p}}}}function E(e){return Math.round(1e11*e)/1e11}function S(e,t,i){if(n=w(e),o=w(t),n=g(n),!(x(o=g(o),n.x,n.y)||x(o,n.x2,n.y)||x(o,n.x,n.y2)||x(o,n.x2,n.y2)||x(n,o.x,o.y)||x(n,o.x2,o.y)||x(n,o.x,o.y2)||x(n,o.x2,o.y2)||(n.x<o.x2&&n.x>o.x||o.x<n.x2&&o.x>n.x)&&(n.y<o.y2&&n.y>o.y||o.y<n.y2&&o.y>n.y)))return i?0:[];for(var n,o,a=_.apply(0,e),s=_.apply(0,t),r=A(e)?1:~~(a/5)||1,c=A(t)?1:~~(s/5)||1,d=[],u=[],h={},p=i?0:[],m=0;m<r+1;m++){var f=y.apply(0,e.concat(m/r));d.push({x:f.x,y:f.y,t:m/r})}for(m=0;m<c+1;m++)f=y.apply(0,t.concat(m/c)),u.push({x:f.x,y:f.y,t:m/c});for(m=0;m<r;m++)for(var v=0;v<c;v++){var b,$=d[m],E=d[m+1],S=u[v],k=u[v+1],R=l(E.x-$.x)<.01?"y":"x",D=l(k.x-S.x)<.01?"y":"x",P=C($.x,$.y,E.x,E.y,S.x,S.y,k.x,k.y);if(P){if(h[b=P.x.toFixed(9)+"#"+P.y.toFixed(9)])continue;h[b]=!0;var L=$.t+l((P[R]-$[R])/(E[R]-$[R]))*(E.t-$.t),F=S.t+l((P[D]-S[D])/(k[D]-S[D]))*(k.t-S.t);L>=0&&L<=1&&F>=0&&F<=1&&(i?p++:p.push({x:P.x,y:P.y,t1:L,t2:F}))}}return p}function k(e){var t=f(e);if(t.abs)return b(t.abs);if(u(e)&&u(e&&e[0])||(e=function(e){if(!e)return null;var t=f(e);if(t.arr)return p(t.arr);var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=[];return u(e)&&u(e[0])&&(n=p(e)),n.length||String(e).replace(c,(function(e,t,o){var a=[],s=t.toLowerCase();for(o.replace(d,(function(e,t){t&&a.push(+t)})),"m"==s&&a.length>2&&(n.push([t].concat(a.splice(0,2))),s="l",t="m"==t?"l":"L");a.length>=i[s]&&(n.push([t].concat(a.splice(0,i[s]))),i[s]););})),n.toString=f.toString,t.arr=p(n),n}(e)),!e||!e.length)return[["M",0,0]];var i,n=[],o=0,a=0,s=0,r=0,l=0;"M"==e[0][0]&&(s=o=+e[0][1],r=a=+e[0][2],l++,n[0]=["M",o,a]);for(var h,m,g=l,y=e.length;g<y;g++){if(n.push(h=[]),(i=(m=e[g])[0])!=i.toUpperCase())switch(h[0]=i.toUpperCase(),h[0]){case"A":h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=+m[6]+o,h[7]=+m[7]+a;break;case"V":h[1]=+m[1]+a;break;case"H":h[1]=+m[1]+o;break;case"M":s=+m[1]+o,r=+m[2]+a;default:for(var w=1,x=m.length;w<x;w++)h[w]=+m[w]+(w%2?o:a)}else for(var $=0,_=m.length;$<_;$++)h[$]=m[$];switch(i=i.toUpperCase(),h[0]){case"Z":o=+s,a=+r;break;case"H":o=h[1];break;case"V":a=h[1];break;case"M":s=h[h.length-2],r=h[h.length-1];default:o=h[h.length-2],a=h[h.length-1]}}return n.toString=v,t.abs=b(n),n}function A(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function R(e,t,i,n){return[e,t,i,n,i,n]}function D(e,t,i,n,o,a){var s=1/3,r=2/3;return[s*e+r*i,s*t+r*n,s*o+r*i,s*a+r*n,o,a]}function P(e,t,i,a,s,r,c,d,u,p){var f,g,v=120*o/180,b=o/180*(+s||0),y=[],w=(g=function(e,t,i){return{x:e*n.cos(i)-t*n.sin(i),y:e*n.sin(i)+t*n.cos(i)}},function e(){var t=Array.prototype.slice.call(arguments,0),i=t.join("␀"),n=e.cache=e.cache||{},o=e.count=e.count||[];return h(n,i)?(m(o,i),n[i]):(o.length>=1e3&&delete n[o.shift()],o.push(i),n[i]=g.apply(0,t),n[i])});if(p)R=p[0],D=p[1],k=p[2],A=p[3];else{e=(f=w(e,t,-b)).x,t=f.y;var x=(e-(d=(f=w(d,u,-b)).x))/2,$=(t-(u=f.y))/2,_=x*x/(i*i)+$*$/(a*a);_>1&&(i*=_=n.sqrt(_),a*=_);var C=i*i,E=a*a,S=(r==c?-1:1)*n.sqrt(l((C*E-C*$*$-E*x*x)/(C*$*$+E*x*x))),k=S*i*$/a+(e+d)/2,A=S*-a*x/i+(t+u)/2,R=n.asin(((t-A)/a).toFixed(9)),D=n.asin(((u-A)/a).toFixed(9));(R=e<k?o-R:R)<0&&(R=2*o+R),(D=d<k?o-D:D)<0&&(D=2*o+D),c&&R>D&&(R-=2*o),!c&&D>R&&(D-=2*o)}var L=D-R;if(l(L)>v){var F=D,V=d,B=u;D=R+v*(c&&D>R?1:-1),y=P(d=k+i*n.cos(D),u=A+a*n.sin(D),i,a,s,0,c,V,B,[D,F,k,A])}L=D-R;var I=n.cos(R),T=n.sin(R),j=n.cos(D),O=n.sin(D),M=n.tan(L/4),N=4/3*i*M,W=4/3*a*M,z=[e,t],U=[e+N*T,t-W*I],H=[d+N*O,u-W*j],q=[d,u];if(U[0]=2*z[0]-U[0],U[1]=2*z[1]-U[1],p)return[U,H,q].concat(y);for(var G=[],Y=0,Z=(y=[U,H,q].concat(y).join().split(",")).length;Y<Z;Y++)G[Y]=Y%2?w(y[Y-1],y[Y],b).y:w(y[Y],y[Y+1],b).x;return G}function L(e,t,i,o,r,c,d,u){for(var h,p,m,f,g,v,b,y,w=[],x=[[],[]],$=0;$<2;++$)if(0==$?(p=6*e-12*i+6*r,h=-3*e+9*i-9*r+3*d,m=3*i-3*e):(p=6*t-12*o+6*c,h=-3*t+9*o-9*c+3*u,m=3*o-3*t),l(h)<1e-12){if(l(p)<1e-12)continue;0<(f=-m/p)&&f<1&&w.push(f)}else b=p*p-4*m*h,y=n.sqrt(b),b<0||(0<(g=(-p+y)/(2*h))&&g<1&&w.push(g),0<(v=(-p-y)/(2*h))&&v<1&&w.push(v));for(var _,C=w.length,E=C;C--;)_=1-(f=w[C]),x[0][C]=_*_*_*e+3*_*_*f*i+3*_*f*f*r+f*f*f*d,x[1][C]=_*_*_*t+3*_*_*f*o+3*_*f*f*c+f*f*f*u;return x[0][E]=e,x[1][E]=t,x[0][E+1]=d,x[1][E+1]=u,x[0].length=x[1].length=E+2,{x0:a.apply(0,x[0]),y0:a.apply(0,x[1]),x1:s.apply(0,x[0]),y1:s.apply(0,x[1])}}function F(e){var t=f(e);if(t.curve)return b(t.curve);for(var n=k(e),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=function(e,t,i){var n,o;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(P.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==i||"S"==i?(n=2*t.x-t.bx,o=2*t.y-t.by):(n=t.x,o=t.y),e=["C",n,o].concat(e.slice(1));break;case"T":"Q"==i||"T"==i?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(D(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(D(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(R(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(R(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(R(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(R(t.x,t.y,t.X,t.Y))}return e},s=function(e,t){if(e[t].length>7){e[t].shift();for(var i=e[t];i.length;)r[t]="A",e.splice(t++,0,["C"].concat(i.splice(0,6)));e.splice(t,1),u=n.length}},r=[],l="",c="",d=0,u=n.length;d<u;d++){n[d]&&(l=n[d][0]),"C"!=l&&(r[d]=l,d&&(c=r[d-1])),n[d]=a(n[d],o,c),"A"!=r[d]&&"C"==l&&(r[d]="C"),s(n,d);var h=n[d],p=h.length;o.x=h[p-2],o.y=h[p-1],o.bx=i(h[p-4])||o.x,o.by=i(h[p-3])||o.y}return t.curve=b(n),n}e.exports=function(e,t,i){e=F(e),t=F(t);for(var n,o,a,s,r,l,c,d,u,h,p=i?0:[],m=0,f=e.length;m<f;m++){var g=e[m];if("M"==g[0])n=r=g[1],o=l=g[2];else{"C"==g[0]?(u=[n,o].concat(g.slice(1)),n=u[6],o=u[7]):(u=[n,o,n,o,r,l,r,l],n=r,o=l);for(var v=0,b=t.length;v<b;v++){var y=t[v];if("M"==y[0])a=c=y[1],s=d=y[2];else{"C"==y[0]?(h=[a,s].concat(y.slice(1)),a=h[6],s=h[7]):(h=[a,s,a,s,c,d,c,d],a=c,s=d);var w=S(u,h,i);if(i)p+=w;else{for(var x=0,$=w.length;x<$;x++)w[x].segment1=m,w[x].segment2=v,w[x].bez1=u,w[x].bez2=h;p=p.concat(w)}}}}}return p}},3379:e=>{"use strict";var t=[];function i(e){for(var i=-1,n=0;n<t.length;n++)if(t[n].identifier===e){i=n;break}return i}function n(e,n){for(var a={},s=[],r=0;r<e.length;r++){var l=e[r],c=n.base?l[0]+n.base:l[0],d=a[c]||0,u="".concat(c," ").concat(d);a[c]=d+1;var h=i(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var m=o(p,n);n.byIndex=r,t.splice(r,0,{identifier:u,updater:m,references:1})}s.push(u)}return s}function o(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,o){var a=n(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var r=i(a[s]);t[r].references--}for(var l=n(e,o),c=0;c<a.length;c++){var d=i(a[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=l}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var n=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var o=void 0!==i.layer;o&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,o&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var a=i.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},5256:e=>{e.exports=[]},3880:e=>{e.exports={}},8023:(e,t,i)=>{var n={};n.en=i(3880),e.exports=n},2761:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"csvExporter"}constructor(e,t="interface_editor_csvExporter"){super(e,t),this.view=e,this.component=this.view.component()}ui(){return this.component.ui()}init(e){this.AB=e,this.component.init(this.AB)}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}}}return o}},6720:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"csvImporter"}constructor(e,t="interface_editor_csvImporter"){super(e,t),this.view=e,this.component=this.view.component()}ui(){return this.component.ui()}init(e){this.AB=e,this.component.init(this.AB)}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}}}return o}},8442:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"carousel"}constructor(t,i="interface_editor_viewcarousel"){super(i,{label:""}),this.view=t,this.settings=t.settings,this.base=i,this.AB=e,this.component=this.view.component()}ui(){return this.component.ui()}init(e){return this.AB=e,this.component.init(e,2)}detatch(){this.component.detatch()}onShow(){this.component.onShow()}}}return o}},1298:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713);let o=null;function a(e){if(!o){const t="interface_editor_viewchart",i=(0,n.default)(e);o=class extends i{static get key(){return"chart"}constructor(e,i=t){super(e,i)}ui(){const e=super.ui();return e.rows[0].cellHeight=400,e}async init(e){this.AB=e,await super.init(e)}detatch(){}onShow(){super.onShow()}}}return o}},6062:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewchart_area",i=(0,n.Z)(e);o=class extends i{static get key(){return"area"}constructor(i,n=t){super(n,{view:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return{id:this.ids.component}}async init(e){this.AB=e,await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},3725:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewchart_bar",i=(0,n.Z)(e);o=class extends i{static get key(){return"bar"}constructor(i,n=t){super(n,{view:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return{id:this.ids.component}}async init(e){this.AB=e,await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},3121:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewchart_line",i=(0,n.Z)(e);o=class extends i{static get key(){return"line"}constructor(i,n=t){super(n,{view:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return{id:this.ids.component}}async init(e){this.AB=e,await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},5250:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewchart_pie",i=(0,n.Z)(e);o=class extends i{static get key(){return"pie"}constructor(i,n=t){super(n,{view:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return this.component.ui()}async init(e){this.AB=e,await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},8971:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewcomment",i=(0,n.Z)(e);o=class extends i{static get key(){return"comment"}constructor(i,n=t){super(n),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return this.component.ui()}async init(e){this.AB=e,await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},760:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713);let o=null;function a(e){if(o)return o;const t=(0,n.default)(e);return o=class extends t{static get key(){return"conditionalcontainer"}constructor(e,t="interface_editor_viewconditionalContainer"){super(e,t)}},o}},4713:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=null;function a(e){if(!o){const i=(0,n.Z)(e);var t=i.L();o=class n extends i{static get key(){return"viewcontainer"}constructor(t,i="interface_editor_viewcontainer",n={}){var o={label:""};Object.keys(n).forEach((e=>{void 0===o[e]?o[e]="":console.error(`!!! ABFieldProperty:: passed in ids contains a restricted field : ${e}`)})),super(i,o),this.view=t,this.settings=t.settings,this.viewLoad(t),this.base=i,this.AB=e,this.subComponents={},this.cellHeight=250}ui(){let t=n.key,i=e.Class.ABViewManager.viewClass(t).defaultValues();return{rows:[{id:this.ids.component,view:"dashboard",css:`ab-${t}-container`,cellHeight:this.cellHeight,gridColumns:this.settings.columns||i.columns}]}}init(e){var t=$$(this.ids.component);t&&(webix.extend(t,webix.OverlayBox),webix.extend(t,webix.ProgressBar)),this.CurrentView.viewsSortByPosition().forEach((i=>{let n;i.warningsSilent=!0;try{n=i.component()}catch(e){n=i.component(this.AB._App);let t=n.ui;n.ui=(()=>t).bind(n)}this.subComponents[i.id]=n;let o="panel";0==i.settings.movable&&(o="scrollview"),t.addView({view:o,name:i.id,icon:"fa fa-arrows",css:"ab-widget-container",body:{rows:[{view:"template",height:30,css:"ab-widget-header",template:this.template(i),onClick:{"ab-component-edit":(e,t,n)=>{this.viewEdit(e,i.id,n)},"ab-component-remove":(e,t,n)=>{this.viewDelete(e,i.id,n)}}},n.ui()]},dx:i.position.dx||1,dy:i.position.dy||1,x:this.validatePosition(i.position.x,0,t.config.gridColumns-1),y:i.position.y||0}),n.init(e,2)})),this._onChangeId&&t.detachEvent(this._onChangeId),this._onChangeId=t.attachEvent("onChange",(()=>{this.onReorder()})),this.showEmptyPlaceholder(),t.adjust()}detatch(){Object.keys(this.subComponents).forEach((e=>{this.subComponents[e]?.detatch?.()}));var e=$$(this.ids.component);e&&this._onChangeId&&e.detachEvent(this._onChangeId)}busy(){let e=$$(this.ids.component);e?.disable(),e?.showProgress({type:"icon"})}async onReorder(){this.busy();var e=$$(this.ids.component).serialize(),t=[];this.CurrentView.views().forEach((i=>{var n=e.filter((e=>e.name==i.id))[0];n&&(i.position.x=n.x,i.position.y=n.y,i.position.x<0&&(i.position.x=0),i.position.y<0&&(i.position.y=0),t.push(i.save()))}));try{await Promise.all(t),await this.CurrentView.save(),this.ready()}catch(e){this.AB.notify.developer(e,{message:"Error trying to save selected View:",view:this.CurrentView.toObj()}),this.ready()}}onShow(){this.CurrentView.views().forEach((e=>{this.subComponents[e.id]?.onShow?.()}));let e=this.CurrentView.datacollection;e&&e.dataStatus==e.dataStatusFlag.notInitial&&e.loadData()}ready(){let e=$$(this.ids.component);e?.enable(),e?.hideProgress()}showEmptyPlaceholder(){var e=$$(this.ids.component);0==e.getChildViews().length&&e.showOverlay("<div class='drop-zone'><div>"+t("Add Widgets Here")+"</div></div>")}template(e){let t="";return(e.warningsAll()||[]).length>0&&(t=this.WARNING_ICON),`<div>\n               <i class="fa fa-${e.icon} webix_icon_btn"></i> ${e.label}\n               <div class="ab-component-tools">\n               ${t}${0==e.settings.removable?"":'<i class="fa fa-trash ab-component-remove"></i>'}\n               <i class="fa fa-edit ab-component-edit"></i>\n               </div></div>`}validatePosition(e,t,i){return e<t?t:e>i?i:e}viewDelete(e,i){var n=this.CurrentView.views((e=>e.id==i))[0];if(!n)return!1;webix.confirm({title:t("Delete component"),text:t("Do you want to delete <b>{0}</b>?",[n.label]),callback:async e=>{if(e){this.busy();try{await n.destroy(),n.emit("destroyed",n),this.emit("view.destroyed",n);let e=$$(this.ids.component);var t=e.queryView({name:i});t&&(e.blockEvent(),e.removeView(t),e.unblockEvent()),this.showEmptyPlaceholder()}catch(e){this.AB.notify.developer(e,{message:"Error trying to delete selected View:",view:n})}this.ready()}}}),e.preventDefault()}viewEdit(e,t){var i=this.CurrentView.views((e=>e.id==t))[0];return!!i&&(setTimeout((()=>{try{this.emit("view.edit",i)}catch(e){console.error(e)}}),15),e.preventDefault(),!1)}}}return o}},5903:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713);let o=null;function a(e){if(!o){const t=(0,n.default)(e);o=class extends t{static get key(){return"dataview"}constructor(e,t="interface_editor_viewdataview"){super(e,t)}ui(){let e=super.ui();return e.rows[0].cellHeight=75,e}init(e){return this.AB=e,super.init(e)}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}}}return o}},2442:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713);let o=null;function a(e){if(!o){const t=(0,n.default)(e);o=class extends t{static get key(){return"detail"}constructor(e,t="interface_editor_viewdetail"){super(e,t)}ui(){let e=super.ui();return e.rows[0].cellHeight=75,e}init(e){return this.AB=e,super.init(e)}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}}}return o}},559:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(o)return o;const t=(0,n.Z)(e);return o=class extends t{static get key(){return"docxBuilder"}constructor(t,i="interface_editor_viewdocxBuilder"){super(i,{}),this.view=t,this.settings=t.settings,this.base=i,this.AB=e,this.component=this.view.component()}ui(){return this.component.ui()}init(e){return this.AB=e,this.component.init(e,2)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow?.()}},o}},2363:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713),o=null;function a(e){if(!o){const t=(0,n.default)(e);o=class extends t{static get key(){return"form"}constructor(e,t="interface_editor_viewform"){super(e,t)}ui(){let e=super.ui();return e.rows[0].cellHeight=75,e}init(e){return this.AB=e,super.init(e)}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}}}return o}},803:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewgantt",i=(0,n.Z)(e);o=class extends i{static get key(){return"gantt"}constructor(i,n=t){super(n,{label:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){return this.component.ui()}async init(e){this.AB=e,this.component.ignoreLocal=!0,await this.component.init(e,2)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow?.()}}}return o}},5084:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"grid"}constructor(t,i="interface_editor_viewgrid"){super(i,{label:""}),this.view=t,this.settings=t.settings,this.base=i,this.AB=e,this.component=this.view.component()}ui(){return this.component.ui()}init(e){return this.AB=e,this.component.ignoreLocal=!0,this.component.init(e,2)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow?.()}}}return o}},7895:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewlabel",i=(0,n.Z)(e);o=class extends i{static get key(){return"label"}constructor(i,n=t){super(n),this.AB=e,this.view=i,this.component=this.view.component()}ui(){const e=this.ids,t=this.view,i=this.component,n={type:"form",margin:10,padding:10,borderless:!0,rows:[{id:e.component,view:"label",label:t.text||"",align:t.settings.alignment},{}]};return i.uiFormatting(n)}async init(e){this.AB=e,webix.codebase="/js/webix/extras/",await this.component.init(this.AB)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},4826:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e),i=(...t)=>e.Multilingual.label(...t);o=class extends t{static get key(){return"layout"}constructor(e,t="interface_editor_view_layout"){super(t)}get viewComponent(){const e=this.CurrentView;return e&&!this._component&&(this._component=e.component()),this._component}ui(){const e=this.CurrentView.views(),t=this.viewComponent.ui().rows.find((e=>"layout"===e.view));return t.type="form",e.length?e.forEach(((e,i)=>{const n=e.component().ui();t.cols[i]={rows:[{type:"template",css:"ab-layout-header",height:30,template:this.templateButton({icon:e.icon,label:e.label,warnings:e._warnings}),onClick:{"ab-component-edit":(t,i,n)=>{this.viewEdit(t,e.id,n)},"ab-component-remove":(t,i,n)=>{this.viewDelete(t,e.id,n)}}},n,{}]}})):t.cols[0]={},t}init(e,t){this.AB=e,this.viewComponent.init(e,t),this.viewComponent.onShow?.(),this.CurrentView.views().forEach((i=>{const n=i.component();n.init(e,t),n.onShow?.()}))}detatch(){this.viewComponent?.detatch?.()}templateButton(e){let t="";return(e.warnings||[]).length>0&&(t=this.WARNING_ICON),`<div class="ab-widget-header ab-layout-header">\n               <i class="fa fa-${e.icon} webix_icon_btn"></i> ${e.label}\n               <div class="ab-component-tools">\n               ${t}\n               <i class="fa fa-trash ab-component-remove"></i>\n               <i class="fa fa-edit ab-component-edit"></i>\n               </div></div>`}viewEdit(e,t){const i=this.CurrentView.views((e=>e.id==t))[0];return!!i&&(setTimeout((()=>{try{this.emit("view.edit",i)}catch(e){console.error(e)}}),50),e.preventDefault(),!1)}viewDelete(e,t){const n=this.CurrentView.views((e=>e.id==t))[0];if(!n)return!1;this.AB.Webix.confirm({title:i("Delete component"),text:i("Do you want to delete <b>{0}</b>?",[n.label]),callback:e=>{e&&n.destroy().then((()=>{n.emit("destroyed",n),this.emit("view.destroyed",n)}))}}),e.preventDefault()}}}return o}},6629:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"menu"}constructor(e,t="interface_editor_viewmenu"){super(t),this.view=e,this.component=this.view.component()}ui(){return{type:"space",rows:[this.component.ui(),{}]}}init(e){this.AB=e,this.onShow()}detatch(){this.component?.detatch?.()}onShow(){const e=this.component.ids,t=this.view,i=$$(e.menu);t.ClearPagesInView(i),t?.settings?.order?.length&&t.AddPagesToView(i,t.settings.order),this.component?.onShow?.()}}}return o}},302:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(4713),o=null;function a(e){if(!o){const t=(0,n.default)(e);o=class extends t{static get key(){return"page"}}}return o}},5025:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"pivot"}constructor(e,t="interface_editor_viewpivot"){super(t),this.view=e,this.component=this.view.component()}ui(){const e=this.component.ui().rows[0];return e.readonly=!1,e.on={onBeforeApply:e=>{this._saveStructure(e)}},e}init(e){this.AB=e,this.component?.init?.()}detatch(){this.component?.detatch?.()}onShow(){this.component?.onShow?.()}_saveStructure(e){this.view.settings.structure=e,this.view.save()}}}return o}},2279:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(3285),o=i(5888);let a=null;function s(e){if(!a){const t="interface_editor_viewtab",i=(0,n.Z)(e),s=i.L(),r=(0,o.Z)(e);a=class extends i{static get key(){return"tab"}constructor(i,n=t){super(n,{view:""}),this.AB=e,this.view=i,this.component=this.view.component()}ui(){const e=this.ids,t=this.view,i=this.component,n=this.component.ui()?.rows[0];if(n.rows){n.rows[0].id=e.component,n.rows[0].tabbar={height:60,type:"bottom",css:t.settings.darkTheme?"webix_dark":"",on:{onItemClick:(i,n)=>{const o=$$(e.component).getValue(),a=t.views((e=>e.id===o))[0],s=t._views.findIndex((e=>e.id===o));n.target.classList.contains("rename")?t.tabPopup.show(a):n.target.classList.contains("move-back")?(t.viewReorder(o,s-1),t.emit("properties.updated",t)):n.target.classList.contains("move-next")&&(t.viewReorder(o,s+1),t.emit("properties.updated",t))}}};for(let e=0;e<(n.rows[0]?.cells??[]).length;e++){let i=n.rows[0].cells[e];i.header=`<i class="fa fa-caret-left move-back ab-tab-back"></i>${n.rows[0]?.cells[e].header}`;let o=t.views((e=>e.id==i.body.id))[0];(!o||(o.warningsAll()||[]).length>0)&&(i.header+=this.WARNING_ICON),i.header+=' <i class="fa fa-pencil-square rename ab-tab-edit"></i>',i.header+=' <i class="fa fa-caret-right move-next ab-tab-next"></i>'}}else if(n.cols){let o=1,a=0;"right"===t.settings.sidebarPos&&(o=0,a=1),n.cols[o].id=e.component,n.cols[a].on={onItemClick:(e,n)=>{const o=e.replace("_menu",""),a=t.views((e=>e.id==o))[0],s=t._views.findIndex((e=>e.id===o));i.onShow(o),n.target.classList.contains("rename")?t.tabPopup.show(a):n.target.classList.contains("move-back")?(t.viewReorder(o,s-1),t.emit("properties.updated",t)):n.target.classList.contains("move-next")&&(t.viewReorder(o,s+1),t.emit("properties.updated",t))}};for(let e=0;e<(n.cols[a].data??[]).length;e++)n.cols[a].data[e].value=n.cols[a].data[e].value+' <i class="fa fa-pencil rename ab-tab-edit"></i>',n.cols[a].data[e].value+='<i class="fa fa-caret-up move-back ab-tab-up"></i>',n.cols[a].data[e].value+=' <i class="fa fa-caret-down move-next ab-tab-down"></i>'}return{rows:[n]}}async init(e){this.AB=e;const t=this.ids;await this.component.init(this.AB);const i=$$(t.component);if(i){const e=i.getValue(),t=this.view.views((t=>t.id===e))[0];let n="";(!t||(t.warningsAll()||[]).length>0)&&(n=this.WARNING_ICON),"tabview"===i.config.view?webix.ui({container:i.getMultiview().$view,view:"template",autoheight:!1,height:1,width:0,template:['<div class="ab-component-tools ab-layout-view ab-tab-tools">','<i class="fa fa-trash ab-component-remove"></i>','<i class="fa fa-edit ab-component-edit"></i>',n,"</div>"].join(""),onClick:{"ab-component-edit":(e,t,i)=>{this.tabEdit(e,t,i)},"ab-component-remove":(e,t,i)=>{this.tabRemove(e,t,i)}}}):"multiview"===i.config.view&&webix.ui({container:i.$view,view:"template",autoheight:!1,height:1,width:0,template:['<div class="ab-component-tools ab-layout-view ab-tab-tools">',n,'<i class="fa fa-trash ab-component-remove"></i>','<i class="fa fa-edit ab-component-edit"></i>',"</div>"].join(""),onClick:{"ab-component-edit":e=>{this.tabEdit(e)},"ab-component-remove":e=>{this.tabRemove(e)}}})}const n=this.view;n.tabPopup||(n.tabPopup=new r(n),n.tabPopup.init(e))}tabEdit(e){const t=$$(this.ids.component).getValue(),i=this.view.views((e=>e.id==t))[0];return!!i&&(setTimeout((()=>{try{this.emit("view.edit",i)}catch(e){console.error(e)}}),50),e.preventDefault(),!1)}tabRemove(e){const t=this.ids,i=$$(t.component),n=i.getValue(),o=this.view.views((e=>e.id==n))[0];return o&&webix.confirm({title:s("Delete tab"),text:s("Do you want to delete <b>{0}</b>?",[o.label]),callback:e=>{if(e){o.destroy();const e=this.component.ui();if(e.rows)i.removeView(n);else{let t=null;for(let i=0;i<e.cols.length;i++)if("sidebar"===e.cols[i].view){t=$$(e.cols[i].id);break}t.remove(`${n}_menu`)}}}}),e.preventDefault(),!1}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return a}},7912:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t="interface_editor_viewtext",i=(0,n.Z)(e);o=class extends i{static get key(){return"text"}constructor(i,n=t){super(n),this.AB=e,this.view=i,this.component=this.view.component()}ui(){const e=this.ids,t=this.view;return{id:e.component,view:"tinymce-editor",value:t.text,config:{plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste imagetools wordcount"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",init_instance_callback:e=>{e.on("Change",(()=>{this.onChange()}))}}}}async init(e){this.AB=e,webix.codebase="/js/webix/extras/",await this.component.init(this.AB)}onChange(){const e=this.ids,t=this.view;t._onChangeFunction&&(clearTimeout(t._onChangeFunction),t._onChangeFunction=null);const i=$$(e.component);t._onChangeFunction=setTimeout((()=>{t.text=i.getValue(),t.save()}),400)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow()}}}return o}},3759:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=(0,n.Z)(e);o=class extends t{static get key(){return"_default"}constructor(t,i="interface_editor_viewdefault"){super(i,{label:""}),this.view=t,this.settings=t.settings,this.base=i,this.AB=e,this.component=this.view.component(this.AB._App)}ui(){return"function"==typeof this.component.ui?this.component.ui():this.component.ui}init(e){return this.AB=e,this.component.init?.(e,2)}detatch(){this.component.detatch?.()}onShow(){this.component.onShow?.()}}}return o}},5888:(e,t,i)=>{"use strict";function n(e){const t=(...t)=>e.Multilingual.label(...t);class i extends e.ClassUI{constructor(e){super(`${e.id}_popup`,{popupTabManager:"",popupTabManagerForm:"",popupTabManagerSaveButton:""}),this.view=e}async init(e){this.view.AB=e,this.create()}ui(){const e=this.ids;return{id:e.popupTabManager,view:"window",height:250,width:300,modal:!0,position:"center",head:" ",body:{id:e.popupTabManagerForm,view:"form",elements:[{view:"text",name:"label",label:t("Label"),required:!0},{view:"combo",name:"tabicon",label:t("Icon"),options:{filter:(e,t)=>0===e.value.toString().toLowerCase().indexOf(t.toLowerCase()),body:{data:this.view.AB._App.icons??[],template:"<i class='fa fa-fw fa-#value#'></i> #value#"}}},{cols:[{fillspace:!0},{view:"button",value:t("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.hide()}},{id:e.popupTabManagerSaveButton,view:"button",css:"webix_primary",value:t("Add Tab"),autowidth:!0,type:"form",click:()=>{const t=$$(e.popupTabManagerForm);if(t.validate()){this.busy();const e=t.getValues(),i=()=>{this.ready(),this.hide(),this.emit("saved")};e.id?this.editTab(e).then((()=>i())):this.addTab(e).then((()=>i()))}}}]}]}}}create(){this.view.AB.Webix.ui(this.ui()).hide()}show(e){const i=this.ids,n=$$(i.popupTabManager),o=$$(i.popupTabManagerForm),a=$$(i.popupTabManagerSaveButton);n&&(e?(o.setValues({id:e.id,label:e.label,tabicon:e.tabicon}),n.getHead().setHTML(t("Edit Tab")),a.setValue(t("Save"))):(o.setValues({id:null,label:"",tabicon:""}),n.getHead().setHTML(t("Add Tab")),a.setValue(t("Add"))),a.refresh(),n.show())}hide(){const e=this.ids,t=$$(e.popupTabManager);t&&t.hide()}busy(){const e=this.ids,t=$$(e.popupTabManagerSaveButton);t&&t.disable()}ready(){const e=this.ids,t=$$(e.popupTabManagerSaveButton);t&&t.enable()}addTab(e){return this.view.addTab(e.label??"",e.tabicon??null)}editTab(e){const t=this.view.views((t=>t.id===e.id))[0];if(t)return t.label=e.label,t.tabicon=e.tabicon,t.save()}}return i}i.d(t,{Z:()=>n})},7056:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=null;function o(e){if(!n){var t=[];[i(6063),i(1573),i(9263),i(1134),i(2818),i(2970),i(2250),i(6393),i(727),i(6139),i(7380),i(7341),i(4074),i(3820),i(6771),i(401),i(8546),i(1702),i(8114)].forEach((i=>{t.push(i.default(e))}));var o=[];[i(2607),i(5732),i(7670),i(3412),i(6692),i(6699),i(1051),i(8010),i(2367),i(6277),i(4490),i(7825),i(8866),i(7358),i(9722)].forEach((t=>{o.push(t.default(e))}));var a=[];[i(814),i(7887),i(7661),i(2225),i(992),i(3875),i(4158),i(4856),i(3156),i(1712),i(231),i(5786),i(3300),i(1377),i(9270),i(3381),i(8568),i(7420),i(1023),i(7901),i(6309),i(7103),i(3020),i(2480),i(2318),i(1722),i(6929),i(5670),i(6378),i(7754),i(9720),i(2651),i(9975),i(5177),i(4973),i(5281),i(5711),i(4247),i(1163),i(8450),i(6598),i(9630),i(1832),i(7375),i(6234),i(7669)].forEach((t=>{a.push(t.default(e))})),n={fields:function(e=(()=>!0)){return t.filter(e)},processElements:function(e=(()=>!0)){return o.filter(e)},views:function(e=(()=>!0)){return a.filter(e)}}}return n}},917:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285);let o=null;function a(e){if(!o){const t=e.Config.uiSettings(),i=(0,n.Z)(e),a=i.L();o=class extends i{constructor(t="properties_abfield",i={}){const n={label:"",columnName:"",fieldDescription:"",showIcon:"",required:"",numberOfNull:"",unique:"",filterComplex:"",addValidation:"",shorthand:"",validationRules:"",buttonCog:"",editFieldName:"",editFieldNameForm:"",editFieldNameFormDatabaseColumn:"",filterView:"",uniqueView:""};Object.keys(i).forEach((e=>{void 0===n[e]?n[e]="":console.error(`!!! ABFieldProperty:: passed in ids contains a restricted field : ${e}`)})),super(t,n),this.base=t,this.AB=e}ui(e=[]){const t=this.ids,n=this.FieldClass(),o={view:"form",id:t.component,borderless:!0,autowidth:!0,elements:[{cols:[{view:"label",label:a("Field Name:"),align:"left",width:87},{name:"label",id:t.label,view:"text",placeholder:a("Database field name"),fillspace:!0,on:{onChange:e=>{this.textFieldName(e)},onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"text",id:t.columnName,name:"columnName",hidden:!0,on:{onAfterRender(){i.CYPRESS_REF(this)}}},{view:"button",id:t.buttonCog,css:"webix_transparent",label:'<span class="webix_icon_btn" style="margin: 0px;"><i class="nomargin fa fa-cog"></i></span>',width:40,on:{onItemClick:()=>{this.buttonCog()},onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:a("Show icon:"),align:"left",width:75},{view:"switch",id:t.showIcon,name:"showIcon",value:1,width:55,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{width:20},{view:"label",label:a("Required:"),align:"left",width:66},{view:"switch",id:t.required,name:"required",disabled:!n.defaults().supportRequire,value:0,width:55,on:{onChange:(e,i)=>{this.requiredOnChange(e,i,t),this.getNumberOfNullValue(e)},onAfterRender:function(){i.CYPRESS_REF(this)}}},{width:20},{view:"label",id:t.numberOfNull,css:{color:"#f00"},label:"",hidden:!0,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"label",label:a("Unique:"),align:"left",width:59},{view:"switch",id:t.unique,name:"unique",disabled:!n.defaults().supportUnique,disallowEdit:!0,value:0,width:55,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{width:20},{id:t.addValidation,view:"button",label:a("Add Field Validation"),css:"webix_primary",popup:t.filterView,on:{onItemClick:()=>{$$(t.filterView).adjust()},onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{id:t.validationRules,view:"text",hidden:!0,name:"validationRules",on:{onAfterRender(){i.CYPRESS_REF(this)}}},{cols:[{view:"label",label:a("Custom Settings:"),align:"left",width:200},{},{view:"label",id:t.fieldDescription,label:a("Description"),align:"right",on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{id:t.uniqueView,view:"scrollview",borderless:!0,scroll:"y",css:{background:"#ddd"},body:{padding:{top:25,bottom:25,left:25,right:25},rows:e.map((e=>(!e.id&&e.name&&(this.ids[e.name]||(this.ids[e.name]=`${this.base}_${e.name}`),e.id=this.ids[e.name]),e)))}}],rules:{label:webix.rules.isNotEmpty,columnName:webix.rules.isNotEmpty}};return webix.ui({view:"window",id:t.editFieldName,modal:!0,hidden:!0,position:"center",width:450,height:250,head:{view:"toolbar",css:"webix_dark",paddingX:2,elements:[{view:"label",align:"center",label:a("Edit field name")}]},body:{view:"form",id:t.editFieldNameForm,elements:[{cols:[{view:"label",label:a("Database Column:"),align:"right",width:125},{view:"text",id:t.editFieldNameFormDatabaseColumn,name:"columnName",placeholder:a("Database Column"),on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{width:30}]},{cols:[{},{view:"button",value:a("Cancel"),css:"webix_danger",width:100,on:{onItemClick:()=>{this.buttonEditFieldNameButtonCancel()},onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"button",value:a("Submit"),css:"webix_primary",width:100,on:{onItemClick:()=>{this.buttonEditFieldNameButtonSubmit()},onAfterRender:function(){i.CYPRESS_REF(this)}}},{width:30}]}]}}),webix.ui({id:t.filterView,view:"popup",resize:!0,height:503,width:692,position:"center",body:{rows:[{view:"toolbar",css:"webix_dark",paddingX:0,elements:[{view:"label",align:"center",label:a("Field Validation")},{view:"button",label:'<span class="webix_icon"><i class="nomargin fa fa-times"></i></span>',css:"webix_transparent",width:40,click:()=>{$$(t.filterView).hide()},on:{onAfterRender:()=>{i.CYPRESS_REF(this)}}}]},{cols:[{view:"button",label:a("Add"),css:"webix_secondary",on:{onItemClick:()=>{this.addValidation()},onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"button",label:a("Delete All"),css:"webix_danger",on:{onItemClick:()=>{this.filterViewDeleteAllValidation()},onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{view:"scrollview",scroll:"y",body:{id:t.filterComplex,rows:[]}}]},on:{onViewResize:()=>{$$(t.filterView).show()}}}),o}async init(e){this.AB=e;const t=this.FieldClass();t?$$(this.ids.fieldDescription).define("label","*"+a(t.defaults().description)):$$(this.ids.fieldDescription).hide()}textFieldName(e){const t=this.formValues();this.modeEdit?t.label=e:(t.label=e,t.columnName=t.label),$$(this.ids.component).setValues(t)}buttonCog(){if(this.isValid()){const e=this.formValues();$$(this.ids.editFieldNameForm).setValues({columnName:e.columnName}),this.modeEdit?$$(this.ids.editFieldNameFormDatabaseColumn).disable():$$(this.ids.editFieldNameFormDatabaseColumn).enable(),$$(this.ids.editFieldName).show()}}buttonEditFieldNameButtonCancel(){const e=$$(this.ids.component).getValues();$$(this.ids.editFieldNameForm).setValues({columnName:e.columnName}),$$(this.ids.editFieldName).hide()}buttonEditFieldNameButtonSubmit(){const e=this.formValues(),t=$$(this.ids.editFieldNameForm).getValues().columnName;e.columnName=""!==t?t:e.columnName,$$(this.ids.component).setValues(e),$$(this.ids.editFieldName).hide()}addValidation(e){const n=this.ids,o=new this.AB.Class.FilterComplex(this.AB._App,"field_validation_rules",this.AB);$$(n.filterComplex).addView({view:"form",css:"abValidationForm",cols:[{rows:[{view:"text",name:"invalidMessage",labelWidth:t.labelWidthLarge,value:e?.invalidMessage?e.invalidMessage:"",label:a("Invalid Message")},o.ui]},{view:"button",css:"webix_danger",icon:"fa fa-trash",type:"icon",autowidth:!0,click:function(){const e=this.getParentView();$$(n.filterComplex).removeView(e);const t=$$(n.filterComplex).queryView({view:"form",css:"abValidationForm"},"all");$$(n.addValidation).define("badge",0!==t.length?t.length:null),$$(n.addValidation).refresh()},on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]}),this.resetDefaultValidation(),$$(o.ids.save).hide(),o.fieldsLoad(this.CurrentObject.fields()),e&&e.rules&&o.setValue(e.rules)}filterViewDeleteAllValidation(){const e=this.ids,t=$$(e.filterComplex).queryView({view:"form",css:"abValidationForm"},"all");t.length&&t.forEach((t=>{$$(e.filterComplex).removeView(t)})),this.resetDefaultValidation()}clearEditor(){console.error("!!! Depreciated! call clear() instead."),this.clear()}clear(){const e=this.ids;this._CurrentField=null;const t=this.defaultValues();for(const i in t){const n=$$(e[i]);n&&n.setValue(t[i])}this.filterViewDeleteAllValidation(),$$(e.numberOfNull).hide()}clearInvalid(e){$$(this.ids.component).markInvalid(e,!1)}resetDefaultValidation(){const e=this.ids,t=$$(e.filterComplex).queryView({view:"form",css:"abValidationForm"},"all");$$(e.addValidation).define("badge",0!==t.length?t.length:null),$$(e.addValidation).refresh()}defaults(){const e=this.FieldClass();return e?e.defaults():(console.error("!!! ABFieldStringProperty: could not find FieldClass[]"),null)}defaultValues(){const e={label:"",columnName:"",showIcon:1,required:0,unique:0,validationRules:""},t=this.FieldClass();if(t){const i=t.defaultValues();Object.keys(i).forEach((t=>{void 0===e[t]&&(e[t]=i[t])}))}return e}eachDeep(e,t){e.forEach((e=>{e.cols?this.eachDeep(e.cols,t):e.body?.cols?this.eachDeep(e.body.cols,t):e.rows?this.eachDeep(e.rows,t):e.body?.rows?this.eachDeep(e.body.rows,t):t(e)}))}editorPopulate(e){console.error("!!! Depreciated. call populate() instead."),this.populate(e)}FieldClass(){return console.error("!!! Child Class has not overwritten FieldClass()"),null}_FieldClass(e){return this.AB.Class.ABFieldManager.fieldByKey(e)}formValues(){return $$(this.ids.component).getValues()}async getNumberOfNullValue(e){const t=this.ids;if(e&&this._CurrentField&&this._CurrentField.id&&this._CurrentField.settings.required!=e)try{const e=await this._CurrentField.object.model().count({where:{glue:"and",rules:[{key:this._CurrentField.id,rule:"is_null"}]}});e.count>0?($$(t.numberOfNull).setValue(a("** There are {0} rows that will be updated to default value",[e.count])),$$(t.numberOfNull).show()):$$(t.numberOfNull).hide()}catch(e){}else $$(t.numberOfNull).hide()}isValid(){const e=this.ids;let t=$$(e.component).validate(),i=this.formValues().columnName;const n=this.FieldClass();n||this.AB.notify.developer(new Error("Unable to resolve FieldClass"),{context:"ABFieldProperty: isValid()",base:this.ids.component}),n?.reservedNames.indexOf(i.trim().toLowerCase())>-1&&(this.markInvalid("columnName",a("This is a reserved name")),t=!1);let o=this.CurrentObject?.fields((e=>e.columnName==i));return this._CurrentField&&(o=o.filter((e=>e.id!=this._CurrentField.id))),o.length>0&&(this.markInvalid("columnName",a("This column name is in use by another field ({0})",[o.label])),t=!1),t}markInvalid(e,t){$$(this.ids.component).markInvalid(e,t)}populate(e){const t=this.ids;if(this._CurrentField=e,["label","columnName"].forEach((i=>{$$(t[i]).setValue?.(e[i])})),$$(t.fieldDescription).setValue(e.fieldDescription()),Object.keys(t).forEach((i=>{void 0!==e.settings[i]&&$$(t[i])?.setValue?.(e.settings[i])})),$$(t.label).setValue(e.label),$$(t.columnName).setValue(e.columnName),$$(t.showIcon).setValue(e.settings.showIcon),$$(t.required).setValue(e.settings.required),$$(t.unique).setValue(e.settings.unique),e.settings&&e.settings.validationRules){let i=e.settings.validationRules;if("string"==typeof i)try{i=JSON.parse(i)}catch(t){this.AB.notify.builder(t,{context:`ABField[${e.id}][${e.name}]: has invalid validationRules`,validationRules:e.settings.validationRules}),i=[]}(i||[]).forEach((i=>{e.addValidation(t,i)})),$$(t.addValidation).define("badge",0!==i.length?i.length:null),$$(t.addValidation).refresh()}}requiredOnChange(){}values(){const e=this.ids,t=$$(e.component).getValues();if($$(e.filterComplex)){const i=[];$$(e.filterComplex).queryView({view:"form",css:"abValidationForm"},"all").forEach((e=>{const t=e.queryView({view:"querybuilder"}).getValue(),n={invalidMessage:e.queryView({name:"invalidMessage"}).getValue(),rules:t};i.push(n)})),t.validationRules=JSON.stringify(i)}const i=this.FieldClass(),n=i.editorValues(t);return n.key=i.defaults().key,n}}}return o}},6063:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_autoindex`,{prefix:"",delimiter:"",displayLength:"",previewText:""})}ui(){const e=this.ids,n=this.FieldClass();return super.ui([{cols:[{view:"label",label:i("Prefix:"),align:"right",width:75},{id:e.prefix,view:"text",name:"prefix",placeholder:i("Prefix"),on:{onTimedKeyPress:()=>{this.previewChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Delimiter:"),align:"right",width:75},{id:e.delimiter,view:"richselect",name:"delimiter",value:"none",options:n.delimiterList(),on:{onChange:()=>{this.previewChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Length:"),align:"right",width:75},{id:e.displayLength,view:"counter",name:"displayLength",step:1,value:4,min:1,max:10,width:104,on:{onChange:()=>{this.previewChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Preview:"),align:"right",width:75},{id:e.previewText,view:"text",name:"previewText",value:"0000",disabled:!0,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]}])}previewChange(){const e=this.ids,t=this.FieldClass().setValueToIndex($$(e.prefix).getValue(),$$(e.delimiter).getValue(),$$(e.displayLength).getValue(),0);$$(e.previewText).setValue(t)}FieldClass(){return super._FieldClass("AutoIndex")}populate(e){super.populate(e),this.previewChange()}}}},1573:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_boolean`,{checkBoxLabel:"",default:""})}ui(){const e=this.ids;return super.ui([{cols:[{view:"label",label:i("Default:"),align:"right",width:65},{id:e.default,name:"default",view:"checkbox",css:"webix_table_checkbox",width:30,on:{onChange:t=>{let n=i("Check"),o=i("Uncheck");$$(e.checkBoxLabel).setValue(t?n:o)},onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:e.checkBoxLabel,view:"label",label:i("Uncheck"),width:60}]}])}FieldClass(){return super._FieldClass("boolean")}}}},9263:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_calculate`,{formula:"",fieldPopup:"",fieldList:"",numberOperatorPopup:"",numberOperatorPopupList:"",dateOperatorPopup:"",dateFieldList:"",decimalSign:"",decimalPlaces:""})}ui(){const e=this.ids,n=[{id:"none",value:i("None")},{id:"comma",value:i("Comma"),sign:","},{id:"period",value:i("Period"),sign:"."},{id:"space",value:i("Space"),sign:" "}];return webix.ui({id:e.fieldPopup,view:"popup",hidden:!0,width:200,body:{id:e.fieldList,view:"list",data:[],template:this.itemTemplate,on:{onItemClick:t=>{const i="{"+$$(e.fieldList).getItem(t).columnName+"}";this.insertEquation(i),$$(e.fieldPopup).hide()},onAfterRender:function(){t.CYPRESS_REF(this)}}},on:{onBeforeShow:()=>{$$(e.fieldList).clearAll(),$$(e.fieldList).parse(this.getNumberFields())}}}),webix.ui({id:e.numberOperatorPopup,view:"popup",hidden:!0,width:200,body:{id:e.numberOperatorPopupList,view:"list",template:this.itemTemplate,data:[{label:i("+ Adds"),symbol:"+"},{label:i("- Subtracts"),symbol:"-"},{label:i("* Multiples"),symbol:"*"},{label:i("/ Divides"),symbol:"/"},{label:i("( Open Bracket"),symbol:"("},{label:i(") Closed Bracket"),symbol:")"}],on:{onItemClick:t=>{const i=$$(e.numberOperatorPopupList).getItem(t);this.insertEquation(i.symbol),$$(e.numberOperatorPopup).hide()},onAfterRender:function(){t.CYPRESS_REF(this)}}}}),webix.ui({id:e.dateOperatorPopup,view:"popup",hidden:!0,width:280,data:[],body:{id:e.dateFieldList,view:"list",template:this.itemTemplate,data:[],on:{onItemClick:t=>{const i=$$(e.dateFieldList).getItem(t);this.insertEquation(i.function),$$(e.dateOperatorPopup).hide()},onAfterRender:function(){t.CYPRESS_REF(this)}}},on:{onBeforeShow:()=>{$$(e.dateFieldList).clearAll(),$$(e.dateFieldList).parse(this.getDateFields())}}}),super.ui([{rows:[{cols:[{view:"label",label:i("Equation:"),align:"left",width:75},{}]},{id:e.formula,name:"formula",view:"textarea",height:100,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{rows:[{cols:[{view:"button",type:"icon",css:"webix_primary",icon:"fa fa-hashtag",label:i("Number Fields"),width:185,click:function(){$$(e.fieldPopup).show(this.$view)},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"button",type:"icon",css:"webix_primary",icon:"fa fa-calendar",label:i("Date Fields"),click:function(){$$(e.dateOperatorPopup).show(this.$view)},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-hashtag",label:i("Number Operators"),width:185,click:function(){$$(e.numberOperatorPopup).show(this.$view)},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{}]},{cols:[{view:"label",label:i("Decimals:"),align:"right",width:67},{id:e.decimalSign,view:"richselect",name:"decimalSign",value:"none",options:n,on:{onChange:t=>{"none"==t?$$(e.decimalPlaces).disable():$$(e.decimalPlaces).enable()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"label",label:i("Places:"),align:"right",width:67},{id:e.decimalPlaces,view:"counter",name:"decimalPlaces",step:1,value:1,min:1,max:10,disabled:!0,width:104,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]}]}])}getNumberFields(){return this.CurrentObject?this.CurrentObject.fields((e=>"number"==e.key||"calculate"==e.key||"formula"==e.key)):[]}getDateFields(){if(this.CurrentObject){const e=[];return e.push({label:i("Convert minutes to hours (Format: hours.minutes)"),function:"MINUTE_TO_HOUR()"}),e.push({label:i("Year of [{0}]",["Current"]),function:"YEAR(CURRENT)"}),e.push({label:i("Month of [{0}]",["Current"]),function:"MONTH(CURRENT)"}),e.push({label:i("Day of [{0}]",["Current"]),function:"DAY(CURRENT)"}),e.push({label:i("Get days of [{0}] (since January 1, 1970)",["Current"]),function:"DATE(CURRENT)"}),e.push({label:i("Get hours of [{0}] (since January 1, 1970)",["Current"]),function:"HOUR(CURRENT)"}),e.push({label:i("Get minutes of [{0}] (since January 1, 1970)",["Current"]),function:"MINUTE(CURRENT)"}),this.CurrentObject.fields((e=>"date"==e.key)).forEach((t=>{e.push({label:i("Calculate age from [{0}]",[t.label]),function:`AGE({${t.columnName}})`}),e.push({label:i("Year of [{0}]",[t.label]),function:`YEAR({${t.columnName}})`}),e.push({label:i("Month of [{0}]",[t.label]),function:`MONTH({${t.columnName}})`}),e.push({label:i("Day of [{0}]",[t.label]),function:`DAY({${t.columnName}})`}),e.push({label:i("Get days of [${0}] (since January 1, 1970)",[t.label]),function:`DATE({${t.columnName}})`}),e.push({label:i("Get hours of [${0}] (since January 1, 1970)",[t.label]),function:`HOUR({${t.columnName}})`}),e.push({label:i("Get minutes of [${0}] (since January 1, 1970)",[t.label]),function:`MINUTE({${t.columnName}})`})})),e}return[]}itemTemplate(e){let t="";return e.icon&&(t+=`<i class="fa fa-${e.icon}" aria-hidden="true"></i> `),e.label&&(t+=e.label),t}insertEquation(e){const t=this.ids,i=$$(t.formula).getValue();$$(t.formula).setValue(i+e)}FieldClass(){return super._FieldClass("calculate")}isValid(){const e=this.ids,t=this.FieldClass();let i=super.isValid();if(i){$$(e.component).markInvalid("formula",!1);const n=$$(e.formula).getValue();try{t.convertToJs(this.CurrentObject,n,{}),i=!0}catch(t){$$(e.component).markInvalid("formula",""),i=!1}}return i}}}},1134:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_combine`,{combinedFields:"",delimiter:""})}ui(){const e=this.ids,n=this.FieldClass();return super.ui([{cols:[{view:"label",label:o("Combined Fields:"),align:"right",width:125},{id:e.combinedFields,name:"combinedFields",view:"multicombo",labelWidth:t.labelWidthXLarge,disallowEdit:!0,options:[],on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:o("Delimiter:"),align:"right",width:125},{id:e.delimiter,view:"richselect",name:"delimiter",value:n.defaultValues().delimiter,labelWidth:t.labelWidthXLarge,disallowEdit:!0,options:[{id:"plus",value:o("Plus ( + )")},{id:"dash",value:o("Dash ( - )")},{id:"period",value:o("Period ( . )")},{id:"space",value:o("Space ( )")}],on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]}])}FieldClass(){return super._FieldClass("combined")}show(){const e=this.ids,t=this.CurrentObject.fields((e=>["string","LongText","number","date","datetime","boolean","list","email","user","AutoIndex","combined"].indexOf(e.key)>-1||e.isConnection&&("one"==e.settings.linkType&&"many"==e.settings.linkViaType||"one"==e.settings.linkType&&"one"==e.settings.linkViaType&&e.settings.isSource))).map((e=>({id:e.id,value:e.label})));super.show();const i=$$(e.combinedFields);i&&(i.define("options",t),i.refresh())}}}},2818:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_connect`,{linkObject:"",objectCreateNew:"",fieldLink:"",fieldLink2:"",linkType:"",linkViaType:"",fieldLinkVia:"",fieldLinkVia2:"",link1:"",link2:"",isCustomFK:"",indexField:"",indexField2:"",connectDataPopup:""})}ui(){const e=this.FieldClass(),n=this.ids;return super.ui([{cols:[{view:"label",label:o("Connected to:"),align:"right",width:94},{id:n.linkObject,view:"richselect",disallowEdit:!0,name:"linkObject",labelWidth:t.labelWidthLarge,placeholder:o("Select object"),options:[],on:{onChange:(e,t)=>{this.selectObjectTo(e,t)},onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{view:"layout",id:n.link1,hidden:!0,cols:[{id:n.fieldLink,view:"label",width:300},{id:n.linkType,disallowEdit:!0,name:"linkType",view:"richselect",value:e.defaultValues().linkType,width:95,options:[{id:"many",value:o("many")},{id:"one",value:o("one")}],on:{onChange:(e,t)=>{this.selectLinkType(e,t)},onAfterRender:function(){i.CYPRESS_REF(this)}}},{id:n.fieldLinkVia,view:"label",label:o("<b>[Select Object]</b> entry."),width:200}]},{view:"layout",id:n.link2,hidden:!0,cols:[{id:n.fieldLinkVia2,view:"label",label:o("Each <b>[Select object]</b> entry connects with"),width:300},{id:n.linkViaType,name:"linkViaType",disallowEdit:!0,view:"richselect",value:e.defaultValues().linkViaType,width:95,options:[{id:"many",value:o("many")},{id:"one",value:o("one")}],on:{onChange:(e,t)=>{this.selectLinkViaType(e,t)},onAfterRender:function(){i.CYPRESS_REF(this)}}},{id:n.fieldLink2,view:"label",width:200}]},{name:"linkColumn",view:"text",hidden:!0},{name:"isSource",view:"text",hidden:!0},{id:n.isCustomFK,name:"isCustomFK",view:"checkbox",disallowEdit:!0,labelWidth:0,labelRight:o("Custom Foreign Key"),hidden:!0,on:{onChange:()=>{this.checkCustomFK()},onAfterRender:function(){i.CYPRESS_REF(this)}}},{id:n.indexField,name:"indexField",view:"richselect",disallowEdit:!0,hidden:!0,labelWidth:t.labelWidthLarge,label:o("Index Field:"),placeholder:o("Select index field"),options:[],on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{id:n.indexField2,name:"indexField2",view:"richselect",disallowEdit:!0,hidden:!0,labelWidth:t.labelWidthLarge,label:o("Index Field:"),placeholder:o("Select index field"),options:[],on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}])}clear(){super.clear(),$$(this.ids.linkObject).setValue(this.FieldClass().defaultValues().linkObject)}FieldClass(){return super._FieldClass("connectObject")}isValid(){const e=this.ids;let t=super.isValid();return $$(e.linkObject).getValue()?this.clearInvalid("linkObject"):(this.markInvalid("linkObject",o("Select an object")),t=!1),t}selectLinkViaType(e){let t=o("entry"),i=o("entries"),n=$$(this.ids.fieldLink2),a=n.getValue()||"";a="many"==e?a.replace(t,i):a.replace(i,t),n.define("label",a),n.refresh(),this.updateCustomIndex()}show(){super.show(),this.populateSelect(!1);const e=this.ids;$$(e.fieldLink).setValue(o("Each <b>{0}</b> entry connects with",[this.CurrentObject?.label])),$$(e.fieldLink2).setValue(o("<b>{0}</b> entry.",[this.CurrentObject?.label])),this.updateCustomIndex()}checkCustomFK(){const e=this.ids;if($$(e.indexField).hide(),$$(e.indexField2).hide(),$$(e.isCustomFK).getValue()){let t=$$(e.indexField).getList().config.data;t&&t.length&&$$(e.indexField).show();let i=$$(e.indexField2).getList().config.data;i&&i.length&&$$(e.indexField2).show()}}populateSelect(){const e=[],t=this.CurrentApplication;t?t.objectsIncluded().forEach((t=>{e.push({id:t.id,value:t.label})})):this.AB.objects().forEach((t=>{e.push({id:t.id,value:t.label})})),e.sort(((e,t)=>e.value<t.value?-1:e.value>t.value?1:0));const i=this.ids,n=$$(i.linkObject);n.define("options",e),n.refresh()}selectLinkType(e){let t=o("entry"),i=o("entries"),n=$$(this.ids.fieldLinkVia),a=n.getValue()||"";a="many"==e?a.replace(t,i):a.replace(i,t),n.define("label",a),n.refresh(),this.updateCustomIndex()}selectObjectTo(e,t){const i=this.ids;if(e||($$(i.link1).hide(),$$(i.link2).hide()),e==t||""==e)return;let n=$$(i.linkObject).getList().getItem(e);if(!n)return;let a=n.value;$$(i.fieldLinkVia).setValue(o("<b>{0}</b> entry.",[a])),$$(i.fieldLinkVia2).setValue(o("Each <b>{0}</b> entry connects with",[a])),$$(i.link1).show(),$$(i.link2).show(),this.updateCustomIndex()}updateCustomIndex(){const e=this.ids;let t=$$(e.linkObject).getValue(),i=$$(e.linkType).getValue(),n=$$(e.linkViaType).getValue(),o=null,a=null;$$(e.indexField2).define("options",[]),$$(e.indexField2).refresh();let s=`${i}:${n}`;if(["one:one","one:many"].indexOf(s)>-1)o=this.AB.objectByID(t);else if("many:one"==s)o=this.CurrentObject;else if("many:many"==s){o=this.CurrentObject;let i=this.AB.objectByID(t),n=[];a=i.indexes((e=>e.unique)),(a||[]).forEach((e=>{(e.fields||[]).forEach((e=>{(e&&e.settings&&e.settings.required&&!n.filter((t=>t.id==e.id)).length||"AutoIndex"==e.key||"combined"==e.key)&&n.push({id:e.id,value:e.label})}))})),$$(e.indexField2).define("options",n),$$(e.indexField2).refresh()}if($$(e.indexField).hide(),$$(e.indexField2).hide(),!o)return void $$(e.isCustomFK).hide();let r=o.indexes((e=>e.unique));if((!r||r.length<1)&&(!a||a.length<1))return $$(e.isCustomFK).hide(),$$(e.indexField).define("options",[]),void $$(e.indexField).refresh();let l=[];(r||[]).forEach((e=>{(e.fields||[]).forEach((e=>{(e&&e.settings&&e.settings.required&&!l.filter((t=>t.id==e.id)).length||"AutoIndex"==e.key||"combined"==e.key)&&l.push({id:e.id,value:e.label,field:e})}))})),$$(e.indexField).define("options",l),$$(e.indexField).refresh(),l&&l.length&&$$(e.isCustomFK).show(),this.checkCustomFK()}}}},2970:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_date`,{default:"",currentToDefault:"",dateDisplay:"",dateFormat:"",defaultDate:"",defaultDateValue:"",validateCondition:"",validateRange:"",validateRangeUnit:"",validateRangeBefore:"",validateRangeAfter:"",validateRangeBeforeLabel:"",validateRangeAfterLabel:"",validateStartDateContainer:"",validateStartDateContainerLabel:"",validateEndDateContainer:""})}ui(){const e=this.ids;return super.ui([{cols:[{view:"label",label:i("Date Format:"),align:"right",width:88},{view:"richselect",name:"dateFormat",id:e.dateFormat,value:2,options:[{id:2,value:"dd/mm/yyyy"},{id:3,value:"mm/dd/yyyy"},{id:4,value:"M D, yyyy"},{id:5,value:"D M, yyyy"}],on:{onChange:()=>{this.refreshDateValue()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Default:"),align:"right",width:88},{view:"richselect",name:"defaultDate",id:e.defaultDate,value:1,options:[{id:1,value:i("None")},{id:2,value:i("Current Date")},{id:3,value:i("Specific Date")}],on:{onChange:()=>{this.defaultDateChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"datepicker",name:"defaultDateValue",id:e.defaultDateValue,gravity:.5,disabled:!0,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{view:"label",label:i("Validation criteria:"),width:123,css:"ab-text-bold"},{cols:[{view:"label",label:i("Condition:"),align:"right",width:88,css:"ab-text-bold"},{id:e.validateCondition,view:"select",name:"validateCondition",value:"none",options:[{id:"none",value:i("None")},{id:"dateRange",value:i("Range")},{id:"between",value:i("Between")},{id:"notBetween",value:i("Not between")},{id:"=",value:i("Equal to")},{id:"<>",value:i("Not equal to")},{id:">",value:i("Greater than")},{id:"<",value:i("Less than")},{id:">=",value:i("Greater than or Equal to")},{id:"<=",value:i("Less than or Equal to")}],on:{onChange:t=>{switch(t){case"none":$$(e.validateRange).hide(),$$(e.validateStartDateContainer).hide(),$$(e.validateEndDateContainer).hide();break;case"dateRange":$$(e.validateRange).show(),$$(e.validateStartDateContainer).hide(),$$(e.validateEndDateContainer).hide();break;case"between":case"notBetween":$$(e.validateRange).hide(),$$(e.validateStartDateContainerLabel).define("label",i("Start Date:")),$$(e.validateStartDateContainerLabel).refresh(),$$(e.validateStartDateContainer).show(),$$(e.validateEndDateContainer).show();break;case"=":case"<>":case">":case"<":case">=":case"<=":$$(e.validateRange).hide(),$$(e.validateStartDateContainerLabel).define("label",i("Date:")),$$(e.validateStartDateContainerLabel).refresh(),$$(e.validateStartDateContainer).show(),$$(e.validateEndDateContainer).hide()}},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:e.validateRange,hidden:!0,rows:[{cols:[{view:"label",label:i("Unit:"),align:"right",width:88},{id:e.validateRangeUnit,view:"select",name:"validateRangeUnit",options:[{id:"days",value:i("Days")},{id:"months",value:i("Months")},{id:"years",value:i("Years")}],on:{onChange:()=>{$$(e.validateRangeBeforeLabel).refresh(),$$(e.validateRangeAfterLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{id:e.validateRangeBeforeLabel,view:"template",align:"left",width:140,borderless:!0,template:()=>{let t=$$(e.validateRangeUnit).getValue(),n=$$(e.validateRangeUnit).config.options.filter((e=>e.id==t))[0];return`${i("Before")} ${$$(e.validateRangeBefore).getValue()} ${n.value}`}},{view:"label",label:"",align:"center",width:1},{id:e.validateRangeAfterLabel,view:"template",align:"right",borderless:!0,template:()=>{let t=$$(e.validateRangeUnit).getValue(),n=$$(e.validateRangeUnit).config.options.filter((e=>e.id==t))[0];return`${i("After")} ${$$(e.validateRangeAfter).getValue()} ${n.value}`}}]},{cols:[{id:e.validateRangeBefore,view:"slider",name:"validateRangeBefore",on:{onChange:()=>{$$(e.validateRangeBeforeLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:e.validateRangeAfter,view:"slider",name:"validateRangeAfter",on:{onChange:()=>{$$(e.validateRangeAfterLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]}]},{id:e.validateStartDateContainer,hidden:!0,cols:[{id:e.validateStartDateContainerLabel,view:"label",label:i("Start Date:"),align:"right",width:88},{name:"validateStartDate",view:"datepicker",on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:e.validateEndDateContainer,hidden:!0,cols:[{view:"label",label:i("End Date:"),align:"right",width:88},{name:"validateEndDate",view:"datepicker",on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]}])}defaultDateChange(){const e=this.ids,t=$$(e.defaultDate).getValue();switch(parseInt(t)){case 1:$$(e.defaultDateValue).disable(),$$(e.defaultDateValue).setValue();break;case 2:$$(e.defaultDateValue).enable(),$$(e.defaultDateValue).setValue(new Date),this.refreshDateValue();break;case 3:$$(e.defaultDateValue).enable(),$$(e.defaultDateValue).setValue();break;default:$$(e.defaultDateValue).disable(),$$(e.defaultDateValue).setValue(new Date)}}refreshDateValue(){const e=this.ids,t=$$(e.dateFormat).getValue();let i="";switch(parseInt(t)){case 2:default:i="%d/%m/%Y";break;case 3:i="%m/%d/%Y";break;case 4:i="%M %d, %Y";break;case 5:i="%d %M, %Y"}$$(e.defaultDateValue).define("format",i),$$(e.defaultDateValue).refresh()}defaultTimeChange(){const e=this.ids;switch(console.log("defaultTimeChange"),parseInt($$(e.defaultTime).getValue())){case 1:default:$$(e.defaultTimeValue).disable(),$$(e.defaultTimeValue).setValue();break;case 2:$$(e.defaultTimeValue).enable(),$$(e.defaultTimeValue).setValue(new Date);break;case 3:$$(e.defaultTimeValue).enable(),$$(e.defaultTimeValue).setValue()}}FieldClass(){return super._FieldClass("date")}populate(e){const t=this.ids;super.populate(e),$$(t.defaultDateValue).setValue(new Date(e.settings.defaultDateValue))}show(){this.refreshDateValue(),super.show()}}}},2250:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_datetime`,{default:"",currentToDefault:"",dateDisplay:"",dateFormat:"",defaultDate:"",defaultDateValue:"",timeFormat:"",defaultTime:"",defaultTimeValue:"",validateCondition:"",validateRange:"",validateRangeUnit:"",validateRangeBefore:"",validateRangeAfter:"",validateRangeBeforeLabel:"",validateRangeAfterLabel:"",validateStartDateContainer:"",validateStartDateContainerLabel:"",validateEndDateContainer:""})}ui(){const e=this.ids;return super.ui([{view:"label",label:i("Date:"),align:"left"},{cols:[{view:"label",label:i("Format:"),align:"right",width:88},{id:e.dateFormat,view:"richselect",name:"dateFormat",value:1,options:[{id:1,value:i("Ignore Date")},{id:2,value:"dd/mm/yyyy"},{id:3,value:"mm/dd/yyyy"},{id:4,value:"M D, yyyy"},{id:5,value:"D M, yyyy"}],on:{onChange:()=>{this.refreshDateValue()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Default:"),align:"right",width:88},{view:"richselect",name:"defaultDate",id:e.defaultDate,value:1,options:[{id:1,value:i("None")},{id:2,value:i("Current Date")},{id:3,value:i("Specific Date")}],on:{onChange:()=>{this.defaultDateChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"datepicker",name:"defaultDateValue",id:e.defaultDateValue,gravity:.5,disabled:!0,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{view:"label",label:i("Validation criteria:"),width:123,css:"ab-text-bold"},{cols:[{view:"label",label:i("Condition:"),align:"right",width:88,css:"ab-text-bold"},{id:e.validateCondition,view:"select",name:"validateCondition",value:"none",options:[{id:"none",value:i("None")},{id:"dateRange",value:i("Range")},{id:"between",value:i("Between")},{id:"notBetween",value:i("Not between")},{id:"=",value:i("Equal to")},{id:"<>",value:i("Not equal to")},{id:">",value:i("Greater than")},{id:"<",value:i("Less than")},{id:">=",value:i("Greater than or Equal to")},{id:"<=",value:i("Less than or Equal to")}],on:{onChange:t=>{switch(t){case"none":$$(e.validateRange).hide(),$$(e.validateStartDateContainer).hide(),$$(e.validateEndDateContainer).hide();break;case"dateRange":$$(e.validateRange).show(),$$(e.validateStartDateContainer).hide(),$$(e.validateEndDateContainer).hide();break;case"between":case"notBetween":$$(e.validateRange).hide(),$$(e.validateStartDateContainerLabel).define("label",i("Start Date:")),$$(e.validateStartDateContainerLabel).refresh(),$$(e.validateStartDateContainer).show(),$$(e.validateEndDateContainer).show();break;case"=":case"<>":case">":case"<":case">=":case"<=":$$(e.validateRange).hide(),$$(e.validateStartDateContainerLabel).define("label",i("Date:")),$$(e.validateStartDateContainerLabel).refresh(),$$(e.validateStartDateContainer).show(),$$(e.validateEndDateContainer).hide()}},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:e.validateRange,hidden:!0,rows:[{cols:[{view:"label",label:i("Unit:"),align:"right",width:88},{id:e.validateRangeUnit,view:"select",name:"validateRangeUnit",options:[{id:"days",value:i("Days")},{id:"months",value:i("Months")},{id:"years",value:i("Years")}],on:{onChange:()=>{$$(e.validateRangeBeforeLabel).refresh(),$$(e.validateRangeAfterLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{id:e.validateRangeBeforeLabel,view:"template",align:"left",width:140,borderless:!0,template:()=>{let t=$$(e.validateRangeUnit).getValue(),n=$$(e.validateRangeUnit).config.options.filter((e=>e.id==t))[0];return`${i("Before")} ${$$(e.validateRangeBefore).getValue()} ${n.value}`}},{view:"label",label:"",align:"center",width:1},{id:e.validateRangeAfterLabel,view:"template",align:"right",borderless:!0,template:()=>{let t=$$(e.validateRangeUnit).getValue(),n=$$(e.validateRangeUnit).config.options.filter((e=>e.id==t))[0];return`${i("After")} ${$$(e.validateRangeAfter).getValue()} ${n.value}`}}]},{cols:[{id:e.validateRangeBefore,view:"slider",name:"validateRangeBefore",on:{onChange:()=>{$$(e.validateRangeBeforeLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:e.validateRangeAfter,view:"slider",name:"validateRangeAfter",on:{onChange:()=>{$$(e.validateRangeAfterLabel).refresh()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]}]},{id:e.validateStartDateContainer,hidden:!0,cols:[{id:e.validateStartDateContainerLabel,view:"label",label:i("Start Date:"),align:"right",width:88},{name:"validateStartDate",view:"datepicker",om:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:e.validateEndDateContainer,hidden:!0,cols:[{view:"label",label:i("End Date:"),align:"right",width:88},{name:"validateEndDate",view:"datepicker",on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{view:"label",label:i("Time:"),align:"left"},{cols:[{view:"label",label:i("Format:"),align:"right",width:88},{view:"richselect",name:"timeFormat",id:e.timeFormat,value:2,options:[{id:2,value:i("HH:MM AM/PM")},{id:3,value:i("HH:MM (military)")}],on:{onChange:()=>{this.refreshTimevalue()},onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Default Time:"),align:"right",width:88},{view:"richselect",name:"defaultTime",id:e.defaultTime,labelWidth:110,value:1,options:[{id:1,value:i("None")},{id:2,value:i("Current Time")},{id:3,value:i("Specific Time")}],on:{onChange:()=>{this.defaultTimeChange()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"datepicker",name:"defaultTimeValue",type:"time",id:e.defaultTimeValue,gravity:.5,disabled:!0,onAfterRender:function(){t.CYPRESS_REF(this)}}]}])}defaultDateChange(){const e=this.ids,t=$$(e.defaultDate).getValue();switch(parseInt(t)){case 1:$$(e.defaultDateValue).disable(),$$(e.defaultDateValue).setValue();break;case 2:$$(e.defaultDateValue).enable(),$$(e.defaultDateValue).setValue(new Date),this.refreshDateValue();break;case 3:$$(e.defaultDateValue).enable(),$$(e.defaultDateValue).setValue();break;default:$$(e.defaultDateValue).disable(),$$(e.defaultDateValue).setValue(new Date)}}refreshDateValue(){const e=this.ids,t=$$(e.dateFormat).getValue();let i="";switch(parseInt(t)){case 2:default:i="%d/%m/%Y";break;case 3:i="%m/%d/%Y";break;case 4:i="%M %d, %Y";break;case 5:i="%d %M, %Y"}$$(e.defaultDateValue).define("format",i),$$(e.defaultDateValue).refresh()}defaultTimeChange(){const e=this.ids;switch(parseInt($$(e.defaultTime).getValue())){case 1:default:$$(e.defaultTimeValue).disable(),$$(e.defaultTimeValue).setValue();break;case 2:$$(e.defaultTimeValue).enable(),$$(e.defaultTimeValue).setValue(new Date);break;case 3:$$(e.defaultTimeValue).enable(),$$(e.defaultTimeValue).setValue()}this.refreshTimevalue()}refreshTimevalue(){const e=this.ids;let t="";switch(parseInt($$(e.timeFormat).getValue())){case 2:default:t="%h:%i %A";break;case 3:t="%H:%i"}$$(e.defaultTimeValue).define("format",t),$$(e.defaultTimeValue).refresh()}FieldClass(){return super._FieldClass("datetime")}populate(e){const t=this.ids;super.populate(e),$$(t.defaultDateValue).setValue(new Date(e.settings.defaultDateValue)),$$(t.defaultTimeValue).setValue(new Date(e.settings.defaultTimeValue))}show(){this.refreshDateValue(),this.refreshTimevalue(),super.show()}}}},6393:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_email`,{default:"",defaultCheckbox:""})}ui(){const i=this.ids;return super.ui([{cols:[{view:"label",label:o("Default Value:"),align:"right",width:100},{id:i.defaultCheckbox,view:"checkbox",width:30,value:0,on:{onChange:e=>{this.checkboxDefaultValue(e)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}},{view:"text",id:i.default,name:"default",placeholder:o("Enter default value"),disabled:!0,labelWidth:t.labelWidthXLarge,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}])}checkboxDefaultValue(e){0===e?($$(this.ids.default).disable(),$$(this.ids.default).setValue("")):$$(this.ids.default).enable()}FieldClass(){return super._FieldClass("email")}isValid(){const e=this.ids;let t=super.isValid();$$(e.component).clearValidation();const i=$$(e.required).getValue(),n=$$(e.default).getValue();return i||n?webix.rules.isEmail(n)?t=!0:($$(e.component).markInvalid("default",o("This email is invalid")),t=!1):t=!0,t}populate(e){const t=this.ids;super.populate(e),""===e.settings.default?$$(t.defaultCheckbox).setValue(0):$$(t.defaultCheckbox).setValue(1)}}}},727:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_file`,{fileSize:"",fileType:""})}ui(){const e=this.ids;return super.ui([{cols:[{view:"label",label:i("Size (MB):"),align:"right",width:75},{view:"checkbox",name:"limitFileSize",value:1,width:30,click:function(){this.getValue()?$$(e.fileSize).enable():$$(e.fileSize).disable()},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"counter",name:"fileSize",id:e.fileSize,width:104,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Type:"),align:"right",width:75},{view:"checkbox",name:"limitFileType",width:30,labelWidth:0,value:1,click:function(){this.getValue()?$$(e.fileType).enable():$$(e.fileType).disable()},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:e.fileType,view:"text",name:"fileType",placeholder:i("txt,rtf,doc,docx,..."),on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]}])}FieldClass(){return super._FieldClass("file")}clear(){const e=this.ids;super.clear(),$$(e.fileSize).setValue(0),$$(e.fileType).setValue("")}}}},6139:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_formula`,{field:"",fieldList:"",rowFilterContainer:""})}ui(){this.FieldClass();const n=this.ids;return this.rowFilter=e.filterComplexNew(n.component,{isSaveHidden:!0}),super.ui([{cols:[{view:"label",label:o("Type:"),align:"right",width:40},{view:"richselect",name:"type",labelWidth:t.labelWidthMedium,value:"sum",options:[{id:"sum",value:o("Sum")},{id:"max",value:o("Max")},{id:"min",value:o("Min")},{id:"average",value:o("Average")},{id:"count",value:o("Count")}],on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:o("Field:"),align:"right",width:40},{id:n.field,view:"richselect",name:"field",labelWidth:t.labelWidthMedium,options:{view:"suggest",body:{id:n.fieldList,view:"list",template:this.itemTemplate,data:[]}},on:{onChange:()=>{this.refreshFilter()},onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{id:n.rowFilterContainer,height:200,rows:[{fillspace:!0,height:10},this.rowFilter.ui]}])}getFieldList(){const e=[];return this.CurrentObject.connectFields().forEach((t=>{t.datasourceLink.fields().forEach((i=>{"number"==i.key&&e.push({id:`${t.id}:${i.id}`,field:t,fieldLink:i})}))})),e}itemTemplate(e){return`[${e.field.label}] ${e.fieldLink.object.label} -> <i class="fa fa-${e.fieldLink.icon}" aria-hidden="true"></i><b>${e.fieldLink.label}</b>`}getSelectedField(){const e=this.ids,t=$$(e.field).getValue();return $$(e.field).getList().data.find({id:t})[0]}refreshFilter(){const e=$$(this.ids.rowFilterContainer),t=this.getSelectedField();t?.fieldLink?.object?(this.rowFilter.fieldsLoad(t.fieldLink.object.fields()),e.show()):(this.rowFilter.fieldsLoad([]),e.hide())}FieldClass(){return super._FieldClass("formula")}populate(e){const t=this.ids;if(super.populate(e),e.settings.field){const i=`${e.settings.field}:${e.settings.fieldLink}`;$$(t.field).setValue(i||"")}else $$(t.field).setValue("");this.refreshFilter(),this.rowFilter.setValue(e.settings.where||{})}show(){const e=this.ids,t=this.getFieldList();$$(e.fieldList).clearAll(),$$(e.fieldList).parse(t),super.show(),this.refreshFilter()}values(){const e=this.ids,t=$$(e.component).getValues(),i=this.getSelectedField();return i?(t.field=i.field.id,t.fieldLink=i.fieldLink.id,t.object=i.fieldLink.object.id):(t.field="",t.fieldLink="",t.object=""),t.where=this.rowFilter.getValue(),$$(e.component).setValues(t),super.values()}}}},7380:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e="properties_abfield"){super(`${e}_image`,{imageWidth:"",imageHeight:"",imageContainer:"",defaultImageUrl:"",useWidth:"",useHeight:"",useDefaultImage:""})}ui(){const n=this.ids;return super.ui([{cols:[{view:"label",label:i("Width:"),align:"right",width:60},{id:n.useWidth,view:"checkbox",name:"useWidth",width:30,value:1,click:function(){this.getValue()?$$(n.imageWidth).enable():$$(n.imageWidth).disable()},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:n.imageWidth,view:"text",name:"imageWidth",on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Height:"),align:"right",width:60},{id:n.useHeight,view:"checkbox",name:"useHeight",width:30,value:1,click:function(){this.getValue()?$$(n.imageHeight).enable():$$(n.imageHeight).disable()},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"text",name:"imageHeight",id:n.imageHeight,on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:i("Default image:"),align:"right",width:100},{id:n.useDefaultImage,view:"checkbox",name:"useDefaultImage",value:0,click:function(){this.getValue()?$$(n.imageContainer).enable():$$(n.imageContainer).disable()},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:n.imageContainer,disabled:!0,cols:[{},{view:"uploader",id:n.defaultImageUrl,template:`<div style="text-align:center; font-size: 30px;">\n                           <div class="default-image-holder">\n                              <div class="image-data-field-icon">\n                                 <i class="fa fa-picture-o fa-2x"></i>\n                                 <div style="font-size: 15px;">${i("Drag and drop or click here")}</div>\n                              </div>\n                              <div class="image-data-field-image" style="display:none;">\n                                 <a style="" class="ab-delete-photo" href="javascript:void(0);"><i class="fa fa-times delete-image" style="display:none;"></i></a>\n                              </div>\n                           </div>\n                        </div>`,apiOnly:!0,inputName:"file",multiple:!1,name:"defaultImageUrl",height:105,width:150,on:{onBeforeFileAdd:function(e){const t=["jpg","jpeg","bmp","png","gif"],n=e.type.toLowerCase();if(-1==t.indexOf(n))return webix.message(i("Only [{0}] images are supported",[t.join(", ")])),!1},onFileUploadError:function(t,i){e.notify.developer(new Error("Error loading image"),{message:"Error loading image",response:i})},onAfterRender:function(){t.CYPRESS_REF(this)}}},{}]}])}urlImage(e){return`/file/${e}`}urlUpload(e=!0){return`/file/upload/${this.CurrentObjectID}/${this.CurrentFieldID}/${e?"1":"0"}`}FieldClass(){return super._FieldClass("image")}populate(e){const t=this.ids,i=$$(t.defaultImageUrl),n=e.settings.defaultImageUrl,o=e.settings.useDefaultImage;super.populate(e),e.settings.useDefaultImage&&$$(t.imageContainer).enable(),n&&o&&(i.attachEvent("onAfterRender",(()=>{const e=i.$view.querySelector(".default-image-holder");e.querySelector(".image-data-field-icon").style.display="none";const t=e.querySelector(".image-data-field-image");t.style.display="",t.style.backgroundImage=`url('${this.urlImage(n)}')`,t.setAttribute("image-uuid",n),e.querySelector(".delete-image").style.display="table-cell"})),i.$view.addEventListener("click",(e=>{if(e.target.className.indexOf("delete-image")>-1){const e=i.$view.querySelector(".default-image-holder");e.querySelector(".image-data-field-icon").style.display="";const t=e.querySelector(".image-data-field-image");t.style.display="none",t.style.backgroundImage="",t.setAttribute("image-uuid",""),e.querySelector(".delete-image").style.display="none"}})))}show(){const e=this.ids,t=this.urlUpload(!0),i=$$(e.defaultImageUrl);i.config.upload=t,i.attachEvent("onFileUpload",((t,n)=>{$$(e.defaultImageUrl).setValue(n.data.uuid);const o=i.$view.querySelector(".default-image-holder");o.querySelector(".image-data-field-icon").style.display="none";const a=o.querySelector(".image-data-field-image");a.style.display="",a.style.backgroundImage=`url('${this.urlImage(n.data.uuid)}')`,a.setAttribute("image-uuid",n.data.uuid),o.querySelector(".delete-image").style.display="table-cell"})),i.attachEvent("onAfterRender",(()=>{const e=i.$view.querySelector(".default-image-holder");e.querySelector(".image-data-field-icon").style.display="";const t=e.querySelector(".image-data-field-image");t.style.display="none",t.style.backgroundImage="",t.setAttribute("image-uuid",""),e.querySelector(".delete-image").style.display="none"})),i.addDropZone(i.$view),i.render(),super.show()}clear(){const e=this.ids;super.clear(),$$(e.useWidth).setValue(0),$$(e.useHeight).setValue(0),$$(e.useDefaultImage).setValue(0),$$(e.imageWidth).setValue(""),$$(e.imageHeight).setValue(""),$$(e.defaultImageUrl).setValue("")}}}},7341:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(e="properties_abfield"){super(`${e}_json`,{})}ui(){return super.ui([])}FieldClass(){return super._FieldClass("json")}}}},4074:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Class.ABFieldManager.fieldByKey("selectivity");return class extends t{constructor(e="properties_abfield"){super(`${e}_list`,{isMultiple:"",hasColors:"",default:"",multipleDefault:"",options:"",colorboard:""}),this.colors=[["#F44336","#E91E63","#9C27B0","#673AB7"],["#3F51B5","#2196F3","#03A9F4","#00BCD4"],["#009688","#4CAF50","#8BC34A","#CDDC39"],["#FFEB3B","#FFC107","#FF9800","#FF5722"],["#795548","#9E9E9E","#607D8B","#000000"]],this._originalOptions=[]}ui(){const e=this.ids;return super.ui([{view:"checkbox",name:"isMultiple",disallowEdit:!0,id:e.isMultiple,labelRight:i("Multiselect"),labelWidth:0,value:!1,on:{onChange:t=>{1==t?($$(e.default).hide(),$$(e.multipleDefault).show()):($$(e.default).show(),$$(e.multipleDefault).hide()),this.updateDefaultList()},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"checkbox",name:"hasColors",id:e.hasColors,labelRight:i("Customize Colors"),labelWidth:0,value:!1,on:{onChange:(e,t)=>{if(e==t)return!1;this.toggleColorControl(e)},onAfterRender:function(){t.CYPRESS_REF(this)}}},{view:"label",label:`<b>${i("Options")}</b>: `},{id:e.options,name:"options",css:"padList",view:this.AB._App.custom.editlist.view,template:"<div style='position: relative;'><i class='ab-color-picker fa fa-lg fa-chevron-circle-down' style='color:#hex#'></i> #value#<i class='ab-new-field-remove fa fa-remove' style='position: absolute; top: 7px; right: 7px;'></i></div>",autoheight:!0,drag:!0,editable:!0,hex:"",editor:"text",editValue:"value",onClick:{"ab-new-field-remove":(t,n)=>((this._originalOptions||[]).filter((e=>e.id==n))[0]?webix.confirm({title:i("Delete Option"),text:i("All exisiting entries with this value will be cleared. Are you sure you want to delete this option?"),type:"confirm-warning"}).then((()=>{this._CurrentField.pendingDeletions=this._CurrentField.pendingDeletions||[],this._CurrentField.pendingDeletions.push(n),$$(e.options).remove(n)})):$$(e.options).remove(n),!1),"ab-color-picker":(t,i,n)=>(webix.ui({id:e.colorboard,view:"popup",body:{view:"colorboard",type:"classic",id:"color",width:125,height:150,palette:this.colors,left:125,top:150,on:{onSelect:t=>{const n=$$(e.options).getItem(i);n.hex=t,$$(e.options).updateItem(i,n),$$(e.colorboard).hide()}}}}).show(n,{x:-7}),!1)},on:{onAfterAdd:()=>{this.updateDefaultList()},onAfterEditStop:()=>{this.updateDefaultList()},onAfterDelete:()=>{this.updateDefaultList()},onAfterRender:()=>{this.toggleColorControl($$(e.hasColors).getValue())}}},{view:"button",css:"webix_primary",value:i("Add new option"),click:()=>{let t=webix.uid(),i=this.getNextHex(),n=$$(e.options);n&&(n.add({id:t,value:"",hex:i,isNew:!0},n.count()),n.exists(t)&&n.edit(t))},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{cols:[{view:"label",label:i("Default:"),width:55},{id:e.default,placeholder:i("Select Default"),name:"default",view:"richselect",on:{onAfterRender:function(){t.CYPRESS_REF(this)}}}]},{id:e.multipleDefault,name:"multipleDefault",view:"forminput",labelWidth:0,height:44,borderless:!0,hidden:!0,body:{view:this.AB._App.custom.focusabletemplate.view,css:"customFieldCls",borderless:!0,template:`<label style="width: 80px;text-align: left;line-height:32px;" class="webix_inp_label">${i("Default")}</label><div style="margin-left: 80px; height: 36px;" class="list-data-values form-entry"></div>`}}])}clear(){const e=this.ids;$$(e.isMultiple).setValue(0),$$(e.hasColors).setValue(0),$$(e.options).clearAll(),$$(e.default).define("options",[]),$$(e.default).setValue(this.FieldClass()?.defaultValues()?.default);const t=$$(e.multipleDefault).$view.querySelector(".list-data-values");t&&t.selectivity&&t.selectivity.setData([])}FieldClass(){return super._FieldClass("list")}getNextHex(){const e=[];$$(this.ids.options)?.data.each((function(t){e.push(t.hex)}));const t=[];this.colors.forEach((e=>{e?.forEach?.((e=>{t.push(e)}))}));let i="#3498db";for(let n=0;n<t.length;n++)if(-1==e.indexOf(t[n])){i=t[n];break}return i}populate(e){super.populate(e),this._originalOptions=e?.settings?.options??[];let t=[];this._CurrentField=e,this._CurrentField&&(this._CurrentField.pendingDeletions=[],t=(e?.settings.options||[]).map((e=>({id:e.id,value:e.text,hex:e.hex,translations:e.translations}))));const i=$$(this.ids.options);i.parse(t),i.refresh(),setTimeout((()=>{this.updateDefaultList()}),10)}toggleColorControl(e){const t=$$(this.ids.options)?.$view.querySelectorAll(".ab-color-picker");t?.forEach((function(t){1==e?t.classList.remove("hide"):t.classList.add("hide")}))}updateDefaultList(){const e=this.ids,t=this._CurrentField?.settings,n=$$(e.options).find({}).map((function(e){return{id:e.id,value:e.value,hex:e.hex}}));if($$(e.isMultiple).getValue()){const a=$$(e.multipleDefault).$view.querySelector(".list-data-values");if(!a)return!1;const s=this.values();new o(s,this).selectivityRender(a,{multiple:!0,data:t?.multipleDefault??[],placeholder:i("Select items"),items:n.map((function(e){return{id:e.id,text:e.value,hex:e.hex}}))}),a.addEventListener("change",(function(t){t.value.length?$$(e.multipleDefault).define("required",!1):$$(e.multipleDefault).$view.querySelector(".webix_inp_label").classList.contains("webix_required")&&$$(e.multipleDefault).define("required",!0)}))}else $$(e.default).define("options",n),t?.default&&$$(e.default).setValue(t.default),$$(e.default).refresh()}values(){const e=super.values(),t=this.ids;e.settings.options=[],$$(t.options).data.each((t=>{let i=t.id;t.isNew&&t.value&&!e.settings.options.filter((e=>e.id==t.value)).length&&(i=t.value),e.settings.options.push({id:i,text:t.value,hex:t.hex,translations:t.translations})})),e.settings.options.forEach((e=>{this.AB.Multilingual.unTranslate(e,e,["text"])})),e.settings.multipleDefault=[];const i=$$(t.multipleDefault).$view.querySelector(".list-data-values");return i&&i.selectivity&&(e.settings.multipleDefault=i.selectivity.getData()||[]),e}}}},3820:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_longtext`,{default:"",defaultCheckbox:""})}ui(){const e=this.ids;return super.ui([{view:"layout",cols:[{view:"label",label:o("Default Value:"),align:"right",width:100},{id:e.defaultCheckbox,view:"checkbox",width:30,value:0,on:{onChange:e=>{this.checkboxDefaultValue(e)},onAfterRender:function(){i.CYPRESS_REF(this)}}},{id:e.default,view:"text",name:"default",placeholder:o("Enter default value"),disabled:!0,labelWidth:t.labelWidthXLarge,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{view:"checkbox",name:"supportMultilingual",disallowEdit:!0,labelRight:o("Support multilingual"),labelWidth:t.labelWidthCheckbox,value:!1,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}])}FieldClass(){return super._FieldClass("LongText")}populate(e){super.populate(e);const t=""===e.settings.default?0:1;$$(this.ids.defaultCheckbox).setValue(t)}show(){super.show(),$$(this.ids.defaultCheckbox).setValue(0)}checkboxDefaultValue(e){0==e?($$(this.ids.default).disable(),$$(this.ids.default).setValue("")):$$(this.ids.default).enable()}}}},6771:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_number`,{default:"",decimalOptions:"",typeDecimalPlaces:"",typeRounding:"",validation:"",validateMinimum:"",validateMaximum:"",defaultCheckbox:"",validateView:"",typeDecimals:"",typeFormat:"",typeThousands:""})}ui(){const i=this.FieldClass(),n=this.ids;return super.ui([{cols:[{view:"label",label:o("Default Value:"),align:"right",width:100},{id:n.defaultCheckbox,view:"checkbox",width:30,value:0,on:{onChange:e=>{this.checkboxDefaultValue(e)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}},{id:n.default,view:"text",name:"default",placeholder:o("Enter default value"),disabled:!0,labelWidth:t.labelWidthXLarge,on:{onChange:(e,t)=>{this.numValidation(e,t,n.default)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:o("Format:"),align:"right",width:100},{id:n.typeFormat,view:"richselect",name:"typeFormat",value:"none",labelWidth:t.labelWidthXLarge,options:i.formatList(o),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:o("Decimals:"),align:"right",width:100},{id:n.typeDecimals,view:"segmented",name:"typeDecimals",disallowEdit:!0,labelWidth:t.labelWidthXLarge,value:"none",options:i.delimiterList(),on:{onChange:e=>{this.segmentedDecimals(e)},onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},{id:n.decimalOptions,hidden:!0,disabled:!0,rows:[{cols:[{width:20},{view:"label",label:o("Places:"),align:"right",width:100},{id:n.typeDecimalPlaces,view:"counter",disallowEdit:!0,name:"typeDecimalPlaces",width:102,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}},{width:20},{view:"label",label:o("Rounding:"),align:"right",width:100},{id:n.typeRounding,view:"richselect",name:"typeRounding",value:"none",vertical:!0,options:[{id:"none",value:o("Default")},{id:"roundUp",value:o("Round Up")},{id:"roundDown",value:o("Round Down")}],on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}]},{cols:[{view:"label",label:o("Thousands:"),align:"right",width:100},{id:n.typeThousands,view:"segmented",name:"typeThousands",value:"none",options:i.delimiterList(),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},{cols:[{view:"label",label:o("Validation:"),align:"right",width:100},{view:"switch",id:n.validation,name:"validation",value:0,width:55,on:{onChange:e=>{this.switchValidation(e)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}}]},{id:n.validateView,hidden:!0,disabld:!0,rows:[{cols:[{width:20},{view:"label",label:o("Minimum:"),align:"right",width:100},{view:"text",id:n.validateMinimum,name:"validateMinimum",placeholder:o("Minimum Number"),on:{onChange:(e,t)=>{this.numValidation(e,t,n.validateMinimum)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}}]},{cols:[{width:20},{view:"label",label:o("Maximum:"),align:"right",width:100},{view:"text",id:n.validateMaximum,name:"validateMaximum",placeholder:o("Maximum Number"),on:{onChange:(e,t)=>{this.numValidation(e,t,n.validateMaximum)},onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}]}])}numValidation(e,t,i){new RegExp("^[0-9.]*$").test(e)||$$(i).setValue(t||"")}checkboxDefaultValue(e){0==e?($$(this.ids.default).disable(),$$(this.ids.default).setValue("")):$$(this.ids.default).enable()}segmentedDecimals(e){"none"==e?($$(this.ids.decimalOptions).disable(),$$(this.ids.decimalOptions).hide()):($$(this.ids.decimalOptions).enable(),$$(this.ids.decimalOptions).show())}switchValidation(e){e?($$(this.ids.validateView).enable(),$$(this.ids.validateView).show()):($$(this.ids.validateView).disable(),$$(this.ids.validateView).hide())}FieldClass(){return super._FieldClass("number")}isValid(){let e=super.isValid();const t=this.formValues(),i=t.default;let n=0;if(""!==i&&(n=parseFloat(i)),t.required&&""===i&&(this.markInvalid("default",o("If a field is required, you must set a default value.")),e=!1),t.validation){const a=t.validateMinimum,s=t.validateMaximum;let r=0,l=0;""!==a&&(r=parseFloat(a)),""!==s&&(l=parseFloat(s)),""!==i&&(""!==a&&n<r&&(this.markInvalid("default",o("default value must be within any min / max value setting")),e=!1),""!==s&&n>l&&(this.markInvalid("default",o("default value must be within any min / max value setting")),e=!1)),""!=a&&""!=s&&r>l&&(this.markInvalid("validateMinimum",o("minimum value must be <= maximum value")),this.markInvalid("validateMaximum",o("maximum value must be >= minimum value")),e=!1)}return e}populate(e){const t=this.ids;super.populate(e),""===e.settings.default?$$(t.defaultCheckbox).setValue(0):$$(t.defaultCheckbox).setValue(1),0===e.settings.validation?$$(t.validateView).hide():$$(t.validateView).show(),"none"===e.settings.typeDecimals?($$(t.decimalOptions).hide(),$$(t.decimalOptions).disable()):($$(t.decimalOptions).enable(),$$(t.decimalOptions).show(),$$(t.typeDecimalPlaces).enable(),$$(t.typeDecimalPlaces).show(),$$(t.typeRounding).enable(),$$(t.typeRounding).show())}}}},401:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_string`,{default:"",supportMultilingual:"",defaultCheckbox:""})}ui(){const i=this.ids;return super.ui([{cols:[{view:"label",label:o("Default Value:"),align:"right",width:100},{id:i.defaultCheckbox,view:"checkbox",width:30,value:0,on:{onChange:e=>{this.checkboxDefaultValue(e)},onAfterRender:()=>{e.ClassUI.CYPRESS_REF(this)}}},{view:"text",id:i.default,name:"default",placeholder:o("Enter default value"),disabled:!0,labelWidth:t.labelWidthXLarge,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},{view:"checkbox",id:i.supportMultilingual,name:"supportMultilingual",disallowEdit:!0,labelRight:o("Support multilingual"),labelWidth:t.labelWidthCheckbox,value:!1,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}])}checkboxDefaultValue(e){0===e?($$(this.ids.default).disable(),$$(this.ids.default).setValue("")):$$(this.ids.default).enable()}FieldClass(){return super._FieldClass("string")}populate(e){const t=this.ids;super.populate(e),""===e.settings.default?$$(t.defaultCheckbox).setValue(0):$$(t.defaultCheckbox).setValue(1)}}}},8546:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_textformula`,{textFormula:"",formulaSuggest:""})}ui(){const e=this.ids;return super.ui([{view:"layout",cols:[{id:e.textFormula,view:"textarea",name:"textFormula",editor:"text",labelWidth:t.labelWidthLarge,placeholder:o("Text Formula"),on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"spacer",width:15},{view:"layout",rows:[{view:"spacer",height:5},{id:e.formulaSuggest,name:"formulaSuggest",view:"dataview",xCount:1,select:!0,type:{height:30,width:246},template:"#value#",on:{onItemClick:t=>{const i=$$(e.formulaSuggest).getItem(t),n="field"==i.type?"{"+i.value+"}":i.value;$$(e.textFormula).setValue($$(e.textFormula).getValue()+n),$$(e.formulaSuggest).unselect()},onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"spacer",height:5}]}]}])}FieldClass(){return super._FieldClass("TextFormula")}show(){super.show(),this.loadSuggestions()}populate(e){super.populate(e),this.loadSuggestions()}loadSuggestions(){const e=this.ids,t=this.FieldClass(),i=this.CurrentObject.fields().filter((e=>"formula"!=e.key&&"TextFormula"!=e.key&&!e.isConnection)).map((e=>({id:e.id,value:e.columnName,type:"field"}))).concat(t.getBuildInFunction());$$(e.formulaSuggest).clearAll(),$$(e.formulaSuggest).parse(i)}}}},1702:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(e="properties_abfield"){super(`${e}_tree`,{options:"",popup:"",tree:""})}ui(){const e=this.ids;return super.ui([{view:"button",type:"icon",icon:"fa fa-plus",height:30,click:()=>{const t=webix.uid().toString();$$(e.options).data.add({id:t,text:""}),$$(e.options).openAll(),$$(e.options).config.height=28*$$(e.options).count()+18,$$(e.options).resize(),$$(e.options).edit(t)},on:{onAfterRender:function(){t.CYPRESS_REF(this)}}},{id:e.options,name:"options",css:{background:"transparent"},view:this.AB.custom.edittree.view,template:"<div style='position: relative;'><i class='ab-new-field-add fa fa-plus' style='position: relative; right: 0px;'></i> #text#<i class='ab-new-field-remove fa fa-remove' style='position: absolute; top: 7px; right: 7px;'></i></div>",autoheight:!0,drag:!0,editor:"text",editable:!0,editValue:"text",onClick:{"ab-new-field-remove":(t,i)=>($$(e.options).remove(i),$$(e.options).config.height=0,$$(e.options).config.height=28*$$(e.options).count()+18,!1),"ab-new-field-add":(t,i)=>{const n=webix.uid().toString(),o=i.toString();return $$(e.options).data.add({id:n,text:""},null,o),$$(e.options).openAll(),$$(e.options).config.height=28*$$(e.options).count()+18,$$(e.options).resize(),$$(e.options).edit(n),!1}}}])}FieldClass(){return super._FieldClass("tree")}clear(){const e=this.ids;$$(e.options).clearAll(),$$(e.options).config.height=0,$$(e.options).resize(),$$(e.options).refresh()}values(){const e=super.values();return e.settings.options=$$(this.ids.options).serialize(),e}populate(e){const t=this.ids;$$(t.options).clearAll(),$$(t.options).parse(e.settings.options),$$(t.options).openAll(),$$(t.options).config.height=28*$$(t.options).count()+18,$$(t.options).resize(),$$(t.options).refresh()}}}},8114:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(917);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(e="properties_abfield"){super(`${e}_user`,{editable:"",isMultiple:"",isCurrentUser:"",isShowProfileImage:"",isShowUsername:""})}ui(){const e=this.ids;return super.ui([{view:"checkbox",name:"isMultiple",id:e.isMultiple,disallowEdit:!0,labelRight:o("Allow multiple users"),labelWidth:t.labelWidthCheckbox,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{cols:[{view:"checkbox",name:"isCurrentUser",id:e.isCurrentUser,labelRight:o("Default value as current user"),labelWidth:t.labelWidthCheckbox,on:{onChange:function(t){0==t?($$(e.editable).setValue(0),$$(e.editable).hide()):($$(e.editable).setValue(1),$$(e.editable).show())},onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"checkbox",name:"editable",hidden:!0,id:e.editable,labelRight:o("Editable"),labelWidth:t.labelWidthCheckbox,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}]},{view:"checkbox",name:"isShowProfileImage",id:e.isShowProfileImage,labelRight:o("Show Profile Image"),labelWidth:t.labelWidthCheckbox,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}},{view:"checkbox",name:"isShowUsername",id:e.isShowUsername,labelRight:o("Show Username"),labelWidth:t.labelWidthCheckbox,on:{onAfterRender:function(){i.CYPRESS_REF(this)}}}])}FieldClass(){return super._FieldClass("user")}}}},2607:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_end",{name:""})}static get key(){return"End"}ui(){let e=this.ids;return{id:e.component,rows:[{view:"label",label:i("Terminate End Event")},{view:"label",label:i("Stops the flow of the process.")},{view:"form",elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""}]}]}}async init(e){return this.AB=e,Promise.resolve()}populate(e){let t=this.ids;$$(t.name).setValue(e.name)}values(){const e={},t=this.ids;return e.label=$$(t.name)?.getValue(),e}}}},5732:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_gateway_exclusive",{name:"",buttonFilter:""})}static get key(){return"GatewayExclusive"}ui(){let e=this.ids;return{id:e.component,view:"form",elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name"}]}}async init(e){return this.AB=e,Promise.resolve()}populate(e){let t=this.ids,n=this.ui();this._element=e;const o=(e.process.processDataFields(e)||[]).map((e=>e.field)).filter((e=>e)),a=e.process.connectionsOutgoing(e.diagramID);this.__dfLookup={},this.conditions=e.conditions||this.conditions||{},a.forEach((o=>{const a=this.conditions[o.id]||{},s=e.process.elementForDiagramID(o.to);let r;this.__dfLookup[o.id]||(r=this.AB.filterComplexNew(`${t.component}_${o.id}_filter`),r.myPopup=webix.ui({view:"popup",height:240,width:480,hidden:!0,body:r.ui}),r.init(),r.on("save",(()=>{const e=r.getValue(),i=$$(`${t.buttonFilter}_${o.id}`);i.define("badge",e.rules?.length||null),i.refresh()})),this.__dfLookup[o.id]=r),r=this.__dfLookup[o.id];const l={view:"fieldset",label:i("to {0}",[s?s.name:i("unlabeled Task({0})",[o.id])]),body:{rows:[{id:`${t.component}_${o.id}_label`,view:"text",label:i("Label"),value:a.label||""},{id:`${t.buttonFilter}_${o.id}`,css:"webix_primary",view:"button",label:i("Add Filter"),icon:"fa fa-gear",type:"icon",badge:a.filterValue?.rules?.length||null,click:function(){r.popUp(this.$view,null,{pos:"top"})}}]}};n.elements.push(l)})),webix.ui(n,$$(t.component)),$$(t.component).show(),a.forEach((e=>{const t=this.conditions[e.id]||{},i=this.__dfLookup[e.id];i.fieldsLoad(o),t.filterValue&&i.setValue(t.filterValue),i.init()})),$$(t.name).setValue(e.name)}values(){let e={};const t=this.ids;return e.label=$$(t.name)?.getValue(),e.name=e.label,e.conditions={},this._element.process.connectionsOutgoing(this._element.diagramID).forEach((i=>{if(e.conditions[i.id]={},e.conditions[i.id].label=$$(`${t.component}_${i.id}_label`).getValue(),this.__dfLookup&&this.__dfLookup[i.id]){const t=this.__dfLookup[i.id];e.conditions[i.id].filterValue=t.getValue()}})),e}}}},7670:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=i(5178);function a(e){const t=(0,n.Z)(e),i=t.L(),a=e.Config.uiSettings(),s=(0,o.Z)(e);return class extends t{constructor(){super("properties_process_participant",{name:"",users:""}),this.users=new s(this.ids.component+"_users_")}static get key(){return"process.participant"}uiUser(e){const t=this.users.ui(e??{});return{id:this.ids.users,rows:[t],paddingY:10}}ui(e){let t=this.ids,n={id:t.component,rows:[{view:"label",label:i("Process Participant:")},{view:"label",label:i("This element defines a group of users that are responsible for the tasks contained within.")},{view:"form",id:t.form,elements:[{id:t.name,view:"text",label:i("Name"),labelWidth:a.labelWidthLarge,name:"name",value:this.name}]}]},o={id:t.users};return e?.laneIDs&&0==e?.laneIDs.length&&(o=this.uiUser(e??{})),n.rows[2].elements.push(o),n}async init(e){return this.AB=e,Promise.resolve()}populate(e){let t=this.ids;if($$(t.name).setValue(e.name),e.laneIDs&&0==e.laneIDs.length){const i=this.uiUser(e??{});webix.ui(i,$$(t.users))}}values(){const e={},t=this.ids;e.label=$$(t.name).getValue();const i=this.users.values();return Object.keys(i).forEach((t=>{e[t]=i[t]})),e}}}},5178:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285),o=i(8788);function a(e){const t=(0,n.Z)(e),i=(0,o.Z)(e);var a=t.L();return class extends i{constructor(t){super(t,{useField:"",fields:"",userField:"",buttonFilter:""}),this.AB=e,this.filterComponent=this.AB.filterComplexNew(`${this.ids.component}_filter`,e),this.filterComponent.init({isProcessParticipant:!0}),this.filterComponent.on("save",(e=>{this.populateBadgeNumber(e)}))}ui(e={}){const i=e??{},n=super.ui(i),o=i.filterConditions||{glue:"and",rules:[]},s=e.process?.processDataFields(e).map((e=>e.field))||[];this.filterComponent.fieldsLoad(s),this.filterComponent.setValue(o);const r=i.userProcessFieldData?.map((e=>({uuid:e.field.id,id:e.key,value:e.label,key:e.key})))||[],l=this.ids,c=[{},{cols:[{view:"checkbox",id:this.ids.useField,width:34,labelWidth:0,value:"1"==i.useField?1:0,click:function(e){$$(e).getValue()?$$(l.userField).enable():$$(l.userField).disable()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"label",label:a("by Field"),width:88},{view:"multicombo",id:this.ids.userField,value:i.userFields?i.userFields:0,disabled:"1"!=i.useField,suggest:{body:{yCount:4,data:r,on:{onAfterRender(){this.data.each((e=>{t.CYPRESS_REF(this.getItemNode(e.id),`${l.userField}_${e.id}`)}))},onItemClick:function(e){var t=$$(l.userField),i=t.getValue(),n=i.indexOf(e);-1==n?i.push(e):i.splice(n,1),t.setValue(i)}}}},placeholder:a("Click to add User"),labelAlign:"left",stringResult:!1,on:{onAfterRender:function(){d.filterComponent.emit("save",o),t.CYPRESS_REF(this.getNode(),l.userField)},onChange:()=>{$$(this.ids.userField).getList().callEvent("onAfterRender")}}}]}],d=this;return n.elements.push(...c,{id:l.buttonFilter,view:"button",name:"buttonFilter",css:"webix_primary",label:a("Scope query"),type:"icon",badge:0,click:function(){d.filterComponent.popUp(this.$view,null,{pos:"top"})}}),n}async init(e){this.AB=e}populateBadgeNumber(e={}){const t=this.ids,i=$$(t.buttonFilter);e.rules?(i.define("badge",e.rules?.length||null),i.refresh()):(i.define("badge",null),i.refresh())}values(){const e=super.values(),t=this.ids;return $$(t.useField)&&(e.useField=$$(t.useField).getValue()),$$(t.useField)?e.userFields=$$(t.userField).getValue():e.userFields=[],e.filterConditions=this.filterComponent.getValue(),e}}}},3412:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=i(5178);function a(e){const t=(0,n.Z)(e),i=t.L(),a=e.Config.uiSettings(),s=(0,o.Z)(e);return class extends t{constructor(){super("properties_process_email",{name:"",to:"",from:"",subject:"",fromUser:"",toUser:"",message:"",toCustom:"",toCustomFields:"",fromCustom:"",fromCustomFields:"",customFrom:"",toEmailForm:"",fromEmailForm:""}),this.toUser=new s(this.ids.component+"_to_"),this.fromUser=new s(this.ids.component+"_from_")}static get key(){return"Email"}ui(e){const n=this.toUser.ui(e?.toUsers??{}),o=this.fromUser.ui(e?.fromUsers??{});let s=this.ids;return{id:s.component,rows:[{view:"label",label:i("Send Email:")},{view:"label",label:i("Generate an Email message to be sent.")},{view:"form",elements:[{id:s.name,view:"text",label:i("Name"),labelWidth:a.labelWidthLarge,name:"name",value:this.name},{id:s.to,view:"select",label:i("To"),name:"to",value:this.to,options:[{id:0,value:i("Next Participant")},{id:1,value:i("Select Role or User")},{id:2,value:i("Custom")}],on:{onChange:e=>{1==parseInt(e)?($$(s.toUser).show(),$$(s.toEmailForm).hide()):2==parseInt(e)?($$(s.toUser).hide(),$$(s.toEmailForm).show()):($$(s.toUser).hide(),$$(s.toEmailForm).hide())}}},{id:s.toUser,rows:[n],paddingY:10,hidden:1!=parseInt(this.to)},{id:s.toEmailForm,name:"toEmailForm",type:"form",css:"no-margin",rows:[{id:s.toCustom,view:"text",label:i("Email"),placeholder:i("Type email address here..."),name:"toCustom",value:this.toCustom},{id:s.toCustomFields,label:i("toCustomFields"),name:"toCustomFields",value:this.toCustomFields,view:"multicombo",placeholder:i("..."),suggest:{body:{data:[],on:{onAfterRender(){this.data.each((e=>{t.CYPRESS_REF(this.getItemNode(e.id),`${s.toCustomFields}_${e.id}`)}))},onItemClick:function(e){const t=$$(s.toCustomFields),i=t.getValue(),n=i.indexOf(e);-1==n?i.push(e):i.splice(n,1),t.setValue(i)}}}},labelAlign:"left",stringResult:!1,on:{onAfterRender:function(){t.CYPRESS_REF(this.getNode(),s.toCustomFields)},onChange:()=>{$$(this.ids.toCustomFields).getList().callEvent("onAfterRender")}}}],hidden:2!=parseInt(this.to)},{id:s.from,view:"select",label:i("From"),name:"from",value:this.from,options:[{id:0,value:i("Current Participant")},{id:1,value:i("Select Role or User")},{id:2,value:i("Custom")}],on:{onChange:e=>{1==parseInt(e)?($$(s.fromUser).show(),$$(s.fromEmailForm).hide()):2==parseInt(e)?($$(s.fromUser).hide(),$$(s.fromEmailForm).show()):($$(s.fromUser).hide(),$$(s.fromEmailForm).hide())}}},{id:s.fromUser,rows:[o],paddingY:10,hidden:1!=parseInt(this.from)},{id:s.fromEmailForm,name:"fromEmailForm",type:"form",css:"no-margin",rows:[{id:s.fromCustom,view:"text",label:i("Email"),placeholder:i("Type email address here..."),name:"fromCustom",value:this.fromCustom},{id:s.fromCustomFields,view:"multicombo",label:i("Process"),placeholder:i("..."),name:"fromCustomFields",suggest:{body:{data:[],on:{onAfterRender(){this.data.each((e=>{t.CYPRESS_REF(this.getItemNode(e.id),`${s.fromCustomFields}_${e.id}`)}))},onItemClick:function(e){const t=$$(s.fromCustomFields),i=t.getValue(),n=i.indexOf(e);-1==n?i.push(e):i.splice(n,1),t.setValue(i)}}}},labelAlign:"left",value:this.fromCustomFields,stringResult:!1,on:{onAfterRender:function(){t.CYPRESS_REF(this.getNode(),s.fromCustomFields)},onChange:()=>{$$(this.ids.fromCustomFields).getList().callEvent("onAfterRender")}}}],hidden:2!=parseInt(this.from)},{id:s.subject,view:"text",label:i("Subject"),name:"subject",value:this.subject},{view:"spacer",height:10},{id:s.message,view:"tinymce-editor",label:i("Message"),name:"message",value:this.message,borderless:!0,minHeight:500,config:{plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste imagetools wordcount"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"}}]}]}}async init(e){return this.AB=e,Promise.resolve()}applicationLoad(e){super.applicationLoad(e)}processLoad(e){super.processLoad(e),this.process=e}populate(e){let t=this.ids;e.toUsers=e.toUsers??{},e.fromUsers=e.fromUsers??{};const i=e.process.processDataFields(e)||[];let n=i.filter((e=>"user"==e.field?.key));e.toUsers.userProcessFieldData=n,e.fromUsers.userProcessFieldData=n;let o=i.filter((e=>"email"==e.field?.key)).map((e=>({uuid:e.field.id,id:e.key,value:e.label,key:e.key})));$$(t.name).setValue(e.name),$$(t.to).setValue(e.to),$$(t.from).setValue(e.from),$$(t.subject).setValue(e.subject),$$(t.message).setValue(e.message),$$(t.toCustom).setValue(e.toCustom),$$(t.fromCustom).setValue(e.fromCustom),$$(t.fromCustomFields).options_setter(o),$$(t.fromCustomFields).refresh(),$$(t.fromCustomFields).setValue(e.fromCustomFields),$$(t.toCustomFields).options_setter(o),$$(t.toCustomFields).refresh(),$$(t.toCustomFields).setValue(e.toCustomFields);let a=this.toUser.ui(e.toUsers??{}),s={id:t.toUser,rows:[a],paddingY:10,hidden:1!=parseInt(e.to)};webix.ui(s,$$(t.toUser));let r=this.fromUser.ui(e.fromUsers??{}),l={id:t.fromUser,rows:[r],paddingY:10,hidden:1!=parseInt(e.from)};webix.ui(l,$$(t.fromUser))}values(){const e={},t=this.ids;return e.label=$$(t.name).getValue(),e.to=$$(t.to).getValue(),e.from=$$(t.from).getValue(),e.subject=$$(t.subject).getValue(),e.message=$$(t.message).getValue(),e.toCustom=$$(t.toCustom).getValue(),e.toCustomFields=$$(t.toCustomFields).getValue(),e.fromCustom=$$(t.fromCustom).getValue(),e.fromCustomFields=$$(t.fromCustomFields).getValue(),e.toUsers=this.toUser.values(),e.fromUsers=this.fromUser.values(),e}}}},6692:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings(),a=e.Class.ABProcessTaskManager;class s extends t{constructor(){super("properties_process_service",{name:"",option:""})}static get key(){return"TaskService"}ui(){const e=this.ids;return{id:e.component,view:"form",elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.option,rows:[{view:"button",label:i("Accounting: Process Batch"),click:()=>{this.switchTo("AccountingBatchProcessing")}},{view:"button",label:i("Accounting: Fiscal Period Close"),click:()=>{this.switchTo("AccountingFPClose")}},{view:"button",label:i("Accounting: Fiscal Period Year Close"),click:()=>{this.switchTo("AccountingFPYearClose",e.component)}},{view:"button",label:i("Accounting: Journal Entry Archive"),click:()=>{this.switchTo("AccountingJEArchive")}},{view:"button",label:i("Query Task"),click:()=>{this.switchTo("TaskServiceQuery")}},{view:"button",label:i("Insert Record Task"),click:()=>{this.switchTo("InsertRecord")}},{view:"button",label:i("Calculate Task"),click:()=>{this.switchTo("Calculate")}},{view:"button",label:i("Get Reset Password Url"),click:()=>{this.switchTo("GetResetPasswordUrl")}}]}]}}async init(e){return this.AB=e,Promise.resolve()}switchTo(e){const t=this.ids,i=this.values();i.id=this.element.id,i.diagramID=this.element.diagramID,i.key=e??s.key;const n=a.newTask(i,this.element.process,this.AB)??null;n&&this.element.switchTo(n,t.component)}values(){const e=this.ids;let t={};const i=$$(e.name);return t.label=i?.getValue()??"",t.name=i?.getValue()??"",t}populate(e){const t=this.ids,i=$$(t.name);this.element=e,i?.setValue(e.label??"")}}return s}},6699:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_service_calculate",{name:"",formulaText:"",variableList:"",variablePopup:"",operatorPopup:""}),this.element=null}static get key(){return"Calculate"}ui(){const e=this.ids;webix.ui({id:e.variablePopup,view:"popup",hidden:!0,body:{id:e.variableList,view:"list",template:e=>e.value,data:"",on:{onItemClick:function(i){const n=this.getItem(i);t(`{${n.value}}`),$$(e.variablePopup).hide()}}}});const t=t=>{const i=$$(e.formulaText).getValue();$$(e.formulaText).setValue(`${i}${t} `)};return webix.ui({id:e.operatorPopup,view:"popup",hidden:!0,width:180,body:{view:"list",template:e=>{let t="";return e.icon&&(t+=`<i class="fa fa-${e.icon}" aria-hidden="true"></i> `),e.label&&(t+=e.label),t},data:[{label:i("+ Adds"),symbol:"+"},{label:i("- Subtracts"),symbol:"-"},{label:i("* Multiples"),symbol:"*"},{label:i("/ Divides"),symbol:"/"},{label:i("( Open Bracket"),symbol:"("},{label:i(") Closed Bracket"),symbol:")"}],on:{onItemClick:function(i){const n=this.getItem(i);t(n.symbol),$$(e.operatorPopup).hide()}}}}),{rows:[{view:"form",elementsConfig:{labelWidth:120},elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:this.name},{id:e.formulaText,view:"texthighlight",height:200,label:i("Formula"),type:"textarea",value:this.formulaText||"",highlight:e=>e},{cols:[{width:120,fillspace:!0},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-at",label:i("Parameters"),click:function(){$$(e.variablePopup).show(this.$view)}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-hashtag",label:i("Operators"),click:function(){$$(e.operatorPopup).show(this.$view)}}]}]}]}}populate(e){const t=this.ids,i=(e?.process?.processDataFields(e)||[]).map((e=>({id:e.key,value:e.label})));$$(t.name).setValue(e.label),$$(t.formulaText).setValue(e.formulaText),$$(t.variableList).define("data",i),$$(t.variableList).refresh()}values(){const e={},t=this.ids;return e.label=$$(t.name)?.getValue(),e.formulaText=$$(t.formulaText).getValue(),e}}}},1051:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_service_getResetPasswordUrl",{name:"",email:""})}static get key(){return"GetResetPasswordUrl"}ui(){const e=this.ids;return{id:e.component,view:"form",rows:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.email,view:"multicombo",label:i("Email"),name:"email",options:[]}]}}async init(e){return this.AB=e,Promise.resolve()}populate(e){const t=(e.process.processDataFields(e)??[]).filter((e=>"email"==e.field?.key)).map((e=>({id:e.key,value:e.label}))),i=this.ids,n=$$(i.name),o=$$(i.email);n.setValue(e.label),o.setValue(e.email),o.define("options",t),o.refresh()}values(){const e={},t=this.ids,i=$$(t.name),n=$$(t.email);return e.label=i?.getValue()??"",e.name=i?.getValue()??"",e.email=n?.getValue()??"",e}}}},8010:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_service_insertRecord",{name:"",objectID:"",fieldValues:"",repeatLayout:"",repeatMode:"",repeatColumn:""})}static get key(){return"InsertRecord"}ui(){const e=this.ids,t=this.CurrentApplication.objectsIncluded().map((e=>({id:e.id,value:e.label??e.name})));return{id:e.component,view:"form",elementsConfig:{labelWidth:120},elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.objectID,view:"select",label:i("Object"),value:"",name:"objectID",options:t,on:{onChange:e=>{this.element.objectID=e,this.refreshFieldValues(e)}}},{id:e.repeatLayout,hidden:!0,cols:[{id:e.repeatMode,view:"select",label:i("Repeat"),value:"",name:"repeatMode",width:330,options:[{id:"rootData",value:i("For Connection in root data")}],on:{onChange:e=>{this.element.repeatMode=e,this.refreshFieldValues()}}},{id:e.repeatColumn,view:"select",label:"",value:this.repeatColumn,name:"repeatColumn",options:[],on:{onChange:e=>{this.element.repeatColumn=e,this.refreshFieldValues()}}}],on:{onViewShow:()=>{this.refreshFieldValues()}}},{view:"fieldset",label:i("Values"),body:{id:e.fieldValues,view:"form",borderless:!0,elements:[]}}]}}async init(e){return this.AB=e,Promise.resolve()}getFieldOptions(e){const t=[];return t.push({id:"PK",value:i("Primary Key")}),e.fields().forEach((e=>{if(e.isConnection){const n=e.datasourceLink;n&&(t.push({id:`${e.id}|PK`,value:`${e.label} -> ${i("Primary Key")}`}),n.fields().forEach((i=>{t.push({id:`${e.id}|${i.id}`,value:`${e.label} -> ${i.label}`})})))}else t.push({id:e.id,value:e.label})})),t}refreshFieldValues(e){const t=this.ids,n=$$(t.fieldValues);if(!n)return;webix.ui([],n);const o=this.AB.objectByID(e??this.element.objectID);if(!o)return;const a=this.element.objectOfStartElement,s=a?this.getFieldOptions(a):[],r=this.element.objectOfPrevElement,l=r?this.getFieldOptions(r):[],c=[{id:0,value:i("Not Set")},{id:1,value:i("Set by custom value")},{id:2,value:i("Set by the root data [{0}]",[a?a.label:""])},{id:3,value:i("Set by previous step data [{0}]",[r?r.label:""])},{id:4,value:i("Set by formula format")}];let d=[];const u=this.element.fieldRepeat;u&&u.datasourceLink&&(c.push({id:5,value:i("Set by the instance [{0}]",[u?.label??""])}),d=this.getFieldOptions(u.datasourceLink)),c.push({id:6,value:i("Set by the parameter of a Query task")});const h=(this.element.process.processDataFields(this.element)??[]).map((e=>({id:e.key,value:e.label})));o.fields().forEach((e=>{n.addView({fieldId:e.id,view:"layout",cols:[{rows:[{view:"label",label:e.label,width:100},{fillspace:!0}]},{rows:[{name:"setSelector",view:"select",options:c,on:{onChange:function(e){this.getParentView().queryView({name:"valuePanel"}).showBatch(e)}}},{name:"valuePanel",view:"multiview",visibleBatch:0,cols:[{batch:0,fillspace:!0},{batch:1,view:"text"},{batch:2,view:"select",options:s},{batch:3,view:"select",options:l},{batch:4,view:"text"},{batch:5,view:"select",options:d},{batch:6,view:"multicombo",label:"",options:h}]}]}]})}))}setFieldValues(){const e=this.ids,t=$$(e.fieldValues).getChildViews()??[];this.element.fieldValues=this.element.fieldValues??{},t.forEach((e=>{const t=e.config.fieldId,i=this.element.fieldValues[t]??{};e.queryView({name:"setSelector"}).setValue(i.set);const n=e.queryView({name:"valuePanel"}),o=n.queryView({batch:n.config.visibleBatch});o&&o.setValue&&o.setValue(i.value)}))}getFieldValues(){const e={},t=this.ids;return($$(t.fieldValues).getChildViews()??[]).forEach((t=>{const i=t.config.fieldId,n=t.queryView({name:"setSelector"}),o=t.queryView({name:"valuePanel"}),a=o.queryView({batch:o.config.visibleBatch});e[i]={},e[i].set=n.getValue(),e[i].value=a?.getValue?.()??null})),e}populate(e){const t=this.ids,i=$$(t.name),n=$$(t.objectID),o=$$(t.repeatLayout),a=$$(t.repeatMode),s=$$(t.repeatColumn),r=e?.objectOfStartElement?.connectFields().map((e=>({id:e.id,value:e.label})))??[];this.element=e,i.setValue(e.label),n.setValue(e.objectID),a.setValue(e.repeatMode),s.define("options",r),s.refresh(),e.isRepeat&&o.show(),this.refreshFieldValues(),this.setFieldValues()}values(){const e={},t=this.ids,i=$$(t.name),n=$$(t.objectID),o=$$(t.repeatMode),a=$$(t.repeatColumn);return e.label=i.getValue()??"",e.name=i.getValue()??"",e.objectID=n.getValue()??"",e.repeatMode=o.getValue()??"",e.repeatColumn=a.getValue()??"",e.fieldValues=this.getFieldValues(),e}}}},2367:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_service_query",{name:"",query:"",suggestions:""})}static get key(){return"TaskServiceQuery"}ui(){const e=this.ids;return{id:e.component,view:"form",elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:this.name},{id:e.query}]}}async init(e){return this.AB=e,Promise.resolve()}populate(e){const t=this.ids,i=e.ABQLManager().builder(e.qlObj,e,this.AB),n=$$(t.name);this.element=e,webix.ui(i.ui(t.query),$$(t.query)),i.init(t.query),n.setValue(e.label)}values(){const e={},t=this.ids,i=$$(t.name);return e.label=i.getValue()??"",e.name=i.getValue()??"",e.qlObj=this.element.ABQLManager().parse(t.query,this.element,this.AB)??null,e}}}},6277:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_subprocess",{name:"",isEnable:"",parameterId:""})}static get key(){return"SubProcess"}ui(){let e=this.ids;return{id:e.component,view:"form",elementsConfig:{labelWidth:120},elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.isEnable,view:"switch",label:i("Enable"),value:!1},{id:e.parameterId,view:"richselect",label:i("Repeat for"),options:[{id:"",value:""}],value:""}]}}async init(e){return this.AB=e,Promise.resolve()}populate(e){let t=this.ids,i=(e.process.processDataFields(e)||[]).map((e=>({id:e.key,value:e.label}))),n=$$(t.parameterId);n.define("options",i),n.refresh(),$$(t.name).setValue(e.name),$$(t.isEnable).setValue(e.isEnable),n.setValue(e.parameterId)}values(){const e={},t=this.ids;return e.name=$$(t.name)?.getValue(),e.label=e.name,e.isEnable=$$(t.isEnable)?.getValue(),e.parameterId=$$(t.parameterId)?.getValue(),e}}}},4490:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings(),a=e.Class.ABProcessTaskManager;class s extends t{constructor(){super("properties_process_user",{name:"",option:""})}static get key(){return"TaskUser"}ui(){const e=this.ids;return{id:e.component,view:"form",elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.option,rows:[{view:"button",label:i("Approval Task"),click:()=>{this.switchTo("Approval")}},{view:"button",label:i("External Task"),click:()=>{this.switchTo("External")}}]}]}}async init(e){return this.AB=e,Promise.resolve()}switchTo(e){const t=this.ids,i=this.values();i.id=this.element.id,i.diagramID=this.element.diagramID,i.key=e??s.key;const n=a.newTask(i,this.element.process,this.AB)??null;n&&this.element.switchTo(n,t.component)}values(){const e=this.ids;let t={};const i=$$(e.name);return t.label=i?.getValue()??"",t.name=i?.getValue()??"",t}populate(e){const t=this.ids,i=$$(t.name);this.element=e,i?.setValue(e.label??"")}}return s}},7825:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=i(5178);function a(e){const t=(0,n.Z)(e),i=t.L(),a=e.Config.uiSettings(),s=(0,o.Z)(e);return class extends t{constructor(){super("properties_process_user_approval",{name:"",who:"",toUser:"",formBuilder:"",modalWindow:"",formPreview:""}),this.toUser=new s(`${this.ids.component}_to_`),this.on("save",(()=>{this.processComponents()}))}static get key(){return"Approval"}uiUser(e){const t=this.users.ui(e??{});return{id:this.ids.users,rows:[t],paddingY:10}}ui(e){const t=this.ids,n=[{id:0,value:i("Current Participant")},{id:1,value:i("Select Role or User")}];this.laneDiagramID&&"?laneID?"!=this.laneDiagramID||n.shift();const o=()=>({id:t.modalWindow,view:"window",position:"center",fullscreen:!0,modal:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"spacer",width:17},{view:"label",label:i("Customize the approval layout")},{view:"spacer"},{view:"button",label:i("Cancel"),autowidth:!0,click:function(){$$(t.modalWindow).close()}},{view:"button",css:"webixtype_form",label:i("Save"),autowidth:!0,click:()=>{this.formBuilder=$$(t.formBuilder).getFormData(),this.element.formBuilder=this.formBuilder,(this.formBuilder.components||[]).forEach((e=>{e._key&&e.key!=e._key&&(e.key=e._key)})),this.emit("save"),$$(t.modalWindow).close()}},{view:"spacer",width:17}]},body:{id:t.formBuilder,view:"formiobuilder",dataFields:this.dataFields,formComponents:this.formIOComponents}}),s=this.toUser.ui(e?.toUsers??{});return{id:t.component,view:"form",rows:[{id:t.name,view:"text",label:i("Name"),labelWidth:a.labelWidthLarge,name:"name",value:""},{id:t.who,view:"select",label:i("Who"),name:"who",options:n,value:1==n.length?"1":"",on:{onChange:e=>{1==parseInt(e)?$$(t.toUser).show():$$(t.toUser).hide()}}},{id:t.toUser,rows:[s],paddingY:10},{view:"spacer",height:10},{view:"toolbar",type:"clean",borderless:!0,cols:[{view:"label",label:i("Data To Approve")},{view:"spacer"},{view:"button",value:i("Customize Layout"),autowidth:!0,click:()=>{webix.ui(o()).show()}}]},{view:"layout",type:"form",rows:[{view:"layout",padding:20,rows:[{id:t.formPreview,view:"formiopreview",formComponents:[],height:500}]}]}]}}async init(e){this.AB=e}processComponents(){const e=this.ids;this.dataFields=this.element.process.processDataFields(this.element),this.formIOComponents=this.element.preProcessFormIOComponents();const t=$$(e.formPreview).getParentView();t.removeView(e.formPreview),t.addView({id:e.formPreview,view:"formiopreview",formComponents:this.formIOComponents,height:500})}populate(e){this.element=e;const t=this.ids,i=$$(t.name),n=$$(t.who);if(i.setValue(e.label),null!==e.who)if(n.setValue(e.who),"0"===e.who)$$(t.toUser).hide();else{let i=this.toUser.ui(e.toUsers??{}),n={id:t.toUser,rows:[i],paddingY:10};webix.ui(n,$$(t.toUser))}this.processComponents()}values(){const e={},t=this.ids,i=$$(t.name),n=$$(t.who);return e.label=i?.getValue()??"",e.name=i?.getValue()??"",e.who=n?.getValue()??"",e.formBuilder=this.formBuilder,e.toUsers=this.toUser.values(),e}}}},8866:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(3285),o=i(5178);function a(e){const t=(0,n.Z)(e),i=t.L(),a=e.Config.uiSettings(),s=(0,o.Z)(e);return class extends t{constructor(){super("properties_process_user_external",{toUsers:""}),this.toUsers=new s(`${this.ids.component}_to_`)}static get key(){return"External"}ui(){const e=this.ids;return{id:e.component,view:"form",elements:[{view:"text",label:i("Name"),labelWidth:a.labelWidthLarge,name:"name",value:""},{view:"select",label:i("Who"),name:"who",options:[{id:0,value:i("Current Participant")},{id:1,value:i("Select Role or User")}],value:"0",on:{onChange:t=>{const i=$$(e.toUsers);1===parseInt(t)?i.show():i.hide()}}},{id:e.toUsers,rows:[this.toUsers.ui({})]},{view:"texthighlight",label:i("URL"),name:"url",value:"",highlight:e=>e.replace(/{%=[^%]*%}/g,(e=>`<span style="font-weight:500;background-color:#ebedf0;">${e}</span>`))}]}}async init(e){this.AB=e}populate(e){const t=this.ids,i={name:e.name,who:e.who,url:e.url},n=$$(t.component),o=$$(t.toUsers);this.element=e,n.setValues(i),"0"===e.who?o.hide():webix.ui({id:t.toUsers,rows:[this.toUsers.ui(e??{})],paddingY:10},o)}values(){const e=this.ids,t=$$(e.component).getValues();return t.label=t.name,t.toUsers=this.toUsers.values(),t}}}},7358:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();return class extends t{constructor(){super("properties_process_trigger_lifecycle",{name:"",objList:"",lifecycleList:""})}static get key(){return"TriggerLifecycle"}ui(){const e=this.CurrentApplication.objectsIncluded(),t=[];e.forEach((e=>{t.push({id:e.id,value:e.label})}));const n=this.ids;return{id:n.component,rows:[{view:"label",label:i("Object Lifecycle Trigger:")},{view:"label",label:i("Begins a process when an object's data is Added, Updated or Deleted.")},{view:"form",id:n.component,elements:[{id:n.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:n.objList,view:"select",label:i("Object"),options:t},{id:n.lifecycleList,view:"select",label:i("lifecycle"),options:[{id:"added",value:i("after Add")},{id:"updated",value:i("after Update")},{id:"deleted",value:i("after Delete")}]}]}]}}async init(e){this.AB=e}populate(e){const t=this.ids;$$(t.name).setValue(e.label),$$(t.objList).setValue(e.objectID),$$(t.lifecycleList).setValue(e.lifecycleKey)}values(){const e={},t=this.ids;return e.label=$$(t.name)?.getValue(),e.objectID=$$(t.objList)?.getValue(),e.lifecycleKey=$$(t.lifecycleList)?.getValue(),e.triggerKey=`${e.objectID}.${e.lifecycleKey}`,e}}}},9722:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.Config.uiSettings();class a extends t{constructor(){super("properties_process_trigger_lifecycle",{name:"",repeatEvery:"",repeatTime:"",repeatOnPanel:"",repeatDaily:"",repeatWeekly:"",repeatMonthly:"",isEnabled:"",triggerKey:""})}static get key(){return"TimerStartEvent"}ui(){let e=this.ids,t=[];for(let e=1;e<=31;e++)t.push({id:e,value:e});return{view:"form",id:e.component,elements:[{id:e.name,view:"text",label:i("Name"),labelWidth:o.labelWidthLarge,name:"name",value:""},{id:e.repeatEvery,view:"richselect",name:"repeatEvery",label:i("Repeat every"),labelWidth:o.labelWidthLarge,value:s.repeatEvery,options:[{id:"daily",value:i("Daily")},{id:"weekly",value:i("Weekly")},{id:"monthly",value:i("Monthly")}],on:{onChange:t=>{$$(e.repeatOnPanel).showBatch(t)}}},{id:e.repeatTime,view:"datepicker",name:"repeatTime",label:i("Time"),labelWidth:o.labelWidthLarge,value:s.repeatTime,timepicker:!0,type:"time",multiselect:!1},{view:"multiview",id:e.repeatOnPanel,cells:[{view:"radio",id:e.repeatDaily,label:" ",labelWidth:o.labelWidthLarge,batch:"daily",vertical:!0,value:s.repeatDaily,options:[{id:"day",value:i("Day")},{id:"weekday",value:i("Weekday")}]},{view:"multiselect",id:e.repeatWeekly,labelWidth:o.labelWidthLarge,label:i("Every week on:"),batch:"weekly",value:s.repeatWeekly,options:[{id:"SUN",value:i("Sunday")},{id:"MON",value:i("Monday")},{id:"TUE",value:i("Tuesday")},{id:"WED",value:i("Wednesday")},{id:"THU",value:i("Thursday")},{id:"FRI",value:i("Friday")},{id:"SAT",value:i("Saturday")}]},{view:"layout",batch:"monthly",rows:[{id:e.repeatMonthly,view:"richselect",labelWidth:o.labelWidthLarge,label:i("Monthly on day"),options:t,value:s.repeatMonthly}]}]},{id:e.isEnabled,view:"switch",label:i("Enable"),labelWidth:o.labelWidthLarge,value:s.isEnabled},{id:e.triggerKey,view:"text",hidden:!0,value:"triggerKey.??"}]}}async init(e){this.AB=e}populate(e){const t=this.ids;$$(t.name).setValue(e.label),$$(t.repeatEvery).setValue(e.repeatEvery),$$(t.repeatTime).setValue(e.repeatTime),$$(t.repeatDaily).setValue(e.repeatDaily),$$(t.repeatWeekly).setValue(e.repeatWeekly),$$(t.repeatMonthly).setValue(e.repeatMonthly),$$(t.isEnabled).setValue(e.isEnabled),$$(t.triggerKey).setValue(e.triggerKey),null!=e.triggerKey&&"triggerKey.??"!=e.triggerKey||$$(t.triggerKey).setValue(`timer.${e.id||this.AB.uuid()}`)}values(){const e={},t=this.ids;return e.label=$$(t.name).getValue(),e.repeatEvery=$$(t.repeatEvery).getValue(),e.repeatTime=$$(t.repeatTime).getValue().toLocaleTimeString(),e.repeatDaily=$$(t.repeatDaily).getValue(),e.repeatWeekly=$$(t.repeatWeekly).getValue(),e.repeatMonthly=$$(t.repeatMonthly).getValue(),e.isEnabled=$$(t.isEnabled).getValue(),e.triggerKey=$$(t.triggerKey)?.getValue(),e}}const s=e.Class.ABProcessTaskManager.allTasks().filter((e=>e.defaults().key==a.key))[0].defaults();return a}},2135:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(t,i){super(`${t}_ofc`,{queryBuilder:"",queryBuilderContainer:"",queryBuilderLayout:"",showQBButton:""}),this.label=i,this.FilterComplex=e.filterComplexNew(`${this.ids.component}_fc`,{isSaveHidden:!0})}cleanRules(e,t,i){void 0===i&&(i=!0),function e(n){if(n)if(n.glue&&n.rules)n.rules.forEach((t=>{e(t)}));else{var o=t.filter((e=>e.id==n.key))[0];if(o)switch(o.type){case"number":case"formula":"string"==typeof n.value&&(-1==n.value.indexOf(".")?n.value=parseInt(n.value):n.value=parseFloat(n.value));break;case"date":i?n.value instanceof Date&&(n.value=webix.i18n.dateFormatStr(n.value)):"string"==typeof n.value&&(n.value=new Date(n.value))}}}(e)}ui(){const e=this.ids;let t={id:e.queryBuilderLayout,view:"layout",hidden:!0,type:"line",rows:[{id:e.showQBButton,cols:[{fillspace:!0},{view:"button",css:"webix_primary",name:"addqb",value:o("Add Custom Conditions"),autowidth:!0,click:()=>{$$(e.queryBuilderContainer).show(),$$(e.queryBuilderContainer).resize(),$$(e.showQBButton).hide(),this.FilterComplex.fieldsLoad(this.conditionFields(),this.CurrentObject)}},{fillspace:!0}]},{hidden:!0,id:e.queryBuilderContainer,cols:[{view:"layout",height:200,rows:[this.FilterComplex.ui]}]}]};return this.label&&t.rows[1].cols.unshift({view:"label",css:"ab-text-bold",label:this.label,width:i.labelWidthLarge}),t}init(e){this.AB=e,this.FilterComplex.init()}objectLoad(e){super.objectLoad(e),this.FilterComplex.fieldsLoad(this.conditionFields(),e)}getValue(){var e=this.FilterComplex.getValue();let t=this.conditionFields();return e&&this.cleanRules(e,t,!0),e}setValue(e){Array.isArray(e)&&(e=e[0]),e=e||{glue:"and",rules:[]},this.cleanRules(e,this.conditionFields(),!1),this.FilterComplex.setValue(e)}conditionFields(){var e=["string","LongText","number","date","email","formula","calculate"],t=[];return this.CurrentObject&&this.CurrentObject.fields().forEach((i=>{-1!=e.indexOf(i.key)&&t.push(i)})),t}}}},8975:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(2135),o=i(3285);function a(e){const t=(0,o.Z)(e),i=e.Config.uiSettings(),a=t.L(),s=(0,n.Z)(e);return class extends t{constructor(e,t){super(e,{selectAction:"",queryBuilder:"",valueDisplay:""});var i=webix.uid();Object.keys(this.ids).forEach((e=>{this.ids[e]=`${e}_${i}`})),this.listActions=t||[],this.actionDropList=[],this.listActions.forEach((e=>{this.actionDropList.push({id:e.key,value:e.label})})),this.selectedAction=null,this.actionDropList.length>0&&(this.selectedAction=this.actionDropList[0].id),this.removable=!0,this.objectQB=null}init(e){this.AB=e,this.objectQB?.init(e);var t=this.currentAction();t&&t.init(this.AB)}ui(){return{id:this.ids.component,view:"layout",css:"ab-component-form-rules",padding:20,type:"line",rows:[{view:"template",css:"ab-component-form-rules-delete",template:'<i class="fa fa-trash ab-component-remove"></i>',height:30,borderless:!0,hidddatasourceen:0==this.removable,onClick:{"ab-component-remove":()=>{this.emit("delete",this)}}},{id:this.ids.selectAction,view:"richselect",label:a("Action"),placeholder:a("Choose an action"),labelWidth:i.labelWidthLarge,options:this.actionDropList,on:{onChange:(e,t)=>{this.selectAction(e,t)}}},{for:"values",hidden:!0,cells:[{view:"layout",cols:[{view:"label",label:a("Values"),css:"ab-text-bold",width:i.labelWidthLarge},{id:this.ids.valueDisplay,view:"layout",rows:[{label:a(" ABViewRule: This should be the Set Area"),css:"ab-text-bold",height:30}]}]}]},this.objectQB.ui()]}}replaceValueDisplay(e){var t=$$(this.ids.valueDisplay);if(t){var i=t.getChildViews(),n=[];i.forEach((e=>{n.push(e)})),n.forEach((e=>{t.removeView(e)})),t.addView(e.ui())}}selectAction(e,t){e&&$$(this.ids.component).getChildViews().forEach((e=>{e.show()}));var i=this.getAction(t);i&&i.stashCondition(this.objectQB.getValue()),this.selectedAction=e;var n=this.currentAction();n&&(this.objectQB?.setValue(n.condition()),this.replaceValueDisplay(n),n.init(this.AB))}conditionFields(){var e=[],t=this.currentAction();return t&&(e=t.conditionFields()),e}currentAction(){return this.getAction(this.selectedAction)}getAction(e){return this.listActions.filter((t=>t.key==e))[0]}objectLoad(e){super.objectLoad(e),this.listActions.forEach((t=>{t.objectLoad(e)}));var t=a("When");this.objectQB=new s(this.ids.component,t),this.objectQB.objectLoad(e)}formLoad(e){this.viewLoad(e),this.listActions.forEach((t=>{t.formLoad(e)}))}get currentForm(){return this.CurrentView}fromSettings(e){if((e=e||{}).selectedAction){this.selectedAction=e.selectedAction;var t=this.currentAction();if(!t)return;t.stashCondition(e.queryRules||{}),this.ids&&$$(this.ids.selectAction).setValue(this.selectedAction),t.fromSettings(e.actionSettings)}}toSettings(){var e={};if(this.selectedAction){e.selectedAction=this.selectedAction,e.queryRules=this.objectQB.getValue();let t=this.currentAction();t&&(e.actionSettings=t.toSettings())}return e}qbFixAfterShow(){var e=this.currentAction();e&&this.objectQB&&(this.objectQB.setValue(e.condition()),e.qbFixAfterShow())}async isReady(){let e=this.currentAction();return e?e.isReady():Promise.resolve()}isValid(e={}){var t={id:"hiddenQB_"+webix.uid(),hidden:!0,view:"querybuilder"},i=webix.ui(t),n=this.currentAction().condition();this.objectQB&&this.objectQB.cleanRules(n[0],n[1],!1);let o=n[0]||{},a=n[1]||[],s=(e="")=>"number"==typeof e?e:parseFloat(e.replace(/[^-0-9.]/g,""));a.filter((e=>"number"==e.type||"calculate"==e.type||"formula"==e.type)).forEach((t=>{try{o&&o.rules&&Array.isArray(o.rules)&&o.rules.forEach((e=>{e.key==t.id&&(e.value=s(e.value))})),e[t.id]&&"string"==typeof e[t.id]&&(e[t.id]=s(e[t.id]))}catch(e){}})),i.setValue({query:o,fields:a});var r=i.getFilterHelper()(e);return i.destructor(),r}get isPreProcess(){return this.currentAction().isPreProcess||!1}}}},6222:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e);return e.Config.uiSettings(),t.L(),class extends t{constructor(e,t){super(e,t);let i=webix.uid();Object.keys(this.ids).forEach((e=>{this.ids[e]=`${e}_${i}`})),this.key="ABViewRuleAction",this.queryObject=null,this.queryRules={},this.valueRules={}}ui(){return{}}init(e){return this.AB=e,Promise.resolve()}condition(){return[this.conditionRules(),this.conditionFields()]}stashCondition(e){Array.isArray(e)&&(e=e[0]),e&&("or"!=e.glue&&(e.glue="and"),e.rules=e.rules||[],this.queryRules=e)}conditionFields(){var e=["string","number","date","formula","calculate"],t=[];return this.queryObject&&this.queryObject.fields().forEach((i=>{-1!=e.indexOf(i.key)&&t.push({id:i.columnName,value:i.label,type:i.key})})),t}conditionRules(){return this.queryRules}objectLoad(e){super.objectLoad(e),this.queryObjectLoad(e)}queryObjectLoad(e){this.queryObject=e}formLoad(e){this.viewLoad(e)}get currentForm(){return this.CurrentView}valueDisplay(e){return this.valueDisplayComponent(e)}valueDisplayComponent(){return this._ui={ui:{template:"ABViewRuleAction.valueDisplayComponent"},init:e=>{console.error("!!! ABViewRuleAction.valueDisplayComponent() should be overridden."),console.warn(" --\x3e passed in data:",e)}}}fromSettings(e){e=e||{},this.valueRules=e.valueRules||{}}toSettings(){return{}}isReady(){return Promise.resolve()}qbFixAfterShow(){}}}},8791:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(e,t){super(e=e||"ABViewRuleList",{rules:"",rulesScrollview:"",action:"",when:"",values:"",set:""}),this.listRules=[],(t=t||{}).labels=t.labels||{},t.labels.header=t.labels.header||i("Rule List"),t.labels.headerDefault=t.labels.headerDefault||i("Rule List"),this.childSettings=t}ui(){const e=this.ids;return{view:"window",id:e.component,modal:!0,position:"center",resize:!0,width:700,height:450,css:"ab-main-container",head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:this.childSettings.labels.headerDefault},{view:"button",css:"webix_primary",icon:"fa fa-plus",type:"iconButton",label:i("Add new rule"),width:150,click:()=>{this.addRule(),$$(e.rulesScrollview).scrollTo(0,$$(e.rules).$height)}}]},body:{type:"form",rows:[{view:"scrollview",id:e.rulesScrollview,scroll:"xy",body:{view:"layout",id:e.rules,margin:20,padding:10,rows:[]}},{css:{"background-color":"#fff"},cols:[{fillspace:!0},{view:"button",name:"cancel",value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.buttonCancel()}},{view:"button",css:"webix_primary",name:"save",label:i("Save"),type:"form",autowidth:!0,click:()=>{this.buttonSave()}},{fillspace:!0}]}]}}}init(e){return this.AB=e,webix.ui(this.ui()),Promise.resolve()}buttonCancel(){$$(this.ids.component)?.hide()}buttonSave(){var e=this.toSettings();this.emit("save",e),this.hide()}hide(){$$(this.ids.component)?.hide()}show(){$$(this.ids.component)?.show()}addRule(e){var t=this.getRule();if(t){this.listRules.push(t);var i=$$(this.ids.rules);i&&(i.addView(t.ui()),t.objectLoad(this.CurrentObject),t.on("delete",(e=>{$$(this.ids.rules).removeView(t.ids.component);var i=this.listRules.indexOf(e);-1!==i&&this.listRules.splice(i,1)}))),e&&t.fromSettings(e)}}fromSettings(e){this.listRules.forEach((e=>{this.ids?.rules&&e?.ids?.component&&$$(this.ids.rules).removeView(e.ids.component)})),this.listRules=[],e&&e.forEach((e=>{this.addRule(e)}))}objectLoad(e){super.objectLoad(e),this.listRules.forEach((t=>{t.objectLoad(e)}))}toSettings(){var e=[];return this.listRules.forEach((t=>{e.push(t.toSettings())})),e}getRule(){return console.error("!!! ABViewRuleList.getRule() should be overridded by a child object."),null}formLoad(e){this.viewLoad(e)}get currentForm(){return this.CurrentView}rulesReady(){return Promise.resolve()}qbFixAfterShow(){this.listRules.forEach((e=>{e.qbFixAfterShow()}))}}}},1538:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var n=i(8791),o=i(8975),a=i(3285),s=i(6222);const r={filterConditions:{glue:"and",rules:[]}};function l(e){const t=(0,a.Z)(e),i=(0,s.Z)(e),n=e.Config.uiSettings(),o=i.L();class l extends t{constructor(e,t){super(e,{updateForm:""}),this.uniqueIDs(),this.base=e,this.Rule=t,this.valueRules=null}ui(){return{view:"form",id:this.ids.updateForm,elements:[]}}init(e,t){this.AB=e,t=t||this.valueRules,this.setValues(t)}removeAddRow(){const e=this.formGet();if(!e)return;const t=e.getChildViews().filter((e=>e.queryView((function(e){return"field"==e.config.name&&!e.getValue()}))))[0];t&&e.removeView(t)}addRow(e){const t=this.formGet();if(!t)return;const i=t.getChildViews();if(null==e&&i.filter((e=>e.queryView((function(e){return"field"==e.config.name&&!e.getValue()})))).length>0)return;const n=new c(this.base,this.Rule);t.addView(n.ui()),n.init(this.AB,e),n.on("add",(()=>{this.addRow()})),n.on("delete",(e=>{this.delRow(e)})),this.Rule.formRows.push(n)}delRow(e){this.Rule.formRows.forEach(((t,i)=>{t.ui.id==e&&this.Rule.formRows.splice(i,0)}));const t=this.formGet();t&&t.removeView($$(e))}formClear(){const e=this.formGet();if(!e)return;const t=e.getChildViews(),i=[];t.forEach((e=>{i.push(e)})),i.forEach((t=>{e.removeView(t)})),this.Rule.formRows=[]}formGet(){const e=$$(this.ids.updateForm);if(!e){let e="ABViewRuleActionFormRecordRuleUpdate.formGet() could not find webix form.";return this.AB.notify.developer(new Error(e),{context:e,updateForm:this.ids.updateForm}),null}return e}setValues(e){(e=e||{}).fieldOperations=e.fieldOperations||[],this.formGet()&&(this.formClear(),e.fieldOperations.length>0&&e.fieldOperations.forEach((e=>{this.addRow(e)})),this.removeAddRow(),this.addRow())}fromSettings(e){const t=e.valueRules||e;this.setValues(t)}toSettings(){const e={fieldOperations:[]};return this.Rule.formRows.forEach((t=>{const i=t.toSettings();i&&e.fieldOperations.push(i)})),e}}class c extends t{constructor(e,t){super(e,{row:"",updateForm:"",field:"",value:"",selectDc:"",selectBy:"",queryField:"",multiview:"",buttonAdd:"",buttonDelete:""}),this.uniqueIDs(),this.base=e,this.FilterComponent=null,this.Rule=t}ui(){const e=this.ids;return{id:e.row,view:"layout",rows:[{cols:[{view:"label",width:n.labelWidthSmall,label:o("Set")},{id:e.field,view:"combo",name:"field",placeholder:o("Choose a field"),height:32,options:this.getFieldList(!0),on:{onChange:e=>{this.selectField(e)}}},{view:"label",width:n.labelWidthSmall,label:o("To")},{},{view:"button",css:"webix_danger",id:e.buttonDelete,icon:"fa fa-trash",type:"icon",width:30,hidden:!0,click:()=>{this.emit("delete",e.row)}}]},{}]}}datacollections(e=(()=>!0)){return this.Rule.CurrentApplication?.datacollectionsIncluded(e)??[]}buttonsToggle(){const e=$$(this.ids.row).getChildViews()[0].getChildViews();e[4].hide(),e[5].show()}getFieldList(e){let t=[];if(this.Rule.CurrentObject&&(t=(this.Rule.CurrentObject.fields()||[]).map((e=>({id:e.id,value:e.label}))),e)){const e={};this.Rule.formRows.forEach((t=>{const i=$$(t.ids.row);if(i){const t=i.getChildViews()[0].getChildViews()[1];e[t.getValue()]=!0}})),t=t.filter((t=>!e[t.id]))}return t}isValid(){const e=this.ids,t=this.AB.Validation.validator(),i=$$(e.row).getChildViews()[0].getChildViews()[3],n=i.getParentView().getParentView(),a=this.Rule.getUpdateObjectField($$(e.field).getValue());if(a){const e=a.getValue(i,{}),s={};return s[a.columnName]=e,a.isValidData(s,t),(""==e||null==e||Array.isArray(e)&&0==e.length)&&t.addError(a.columnName,o("")),n.clearValidation(),t.updateForm(n),t.pass()}{const t=$$(e.row).getChildViews()[0].getChildViews()[1];return t.define("invalidMessage",o("A value is required")),t.define("invalid",!0),t.refresh(),!1}}selectField(e){const t=this.ids,i=this.Rule.getUpdateObjectField(e);if(!i)return;let n,a,s=i.formComponent().newInstance(this.Rule.CurrentApplication).component();if(console.warn("TODO: remove this testing code:"),n="function"==typeof s.ui?s.ui():s.ui,n.rows[0]?n.rows[0].id=t.value:n.id=t.value,"user"==i.key){n.id=`update_container_${i.id}`,s.ids.component=t.value;const e=n.rows[0].rows[0];e.id=t.value;const a=e.suggest.on.onShow;e.suggest.on.onShow=async()=>{await a();const e=$$(t.value);if(!e)return!0;const i=e.getList().find({})??[];i.unshift({id:"ab-current-user",value:`[${o("Current User")}]`}),e.blockEvent(),e.getList().clearAll(),e.getList().define("data",i),e.unblockEvent()},i.on("option.data",(()=>{e.suggest.on.onShow()}))}let r=this.datacollections((e=>e.datasource)),l=[];r.forEach((e=>{l.push({id:e.id,value:e.label,icon:e.settings.isQuery?"fa fa-filter":"fa fa-database"})}));const c=[{id:"select-one",value:o("Current selection")},{id:"filter-select-one",value:o("Select first after filter by...")}],d={type:"clean",rows:[{cols:[{id:t.selectDc,view:"richselect",options:{data:l},placeholder:o("Choose a data source"),on:{onChange:e=>{const n=this.datacollections((t=>t.id==e))[0];if(!n||"query"!=n.sourceType&&"connectObject"==i.key)$$(t.queryField).hide();else{const e=[];n.datasource.fields().forEach((t=>{e.push({id:t.id,value:t.label})})),$$(t.queryField).define("options",e),$$(t.queryField).refresh(),$$(t.queryField).show()}}}},{id:t.queryField,view:"combo",hidden:!0,placeholder:o("Choose value from..."),options:[{id:1,value:"figure this out"}]}]},{id:t.selectBy,view:"combo",options:c,placeholder:o("Choose select option"),on:{onChange:e=>{const i=$$(t.row);if(i.removeView(i.getChildViews()[1]),"select-one"==e)i.addView({},1);else{const e=(this.Rule.CurrentView?.datacollection?.datasource?.fields()??[]).map((function(e){return{id:e.id,value:e.label}}));this.FilterComponent=this.AB.filterComplexNew(this.base,{height:200,isSaveHidden:!0}),this.FilterComponent.init({isRecordRule:!0,recordRuleFieldOptions:e}),console.warn("TODO: remove this transition Code:"),"function"==typeof this.FilterComponent.ui?i.addView(this.FilterComponent.ui(),1):i.addView(this.FilterComponent.ui,1);const n=$$(t.selectDc).getValue(),o=this.datacollections((e=>e.id==n))[0];o&&this.populateFilters(o)}}}}]};if(i.isConnection&&"user"!=i.key){const e=i.datasourceLink;r=r.filter((t=>t.datasource.id==e.id));const n=this.datacollections((t=>"query"==t.sourceType&&t.datasource&&t.datasource.canFilterObject(e)));r=r.concat(n),l=[],r.forEach((e=>{l.push({id:e.id,value:e.label,icon:e.settings.isQuery?"fa fa-filter":"fa fa-database"})})),c.push({id:"filter-select-all",value:o("Select all after filter by...")}),a=d,$$(t.selectDc)?($$(t.selectDc).parse?$$(t.selectDc).parse(l):$$(t.selectDc).define("options",l),$$(t.selectDc).refresh()):a.rows[0].cols[0].options=l,s={init:function(){}}}else a={id:t.multiview,view:"multiview",cells:[{batch:"custom",rows:[n,{view:"label",label:o("<a>Or exists value</a>"),on:{onItemClick:function(){this.getParentView().getParentView().showBatch("exist")}}}]},{batch:"exist",rows:[d,{view:"label",label:o("<a>Or custom value</a>"),on:{onItemClick:function(){const e=this.getParentView().getParentView();$$(t.selectBy).setValue("select-one"),e.showBatch("custom")}}}]}]};const u=$$(t.row).getChildViews()[0];if(u.removeView(u.getChildViews()[3]),u.addView(a,3),s.init(),!i.isConnection&&i.customDisplay){const e=$$(n.id).$view;setTimeout((()=>{i.customDisplay(i,this.AB._App,e,{editable:!0,isForm:!0})}),50)}u.getChildViews()[4].show(),e&&this.emit("add")}setValue(e){const t=this.ids;$$(t.field).setValue(e.fieldID);const i=this.Rule.getUpdateObjectField(e.fieldID);if(i){const n=()=>{$$(t.selectDc).setValue(e.value),e.queryField&&$$(t.queryField).setValue(e.queryField);const i=e.selectBy||"select-one";if($$(t.selectBy).setValue(i),"select-one"!=i){const t=e.value,i=this.datacollections((e=>e.id==t))[0];i&&e.filterConditions&&this.populateFilters(i,e.filterConditions)}};"connectObject"==i.key?n():"exist"==e.valueType?($$(t.multiview)?.showBatch("exist"),n()):($$(t.multiview)?.showBatch("custom"),setTimeout((function(){const n={};n[i.columnName]=e.value,i.setValue($$(t.value),n)}),50))}}populateFilters(e,t){t=t??r.filterConditions,this.FilterComponent.fieldsLoad(e.datasource?e.datasource.fields():[]),this.FilterComponent.setValue(t)}toSettings(){const e=this.ids,t=$$(e.field).getValue();if(!t)return null;const i={fieldID:t},n=$$(e.value),o=this.Rule.getUpdateObjectField(i.fieldID);return"connectObject"==o.key||"exist"==$$(e.multiview).config.visibleBatch?(()=>{i.value=$$(e.selectDc).getValue(),i.queryField=$$(e.queryField).getValue(),i.op="set",i.type=o.key,i.selectBy=$$(e.selectBy).getValue(),i.valueType="exist",this.FilterComponent&&(i.filterConditions=this.FilterComponent.getValue())})():(i.value=o.getValue(n,{}),i.op="set",i.type=o.key,i.valueType="custom"),i}init(e,t){return this.AB=e,t&&this.setValue(t),Promise.resolve()}}return class extends i{constructor(e,t){super(e,t),this.key="ABViewRuleActionFormRecordRuleUpdate",this.label=o("Update Record"),this.formRows=[],this.stashRules={}}ui(){return this._uiUpdater||this.valueDisplayComponent(),this._uiUpdater.ui()}init(){this._uiUpdater?.init(e,this.valueRules)}valueDisplayComponent(e){return null==this._uiUpdater&&(this._uiUpdater=new l(e??this.ids.component,this)),this._uiUpdater}getUpdateObjectField(e){return this.CurrentObject.fieldByID(e)}objectLoad(e){this.CurrentObject&&(this.stashRules[this.CurrentObject.id]=this.valueRules),super.objectLoad(e),e&&(this.valueRules=this.stashRules[this.CurrentObject.id]||{})}fromSettings(e){if(e=e||{},super.fromSettings(e),e.updateObjectID){const t=this.AB.objectByID(e.updateObjectID);this.objectLoad(t)}this._uiUpdater&&this._uiUpdater.fromSettings(e)}toSettings(){const e=super.toSettings();return e.valueRules=this._uiUpdater?.toSettings(),e.updateObjectID=this.CurrentObject.id,e}}}var c=i(2135);function d(e){const t=(0,a.Z)(e),i=(0,s.Z)(e),n=l(e),o=n.L(),r=(0,c.Z)(e);class d extends t{constructor(e,t,i){super(e,{updateForm:"",selectConnectedField:"",updateFieldsForm:""}),this.base=e,this.RuleAction=t,this.options=i??{},this.uniqueIDs(),this.ObjectUpdater=new n(`${this.base}_objupdater`,{})}ui(){return{id:this.ids.component,view:"layout",css:"ab-component-form-rule",rows:[{id:this.ids.selectConnectedField,view:"richselect",label:o("Select which connected object to update."),labelWidth:300,value:this.RuleAction.selectedField(),options:this.RuleAction.fieldDropList,on:{onChange:(e,t)=>{this.selectAction(e,t)}}}]}}init(e){return this.ObjectUpdater.init(e)}addDisplay(e){$$(this.ids.component).addView(e)}removePreviousDisplays(){var e=$$(this.ids.component).getChildViews(),t=[];e.forEach((e=>{t.push(e)})),t.forEach((e=>{e.config.id!=this.ids.selectConnectedField&&$$(this.ids.component).removeView(e)}))}selectAction(e){this.removePreviousDisplays(),this.RuleAction.selectedFieldID=e;var t=this.RuleAction.connectedObject();if(t){if(this.ObjectUpdater.objectLoad(t),this.ObjectUpdater.applicationLoad(this.RuleAction.CurrentApplication),this.updateComponent=this.ObjectUpdater.valueDisplayComponent(this.ids.updateFieldsForm),this.showQBIfNeeded(),this.addDisplay(this.updateComponent.ui()),this.updateComponent.init(this.AB),this.options?.isUpdateValueDisabled){let e=this.updateComponent.formGet();e&&(e.disable(),e.hide())}}else this.AB.notify.builder(new Error("No connectedObject found."),{fieldID:this.selectedFieldID})}showQBIfNeeded(){var e=this.RuleAction.queryBuilderDisplay(this.base);this.addDisplay(e.ui()),e.init(this.AB)}fromSettings(e){$$(this.ids.selectConnectedField).setValue(e.selectedFieldID),this.objectQB&&this.objectQB.setValue(this.qbCondition),this.updateComponent&&this.updateComponent.fromSettings(e)}toSettings(){return this.updateComponent?.toSettings()??{}}}return class extends i{constructor(e){super(e,{}),this.key="ABViewRuleActionFormRecordRuleUpdateConnected",this.label=o("Update Connected Record"),this.selectedFieldID=null,this.fieldDropList=[],this.objectQB=null,this.qbCondition=null,this._uiChooser=null}ui(){return this._uiChooser||this.valueDisplayComponent(this.base),this._uiChooser.ui()}objectLoad(e){super.objectLoad(e),this.connectedFieldList().forEach((e=>{this.fieldDropList.push({id:e.id,value:e.label})}))}connectedFieldList(){return this.CurrentObject.connectFields()}connectedObject(){if(this.selectedFieldID){var e=this.selectedField();if(e)return e.datasourceLink}return null}selectedField(){return this.connectedFieldList().filter((e=>e.id==this.selectedFieldID))[0]}valueDisplayComponent(e){return null==this._uiChooser&&(this._uiChooser=new d(e,this,{isUpdateValueDisabled:this.isUpdateValueDisabled})),this._uiChooser}superValueDisplayComponent(e){return super.valueDisplayComponent(e)}queryBuilderDisplay(e){if(!this.objectQB){this.objectQB=new r(e,o("How to choose which object:"));var t=this.connectedObject();t&&this.objectQB.objectLoad(t)}return this.objectQB}fromSettings(e){e=e||{},this.selectedFieldID=e.selectedFieldID||null,this.qbCondition=e.qbCondition||{},super.fromSettings(e),this._uiChooser&&this._uiChooser.fromSettings(e)}toSettings(){var e=super.toSettings();e.selectedFieldID=this.selectedFieldID;var t=null;return this.objectQB&&(t=this.objectQB.getValue(),Array.isArray(t)&&(t=t[0]),t&&(t.glue=t.glue||"and")),e.qbCondition=t,this._uiChooser&&(e.valueRules=this._uiChooser.toSettings()),e}qbFixAfterShow(){this.objectQB&&this.objectQB.setValue(this.qbCondition)}}}function u(e,t){const i=(0,n.Z)(e),a=(0,o.Z)(e),s=i.L(),r=function(e){const t=l(e);return class extends t{constructor(t){super(t,{}),this.key="ABViewRuleActionFormRecordRuleUpdate",this.label=((...t)=>e.Multilingual.label(...t))("Update Record")}}}(e),c=function(e){const t=d(e);return class extends t{constructor(t){super(t,{}),this.key="ABViewRuleActionFormRecordRuleInsertConnected",this.label=((...t)=>e.Multilingual.label(...t))("Insert Connected Object")}}}(e),u=d(e),h=function(e){const t=d(e);return class extends t{constructor(t){super(t,{}),this.key="ABViewRuleActionFormRecordRuleRemoveConnected",this.label=((...t)=>e.Multilingual.label(...t))("Remove Connected Record"),this.isUpdateValueDisabled=!0}}}(e);return new class extends i{constructor(e="ABViewRuleListFormRecordRules"){super(e,{labels:{header:s("Record Rules"),headerDefault:s("Record Rules")}}),this.base=e}getRule(){var e=[new r(`${this.base}_ruleActionUpdate`),new c(`${this.base}_ruleActionInsertConnected`),new u(`${this.base}_ruleActionUpdateConnected`),new h(`${this.base}_ruleActionRemoveConnected`)],t=new a(`${this.base}_rule_record`,e);return t.init(this.AB),t.objectLoad(this.CurrentObject),t.formLoad(this.currentForm),t}}(t)}},2418:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285),o=null;function a(e){if(!o){const i=(0,n.Z)(e);var t=i.L();o=class extends i{constructor(t="properties_abview",i={}){var n={label:""};Object.keys(i).forEach((e=>{void 0===n[e]?n[e]="":console.error(`!!! ABFieldProperty:: passed in ids contains a restricted field : ${e}`)})),super(t,n),this.base=t,this.AB=e}ui(e=[],i={}){let n=this.ids,o={view:"form",id:n.component,scroll:!0,elements:[{id:n.label,view:"text",label:t("Name"),name:"name",value:""}],rules:{}};return e.forEach((e=>{o.elements.push(e)})),Object.keys(i).forEach((e=>{o.rules[e]=i[e]})),o}async init(e){this.AB=e,this.ViewClass()}clearEditor(){console.error("!!! Depreciated! call clear() instead."),this.clear()}clear(){$$(this.ids.label).setValue("")}propertyDatacollections(e){return e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label})))}defaults(){var e=this.ViewClass();return e?e.common():(console.error("!!! properties/views/ABView: could not find ViewClass"),null)}editorPopulate(e){console.error("!!! Depreciated. call populate() instead."),this.populate(e)}formValues(){return $$(this.ids.component).getValues()}isValid(){}markInvalid(e,t){$$(this.ids.component).markInvalid(e,t)}onChange(){this.emit("changed")}populate(e){this.viewLoad(e),$$(this.ids.label)?.setValue(e.label)}requiredOnChange(){}values(){let e={};return e.label=$$(this.ids.label).getValue(),e}ViewClass(){return console.error("!!! Child Class has not overwritten ViewClass()"),null}_ViewClass(e){var t=this.CurrentApplication;return t||(t=this.AB.applicationNew({})),t.viewAll((t=>t.common().key==e))[0]}}}return o}},1712:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(t){super(t??"properties_abview_csvexporter",{datacollection:"",buttonLabel:"",hasHeader:"",filename:"",width:"",buttonFilter:""}),this.AB=e,this.propertyFilter=this.AB.filterComplexNew(`${t}_filter`)}static get key(){return"csvExporter"}ui(){const e=this.ids;return super.ui([{view:"fieldset",label:o("Data:"),labelWidth:i.labelWidthLarge,body:{rows:[{id:e.datacollection,name:"datacollection",view:"richselect",label:o("Data Source"),labelWidth:i.labelWidthLarge,skipAutoSave:!0,on:{onChange:(e,t)=>{e!=t&&(this.populateFilter(),this.onChange())}}},{id:e.hasHeader,name:"hasHeader",view:"checkbox",label:o("Header on first line"),labelWidth:i.labelWidthXLarge},{cols:[{view:"label",label:o("Filter Option:"),css:"ab-text-bold",width:i.labelWidthLarge},{id:e.buttonFilter,view:"button",name:"buttonFilter",css:"webix_primary",label:o("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:()=>{this.showFilterPopup()}}]}]}},{view:"fieldset",label:o("Customize Display:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.buttonLabel,name:"buttonLabel",view:"text",label:o("Label"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.filename,name:"filename",view:"text",label:o("File name"),labelWidth:i.labelWidthLarge},{id:e.width,view:"counter",name:"width",label:o("Width:"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}}]}}])}async init(e){this.AB=e,await super.init(e),this.propertyFilter.init(),this.propertyFilter.on("save",(e=>{this.onChange(),this.populateBadgeNumber()})),this.filter_popup=webix.ui({view:"popup",width:800,hidden:!0,body:this.propertyFilter.ui})}populate(e){super.populate(e),e.settings=e.settings??{};const t=this.ids,i=this.ViewClass().defaultValues();this.populateDatacollections(),$$(t.hasHeader).setValue(e.settings.hasHeader??i.hasHeader),$$(t.buttonLabel).setValue(e.settings.buttonLabel??i.buttonLabel),$$(t.filename).setValue(e.settings.filename??i.filename),$$(t.width).setValue(e.settings.width??i.width),this.populateFilter(),this.populateBadgeNumber()}populateDatacollections(){const e=this.CurrentView.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"===e.sourceType?"fa fa-filter":"fa fa-database"}))),t=$$(this.ids.datacollection);t.define("options",e),t.define("value",this.CurrentView?.settings?.dataviewID??null),t.refresh()}populateBadgeNumber(){const e=this.ids,t=this.CurrentView;$$(e.buttonFilter).define("badge",t?.settings?.where?.rules?.length??null),$$(e.buttonFilter).refresh()}populateFilter(){const e=this.CurrentView,t=e.datacollection?.datasource;this.propertyFilter.fieldsLoad(t?.fields()??[]),this.propertyFilter.setValue(e.settings.where)}showFilterPopup(){const e=$$(this.ids.buttonFilter);this.propertyFilter.popUp(e?.$view)}values(){const e=this.ids,t=this.ViewClass().defaultValues(),i=super.values();return i.settings=i.settings??{},i.settings.dataviewID=$$(e.datacollection).getValue(),i.settings.hasHeader=$$(e.hasHeader).getValue(),i.settings.where=this.propertyFilter.getValue(),i.settings.buttonLabel=$$(e.buttonLabel).getValue()??t.buttonLabel,i.settings.filename=$$(e.filename).getValue()??t.filename,i.settings.width=$$(e.width).getValue()??t.width,i}ViewClass(){return super._ViewClass("csvExporter")}}}},231:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(2418),o=i(1538);let a=null;function s(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),s=t.L();return class extends t{constructor(t){super(t??"properties_abview_csvimporter",{datacollection:"",fields:"",buttonLabel:"",buttonRecordRules:"",width:""}),this.AB=e}static get key(){return"csvImporter"}ui(){const e=this.ids;return a=(0,o.Z)(this.AB,this.base),super.ui([{view:"fieldset",label:s("Data:"),labelWidth:i.labelWidthLarge,body:{id:e.datacollection,name:"datacollection",view:"richselect",label:s("Data Source"),labelWidth:i.labelWidthLarge,skipAutoSave:!0,on:{onChange:e=>this.selectSource(e)}}},{view:"fieldset",label:s("Available Fields:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.fields,name:"fields",view:"list",select:!1,minHeight:250,template:this.listTemplate.bind(this),type:{markCheckbox:function(e){return`<span class='check webix_icon fa fa-${e.selected?"check-":""}square-o'></span>`}},onClick:{check:this.check.bind(this)}}]}},{view:"fieldset",label:s("Rules:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:s("Record Rules:"),width:i.labelWidthLarge},{id:e.buttonRecordRules,view:"button",name:"buttonRecordRules",css:"webix_primary",label:s("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:this.recordRuleShow.bind(this)}]}]}},{view:"fieldset",label:s("Customize Display:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.buttonLabel,name:"buttonLabel",view:"text",label:s("Label"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>this.onChange()}},{id:e.width,view:"counter",name:"width",label:s("Width:"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>this.onChange()}}]}}])}async init(e){this.AB=e,await super.init(e),a.init(e),a.on("save",(()=>{this.populateBadgeNumber()}))}selectSource(e){const t=this.CurrentView;t.settings=t.settings??{},t.settings.dataviewID=e,this.updateRules(),this.populateAvailableFields({selectAll:!0}),this.onChange()}updateRules(){const e=this.CurrentView.datacollection;e?.datasource&&a.objectLoad(e.datasource),a.fromSettings(this.CurrentView?.settings?.recordRules??[])}populateAvailableFields(e={}){const t=this.ids,i=this.CurrentView,n=this.AB.datacollectionByID(i.settings.dataviewID)?.datasource;i.settings=i.settings??{};const o=i.settings.availableFieldIds??[],a=n?.fields()?.map((t=>(t.selected=!!e.selectAll||o.filter((e=>t.id==e)).length>0,t)));$$(t.fields).clearAll(),$$(t.fields).parse(a)}populateBadgeNumber(){const e=this.ids,t=this.CurrentView;t&&($$(e.buttonRecordRules).define("badge",t.settings?.recordRules?.length??null),$$(e.buttonRecordRules).refresh())}listTemplate(e,t){const i=e.formComponent();if(null==i)return`<i class='fa fa-times'></i>  ${e.label} <div class='ab-component-form-fields-component-info'> Disable </div>`;const n=i.common().key,o=this.CurrentApplication.viewAll((e=>e.common().key==n))[0];return`${t.markCheckbox(e)} ${e.label} <div class='ab-component-form-fields-component-info'> <i class='fa fa-${o?.common()?.icon??"fw"}'></i> ${o?s(o.common().labelKey??"Label"):""} </div>`}check(e,t){const i=this.ids;let n=$$(i.fields).getItem(t);n.selected=n.selected?0:1,$$(i.fields).updateItem(t,n),this.onChange()}recordRuleShow(){this.updateRules(),a.CurrentObject&&a.show(),a.qbFixAfterShow()}populate(e){super.populate(e);const t=this.ids;e.settings=e.settings??{},this.populateDataCollections(),this.populateAvailableFields(),$$(t.buttonLabel).setValue(e.settings.buttonLabel),$$(t.width).setValue(e.settings.width),e.settings.availableFieldIds=[],($$(t.fields).find({selected:!0})||[]).forEach((t=>{e.settings.availableFieldIds.push(t.id)}))}populateDataCollections(){const e=this.ids,t=this.CurrentView,i=this.CurrentApplication.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"===e.sourceType?"fa fa-filter":"fa fa-database"}))),n=$$(e.datacollection);n.define("options",i),n.define("value",t.settings.dataviewID),n.refresh()}defaultValues(){const e={dataviewID:null,buttonLabel:"Upload CSV",width:0,recordRules:[],availableFieldIds:[]},t=this.ViewClass();if(t){const i=t.defaultValues();Object.keys(i).forEach((t=>{e[t]=i[t]}))}return e}values(){const e=this.ids,t=super.values();return t.settings=t.settings??{},t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.recordRules=a.toSettings(),t.settings.buttonLabel=$$(e.buttonLabel).getValue(),t.settings.width=$$(e.width).getValue(),t.settings.availableFieldIds=[],$$(e.fields).find({selected:!0}).forEach((e=>{t.settings.availableFieldIds.push(e.id)})),t}ViewClass(){return super._ViewClass("csvImporter")}toSettings(){var e=this.defaults();return e.settings=this.defaultValues(),e}}}},814:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(2418),o=i(4245),a=i(8782);function s(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),s=t.L(),r="properties_abview_carousel",l=new((0,o.Z)(e,r)),c=new a.Z(e,r);return class extends t{constructor(){super(r,{datacollection:"",field:"",filterByCursor:"",width:"",height:"",showLabel:"",hideItem:"",hideButton:"",navigationType:"",gridFilterMenuButton:"",detailsPage:"",editPage:""}),this.ABFieldImage=e.Class.ABFieldManager.fieldByKey("image"),this._preFilterSettings=null,this.linkPageComponent=new c}static get key(){return"carousel"}ui(){let e=this.ids,t=this;return super.ui([{view:"fieldset",label:s("Data:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.datacollection,view:"select",name:"datacollection",label:s("Datacollection:"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:(t,i)=>{if(t!=i){this.linkPageComponent.clear();let i=[],n=this.AB.datacollectionByID(t);if(n){let e=n.datasource;e&&(i=e.fields((e=>e instanceof this.ABFieldImage)).map((e=>({id:e.id,value:e.label})))||[])}i.length>0?i.unshift({id:"",value:s("Select a field")}):i.unshift({id:"",value:s("no image fields.")}),$$(e.field).define("options",i),$$(e.field).refresh(),this.onChange()}}}},{id:e.field,view:"select",name:"field",label:s("Image Field:"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:()=>{this.onChange()}}},{id:e.filterByCursor,view:"checkbox",name:"filterByCursor",labelWidth:0,labelRight:s("Filter images by cursor"),on:{onChange:()=>{this.onChange()}}}]}},this.linkPageComponent.ui(),{view:"fieldset",label:s("Customize Display:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.navigationType,view:"select",name:"navigationType",label:s("Navigation Type"),labelWidth:i.labelWidthLarge,options:[{id:"corner",value:s("Corner")},{id:"side",value:s("Side")}],on:{onChange:()=>{this.onChange()}}},{id:e.showLabel,view:"checkbox",name:"showLabel",labelRight:s("Show label of image"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.hideItem,view:"checkbox",name:"hideItem",labelRight:s("Hide item list"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.hideButton,view:"checkbox",name:"hideButton",labelRight:s("Hide navigation buttons"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.width,view:"counter",name:"width",label:s("Width:"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{id:e.height,view:"counter",name:"height",label:s("Height:"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{cols:[{view:"label",label:s("Filter Option:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.gridFilterMenuButton,view:"button",css:"webix_primary",label:s("Settings"),icon:"fa fa-gear",type:"icon",click:function(){t.filterMenuShow(this.$view)}}]}]}}])}async init(e){super.init(e),this._handler_onCancel=()=>{l.setSettings(this._preFilterSettings),this.filter_property_popup.hide()},this.filter_property_popup=webix.ui({view:"window",modal:!0,position:"center",resize:!0,width:700,height:450,css:"ab-main-container",hidden:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:s("Filter Menu")},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:this._handler_onCancel,on:{onAfterRender(){t.CYPRESS_REF(this)}}}]},body:l.ui()}),l.on("cancel",this._handler_onCancel),l.on("save",(()=>{this.filter_property_popup.hide(),this.onChange()}));let i=[];return i.push(l.init(e)),i.push(this.linkPageComponent.init(e)),Promise.all(i)}populate(e){super.populate(e);let t=this.ids;if(e){var i=this.propertyDatacollections(e);$$(t.datacollection).define("options",i),$$(t.datacollection).refresh(),$$(t.datacollection).setValue(e.settings.dataviewID),$$(t.field).setValue(e.settings.field),$$(t.filterByCursor).setValue(e.settings.filterByCursor),$$(t.width).setValue(e.settings.width),$$(t.height).setValue(e.settings.height),$$(t.showLabel).setValue(e.settings.showLabel),$$(t.hideItem).setValue(e.settings.hideItem),$$(t.hideButton).setValue(e.settings.hideButton),$$(t.navigationType).setValue(e.settings.navigationType);var n=e.datacollection;n&&(l.objectLoad(n.datasource),l.setSettings(e.settings.filter)),this.linkPageComponent.viewLoad(e),this.linkPageComponent.setSettings(e.settings)}}defaultValues(){let e={};var t=this.ViewClass();return t&&(e=t.defaultValues()),e}filterMenuShow(){this._preFilterSettings=l.getSettings(),this.filter_property_popup.show()}values(){let e=this.ids,t=super.values();t.settings=t.settings||{},t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.field=$$(e.field).getValue(),t.settings.filterByCursor=$$(e.filterByCursor).getValue()||!1,t.settings.width=$$(e.width).getValue(),t.settings.height=$$(e.height).getValue(),t.settings.showLabel=$$(e.showLabel).getValue(),t.settings.hideItem=$$(e.hideItem).getValue(),t.settings.hideButton=$$(e.hideButton).getValue(),t.settings.navigationType=$$(e.navigationType).getValue(),t.settings.filter=l.getSettings();let i=this.linkPageComponent.getSettings();for(let e in i)t.settings[e]=i[e];return t}ViewClass(){return super._ViewClass("carousel")}}}},7887:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3156);function o(e){const t=(0,n.default)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_chart",{dataviewID:"",columnLabel:"",columnValue:"",multipleSeries:"",columnValue2:""}),this.AB=e}static get key(){return"chart"}ui(){const e=this.ids;return super.ui([{id:e.dataviewID,name:"dataviewID",view:"richselect",label:o("Chart Data"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:()=>{this.onChange(),this.populateFieldOptions(),$$(e.multipleSeries).getValue()&&this.populateFieldOptions2()}}},{id:e.columnLabel,name:"columnLabel",view:"richselect",label:o("Label Column"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:()=>{this.onChange()}}},{id:e.columnValue,name:"columnValue",view:"richselect",label:o("Value Column"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:()=>{this.onChange()}}},{id:e.multipleSeries,name:"multipleSeries",view:"checkbox",label:o("Multiple Series"),labelWidth:i.labelWidthLarge,value:0,on:{onChange:t=>{const i=$$(e.columnValue2);t?this.populateFieldOptions2():(i.setValue(""),i.disable()),this.onChange()}}},{id:e.columnValue2,name:"columnValue2",view:"richselect",label:o("Value Column 2"),labelWidth:i.labelWidthLarge,disabled:!0,options:[],on:{onChange:()=>{this.onChange()}}},{name:"isPercentage",view:"checkbox",labelRight:o("Percentage"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{name:"showLabel",view:"checkbox",label:o("Display Label"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{name:"labelPosition",view:"richselect",label:o("Label Position"),labelWidth:i.labelWidthLarge,options:[{id:"left",value:o("Left")},{id:"top",value:o("Top")}],on:{onChange:()=>{this.onChange()}}},{name:"labelWidth",view:"counter",label:o("Label Width"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{view:"counter",name:"height",label:`${o("Height")}: `,labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e),webix.extend($$(this.ids.component),webix.ProgressBar)}updateCharts(){this.CurrentView.refreshData()}populateDataview(){const e=this.AB.Account.isSystemDesigner()?e=>!e.isSystemObject:()=>!0,t=this.CurrentApplication.datacollectionsIncluded(e),i=$$(this.ids.dataviewID);i.define("options",t.map((e=>({id:e.id,value:e.label})))),i.refresh()}populateFieldOptions(){const e=this.CurrentView.datacollection;if(!e)return;const t=e.datasource;if(!t)return;const i=this.ids,n=$$(i.columnLabel),o=$$(i.columnValue);n.define("options",t.fields().map((e=>({id:e.id,value:e.columnName,key:e.key})))),n.refresh(),o.define("options",t.fields((e=>"number"===e.key||"formula"===e.key||"calculate"===e.key)).map((e=>({id:e.id,value:e.columnName,key:e.key})))),o.refresh()}populateFieldOptions2(){const e=this.CurrentView.datacollection;if(!e)return;const t=e.datasource;if(!t)return;const i=$$(this.ids.columnValue2);i.define("options",t.fields((e=>"number"===e.key||"formula"===e.key||"calculate"===e.key)).map((e=>({id:e.id,value:e.columnName,key:e.key})))),i.enable(),i.refresh()}populate(e){super.populate(e);const t=this.ids,i=$$(t.component),n=this.defaultValues(),o=Object.assign(i.getValues(),Object.assign(n,e.settings));this.populateDataview(),this.populateFieldOptions(),o.multipleSeries&&this.populateFieldOptions2(),i.setValues(o)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values(),t=this.ids,i=$$(t.component);return e.settings=Object.assign(i.getValues(),e.settings),e}ViewClass(){return super._ViewClass("chart")}}}},7661:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_chart_area",{}),this.AB=e}static get key(){return"area"}ui(){return super.ui([{name:"areaType",view:"richselect",label:o("Chart Type"),labelWidth:i.labelWidthLarge,options:[{id:"area",value:o("Area")},{id:"stackedArea",value:o("Stacked Area")}],on:{onChange:()=>{this.onChange()}}},{name:"chartHeight",view:"counter",min:1,label:o("Height"),on:{onChange:()=>{this.onChange()}}},{name:"stepValue",view:"counter",min:1,label:o("Step"),on:{onChange:()=>{this.onChange()}}},{name:"maxValue",view:"counter",min:1,label:o("Max Value"),on:{onChange:()=>{this.onChange()}}},{name:"labelFontSize",view:"counter",min:1,label:o("Label Font Size"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{name:"isLegend",view:"checkbox",labelRight:o("Show Legend"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=$$(this.ids.component),i=this.defaultValues(),n=Object.assign(t.getValues(),Object.assign(i,e.settings));t.setValues(n)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values();return e.settings=Object.assign($$(this.ids.component).getValues(),e.settings),e}ViewClass(){return super._ViewClass("area")}}}},2225:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_chart_bar",{}),this.AB=e}static get key(){return"bar"}ui(){return super.ui([{name:"barType",view:"richselect",label:o("Chart Type"),labelWidth:i.labelWidthLarge,options:[{id:"bar",value:o("Vertical")},{id:"barH",value:o("Horizontal")}],on:{onChange:()=>{this.onChange()}}},{name:"barPreset",view:"richselect",label:o("Chart Preset"),labelWidth:i.labelWidthLarge,options:[{id:"column",value:o("Column")},{id:"stick",value:o("Stick")},{id:"alpha",value:o("Alpha")}],on:{onChange:()=>{this.onChange()}}},{name:"height",view:"counter",min:1,label:o("Height"),on:{onChange:()=>{this.onChange()}}},{name:"stepValue",view:"counter",min:1,label:o("Step"),on:{onChange:()=>{this.onChange()}}},{name:"maxValue",view:"counter",min:1,label:o("Max Value"),on:{onChange:()=>{this.onChange()}}},{name:"labelFontSize",view:"counter",min:1,label:o("Label Font Size"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{name:"isLegend",view:"checkbox",labelRight:o("Show Legend"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=$$(this.ids.component),i=this.defaultValues(),n=Object.assign(t.getValues(),Object.assign(i,e.settings));t.setValues(n)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values();return e.settings=Object.assign($$(this.ids.component).getValues(),e.settings),e}ViewClass(){return super._ViewClass("bar")}}}},992:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_chart_line",{}),this.AB=e}static get key(){return"line"}ui(){return super.ui([{name:"lineType",view:"richselect",label:o("Chart Type"),labelWidth:i.labelWidthLarge,options:[{id:"line",value:o("Line")},{id:"spline",value:o("Spline")}],on:{onChange:()=>{this.onChange()}}},{name:"linePreset",view:"richselect",label:o("Chart Preset"),labelWidth:i.labelWidthLarge,options:[{id:"plot",value:o("Plot")},{id:"diamond",value:o("Diamond")},{id:"simple",value:o("Simple")}],on:{onChange:()=>{this.onChange()}}},{name:"chartHeight",view:"counter",min:1,label:o("Height"),on:{onChange:()=>{this.onChange()}}},{name:"stepValue",view:"counter",min:1,label:o("Step"),on:{onChange:()=>{this.onChange()}}},{name:"maxValue",view:"counter",min:1,label:o("Max Value"),on:{onChange:()=>{this.onChange()}}},{name:"labelFontSize",view:"counter",min:1,label:o("Label Font Size"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{name:"isLegend",view:"checkbox",labelRight:o("Show Legend"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=$$(this.ids.component),i=this.defaultValues(),n=Object.assign(t.getValues(),Object.assign(i,e.settings));t.setValues(n)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values();return e.settings=Object.assign($$(this.ids.component).getValues(),e.settings),e}ViewClass(){return super._ViewClass("line")}}}},3875:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_chart_pie",{}),this.AB=e}static get key(){return"pie"}ui(){return super.ui([{name:"pieType",view:"richselect",label:o("Chart Type"),labelWidth:i.labelWidthLarge,options:[{id:"pie",value:o("Standard")},{id:"pie3D",value:o("Pie3D")},{id:"donut",value:o("Donut")}],on:{onChange:()=>{this.onChange()}}},{name:"height",view:"counter",min:1,label:o("Height"),on:{onChange:()=>{this.onChange()}}},{name:"innerFontSize",view:"counter",min:1,label:o("Inner Font Size"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{name:"labelFontSize",view:"counter",min:1,label:o("Label Font Size"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{name:"isLegend",view:"checkbox",labelRight:o("Show Legend"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=$$(this.ids.component),i=this.defaultValues(),n=Object.assign(t.getValues(),Object.assign(i,e.settings));t.setValues(n)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values();return e.settings=Object.assign($$(this.ids.component).getValues(),e.settings),e}ViewClass(){return super._ViewClass("pie")}}}},4158:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_comment",{dataviewID:"",columnUser:"",columnComment:"",columnDate:"",height:""}),this.AB=e}static get key(){return"comment"}ui(){const e=this.ids;return super.ui([{id:e.dataviewID,view:"richselect",name:"dataviewID",label:o("Data Source"),labelWidth:i.labelWidthLarge,on:{onChange:e=>{this.selectSource(e)}}},{id:e.columnUser,view:"richselect",name:"columnUser",label:o("Select a user field"),labelWidth:i.labelWidthLarge},{id:e.columnComment,view:"richselect",name:"columnComment",label:o("Select a comment field"),labelWidth:i.labelWidthLarge},{id:e.columnDate,view:"richselect",name:"columnDate",label:o("Select a date field"),labelWidth:i.labelWidthLarge},{id:e.height,view:"counter",name:"height",label:o("Height:"),labelWidth:i.labelWidthLarge}])}async init(e){this.AB=e,await super.init(e)}selectSource(e){this.updateUserFieldOptions(e),this.updateCommentFieldOptions(e),this.updateDateFieldOptions(e)}updateDatacollectionOptions(e){const t=this.CurrentApplication.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"===e.sourceType?"fa fa-filter":"fa fa-database"}))),i=this.ids;$$(i.dataviewID).define("options",t),$$(i.dataviewID).define("value",e),$$(i.dataviewID).refresh()}updateUserFieldOptions(e){const t=this.CurrentView.AB.datacollectionByID(e),i=t?t.datasource:null,n=i?i.fields((e=>"user"===e.key)).map((e=>({id:e.id,value:e.label}))):[];n.unshift({id:null,value:"[Select]"});const o=this.ids;$$(o.columnUser).define("options",n),$$(o.columnUser).refresh()}updateCommentFieldOptions(e){const t=this.CurrentView.AB.datacollectionByID(e),i=t?t.datasource:null,n=i?i.fields((e=>"string"===e.key||"LongText"===e.key)).map((e=>({id:e.id,value:e.label}))):[];n.unshift({id:null,value:"[Select]"});const o=this.ids;$$(o.columnComment).define("options",n),$$(o.columnComment).refresh()}updateDateFieldOptions(e){const t=this.CurrentView.AB.datacollectionByID(e),i=t?t.datasource:null,n=i?i.fields((e=>"date"===e.key)).map((e=>({id:e.id,value:e.label}))):[];n.unshift({id:null,value:"[Select]"});const o=this.ids;$$(o.columnDate).define("options",n),$$(o.columnDate).refresh()}populate(e){super.populate(e);const t=this.ids,i=e.settings.dataviewID?e.settings.dataviewID:null;this.updateDatacollectionOptions(i),this.updateUserFieldOptions(i),this.updateCommentFieldOptions(i),this.updateDateFieldOptions(i);const n=$$(t.component),o=n.getValues();for(const t in e.settings)o[t]=o[t]||e.settings[t];n.setValues(o)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=$$(e.component),i=super.values();return i.settings=t.getValues(),i}ViewClass(){return super._ViewClass("comment")}}}},4856:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L(),a="properties_abview_conditionalcontainer";let s;return class extends t{constructor(){super(a,{buttonFilter:"",datacollection:""}),this.AB=e,s=this.AB.Class.ABViewManager.viewClass("conditionalcontainer").defaultValues()}static get key(){return"conditionalcontainer"}get filterComponent(){return null==this._filterComponent&&(this._filterComponent=this.AB.filterComplexNew(`${a}_filter`)),this._filterComponent}ui(){return this.filterComponent.init(),this.filterComponent.on("save",(e=>{this.onFilterChange(e)})),null==this._filterPopup&&(this._filterPopup=this.AB.Webix.ui({view:"popup",width:800,hidden:!0,body:this.filterComponent.ui})),super.ui([{id:this.ids.datacollection,name:"datacollection",view:"richselect",label:o("Data Source"),labelWidth:i.labelWidthLarge,on:{onChange:e=>{this.changeDatacollection(e)}}},{view:"fieldset",name:"filter",label:o("Filter:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:o("Filter Data:"),width:i.labelWidthLarge},{id:this.ids.buttonFilter,view:"button",name:"buttonFilter",label:o("Settings"),icon:"fa fa-gear",type:"icon",css:"webix_primary",autowidth:!0,badge:0,click:()=>{const e=$$(this.ids.buttonFilter);this.showFilterPopup(e)}}]}]}}])}populate(e){if(super.populate(e),!e)return;const t=this.ids,i=$$(t.datacollection),n=e.application.datacollectionsIncluded().map((e=>{let t="fa-database";return"query"===e.sourceType&&(t="fa-filter"),{id:e.id,value:`<i class="fa ${t}"></i> ${e.label}`}}));i.define("options",n),i.define("value",e?.settings?.dataviewID??null),i.refresh(),e?.settings?.filterConditions&&this.filterComponent.setValue(e.settings.filterConditions),this.populatePopupEditors(e)}defaultValues(){let e={};const t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){const e=this.ids,t=this.filterComponent.getValue(),i=super.values();return i.settings=i.settings??{},i.settings.dataviewID=$$(e.datacollection).getValue(),i.settings.filterConditions=t,i}ViewClass(){return super._ViewClass("conditionalcontainer")}changeDatacollection(e){const t=this.CurrentView;this.populatePopupEditors(t,e),this.filterComponent.setValue(s.filterConditions),this.onChange(),this.populateBadgeNumber(t)}showFilterPopup(e){this._filterPopup.show(e,{pos:"bottom"})}hideFilterPopup(){this._filterPopup.hide()}onFilterChange(){this.values();const e=this.filterComponent.getValue();this.filterComponent.isConditionComplete(e)&&(this.hideFilterPopup(),setTimeout((()=>{this.onChange();const e=this.CurrentView;this.populateBadgeNumber(e)}),10))}populatePopupEditors(e,t){let i=e.datacollection;t&&(i=e.AB.datacollectionByID(t)),i?.datasource?this.filterComponent.fieldsLoad(i.datasource.fields()):this.filterComponent.fieldsLoad(),this.filterComponent.setValue(e.settings.filterConditions??s.filterConditions),this.populateBadgeNumber(e)}populateBadgeNumber(e){const t=this.ids,i=$$(t.buttonFilter),n=e?.settings?.filterConditions?.rules?.length||null;i.define("badge",n),i.refresh()}}}},3156:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(2418),o=null;function a(e){if(!o){const i=e.Config.uiSettings(),a=(0,n.Z)(e);var t=a.L();o=class extends a{constructor(t="properties_abview_container",i={}){var n={columns:"",gravity:""};Object.keys(i).forEach((e=>{void 0===n[e]?n[e]="":console.error(`!!! ABViewContainerProperty:: passed in ids contains a restricted id : ${e}`)})),super(t,n),this.base=t,this.AB=e}static get key(){return"viewcontainer"}ui(e=[],n={}){let o=this.ids,a=[{id:o.columns,name:"columns",view:"counter",min:1,label:t("Columns"),labelWidth:i.labelWidthXLarge,on:{onChange:(e,n)=>{e>8&&$$(o.columns).setValue(8);let a=$$(o.gravity),s=e=>{var n=a.getParentView().index(a);a.getParentView().addView({view:"counter",value:"1",min:1,label:t("Column {0} Gravity",[e]),labelWidth:i.labelWidthXLarge,css:"gravity_counter",on:{onChange:()=>{this.onChange()}}},n)};function r(){a.getParentView().removeView(a.getParentView().getChildViews()[a.getParentView().index(a)-1])}e>n?(2==e&&s(1),s(e)):e<n&&(r(),1==e&&r()),this.onChange()}}},{id:o.gravity,view:"text",name:"gravity",height:1}];return a=a.concat(e),super.ui(a,n)}clear(){}defaults(){var e=this.ViewClass();return e?e.common():(console.error("!!! properties/views/ABView: could not find ViewClass"),null)}editorPopulate(e){console.error("!!! Depreciated. call populate() instead."),this.populate(e)}formValues(){return $$(this.ids.component).getValues()}isValid(){}markInvalid(e,t){$$(this.ids.component).markInvalid(e,t)}populate(e){super.populate(e);let n=this.ids,o=$$(n.columns);o?.setValue(e.settings.columns||1);let a=$$(n.gravity);if(a){a.getParentView().queryView({css:"gravity_counter"},"all").map((e=>a.getParentView().removeView(e)));let n=o.getValue();if(n>1)for(var s=1;s<=n;s++){var r=a.getParentView().index(a);a.getParentView().addView({view:"counter",min:1,label:t("Column {0} Gravity",[s]),labelWidth:i.labelWidthXLarge,css:"gravity_counter",value:e.settings.gravity&&e.settings.gravity[s-1]?e.settings.gravity[s-1]:1,on:{onChange:()=>{this.onChange()}}},r)}}}requiredOnChange(){}values(){let e=super.values();e.settings={},e.settings.columns=$$(this.ids.columns).getValue();var t=[];return $$(this.ids.gravity).getParentView().queryView({css:"gravity_counter"},"all").map((e=>t.push($$(e).getValue()))),e.settings.gravity=t,e}ViewClass(){return super._ViewClass("viewcontainer")}}}return o}},5786:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e),o=i.L();return class extends i{constructor(){super("properties_abview_data_filter",{datacollection:"",fields:"",custom_filters:"",custom_sort:"",batch:""}),this.AB=e}static get key(){return"data-filter"}ui(){let e=this.ids;return super.ui([{id:e.batch,visibleBatch:"advanced",rows:[{id:e.viewtype,name:"viewType",view:"combo",label:o("Display as"),labelWidth:t.labelWidthLarge,on:{onChange:(t,i)=>{t!=i&&($$(e.batch).showBatch(t),this.onChange())}},options:[{id:"advanced",value:"Search & filter"},{id:"connected",value:"Connected field"}]},{id:e.datacollection,name:"dataviewID",view:"combo",label:o("Datacollection"),labelWidth:t.labelWidthLarge,on:{onChange:(e,t)=>{e!=t&&(this.populateFields(e),this.onChange())}}},{id:e.fields,batch:"connected",name:"field",view:"combo",label:o("Field"),labelWidth:t.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{view:"checkbox",batch:"advanced",id:e.custom_filters,label:"Show Filters",labelWidth:t.labelWidthLarge,name:"showFilter",on:{onChange:()=>{this.onChange()}}},{view:"checkbox",batch:"advanced",id:e.custom_sort,label:"Show Sort",labelWidth:t.labelWidthLarge,name:"showSort",on:{onChange:()=>{this.onChange()}}},{}]}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);let t=this.ids;if(!e)return;const i=$$(t.component),n=this.defaultValues();let o=i.getValues();for(const e in n)o[e]=n[e]||o[e];for(const t in e.settings)o[t]=void 0!==e.settings[t]?e.settings[t]:o[t];let a=o.dataviewID?o.dataviewID:null;var s=$$(t.datacollection),r=e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"===e.sourceType?"fa fa-filter":"fa fa-database"})));s.define("options",r),s.define("value",e.datacollection),s.refresh(),a&&this.populateFields(a),i.setValues(o)}populateFields(e){let t=this.ids,i=this.AB.datacollectionByID(e);var n;n=(i?i.datasource:null).connectFields().map((e=>({id:e.columnName,value:e.label}))),$$(t.fields).define("options",n),$$(t.fields).refresh()}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=$$(e.component),i=super.values();return i.settings=t.getValues(),i.text=i.settings.text,i}ViewClass(){return super._ViewClass("data-filter")}}}},3300:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(1377),o=i(8782);function a(e){const t="properties_abview_dataview",i=(0,n.default)(e),a=(0,o.Z)(e,t),s=e.Config.uiSettings(),r=i.L();let l={};return class extends i{constructor(){super(t,{xCount:""}),this.AB=e,l=this.AB.Class.ABViewManager.viewClass("dataview").defaultValues(),this.linkPageComponent=new a(e,t)}static get key(){return"dataview"}ui(){const e=this.ids;return super.ui([{id:e.xCount,view:"counter",name:"xCount",min:1,label:r("Items in a row"),labelWidth:s.labelWidthLarge,step:1,on:{onChange:()=>{this.onChange()}}},this.linkPageComponent.ui()])}init(){super.init(this.AB),this.linkPageComponent.init(),this.linkPageComponent.on("change",(()=>{this.onChange()}))}populate(e){if(super.populate(e),!e)return;const t=this.ids;$$(t.xCount).setValue(e.settings.xCount||l.xCount),this.linkPageComponent.viewLoad(e),this.linkPageComponent.setSettings(e.settings)}defaultValues(){let e={};const t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){const e=this.ids;let t=super.values();t.settings=t.settings??{},t.settings.xCount=$$(e.xCount).getValue();let i=this.linkPageComponent.getSettings();for(let e in i)t.settings[e]=i[e];return t}ViewClass(){return super._ViewClass("dataview")}}}},1377:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3156);function o(e){const t=(0,n.default)(e),i=e.Config.uiSettings(),o=t.L();let a={};return class extends t{constructor(t,i={}){super(t,Object.assign({datacollection:"",fields:"",showLabel:"",labelPosition:"",labelWidth:"",height:""},i)),this.AB=e,a=this.AB.Class.ABViewManager.viewClass("detail").defaultValues()}static get key(){return"detail"}ui(e){const t=this.ids;let n=[{id:t.datacollection,name:"datacollection",view:"richselect",label:o("Data Source"),labelWidth:i.labelWidthLarge,skipAutoSave:!0,on:{onChange:(e,t)=>{this.selectSource(e,t)}}},{id:t.fields,name:"fields",view:"list",select:!1,minHeight:200,template:this.listTemplate,type:{markCheckbox:function(e){return"<span class='check webix_icon fa fa-"+(e.selected?"check-":"")+"square-o'></span>"}},onClick:{check:(...e)=>this.check(...e)}},{id:t.showLabel,name:"showLabel",view:"checkbox",label:o("Display Label"),labelWidth:i.labelWidthLarge},{id:t.labelPosition,name:"labelPosition",view:"richselect",label:o("Label Position"),labelWidth:i.labelWidthLarge,options:[{id:"left",value:o("Left")},{id:"top",value:o("Top")}],on:{onChange:()=>{this.onChange()}}},{id:t.labelWidth,name:"labelWidth",view:"counter",label:o("Label Width"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:t.height,name:"height",view:"counter",label:o("Height:"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}}];return(e??[]).forEach((e=>{n.push(e)})),super.ui(n)}populate(e){if(super.populate(e),!e)return;const t=this.ids,i=e.settings?.dataviewID,n=$$(t.datacollection),o=e.application.datacollectionsIncluded().filter((e=>{const t=e.datasource;return"object"==e.sourceType&&t&&!t.isImported})).map((e=>{let t={id:e.id,value:e.label};return"query"==e.sourceType?t.icon="fa fa-filter":t.icon="fa fa-database",t}));n.define("options",o),n.define("value",i),n.refresh(),this.propertyUpdateFieldOptions(i,e),$$(t.showLabel).setValue(e.settings.showLabel??a.showLabel),$$(t.labelPosition).setValue(e.settings.labelPosition??a.labelPosition),$$(t.labelWidth).setValue(parseInt(e.settings.labelWidth)??a.labelWidth),$$(t.height).setValue(e.settings.height>=0?e.settings.height:a.height),e?.views().forEach((t=>{t instanceof this.AB.Class.ABViewDetailItem&&t.once("destroyed",(()=>this.populate(e)))}))}defaultValues(){let e={};const t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){const e=this.ids;let t=super.values();return t.settings=t.settings??{},t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.showLabel=$$(e.showLabel).getValue(),t.settings.labelPosition=$$(e.labelPosition).getValue(),t.settings.labelWidth=$$(e.labelWidth).getValue(),t.settings.height=$$(e.height).getValue(),t}ViewClass(){return super._ViewClass("detail")}propertyUpdateFieldOptions(e,t){const i=this.ids,n=this.AB.datacollectionByID(e)?.datasource,o=n?.fields().map((e=>(e.selected=t?.views((t=>e.id==t.settings.fieldId)).length>0,e)));$$(i.fields).clearAll(),$$(i.fields).parse(o??[])}async selectSource(e){const t=this.ids;let i=this.CurrentView;i.settings.dataviewID=e;let n=i._views;i._views=[];let o=[];n.forEach((e=>{o.push(e.destroy())})),await Promise.all(o),this.propertyUpdateFieldOptions(e);let a=[],s=$$(t.fields).find({});s.reverse(),s.forEach(((e,n)=>{if(!e.selected){const o=s.length-n-1,r=i.addFieldToDetail(e,o);r&&(r.once("destroyed",(()=>this.populate(i))),a.push(r.save())),e.selected=1,$$(t.fields).updateItem(e.id,e)}})),await Promise.all(a),await i.save(),i.parentDetailComponent()?.emit("properties.updated",i),this.onChange()}listTemplate(e,t){return`${t.markCheckbox(e)} ${e.label}`}check(e,t){const i=this.ids,n=this.CurrentView,o=n.parentDetailComponent(),a=$$(i.fields).getItem(t);a.selected=a.selected?0:1,$$(i.fields).updateItem(t,a);const s=()=>{n.emit("properties.updated",n),this.onChange()};if(a.selected){const e=n.addFieldToDetail(a);e&&e.save().then((()=>{e.once("destroyed",(()=>this.populate(n))),n.viewInsert(e).then((()=>{s()}))}))}else{const e=o.views((e=>e.settings.fieldId==t))[0];e&&(e.destroy(),n.viewRemove(e).then((()=>{s()})))}}}}},9270:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(7420);function o(e){const t=(0,n.default)(e);return class extends t{constructor(){super("properties_abview_detail_checkbox",{height:""}),this.AB=e}static get key(){return"detailcheckbox"}ViewClass(){return super._ViewClass("detailcheckbox")}}}},3381:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(7420);function o(e){const t=(0,n.default)(e);return class extends t{constructor(){super("properties_abview_detail_custom",{height:""}),this.AB=e}static get key(){return"detailcustom"}ViewClass(){return super._ViewClass("detailcustom")}}}},8568:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(7420);function o(e){const t={height:0,width:0},i=(0,n.default)(e);return class extends i{constructor(){super("properties_abview_detail_image",{height:"",width:""}),this.AB=e}static get key(){return"detailimage"}ui(){return super.ui([{id:this.ids.height,name:"height",view:"counter",label:this.label("Height"),on:{onChange:()=>this.onChange()}},{id:this.ids.width,name:"width",view:"counter",label:this.label("Width"),on:{onChange:()=>this.onChange()}}])}ViewClass(){return super._ViewClass("detailimage")}populate(e){super.populate(e);const t=this.defaultValues(),i=e.settings?.height??t.height;$$(this.ids.height).setValue(i);const n=e.settings?.width??t.width;$$(this.ids.width).setValue(n)}defaultValues(){const e=super.defaultValues();return Object.assign(t,e)}values(){const e=super.values()??{};return e.settings=e.settings??{},e.settings.height=$$(this.ids.height).getValue(),e.settings.width=$$(this.ids.width).getValue(),e}}}},7420:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(t,i={}){super(t,Object.assign(i,{field:""})),this.AB=e}ui(e=[],t={}){const n=[{id:this.ids.field,name:"fieldLabel",view:"text",disabled:!0,label:i("Field")}].concat(e);return super.ui(n,t)}populate(e){super.populate(e);const[t]=this.AB.objectByID(e.settings.objectId).fields((t=>t.id==e.settings.fieldId));$$(this.ids.field).setValue(t.label)}defaultValues(){const e=this.ViewClass();let t={};return e&&(t=e.defaultValues()),t}}}},1023:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(7420);function o(e){const t={height:0},i=(0,n.default)(e);return class extends i{constructor(){super("properties_abview_detail_text",{height:""}),this.AB=e}static get key(){return"detailtext"}ui(){return super.ui([{id:this.ids.height,name:"height",view:"counter",label:this.label("Height"),on:{onChange:()=>this.onChange()}}])}ViewClass(){return super._ViewClass("detailtext")}populate(e){super.populate(e);const t=this.defaultValues(),i=e.settings?.height??t.height;$$(this.ids.height).setValue(i)}defaultValues(){const e=super.defaultValues();return Object.assign(t,e)}values(){const e=super.values()??{};return e.settings=e.settings??{},e.settings.height=$$(this.ids.height).getValue(),e}}}},7901:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(7420);function o(e){const t=(0,n.default)(e);return class extends t{constructor(){super("properties_abview_detail_tree",{height:""}),this.AB=e}static get key(){return"detailtree"}ViewClass(){return super._ViewClass("detailtree")}}}},6309:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();let a={};return class extends t{constructor(){super("properties_abview_docxBuilder",{buttonlabel:"",buttonPosition:"",datacollection:"",docxFile:"",docxDownload:"",filelabel:"",language:"",toolbarBackground:"",width:0}),this.AB=e,a=this.AB.Class.ABViewManager.viewClass("docxBuilder").defaultValues()}static get key(){return"docxBuilder"}ui(){const e=this.AB.Multilingual.languages().map((e=>({id:e.language_code,value:e.language_label})));return super.ui([{view:"fieldset",label:o("Data:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:this.ids.datacollection,name:"datacollection",view:"richselect",label:o("Data Source"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}}]}},{view:"fieldset",label:o("Template file:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:o("DOCX file:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:this.ids.docxFile,view:"uploader",value:o("Upload"),name:"docxFile",apiOnly:!0,inputName:"file",multiple:!1,on:{onBeforeFileAdd:e=>this.validateType(e),onFileUpload:(e,t)=>{this.uploadedFile(e)},onFileUploadError:(e,t)=>{}}}]},{id:this.ids.filelabel,name:"filelabel",view:"text",label:o("Filename"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:this.ids.docxDownload,name:"docxDownload",view:"button",type:"icon",css:"webix_primary",icon:"fa fa-file-word-o",label:o("Download Template File"),click:()=>{this.downloadFile()}}]}},{view:"fieldset",label:o("Language:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:this.ids.language,name:"language",view:"richselect",label:o("Language"),labelWidth:i.labelWidthLarge,options:e,on:{onChange:()=>{this.onChange()}}}]}},{view:"fieldset",label:o("Customize Display:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:this.ids.buttonlabel,name:"buttonlabel",view:"text",label:o("Label"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{id:this.ids.width,view:"counter",name:"width",label:o("Width:"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{id:this.ids.toolbarBackground,view:"richselect",name:"toolbarBackground",label:o("Page background:"),labelWidth:i.labelWidthXLarge,options:[{id:"ab-background-default",value:o("White (default)")},{id:"webix_dark",value:o("Dark")},{id:"ab-background-lightgray",value:o("Gray")}],on:{onChange:()=>{this.onChange()}}},{id:this.ids.buttonPosition,view:"richselect",name:"buttonPosition",label:o("Button Position:"),labelWidth:i.labelWidthXLarge,options:[{id:"left",value:o("Left (default)")},{id:"center",value:o("Centered")},{id:"right",value:o("Right")}],on:{onChange:()=>{this.onChange()}}}]}}])}populate(e){if(super.populate(e),!e)return;const t=this.ids,i=$$(t.datacollection),n=e.settings.dataviewID??null;$$(t.toolbarBackground).setValue(e.settings.toolbarBackground??a.toolbarBackground),$$(t.buttonPosition).setValue(e.settings.buttonPosition??a.buttonPosition);const o=e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"===e.sourceType?"fa fa-filter":"fa fa-database"})));i.define("options",o),i.define("value",n),i.refresh(),$$(t.language).setValue(e.settings.language??a.language),$$(t.filelabel).setValue(e.filelabel??e.settings.filelabel),$$(t.buttonlabel).setValue(e.buttonlabel??e.settings.buttonlabel),$$(t.width).setValue(e.settings.width),e.settings.filename?$$(t.docxDownload).show():$$(t.docxDownload).hide()}defaultValues(){let e={};const t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){const e=this.ids;let t=super.values();return t.settings=t.settings??{},t.settings.buttonlabel=$$(e.buttonlabel).getValue(),t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.width=$$(e.width).getValue(),t.filelabel=$$(e.filelabel).getValue(),t.settings.language=$$(e.language).getValue(),t.settings.toolbarBackground=$$(e.toolbarBackground).getValue(),t.settings.buttonPosition=$$(e.buttonPosition).getValue(),t}ViewClass(){return super._ViewClass("docxBuilder")}validateType(e){const t=this.ids,i=["docx"],n=e.type.toLowerCase();if(-1==i.indexOf(n))return this.AB.Webix.message(o(`Only [${i.join(", ")}] files are supported`)),!1;{const e=this.CurrentView.uploadUrl();return $$(t.docxFile).define("upload",e),$$(t.docxFile).refresh(),!0}}uploadedFile(e){if(!e||!e.data)return;const t=this.ids;let i=this.CurrentView;i.settings.filename=e.data.uuid,i.filelabel=e.name,$$(t.filelabel).setValue(i.filelabel),$$(t.docxDownload).show()}downloadFile(){const e=this.CurrentView,t=e.downloadUrl();fetch(t).then((e=>e.blob())).then((t=>{e.letUserDownload(t,e.filelabel)}))}}}},7103:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var n=i(3156),o=i(1538),a=i(8791),s=i(8975),r=i(6222);function l(e){const t=(0,n.default)(e),i=e.Config.uiSettings(),l=t.L();var c={};const d="properties_abview_form",u=(0,o.Z)(e,`${d}_popupRecordRule`),h=function(e,t){const i=(0,a.Z)(e),n=(0,s.Z)(e),o=i.L(),l=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{message:""}),this.key="ABViewRuleActionFormSubmitRuleConfirmMessage",this.label=i("Show a confirmation message"),this.formRows=[]}ui(){return{id:this.ids.message,view:"textarea",height:130}}init(e){return this.AB=e,Promise.resolve()}fromSettings(e){e=e||{},super.fromSettings(e),$$(this.ids.message)?.setValue(e.message||"")}toSettings(){var e=super.toSettings();return e.message=$$(this.ids.message)?.getValue()||"",e}}}(e),c=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{pagesAndTabs:""}),this.key="ABViewRuleActionFormSubmitRuleExistPage",this.label=i("Redirect to an existing page"),this.formRows=[]}ui(){return{id:this.ids.pagesAndTabs,view:"richselect",options:[]}}init(e){this.AB=e,this.refreshUI()}fromSettings(e){super.fromSettings(e);const t=e.valueRules||{};$$(this.ids.pagesAndTabs).setValue(t.tabId??t.pageId??"")}toSettings(){const e=this.ids,t=super.toSettings(),i=$$(e.pagesAndTabs).getValue(),n=$$(e.pagesAndTabs).getPopup().getList().config.data.filter((e=>e.id==i))[0];return n&&("tab"==n.type?t.valueRules={pageId:n.pageId,tabId:i}:t.valueRules={pageId:i}),t}refreshUI(){const e=this.ids,t=[],i=(e,n,o,a)=>{n=n||"";const s="tab"==o?"fa fa-window-maximize":"fa fa-file-o",r=e.pageParent();t.push({id:e.id,value:`${n}${e.label}`,type:o,pageId:r?.id,icon:s}),"page"!=o&&"tab"!=o||((e?.pages?.()??[]).forEach((function(e){i(e,`${n}-`,"page")})),(e?.views?.((e=>"tab"==e.key))??[]).forEach((t=>{t.views().forEach((t=>{i(t,`${n}-`,"tab",e.id)}))})))};i(this.currentForm.pageRoot(),"","page"),$$(e.pagesAndTabs).define("options",t),$$(e.pagesAndTabs).refresh()}}}(e),d=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{}),this.key="ABViewRuleActionFormSubmitRuleParentPage",this.label=i("Redirect to the parent page"),this.formRows=[]}ui(){return{view:"label",label:this.label}}}}(e),u=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{}),this.key="ABViewRuleActionFormSubmitRuleClosePopup",this.label=i("Close the current popup"),this.formRows=[]}ui(){return{view:"layout",rows:[]}}}}(e),h=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{website:""}),this.key="ABViewRuleActionFormSubmitRuleWebsite",this.label=i("Redirect to another website URL"),this.formRows=[]}ui(){return{id:this.ids.website,view:"text"}}fromSettings(e){super.fromSettings(e);const t=e.valueRules||{};$$(this.ids.website).setValue(t.website??"")}toSettings(){const e=this.ids,t=super.toSettings();return t.valueRules={website:$$(e.website).getValue()??""},t}}}(e),p=function(e){const t=(0,r.Z)(e),i=t.L();return class extends t{constructor(e){super(e,{form:"",popup:"",list:"",toEmailsContainer:"",toEmails:"",fromName:"",message:""}),this.key="ABViewRuleActionFormSubmitRuleEmail",this.label=i("Send a custom email"),this.formRows=[]}ui(){const e=this.ids,t=this;return{id:e.form,view:"form",width:450,elementsConfig:{labelPosition:"top",labelWidth:100},cols:[{width:330,rows:[{view:"text",name:"fromName",label:i("From Name")},{view:"text",name:"fromEmail",label:i("From Email"),validate:webix.rules.isEmail,on:{onChange:function(){this.getValue()&&!this.validate()?$$(e.form).markInvalid("fromEmail",i("Email is invalid")):$$(e.form).markInvalid("fromEmail",!1)}}},{id:e.toEmailsContainer,view:"forminput",name:"toEmails",label:i("Send"),css:"ab-rich-text",width:320,body:{width:320,rows:[{height:25},{id:e.toEmails,width:320,view:"layout",rows:[]},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:i("Add a recipient"),width:150,click:()=>{this.toEmailAdd()}}]}},{view:"text",name:"subject",label:i("Subject")},{id:e.message,view:"textarea",name:"message",label:i("Message"),width:320,height:400}]},{rows:[{view:"template",type:"header",template:"Fields"},{id:e.list,view:"list",width:120,css:{"background-color":"#fff !important;"},template:(e,t)=>this.fieldTemplate(e,t),on:{onItemClick:function(e){var i=this.getItem(e);t.enterField(i)}}}]}]}}init(e){this.AB=e;const t=this.ids;this.CurrentObject&&($$(t.list).parse(this.CurrentObject.fields((e=>e.fieldUseAsLabel()))),$$(t.list).refresh()),this.refreshUI()}fromSettings(e){super.fromSettings(e);let t=e.valueRules||{};$$(this.ids.form).setValues(t),(t.toEmails||[]).forEach((e=>{this.toEmailAdd({type:e.type,emailType:e.emailType,value:e.value})})),this.refreshUI()}toSettings(){const e=this.ids;var t=super.toSettings(),i=$$(e.form).getValues()||{},n=[];return $$(e.toEmails).getChildViews().forEach((e=>{var t=e.queryView({name:"emailType"}).getValue(),i=e.queryView({name:t}).getValue();n.push({type:"to",emailType:t,value:i})})),t.valueRules={fromName:i.fromName,fromEmail:i.fromEmail,toEmails:n,subject:i.subject,message:i.message},t}toEmailTemplate(e){const t=this;return{width:320,cols:[{view:"richselect",name:"emailType",value:(e=e||{}).emailType||"email",width:150,options:[{id:"email",value:i("A custom email address")},{id:"field",value:i("An email field")},{id:"query",value:i("From query")}],on:{onChange:function(e){t.emailTypeChange(e,this)}}},{width:150,name:"emailValue",visibleBatch:e.emailType||"email",cols:[{view:"text",name:"email",batch:"email",value:"email"==e.emailType?e.value:"",validate:webix.rules.isEmail,width:150,on:{onChange:()=>{this.toEmailValidate()}}},{view:"richselect",name:"field",batch:"field",value:"field"==e.emailType?e.value:"",width:150,suggest:{on:{onBeforeShow:function(){this.define("width",300),this.resize()}},data:this.emailFieldOptions()}},{view:"richselect",name:"query",batch:"query",value:"query"==e.emailType?e.value:"",width:150,suggest:{on:{onBeforeShow:function(){this.define("width",300),this.resize()}},data:this.queryOptions()}}]},{view:"button",css:"webix_danger",type:"icon",icon:"fa fa-trash-o",width:32,click:function(){var e=this.getParentView();t.toEmailRemove(e)}}]}}toEmailAdd(e){var t=$$(this.ids.toEmails).getChildViews().length;$$(this.ids.toEmails).addView(this.toEmailTemplate(e),t),this.refreshUI()}emailTypeChange(e,t){var n=t.getParentView().queryView({name:"emailValue"});switch(e){case"field":this.emailFieldOptions().length>0?n.showBatch("field"):(t.setValue("email"),webix.message(i("This form's chosen Datacollection has no Email Fields")));break;case"query":this.queryOptions().length>0?n.showBatch("query"):(t.setValue("email"),webix.message(i("There are no queries with Email Fields in this Application")));break;default:n.showBatch("email")}$$(this.ids.toEmailsContainer).adjust()}toEmailRemove(e){$$(this.ids.toEmails).removeView(e),this.refreshUI()}toEmailValidate(){let e=!0;$$(this.ids.toEmails).getChildViews().forEach((t=>{let i=t.queryView({name:"email"});i.getValue()&&!i.validate()&&(e=!1)})),e?$$(this.ids.form).markInvalid("toEmails",!1):$$(this.ids.form).markInvalid("toEmails",i("Email is invalid"))}fieldTemplate(e){return`<i class='fa fa-${e.icon} webix_icon_btn' aria-hidden='true'></i> ${e.label}`}emailFieldOptions(){var e=[],t=[],i=(e,i)=>{var n=e.fields((e=>"email"==e.key)).map((t=>{var n="",o="";return i?(n=`${i.id}|${t.urlPointer()}`,o=`${e.label}.${t.label} (${i.label})`):(n=`|${t.urlPointer()}`,o=`${e.label}.${t.label}`),{id:n,value:o}}));t=t.concat(n)};return i(this.CurrentObject),this.CurrentObject.connectFields().forEach((t=>{e.indexOf(t.id)>-1||(e.push(t.id),i(t.datasourceLink,t))})),t}queryOptions(){var e=[];return this.currentForm.application.datacollectionsIncluded((e=>{let t=e.datasource;return e.settings.isQuery&&t&&t.fields((e=>"email"==e.key)).length>0})).forEach((t=>{t.datasource&&t.datasource.fields((e=>"email"==e.key)).forEach((i=>{e.push({id:`${t.id}|${i.id}`,value:`${t.label}.${i.label}`})}))})),e}enterField(e){var t=webix.UIManager.getFocus(),i="";"text"==t.config.view&&"textarea"==t.config.view||(t.getValue&&(i=t.getValue()),t.setValue&&t.setValue(`${i}${e.label}`),webix.UIManager.setFocus(t))}refreshUI(){$$(this.ids.toEmailsContainer).adjust(),$$(this.ids.message).adjust()}}}(e);return new class extends i{constructor(e="ABViewRuleListFormSubmitRules"){super(e,{labels:{header:o("Submit Rules"),headerDefault:o("Submit Rules")}}),this.base=e}getRule(){var e=[new l(`${this.idBase}_ruleActionConfirmMessage`),new c(`${this.idBase}_ruleActionExistPage`),new d(`${this.idBase}_ruleActionParentPage`),new u(`${this.idBase}_ruleActionClosePopup`),new h(`${this.idBase}_ruleActionWebsite`),new p(`${this.idBase}_ruleActionEmail`)],t=new n(`${this.base}_rule`,e);return t.init(this.AB),t.objectLoad(this.CurrentObject),t.formLoad(this.currentForm),t}}(t)}(e,`${d}_popupSubmitRule`);return class extends t{constructor(){super(d,{datacollection:"",fields:"",showLabel:"",labelPosition:"",labelWidth:"",height:"",clearOnLoad:"",clearOnSave:"",buttonSubmitRules:"",buttonRecordRules:""}),this.AB=e,c=this.AB.Class.ABViewManager.viewClass("form").defaultValues()}static get key(){return"form"}ui(){let e=this.ids;return super.ui([{id:e.datacollection,view:"richselect",name:"datacollection",label:l("Datacollection"),labelWidth:i.labelWidthLarge,skipAutoSave:!0,on:{onChange:(e,t)=>{this.selectSource(e,t)}}},{view:"fieldset",label:l("Form Fields:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.fields,view:"list",name:"fields",select:!1,minHeight:200,template:(...e)=>this.listTemplate(...e),type:{markCheckbox:function(e){return"<span class='check webix_icon fa fa-"+(e.selected?"check-":"")+"square-o'></span>"}},onClick:{check:(...e)=>this.check(...e)}}]}},{id:e.showLabel,name:"showLabel",view:"checkbox",label:l("Display Label"),labelWidth:i.labelWidthLarge,click:()=>{this.onChange()}},{id:e.labelPosition,view:"richselect",name:"labelPosition",label:l("Label Position"),labelWidth:i.labelWidthLarge,options:[{id:"left",value:l("Left")},{id:"top",value:l("Top")}],on:{onChange:()=>{this.onChange()}}},{id:e.labelWidth,view:"counter",name:"labelWidth",label:l("Label Width"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.height,view:"counter",name:"height",label:l("Height"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.clearOnLoad,view:"checkbox",name:"clearOnLoad",label:l("Clear on load"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.clearOnSave,view:"checkbox",name:"clearOnSave",label:l("Clear on save"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{view:"fieldset",label:l("Rules:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:l("Submit Rules:"),width:i.labelWidthLarge},{id:e.buttonSubmitRules,view:"button",css:"webix_primary",name:"buttonSubmitRules",label:l("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:()=>{this.submitRuleShow()}}]},{cols:[{view:"label",label:l("Record Rules:"),width:i.labelWidthLarge},{id:e.buttonRecordRules,view:"button",name:"buttonRecordRules",css:"webix_primary",label:l("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:()=>{this.recordRuleShow()}}]}]}}])}async init(e){super.init(e),webix.extend($$(this.ids.component),webix.ProgressBar);let t=[];return t.push(u.init(e)),u.on("save",(()=>{this.onChange(),this.populateBadgeNumber()})),t.push(h.init(e)),h.on("save",(()=>{this.onChange(),this.populateBadgeNumber()})),Promise.all(t)}populate(e){super.populate(e);let t=this.ids;if(!e)return;let i=e.parentFormComponent(),n=i.settings.dataviewID?i.settings.dataviewID:null;var o=$$(t.datacollection),a=e.application.datacollectionsIncluded().filter((e=>{var t=e.datasource;return"object"==e.sourceType&&t&&!t.isImported})).map((e=>{let t={id:e.id,value:e.label};return"query"==e.sourceType?t.icon="fa fa-filter":t.icon="fa fa-database",t}));o.define("options",a),o.define("value",n),o.refresh(),this.propertyUpdateFieldOptions(n),e.views().forEach((t=>{t instanceof this.AB.Class.ABViewFormItem&&t.once("destroyed",(()=>this.populate(e)))})),o.enable(),$$(t.showLabel).setValue(e.settings.showLabel),$$(t.labelPosition).setValue(e.settings.labelPosition||c.labelPosition),$$(t.labelWidth).setValue(e.settings.labelWidth||c.labelWidth),$$(t.height).setValue(e.settings.height||c.height),$$(t.clearOnLoad).setValue(e.settings.clearOnLoad||c.clearOnLoad),$$(t.clearOnSave).setValue(e.settings.clearOnSave||c.clearOnSave),u.objectLoad(this.CurrentObject),u.viewLoad(e),u.fromSettings(e.settings.recordRules||[]),h.objectLoad(this.CurrentObject),h.viewLoad(e),h.fromSettings(e.settings.submitRules||[]),this.populateBadgeNumber(),this.updateEventIds=this.updateEventIds||{},this.updateEventIds[e.id]||(this.updateEventIds[e.id]=!0,e.addListener("properties.updated",(()=>{this.populateBadgeNumber()})))}defaultValues(){let e={};var t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){let e=this.ids,t=super.values();return t.settings=t.settings||{},t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.showLabel=$$(e.showLabel).getValue(),t.settings.labelPosition=$$(e.labelPosition).getValue()||c.labelPosition,t.settings.labelWidth=$$(e.labelWidth).getValue()||c.labelWidth,t.settings.height=$$(e.height).getValue(),t.settings.clearOnLoad=$$(e.clearOnLoad).getValue(),t.settings.clearOnSave=$$(e.clearOnSave).getValue(),t.settings.recordRules=u.toSettings(),t.settings.submitRules=h.toSettings(),t}ViewClass(){return super._ViewClass("carousel")}busy(){$$(this.ids.component)?.showProgress?.({type:"icon"})}check(e,t){const i=this.ids;let n=this.CurrentView,o=n.parentFormComponent(),a=$$(i.fields).getItem(t);a.selected=a.selected?0:1,$$(i.fields).updateItem(t,a);let s=()=>{o.refreshDefaultButton(i).save().then((()=>{n.emit("properties.updated",n),this.onChange()}))};if(a.selected){let e=n.addFieldToForm(a);e&&e.save().then((()=>{e.once("destroyed",(()=>this.populate(n))),n.viewInsert(e).then((()=>{s()}))}))}else{let e=o.fieldComponents().filter((e=>e.settings.fieldId==t))[0];e&&(e.destroy(),n.viewRemove(e).then((()=>{s()})))}}populateBadgeNumber(){const e=this.ids;let t=this.CurrentView;t&&(t.settings.submitRules?$$(e.buttonSubmitRules).define("badge",t.settings.submitRules.length||null):$$(e.buttonSubmitRules).define("badge",null),$$(e.buttonSubmitRules).refresh(),t.settings.recordRules?$$(e.buttonRecordRules).define("badge",t.settings.recordRules.length||null):$$(e.buttonRecordRules).define("badge",null),$$(e.buttonRecordRules).refresh())}ready(){$$(this.ids.component)?.hideProgress?.()}recordRuleShow(){u.fromSettings(this.CurrentView.settings.recordRules),u.show()}submitRuleShow(){h.fromSettings(this.CurrentView.settings.submitRules),h.show()}listTemplate(e,t){let i=this.CurrentView;var n=e.formComponent();if(null==n)return`<i class='fa fa-times'></i>  ${e.label} <div class='ab-component-form-fields-component-info'> Disable </div>`;var o=n.common().key,a=i.application.viewAll((e=>e.common().key==o))[0];return`${t.markCheckbox(e)} ${e.label} <div class='ab-component-form-fields-component-info'> <i class='fa fa-${a?a.common().icon:"fw"}'></i> ${a?l(a.common().labelKey):""} </div>`}propertyUpdateFieldOptions(e){const t=this.ids;var i=this.CurrentView.parentFormComponent().fieldComponents(),n=this.AB.datacollectionByID(e),o=n?n.datasource:null,a=[];null!=o&&(a=o.fields().map((e=>(e.selected=i.filter((t=>e.id==t.settings.fieldId)).length>0,e))),this.objectLoad(o)),$$(t.fields).clearAll(),$$(t.fields).parse(a)}refreshDefaultButton(){const e=this.ids,t=this.AB.Class.ABViewManager.viewClass("button");let i=this.views((e=>e instanceof t&&e.settings.isDefault))[0];null==i?(i=t.newInstance(this.application,this),i.settings.isDefault=!0):this._views=this.views((e=>!(e instanceof t||e.settings.isDefault)));let n=this.views().map((e=>(e.position.y||0)+1));n.push(this._views.length||0),n.push($$(e.fields).length||0);let o=Math.max(...n);return i.position.y=o,this._views.push(i),i}selectSource(e){const t=this.ids;this.busy();let i=this.CurrentView,n=i.parentFormComponent();i.settings.dataviewID=e;var o=i._views;return i._views=[],Promise.resolve().then((()=>{var e=[];return o.forEach((t=>{e.push(t.destroy())})),Promise.all(e)})).then((()=>{if(this.propertyUpdateFieldOptions(e),i._views.length>0)return Promise.resolve();let o=[],a=$$(t.fields).find({});a.reverse(),a.forEach(((e,n)=>{if(!e.selected){let s=a.length-n-1,r=i.addFieldToForm(e,s);r&&(r.once("destroyed",(()=>this.populate(i))),o.push(r.save())),e.selected=1,$$(t.fields).updateItem(e.id,e)}}));let s=n.refreshDefaultButton(t);return s&&o.push(s.save()),Promise.all(o)})).then((()=>i.save())).then((()=>(n.emit("properties.updated",i),this.ready(),this.onChange(),Promise.resolve())))}}}},3020:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_button",{includeSave:"",saveLabel:"",includeCancel:"",cancelLabel:"",includeReset:"",resetLabel:"",afterCancel:"",alignment:""}),this.AB=e}static get key(){return"button"}ui(){const e=this.ids,t=this.AB.UISettings.config();return super.ui([{id:e.includeSave,name:"includeSave",view:"checkbox",label:i("Save"),click:()=>this.onChange()},{id:e.saveLabel,name:"saveLabel",view:"text",labelWidth:t.labelWidthLarge,label:i("Save Label"),placeholder:i("Save Placeholder"),on:{onChange:()=>this.onChange()}},{id:e.includeCancel,name:"includeCancel",view:"checkbox",label:i("Cancel"),click:()=>this.onChange()},{id:e.cancelLabel,name:"cancelLabel",view:"text",labelWidth:t.labelWidthLarge,label:i("Cancel Label"),placeholder:i("Cancel Placeholder"),on:{onChange:()=>this.onChange()}},{id:e.includeReset,name:"includeReset",view:"checkbox",label:i("Reset"),click:()=>this.onChange()},{id:e.resetLabel,name:"resetLabel",view:"text",labelWidth:t.labelWidthLarge,label:i("Reset Label"),placeholder:i("Reset Placeholder"),on:{onChange:()=>this.onChange()}},{id:e.afterCancel,name:"afterCancel",view:"richselect",labelWidth:t.labelWidthLarge,label:i("After Cancel"),on:{onChange:()=>this.onChange()}},{id:e.alignment,name:"alignment",view:"richselect",labelWidth:t.labelWidthLarge,label:i("Alignment"),options:[{id:"left",value:i("Left")},{id:"center",value:i("Center")},{id:"right",value:i("Right")}],on:{onChange:()=>this.onChange()}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues(),n=[];this.addPagesToList(n,e.application,e.pageRoot().id);const o=n.map((e=>({id:e.id,value:e.value})));$$(t.afterCancel).define("options",o),$$(t.includeSave).setValue(null!=e.settings.includeSave?e.settings.includeSave:i.includeSave),$$(t.includeCancel).setValue(null!=e.settings.includeCancel?e.settings.includeCancel:i.includeCancel),$$(t.includeReset).setValue(null!=e.settings.includeReset?e.settings.includeReset:i.includeReset),$$(t.saveLabel).setValue(e.settings.saveLabel??""),$$(t.cancelLabel).setValue(e.settings.cancelLabel??""),$$(t.resetLabel).setValue(e.settings.resetLabel??""),$$(t.afterCancel).setValue(e.settings.afterCancel??i.afterCancel),$$(t.alignment).setValue(e.settings.alignment??i.alignment)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.includeSave=$$(e.includeSave).getValue(),i.settings.saveLabel=$$(e.saveLabel).getValue(),i.settings.includeCancel=$$(e.includeCancel).getValue(),i.settings.cancelLabel=$$(e.cancelLabel).getValue(),i.settings.includeReset=$$(e.includeReset).getValue(),i.settings.resetLabel=$$(e.resetLabel).getValue(),i.settings.afterCancel=$$(e.afterCancel).getValue(),i.settings.alignment=$$(e.alignment).getValue(),i}ViewClass(){return super._ViewClass("button")}addPagesToList(e,t,i){t&&t.pages&&e&&(t.pages()??[]).forEach((t=>{null==t.parent&&t.id!=i||(e.push({id:t.id,value:t.label}),this.addPagesToList(e,t,t.id))}))}}}},2480:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(){super("properties_abview_form_checkbox",{}),this.AB=e}static get key(){return"checkbox"}}}},2318:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var n=i(4412),o=i(423),a=i(3285);let s=null,r=null;function l(e){const t="properties_abview_connect",i=(0,n.Z)(e),l=function(e,t){if(!s){const t="properties_abview_connect_viewpropertyaddpage",i=(0,a.Z)(e),n=i.L();s=class extends i{static get default(){return{formView:"none"}}constructor(){super(t,{formView:""}),this.AB=e}ui(){const e=this.ids;return{id:e.formView,name:"formView",view:"richselect",label:n("Add New Form"),labelWidth:this.AB.UISettings.config().labelWidthXLarge,on:{onChange:(t,i)=>{t==n("No add new option")&&$$(e.formView).setValue(""),this.emit("change")}}}}setSettings(e,t={}){if(null==e)return;let i=[{id:"none",value:n("No add new option")}];const o=e.pageRoot().pages((t=>t.views((t=>"form"==t?.key&&t?.datacollection?.datasource?.id==e.field().settings.linkObject),!0).length),!0).map((e=>({id:e.id,value:e.label})));i=i.concat(o);const a=$$(this.ids.formView);a&&(a.define("options",i),a.define("value",t.formView??this.constructor.default.formView),a.refresh())}getSettings(e){const t=e.settings??{};return t.formView=$$(this.ids.formView).getValue(),t}}}return s}(e),c=function(e,t){if(!r){const t="properties_abview_connect_viewpropertyeditpage",i=(0,a.Z)(e),n=i.L();r=class extends i{static get default(){return{editForm:"none"}}constructor(){super(t,{formEdit:""}),this.AB=e}ui(){const e=this.ids;return{id:e.formEdit,name:"editForm",view:"richselect",label:n("Edit Form"),labelWidth:this.AB.UISettings.config().labelWidthXLarge,on:{onChange:(t,i)=>{t==n("No add new option")&&$$(e.formEdit).setValue(""),this.emit("change")}}}}setSettings(e,t={}){if(null==e)return;const i=[{id:"none",value:n("No add new option")}];(e.pageRoot().pages((()=>!0),!0)??[]).forEach((t=>{t&&t.views((()=>!0),!0).forEach((n=>{"form"==n?.key&&n?.datacollection?.datasource?.id==e.field().settings.linkObject&&i.push({id:n.urlPointer(),value:`${t.label} - ${n.label}`})}))}));const o=$$(this.ids.formEdit);o&&(o.define("options",i),o.define("value",t.editForm??this.constructor.default.editForm),o.refresh())}getSettings(e){const t=e.settings||{},i=$$(this.ids.formEdit),n=(i.getPopup().config.body.data??[]).filter((e=>e.id==i.getValue()))[0];return n&&(t.editForm=n.id),t}}}return r}(e),d=i.L();let u=null,h=null;return class extends i{constructor(){super(t,{addNewSettings:"",popupWidth:"",popupHeight:"",advancedOption:"",buttonFilter:"",filterConnectedValue:"",buttonSort:""}),this.AB=e,u=this.AB.filterComplexNew(`${t}_filter`),u.on("save",(()=>this.onChange())),h=(0,o.Z)(this.AB,`${t}_sort`),h.on("changed",(()=>this.onChange()))}static get key(){return"connect"}ui(){const e=this,t=this.ids,i=this.AB.UISettings.config();return super.ui([this.addPageProperty.ui(),this.editPageProperty.ui(),{id:t.addNewSettings,view:"fieldset",name:"addNewSettings",label:d("Add New Popup Settings:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:t.popupWidth,view:"text",name:"popupWidth",placeholder:d("Set popup width"),label:d("Width:"),labelWidth:i.labelWidthLarge,validate:this.AB.Webix.rules.isNumber,on:{onChange:()=>this.onChange()}},{id:t.popupHeight,view:"text",name:"popupHeight",placeholder:d("Set popup height"),label:d("Height:"),labelWidth:i.labelWidthLarge,validate:this.AB.Webix.rules.isNumber,on:{onChange:()=>this.onChange()}}]}},{id:t.advancedOption,view:"fieldset",name:"advancedOption",label:d("Advanced Options:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:d("Filter Options:"),width:i.labelWidthLarge},{id:t.buttonFilter,view:"button",name:"buttonFilter",css:"webix_primary",label:d("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:function(){e.showFilterPopup(this.$view)}}]},{rows:[{view:"label",label:d("Filter by Connected Field Value:")},{id:t.filterConnectedValue,view:"combo",name:"filterConnectedValue",options:[],on:{onChange:()=>this.onChange()}}]},{height:30},{rows:[{cols:[{view:"label",label:d("Sort Options:"),width:i.labelWidthLarge},{id:t.buttonSort,view:"button",name:"buttonSort",css:"webix_primary",label:d("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:function(){e.showSortPopup(this.$view)}}]}]}]}}])}async init(e){this.AB=e,await super.init(e),u.init(),h.init(e),this.addPageProperty.on("change",(()=>{this.onChange()})),this.editPageProperty.on("change",(()=>{this.onChange()}))}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues(),n=[{id:null,value:""}],o=this.AB.definitionByID(e.settings.fieldId),a=this.AB.definitionByID(o.settings.linkObject),s=[];a.fieldIDs.forEach((e=>{s.push(this.AB.definitionByID(e))}));const r=e.application.connectedObjects(o.settings.linkObject);e.parent.views().forEach((t=>{if("connect"==t.key){const i=this.AB.definitionByID(t.settings.fieldId);r.forEach((o=>{if(o.id==i.settings.linkObject){let o;if(s.forEach((e=>{if(e.settings.isCustomFK&&""!=e.settings.indexField&&e.settings.linkObject&&"one"==e.settings.linkType&&e.settings.linkObject==i.settings.linkObject){o=e.id;let t=this.AB.definitionByID(e.settings.indexField);t&&(o=`${e.id}:${t.columnName}`)}else e.settings.linkObject&&"one"==e.settings.linkType&&e.settings.linkObject==i.settings.linkObject&&(o=`${e.id}:uuid`)})),o){const i=e.parent.viewComponents[t.id].ui(),a=i.rows[0]??i;n.push({id:`${a.name}:${o}`,value:a.label})}}}))}})),this.addPageProperty.setSettings(e,{formView:e.settings.formView}),this.editPageProperty.setSettings(e,{editForm:e.settings.editForm}),$$(t.filterConnectedValue).define("options",n),$$(t.filterConnectedValue).setValue(e.settings.filterConnectedValue),$$(t.popupWidth).setValue(e.settings.popupWidth||i.popupWidth),$$(t.popupHeight).setValue(e.settings.popupHeight||i.popupHeight),this.populatePopupEditors(e),this.populateBadgeNumber(t,e)}populatePopupEditors(e){const t=e?.settings?.filterConditions??this.defaultValues().filterConditions;let i;const n=e.field();n&&(i=n.datasourceLink,i&&u.fieldsLoad(i.fields(),i)),u.setValue(t),i&&h.objectLoad(i),h.setSettings(e.settings.sortFields)}populateBadgeNumber(e,t){const i=$$(e.buttonFilter);t?.settings?.filterConditions?.rules?(i.define("badge",t.settings.filterConditions.rules.length||null),i.refresh()):(i.define("badge",null),i.refresh());const n=$$(e.buttonSort);t?.settings?.sortFields?.length?(n.define("badge",t.settings.sortFields.length||null),n.refresh()):(n.define("badge",null),n.refresh())}values(){const e=this.ids,t=this.CurrentView,i=$$(e.component),n=super.values()??{};n.settings=i.getValues()??{},n.settings.popupWidth=$$(e.popupWidth).getValue(),n.settings.popupHeight=$$(e.popupHeight).getValue(),n.settings.filterConnectedValue=$$(e.filterConnectedValue).getValue(),n.settings.filterConditions=u.getValue(),n.settings.sortFields=h.getSettings();const o=this.addPageProperty.getSettings(t)??{},a=this.editPageProperty.getSettings(t)??{};return n.settings.formView=o.formView,n.settings.editForm=a.editForm,n}ViewClass(){return super._ViewClass("connect")}get addPageProperty(){return this._addPage||(this._addPage=new l),this._addPage}get editPageProperty(){return this._editPage||(this._editPage=new c),this._editPage}showFilterPopup(e){u.popUp(e,null,{pos:"top"})}showSortPopup(e){h.show(e,null,{pos:"top"})}}}},1722:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(){super("properties_abview_form_custom",{}),this.AB=e}static get key(){return"fieldcustom"}}}},6929:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(){super("properties_abview_form_datepicker",{}),this.AB=e}static get key(){return"datepicker"}}}},4412:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L(),o={required:0,disable:0};return class extends t{constructor(t,i={}){super(t,Object.assign(i,{field:"",required:"",disable:""})),this.AB=e}ui(e=[],t={}){const n=this.ids,o=this.AB.UISettings.config(),a=[{id:n.field,name:"fieldLabel",view:"text",disabled:!0,label:i("Field")},{id:n.required,name:"required",view:"checkbox",labelWidth:o.labelWidthCheckbox,labelRight:i("Required"),click:()=>this.onChange()},{id:n.disable,name:"disable",view:"checkbox",labelWidth:o.labelWidthCheckbox,labelRight:i("Disable"),click:()=>this.onChange()}].concat(e);return super.ui(a,t)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues(),n=e.field();$$(t.field).setValue(n?n.label:""),1==n?.settings?.required?($$(t.required).setValue(n.settings.required),$$(t.required).disable()):$$(t.required).setValue(null!=e.settings?.required?e.settings.required:i.required),1==e.settings?.disable?$$(t.disable).setValue(e.settings.disable):$$(t.disable).setValue(i.disable)}defaultValues(){const e=this.ViewClass();let t={};return e&&(t=e.defaultValues()),Object.assign(o,t)}values(){const e=this.ids,t=super.values()??{};return t.settings=t.settings??{},t.settings.required=$$(e.required).getValue(),t.settings.disable=$$(e.disable).getValue(),t}}}},5670:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_form_json",{type:"",filterField:""}),this.AB=e}static get key(){return"json"}ui(){const e=this.ids;return super.ui([{id:e.type,name:"type",view:"radio",label:i("Type"),vertical:!0,options:[{id:"string",value:i("JSON String")},{id:"systemObject",value:i("System Object Chooser UI")},{id:"filter",value:i("Filter UI")}],on:{onChange:t=>{"filter"==t?$$(e.filterField).show():$$(e.filterField).hide(),this.onChange()}}},{id:e.filterField,name:"filterField",view:"combo",hidden:!0,label:i("Object Field to Filter"),labelPosition:"top",placeholder:i("Select a field to filter by"),on:{onChange:e=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues();let n=[{id:"",value:""}];e.parent.views().forEach((t=>{if("json"==t.key&&"systemObject"==t.settings.type){let i=e.parent.viewComponents[t.id];n.push({id:t.settings.fieldId,value:i.settings.fieldLabel})}})),$$(t.filterField).define("options",n),e.settings.filterField&&$$(t.filterField).setValue(e.settings.filterField),$$(t.type).setValue(e.settings.type||i.type)}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.type=$$(e.type).getValue(),i}ViewClass(){return super._ViewClass("json")}}}},6378:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_form_number",{isStepper:""}),this.AB=e}static get key(){return"numberbox"}ui(){const e=this.ids,t=this.AB.UISettings.config();return super.ui([{id:e.isStepper,name:"isStepper",view:"checkbox",labelWidth:t.labelWidthCheckbox,labelRight:i("Plus/Minus Buttons"),on:{onChange:()=>this.onChange()}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues();$$(t.isStepper).setValue(null!=e.settings.isStepper?e.settings.isStepper:i.isStepper)}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.isStepper=$$(e.isStepper).getValue(),i}ViewClass(){return super._ViewClass("numberbox")}}}},7754:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_form_select_multiple",{type:""}),this.AB=e}static get key(){return"selectmultiple"}ui(){const e=this.ids;return super.ui([{id:e.type,name:"type",view:"richselect",label:i("Type"),options:[{id:"multicombo",value:i("Multi Combo")},{id:"checkbox",value:i("Checkboxes")}],on:{onChange:()=>this.onChange()}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues();$$(t.type).setValue(e.settings.type||i.type)}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.type=$$(e.type).getValue(),i}ViewClass(){return super._ViewClass("selectmultiple")}}}},9720:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_form_select_single",{type:""}),this.AB=e}static get key(){return"selectsingle"}ui(){const e=this.ids;return super.ui([{id:e.type,name:"type",view:"richselect",label:i("Type"),options:[{id:"richselect",value:i("Select list")},{id:"radio",value:i("Radio")}],on:{onChange:()=>this.onChange()}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues();$$(t.type).setValue(e.settings.type||i.type)}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.type=$$(e.type).getValue(),i}ViewClass(){return super._ViewClass("selectsingle")}}}},2651:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_form_textbox",{type:""}),this.AB=e}static get key(){return"textbox"}ui(){const e=this.ids;return super.ui([{id:e.type,name:"type",view:"radio",label:i("Type"),vertical:!0,options:[{id:"single",value:i("Single line")},{id:"multiple",value:i("Multiple lines")},{id:"rich",value:i("Rich editor")}],on:{onChange:()=>this.onChange()}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=this.defaultValues();$$(t.type).setValue(e.settings.type||i.type)}values(){const e=this.ids,t=$$(e.component),i=super.values()??{};return i.settings=t.getValues()??{},i.settings.type=$$(e.type).getValue(),i}ViewClass(){return super._ViewClass("textbox")}}}},9975:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(4412);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(){super("properties_abview_form_tree",{}),this.AB=e}static get key(){return"formtree"}}}},5177:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(2418),o=i(4550),a=i(2439);function s(e){const t="properties_abview_gantt",i=(0,n.Z)(e),s=e.Config.uiSettings(),r=i.L(),l=(0,o.Z)(e,`${t}_workspaceView_gantt`);return class extends i{constructor(){super(t,{dataviewID:"",fields:""}),this.AB=e}static get key(){return"gantt"}ui(){const e=this.ids;return super.ui([{view:"fieldset",label:`${r("Gantt Data")}:`,labelWidth:s.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.dataviewID,view:"richselect",name:"dataviewID",label:`${r("Datacollection")}:`,labelWidth:s.labelWidthLarge,on:{onChange:(e,t)=>{e!==t&&(l.emit("dc.changed",e,this.CurrentView),this.onChange())}}}]}},{view:"fieldset",label:`${r("Gantt Fields")}:`,labelWidth:s.labelWidthLarge,body:{id:e.fields,view:"form",name:"fields",borderless:!0,elements:[l.ui()],on:{onChange:()=>{this.onChange()}}}}])}async init(e){this.AB=e,this.PopupNewDataFieldComponent=(0,a.Z)(e,`${t}_popupNewDataField`),await this.PopupNewDataFieldComponent.init(e),this.PopupNewDataFieldComponent.on("save",((...e)=>{l.emit("field.added",e[0])})),l.on("dc.changed",((e,t)=>{const i=this.AB.datacollectionByID(e);l.init(i.datasource,t),this.PopupNewDataFieldComponent.objectLoad(i.datasource)})),l.on("new.field",(e=>{this.PopupNewDataFieldComponent.show(null,e,!1)})),await super.init(e)}populateDataview(){const e=this.AB.Account.isSystemDesigner()?e=>!e.isSystemObject:()=>!0,t=this.CurrentApplication.datacollectionsIncluded(e),i=$$(this.ids.dataviewID);i.define("options",t.map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})))),i.refresh()}populate(e){super.populate(e);const t=this.ids,i=$$(t.component),n=this.defaultValues(),o=Object.assign(i.getValues(),n,e.settings);this.populateDataview(),i.setValues(o);let a=this.AB.datacollectionByID(o.dataviewID);a&&(l.init(a.datasource,this.CurrentView),this.PopupNewDataFieldComponent.objectLoad(a.datasource))}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=super.values(),t=this.ids;return e.settings=Object.assign($$(t.component).getValues(),$$(t.fields).getValues()),e}ViewClass(){return super._ViewClass("gantt")}}}},4973:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var n=i(2418),o=i(3285),a=i(5997),s=i(6038),r=i(4245),l=i(8782);function c(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),c=t.L(),d="properties_abview_grid",u=new((0,r.Z)(e,d))({isGrid:!0}),h=new l.Z(e,d);return class extends t{constructor(){super(d,{isEditable:"",massUpdate:"",allowDelete:"",isSortable:"",isExportable:"",datacollection:"",groupBy:"",groupByList:"",buttonFieldsVisible:"",buttonFieldsFreeze:"",buttonSummaryFields:"",buttonCountFields:"",height:"",hideHeader:"",labelAsField:"",hideButtons:""}),this._preFilterSettings=null,this.linkPageComponent=new h,this.PopupCountColumnsComponent=function(e,t){t=t||"ui_work_object_workspace_popupCountColumns";const i=(0,o.Z)(e);var n=i.L();return new class extends i{constructor(e){super(e,{list:""}),this.CountFieldIds=[]}ui(){const e=this.ids;return{id:e.component,view:"popup",body:{rows:[{cols:[{view:"button",css:"webix_primary",value:n("Select All"),on:{onItemClick:()=>{this.clickShowAll()}}},{view:"button",value:n("Unselect All"),on:{onItemClick:()=>{this.clickHideAll()}}}]},{id:e.list,view:"list",maxHeight:250,select:!1,template:'<span style="min-width: 18px; display: inline-block;"><i class="fa ab-count-field-icon"></i>&nbsp;</span> #label#',on:{onItemClick:(e,t,i)=>{this.clickListItem(e,t,i)}}}]},on:{onShow:()=>{this.onShow()}}}}init(e){return this.AB=e,webix.ui(this.ui()),Promise.resolve()}onChange(){this.emit("changed",this.CountFieldIds)}clickHideAll(){var e=$$(this.ids.list);this.CountFieldIds=[],e.find({}).forEach((e=>{this.iconHide(e.id)})),this.onChange()}clickShowAll(){var e=$$(this.ids.list);this.CountFieldIds=e.find({}).map((e=>e.id)),e.find({}).forEach((e=>{this.iconShow(e.id)})),this.onChange()}clickListItem(e){this.CountFieldIds.indexOf(e)<0?(this.CountFieldIds.push(e),this.iconShow(e)):(this.CountFieldIds=this.CountFieldIds.filter((t=>t!=e)),this.iconHide(e)),this.onChange()}getValue(){return this.CountFieldIds}iconHide(e){var t=$$(this.ids.list).getItemNode(e);t&&t.querySelector(".ab-count-field-icon").classList.remove("fa-circle")}iconShow(e){var t=$$(this.ids.list).getItemNode(e);t&&t.querySelector(".ab-count-field-icon").classList.add("fa-circle")}setValue(e){this.CountFieldIds=e||[],this.onShow()}onShow(){var e=this.CurrentObject.fields().map((e=>({id:e.id,label:e.label})));$$(this.ids.list).clearAll(),$$(this.ids.list).parse(e),this.CountFieldIds.forEach((e=>{this.iconShow(e)}))}show(...e){$$(this.ids.component).show(...e)}}(t)}(e,`${d}_count`),this.PopupCountColumnsComponent.on("changed",(e=>{this.badgesCount(e),this.onChange()})),this.PopupFrozenColumnsComponent=new a.Z(e,`${d}_frozenFields`),this.PopupFrozenColumnsComponent.on("changed",(e=>{this.badgesFrozen(e),this.PopupHideFieldComponent.setFrozenColumnID(e),this.onChange()})),this.PopupHideFieldComponent=(0,s.Z)(e,`${d}_hideFields`),this.PopupHideFieldComponent.on("changed",((e=[])=>{this.badgesHidden(e),this.PopupFrozenColumnsComponent.setHiddenFields(e),this.onChange()})),this.PopupSummaryColumnsComponent=function(e,t){t=t||"ui_work_object_workspace_popupSummaryColumns";const i=(0,o.Z)(e);var n=i.L();return new class extends i{constructor(t){super(t,{list:""}),this.ABFieldNumber=e.Class.ABFieldManager.fieldByKey("number"),this.ABFieldFormula=e.Class.ABFieldManager.fieldByKey("formula"),this.ABFieldCalculate=e.Class.ABFieldManager.fieldByKey("calculate"),this.SummaryFieldIds=[]}ui(){const e=this.ids;return{view:"popup",id:e.component,body:{rows:[{cols:[{view:"button",value:n("Select All"),on:{onItemClick:()=>{this.clickHideAll()}}},{view:"button",css:"webix_primary",value:n("Unselect All"),on:{onItemClick:()=>{this.clickShowAll()}}}]},{view:"list",id:e.list,maxHeight:250,select:!1,template:'<span style="min-width: 18px; display: inline-block;"><i class="fa ab-summary-field-icon"></i>&nbsp;</span> #label#',on:{onItemClick:(e,t,i)=>{this.clickListItem(e,t,i)}}}]},on:{onShow:()=>{this.onShow()}}}}init(e){return this.AB=e,webix.ui(this.ui()),Promise.resolve()}clickHideAll(){var e=$$(this.ids.list);this.SummaryFieldIds=[],e.find({}).forEach((e=>{this.iconHide(e.id)})),this.emit("changed",this.SummaryFieldIds)}clickShowAll(){var e=$$(this.ids.list);this.SummaryFieldIds=e.find({}).map((e=>e.id)),e.find({}).forEach((e=>{this.iconShow(e.id)})),this.emit("changed",this.SummaryFieldIds)}clickListItem(e){this.SummaryFieldIds.indexOf(e)<0?(this.SummaryFieldIds.push(e),this.iconShow(e)):(this.SummaryFieldIds=this.SummaryFieldIds.filter((t=>t!=e)),this.iconHide(e)),this.emit("changed",this.SummaryFieldIds)}getValue(){return this.SummaryFieldIds}iconHide(e){var t=$$(this.ids.list).getItemNode(e);t&&t.querySelector(".ab-summary-field-icon").classList.remove("fa-circle")}iconShow(e){var t=$$(this.ids.list).getItemNode(e);t&&t.querySelector(".ab-summary-field-icon").classList.add("fa-circle")}setValue(e){this.SummaryFieldIds=e||[],this.onShow()}onShow(){const e=this.ids;var t=this.CurrentObject.fields((e=>e instanceof this.ABFieldNumber)).map((e=>({id:e.id,label:e.label}))),i=this.CurrentObject.fields((e=>e instanceof this.ABFieldCalculate)).map((e=>({id:e.id,label:e.label}))),n=this.CurrentObject.fields((e=>e instanceof this.ABFieldFormula)).map((e=>({id:e.id,label:e.label}))),o=t.concat(i);o=o.concat(n),$$(e.list).clearAll(),$$(e.list).parse(o),this.SummaryFieldIds.forEach((e=>{this.iconShow(e)}))}show(...e){$$(this.ids.component).show(...e)}}(t)}(e,`${d}_summary`),this.PopupSummaryColumnsComponent.on("changed",(e=>{this.badgesSummary(e),this.onChange()}))}static get key(){return"grid"}ui(){let e=this.ids,t=this;return super.ui([{view:"fieldset",label:c("Grid Properties:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.isEditable,view:"checkbox",name:"isEditable",labelRight:c("User can edit in grid."),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.massUpdate,view:"checkbox",name:"massUpdate",labelRight:c("User can edit multiple items at one time."),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.allowDelete,view:"checkbox",name:"allowDelete",labelRight:c("User can delete records."),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.isSortable,view:"checkbox",name:"isSortable",labelRight:c("User can sort records."),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.isExportable,view:"checkbox",name:"isExportable",labelRight:c("User can export."),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}}]}},{view:"fieldset",label:c("Grid Data:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.datacollection,view:"richselect",name:"datacollection",label:c("Datacollection:"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:(t,i)=>{if(t!=i){this.linkPageComponent.clear();let i=this.CurrentView?.AB.datacollectionByID(t);i&&"query"==i.sourceType?($$(e.isEditable).setValue(!1),$$(e.massUpdate).setValue(!1),$$(e.allowDelete).setValue(!1),$$(e.isEditable).disable(),$$(e.massUpdate).disable(),$$(e.allowDelete).disable()):($$(e.isEditable).enable(),$$(e.massUpdate).enable(),$$(e.allowDelete).enable()),this.refreshGroupBy(i),this.onChange()}}}}]}},{view:"fieldset",label:c("Group:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.groupBy,view:"multiselect",name:"groupBy",label:c("Group by:"),labelWidth:i.labelWidthLarge,options:[],on:{onChange:e=>{this.refreshGroupByList(e),this.onChange()}}},{id:e.groupByList,view:"list",name:"groupByList",drag:!0,data:[],height:200,template:"<span class='fa fa-sort'></span>&nbsp;&nbsp; #value#",on:{onAfterDrop:()=>{this.onChange()}}}]}},this.linkPageComponent.ui(),{view:"fieldset",label:c("Customize Display:"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{cols:[{view:"label",label:c("Hidden Fields:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.buttonFieldsVisible,view:"button",name:"buttonFieldsVisible",label:c("Settings"),icon:"fa fa-gear",type:"icon",click:function(){t.PopupHideFieldComponent.show(this.$view)}}]},{cols:[{view:"label",label:c("Filter Option:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.buttonFilterData,view:"button",name:"buttonFilterData",label:c("Settings"),icon:"fa fa-gear",type:"icon",click:()=>{this.filter_property_popup.show()}}]},{cols:[{view:"label",label:c("Freeze Columns:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.buttonFieldsFreeze,view:"button",name:"buttonFieldsFreeze",label:c("Settings"),icon:"fa fa-gear",type:"icon",click:function(){t.PopupFrozenColumnsComponent.show(this.$view)}}]},{cols:[{view:"label",label:c("Summary Fields:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.buttonSummaryFields,view:"button",name:"buttonSummaryFields",label:c("Settings"),icon:"fa fa-gear",type:"icon",click:function(){t.PopupSummaryColumnsComponent.show(this.$view)}}]},{cols:[{view:"label",label:c("Count Fields:"),css:"ab-text-bold",width:i.labelWidthXLarge},{id:e.buttonCountFields,view:"button",name:"buttonCountFields",label:c("Settings"),icon:"fa fa-gear",type:"icon",click:function(){t.PopupCountColumnsComponent.show(this.$view)}}]},{id:e.height,view:"counter",name:"height",label:c("Height:"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{id:e.hideHeader,view:"checkbox",name:"hideHeader",labelRight:c("Hide table header"),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.labelAsField,view:"checkbox",name:"labelAsField",labelRight:c("Show a field using label template"),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}},{id:e.hideButtons,view:"checkbox",name:"hideButtons",labelRight:c("Hide edit and view buttons"),labelWidth:i.labelWidthCheckbox,click:()=>{this.onChange()}}]}},{}])}async init(e){super.init(e);var i=this.CurrentApplication.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})));$$(this.ids.datacollection).define("options",i),$$(this.ids.datacollection).refresh(),this._handler_onCancel=()=>{u.setSettings(this._preFilterSettings),this.filter_property_popup.hide()},this.filter_property_popup=webix.ui({view:"window",modal:!0,position:"center",resize:!0,width:700,height:450,css:"ab-main-container",hidden:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:c("Filter Menu")},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:this._handler_onCancel,on:{onAfterRender(){t.CYPRESS_REF(this)}}}]},body:u.ui()}),u.on("cancel",this._handler_onCancel),u.on("save",(()=>{this.filter_property_popup.hide(),this.onChange()}));let n=[];return n.push(u.init(e)),n.push(this.linkPageComponent.init(e)),n.push(this.PopupFrozenColumnsComponent.init(e)),n.push(this.PopupHideFieldComponent.init(e)),n.push(this.PopupSummaryColumnsComponent.init(e)),n.push(this.PopupCountColumnsComponent.init(e)),Promise.all(n)}badgesCount(e){let t=e.length;0==t&&(t=!1),$$(this.ids.buttonCountFields).config.badge=t,$$(this.ids.buttonCountFields).refresh()}badgesHidden(e){let t=e.length;0==t&&(t=!1),$$(this.ids.buttonFieldsVisible).config.badge=t,$$(this.ids.buttonFieldsVisible).refresh()}badgesFrozen(e){const t=this.CurrentView.settings.hiddenFields||[];let i=this.CurrentView.datacollection.datasource.fields((e=>-1==t.indexOf(e.columnName))).map((e=>e.columnName)).indexOf(e)+1;0==i&&(i=!1),$$(this.ids.buttonFieldsFreeze).config.badge=i,$$(this.ids.buttonFieldsFreeze).refresh()}badgesSummary(e){let t=e.length;0==t&&(t=!1),$$(this.ids.buttonSummaryFields).config.badge=t,$$(this.ids.buttonSummaryFields).refresh()}get datacollection(){return this.AB.datacollectionByID(this.CurrentView.settings?.dataviewID)}populate(e){super.populate(e);let t=this.ids;if(!e)return;$$(t.datacollection).setValue(e.settings.dataviewID),$$(t.isEditable).setValue(e.settings.isEditable),$$(t.massUpdate).setValue(e.settings.massUpdate),$$(t.allowDelete).setValue(e.settings.allowDelete),$$(t.isSortable).setValue(e.settings.isSortable),$$(t.isExportable).setValue(e.settings.isExportable),""!=e.settings.datacollection?$$(t.datacollection).setValue(e.settings.dataviewID):$$(t.datacollection).setValue(""),$$(t.height).setValue(e.settings.height),$$(t.hideHeader).setValue(e.settings.hideHeader),$$(t.labelAsField).setValue(e.settings.labelAsField),$$(t.hideButtons).setValue(e.settings.hideButtons),this.refreshGroupBy(),this.refreshGroupByList(e.settings.groupBy);let i=this.datacollection;i&&(u.objectLoad(i.datasource),u.setSettings(e.settings.gridFilter),this.PopupCountColumnsComponent.objectLoad(i.datasource),this.PopupCountColumnsComponent.setValue(e.settings.countColumns||""),this.PopupFrozenColumnsComponent.objectLoad(i.datasource),this.PopupFrozenColumnsComponent.setValue(e.settings.frozenColumnID||""),this.PopupFrozenColumnsComponent.setHiddenFields(e.settings.hiddenFields),this.PopupHideFieldComponent.objectLoad(i.datasource),this.PopupHideFieldComponent.setSettings(e.settings.hiddenFields),this.PopupHideFieldComponent.setFrozenColumnID(e.settings.frozenColumnID||""),this.PopupSummaryColumnsComponent.objectLoad(i.datasource),this.PopupSummaryColumnsComponent.setValue(e.settings.summaryColumns||[]),this.badgesCount(e.settings.countColumns),this.badgesHidden(e.settings.hiddenFields),this.badgesFrozen(e.settings.frozenColumnID),this.badgesSummary(e.settings.summaryColumns)),this.linkPageComponent.viewLoad(e),this.linkPageComponent.setSettings(e.settings)}defaultValues(){let e={};var t=this.ViewClass();return t&&(e=t.defaultValues()),e}filterMenuShow(){this._preFilterSettings=u.getSettings(),this.filter_property_popup.show()}refreshGroupBy(e){const t=this.ids;let i=this.CurrentView,n=[];(e=e||this.datacollection)&&e.datasource&&e.datasource.fields((e=>!e.isConnection&&i.settings.hiddenFields.indexOf(e.columnName)<0)).forEach((e=>{n.push({id:e.columnName,value:e.label})})),$$(t.groupBy).define("options",n),$$(t.groupBy).refresh(),$$(t.groupBy).setValue(i.settings.groupBy)}refreshGroupByList(e){const t=this.ids;let i=e||[];"string"==typeof i&&(i=i.split(","));let n=$$(t.groupBy).getList().data.find({});$$(t.groupByList).clearAll(),i.forEach((e=>{let i=n.filter((t=>t.id==e))[0];i&&$$(t.groupByList).add(i)}))}values(){let e=this.ids,t=super.values();t.settings=t.settings||{},t.settings.dataviewID=$$(e.datacollection).getValue(),t.settings.isEditable=$$(e.isEditable).getValue(),t.settings.massUpdate=$$(e.massUpdate).getValue(),t.settings.allowDelete=$$(e.allowDelete).getValue(),t.settings.isSortable=$$(e.isSortable).getValue(),t.settings.isExportable=$$(e.isExportable).getValue(),t.settings.height=$$(e.height).getValue(),t.settings.hideHeader=$$(e.hideHeader).getValue(),t.settings.labelAsField=$$(e.labelAsField).getValue(),t.settings.hideButtons=$$(e.hideButtons).getValue();let i=$$(e.groupByList).serialize()||[];t.settings.groupBy=i.map((e=>e.id)).join(","),t.settings.gridFilter=u.getSettings(),t.settings.hiddenFields=this.PopupHideFieldComponent.getSettings(),t.settings.frozenColumnID=this.PopupFrozenColumnsComponent.getValue(),t.settings.summaryColumns=this.PopupSummaryColumnsComponent.getValue(),t.settings.countColumns=this.PopupCountColumnsComponent.getValue();let n=this.linkPageComponent.getSettings();for(let e in n)t.settings[e]=n[e];return t}ViewClass(){return super._ViewClass("grid")}}}},5281:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_image",{width:"",height:""})}static get key(){return"image"}ui(){const e=this.ids;return super.ui([{cols:[{view:"label",label:o("Image:"),css:"ab-text-bold",width:i.labelWidthXLarge},{view:"uploader",value:o("Upload image"),name:"file",apiOnly:!0,inputName:"image",multiple:!1,accept:"image/png, image/gif, image/jpeg, image/jpg, image/bmp",upload:"/image/upload/1",on:{onFileUpload:t=>{if(t&&t.data){if(this.filename=t.data.uuid,t.file){let i=new Image;i.onload=function(){$$(e.width).setValue(i.width),$$(e.height).setValue(i.height)},i.src=URL.createObjectURL(t.file)}this.onChange()}},onFileUploadError:(e,t)=>{}}}]},{id:e.width,view:"counter",name:"width",label:o("Width:"),labelWidth:i.labelWidthXLarge,on:{onChange:(e,t)=>{e!=t&&(this._saveTimeout&&clearTimeout(this._saveTimeout),this._saveTimeout=setTimeout((()=>{this._saveTimeout=null,this.onChange()}),1e3))}}},{id:e.height,view:"counter",name:"height",label:o("Height:"),labelWidth:i.labelWidthXLarge,on:{onChange:(e,t)=>{e!=t&&(this._saveTimeout&&clearTimeout(this._saveTimeout),this._saveTimeout=setTimeout((()=>{this._saveTimeout=null,this.onChange()}),1e3))}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e),this.filename=e.settings.filename;const t=this.ids;let i=$$(t.width);i.blockEvent(),i.setValue(e.settings.width),i.unblockEvent();let n=$$(t.height);n.blockEvent(),n.setValue(e.settings.height),n.unblockEvent()}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=super.values();return t.settings=t.settings||{},t.settings.filename=this.filename,t.settings.width=$$(e.width).getValue(),t.settings.height=$$(e.height).getValue(),t}ViewClass(){return super._ViewClass("label")}}}},5711:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var n=i(2418),o=i(5609),a=i(2439);function s(e){const t="properties_abview_kanban",i=(0,n.Z)(e),s=i.L(),r=e.UISettings.config(),l=(0,o.Z)(e,`${t}_prop`);var c=null;return class extends i{constructor(){super(t,{datacollection:""})}static get key(){return"kanban"}ui(){let e=l.ui(),t=[{view:"fieldset",label:s("Kanban Data:"),labelWidth:r.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:this.ids.datacollection,view:"richselect",name:"dataviewID",label:s("Data Source:"),placeholder:s("Select a Datacollection"),labelWidth:r.labelWidthLarge,options:[],on:{onChange:(e,t)=>{e!=t&&(this.refreshFields(e),this.onChange())}}}]}},...e.rows];return super.ui(t)}async init(e){this.AB=e,l.on("new.field",(e=>{let t=this.AB.datacollectionByID(this.CurrentView.settings.dataviewID);c.objectLoad(t.datasource),c.resetState(),c.show(null,e,!1)})),l.on("changed",(()=>{this.onChange()})),c=(0,a.Z)(e,`${t}_popupNewDataField`),await c.init(e),c.on("save",((...e)=>{l.emit("field.added",e[0])})),await super.init(e)}populate(e){super.populate(e);var t=e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})));let i=$$(this.ids.datacollection),n=e.settings.dataviewID||null;i.blockEvent(),i.define("options",t),i.define("value",n),i.unblockEvent(),i.refresh(),this.refreshFields(n)}refreshFields(e){let t=this.AB.datacollectionByID(e);if(!t)return void l.clearValues();let i=t.datasource;l.init(i,this.CurrentView),c.objectLoad(i)}values(){const e=super.values(),t=this.ids,i=$$(t.component);return e.settings=i.getValues(),e}ViewClass(){return super._ViewClass("kanban")}}}},4247:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_label",{text:"",format:"",alignment:""}),this.AB=e}static get key(){return"label"}ui(){const e=this.defaultValues(),t=this.ids;return super.ui([{id:t.text,view:"text",name:"text",label:i("Text"),placeholder:i("Text Placeholder"),on:{onChange:(e,t)=>{if(e!==t){const t=this.CurrentView;t.text=e,t.save(),this.onChange()}}}},{view:"fieldset",label:i("Format Options:"),body:{type:"clean",padding:10,rows:[{id:t.format,view:"radio",name:"format",vertical:!0,value:e.format,options:[{id:0,value:i("normal")},{id:1,value:i("title")},{id:2,value:i("description")}],on:{onChange:()=>{this.onChange()}}}]}},{view:"fieldset",label:i("Alignment:"),body:{type:"clean",padding:10,rows:[{id:t.alignment,view:"radio",name:"alignment",vertical:!0,value:e.alignment,options:[{id:"left",value:i("Left")},{id:"center",value:i("Center")},{id:"right",value:i("Right")}],on:{onChange:()=>{this.onChange()}}}]}},{}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids;$$(t.text).setValue(e.text),$$(t.format).setValue(e.settings.format),$$(t.alignment).setValue(e.settings.alignment)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=$$(e.component),i=super.values();return i.settings=t.getValues(),i.text=i.settings.text,i}ViewClass(){return super._ViewClass("label")}}}},1163:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L();return class extends t{constructor(){super("properties_abview_layout",{}),this.AB=e}static get key(){return"layout"}ui(){return super.ui([{view:"button",css:"webix_primary",value:i("Add Column "),click:()=>this.addView()}])}defaultValues(){let e={};const t=this.ViewClass();return t&&(e=t.defaultValues()),e}ViewClass(){return super._ViewClass("layout")}async addView(){const e=this.CurrentView;e.addColumn();const t=[];e.views().forEach((e=>{t.push(e.save())})),await Promise.all(t),this.onChange()}}}},8450:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.UISettings.config();return class extends t{constructor(){super("properties_abview_list",{datacollection:"",field:"",height:""})}static get key(){return"list"}ui(){const e=this.ids;return super.ui([{id:e.datacollection,name:"dataviewID",view:"richselect",label:i("Data Source"),labelWidth:o.labelWidthLarge,on:{onChange:(e,t)=>{e!=t&&(this.propertyUpdateFieldOptions(e),this.onChange())}}},{id:e.field,name:"field",view:"richselect",label:i("Field"),labelWidth:o.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.height,view:"counter",name:"height",label:i("Height:"),labelWidth:o.labelWidthLarge,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}propertyUpdateFieldOptions(e){var t=this.AB.datacollectionByID(e),i=t?t.datasource:null,n=[];null!=i&&(n=i.fields().map((e=>({id:e.id,value:e.label}))));const o=this.ids;$$(o.field).define("options",n),$$(o.field).refresh()}populate(e){super.populate(e);const t=this.ids;var i=e.settings.dataviewID?e.settings.dataviewID:null,n=$$(t.datacollection),o=e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})));n.define("options",o),n.define("value",i),n.refresh(),this.propertyUpdateFieldOptions(i),$$(t.field).setValue(e.settings.field),$$(t.height).setValue(e.settings.height)}defaultValues(){const e=this.ViewClass();let t=null;return e&&(t=e.defaultValues()),t}values(){const e=this.ids,t=$$(e.component),i=super.values();return i.settings=t.getValues(),i}ViewClass(){return super._ViewClass("list")}}}},6598:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();let a={};return class extends t{constructor(){super("properties_abview_menu",{orientation:"",buttonStyle:"",menuAlignment:"",menuInToolbar:0,menuPadding:"",menuTheme:"",menuPosition:"",menuTextLeft:"",menuTextCenter:"",menuTextRight:"",pages:"",treeDnD:"",pagesFieldset:"",pageOrderFieldset:""}),this.AB=e,a=this.AB.Class.ABViewManager.viewClass("menu").defaultValues()}static get key(){return"menu"}ui(){const e=this.ids;return super.ui([{id:e.orientation,name:"orientation",view:"richselect",label:o("Orientation"),value:a.orientation,labelWidth:i.labelWidthXLarge,options:[{id:"x",value:o("Horizontal")},{id:"y",value:o("Vertical")}],on:{onChange:()=>{this.onChange()}}},{id:e.buttonStyle,name:"buttonStyle",view:"richselect",label:o("Button Style"),value:a.buttonStyle,labelWidth:i.labelWidthXLarge,options:[{id:"ab-menu-default",value:o("Default")},{id:"ab-menu-link",value:o("Link")}],on:{onChange:()=>{this.onChange()}}},{id:e.menuAlignment,name:"menuAlignment",view:"richselect",label:o("Menu Alignment"),value:a.menuAlignment,labelWidth:i.labelWidthXLarge,options:[{id:"ab-menu-left",value:o("Left")},{id:"ab-menu-center",value:o("Center")},{id:"ab-menu-right",value:o("Right")}],on:{onChange:()=>{this.onChange()}}},{id:e.menuInToolbar,name:"menuInToolbar",view:"checkbox",labelRight:o("Put menu in toolbar"),value:a.menuInToolbar,labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{name:"toolbarFieldset",view:"fieldset",label:o("Toolbar Settings:"),labelWidth:i.labelWidthLarge,body:{view:"layout",type:"clean",padding:10,rows:[{id:e.menuPadding,name:"menuPadding",view:"counter",label:o("Toolbar padding"),value:a.menuPadding,labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.menuTheme,name:"menuTheme",view:"richselect",label:o("Toolbar theme"),value:a.menuTheme,labelWidth:i.labelWidthLarge,options:[{id:"white",value:o("White")},{id:"bg_gray",value:o("Gray")},{id:"webix_dark",value:o("Dark")}],on:{onChange:()=>{this.onChange()}}},{id:e.menuPosition,name:"menuPosition",view:"richselect",label:o("Menu Position"),value:a.menuPosition,labelWidth:i.labelWidthLarge,options:[{id:"left",value:o("Left")},{id:"center",value:o("Center")},{id:"right",value:o("Right")}],on:{onChange:()=>{this.onChange()}}},{id:e.menuTextLeft,name:"menuTextLeft",view:"text",label:o("Text Left"),placeholder:o("Place text in left region of toolbar."),labelWidth:i.labelWidthLarge,labelPosition:"top",on:{onChange:()=>{this.onChange()}}},{id:e.menuTextCenter,name:"menuTextCenter",view:"text",label:o("Text Center"),placeholder:o("Place text in center region of toolbar."),labelWidth:i.labelWidthLarge,labelPosition:"top",on:{onChange:()=>{this.onChange()}}},{id:e.menuTextRight,name:"menuTextRight",view:"text",label:o("Text Right"),placeholder:o("Place text in right region of toolbar."),labelWidth:i.labelWidthLarge,labelPosition:"top",on:{onChange:()=>{this.onChange()}}}]}},{id:e.pagesFieldset,name:"pagesFieldset",view:"fieldset",label:o("Page List:"),labelWidth:i.labelWidthLarge,body:{view:"layout",type:"clean",padding:10,rows:[{id:e.pages,name:"pages",view:"edittree",borderless:!0,css:"transparent",editable:!0,editValue:"aliasname",editor:"text",template:function(e,t){return`<div class='ab-page-list-item'>\n                              ${t.icon(e)} ${t.checkbox(e,!1)} <div class="fa fa-${"viewcontainer"==e.key?"window-maximize":"file"}"></div> \n                              ${e.label}</div>`},on:{onItemCheck:(e,t)=>{this.onChange(),this.updateTreeDnD(e,t)},onBeforeEditStart:function(e){const t=this.getItem(e);t.aliasname||(t.aliasname=t.label,this.updateItem(t))},onBeforeEditStop:(t,i)=>{const n=$$(e.pages),o=$$(e.treeDnD);let a=n.getItem(i.id);if(a&&(a.translations.forEach((e=>{e.language_code==this.AB.Multilingual.currentLanguage()&&(e.aliasname=t.value)})),a.label=t.value,n.updateItem(i.id,a)),o.exists(i.id)){let e=o.getItem(i.id)||{};e.value=t.value,e.aliasname=t.value,this.onChange(),o.updateItem(i.id,e)}}}}]}},{id:e.pageOrderFieldset,name:"pageOrderFieldset",view:"fieldset",label:o("Drag & Drop to Reorder/Click to Add Icon:"),labelWidth:i.labelWidthLarge,body:{view:"layout",type:"clean",padding:10,rows:[{id:e.treeDnD,view:"edittree",borderless:!0,name:"treeDnD",template:"{common.icon()} <i class='fa fa-fw fa-#icon#'></i> <span>#value#</span>",drag:!0,editable:!0,editValue:"icon",editor:"combo",options:this.AB._App.icons,suggest:{template:"#value#",filter:function(e,t){return 0===e.value.toString().toLowerCase().indexOf(t.toLowerCase())},body:{template:"<i class='fa fa-fw fa-#value#'></i> #value#"}},on:{onBeforeDrop:function(e){e.parent=e.target,e.index=-1},onAfterDrop:(e,t)=>{this.reorderPages()},onDataUpdate:()=>{this.reorderPages()}}}]}}])}populate(e){if(super.populate(e),!e)return;const t=this.ids;$$(t.orientation).setValue(e.settings.orientation??a.orientation),$$(t.buttonStyle).setValue(e.settings.buttonStyle??a.buttonStyle),$$(t.menuAlignment).setValue(e.settings.menuAlignment??a.menuAlignment),$$(t.menuInToolbar).setValue(parseInt(e.settings.menuInToolbar)??a.menuInToolbar),$$(t.menuPadding).setValue(e.settings.menuPadding??a.menuPadding),$$(t.menuTheme).setValue(e.settings.menuTheme??a.menuTheme),$$(t.menuPosition).setValue(e.settings.menuPosition??a.menuPosition),e.menuTextLeft=e.menuTextLeft||e.settings.menuTextLeft,$$(t.menuTextLeft).setValue(e.menuTextLeft??a.menuTextLeft),e.menuTextCenter=e.menuTextCenter||e.settings.menuTextCenter,$$(t.menuTextCenter).setValue(e.menuTextCenter??a.menuTextCenter),e.menuTextRight=e.menuTextRight||e.settings.menuTextRight,$$(t.menuTextRight).setValue(e.menuTextRight??a.menuTextRight);const i=new this.AB.Webix.TreeCollection,n=e.application,o=e.pageRoot();n.pages((e=>o?.id==e.id),!0).forEach(((t,n)=>{this.addPage(e,t,n,i)}));const s=$$(t.pages);s.clearAll(),s.data.importData(i),s.refresh(),s.blockEvent(),s.uncheckAll(),s.unblockEvent(),s.openAll();const r=$$(t.treeDnD);r.clearAll(),e?.settings?.order?.forEach((t=>{s.exists(t.tabId??t.pageId)&&(s.blockEvent(),s.checkItem(t.tabId??t.pageId),s.unblockEvent());const i=e.getAliasname(t);r.add({id:t.tabId??t.pageId,value:i,type:t.type,pageId:t.pageId??"",tabId:t.tabId??"",icon:t.icon},t.position?parseInt(t.position):0,t.parent&&"0"!=t.parent?t.parent:"")})),r.openAll(),$$(t.pagesFieldset).config.height=28*s.count()+18+40,$$(t.pagesFieldset).resize(),$$(t.pageOrderFieldset).config.height=28*s.count()+18+40,$$(t.pageOrderFieldset).resize()}values(){const e=this.ids;let t=super.values();if(t.settings=t.settings??{},t.settings.orientation=$$(e.orientation).getValue(),t.settings.buttonStyle=$$(e.buttonStyle).getValue(),t.settings.menuAlignment=$$(e.menuAlignment).getValue(),t.settings.menuInToolbar=$$(e.menuInToolbar).getValue(),t.settings.menuPadding=$$(e.menuPadding).getValue(),t.settings.menuTheme=$$(e.menuTheme).getValue(),t.settings.menuPosition=$$(e.menuPosition).getValue(),t.menuTextLeft=$$(e.menuTextLeft).getValue(),t.menuTextCenter=$$(e.menuTextCenter).getValue(),t.menuTextRight=$$(e.menuTextRight).getValue(),t.menuTextLeft.length&&(t.settings.menuTextLeft=""),t.menuTextCenter.length&&(t.settings.menuTextCenter=""),t.menuTextCenter.length&&(t.settings.menuTextRight=""),$$(e.pages)){for(let t=0;t<$$(e.pages).data.count();t++){let i=$$(e.pages).getIdByIndex(t);const n=$$(e.pages).getItem(i);let o,a="page";"viewcontainer"==n.key?(a="tab",o=i,i=n.pageParent().id):o="";let s=[];n&&n.translations&&(s=n.translations)}t.settings.pages&&delete t.settings.pages}return t}ViewClass(){return super._ViewClass("menu")}updateTreeDnD(e,t){const i=this.ids,n=this.CurrentView,a=$$(i.treeDnD),s=$$(i.pages);let r=n.application.pages((t=>t.id==e),!0)[0];if(r||(r=n.application.views((t=>t.id==e),!0)[0]),t){let e=n.getAliasname(r);a.add({id:r.id,value:e,type:r.type,pageId:r.pageId??"",tabId:r.tabId??""}),this.reorderPages()}else a.exists(e)&&!a.isBranch(e)?(a.remove(e),this.reorderPages()):a.exists(e)&&a.isBranch(e)&&(s.blockEvent(),s.checkItem(e),this.AB.Webix.message({text:o("Item comtains submenu, please remove items in submenu before removing."),type:"error",expire:1e4}),s.unblockEvent())}reorderPages(){const e=this.ids,t=this.CurrentView,i=$$(e.treeDnD);let n=[];i.data.each((e=>{let i=t.application.pages((t=>t.id==e.id),!0)[0];i||(i=t.application.views((t=>t.id==e.id),!0)[0]),n.push(i)}));let o=[];n.forEach((i=>{if(i){const n={},a=i.id,s=$$(e.treeDnD).getItem(a);n.parent=s.$parent,n.position=$$(e.treeDnD).getBranchIndex(a),n.icon=s.icon,n.type="viewcontainer"==i.key?"tab":"page","tab"==n.type?(n.tabId=i.id,n.pageId=t.getParentPageId(i)):n.pageId=i.id,n.isChecked="true",n.translations=i.translations,o.push(n)}})),t.settings.order=o,this.onChange(),i.openAll()}addPage(e,t,i,n,o){e?.settings?.order?.forEach((e=>{(e.pageId==t.id&&!e.id||o&&e.pageId==o&&e.tabId==t.id)&&(t.translations=e.translations)}));const a=e.getAliasname(t);t.label=a||t.label,n.add(t,i,o);const s=t.pages?t.pages():[];s.forEach(((i,o)=>{this.addPage(e,i,o,n,t.id)}));const r=this.AB.Class.ABViewManager.viewClass("tab");t.views((e=>e instanceof r)).forEach(((i,o)=>{i.views().forEach(((i,a)=>{const r=s.length+o+a;this.addPage(e,i,r,n,t.id)}))}))}}}},9630:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(3156);function o(e){const t=(0,n.default)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_page",{type:"",popupSettings:"",popupWidth:"",popupHeight:"",pageSettings:"",fixedPageWidth:"",pageWidth:"",pageBackground:""})}static get key(){return"page"}ui(){let e=this.ids,t=this;return super.ui([{id:e.type,name:"type",view:"richselect",label:o("Type"),options:[{id:"page",value:o("Page")},{id:"popup",value:o("Popup")}],on:{onChange:t=>{"page"==t?($$(e.popupSettings).hide(),$$(e.pageSettings).show()):($$(e.popupSettings).show(),$$(e.pageSettings).hide()),this.onChange()}}},{id:e.popupSettings,view:"fieldset",name:"popupSettings",label:o("Popup Settings"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.popupWidth,view:"text",name:"popupWidth",placeholder:o("Set popup width"),label:o("Width:"),labelWidth:i.labelWidthLarge,validate:webix.rules.isNumber,on:{onChange:()=>{this.onChange()}}},{id:e.popupHeight,view:"text",name:"popupHeight",placeholder:o("Set popup height"),label:o("Height:"),labelWidth:i.labelWidthLarge,validate:webix.rules.isNumber,on:{onChange:()=>{this.onChange()}}}]}},{id:e.pageSettings,view:"fieldset",name:"pageSettings",label:o("Page Settings"),labelWidth:i.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.fixedPageWidth,view:"checkbox",name:"fixedPageWidth",labelRight:o("Page has fixed width"),labelWidth:i.labelWidthCheckbox,click:function(){1==this.getValue()?$$(e.pageWidth).show():$$(e.pageWidth).hide(),t.onChange()}},{id:e.pageWidth,view:"text",name:"pageWidth",placeholder:o("Set page width"),label:o("Page width:"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.pageBackground,view:"richselect",name:"pageBackground",label:o("Page background:"),labelWidth:i.labelWidthXLarge,options:[{id:"ab-background-default",value:o("White (default)")},{id:"ab-background-gray",value:o("Dark")}],on:{onChange:()=>{this.onChange()}}}]}}])}populate(e){super.populate(e);let t=this.ids,i=this.defaultValues();$$(t.type).setValue(e.settings.type||i.type),$$(t.popupWidth).setValue(e.settings.popupWidth||i.popupWidth),$$(t.popupHeight).setValue(e.settings.popupHeight||i.popupHeight),$$(t.pageWidth).setValue(e.settings.pageWidth||i.pageWidth),$$(t.fixedPageWidth).setValue(e.settings.fixedPageWidth||i.fixedPageWidth),$$(t.pageBackground).setValue(e.settings.pageBackground||i.pageBackground),e.isRoot()?$$(t.type).hide():$$(t.type).show(),"popup"==e.settings.type?($$(t.popupSettings).show(),$$(t.pageSettings).hide()):($$(t.popupSettings).hide(),$$(t.pageSettings).show()),1==e.settings.fixedPageWidth?$$(t.pageWidth).show():$$(t.pageWidth).hide()}defaultValues(){let e={};var t=this.ViewClass();return t&&(e=t.defaultValues()),e}values(){let e=this.ids,t=super.values();return t.settings=t.settings||{},t.settings.type=$$(e.type).getValue(),t.settings.popupWidth=$$(e.popupWidth).getValue(),t.settings.popupHeight=$$(e.popupHeight).getValue(),t.settings.pageWidth=$$(e.pageWidth).getValue(),t.settings.fixedPageWidth=$$(e.fixedPageWidth).getValue(),t.settings.pageBackground=$$(e.pageBackground).getValue(),t}ViewClass(){return super._ViewClass("page")}}}},1832:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=t.L(),o=e.UISettings.config();return class extends t{constructor(){super("properties_abview_pivot",{datacollection:"",height:"",removeMissed:"",totalColumn:"",separateLabel:"",min:"",max:"",decimalPlaces:""}),this.AB=e}static get key(){return"pivot"}ui(){const e=this.ids;return super.ui([{id:e.datacollection,name:"dataviewID",view:"richselect",label:i("Data Source"),labelWidth:o.labelWidthLarge,on:{onChange:(e,t)=>{e!=t&&this.onChange()}}},{id:e.height,view:"counter",name:"height",label:i("Height:"),labelWidth:o.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.removeMissed,view:"checkbox",name:"removeMissed",labelRight:i("Remove empty data."),labelWidth:o.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.totalColumn,view:"checkbox",name:"totalColumn",labelRight:i("Show a total column."),labelWidth:o.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.separateLabel,view:"checkbox",name:"separateLabel",labelRight:i("Separate header label."),labelWidth:o.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.min,view:"checkbox",name:"min",labelRight:i("Highlighting of a cell(s) with the least value in a row."),labelWidth:o.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.max,view:"checkbox",name:"max",labelRight:i("Highlighting of a cell(s) with the biggest value in a row."),labelWidth:o.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.decimalPlaces,name:"decimalPlaces",view:"counter",min:1,label:i("Decimal Places"),labelWidth:o.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}}])}async init(e){this.AB=e,await super.init(e)}populate(e){super.populate(e);const t=this.ids,i=e.settings.dataviewID?e.settings.dataviewID:null;var n=$$(t.datacollection),o=e.application.datacollectionsIncluded().map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})));n.define("options",o),n.define("value",i),n.refresh(),$$(t.removeMissed).setValue(e.settings.removeMissed),$$(t.totalColumn).setValue(e.settings.totalColumn),$$(t.separateLabel).setValue(e.settings.separateLabel),$$(t.min).setValue(e.settings.min),$$(t.max).setValue(e.settings.max),$$(t.height).setValue(e.settings.height),$$(t.decimalPlaces).setValue(null==e.settings.decimalPlaces?2:e.settings.decimalPlaces)}values(){const e=$$(this.ids.component),t=super.values();return t.settings=e.getValues(),t}ViewClass(){return super._ViewClass("pivot")}}}},7375:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e);return class extends t{constructor(){super("properties_abview_pivot",{})}static get key(){return"reportsManager"}ui(){return super.ui([])}async init(e){this.AB=e,await super.init(e)}values(){return super.values()}ViewClass(){return super._ViewClass("pivot")}}}},6234:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var n=i(2418),o=i(5888);function a(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),a=t.L(),s=(0,o.Z)(e);return class extends t{constructor(){super("properties_abview_tab",{sidebarWidth:"",sidebarPos:"",iconOnTop:"",height:"",minWidth:"",stackTabs:"",darkTheme:""})}static get key(){return"tab"}ui(){const e=this.ids;return super.ui([{id:e.height,name:"height",view:"counter",label:a("Height"),on:{onChange:()=>{this.onChange()}}},{id:e.minWidth,view:"counter",name:"minWidth",label:a("Minimum width"),on:{onChange:()=>{this.onChange()}}},{id:e.stackTabs,view:"checkbox",name:"stackTabs",labelRight:a("Stack Tabs Vertically"),labelWidth:i.labelWidthCheckbox,on:{onChange:t=>{1==t?($$(e.sidebarWidth).show(),$$(e.sidebarPos).show(),$$(e.iconOnTop).hide()):($$(e.sidebarWidth).hide(),$$(e.sidebarPos).hide(),$$(e.iconOnTop).show()),this.onChange()}}},{id:e.iconOnTop,view:"checkbox",name:"iconOnTop",labelRight:a("Position icon above text"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.darkTheme,view:"checkbox",name:"darkTheme",labelRight:a("Use Dark Theme"),labelWidth:i.labelWidthCheckbox,on:{onChange:()=>{this.onChange()}}},{id:e.sidebarWidth,view:"counter",name:"sidebarWidth",label:a("Width of Sidebar"),labelWidth:i.labelWidthXLarge,on:{onChange:()=>{this.onChange()}}},{id:e.sidebarPos,view:"richselect",name:"sidebarPos",label:a("Position of Sidebar"),labelWidth:i.labelWidthXLarge,options:[{id:"left",value:a("Left")},{id:"right",value:a("Right")}],on:{onChange:()=>{this.onChange()}}},{view:"button",css:"webix_primary",value:a("Add Tab"),click:()=>{this.CurrentView.tabPopup.show()}}])}async init(e){await super.init(e);const t=this.CurrentView;t.tabPopup||(t.tabPopup=new s(t),await t.tabPopup.init(e)),this.__tabPopupSave||(this.__tabPopupSave=t.tabPopup.on("saved",(()=>{this.onChange()})))}populate(e){super.populate(e);const t=this.ids;$$(t.height).setValue(e.settings.height),$$(t.minWidth).setValue(e.settings.minWidth),$$(t.stackTabs).setValue(e.settings.stackTabs),$$(t.darkTheme).setValue(e.settings.darkTheme),$$(t.sidebarWidth).setValue(e.settings.sidebarWidth),$$(t.sidebarPos).setValue(e.settings.sidebarPos),$$(t.iconOnTop).setValue(e.settings.iconOnTop),e.settings.stackTabs?($$(t.sidebarWidth).show(),$$(t.sidebarPos).show(),$$(t.iconOnTop).hide()):($$(t.sidebarWidth).hide(),$$(t.sidebarPos).hide(),$$(t.iconOnTop).show())}values(){const e=super.values(),t=this.ids,i=$$(t.component);return e.settings=i.getValues(),e}ViewClass(){return super._ViewClass("tab")}}}},7669:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(2418);function o(e){const t=(0,n.Z)(e),i=e.Config.uiSettings(),o=t.L();return class extends t{constructor(){super("properties_abview_text",{height:"",dataviewID:"",field:""}),this.AB=e}static get key(){return"text"}ui(){const e=this.ids,t=this;return super.ui([{id:e.height,view:"counter",name:"height",label:o("Height:"),labelWidth:i.labelWidthLarge,on:{onChange:()=>{this.onChange()}}},{id:e.dataviewID,name:"dataviewID",view:"richselect",label:o("Data Source"),labelWidth:i.labelWidthLarge,on:{onChange:e=>{t.selectSource(e),this.onChange()}}},{id:e.field,name:"field",view:"list",maxHeight:322,template:"#label#",on:{onItemClick:function(e){const i=this.getItem(e);t.selectField(i)}}}])}async init(e){this.AB=e,await super.init(e)}selectSource(e){const t=this.CurrentView;this.updateFieldOptions(t,e)}selectField(e){const t=`{${e.label}}`;tinymce.activeEditor.execCommand("mceInsertContent",!1,t)}updateFieldOptions(e,t){const i=this.ids,n=e.AB.datacollectionByID(t)??e.AB.datacollectionByID(e.parent.settings.dataviewID)??null;"dataview"===e.parent.key&&(t=e.parent.settings.dataviewID);const o=$$(i.dataviewID),a=$$(i.field);if(o.setValue(t),!n)return void a.clearAll();const s=n?.datasource??null;a.clearAll(),s&&a.parse(s.fields()),a.refresh()}populate(e){super.populate(e);const t=this.ids,i=e.settings.dataviewID??"none",n=$$(t.dataviewID),a=this.AB.Account.isSystemDesigner()?()=>!0:e=>!e.isSystemObject,s=this.CurrentApplication.datacollectionsIncluded(a),r=[{id:"none",value:o("None")},...s.map((e=>({id:e.id,value:e.label,icon:"query"==e.sourceType?"fa fa-filter":"fa fa-database"})))];n.define("options",r),n.define("value",i),n.refresh(),this.updateFieldOptions(e,i),$$(t.height).setValue(e.settings.height)}values(){const e=super.values(),t=this.ids,i=$$(t.component);return e.settings=i.getValues(),"none"==e.settings.dataviewID&&(e.settings.dataviewID=null),e}ViewClass(){return super._ViewClass("text")}}}},4245:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285),o=null;function a(e,t){if(!o){const a=`${t}_viewpropertyfilterdata`,s=(0,n.Z)(e),r=e.Config.uiSettings();var i=s.L();class l extends e.Class.ABMLClass{constructor(){super(["label"],e)}fromSettings(e){super.fromValues(e),this.filters=e.filters}toSettings(){let e=super.toObj();return e.filters=this.filters,e}}class c extends s{constructor(e){let t=`${a}_filterrule_${e}`;super(t,{label:"",filter:"",btnDelete:""}),this.indx=e,this.base=t,this.rowFilter=null}ui(){return{id:this.ids.component,cols:[{id:this.ids.label,view:"text",value:""},{id:this.ids.filter,view:"button",css:"webix_primary",value:i("Add Filter"),click:()=>{this.rowFilter.popUp($$(this.ids.filter).getNode())}},{id:this.ids.btnDelete,view:"button",css:"webix_primary",width:28,type:"icon",icon:"fa fa-times",click:()=>{webix.confirm({title:i("Remove Filter?"),message:i("Are you sure you want to remove this filter?"),callback:async e=>{if(e){let e=$$(this.ids.component);e.getParentView().removeView(e),this.emit("deleted")}}})}}]}}init(e){this.AB=e,this.rowFilter=this.AB.filterComplexNew(`${this.ids.filter}_fc`)}fromSettings(e){this.settings=new l,this.settings.fromSettings(e),$$(this.ids.label).setValue(this.settings.label),this.rowFilter?.setValue(this.settings.filters)}toSettings(){return this.settings.label=$$(this.ids.label).getValue(),this.settings.filters=this.rowFilter?.getValue(),this.settings.toSettings()}objectLoad(e){this.object=e,this.rowFilter&&this.rowFilter.fieldsLoad(this.object.fields(),this.object)}}o=class t extends s{static get default(){return{filterOption:1,userFilterPosition:"toolbar",isGlobalToolbar:1}}constructor(t){super(a,{filterRules:"",filterRulesScrollview:"",filterOptionRadio:"",filterUserLayout:"",filterUser:"",filterGlobal:"",filterMenuLayout:"",needLoadAllLabel:"",globalToolbar:""}),this.AB=e,this.queryRules=[],this.isGrid=!1,t?.isGrid&&(this.isGrid=!0)}ui(){const e=this.ids;return{type:"form",rows:[{view:"radio",id:e.filterOptionRadio,value:0,options:[{id:0,value:i("Do not Allow User filters")},{id:1,value:i("Enable User filters")},{id:2,value:i("Use a filter menu")},{id:3,value:i("Use a global filter input")}],vertical:!0,label:"Filter Option",labelWidth:r.labelWidthLarge,on:{onChange:e=>{this.setFilterOption(e)}}},{view:"radio",id:e.filterGlobal,hidden:!0,vertical:!0,label:"Show",labelWidth:r.labelWidthLarge,options:[{id:"default",value:i("All matching records")},{id:"single",value:i("Single records only")}]},{view:"layout",id:e.filterUserLayout,hidden:!0,cols:[{view:"radio",vertical:!0,id:e.filterUser,value:"toolbar",label:"Display",labelWidth:r.labelWidthLarge,width:200,options:[{id:"toolbar",value:i("Toolbar")},{id:"form",value:i("Form")}],on:{onChange:e=>{this.setFilterUser(e)}}},{view:"checkbox",id:e.globalToolbar,width:350,labelRight:i("Include a global filter input")},{}]},{view:"layout",id:e.filterMenuLayout,hidden:!0,rows:[{css:{"padding-bottom":10},cols:[{view:"button",css:"webix_primary",icon:"fa fa-plus",type:"iconButton",label:i("Add new filter"),width:150,click:()=>{this.addFilterRule({})}},{id:e.needLoadAllLabel,view:"label",label:i('need "LoadAll" from datasource'),css:{color:"red"},hidden:!0},{fillspace:!0}]},{id:e.filterRulesScrollview,view:"scrollview",scroll:"xy",body:{id:e.filterRules,view:"layout",margin:20,padding:10,rows:[]}}]},{css:{"background-color":"#fff"},cols:[{fillspace:!0},{view:"button",name:"cancel",value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.buttonCancel()}},{view:"button",css:"webix_primary",name:"save",label:i("Save"),type:"form",autowidth:!0,click:()=>{this.buttonSave()}},{fillspace:!0}]}]}}init(e){this.AB=e}buttonCancel(){this.emit("cancel")}buttonSave(){this.emit("save")}objectLoad(e,t=!1){this.object=e,this.isLoadAll=t,this.queryRules&&this.queryRules.length&&this.queryRules.forEach((t=>{t.objectLoad(e)}))}setSettings(e={}){const i=this.ids;e||(e={}),(e.queryRules||[]).forEach((e=>{e?.queryRules?.[0]?.rules&&e.queryRules[0].rules.forEach((e=>{/^[+-]?\d+(\.\d+)?$/.exec(e.value)&&(e.value=JSON.parse(e.value))}))}));let n=e.filterOption;(null==n||Number.isNaN(n))&&(n=t.default.filterOption),$$(i.filterOptionRadio).setValue(n),$$(i.filterUser).setValue(e.userFilterPosition||t.default.userFilterPosition),$$(i.globalToolbar).setValue(void 0!==e.isGlobalToolbar?e.isGlobalToolbar:t.default.isGlobalToolbar),$$(i.filterGlobal).setValue(e.globalFilterPosition||t.default.globalFilterPosition),(this.queryRules??[]).forEach((e=>{$$(i.filterRules)&&$$(i.filterRules).removeView(e.ids.component)})),this.queryRules=[],(e.queryRules||[]).forEach((e=>{this.addFilterRule(e)}))}getSettings(){const e=this.ids;var t={};switch(t.filterOption=parseInt($$(e.filterOptionRadio).getValue()),t.queryRules=[],t.filterOption){case 0:t.isGlobalToolbar=0;break;case 1:this.isGrid?(t.userFilterPosition=$$(e.filterUser).getValue(),t.isGlobalToolbar=$$(e.globalToolbar).getValue()):(t.userFilterPosition="form",t.isGlobalToolbar=0);break;case 2:this.queryRules.forEach((e=>{t.queryRules.push(e.toSettings())}));break;case 3:t.globalFilterPosition=$$(e.filterGlobal).getValue()}return t}addFilterRule(e){if(null==this.object)return;e=e??{};let t=0;this.queryRules.forEach((e=>{e.indx>t&&(t=e.indx)})),t++;let i=new c(t);var n=$$(this.ids.filterRules);n&&(n.addView(i.ui()),i.init(this.AB),i.objectLoad(this.object),i.fromSettings(e),i.on("deleted",(()=>{this.queryRules=this.queryRules.filter((e=>e.indx!=i.indx))}))),this.queryRules.push(i)}onShow(){this.isLoadAll?$$(this.ids.needLoadAllLabel).hide():$$(this.ids.needLoadAllLabel).show()}setFilterOption(e){const t=this.ids;switch(JSON.parse(e||0)){case 1:$$(t.filterMenuLayout).hide(),$$(t.filterGlobal).hide(),this.isGrid&&$$(t.filterUserLayout).show();break;case 2:$$(t.filterUserLayout).hide(),$$(t.filterGlobal).hide(),$$(t.filterMenuLayout).show();break;case 3:$$(t.filterUserLayout).hide(),$$(t.filterMenuLayout).hide(),$$(t.filterGlobal).show();break;default:$$(t.filterUserLayout).hide(),$$(t.filterMenuLayout).hide(),$$(t.filterGlobal).hide()}}setFilterUser(e){switch(e){case"toolbar":$$(this.ids.globalToolbar).show();break;case"form":$$(this.ids.globalToolbar).hide()}}}}return o}},8782:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285),o=null;function a(e,t){if(!o){const a=`${t}_viewpropertylinkpage`,s=(0,n.Z)(e),r=e.Config.uiSettings();var i=s.L();o=class extends s{constructor(){super(a,{detailsPage:"",editPage:""}),this.AB=e}static get default(){return{detailsPage:null,detailsTab:null,editPage:null,editTab:null}}ui(){return{view:"fieldset",label:i("Linked Pages:"),labelWidth:r.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:this.ids.detailsPage,view:"combo",clear:!0,placeholder:i("No linked view"),name:"detailsPage",label:i("Details Page:"),labelWidth:r.labelWidthLarge,options:[],on:{onChange:()=>this.emit("change")}},{id:this.ids.editPage,view:"combo",clear:!0,placeholder:i("No linked form"),name:"editPage",label:i("Edit Form:"),labelWidth:r.labelWidthLarge,options:[],on:{onChange:()=>this.emit("change")}}]}}}init(e){return this.AB=e,Promise.resolve()}clear(){$$(this.ids.detailsPage).setValue(""),$$(this.ids.editPage).setValue("")}viewLoad(e){this.view=e;const t=this.ids;let i=(t,i)=>t.key==i&&(t.settings.dataviewID==e.settings.dataviewID||(this.AB??e.AB)?.datacollectionByID(t.settings.dataviewID)?.datacollectionFollow?.id==e.settings.dataviewID),n=[];n=n.concat(e.pageRoot().views((e=>i(e,"detail")),!0).map((e=>({id:e.id,value:e.label})))),n=n.concat(e.pageRoot().pages((e=>e.views((e=>i(e,"detail")),!0).length),!0).map((e=>({id:e.id,value:e.label})))),$$(t.detailsPage).define("options",n),$$(t.detailsPage).refresh();let o=[];o=o.concat(e.pageRoot().views((e=>i(e,"form")),!0).map((e=>({id:e.id,value:e.label})))),o=o.concat(e.pageRoot().pages((e=>e.views((e=>i(e,"form")),!0).length),!0).map((e=>({id:e.id,value:e.label})))),$$(t.editPage).define("options",o),$$(t.editPage).refresh()}setSettings(e){if(e.detailsPage){let t=e.detailsPage;""!=e.detailsTab&&(t+=":"+e.detailsTab),$$(this.ids.detailsPage).setValue(t)}else $$(this.ids.detailsPage).setValue(null);if(e.editPage){var t=e.editPage;""!=e.editTab&&(t+=":"+e.editTab),$$(this.ids.editPage).setValue(t)}else $$(this.ids.editPage).setValue(null)}getSettings(){let e={};var t=$$(this.ids.detailsPage).getValue(),i="";if(t.split(":").length>1){var n=t.split(":");t=n[0],i=n[1]}e.detailsPage=t,e.detailsTab=i;var o=$$(this.ids.editPage).getValue(),a="";if(o.split(":").length>1){var s=o.split(":");o=s[0],a=s[1]}return e.editPage=o,e.editTab=a,e}}}return o}},4550:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285);const o={name:"Default Gantt",filterConditions:[],sortFields:[],settings:{dataviewID:"",titleFieldID:"",startDateFieldID:"",endDateFieldID:"",durationFieldID:"",progressFieldID:"",notesFieldID:""}};function a(e,t){const i=(0,n.Z)(e),a=i.L(),s=e.Class.ABFieldManager.fieldByKey("date"),r=e.Class.ABFieldManager.fieldByKey("number"),l=e.Class.ABFieldManager.fieldByKey("string"),c=e.Class.ABFieldManager.fieldByKey("LongText");return new class extends i{constructor(e){super(e,{titleFieldID:"",startDateFieldID:"",endDateFieldID:"",durationFieldID:"",progressFieldID:"",notesFieldID:""}),this.on("field.added",(e=>{this.refreshOptions(this.CurrentObject,this._view),this._autoSelectInput&&$$(this._autoSelectInput)?.setValue(e.id)})),this._autoSelectInput=null,this._dateFields=[]}type(){return"gantt"}icon(){return"fa fa-tasks"}refreshOptions(e,t){const i=this.ids,n=e.fields((e=>e instanceof s)).map((({id:e,label:t})=>({id:e,value:t})));n.sort(((e,t)=>e.value>t.value?1:-1)),n.unshift({id:null,value:a("Select a date field")}),this._dateFields=n,$$(i.startDateFieldID).define("options",n),$$(i.endDateFieldID).define("options",n);const d=e.fields((e=>e instanceof r)).map((({id:e,label:t})=>({id:e,value:t})));d.sort(((e,t)=>e.value>t.value?1:-1)),d.unshift({id:null,value:a("Select a number field")}),this._numberFields=d,$$(i.durationFieldID).define("options",d),$$(i.progressFieldID).define("options",d);const u=e.fields((e=>e instanceof l||e instanceof c)).map((({id:e,label:t})=>({id:e,value:t})));u.sort(((e,t)=>e.value>t.value?1:-1)),u.unshift({id:null,value:a("Select a string field")}),this._stringFields=u,$$(i.titleFieldID).define("options",u),$$(i.notesFieldID).define("options",u),t&&(t.titleFieldID&&($$(i.titleFieldID).define("value",t.titleFieldID),$$(i.titleFieldID).refresh(),this.syncCommonLists([i.titleFieldID,i.notesFieldID],this._stringFields)),t.startDateFieldID&&($$(i.startDateFieldID).define("value",t.startDateFieldID),$$(i.startDateFieldID).refresh(),this.syncCommonLists([i.startDateFieldID,i.endDateFieldID],this._dateFields)),t.endDateFieldID&&($$(i.endDateFieldID).define("value",t.endDateFieldID||o.settings.endDateFieldIDFieldID),$$(i.endDateFieldID).refresh(),this.syncCommonLists([i.startDateFieldID,i.endDateFieldID],this._dateFields)),t.durationFieldID&&($$(i.durationFieldID).define("value",t.durationFieldID||o.settings.durationFieldID),$$(i.durationFieldID).refresh(),this.syncCommonLists([i.durationFieldID,i.progressFieldID],this._numberFields)),t.progressFieldID&&($$(i.progressFieldID).define("value",t.progressFieldID),$$(i.progressFieldID).refresh(),this.syncCommonLists([i.durationFieldID,i.progressFieldID],this._numberFields)),t.notesFieldID&&($$(i.notesFieldID).define("value",t.notesFieldID),$$(i.notesFieldID).refresh(),this.syncCommonLists([i.titleFieldID,i.notesFieldID],this._stringFields)))}syncCommonLists(e,t){e.forEach((i=>{const n=[];e.filter((e=>e!=i)).forEach((e=>{n.push($$(e).getValue())}));const o=$$(i),a=t.filter((e=>-1==n.indexOf(e.id)));o.define("options",a),o.refresh()}))}ui(){const e=this.ids;return{batch:"gantt",rows:[{cols:[{id:e.titleFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-calendar'></span> ${a("Title")}`,placeholder:a("Select a string field"),labelWidth:130,name:"titleFieldID",options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.titleFieldID,e.notesFieldID],this._stringFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.titleFieldID,this.emit("new.field",l.defaults().key)}}]},{cols:[{id:e.startDateFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-calendar'></span> ${a("Start Date")}`,placeholder:a("Select a date field"),labelWidth:130,name:"startDateFieldID",required:!0,options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.startDateFieldID,e.endDateFieldID],this._dateFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.startDateFieldID,this.emit("new.field",s.defaults().key)}}]},{cols:[{id:e.endDateFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-calendar'></span> ${a("End Date")}`,placeholder:a("Select a date field"),labelWidth:130,name:"endDateFieldID",options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.startDateFieldID,e.endDateFieldID],this._dateFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.endDateFieldID,this.emit("new.field",s.defaults().key)}}]},{cols:[{id:e.durationFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-hashtag'></span> ${a("Duration")}`,placeholder:a("Select a number field"),labelWidth:130,name:"durationFieldID",options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.durationFieldID,e.progressFieldID],this._numberFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.durationFieldID,this.emit("new.field",r.defaults().key)}}]},{cols:[{id:e.progressFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-hashtag'></span> ${a("Progress")}`,placeholder:a("Select a number field"),labelWidth:130,name:"progressFieldID",required:!1,options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.durationFieldID,e.progressFieldID],this._numberFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.progressFieldID,this.emit("new.field",r.defaults().key)}}]},{cols:[{id:e.notesFieldID,view:"richselect",label:`<span style='opacity: 0.6;' class='webix_icon fa fa-align-right'></span> ${a("Notes")}`,placeholder:a("Select a string field"),labelWidth:130,name:"notesFieldID",required:!1,options:[],on:{onChange:(t,i)=>{this.syncCommonLists([e.titleFieldID,e.notesFieldID],this._stringFields)}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.notesFieldID,this.emit("new.field",c.defaults().key)}}]}]}}init(e,t){this.objectLoad(e),this._view=t,this.refreshOptions(e,t?.settings)}validate(e){const t=this.ids,i=$$(t.endDateFieldID).getValue()||o.settings.endDateFieldID,n=$$(t.durationFieldID).getValue()||o.settings.durationFieldID;return!(!i&&!n&&(e.markInvalid("endDateFieldID","Required"),e.markInvalid("durationFieldID","Required"),1))}values(){const e=this.ids,t={};return t.titleFieldID=$$(e.titleFieldID).getValue()||o.settings.titleFieldID,t.startDateFieldID=$$(e.startDateFieldID).getValue()||o.settings.startDateFieldID,t.endDateFieldID=$$(e.endDateFieldID).getValue()||o.settings.endDateFieldID,t.durationFieldID=$$(e.durationFieldID).getValue()||o.settings.durationFieldID,t.progressFieldID=$$(e.progressFieldID).getValue()||o.settings.progressFieldID,t.notesFieldID=$$(e.notesFieldID).getValue()||o.settings.notesFieldID,t}fromSettings(e){for(const t in o)this[v]=e[t]||o[t];this.settings=Object.assign({},o.settings,e.settings??{}),this.type=this.type()}toSettings(){const e={};for(const t in o)e[t]=this[t]||o[t];return e.settings=Object.assign({},o.settings,e.settings??{}),e.key=this.type(),e.type=this.type(),e}}(t)}},5609:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(3285);const o={name:"Default Kanban",settings:{verticalGroupingField:null,horizontalGroupingField:null,ownerField:null}};var a=null;function s(e,t){const i=(0,n.Z)(e);var s=i.L();const r=e.Class.ABFieldManager.fieldByKey("connectObject"),l=e.Class.ABFieldManager.fieldByKey("list"),c=e.Class.ABFieldManager.fieldByKey("user");return a||(a=class extends i{constructor(e){super(e,{vGroupInput:"",hGroupInput:"",ownerInput:""}),this.on("field.added",(e=>{this.refreshOptions(this.CurrentObject,this._view),this._autoSelectInput&&$$(this._autoSelectInput)?.setValue(e.id)})),this._autoSelectInput=null}type(){return"kanban"}icon(){return"fa fa-columns"}refreshOptions(e,t,i={}){let n=this.ids;const o=(i,n,o=(e=>e.key===l.defaults().key),a)=>{if(null!=i&&null!=e){var r=e.fields().filter(o).map((({id:e,label:t})=>({id:e,value:t})));!a&&r.length&&r.unshift({id:"none",value:s("None")}),i.define("options",r),t?t.settings[n]?i.define("value",t.settings[n]):!a&&r[0]&&i.define("value",r[0].id):1===r.filter((e=>e.id)).length&&i.define("value",r[0].id),i.refresh()}};o(i.vGroupInput||$$(n.vGroupInput),"verticalGroupingField",(e=>[l.defaults().key,c.defaults().key].includes(e.key)),!0),o(i.hGroupInput||$$(n.hGroupInput),"horizontalGroupingField",(e=>[r.defaults().key,l.defaults().key,c.defaults().key].includes(e.key)),!1),o(i.ownerInput||$$(n.ownerInput),"ownerField",(e=>e.key===c.defaults().key||e.key===r.defaults().key&&"one"==e.settings.linkType&&"many"==e.settings.linkViaType),!1)}ui(){let e=this.ids;return{batch:"kanban",rows:[{cols:[{id:e.vGroupInput,view:"richselect",label:`<span style="opacity: 0.6;" class='webix_icon fa fa-columns'></span> ${s("Vertical Grouping")}`,placeholder:s("Select a field"),labelWidth:180,name:"verticalGroupingField",required:!0,options:[],on:{onChange:()=>{$$(e.vGroupInput).validate(),$$(e.hGroupInput).validate(),this.emit("changed")}},invalidMessage:s("Required")},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.vGroupInput,this.emit("new.field",l.defaults().key)}}]},{cols:[{id:e.hGroupInput,view:"richselect",label:`<span style="opacity: 0.6;"class='webix_icon fa fa-list'></span> ${s("Horizontal Grouping")}`,placeholder:s("Select a field"),labelWidth:180,name:"horizontalGroupingField",required:!1,options:[],invalidMessage:s("Cannot be the same as vertical grouping field"),validate:t=>{var i=$$(e.vGroupInput).getValue();return!i||!t||i!==t},on:{onChange:()=>{$$(e.hGroupInput).validate(),this.emit("changed")}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.hGroupInput,this.emit("new.field",l.defaults().key)}}]},{cols:[{id:e.ownerInput,view:"richselect",label:`<span style="opacity: 0.6;" class='webix_icon fa fa-user-circle'></span> ${s("Card Owner")}`,placeholder:s("Select a user field"),labelWidth:180,name:"ownerField",options:[],on:{onChange:(e,t)=>{e!=t&&this.emit("changed")}}},{view:"button",css:"webix_primary",type:"icon",icon:"fa fa-plus",label:"",width:30,click:()=>{this._autoSelectInput=e.ownerInput,this.emit("new.field",r.defaults().key)}}]}]}}init(e,t){this.objectLoad(e),this._view=t,this.refreshOptions(e,t)}clearValues(){const e=this.ids;[e.vGroupInput,e.hGroupInput,e.ownerInput].forEach((e=>{let t=$$(e);t.blockEvent(),t.define("value",null),t.unblockEvent(),t.refresh()}))}values(){let e=this.ids,t={};return t.verticalGroupingField=$$(e.vGroupInput).getValue()||null,t.horizontalGroupingField=$$(e.hGroupInput).getValue()||null,t.ownerField=$$(e.ownerInput).getValue()||null,t}fromSettings(e){for(var t in o)this[t]=e[t]||o[t];this.type=this.type(),this.key=this.type()}toSettings(){var e={};for(var t in o)e[t]=this[t]||o[t];return e.key=this.type(),e.type=this.type(),e}}),new a(t)}},3285:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=null;function o(e){return n||(n=class extends e.ClassUI{constructor(...t){super(...t),this.AB=e,this.CurrentApplicationID=null,this.CurrentDatacollectionID=null,this.CurrentObjectID=null,this.CurrentProcessID=null,this.CurrentQueryID=null,this.CurrentViewID=null}static L(){return function(...t){return e.Multilingual.labelPlugin("ABDesigner",...t)}}applicationLoad(e){this.CurrentApplicationID=e?.id}datacollectionLoad(e){this.CurrentDatacollectionID=e?.id}objectLoad(e){this.CurrentObjectID=e?.id}processLoad(e){this.CurrentProcessID=e?.id}queryLoad(e){this.CurrentQueryID=e?.id}versionLoad(e){this.CurrentVersionID=e?.id}viewLoad(e){this.CurrentViewID=e?.id,e?.application&&this.applicationLoad(e.application)}get CurrentApplication(){return this.AB.applicationByID(this.CurrentApplicationID)}get CurrentDatacollection(){return this.AB.datacollectionByID(this.CurrentDatacollectionID)}get CurrentObject(){let e=this.AB.objectByID(this.CurrentObjectID);return e||(e=this.AB.queryByID(this.CurrentObjectID)),e}get CurrentProcess(){return this.AB.processByID(this.CurrentProcessID)}get CurrentQuery(){return this.AB.queryByID(this.CurrentQueryID)}get CurrentView(){return this.CurrentApplication?.views((e=>e.id==this.CurrentViewID))[0]}uniqueIDs(){let e=webix.uid();Object.keys(this.ids).forEach((t=>{this.ids[t]=`${this.ids[t]}_${e}`}))}warningsRefresh(e){e?.warningsEval?.(),this.emit("warnings")}warningsPropogate(e=[]){e.forEach((e=>{e.on("warnings",(()=>{this.emit("warnings")}))}))}}),n}},8788:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e){const t=(0,n.Z)(e);var i=t.L();return class extends t{constructor(e,t){super(e,Object.assign({form:"",name:"",role:"",useRole:"",useAccount:"",account:""},t))}ui(n={}){var o=e.Account.rolesAll().map((e=>({id:e.id,value:e.name}))),a=e.Account.userList().map((e=>({id:e.uuid,value:e.username}))),s=this.ids;return{view:"form",id:this.ids.component,css:"no-margin",elements:[{cols:[{view:"checkbox",id:this.ids.useRole,width:34,labelWidth:0,value:"1"==n.useRole?1:0,click:function(e){$$(e).getValue()?$$(s.role).enable():$$(s.role).disable()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"label",label:i("by Role"),width:88},{view:"multicombo",id:this.ids.role,value:n.role?n.role:0,disabled:"1"!=n.useRole,suggest:{body:{yCount:4,data:o,on:{onAfterRender(){this.data.each((e=>{t.CYPRESS_REF(this.getItemNode(e.id),`${s.role}_${e.id}`)}))},onItemClick:function(e){var t=$$(s.role),i=t.getValue(),n=i.indexOf(e);-1==n?i.push(e):i.splice(n,1),t.setValue(i)}}}},placeholder:i("Click to add Role"),labelAlign:"left",stringResult:!1,on:{onAfterRender:function(){t.CYPRESS_REF(this.getNode(),s.role)},onChange:()=>{$$(this.ids.role).getList().callEvent("onAfterRender")}}}]},{},{cols:[{view:"checkbox",id:this.ids.useAccount,width:34,labelWidth:0,value:"1"==n.useAccount?1:0,click:function(e){$$(e).getValue()?$$(s.account).enable():$$(s.account).disable()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"label",label:i("by Account"),width:88},{view:"multicombo",id:this.ids.account,value:n.account?n.account:0,disabled:"1"!=n.useAccount,suggest:{body:{yCount:4,data:a,on:{onAfterRender(){this.data.each((e=>{t.CYPRESS_REF(this.getItemNode(e.id),`${s.account}_${e.id}`)}))},onItemClick:function(e){var t=$$(s.account),i=t.getValue(),n=i.indexOf(e);-1==n?i.push(e):i.splice(n,1),t.setValue(i)}}}},placeholder:i("Click to add User"),labelAlign:"left",stringResult:!1,on:{onAfterRender:function(){t.CYPRESS_REF(this.getNode(),s.account)},onChange:()=>{$$(this.ids.account).getList().callEvent("onAfterRender")}}}]}]}}async init(e){return this.AB=e,Promise.resolve()}values(){var e={},t=this.ids;return $$(t.useRole)&&(e.useRole=$$(t.useRole).getValue()),$$(t.role)&&e.useRole?(e.role=$$(t.role).getValue(),"--"===e.role&&(e.role=null)):e.role=null,$$(t.useAccount)&&(e.useAccount=$$(t.useAccount).getValue()),$$(t.account)&&e.useAccount?(e.account=$$(t.account).getValue(),"--"===e.account&&(e.account=null)):e.account=null,e}}}},5997:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e,t){t=t||"ui_work_object_workspace_popupFrozenColumns";const i=(0,n.Z)(e);var o=i.L();return new class extends i{constructor(e){super(e,{list:""}),this._setting=""}ui(){var e=this.ids;return{view:"popup",id:e.component,width:500,body:{rows:[{view:"list",id:e.list,width:250,maxHeight:350,select:!1,template:'<span style="min-width: 18px; display: inline-block;"><i class="fa fa-circle-o ab-frozen-field-icon"></i>&nbsp;</span> #label#',on:{onItemClick:(e,t,i)=>{this.clickListItem(e,t,i)}}},{view:"button",css:"webix_primary",value:o("Clear All"),type:"form",on:{onItemClick:()=>this.clickClearAll()}}]},on:{onShow:()=>{this.onShow(),this.iconsReset()}}}}async init(e){this.AB=e,webix.ui(this.ui())}changed(){this.emit("changed",this._setting)}clickClearAll(){this.setValue(""),this.iconsReset(),this.changed()}clickListItem(e){var t=$$(this.ids.list).getItem(e).columnName;-1==(this._hiddenFields||[]).indexOf(t)?(this.setValue(t),this.iconsReset(),this.changed()):webix.alert({text:o("Sorry, you cannot freeze a hidden column.")})}iconDefault(e){e&&(e.querySelector(".ab-frozen-field-icon").classList.remove("fa-circle"),e.querySelector(".ab-frozen-field-icon").classList.add("fa-circle-o"))}iconFreeze(e){e&&(e.querySelector(".ab-frozen-field-icon").classList.remove("fa-circle-o"),e.querySelector(".ab-frozen-field-icon").classList.add("fa-circle"))}iconsReset(){for(var e=$$(this.ids.list),t=!1,i=e.getFirstId();i;){var n=e.getItem(i).columnName,o=e.getItemNode(i);""==this._setting?this.iconDefault(o):0==t?this.iconFreeze(o):this.iconDefault(o),this._setting==n&&(t=!0),-1!=(this._hiddenFields||[]).indexOf(n)?(o.style.opacity=.4,o.querySelector(".ab-frozen-field-icon").classList.remove("fa-circle"),o.querySelector(".ab-frozen-field-icon").classList.remove("fa-circle-o"),o.querySelector(".ab-frozen-field-icon").classList.add("fa-eye-slash")):(o.style.opacity=1,o.querySelector(".ab-frozen-field-icon").classList.remove("fa-eye-slash")),i=e.getNextId(i)}}onShow(){var e=this.CurrentObject.fields(),t=[];e.forEach((e=>{t.push({id:e.id,label:e.label,columnName:e.columnName,$css:"hidden_fields_"+e.id})})),$$(this.ids.list).clearAll(),$$(this.ids.list).parse(t)}show(e,t){null!=t?$$(this.ids.component).show(e,t):$$(this.ids.component).show(e)}setValue(e){this._setting=e}getValue(){return this._setting}setHiddenFields(e=[]){this._hiddenFields=e??[]}}(t)}},6038:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e,t){t=t||"ui_work_object_workspace_popupHideFields";const i=(0,n.Z)(e);var o=i.L();return new class extends i{constructor(e){super(e,{list:"",buttonHide:"",buttonShow:""}),this._settings=[],this._frozenColumnID=null}ui(){var t=this.ids;return{view:"popup",id:t.component,body:{rows:[{view:"list",id:t.list,maxHeight:350,select:!1,template:'<span style="min-width: 18px; display: inline-block;"><i class="fa ab-visible-field-icon"></i>&nbsp;</span> #label#',on:{onItemClick:(e,t,i)=>{this.clickListItem(e,t,i)},onAfterRender(){this.data.each((i=>{e.ClassUI.CYPRESS_REF(this.getItemNode(i.id),`${t.list}_${i.id}`)}))}}},{cols:[{id:t.buttonHide,view:"button",value:o("Hide All"),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)},onItemClick:()=>{this.clickHideAll()}}},{id:t.buttonShow,view:"button",css:"webix_primary",value:o("Show All"),type:"form",on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)},onItemClick:()=>{this.clickShowAll()}}}]}]},on:{onShow:()=>{this.onShow(),this.iconsReset()}}}}init(e){this.AB=e,webix.ui(this.ui()),this.$Component=$$(this.ids.component),this.$List=$$(this.ids.list)}changed(){this.emit("changed",this._settings)}clickHideAll(){var e=this.CurrentObject.fields(),t=[];e.forEach((function(e){t.push(e.columnName)})),this._settings=t,this.iconsReset(),this.changed()}clickShowAll(){this._settings=[],this.iconsReset(),this.changed()}clickListItem(e,t,i){var n=this.$List.getItem(e);if(this._frozenColumnID!=n.columnName){var a=[];(this._settings||[]).filter((e=>e==n.columnName)).length>0?(a=(this._settings||[]).filter((e=>e!=n.columnName)),this.iconShow(i)):((a=this._settings||[]).push(n.columnName),this.iconHide(i)),this._settings=a||[],this.changed()}else webix.alert({text:o("Sorry, you cannot hide your last frozen column.")})}iconFreezeOff(e){e&&e.querySelector(".ab-visible-field-icon").classList.remove("fa-thumb-tack")}iconFreezeOn(e){e&&e.querySelector(".ab-visible-field-icon").classList.add("fa-thumb-tack")}iconHide(e){e&&(e.querySelector(".ab-visible-field-icon").classList.add("fa-eye-slash"),e.style.opacity=.4)}iconShow(e){e&&(e.querySelector(".ab-visible-field-icon").classList.remove("fa-eye-slash"),e.style.opacity=1)}iconsReset(){for(var e=this.$List,t=e.getFirstId();t;){var i=e.getItem(t),n=e.getItemNode(t);this._frozenColumnID==i.columnName?this.iconFreezeOn(n):(this.iconFreezeOff(n),-1==(this._settings||[]).indexOf(i.columnName)?this.iconShow(n):this.iconHide(n)),t=e.getNextId(t)}}onShow(){var e=this.CurrentObject.fields(),t=[];e.forEach((e=>{t.push({id:e.id,label:e.label,columnName:e.columnName})})),this.$List.clearAll(),this.$List.parse(e)}show(e,t=null){null!=t?this.$Component.show(e,t):this.$Component.show(e)}setSettings(e){this._settings=this.AB.cloneDeep(e||[])}getSettings(){return this._settings||[]}setFrozenColumnID(e){this._frozenColumnID=e}}(t)}},2439:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(3285),o=i(7056);function a(e,t){t=t||"abd_work_object_workspace_popupNewDataField";const i=(0,n.Z)(e),a=i.L(),s=(0,o.Z)(e);return new class extends i{constructor(e){super(e,{types:"",editDefinitions:"",buttonSave:"",buttonCancel:"",title:"",buttonMaximize:"",buttonMinimize:"",chooseFieldType:"",searchBar:"",fieldSetting:"",submission:"",buttonBack:""}),this._componentHash={},this._componentsByType={},this._currentEditor=null,this.defaultEditorComponent=null,this.submenus=[],this._editField=null}ui(){const e=this.ids;return{view:"window",position:"center",id:e.component,resize:!0,modal:!0,boarderless:!0,height:500,width:700,head:{view:"toolbar",css:"webix_dark",paddingX:2,elements:[{view:"label",id:e.title,align:"center",label:a("Choose Field-Type"),css:"modal_title"},{cols:[{view:"button",id:e.buttonMaximize,label:'<span class="webix_icon"><i class="nomargin fa fa-expand"></i></span>',css:"webix_transparent",width:40,click:()=>{this.buttonMaximize()}},{view:"button",id:e.buttonMinimize,label:'<span class="webix_icon"><i class="nomargin fa fa-compress"></i></span>',hidden:!0,css:"webix_transparent",width:40,click:()=>{this.buttonMinimize()}},{view:"button",label:'<span class="webix_icon"><i class="nomargin fa fa-times"></i></span>',css:"webix_transparent",width:40,click:()=>{this.buttonCancel()},on:{onAfterRender(){i.CYPRESS_REF(this)}}}]}]},body:{rows:[{id:e.chooseFieldType,rows:[{view:"search",id:e.searchBar,placeholder:a("Search by title..."),align:"center",on:{onTimedKeyPress:()=>{this.searchBar()}}},{view:"dataview",id:e.types,borderless:!0,type:{width:87.5,height:85,borderless:!0,template:'<button type="button" class="webix_button webix_img_btn_top" style="text-align: center;"><span style="font-size: 30px; color: #94a1b3;"><i class="#icon#"></i><br></span><span style="font-size: 12px; line-height: 13px; display: inline-block; margin: 3px 3px 0;">#label#</span></button>',css:"webix_transparent"},data:[],datatype:"json",select:1,click:e=>{this.onClick(e)}}]},{id:e.fieldSetting,minWidth:692,maxWidth:3840,maxHeight:2160,hidden:!0,rows:[{view:"multiview",id:e.editDefinitions,padding:0,cells:[{id:"del_me",view:"label",label:a("edit definition here")}]},{id:e.submission,cols:[{fillspace:!0},{view:"button",value:'<span class="webix_icon"><i class="nomargin fa fa-arrow-left fa-sm"></i></span><span class"text">'+a("Back")+"</span>",id:e.buttonBack,css:"ab-cancel-button webix_transparent icon_back_btn",autowidth:!0,click:()=>{this.buttonBack()}},{view:"button",css:"webix_primary",id:e.buttonSave,label:'<span class="text">'+a("Create")+"</span>",autowidth:!0,type:"form",click:()=>{this.buttonSave()}},{width:17}]},{height:17}]}]},on:{onHide:()=>{this.resetState()}}}}async init(e){e&&(this.AB=e);const i=this.ids;webix.ui(this.ui()),webix.extend($$(i.component),webix.ProgressBar);const n=s.fields(),o={view:"multiview",id:i.editDefinitions,animate:!1,rows:[]};n.forEach((e=>{const i=new e(`${t}_properties`),n=i.defaults().menuName,s=i.defaults().key,r=i.defaults().icon;this.submenus.push({id:n,icon:`nomargin fa fa-${r}`,label:a(n)}),this.defaultEditorComponent||(this.defaultEditorComponent=i),o.rows.push(i.ui()),this._componentHash[n]=i,this._componentsByType[s]=i})),$$(i.types).define("data",this.submenus),$$(i.types).refresh(),webix.ui(o,$$(i.editDefinitions));for(let e in this._componentHash)this._componentHash[e].init(this.AB),this._componentHash[e].hide();this.defaultEditorComponent.show(),this._currentEditor=this.defaultEditorComponent}applicationLoad(e){super.applicationLoad(e);for(const t in this._componentHash)this._componentHash[t]?.applicationLoad(e)}objectLoad(e){super.objectLoad(e);for(const t in this._componentHash)this._componentHash[t]?.objectLoad(e)}buttonCancel(){$$(this.ids.searchBar).setValue(""),this.searchBar(),this.buttonBack(),$$(this.ids.component).hide()}buttonMaximize(){$$(this.ids.buttonMaximize).hide(),$$(this.ids.buttonMinimize).show(),webix.fullscreen.set(this.ids.component)}buttonMinimize(){$$(this.ids.buttonMinimize).hide(),$$(this.ids.buttonMaximize).show(),webix.fullscreen.exit()}searchBar(){const e=$$(this.ids.searchBar).getValue().toLowerCase();$$(this.ids.types).filter((t=>-1!=t.label.toLowerCase().indexOf(e)))}buttonBack(){this.resetState(),this.addPopup();for(const e in this._componentHash)this._componentHash[e].clear()}async buttonSave(){const e=this.ids;$$(e.buttonSave).disable(),$$(e.component).showProgress();const t=this._currentEditor;if(t)if(t.isValid()){const i=this.AB.cloneDeep(t.values());let n,o=null,a=null;if(this._editField){i.label&&(this._editField.label=i.label),a=this._editField.toObj();const e=this.AB.cloneDeep(a);for(let t in i)if("settings"==t&&i.settings&&"object"==typeof i.settings){e.settings=e.settings||{};for(let t in i.settings)e.settings[t]=i.settings[t]}else e[t]=i[t];this._editField.fromValues(e),o=this._editField}else{o=this.CurrentObject.fieldNew(i);let e=20+10*o.label.length;if(o.settings.showIcon&&(e+=20),e<100&&(e=100),o.settings.width=e,"connectObject"==o.key){let t=Math.floor(1e3*Math.random());o.settings.isSource=1;const i=o.datasourceLink;let a=o.columnName;i.fields((e=>e.columnName==a)).length&&(a=`${a}${t}`),"many"==o.settings.linkType&&"many"==o.settings.linkViaType&&(a=`${this.CurrentObject.name}${t}`),n=i.fieldNew({key:o.key,columnName:a,label:this.CurrentObject.label,settings:{showIcon:o.settings.showIcon,linkObject:o.object.id,linkType:o.settings.linkViaType,linkViaType:o.settings.linkType,isCustomFK:o.settings.isCustomFK,indexField:o.settings.indexField,indexField2:o.settings.indexField2,isSource:0,width:e}})}}const s=o.isValid();if(s.fail())s.updateForm($$(t.ids.component)),a&&o.fromValues(a),$$(e.buttonSave).enable(),$$(e.component).hideProgress();else try{await o.save();let t=()=>{$$(e.buttonSave).enable(),$$(e.component).hideProgress(),this._currentEditor.clear(),this.hide(),this.emit("save",o)};null!=n?(n.settings.linkColumn=o.id,await n.save(),o.settings.linkColumn=n.id,await o.save(),this._editField||(await o.migrateCreate(),await n.migrateCreate()),t()):t()}catch(e){this.AB.notify.developer(e,{context:"UIWorkObjectWorkspacePopupNewDataField:buttonSave(): error saving new field",field:o.toObj()})}}else $$(e.buttonSave).enable(),$$(e.component).hideProgress();else this.AB.notify.developer(new Error("Could not find the current editor."),{}),$$(e.buttonSave).enable(),$$(e.component).hideProgress();this.buttonCancel}hide(){$$(this.ids.component).hide()}modeAdd(e,t=!0){this.defaultEditorComponent.show(!1,!1),this._currentEditor=this.defaultEditorComponent;const i=this.ids;if(this.CurrentObject.isImported&&(e="connectObject"),e){const i=Object.keys(this._componentHash).map((e=>this._componentHash[e])).filter((t=>t.defaults().key==e))[0];if(!i)return;const n=i.defaults().menuName;t||$$(this.ids.buttonBack).hide(),this.onClick(n)}else $$(i.chooseFieldType).enable(),this.addPopup()}modeEdit(e){this._currentEditor?.hide();for(const t in this._componentsByType)t==e.key?(this._componentsByType[t].show(!1,!1),this._componentsByType[t].populate(e),this._currentEditor=this._componentsByType[t],this._currentEditor.modeEdit=!0):this._componentsByType[t].hide();const t=this._currentEditor.ui()?.elements;if(t){const e=e=>{e.disallowEdit&&$$(e.id)?.disable?.()};this._currentEditor.eachDeep(t,e)}this.editPopup(e.defaults.menuName)}onClick(e){$$(this.ids.chooseFieldType).hide(),$$(this.ids.fieldSetting).show(),$$(this.ids.title).setValue(a("Create Field:")+" "+e);const t=this._componentHash[e];t&&(t.show(),this._currentEditor=t,this._currentEditor.modeEdit=!1)}resetState(){const e=this._currentEditor.ui()?.elements;if(e){const t=e=>{e.disallowEdit&&$$(e.id)?.enable?.()};this._currentEditor.eachDeep(e,t)}this.defaultEditorComponent.show(),this._currentEditor=this.defaultEditorComponent}addPopup(){this.buttonMinimize(),$$(this.ids.chooseFieldType).show(),$$(this.ids.buttonBack).show(),$$(this.ids.title).setValue(a("Choose Field-Type")),$$(this.ids.fieldSetting).hide(),$$(this.ids.buttonSave).define("label",a("Create")),$$(this.ids.buttonSave).refresh()}editPopup(e){this.buttonMinimize(),$$(this.ids.chooseFieldType).hide(),$$(this.ids.buttonBack).hide(),$$(this.ids.title).setValue(a("Edit Field:")+" "+e),$$(this.ids.fieldSetting).show(),$$(this.ids.buttonSave).define("label",a("Save")),$$(this.ids.buttonSave).refresh()}show(e,t,i=!0){this._editField=e,this._editField?this.modeEdit(e):this.modeAdd(t,i),$$(this.ids.component).show()}typeClick(){const e=this.ids;let t=$$(e.types).config.data[0].submenu;"string"!=typeof t&&($$(e.types).getSubMenu($$(e.types).config.data[0].id),t=$$(e.types).config.data[0].submenu),$$(t)&&$$(t).show()}}(t)}},423:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var n=i(3285);function o(e,t){t=t||"ui_work_object_workspace_popupSortFields";const i=(0,n.Z)(e);var o=i.L();return new class extends i{constructor(e){super(e,{list:"",form:""}),this._blockOnChange=!1}uiForm(){return{id:this.ids.form,view:"form",borderless:!0,elements:[{view:"button",type:"form",css:"webix_primary",value:o("Add new sort"),on:{onItemClick:()=>{this.clickAddNewSort()}}}]}}ui(){return{view:"popup",id:this.ids.component,width:600,body:this.uiForm(),on:{onShow:()=>{this.onShow()}}}}init(e){this.AB=e,webix.ui(this.ui())}clickAddNewSort(e,t){var i=this,n=$$(this.ids.form),a=n.getChildViews().length-1,s=this.getFieldList(!0);n.addView({id:`sort_${a+1}`,cols:[{view:"combo",width:220,options:s,on:{onChange:function(e){i.onChangeCombo(e,this)}}},{view:"segmented",width:200,options:[{id:"",value:o("Please select field")}],on:{onChange:()=>{this.triggerOnChange()}}},{view:"button",css:"webix_danger",icon:"fa fa-trash",type:"icon",width:30,on:{onItemClick:function(){n.removeView(this.getParentView()),i.refreshFieldList(!0),i.triggerOnChange()}}}]},a),e&&n.getChildViews()[a].getChildViews()[0].setValue(e),t&&n.getChildViews()[a].getChildViews()[1].setValue(t)}getFieldList(e){var t=$$(this.ids.form),i=[],n=this.CurrentObject.fields();if(!n)return i;if(n.forEach((e=>{e.fieldIsSortable()&&i.push({id:e.id,value:e.label})})),e){var o=t.getChildViews();o.length>1&&o.forEach((function(e,t){if(o.length-1<=t)return!1;var n=e.getChildViews()[0].getValue();if(n){var a=null;i.map(((e,t)=>e.id==n&&(a=t,!0))),i.splice(a,1)}}))}return i}setSettings(e){this._settings=this.AB.cloneDeep(e)}getSettings(){var e=$$(this.ids.form),t=[],i=e.getChildViews();return i.length>1&&i.forEach((function(e,n){if(i.length-1<=n)return!1;var o=e.getChildViews()[0].getValue(),a=e.getChildViews()[1].getValue();t.push({key:o,dir:a})})),t}onChangeCombo(e,t){var i=this.CurrentObject.fields(),n="",a=t.getParentView().getChildViews()[1],s=null;if(i.forEach((t=>{t.id==e&&(n=t)})),n){switch(n.key){case"date":s=[{id:"asc",value:o("Before -> After")},{id:"desc",value:o("After -> Before")}];break;case"number":s=[{id:"asc",value:o("1 -> 9")},{id:"desc",value:o("9 -> 1")}];break;default:s=[{id:"asc",value:o("A -> Z")},{id:"desc",value:o("Z -> A")}]}a.define("options",s),a.refresh(),this.refreshFieldList(),this.triggerOnChange()}}onShow(){var e=$$(this.ids.form);webix.ui(this.uiForm(),e);var t=this._settings;t&&t.forEach&&t.forEach((e=>{this.clickAddNewSort(e.key,e.dir)})),null!=t&&0!=t.length||this.clickAddNewSort()}refreshFieldList(e){var t=$$(this.ids.form),i=this.getFieldList(!1),n=[],o=[],a=t.getChildViews();a.length>1&&a.forEach((function(e,t){if(a.length-1<=t)return!1;let s=e.getChildViews()[0].getValue(),r=i.filter((e=>e.id==s));r.length>0?n.push(r[0]):o.push(e)})),e||o.forEach((e=>{t.removeView(e)})),(a=t.getChildViews()).length>1&&a.forEach(((e,t)=>{if(a.length-1<=t)return!1;let o=e.getChildViews()[0].getValue(),s=i.filter((e=>e.id==o));var r=n.filter((e=>!Array.isArray(s)||-1===s.indexOf(e))),l=i.filter((e=>!Array.isArray(r)||-1===r.indexOf(e)));e.getChildViews()[0].define("options",l),e.getChildViews()[0].refresh()}))}triggerOnChange(){this._blockOnChange||(this._settings=this.getSettings(),this.emit("changed",this._settings))}blockOnChange(){this._blockOnChange=!0}unblockOnChange(){this._blockOnChange=!1}show(e,t,i){this.blockOnChange(),$$(this.ids.component).show(e,i||null),t&&this.clickAddNewSort(t),this.unblockOnChange()}sort(e,t){var i=0,n=$$(this.ids.form).getChildViews();return n.length>1&&n.forEach(((o,a)=>{if(!(n.length-1<=a||0!=i)){var s=o.getChildViews()[0].getValue(),r=o.getChildViews()[1].getValue(),l=this.CurrentObject.fieldByID(s);if(l){var c=l.columnName,d=e[c],u=t[c];Array.isArray(d)&&(d=(d||[]).map((e=>e.text||e)).join(" ")),Array.isArray(u)&&(u=(u||[]).map((e=>e.text||e)).join(" ")),d!=u&&(i="asc"==r?d>u?1:-1:d<u?1:-1)}}})),i}}(t)}},2770:e=>{e.exports=class{constructor(e,t=FileReader){this._AB=e,this._FileReader=t}L(...e){return this._AB.Multilingual.labelPlugin("ABDesigner",...e)}getSeparateItems(){return[{id:",",value:this.L("Comma (,)")},{id:"\t",value:this.L("Tab (&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)")},{id:";",value:this.L("Semicolon (;)")},{id:"s",value:this.L("Space ( )")}]}validateFile(e){if(!e||!e.file||!e.file.type)return!1;let t=e.file.type.toLowerCase();return"text/csv"==t||"application/vnd.ms-excel"==t}async getDataRows(e,t){return this.validateFile(e)?new Promise(((i,n)=>{let o=new this._FileReader;o.onload=e=>{const n=this.convertToArray(o.result,t);i(n)},o.readAsText(e.file)})):Promise.reject(this.L(".fileInfo parameter is invalid"))}convertToArray(e="",t=","){let i=[];return(e.split(/\r\n|\n|\r/).filter((e=>e&&e.length>0))||[]).forEach((e=>{let n=[];n=","==t?(e=e.replace(/,,/g,", ,")).match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g):e.split(t),i.push(n.map((e=>this.reformat(e))))})),i}getGuessDataType(e,t){for(var i,n=1;n<=10;n++){var o=e[n];if(!o)break;if(null!=(i=o[t])&&i.length>0)break}return null==i||""===i?"string":0==i||1==i||1==i||0==i||"checked"==i||"unchecked"==i?"boolean":isNaN(i)?Date.parse(i)?"date":i.length>100?"LongText":"string":"number"}reformat(e){return e?e.trim().replace(/"/g,"").replace(/'/g,""):""}}},7980:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});class n{get key(){return"formiobuilder"}constructor(e){this.AB=e,this.label=this.AB.Label(),this.view=this.key,this.AB.Webix.protoUI(this.ui(),this.AB.Webix.ui.popup)}ui(){return{name:this.key,defaults:{css:"scrolly forceOpen",hidden:!1,autofit:!0},$init:async function(e){const t=this.parseDataFields(e.dataFields),i=e.formComponents?e.formComponents:{components:[t.approveButton.schema]};try{this.builder=await Formio.builder(this.$view,i,{noDefaultSubmitButton:!0,noNewEdit:!0,builder:{basic:!1,advanced:!1,customBasic:!1,premium:!1,custom:{title:this.label("Fields"),weight:0,default:!0,components:t},layout:{components:{table:!0}}}})}catch(e){this.notify("Error initializing formio builder",e)}},getFormData:function(){return this.builder.schema},label:this.label,parseDataFields:this.parseDataFields,notify:this.AB.notify.developer}}parseDataFields(e){const t={};return e.forEach((({field:e,key:i,label:n})=>{if(!e)return;const o={abFieldID:e.id,label:e.label,disabled:!0,key:i,_key:i,type:"textfield",input:!0};switch(e.key){case"boolean":o.type="checkbox";break;case"calculate":o.inputType="text",o.calculateValue=`value = ${e.settings.formula.replace(/{/g,"data['").replace(/}/g,"']")}`;break;case"connectObject":o.inputType="text",o.calculateValue=`value = data['${i}.format']`;break;case"date":o.type="datetime",o.format="MMMM d, yyyy";break;case"datetime":o.type="datetime",o.format="MMMM d, yyyy h:mm a";break;case"email":o.type="email";break;case"file":o.type="htmlelement",o.tag="a",o.className="btn btn-primary btn-block",o.content=`<i class='fa fa-paperclip'></i> {{data['${i}']?.filename ?? "No File"}}`,o.attrs=[{attr:"href",value:e.urlFile(`{{data['${i}'].uuid}}`)},{attr:"target",value:"_blank"}],o.refreshOnChange=!0,o.input=!1;break;case"image":o.type="htmlelement",o.tag="img",o.className="img-thumbnail max100",o.content="",o.attrs=[{attr:"src",value:e.urlImage(`{{data['${i}']}}`)}],o.refreshOnChange=!0,o.input=!1;break;case"list":var a=[];e.settings.options.forEach((e=>{a.push({label:e.text,value:e.id})})),o.type="select",o.data={values:a},o.multiple=e.settings.isMultiple;break;case"LongText":o.type="textarea";break;case"number":o.type="number";break;case"TextFormula":o.inputType="text",o.calculateValue=`value = '${e.settings.textFormula}'`}t[i]={title:n,key:i,icon:e.icon,schema:o}})),t.approveButton={title:this.label("Approve Button"),key:"approve",icon:"check-square",schema:{label:this.label("Approve"),type:"button",key:"approve",event:"approve",block:!0,size:"lg",input:!1,leftIcon:"fa fa-thumbs-up",action:"event",theme:"success"}},t.denyButton={title:this.label("Deny Button"),key:"deny",icon:"ban",schema:{label:this.label("Deny"),type:"button",key:"deny",event:"deny",block:!0,size:"lg",input:!1,leftIcon:"fa fa-thumbs-down",action:"event",theme:"danger"}},t.customButton={title:this.label("Custom Action Button"),key:"custom",icon:"cog",schema:{label:this.label("Custom Name"),type:"button",key:"custom",event:"yourEvent",block:!0,size:"lg",input:!1,leftIcon:"fa fa-cog",action:"event",theme:"primary"}},t}}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={id:n,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nc=void 0,(()=>{"use strict";var e=i(5256),t=i.n(e),n=i(3285),o=null;function a(e){if(!o){const i=(0,n.Z)(e);var t=i.L();o=class extends i{constructor(e){var i="abd_common_popupEditMenu";super(i),this.labels={copy:t("Copy"),exclude:t("Exclude"),rename:t("Rename"),delete:t("Delete")},this.ids.menu=`${i}_menu_${e}`,this.ids.list=`${i}_list_${e}`,this.Popup=null,this._menuOptions=[{label:this.labels.rename,icon:"fa fa-pencil-square-o",command:"rename"},{label:this.labels.copy,icon:"fa fa-files-o",command:"copy"},{label:this.labels.exclude,icon:"fa fa-reply",command:"exclude"},{label:this.labels.delete,icon:"fa fa-trash",command:"delete"}]}ui(){return{view:"popup",id:this.ids.menu,head:t("Application Menu"),width:120,body:{view:"list",id:this.ids.list,borderless:!0,data:[],datatype:"json",template:"<i class='fa #icon#' aria-hidden='true'></i> #label#",autoheight:!0,select:!1,on:{onItemClick:e=>{const{command:t}=$$(this.ids.list).getItem(e);return this.trigger(t)}}}}}async init(e,t){if(t=t||{},null==this.Popup&&(this.Popup=webix.ui(this.ui())),this.$list=$$(this.ids.list),this.hide(),this.menuOptions(this._menuOptions),t.hideCopy){let e=this.$list.data.find((e=>e.label==this.labels.copy))[0];if(e&&(this.$list.remove(e.id),this.$list.refresh()),t.hideExclude){let e=this.$list.data.find((e=>e.label==this.labels.exclude))[0];e&&(this.$list.remove(e.id),this.$list.refresh())}}}menuOptions(e){this.$list.clearAll(),this._menuOptions=e;var t=[];e.forEach((e=>{t.push({label:e.label,icon:e.icon,command:e.command})})),this.$list.parse(t),this.$list.refresh()}show(e){this.Popup?.show(e)}trigger(e){if(e)return this.hide(),this.emit("click",e),!1}hide(){this.Popup?.hide()}}}return o}function s(e,t,i){t=t||"ui_warnings";const o=(0,n.Z)(e);var a=o.L();return new class extends o{constructor(e,t={}){super(e,{buttonWarning:"",buttonWarningHide:"",warnings:"",warningsScroll:""})}ui(){var e=this.ids;return{rows:[{view:"button",type:"form",id:e.buttonWarning,css:"webix_primary darkorange",value:`<i class="fa fa-warning"></i> ${a("Show Issues")}`,hidden:!0,click:()=>{$$(e.warnings).show(),$$(e.buttonWarning).hide(),$$(e.buttonWarningHide).show()}},{view:"button",type:"form",id:e.buttonWarningHide,css:"webix_primary darkorange",value:`<i class="fa fa-warning"></i> ${a("Hide Issues")}`,hidden:!0,click:()=>{$$(e.warnings).hide(),$$(e.buttonWarningHide).hide(),$$(e.buttonWarning).show()}},{id:e.warnings,view:"scrollview",scroll:"y",css:"webix_theme_dark",minHeight:300,body:{rows:[{id:e.warningsScroll,template:"Here are my warnings",autoheight:!0,css:"webix_theme_dark"}]},hidden:!0}]}}async init(e){this.AB=e}show(e){super.show();var t=this.ids;let i=e?.warningsAll().map((e=>e.message));if(i=this.AB.uniq(i),i?.length){let e="<ul class='warningslist'>";i.forEach((t=>{t&&(e+=`<li><i class="warningtext fa fa-warning"></i> ${t}</li>`)})),e+="</ul>",$$(t.warningsScroll).setHTML(e),$$(t.warnings).isVisible()?($$(t.buttonWarning).hide(),$$(t.buttonWarningHide).show()):($$(t.buttonWarning).show(),$$(t.buttonWarningHide).hide())}else $$(t.warningsScroll).setHTML(""),$$(t.warnings).hide(),$$(t.buttonWarning).hide(),$$(t.buttonWarningHide).hide()}}(t,i)}var r=i(8788);function l(e,t){var i=a(e);const n=e.Config.uiSettings();var o=function(...t){return e.Multilingual.labelPlugin("ABDesigner",...t)};class s extends e.ClassUI{constructor(e){var t=e.idBase||"ui_common_list";if(super(t,{listSetting:"",list:"",searchText:"",sort:"",group:"",buttonNew:""}),this.idBase=t,this.labels={addNew:"Add new item",confirmDeleteTitle:"Delete Item",title:"Items",searchPlaceholder:"Item name",renameErrorMessage:"error renaming {0}",confirmDeleteMessage:"Do you want to delete <b>{0}</b>?",listSearch:"Search",listSetting:"Settings",listSort:"Sort",listAsc:"A -> Z",listDesc:"Z -> A",listGroup:"Group"},e.labels)for(var i in e.labels)this.labels[i]=e.labels[i];e.menu=e.menu||{},e.menu.copy=void 0===e.menu.copy||e.menu.copy,e.menu.exclude=void 0===e.menu.exclude||e.menu.exclude,this.attributes=e,this._templateListItem=e.templateListItem||["<div class='ab-object-list-item'>","#label##warnings#","{common.iconGear}","</div>"].join(""),this.cacheTemplate={},this.CurrentApplication=null,this.itemList=null,this._initialized=!1,this._settings={}}ui(){this.PopupEditComponent=new i(this.ids.component);var t=this.ids;return{id:this.ids.component,rows:[{view:e.custom.editunitlist.view,id:this.ids.list,width:n.columnWidthLarge,select:!0,editaction:"custom",editable:!0,editor:"text",editValue:"label",uniteBy:()=>o(this.labels.title),template:(e,t)=>this.templateListItem(e,t),tooltip:e=>this.toolTipListItem(e),type:{height:35,headerHeight:35,iconGear:e=>`<div class="ab-object-list-edit"><span class="webix_icon fa fa-cog" data-cy="${this.ids.list}_edit_${e.id}"></span></div>`},on:{onAfterSelect:e=>{this.onSelectItem(e)},onBeforeEditStop:(e,t)=>{this.onBeforeEditStop(e,t)},onAfterEditStop:(e,t,i)=>{this.onAfterEditStop(e,t,i)},onAfterRender(){this.data.each((i=>{e.ClassUI.CYPRESS_REF(this.getItemNode(i.id),`${t.list}_${i.id}`)}))}},onClick:{"ab-object-list-edit":(e,t,i)=>{this.clickEditMenu(e,t,i)}}},{view:"accordion",multi:!0,css:"ab-object-list-filter",rows:[{id:this.ids.listSetting,header:o(this.labels.listSetting),headerHeight:45,headerAltHeight:45,body:{padding:5,rows:[{id:this.ids.searchText,view:"search",icon:"fa fa-search",label:o(this.labels.listSearch),labelWidth:80,placeholder:o(this.labels.searchPlaceholder),height:35,keyPressTimeout:100,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)},onTimedKeyPress:()=>{this.listSearch(),this.save()}}},{id:this.ids.sort,view:"segmented",label:o(this.labels.listSort),labelWidth:80,height:35,options:[{id:"asc",value:o(this.labels.listAsc)},{id:"desc",value:o(this.labels.listDesc)}],on:{onAfterRender(){this.$view.querySelectorAll("button").forEach((i=>{var n=i.getAttribute("button_id");e.ClassUI.CYPRESS_REF(i,`${t.sort}_${n}`)}))},onChange:e=>{this.listSort(e),this.save()}}},{id:this.ids.group,view:"checkbox",label:o(this.labels.listGroup),labelWidth:80,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)},onChange:e=>{this.listGroup(e),this.save()}}}]}}],on:{onAfterCollapse:()=>{this.listSettingCollapse(),this.save()},onAfterExpand:()=>{this.listSettingExpand(),this.save()}}},{view:"button",css:"webix_primary",id:this.ids.buttonNew,value:o(this.labels.addNew),type:"form",click:()=>{this.clickAddNew(!0)},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}}init(e){this.AB=e,$$(this.ids.component)&&$$(this.ids.component).adjust(),this.$list=$$(this.ids.list),this.$list&&(webix.extend(this.$list,webix.ProgressBar),this.$list.adjust()),this.PopupEditComponent.init(e,{hideCopy:!this.attributes.menu.copy,hideExclude:!this.attributes.menu.exclude}),this.PopupEditComponent.on("click",(e=>{var t=this.$list.getSelectedItem(!1);switch(e){case"delete":this.remove();break;case"rename":this.rename();break;case"exclude":this.emit("exclude",t);break;case"copy":this.copy(t);break;default:this.emit("menu",{command:e,id:t.id})}})),this._settings=this.AB.Storage.get(this.idBase)||{objectlistIsOpen:!1,objectlistSearchText:"",objectlistSortDirection:"",objectlistIsGroup:!1},this._initialized=!0}dataLoad(e){this.busy(),this.itemList=new webix.DataCollection({data:e});var t=$$(this.ids.listSetting);t.getParentView().blockEvent(),t.define("collapsed",1!=this._settings.objectlistIsOpen),t.refresh(),t.getParentView().unblockEvent();var i=$$(this.ids.searchText);i.blockEvent(),i.setValue(this._settings.objectlistSearchText),i.unblockEvent();var n=$$(this.ids.sort);n.blockEvent(),n.setValue(this._settings.objectlistSortDirection),n.unblockEvent();var o=$$(this.ids.group);o.blockEvent(),o.setValue(this._settings.objectlistIsGroup),o.unblockEvent();var a=this.$list;a&&(a.clearAll(),a.data.unsync(),a.data.sync(this.itemList),a.refresh(),a.unselectAll()),this.listSort(this._settings.objectlistSortDirection),this.listSearch(),this.ready()}clickEditMenu(e,t,i){return this.PopupEditComponent.show(i),!1}copy(e){var t=e.toObj();t.id="copy_"+(this.itemList?this.itemList.count():"01"),delete t.translations,t.name=t.name+" copy",t.label=t.name;var i=this.$list,n=i.getIndexById(i.getSelectedId());i.add(t,n),i.select(t.id),i.edit(t.id)}listSettingCollapse(){this._settings.objectlistIsOpen=!1}listSettingExpand(){this._settings.objectlistIsOpen=!0}busy(){this.$list?.showProgress?.({type:"icon"})}ready(){this.$list?.hideProgress?.()}listSearch(){var e=$$(this.ids.searchText).getValue().toLowerCase();this.$list.filter((function(t){return!t.label||t.label.toLowerCase().indexOf(e)>-1})),this._settings.objectlistSearchText=e}listSort(e){null!=this.itemList&&(this.itemList.sort("label",e),this.listSearch(),this._settings.objectlistSortDirection=e)}listGroup(e){1==e?this.$list.define("uniteBy",(e=>e.label.toUpperCase().substr(0,1))):this.$list.define("uniteBy",(()=>o(this.labels.title))),this.$list.refresh(),this._settings.objectlistIsGroup=e}listCount(){if(this.$list)return this.$list.count()}selectedItem(){return this.$list.getSelectedItem(!1)}onAfterEditStop(e,t){if(this.showGear(t.id),e.value!=e.old){this.busy();var i=this.$list.getSelectedItem(!1);if(i.label=e.value,i.save)i.save().catch((t=>{this.ready(),webix.alert({title:o("Alert"),text:o(this.labels.renameErrorMessage,e.old)}),this.AB.notify.developer(t,{context:"ui_common_list:onAfterEditStop():Error saving item.",id:i.id,value:e.value})})).then((()=>{this.ready()}));else if(0==i.id.indexOf("copy_")){i.name=i.label;var n=i.id;delete i.id,this.emit("copied",{item:i,currID:n})}}}onBeforeEditStop(e){var t=this.$list.getSelectedItem(!1);return t.label=e.value,!t.isValid||!t.isValid().fail()||(t.label=e.old,!1)}onSelectItem(e){var t=this.$list.getItem(e);this.emit("selected",t),this.showGear(e)}save(){this._initialized&&this.AB.Storage.set(this.idBase,this._settings)}selectItem(e){this.$list.blockEvent(),this.select(e),this.$list.unblockEvent()}showGear(e){let t=this.$list.getItemNode(e);if(t){let e=t.querySelector(".ab-object-list-edit");e&&(e.style.visibility="visible",e.style.display="block")}}templateListItem(e,t){if(!this.cacheTemplate[e.id]){e.warningsEval?.();var i=e.warningsAll();if("string"==typeof this._templateListItem){var n="";i.length>0&&(n=this.WARNING_ICON),this.cacheTemplate[e.id]=this._templateListItem.replace("#label#",e.label||"??label??").replace("{common.iconGear}",t.iconGear(e)).replace("#warnings#",n)}else this.cacheTemplate[e.id]=this._templateListItem(e,t,i);setTimeout((()=>{delete this.cacheTemplate[e.id]}),400)}return this.cacheTemplate[e.id]}toolTipListItem(e){let t=$$(this.ids.list).data.getItem(e.id).warningsAll().length;return t?`${t} issues`:""}clickAddNew(e){this.emit("addNew",e)}exclude(){var e=this.$list.getSelectedItem(!1);this.emit("exclude",e)}rename(){var e=this.$list.getSelectedId(!1);this.$list.edit(e)}remove(){var e=this.$list.getSelectedItem(!1);webix.confirm({title:o(this.labels.confirmDeleteTitle),text:o(this.labels.confirmDeleteMessage,[e.label]),ok:o("Yes"),cancel:o("No"),callback:async t=>{if(t){this.busy();try{await e.destroy(),this.ready(),this.itemList.remove(e.id),this.emit("deleted",e),this.emit("selected",null)}catch(e){this.AB.notify.developer(e,{context:"ui_common_list:remove(): error removing item"}),this.ready()}}}})}select(e){this.$list.select(e)}callbackProcessEditorMenu(e){switch(e){case"rename":this.rename();break;case"exclude":this.exclude();break;case"delete":this.remove()}}}return new s(t)}var c=i(2770),d=i.n(c);function u(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_object_list_newObject",{tab:""}),this.selectNew=!0,this.BlankTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_object_list_newObject_blank",{form:"",buttonSave:"",buttonCancel:""})}ui(){return{id:this.ids.component,header:i("Create"),body:{view:"form",id:this.ids.form,width:400,rules:{},elements:[{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Object name"),labelWidth:70,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_object_list_newObject_blank_name")}}},{name:"isSystemObject",view:"checkbox",labelRight:i("is this a System Object?"),labelWidth:0,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_object_list_newObject_blank_isSystemObj")}}},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Add Object"),autowidth:!0,type:"form",click:()=>this.save(),on:{onAfterRender(){t.CYPRESS_REF(this)}}}]}]}}}async init(e){return this.AB=e,this.$form=$$(this.ids.form),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form.clearValidation(),this.$form.clear()}onError(e){if(e){console.error(e);var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();webix.alert({title:i("Error creating Object: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}$$(this.ids.buttonSave).enable()}onSuccess(){this.formClear(),$$(this.ids.buttonSave).enable()}save(){var e=$$(this.ids.buttonSave);e.disable();var t=this.$form;if(t.clearValidation(),!t.validate())return e.enable(),!1;var i=t.getValues();i.primaryColumnName="uuid",this.emit("save",i)}show(){$$(this.ids.component)?.show()}}}(e),this.CsvTab=function(e){const t=(0,n.Z)(e);var i=t.L();let o=e.Config.uiSettings();return new class extends t{constructor(){super("ui_work_object_list_newObject_csv",{form:"",uploadFileList:"",separatedBy:"",headerOnFirstLine:"",columnList:"",importButton:""}),this._csvImporter=new(d())(e)}ui(){let e=this.ids;return{id:e.component,header:i("Import CSV"),body:{view:"form",id:e.form,width:400,rules:{},elements:[{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Object name"),labelWidth:o.labelWidthMedium},{view:"uploader",name:"csvFile",value:i("Choose a CSV file"),accept:"text/csv",multiple:!1,autosend:!1,link:e.uploadFileList,on:{onBeforeFileAdd:e=>this.loadCsvFile(e)}},{id:e.uploadFileList,name:"uploadedFile",view:"list",type:"uploader",autoheight:!0,borderless:!0,onClick:{webix_remove_upload:(e,t)=>{this.removeCsvFile(t)}}},{id:e.separatedBy,view:"richselect",name:"separatedBy",label:i("Separated by"),labelWidth:o.labelWidthXLarge,options:this._csvImporter.getSeparateItems(),value:",",on:{onChange:()=>{this.populateColumnList()}}},{id:e.headerOnFirstLine,view:"checkbox",name:"headerOnFirstLine",labelRight:i("Header on first line"),labelWidth:0,disabled:!0,value:!0,on:{onChange:()=>{this.populateColumnList()}}},{type:"space",rows:[{view:"scrollview",height:260,minHeight:260,maxHeight:260,body:{id:e.columnList,disabled:!0,rows:[]}}]},{margin:5,cols:[{fillspace:!0},{view:"button",name:"cancel",value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()}},{view:"button",name:"import",id:e.importButton,value:i("Import"),css:"webix_primary",disabled:!0,autowidth:!0,type:"form",click:()=>{this.import()}}]}]}}}async init(e){return this.AB=e,this.allFields=this.AB.Class.ABFieldManager.allFields(),this._dataRows=[],this.$form=$$(this.ids.form),this.$uploadFileList=$$(this.ids.uploadFileList),this.$separatedBy=$$(this.ids.separatedBy),this.$headerOnFirstLine=$$(this.ids.headerOnFirstLine),this.$columnList=$$(this.ids.columnList),this.$importButton=$$(this.ids.importButton),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}async loadCsvFile(e){if(!this._csvImporter.validateFile(e))return webix.alert({title:i("This file extension is not allowed"),text:i("Please only upload CSV files"),ok:i("OK")}),!1;this.$form.showProgress&&this.$form.showProgress({type:"icon"});let t=this.$separatedBy.getValue();return this._dataRows=await this._csvImporter.getDataRows(e,t),this.$headerOnFirstLine.enable(),this.$columnList.enable(),this.$importButton.enable(),this.populateColumnList(),this.$form.hideProgress&&this.$form.hideProgress(),!0}removeCsvFile(e){return this.$uploadFileList.remove(e),this.formClear(),!0}populateColumnList(){webix.ui([],this.$columnList);var e=this._dataRows[0];if(null==e)return;var t=[];if(this.$headerOnFirstLine.getValue())t=e.map(((e,t)=>({include:!0,columnName:e,dataType:this._csvImporter.getGuessDataType(this._dataRows,t)})));else for(var i=0;i<e.length;i++)t.push({include:!0,columnName:"Field "+(i+1),dataType:this._csvImporter.getGuessDataType(this._dataRows,i)});let n=[];t.forEach((e=>{n.push({height:40,cols:[{view:"checkbox",value:e.include,width:30},{view:"text",value:e.columnName,width:o.labelWidthXLarge},{view:"select",value:e.dataType,options:[{id:"string",value:this.allFields.filter((e=>"string"==e.key))[0].defaults().menuName},{id:"LongText",value:this.allFields.filter((e=>"LongText"==e.key))[0].defaults().menuName},{id:"number",value:this.allFields.filter((e=>"number"==e.key))[0].defaults().menuName},{id:"date",value:this.allFields.filter((e=>"date"==e.key))[0].defaults().menuName},{id:"boolean",value:this.allFields.filter((e=>"boolean"==e.key))[0].defaults().menuName}],width:120}]})})),webix.ui(n,$$(this.$columnList))}import(){if(this.$importButton.disable(),!this.$form.validate())return this.$importButton.enable(),!1;let e=$$(this.$columnList).getChildViews();if(e.filter((e=>e.queryView({view:"checkbox"}).getValue()&&0==e.queryView({view:"text"}).getValue().trim().length)).length>0)return webix.alert({title:i("Column name is required"),text:i("Please enter column name"),ok:i("OK")}),this.$importButton.enable(),!1;if(e.filter((e=>e.queryView({view:"checkbox"}).getValue()&&this.allFields[0].reservedNames.indexOf(e.queryView({view:"text"}).getValue().trim().toLowerCase())>-1)).length>0)return webix.alert({title:i("Column name is invalid"),text:i("Please enter column name that does not match [{0}]",this.allFields[0].reservedNames.join(", ")),ok:i("OK")}),this.$importButton.enable(),!1;let t={primaryColumnName:"uuid",name:this.$form.getValues().name};this.emit("save",t)}onSuccess(t){let i=Promise.resolve();$$(this.$columnList).getChildViews().forEach(((e,n)=>{if(!e.queryView({view:"checkbox"}).getValue())return;let o=e.queryView({view:"text"}).getValue(),a=e.queryView({view:"select"}).getValue(),s={columnName:o,label:o,key:a,settings:{showIcon:1,weight:n}};switch(a){case"string":case"LongText":s.settings.supportMultilingual=0}let r=t.fieldNew(s);i=i.then((()=>r.save()))}));var n=t.model();return this._dataRows.forEach(((e,o)=>{i=i.then((()=>{if(this.$headerOnFirstLine.getValue()&&0==o)return Promise.resolve();var i={},a=e;return t.fields().forEach((e=>{null!=a[e.settings.weight]&&(i[e.columnName]=a[e.settings.weight])})),n.create(i)}))})),i.then((()=>(this.formClear(),this.$importButton.enable(),Promise.resolve()))).catch((t=>{e.notify.developer(t,{message:"Error import data rows from CSV"})}))}onError(e){e&&(e.updateForm&&e.updateForm(this.$form),this.$importButton.enable())}cancel(){this.formClear(),this.emit("cancel")}formClear(){this._dataRows=[],this.$form.clearValidation(),this.$form.clear(),this.$separatedBy.setValue(","),webix.ui([],$$(this.$columnList)),this.$uploadFileList.clearAll(),this.$headerOnFirstLine.disable(),this.$columnList.disable(),this.$importButton.disable()}}}(e),this.ImportTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_object_list_newObject_import",{form:"",filter:"",objectList:"",columnList:"",buttonSave:"",buttonCancel:""})}ui(){return{id:this.ids.component,header:i("Existing"),body:{view:"form",id:this.ids.form,width:400,elements:[{cols:[{view:"icon",icon:"fa fa-filter",align:"left"},{view:"text",id:this.ids.filter,on:{onTimedKeyPress:()=>this.filter()}}]},{view:"list",id:this.ids.objectList,select:!0,height:200,minHeight:250,maxHeight:250,data:[],template:"<div>#label#</div>",on:{onSelectChange:()=>this.objectSelect()}},{view:"label",label:`<b>${i("Columns")}</b>`,height:20},{view:"list",id:this.ids.columnList,datatype:"json",multiselect:!1,select:!1,height:200,minHeight:200,maxHeight:200,type:{height:40,isvisible:{view:"checkbox",width:30}},template:e=>`\n                               <span style="float: left;"><i class="fa fa-${e.icon}"></i></span>\n                               <span style="float: left;">&nbsp;${e.label}</span>\n                           `},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>this.cancel()},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Import"),autowidth:!0,type:"form",click:()=>this.save()}]}]}}}init(e){return this.AB=e,this.$form=$$(this.ids.form),this.$filter=$$(this.ids.filter),this.$objectList=$$(this.ids.objectList),this.$columnList=$$(this.ids.columnList),this.$buttonSave=$$(this.ids.buttonSave),this.$buttonCancel=$$(this.ids.buttonCancel),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}onShow(){this.formClear();let t=this.CurrentApplication.objectsExcluded((t=>!t.isSystemObject||e.Account.isSystemDesigner()));this.$objectList.parse(t,"json")}filter(){let e=this.$filter.getValue();this.$objectList.filter("#label#",e)}objectSelect(){this.$columnList.clearAll();let e=this.$objectList.getSelectedItem(!1);if(e){let t=[];e.fields().forEach((e=>{t.push({id:e.id,label:e.label,isvisible:!0,icon:e.icon})})),0==t.length&&t.push({id:"none",label:i("No Fields Defined"),isvisible:!0}),this.$columnList.parse(t)}}async save(){var e=this.$objectList.getSelectedItem();if(!e)return!1;this.$buttonSave.disable(),await this.CurrentApplication.objectInsert(e),this.emit("imported",e),this.$buttonSave.enable()}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form.clearValidation(),this.$form.clear(),this.$objectList.clearAll(),this.$columnList.clearAll()}onError(e){if(e){var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();webix.alert({title:i("Error creating Object: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}this.$buttonSave.enable()}onSuccess(){this.$buttonSave.enable()}}}(e)}ui(){return{view:"window",id:this.ids.component,position:"center",modal:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Add new object"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.emit("cancel")},on:{onAfterRender(){t.CYPRESS_REF(this)}}}]},selectNewObject:!0,body:{view:"tabview",id:this.ids.tab,cells:[this.BlankTab.ui(),this.CsvTab.ui(),this.ImportTab.ui()],tabbar:{on:{onAfterTabClick:e=>{this.switchTab(e)},onAfterRender(){this.$view.querySelectorAll(".webix_item_tab").forEach((e=>{var i=e.getAttribute("button_id");t.CYPRESS_REF(e,`${i}_tab`)}))}}}},on:{onBeforeShow:()=>{var e=$$(this.ids.tab).getValue();this.switchTab(e)}}}}async init(e){this.AB=e,webix.ui(this.ui()),webix.extend($$(this.ids.component),webix.ProgressBar),this.$component=$$(this.ids.component);var t=[];return["BlankTab","CsvTab","ImportTab"].forEach((i=>{t.push(this[i].init(e)),this[i].on("cancel",(()=>{this.emit("cancel")})),this[i].on("save",(e=>{this.save(e,i)}))})),this.ImportTab.on("imported",(e=>{this.done(e)})),Promise.all(t)}applicationLoad(e){super.applicationLoad(e),this.BlankTab.applicationLoad(e),this.CsvTab.applicationLoad(e),this.ImportTab.applicationLoad(e)}hide(){this.$component?.hide()}busy(){this.$component?.showProgress?.()}ready(){this.$component?.hideProgress?.()}done(e){this.ready(),this.hide(),this.emit("save",e,this.selectNew)}async save(e,t){if(!this.CurrentApplicationID)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this[t].emit("save.error",!0),!1;var n=this.AB.objectNew(e),o=n.isValid();if(o.fail())return this[t].emit("save.error",o),!1;n.createdInAppID||(n.createdInAppID=this.CurrentApplicationID),this.busy();var a=this.CurrentApplication;try{var s=await n.save();await a.objectInsert(s),this[t].emit("save.successful",s),this.done(s)}catch(e){this.ready(),await a.objectRemove(n),this[t].emit("save.error",e)}}show(e){null!=e&&(this.selectNew=e),this.$component&&this.$component.show()}switchTab(e){e==this.BlankTab?.ids.form?this.BlankTab?.onShow?.(this.CurrentApplicationID):e==this.CsvTab?.ids.form?this.CsvTab?.onShow?.(this.CurrentApplicationID):e==this.ImportTab?.ids.form?this.ImportTab?.onShow?.(this.CurrentApplicationID):e==this.ExternalTab?.ids.form&&this.ExternalTab?.onShow?.(this.CurrentApplicationID)}}}function h(e,t){t=t||"ui_work_object_workspace_popupIndex";const i=(0,n.Z)(e);var o=i.L();const a=e.Class.ABIndex;return new class extends i{constructor(e){super(e,{popup:"",form:"",name:"",fields:"",unique:"",removeButton:"",saveButton:""})}ui(){let e=this.ids;return{view:"window",id:e.popup,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:o("Custom Index"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.close()},on:{onAfterRender(){i.CYPRESS_REF(this)}}}]},position:"center",resize:!0,modal:!0,editable:!1,width:500,height:500,body:{view:"form",id:e.form,elements:[{id:e.name,view:"text",label:o("Name"),name:"name"},{id:e.fields,view:"multicombo",label:o("Fields"),name:"fieldIDs",options:[]},{id:e.unique,view:"checkbox",label:o("Unique"),name:"unique"},{cols:[{id:e.removeButton,view:"button",type:"icon",icon:"fa fa-trash-o",css:"webix_danger",width:40,click:()=>this.removeIndex()},{fillspace:!0},{view:"button",value:o("Cancel"),width:100,click:()=>this.close()},{id:e.saveButton,view:"button",type:"icon",icon:"fa fa-floppy-o",css:"webix_primary",label:o("Save"),width:100,click:()=>this.save()}]}]}}}init(e){this.AB=e,webix.ui(this.ui());let t=$$(this.ids.form);t&&webix.extend(t,webix.ProgressBar)}open(e,t){this.CurrentObjectID=e.id,this.CurrentIndex=t;let i=this.ids,n=$$(i.popup);if(!n)return;n.show();let o=$$(i.fields);if(o&&this.CurrentObject){var a=["number","date","datetime","boolean","list","email","user","AutoIndex","combined"];let e=this.CurrentObject.fields((e=>a.indexOf(e.key)>-1||("string"==e.key||"LongText"==e.key)&&e.settings&&!e.settings.supportMultilingual||"connectObject"==e.key&&("one"==e.settings.linkType&&"many"==e.settings.linkViaType||"one"==e.settings.linkType&&"one"==e.settings.linkViaType&&e.settings.isSource))).map((e=>({id:e.id,value:e.label})));o.define("options",e),o.refresh()}let s=$$(this.ids.form);s&&(s.clear(),t&&s.setValues(t.toObj()));let r=$$(i.name),l=$$(i.unique),c=$$(i.saveButton),d=$$(i.removeButton);this.CurrentIndex?(r.disable(),o.disable(),l.disable(),c.hide(),d.show()):(r.enable(),o.enable(),l.enable(),c.show(),d.hide())}async save(){let e=$$(this.ids.form);if(!e)return;this.busy();let t=e.getValues();t.fieldIDs=t.fieldIDs.split(","),null==this.CurrentIndex&&(this.CurrentIndex=new a(t,this.CurrentObject)),this.CurrentIndex.fromValues(t);try{await this.CurrentIndex.save(),this.ready(),this.emit("changed"),this.close()}catch(e){let i=o("The system could not create your index.");"ER_DUP_ENTRY"===e.code&&(i=`${i} : ${o("There are duplicated values in this column.")}`),this.AB.notify.developer(e,{context:`${this.ids.component}:save()`,message:i,vals:t}),webix.alert({type:"alert-error",title:o("Failed"),text:i}),this.ready()}}close(){let e=$$(this.ids.popup);e&&e.hide()}busy(){$$(this.ids.form)?.showProgress?.({type:"icon"}),$$(this.ids.saveButton)?.disable(),$$(this.ids.removeButton)?.disable()}ready(){$$(this.ids.form)?.hideProgress?.(),$$(this.ids.saveButton)?.enable(),$$(this.ids.removeButton)?.enable()}removeIndex(){this.CurrentIndex&&webix.confirm({title:o("Delete this Index"),message:o("Do you want to remove this index ?"),callback:async e=>{if(e){this.busy();try{await this.CurrentIndex.destroy(),this.ready(),this.emit("changed"),this.close()}catch(e){this.AB.notify.developer(e,{context:`${this.ids.component}:removeIndex()`,ABIndex:this.CurrentIndex.toObj()}),this.ready()}}}})}}(t)}function p(e,t){t=t||"ui_work_object_workspace_popupDefineLabel";const i=(0,n.Z)(e);var o=i.L();return new class extends i{constructor(e){super(e,{format:"",list:"",buttonSave:""})}ui(){let e=this.ids;return{view:"popup",id:e.component,modal:!0,autoheight:!0,width:500,body:{rows:[{view:"label",label:o("<b>Label format</b>")},{view:"textarea",id:e.format,height:100},{view:"label",label:o("Select field item to generate format.")},{view:"label",label:o("<b>Fields</b>")},{view:"list",name:"columnList",id:e.list,width:500,height:180,maxHeight:180,select:!1,template:"#label#",on:{onItemClick:(e,t,i)=>{this.onItemClick(e,t,i)}}},{height:10},{cols:[{fillspace:!0},{view:"button",name:"cancel",value:o("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.buttonCancel()}},{view:"button",css:"webix_primary",name:"save",id:e.buttonSave,label:o("Save"),type:"form",autowidth:!0,click:()=>{this.buttonSave()}}]}]},on:{onShow:()=>{this.onShow()}}}}init(e){this.AB=e,webix.ui(this.ui()),webix.extend($$(this.ids.list),webix.ProgressBar)}changed(){this.emit("changed",this._settings)}buttonCancel(){$$(this.ids.component).hide()}async buttonSave(){var e=this.ids,t=$$(e.buttonSave);t.disable();var i=$$(e.format).getValue(),n=$$(e.list);n.showProgress({type:"icon"}),n.data.each((function(e){i=i.replace(new RegExp("{"+e.label+"}","g"),"{"+e.id+"}")})),this.CurrentObject.labelFormat=i;try{await this.CurrentObject.save(),this.hide(),this.changed()}catch(e){this.AB.notify.developer(e,{context:"ui_work_object_workspace_popupDefineLabel:buttonSave(): Error trying to save our Object"})}n.hideProgress(),t.enable()}hide(){$$(this.ids.component).hide()}objectLoad(e){super.objectLoad(e);var t=$$(this.ids.list);t.clearAll();var i=e.fields((e=>e.fieldUseAsLabel())).map((e=>({id:e.id,label:e.label})));t.parse(i),t.refresh()}onItemClick(e){var t=this.ids,i=$$(t.list).getItem(e),n=$$(t.format).getValue();n+=`{${i.label}}`,$$(t.format).setValue(n)}onShow(){var e=this.ids,t=this.CurrentObject.labelFormat,i=$$(e.format),n=$$(e.list);if(i.setValue(""),i.enable(),n.enable(),$$(e.buttonSave).enable(),t)n.data?.count()>0&&n.data.each((function(e){t=t.replace(new RegExp(`{${e.id}}`,"g"),`{${e.label}}`)}));else if(n.data?.count()>0){var o=n.getItem(n.getFirstId());t=`{${o.label}}`}i.setValue(t||"")}show(e){$$(this.ids.component).show(e)}}(t)}function m(e,t){t=t||"ui_work_object_workspace_popupExport";const i=(0,n.Z)(e);return new class extends i{constructor(e){super(e,{popupExport:"",list:""}),this.DatacollectionID=null,this.grid=null,this.filename=null,this.hiddenFields=[]}ui(){var e=this;return{view:"popup",id:this.ids.popupExport,width:160,height:180,select:!1,hidden:!0,body:{id:this.ids.list,view:"list",data:[{name:"CSV",icon:"file-excel-o"},{name:"Excel",icon:"file-excel-o"},{name:"PDF",icon:"file-pdf-o"},{name:"PNG",icon:"file-image-o"}],template:"<div><i class='fa fa-#icon# webix_icon_btn' aria-hidden='true'></i> #name#</div>",on:{onItemClick:function(t){var i=this.getItem(t);e.export(i.name)}}}}}init(e){this.AB=e,webix.ui(this.ui())}get Datacollection(){return this.AB.datacollectionByID(this.DatacollectionID)}dataCollectionLoad(e){this.DatacollectionID=e.id}setHiddenFields(e){this.hiddenFields=e||[]}setFilename(e){this.filename=e}setGridComponent(e){this.grid=e}show(e){$$(this.ids.popupExport).show(e)}async export(e){let t,i={},n=this.Datacollection;!n||n.settings.loadAll&&n.dataStatus!=n.dataStatusFlag.notInitial||(await n.reloadData(0,null),n.settings.loadAll=!0);var o=this.CurrentObject;o&&o.fields().forEach((e=>{this.hiddenFields.indexOf(e.columnName)>-1||(i[e.columnName]={template:t=>e.format(t)})}));var a=this.grid;if(a){var s=this.filename,r=o?o.label:null;switch(e){case"CSV":webix.csv.delimiter.cols=",",t=webix.toCSV(a,{_filename:this.filename||r,columns:i});break;case"Excel":t=webix.toExcel(a,{filename:s||r,name:s||r,columns:i,filterHTML:!0});break;case"PDF":t=webix.toPDF(a,{filename:s||r,filterHTML:!0});break;case"PNG":t=webix.toPNG(a,{filename:s||r})}try{await t,$$(this.ids.popupExport).hide()}catch(t){this.AB.notify.developer(t,{message:`${this.ids.component}:export(): could not export: ${e}`})}}}}(t)}var f=i(5997),g=i(6038),v=i(231);function b(e,t){t=t||"ui_work_object_workspace_popupImport";const i=(0,n.Z)(e),o=new((0,v.default)(e));return new class extends i{constructor(e){super(e),this.popup=null}ui(){return{}}init(e){this.AB=e;var t=o.toSettings(),i=this.AB.viewNewDetatched(t);this.popup=i.component(),this.popup.init(e),this.popup.objectLoad(this.CurrentObject)}objectLoad(e){super.objectLoad(e),this.popup?.objectLoad(e)}show(){this.popup.showPopup()}hide(){this.popup.hide()}}(t)}var y=i(2439),w=i(423),x=i(4550),$={name:"Default Grid",sortFields:[],filterConditions:[],frozenColumnID:"",hiddenFields:[]};function _(e,t){const i=(0,n.Z)(e);return i.L(),new class extends i{constructor(e){super(e)}type(){return"grid"}icon(){return"fa fa-table"}fromSettings(e){for(var t in $)this[t]=e[t]||$[t];this.type=this.type(),this.key=this.type()}toSettings(){var e={};for(var t in $)e[t]=this[t]||$[t];return e.key=this.type(),e.type=this.type(),e}}(t)}var C=i(5609);function E(e,t){t=t||"ui_work_object_workspace_popupHideFields";const i=(0,n.Z)(e);return new class extends i{constructor(t){super(t,{}),this.AB=e,this.base=t,this.rowFilter=this.AB.filterComplexNew(`${this.ids.component}_filter`),this.rowFilter.on("save",((...e)=>{this.emit("save",...e),this.hide()}))}objectLoad(e){super.objectLoad(e),this.rowFilter&&this.rowFilter.fieldsLoad(e.fields(),e)}viewLoad(e){this.view=e}ui(){return{view:"popup",id:this.ids.component,autoheight:!0,minHeight:350,minWidth:400,body:this.rowFilter.ui,on:{onHide:()=>{this.hide()}}}}init(e){this.AB=e,webix.ui(this.ui()),this.$Component=$$(this.ids.component),this.$List=$$(this.ids.list)}show(e,t=null){this.$Component.isVisible()||(null!=t?this.$Component?.show(e,t):this.$Component?.show(e))}hide(e,t=null){null!=t?this.$Component.hide(e,t):this.$Component.hide(e)}setFilter(e){e.rules?.length||(e=e[0]||[]),this.rowFilter.setValue(e)}}(t)}function S(e,t,i){t=t||"ui_work_object_workspace_view_grid";const o=(0,n.Z)(e);var a=o.L();const s=_(e);return new class extends o{constructor(e,t={}){super(e),t.isReadOnly=t.isReadOnly??!1,this.settings=t}ui(){return{id:this.ids.component,rows:[{},{view:"label",label:"Impressive View -> Grid"},{}]}}async init(e){this.AB=e}defaultSettings(t){var i=s.toSettings();i.label=a(i.name);var n=this.AB.viewNewDetatched(i).toObj();return n.id=t?.id??e.jobID(),["isEditable","massUpdate","allowDelete","trackView"].forEach((e=>{n.settings[e]=1})),n.settings.padding=0,n.settings.showToolbar=0,n.settings.gridFilter={filterOption:0,isGlobalToolbar:0},{id:n.id,isDefaultView:!1,type:n.type,icon:n.icon,name:"Default Grid",sortFields:[],filterConditions:[],frozenColumnID:"",hiddenFields:[],component:n}}getColumnIndex(e){return this._currentComponent.getColumnIndex(e)}datacollectionLoad(e){this.datacollection=e}get $grid(){return this._currentComponent?.getDataTable()}ready(){this.ListComponent.ready()}async show(e){await this.viewLoad(e),$$(this.ids.component).show(),this.emit("show")}async viewLoad(e){if(e.id==this.currentViewDef?.id)return;this.currentViewDef=e,this.currentView=this.AB.viewNewDetatched(e.component),this.currentView.warningsSilent=!0;var t=this.currentView.component();t.datacollectionLoad(this.datacollection);var i=t.ui();i.id=this.ids.component,webix.ui(i,$$(this.ids.component));let n=2;this.settings.isReadOnly&&(n=1),await t.init(this.AB,n),t.datacollectionLoad(this.datacollection),t.on("column.header.clicked",((e,t)=>{this.emit("column.header.clicked",e,t)})),t.on("object.track",((e,t)=>{this.emit("object.track",e,t)})),t.on("selection",(()=>{this.emit("selection")})),t.on("selection.cleared",(()=>{this.emit("selection.cleared")})),t.on("column.order",(e=>{this.emit("column.order",e)})),this._currentComponent=t}viewNew(e){var t=this.defaultSettings(e);return Object.keys(e).forEach((i=>{t[i]=e[i]})),t}deleteSelected(e){return this._currentComponent.toolbarDeleteSelected(e)}massUpdate(e){return this._currentComponent.toolbarMassUpdate(e)}refreshHeader(e=[],t,i,n){var o=this.CurrentObject.columnHeaders(!0,!0,[],[],[]);this._currentComponent&&(this._currentComponent.columnConfig(o),this._currentComponent.settings.hiddenFields=e,this._currentComponent.settings.filterConditions=t,this._currentComponent.settings.sortFields=i,this._currentComponent.settings.frozenColumnID=n,this._currentComponent.refreshHeader(!0))}}(t,i)}function k(e,t){t=t||"ui_work_object_workspace_view_gantt";const i=(0,n.Z)(e),o=(i.L(),(0,x.Z)(e));return new class extends i{constructor(e){super(e)}ui(){return{id:this.ids.component,rows:[{},{view:"label",label:"Impressive View -> Gantt"},{}]}}async init(e){this.AB=e}defaultSettings(t){const i=o.toSettings();i.settings=Object.assign(i.settings,t.settings??{});const n=this.AB.viewNewDetatched(i).toObj();return n.id=t.id??e.jobID(),{id:n.id,isDefaultView:!1,type:n.type,icon:n.icon,name:"Default Gantt",sortFields:[],filterConditions:[],frozenColumnID:"",hiddenFields:[],component:n}}datacollectionLoad(e){this.datacollection=e}async show(e){await this.viewLoad(e),$$(this.ids.component).show(),this.emit("show")}async viewLoad(e){if(e.id==this.currentViewDef?.id)return;this.currentViewDef=e,this._currentComponent?.eventsClear(),this.currentView=this.AB.viewNewDetatched(e.component),this.currentView.warningsSilent=!0;const t=this.currentView.component(),i=t.ui();i.id=this.ids.component,webix.ui(i,$$(this.ids.component)),await t.init(this.AB),t.datacollectionLoad(this.datacollection),t.show(),this._currentComponent=t}viewNew(e){return Object.assign(this.defaultSettings(e),e)}}(t)}function A(e,t){t=t||"ui_work_object_workspace_view_kanban";const i=(0,n.Z)(e);var o=i.L();const a=(0,C.Z)(e,`${t}_prop`);return new class extends i{constructor(e){super(e)}ui(){return{id:this.ids.component,rows:[{},{view:"label",label:"Impressive View -> Kanban"},{}]}}async init(e){this.AB=e}defaultSettings(t){var i=a.toSettings();Object.keys(i.settings).forEach((e=>{i.settings[e]=t.settings[e]})),i.label=o(i.name);var n=this.AB.viewNewDetatched({key:"text"}),s=this.CurrentObject,r=s.labelFormat;!r&&s.fields().length>0&&s.fields((e=>e.fieldUseAsLabel())).forEach((e=>{r=`${r}<br>${e.label}: {${n.fieldKey(e)}}`})),i.settings.textTemplate=r,i.settings.editFields=s.fields().map((e=>e.id));var l=this.AB.viewNewDetatched(i).toObj();return l.id=t.id??e.jobID(),{id:l.id,isDefaultView:!1,type:l.type,icon:l.icon,name:"Default Kanban",sortFields:[],filterConditions:[],frozenColumnID:"",hiddenFields:[],component:l}}datacollectionLoad(e){this.datacollection=e}async show(e){await this.viewLoad(e),$$(this.ids.component).show(),this.emit("show")}async viewLoad(e){if(e.id!=this.currentViewDef?.id){this.currentViewDef=e,this.currentView=this.AB.viewNewDetatched(e.component),this.currentView.warningsSilent=!0;var t=this.currentView.component(),i=t.ui();i.id=this.ids.component,webix.ui(i,$$(this.ids.component)),await t.init(this.AB),t.datacollectionLoad(this.datacollection),t.show(),this._currentComponent=t}}viewNew(e){var t=this.defaultSettings(e);return Object.keys(e).forEach((i=>{t[i]=e[i]})),t}}(t)}function R(e,t,i){t=t||"ui_work_object_workspace_workspaceviews";const o=(0,n.Z)(e),a=S(e,`${t}_grid`,i),s=k(e),r=A(e),l=(0,x.Z)(e),c=_(e),d=(0,C.Z)(e);var u={};u[l.type()]=l,u[c.type()]=c,u[d.type()]=d;var h={};h[l.type()]=s,h[c.type()]=a,h[d.type()]=r;const p={currentViewID:void 0,list:[]};return new class extends o{constructor(t,i){super(t),this.AB=e,this._settings=null}async init(e){this.AB=e,Object.keys(h).forEach((t=>{h[t].init(e)})),this._settings=await this.AB.Storage.get("workspaceviews")||{}}objectLoad(e){this.CurrentObjectID&&(this._settings[this.CurrentObjectID]=this.toObj()),super.objectLoad(e),Object.keys(h).forEach((t=>{h[t].objectLoad(e)})),this.fromObj(this._settings[this.CurrentObjectID])}fromObj(t){if(0===((t=t||e.cloneDeep(p))?.list??[]).length){var i=a.defaultSettings();i.isDefaultView=!0,t.list.unshift(i)}this.importViews(t),this.currentViewID=t.currentViewID,this.currentViewID||(this.currentViewID=this.list()[0].id)}toObj(){return{currentViewID:this.currentViewID,list:this._views}}list(e=(()=>!0)){return this._views.filter(e)}importViews(e){this._views=[],e.list.forEach((e=>{this.viewAdd(e,!1)}))}getCurrentView(){return this._views.find((e=>e.id==this.currentViewID))}setCurrentView(e){this.currentViewID=e,this._currentView=this.getCurrentView()}async viewAdd(e,t=!0){return this._views.push(e),t&&await this.save(),e}async viewNew(e){var t=h[e.type];if(t){var i=t.viewNew(e);return await this.viewAdd(i),i}}viewRemove(e){var t=this._views.indexOf(e);this._views.splice(t,1),e.id===this.currentViewID&&(this.currentViewID=this._views[0].id),this.save()}async save(){this._settings[this.CurrentObjectID]=this.toObj();try{await this.AB.Storage.set("workspaceviews",this._settings)}catch(e){console.error(e)}}async viewUpdate(e){var t=h[e.type];if(t){delete e.component;var i=t.viewNew(e),n=[];this._views.forEach((e=>{e.id==i.id?n.push(i):n.push(e)})),this._views=n,await this.save()}}get filterConditions(){return this._currentView.filterConditions}set filterConditions(e){this._currentView.filterConditions=e}get frozenColumnID(){return this._currentView.frozenColumnID}set frozenColumnID(e){this._currentView.frozenColumnID=e}get hiddenFields(){return this._currentView.hiddenFields||[]}set hiddenFields(e){this._currentView.hiddenFields=e}get sortFields(){return this._currentView.sortFields}set sortFields(e=[]){this._currentView.sortFields=e}}(t,i)}function D(e,t,i){t=t||"abd_work_object_workspace";const o=e.Config.uiSettings(),r=(0,n.Z)(e);var l=r.L(),c=S(e,`${t}_view_grid`,i),d=k(e,`${t}_view_gantt`),u=A(e,`${t}_view_kanban`),v=s(e,`${t}_view_warnings`,i),$=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){var e="ui_work_object_workspace_track";super({popup:`${e}_popup`,timeline:`${e}_timeline`})}ui(){let e=this.ids;return{view:"window",id:e.popup,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Record History"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",align:"right",click:()=>{this.close()},on:{onAfterRender(){t.CYPRESS_REF(this)}}}]},position:"center",resize:!0,modal:!0,editable:!1,width:500,height:500,body:{view:"timeline",id:e.timeline,type:{height:140,templateDate:e=>this.AB.rules.toDateFormat(e.timestamp,{localeCode:"en",format:"DD MMM, YYYY hh:mma"}),lineColor:e=>{switch(e.level){case"insert":return"#FF5C4C";case"update":return"#1CA1C1";case"delete":return"#94A1B3"}}},scheme:{$init:e=>{switch(e.level){case"insert":e.value=i("Add");break;case"update":e.value=i("Edit");break;case"delete":e.value=i("Delete")}if(e.details=`by <b>${e.username||i("Unknown")}</b>`,e.record){let t="";Object.keys(e.record).forEach((i=>{t=t.concat(`${i}: <b>${null!=e.record[i]?e.record[i]:""}</b> <br />`)})),e.details=e.details.concat("<br />"),e.details=e.details.concat(`<div>${t}</div>`)}}}}}}init(e){this.AB=e,webix.ui(this.ui());let t=$$(this.ids.timeline);t&&webix.extend(t,webix.ProgressBar)}open(e,t){this.objectLoad(e);let i=this.ids,n=$$(i.popup);n&&(n.show(),this.loadData(t))}async loadData(e){if(!this.CurrentObject)return;let t=$$(this.ids.timeline);t.showProgress({type:"icon"});try{var n=this.CurrentObject.model().logs({rowId:e});t.clearAll(!0),t.parse(n)}catch(e){console.error(e),webix.alert({text:i("Unable to display logs for this entry.")})}t.hideProgress()}close(){let e=this.ids,t=$$(e.popup);t&&t.hide()}}}(e);return new class extends r{constructor(t,i={}){super(t,{buttonAddField:"",buttonDeleteSelected:"",buttonDeleteSelectedSpacer:"",buttonExport:"",buttonImport:"",buttonFieldsVisible:"",buttonFieldsVisibleSpacer:"",buttonFilter:"",buttonFrozen:"",buttonFrozenSpacer:"",buttonLabel:"",buttonMassUpdate:"",buttonMassUpdateSpacer:"",buttonRowNew:"",buttonSort:"",buttonSortSpacer:"",listIndex:"",buttonIndex:"",datatable:"",error:"",error_msg:"",viewMenu:"",viewMenuButton:"",viewMenuNewView:"",toolbar:"",noSelection:"",selectedObject:""}),i.isReadOnly=i.isReadOnly??!1,i.showWarnings=i.showWarnings??!0,this.settings=i,this.workspaceViews=R(e,`${t}_views`,{isReadOnly:this.settings.isReadOnly}),this.hashViews={},this.hashViews.grid=c,c.on("column.header.clicked",((e,t)=>{this.PopupHeaderEditMenu.show(e,t)})),c.on("object.track",((e,t)=>{$.open(e,t)})),c.on("selection",(()=>{this.callbackCheckboxChecked("enable")})),c.on("selection.cleared",(()=>{this.callbackCheckboxChecked("disable")})),c.on("column.order",(e=>{var t=this.CurrentObject,i=[];e.forEach((e=>{i.push(t.fieldByID(e))})),t._fields=i,t.save()})),this.hashViews.gantt=d,this.hashViews.kanban=u,this.PopupCustomIndex=new h(e,`${t}_customIndex`),this.PopupCustomIndex.on("changed",(()=>{this.refreshIndexes()})),this.PopupHeaderEditMenu=function(e,t){t=t||"ui_work_object_workspace_popupHeaderEditMenu";var i=a(e),o=(0,n.Z)(e).L();return new class extends i{constructor(e){super(e),this._menuOptions=[{label:o("Hide field"),icon:"fa fa-eye-slash",command:"hide",imported:!0},{label:o("Filter field"),icon:"fa fa-filter",command:"filter",imported:!0},{label:o("Sort field"),icon:"fa fa-sort",command:"sort",imported:!0},{label:o("Freeze field"),icon:"fa fa-thumb-tack",command:"freeze",imported:!0},{label:o("Edit field"),icon:"fa fa-pencil-square-o",command:"edit",imported:!1},{label:o("Delete field"),icon:"fa fa-trash",command:"delete",imported:!1}],this.$node=null,this.field=null}show(e,t){this.$node=e,this.field=t,super.show(e)}trigger(e){this.emit("click",e,this.field,this.$node)}}(t)}(e,`${t}_headerEditMenu`),this.PopupHeaderEditMenu.on("click",((e,t,i)=>{this.callbackHeaderEditorMenu(e,t,i)})),this.settings.isReadOnly||(this.PopupDefineLabelComponent=new p(e,`${t}_defineLabel`),this.PopupDefineLabelComponent.on("changed",(()=>{this.callbackDefineLabel()}))),this.PopupFilterDataTableComponent=new E(e,`${t}_popupFilter`),this.PopupFrozenColumnsComponent=new f.Z(e,`${t}_frozenFields`),this.PopupFrozenColumnsComponent.on("changed",(e=>{this.callbackFrozenColumns(e)})),this.PopupHideFieldComponent=(0,g.Z)(e,`${t}_hideFields`),this.PopupHideFieldComponent.on("changed",(e=>{this.callbackFieldsVisible(e)})),this.settings.isReadOnly||(this.PopupNewDataFieldComponent=(0,y.Z)(e,`${t}_popupNewDataField`)),this.PopupSortFieldComponent=(0,w.Z)(e,`${t}_sortFields`),this.PopupSortFieldComponent.on("changed",(e=>{this.callbackSortFields(e)})),this.PopupExportObjectComponent=new m(e,`${t}_export`),this.PopupImportObjectComponent=new b(e,`${t}_import`),this.PopupViewSettingsComponent=function(e,t,i){t=t||"abd_work_object_workspace_popupAddView";const o=(0,n.Z)(e),a=o.L();return new class extends o{constructor(t,i={}){super(t,{form:"",formAdditional:"",nameInput:"",typeInput:"",cancelButton:"",cancelX:"",saveButton:""}),i.isReadOnly=i.isReadOnly??!1,this.settings=i,this._view=null,this.comGrid=_(e,`${t}_grid`),this.comKanban=(0,C.Z)(e,`${t}_kanban`),this.comKanban.on("new.field",(e=>{this._newFieldSource="comKanban",this.emit("new.field",e)})),this.comGantt=(0,x.Z)(e,`${t}_gantt`),this.comGantt.on("new.field",(e=>{this._newFieldSource="comGantt",this.emit("new.field",e)})),this.on("field.added",(e=>{this[this._newFieldSource]?.emit("field.added",e)}))}ui(){const e=this.ids,t={view:"form",id:e.form,visibleBatch:"global",rules:{hGroup:(e,{vGroup:t})=>!e||e!==t},elements:[{view:"text",label:a("Name"),id:e.nameInput,name:"name",placeholder:a("Create a name for the view"),required:!0,invalidMessage:a("this field is required"),on:{onChange:()=>{$$(e.nameInput).validate()},onAfterRender(){o.CYPRESS_REF(this)}}},{view:"richselect",label:a("Type"),id:e.typeInput,name:"type",hidden:this.settings.isReadOnly,options:[{id:this.comGrid.type(),value:a("Grid")},{id:this.comKanban.type(),value:a("Kanban")},{id:this.comGantt.type(),value:a("Gantt")}],value:this.comGrid.type(),required:!0,on:{onChange:e=>{this.switchType(e)}}},{id:e.formAdditional,view:"layout",rows:[this.comKanban.ui(),this.comGantt.ui()]},{margin:5,cols:[{fillspace:!0},{id:e.buttonCancel,view:"button",value:a("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.buttonCancel()},on:{onAfterRender(){o.CYPRESS_REF(this)}}},{id:e.buttonSave,view:"button",css:"webix_primary",value:a("Save"),autowidth:!0,type:"form",click:()=>{this.buttonSave()},on:{onAfterRender(){o.CYPRESS_REF(this)}}}]}]};return{view:"window",id:e.component,width:400,resize:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:a("View Settings"),css:"modal_title",align:"center"},{id:e.cancelX,view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.buttonCancel()},on:{onAfterRender(){o.CYPRESS_REF(this)}}}]},position:"center",body:t,modal:!0,on:{onShow:()=>{this.onShow()}}}}async init(e){return this.AB=e,webix.ui(this.ui()),Promise.resolve()}switchType(e){switch($$(this.ids.formAdditional).showBatch(e),e){case"kanban":this.comKanban.init(this.CurrentObject,this._view);break;case"gantt":this.comGantt.init(this.CurrentObject,this._view)}$$(this.ids.component).resize()}onShow(){const e=this.ids;$$(e.form).clear(),$$(e.form).clearValidation(),this._view?($$(e.nameInput).setValue(this._view.name),$$(e.typeInput).setValue(this._view.type)):($$(e.nameInput).setValue(""),$$(e.typeInput).setValue(this.comGrid.type()))}show(e){this._view=e,$$(this.ids.component).show()}hide(){$$(this.ids.component).hide()}buttonCancel(){this.hide()}buttonSave(){const e=this.ids,t=$$(e.form);if(!t.validate())return;const i={},n=$$(e.typeInput);switch(n.getValue()){case this.comKanban.type():if(this.comKanban.validate&&!this.comKanban?.validate(t))return;i.settings=this.comKanban.values();break;case this.comGantt.type():if(this.comGantt.validate&&!this.comGantt.validate(t))return;i.settings=this.comGantt.values()}i.name=$$(e.nameInput).getValue(),i.type=n.getValue(),this._view?(this._view=Object.assign(this._view,i),this.emit("updated",this._view)):this.emit("added",i),this.hide()}}(t,i)}(e,`${t}_popupAddView`,{isReadOnly:this.settings.isReadOnly}),this.settings.isReadOnly||this.PopupViewSettingsComponent.on("new.field",(e=>{this.PopupNewDataFieldComponent.objectLoad(this.CurrentObject),this.PopupNewDataFieldComponent.show(null,e,!1)})),this.mockDataCollection=null,this.CurrentObjectID=null}ui(){var e=this.ids,t="button",i=this,n={id:this.ids.viewMenuNewView,view:"button",type:"icon",autowidth:!0,css:"webix_transparent",label:l("New view"),icon:"fa fa-plus-circle",align:"center",click:()=>{this.PopupViewSettingsComponent.show()}},a={id:e.viewMenu,view:"menu",data:[],on:{onMenuItemClick:t=>{var i=$$(e.viewMenu).getMenuItem(t);if(t!==e.viewMenuButton)if(i.isView){let e=this.workspaceViews.list((e=>e.id===t))[0];this.switchWorkspaceView(e)}else if("edit"===i.action){let e=this.workspaceViews.list((e=>e.id===i.viewId))[0];this.PopupViewSettingsComponent.show(e)}else"delete"===i.action&&webix.confirm({title:l("Delete View?"),message:l("Are you sure you want to remove this view?"),callback:e=>{if(e){var t=this.workspaceViews.list((e=>e.id===i.viewId))[0];this.workspaceViews.viewRemove(t),this.switchWorkspaceView(this.workspaceViews.getCurrentView())}}})}},type:{subsign:!0}},s={view:"toolbar",id:e.toolbar,hidden:!0,css:"webix_dark",elementsConfig:{autowidth:!0,padding:0,margin:0},margin:0,padding:0,rows:[{cols:[{responsive:"hide"},{view:t,id:e.buttonAddField,label:l("Add field"),icon:"fa fa-plus",css:"webix_transparent",type:"icon",hidden:this.settings.isReadOnly,click:function(){i.toolbarAddFields(this.$view)}},{responsive:"hide",hidden:this.settings.isReadOnly},{view:t,id:e.buttonFieldsVisible,label:l("Hide fields"),icon:"fa fa-eye-slash",css:"webix_transparent",type:"icon",badge:null,click:function(){i.toolbarFieldsVisible(this.$view)}},{responsive:"hide",id:e.buttonFieldsVisibleSpacer},{view:t,id:e.buttonFilter,label:l("Filters"),icon:"fa fa-filter",css:"webix_transparent",type:"icon",minWidth:70,autowidth:!0,badge:null,click:function(){i.toolbarFilter(this.$view)}},{responsive:"hide"},{view:t,id:e.buttonSort,label:l("Sort"),icon:"fa fa-sort",css:"webix_transparent",type:"icon",badge:null,click:function(){i.toolbarSort(this.$view)}},{responsive:"hide",id:e.buttonSortSpacer},{view:t,id:e.buttonFrozen,label:l("Freeze"),icon:"fa fa-thumb-tack",css:"webix_transparent",type:"icon",badge:null,click:function(){i.toolbarFrozen(this.$view)}},{responsive:"hide",id:e.buttonFrozenSpacer},{view:t,id:e.buttonLabel,label:l("Label"),icon:"fa fa-crosshairs",css:"webix_transparent",type:"icon",hidden:this.settings.isReadOnly,click:function(){i.toolbarDefineLabel(this.$view)}},{responsive:"hide",hidden:this.settings.isReadOnly},{view:t,id:e.buttonImport,label:l("Import"),icon:"fa fa-upload",css:"webix_transparent",type:"icon",hidden:this.settings.isReadOnly,click:function(){i.toolbarButtonImport()}},{responsive:"hide",hidden:this.settings.isReadOnly},{view:t,id:e.buttonExport,label:l("Export"),icon:"fa fa-download",css:"webix_transparent",type:"icon",click:function(){i.toolbarButtonExport(this.$view)}},{responsive:"hide"},{view:t,id:e.buttonMassUpdate,label:l("Edit"),icon:"fa fa-pencil-square-o",css:"webix_transparent",type:"icon",badge:null,hidden:!0,click:function(){i.toolbarMassUpdate(this.$view)}},{responsive:"hide",hidden:!0,id:e.buttonMassUpdateSpacer},{view:t,id:e.buttonDeleteSelected,label:l("Delete"),icon:"fa fa-trash",css:"webix_transparent",type:"icon",badge:null,hidden:!0,click:function(){i.toolbarDeleteSelected(this.$view)}},{responsive:"hide",hidden:!0,id:e.buttonDeleteSelectedSpacer}]},{css:{"background-color":"#747d84 !important"},hidden:this.settings.isReadOnly,cols:[{view:t,id:e.buttonIndex,label:l("Add Index"),icon:"fa fa-plus-circle",css:"webix_transparent",type:"icon",click:()=>{this.PopupCustomIndex.open(this.CurrentObject)}},{id:e.listIndex,cols:[]},{responsive:"hide"}]}]};let r={view:"multiview",animate:!1,id:e.component,borderless:!0,rows:[{id:e.error,rows:[{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-exclamation-triangle'></div>"},{id:e.error_msg,view:"label",align:"center",label:l("There was an error")},{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile}]},{id:e.noSelection,rows:[{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-database'></div>"},{view:"label",align:"center",label:l("Select an object to work with.")},{cols:[{},{view:"button",label:l("Add new object"),type:"form",css:"webix_primary",autowidth:!0,click:()=>{this.emit("addNew",!0)}},{}]},{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile}]},{id:e.selectedObject,type:"wide",paddingY:0,rows:[{cols:[n,a]},s,{padding:0,rows:[{view:"multiview",animate:!1,cells:[c.ui(),u.ui(),d.ui()]},{view:"button",type:"form",id:e.buttonRowNew,css:"webix_primary",value:l("Add new row"),hidden:this.settings.isReadOnly,click:()=>{this.rowAdd()}}]}]}]};return this.settings.showWarnings&&r.rows[2].rows[2].rows.push(v.ui()),r}init(e){this.AB=e;var t=[];return t.push(this.workspaceViews.init(e)),t.push(c.init(e)),t.push(d.init(e)),t.push(u.init(e)),t.push($.init(e)),this.mockDataCollection=this.AB.datacollectionNew({}),this.mockDataCollection.init(),t.push(this.PopupCustomIndex.init(e)),c.datacollectionLoad(this.mockDataCollection),d.datacollectionLoad(this.mockDataCollection),u.datacollectionLoad(this.mockDataCollection),t.push(this.PopupHeaderEditMenu.init(e)),this.settings.isReadOnly||t.push(this.PopupDefineLabelComponent.init(e)),t.push(this.PopupFilterDataTableComponent.init(e)),this.PopupFilterDataTableComponent.on("save",((...e)=>{this.callbackFilterDataTable(...e)})),t.push(this.PopupFrozenColumnsComponent.init(e)),t.push(this.PopupHideFieldComponent.init(e)),this.settings.isReadOnly||(t.push(this.PopupNewDataFieldComponent.init(e)),this.PopupNewDataFieldComponent.on("save",((...e)=>{this.callbackAddFields(...e),this.PopupViewSettingsComponent.emit("field.added",e[0])}))),t.push(this.PopupSortFieldComponent.init(e)),t.push(this.PopupImportObjectComponent.init(e)),t.push(this.PopupExportObjectComponent.init(e)),t.push(this.PopupViewSettingsComponent.init(e)),this.PopupViewSettingsComponent.on("added",(e=>{this.callbackViewAdded(e)})),this.PopupViewSettingsComponent.on("updated",(e=>{this.callbackViewUpdated(e)})),$$(this.ids.noSelection).show(),Promise.all(t)}applicationLoad(e){super.applicationLoad(e),this.settings.isReadOnly||this.PopupNewDataFieldComponent.applicationLoad(e)}callbackAddFields(){this.refreshView(),this.loadData()}async callbackFilterDataTable(e){this.mockDataCollection.filterCondition(e),this.updateFilterButton(e),this.workspaceViews.getCurrentView().filterConditions=e;try{await this.workspaceViews.save()}catch(e){console.error(e)}this.mockDataCollection.reloadData(),this.refreshView()}async updateFilterButton(e){var t=this.ids,i=$$(t.buttonFilter);if(i){var n=null;e?.rules?.length&&(n=1),i.define("badge",n),i.refresh()}}async callbackFrozenColumns(e){var t=this.workspaceViews.getCurrentView();t.frozenColumnID=e;try{await this.workspaceViews.save()}catch(e){}this.getBadgeFrozenColumn(),this.PopupHideFieldComponent.setFrozenColumnID(t.frozenColumnID),this.refreshView()}async callbackFieldsVisible(e){this.workspaceViews.getCurrentView().hiddenFields=e;try{await this.workspaceViews.save()}catch(e){}this.getBadgeHiddenFields(),this.PopupFrozenColumnsComponent.setHiddenFields(e),this.refreshView(),this.getBadgeFrozenColumn()}callbackCheckboxChecked(e){"enable"==e?this.enableUpdateDelete():this.disableUpdateDelete()}refreshView(){this.warningsRefresh(this.CurrentObject);var e=this.workspaceViews.getCurrentView();switch(e.type){case"gantt":d.show(e);break;case"grid":c.refreshHeader(e.hiddenFields,e.filterConditions,e.sortFields,e.frozenColumnID);break;case"kanban":u.show(e)}this.settings.showWarnings&&v.show(this.CurrentObject)}async callbackHeaderEditorMenu(e,t){var i=this.workspaceViews.getCurrentView();switch(e){case"hide":var n=[];i.hiddenFields.filter((e=>e==t.columnName)).length>0?n=i.hiddenFields.filter((e=>e!=t.columnName)):(n=i.hiddenFields).push(t.columnName),i.hiddenFields=n;try{await this.workspaceViews.save()}catch(e){}this.PopupHideFieldComponent.setSettings(i.hiddenFields),this.PopupFrozenColumnsComponent.setHiddenFields(i.hiddenFields),this.refreshView(),this.getBadgeHiddenFields(),this.getBadgeFrozenColumn();break;case"filter":this.toolbarFilter($$(this.ids.buttonFilter).$view,t.id);break;case"sort":this.toolbarSort($$(this.ids.buttonSort).$view,t.id);break;case"freeze":i.frozenColumnID=t.columnName;try{await this.workspaceViews.save()}catch(e){}this.PopupFrozenColumnsComponent.setValue(i.frozenColumnID||""),this.PopupHideFieldComponent.setFrozenColumnID(i.frozenColumnID||""),this.refreshView(),this.getBadgeFrozenColumn();break;case"edit":this.settings.isReadOnly||this.PopupNewDataFieldComponent.show(t);break;case"delete":webix.confirm({title:l("Delete data field"),message:l("Do you want to delete <b>{0}</b>?",[t.label]),callback:e=>{e&&(this.busy(),t.destroy().then((()=>{this.ready(),this.refreshView(),this.loadData(),function e(i,n){0==i.length?n():i.shift().removeField(t,(t=>{t?n(t):e(i,n)}))}(this.CurrentApplication.pages(),(()=>{}))})).catch((e=>{this.ready(),e&&e.message&&webix.alert({type:"alert-error",title:l("Could not delete"),text:e.message}),this.AB.notify.developer(e,{context:"Error trying to delete field",fields:t.toObj()})})))}})}}busy(){$$(this.ids.component)?.showProgress?.({type:"icon"})}callbackMassUpdate(){this.loadData()}async callbackSortFields(e){this.workspaceViews.getCurrentView().sortFields=e,await this.workspaceViews.save(),this.getBadgeSortFields(),this.refreshView(),this.loadData()}async callbackViewAdded(e){var t=await this.workspaceViews.viewNew(e);await this.switchWorkspaceView(t),this.refreshView(),this.loadData()}async callbackViewUpdated(e){await this.workspaceViews.viewUpdate(e),this.refreshWorkspaceViewMenu(),this.refreshView()}enableUpdateDelete(){var e=this.ids;$$(e.buttonMassUpdate).show(),$$(e.buttonMassUpdateSpacer).show(),$$(e.buttonDeleteSelected).show(),$$(e.buttonDeleteSelectedSpacer).show()}disableUpdateDelete(){var e=this.ids;$$(e.buttonMassUpdate).hide(),$$(e.buttonMassUpdateSpacer).hide(),$$(e.buttonDeleteSelected).hide(),$$(e.buttonDeleteSelectedSpacer).hide()}getBadgeFilters(){var e=this.ids,t=this.workspaceViews.filterConditions,i=0;t?.rules?.length&&(i=t.rules.length),void 0!==t&&($$(e.buttonFilter).define("badge",i||null),$$(e.buttonFilter).refresh())}getBadgeFrozenColumn(){var e=this.ids,t=this.workspaceViews.frozenColumnID,i=null;""!==t&&void 0!==t&&(i=c.getColumnIndex(t)),$$(e.buttonFrozen).define("badge",i),$$(e.buttonFrozen).refresh()}getBadgeHiddenFields(){var e=this.workspaceViews.hiddenFields;void 0!==e&&($$(this.ids.buttonFieldsVisible).define("badge",e.length||null),$$(this.ids.buttonFieldsVisible).refresh())}getBadgeSortFields(){var e=this.ids,t=(this.workspaceViews.sortFields||[]).filter((e=>""!=e.key));void 0!==t&&($$(e.buttonSort).define("badge",t.length||null),$$(e.buttonSort).refresh())}ready(){$$(this.ids.component)?.hideProgress?.()}async rowAdd(){var e=this.CurrentObject;if(e){var t=e.defaultValues();try{var i=await e.model().create(t);if(null==i)return;var n=this.mockDataCollection.$dc;n&&!n.exists(i.id)&&n.add(i,0)}catch(e){this.AB.notify.developer(e,{context:"ui_work_object_workspace:rowAdd(): error creating empty object",emptyObj:t});var o=this.AB.Label();webix.alert({title:o("Unable to create new row"),text:o("An administrator has already been alerted.")})}}}show(){$$(this.ids.component).show()}toolbarAddFields(){this.PopupNewDataFieldComponent.show()}toolbarButtonImport(){this.PopupImportObjectComponent.show()}toolbarButtonExport(e){this.PopupExportObjectComponent.show(e)}toolbarDeleteSelected(e){c.deleteSelected(e)}toolbarDefineLabel(e){this.PopupDefineLabelComponent.show(e)}toolbarFieldsVisible(e){this.PopupHideFieldComponent.show(e)}toolbarFilter(e,t){this.PopupFilterDataTableComponent.show(e,t)}toolbarFrozen(e){this.PopupFrozenColumnsComponent.show(e)}toolbarPermission(){console.error("TODO: toolbarPermission()")}toolbarMassUpdate(e){c.massUpdate(e)}toolbarSort(e,t){this.PopupSortFieldComponent.show(e,t)}async populateObjectWorkspace(e){$$(this.ids.toolbar).show(),$$(this.ids.selectedObject).show(),this.CurrentObjectID=e;var t=this.CurrentObject;this.workspaceViews.objectLoad(t);var i=this.workspaceViews.getCurrentView();this.mockDataCollection.datasource=t,c.objectLoad(t),u.objectLoad(t),d.objectLoad(t),this.settings.isReadOnly||(this.PopupNewDataFieldComponent.objectLoad(t),this.PopupDefineLabelComponent.objectLoad(t)),this.PopupFilterDataTableComponent.objectLoad(t),this.PopupFrozenColumnsComponent.objectLoad(t),this.PopupHideFieldComponent.objectLoad(t),this.PopupSortFieldComponent.objectLoad(t),this.PopupImportObjectComponent.objectLoad(t),this.PopupExportObjectComponent.objectLoad(t),this._handler_show||(this._handler_show=()=>{this.PopupExportObjectComponent.setGridComponent(c.$grid)},c.on("show",this._handler_show)),this.PopupExportObjectComponent.setFilename(t.label),this.PopupViewSettingsComponent.objectLoad(t),this.refreshIndexes(),await this.switchWorkspaceView(i),this.refreshWorkspaceViewMenu(),this.refreshView()}clearObjectWorkspace(){$$(this.ids.noSelection).show(!1,!1)}queryLoad(e){this.objectLoad(e)}loadAll(){c.loadAll()}loadData(){var e={glue:"and",rules:[]};this.workspaceViews?.filterConditions[0]?.rules?.length>0?(e=this.workspaceViews.filterConditions[0].rules,this.workspaceViews.filterConditions.rules=this.workspaceViews.filterConditions[0].rules):this.workspaceViews?.filterConditions?.rules?.length>0&&(e=this.workspaceViews.filterConditions);var t=[];this.workspaceViews?.sortFields?.length>0&&(t=this.workspaceViews?.sortFields),this.mockDataCollection.datasource=this.CurrentObject,this.mockDataCollection.fromValues({settings:{datasourceID:this.CurrentObjectID,objectWorkspace:{filterConditions:e,sortFields:t}}}),this.mockDataCollection.filterCondition(e),this.updateFilterButton(e),this.mockDataCollection.refreshFilterConditions(e),this.mockDataCollection.clearAll();let i=this.workspaceViews.getCurrentView();"gantt"===i.type||"kanban"===i.type?(this.mockDataCollection.settings.loadAll=!0,this.mockDataCollection.loadData(0)):this.mockDataCollection.loadData(0,30).catch((e=>{this.toolbarFilter(this.$view);var t=e.toString();if("string"==typeof e)try{var i=JSON.parse(e);i.data&&i.data.sqlMessage&&(t=i.data.sqlMessage)}catch(e){}e.message&&(t=e.message);var n=this.ids;$$(n.error).show(),$$(n.error_msg).define("label",t),$$(n.error_msg).refresh(),this.AB.notify.developer(e,{context:"ui_work_object_workspace.loadData()",message:t,datacollection:this.mockDataCollection.toObj()})}))}async switchWorkspaceView(e){this.hashViews[e.type]&&(this.workspaceViews.setCurrentView(e.id),await this.hashViews[e.type].show(e),this.refreshWorkspaceViewMenu(),this.refreshToolBarView(),this.PopupFilterDataTableComponent.setFilter(e.filterConditions),this.PopupFrozenColumnsComponent.setValue(e.frozenColumnID||""),this.PopupFrozenColumnsComponent.setHiddenFields(e.hiddenFields),this.PopupHideFieldComponent.setSettings(e.hiddenFields),this.PopupHideFieldComponent.setFrozenColumnID(e.frozenColumnID||""),this.PopupSortFieldComponent.setSettings(e.sortFields),this.PopupExportObjectComponent.setHiddenFields(e.hiddenFields),this.workspaceViews.save(),this.loadData())}refreshToolBarView(){var e=this.ids;switch(this.workspaceViews.getCurrentView().type){case"grid":$$(e.buttonFieldsVisible).show(),$$(e.buttonFrozen).show(),$$(e.buttonSort).show(),$$(e.buttonFieldsVisibleSpacer).show(),$$(e.buttonFrozenSpacer).show(),$$(e.buttonSortSpacer).show();break;case"kanban":$$(e.buttonFieldsVisible).hide(),$$(e.buttonFrozen).hide(),$$(e.buttonSort).hide(),$$(e.buttonFieldsVisibleSpacer).hide(),$$(e.buttonFrozenSpacer).hide(),$$(e.buttonSortSpacer).hide()}this.getBadgeHiddenFields(),this.getBadgeFrozenColumn(),this.getBadgeSortFields(),this.getBadgeFilters(),$$(e.selectedObject).show(!0,!1),this.CurrentObject.isExternal||this.CurrentObject.isImported?$$(e.buttonAddField).disable():$$(e.buttonAddField).enable()}refreshWorkspaceViewMenu(){var e=this.workspaceViews.getCurrentView().id,t=this.workspaceViews.list().map((t=>({id:t.id,hash:t.type,value:t.name,isView:!0,$css:t.id===e?"selected":"",icon:`fa fa-${t.icon}`,submenu:t.isDefaultView?null:[{value:l("Edit"),icon:"fa fa-cog",viewId:t.id,action:"edit"},{value:l("Delete"),icon:"fa fa-trash",viewId:t.id,action:"delete"}]}))),i=$$(this.ids.viewMenu);i.clearAll(),i.define("data",t),i.refresh()}refreshIndexes(){let e=this.CurrentObject?.indexes()||[];webix.ui([],$$(this.ids.listIndex)),e.forEach((e=>{this.addNewIndex(e)}))}addNewIndex(e){$$(this.ids.listIndex).addView({view:"button",label:e.label||e.name,icon:"fa fa-key",css:"webix_transparent",type:"icon",width:160,click:()=>{this.PopupCustomIndex.open(this.CurrentObject,e)}})}}(t,i)}function P(e){const t=(0,n.Z)(e);return new class extends t{constructor(){super("ab_work_query"),this.QueryList=function(e){const t=(0,n.Z)(e);return new class extends t{constructor(){super("ui_work_query_list"),this.ListComponent=l(e,{idBase:this.ids.component,labels:{addNew:"Add new query",confirmDeleteTitle:"Delete Query",title:"Queries",searchPlaceholder:"Query name"},menu:{copy:!1,exclude:!0}}),this.AddForm=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_query_list_newQuery",{tab:""}),this.selectNew=!0,this.BlankTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_query_list_newQuery_blank",{form:"",buttonSave:"",buttonCancel:"",object:""})}ui(){return{id:this.ids.component,header:i("Create"),body:{view:"form",id:this.ids.form,width:400,rules:{},elements:[{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Query name"),labelWidth:70,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_query_list_newQuery_blank_name")}}},{id:this.ids.object,view:"richselect",label:i("Object"),name:"object",required:!0,placeholder:i("Select an object"),labelWidth:70,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_query_list_newQuery_blank_object")}}},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Add Query"),autowidth:!0,type:"form",click:()=>this.save(),on:{onAfterRender(){t.CYPRESS_REF(this)}}}]}]}}}async init(e){return this.AB=e,this.$form=$$(this.ids.form),this.$buttonSave=$$(this.ids.buttonSave),this.$objectList=$$(this.ids.object),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form&&(this.$form.clearValidation(),this.$form.clear())}onError(e){if(e){console.error(e);var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();webix.alert({title:i("Error creating Query: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}this.$buttonSave.enable()}onSuccess(){this.formClear(),this.$buttonSave.enable()}save(){this.$buttonSave.disable();var e=this.$form;if(e.clearValidation(),!e.validate())return this.$buttonSave.enable(),!1;let t=e.getValues(),i={name:t.name,label:t.name,joins:{alias:"BASE_OBJECT",objectID:t.object,links:[]}};this.emit("save",i)}show(){$$(this.ids.component)&&$$(this.ids.component).show()}onShow(e){if(this.$objectList&&e){let t=e.objectsIncluded().map((e=>({id:e.id,value:e.label})));this.$objectList.define("options",t),this.$objectList.refresh();let i=this.$objectList.getPopup();i.attachEvent("onShow",(()=>{i.define("width",300),i.resize()}))}this.$form&&this.$form.setValues({name:"",object:""})}}}(e),this.ImportTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_query_list_newQuery_import",{form:"",filter:"",queryList:"",buttonSave:"",buttonCancel:""})}ui(){return{id:this.ids.component,header:i("Existing"),body:{view:"form",id:this.ids.form,width:400,elements:[{cols:[{view:"icon",icon:"fa fa-filter",align:"left"},{view:"text",id:this.ids.filter,on:{onTimedKeyPress:()=>this.filter()}}]},{view:"list",id:this.ids.queryList,select:!0,height:200,minHeight:250,maxHeight:250,data:[],template:"<div>#label#</div>"},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>this.cancel()},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Import"),autowidth:!0,type:"form",click:()=>this.save()}]}]}}}async init(e){return this.AB=e,this.$form=$$(this.ids.form),this.$filter=$$(this.ids.filter),this.$queryList=$$(this.ids.queryList),this.$buttonSave=$$(this.ids.buttonSave),this.$buttonCancel=$$(this.ids.buttonCancel),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}onShow(e){this.formClear();const t=e.queriesExcluded();this.$queryList.parse(t,"json")}filter(){let e=this.$filter.getValue();this.$queryList.filter("#label#",e)}save(){let e=this.$queryList.getSelectedItem();if(!e)return!1;this.$buttonSave.disable(),this.emit("save",e)}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form&&(this.$form.clearValidation(),this.$form.clear()),this.$queryList&&this.$queryList.clearAll()}onError(e){if(e){let t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;let n=this.$form.getValues();webix.alert({title:i("Error creating Query: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}this.$buttonSave.enable()}onSuccess(){this.$buttonSave.enable()}}}(e)}ui(){return{view:"window",id:this.ids.component,position:"center",modal:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Add new query"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.emit("cancel")},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},selectNewQuery:!0,body:{view:"tabview",id:this.ids.tab,cells:[this.BlankTab.ui(),this.ImportTab.ui()],tabbar:{on:{onAfterTabClick:e=>{this.switchTab(e)},onAfterRender(){this.$view.querySelectorAll(".webix_item_tab").forEach((t=>{var i=t.getAttribute("button_id");e.ClassUI.CYPRESS_REF(t,`${i}_tab`)}))}}}}}}async init(e){this.AB=e,webix.ui(this.ui()),webix.extend($$(this.ids.component),webix.ProgressBar),this.$component=$$(this.ids.component);let t=[];return["BlankTab","ImportTab"].forEach((i=>{t.push(this[i].init(e)),this[i].on("cancel",(()=>{this.emit("cancel")})),this[i].on("save",(e=>{if(e.id)return this.import(e,i);this.save(e,i)}))})),Promise.all(t)}done(e){this.ready(),this.hide(),this.emit("save",e,this.selectNew)}async import(e,t){this.busy();try{await this.CurrentApplication.queryInsert(e),this[t].emit("save.successful",e),this.done(e)}catch(e){this.ready(),this[t].emit("save.error",e)}}async save(e,t){if(!this.CurrentApplication)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this[t].emit("save.error",!0),!1;let n=this.AB.queryNew(e),o=n.isValid();if(o.fail())return this[t].emit("save.error",o),!1;n.createdInAppID||(n.createdInAppID=this.CurrentApplicationID),this.busy();try{let e=await n.save();await this.CurrentApplication.queryInsert(e),this[t].emit("save.successful",e),this.done(e)}catch(e){this.ready(),this[t].emit("save.error",e)}}show(e){null!=e&&(this.selectNew=e),this.$component&&this.$component.show();const t=$$(this.ids.tab).getValue();this.switchTab(t)}hide(){this.$component&&this.$component.hide()}busy(){this.$component&&this.$component.showProgress()}ready(){this.$component&&this.$component.hideProgress()}switchTab(e){e!=this.BlankTab?.ui()?.body?.id&&e?e==this.ImportTab?.ui()?.body?.id&&this.ImportTab?.onShow?.(this.CurrentApplication):this.BlankTab?.onShow?.(this.CurrentApplication)}}}(e)}ui(){return this.ListComponent.ui()}async init(e){this.AB=e,this.on("addNew",(e=>{this.clickNewQuery(e)}));var t=[];t.push(this.ListComponent.init(e)),this.ListComponent.on("selected",(e=>{this.emit("selected",e)})),this.ListComponent.on("addNew",(e=>{this.clickNewQuery(e)})),this.ListComponent.on("deleted",(e=>{this.emit("deleted",e)})),this.ListComponent.on("exclude",(e=>{this.exclude(e)})),t.push(this.AddForm.init(e)),this.AddForm.on("cancel",(()=>{this.AddForm.hide()})),this.AddForm.on("save",(e=>{this.applicationLoad(this.CurrentApplication),this.ListComponent.select(e.id)})),await Promise.all(t)}applicationLoad(e){super.applicationLoad(e),this.ListComponent.dataLoad(e?.queriesIncluded()),this.AddForm.applicationLoad(e)}warningsRefresh(){if(this.CurrentApplication){let e=this.ListComponent.selectedItem();this.ListComponent.dataLoad(this.CurrentApplication?.queriesIncluded()),this.ListComponent.selectItem(e.id)}}clickNewQuery(){this.AddForm.show()}async exclude(e){this.ListComponent.busy();var t=this.CurrentApplication;await t.queryRemove(e),this.ListComponent.dataLoad(t.queriesIncluded()),this.emit("selected",null)}ready(){this.ListComponent.ready()}select(e){this.ListComponent.select(e.id)}}}(e),this.QueryWorkspace=function(e,t){const i=(0,n.Z)(e),o=e.Config.uiSettings();var a=i.L();const r="ui_work_query_workspace",l=function(e,t){const i=(0,n.Z)(e),o=e.Config.uiSettings();var a=i.L();return new class extends i{constructor(t={}){super("ui_work_query_workspace_design",{tree:"",tabObjects:"",depth:"",datatable:"",selectedObject:"",grouping:"",hidePrefix:"",filter:""}),this.settings=t,this.mockDatacollection=null,this.CurrentQueryID=null,this.DataFilter=e.filterComplexNew(this.ids.filter,{isSaveHidden:!0}),this.DataFilter.init({showObjectName:!0}),this.DataFilter.on("changed",(()=>{this.DataFilter.isComplete()&&(this.__saveInProcess||(this.__saveInProcess=this.save().finally((()=>{this.__saveInProcess=null}))))}))}ui(){const e=this,t=this.ids;return{view:"scrollview",id:t.component,body:{rows:[{id:t.selectedObject,type:"form",rows:[{cols:[{rows:[{view:"label",label:a("Manage Objects"),css:"ab-query-label"},{view:"tree",id:t.tree,css:"ab-tree",template:"{common.icon()} {common.checkbox()} #value#",data:[],on:{onItemClick:function(e,t,i){this.getItem(e).disabled||(this.isChecked(e)?this.uncheckItem(e):this.checkItem(e))},onItemCheck:(e,t,i)=>{this.checkObjectLink(e,t)},onBeforeOpen:function(i){let n=this.getItem(i);if(-1===n.$count){$$(t.tree).showProgress({type:"icon"});let o=e.getChildItems(n.objectLinkId,i);$$(t.tree).parse(o.treeItems),$$(t.tree).hideProgress()}}}}]},{view:"resizer",borderless:!0},{gravity:3,rows:[{view:"label",label:a("Manage Fields"),css:"ab-query-label"},{view:"tabview",id:t.tabObjects,tabbar:{tabMinWidth:240,css:"webix_dark",type:"bottom",bottomOffset:0},cells:[{}],multiview:{animate:!1,on:{onViewChange:(e,t)=>{this.setSelectedFields(t)}}}}]}]},{id:t.grouping,view:"checkbox",label:a("Grouping"),labelWidth:o.labelWidthXLarge,on:{onChange:()=>{this.save()}}},{id:t.hidePrefix,view:"checkbox",label:a("Hide prefix labels"),labelWidth:o.labelWidthXLarge,on:{onChange:()=>{this.save()}}},{view:"label",label:a("Manage Filters"),css:"ab-query-label"},{view:"button",label:a("Filters"),icon:"fa fa-filter",type:"button",click:function(){e.DataFilter.popUp(this.$view,{pos:"bottom"})}},{id:t.datatable,view:"treetable",minHeight:280,dragColumn:!0,columns:[],data:[],on:{onAfterColumnDrop:()=>{this.save()}}}]}]}}}init(e){this.AB=e;const t=this.ids;return webix.extend($$(t.tree),webix.ProgressBar),webix.extend($$(t.tabObjects),webix.ProgressBar),webix.extend($$(t.datatable),webix.ProgressBar),this.DataFilter.init({showObjectName:!0}),Promise.resolve()}clearWorkspace(){}populateQueryWorkspace(e){console.error("DEPRECIATED! Use queryLoad() instead"),this.queryLoad(e)}queryLoad(e){super.queryLoad(e);let t=this.CurrentQuery;if(null==t)return void this.clearWorkspace();this.mockDatacollection=this.AB.datacollectionNew({query:[t.toObj()],settings:{datasourceID:t.id}}),this.mockDatacollection.datasource=t;const i=t.objectBase(),n=this.ids;$$(n.selectedObject).show(),this.refreshTree();let o=t.joins().links||[];const a=$$(n.tabObjects);a?.showProgress({type:"icon"}),a.addView({body:{id:"temp"}}),a.getTabbar().config.options.map((e=>e.id)).forEach((e=>{"temp"!=e&&a.removeView(e)}));var s=a.getMultiview();if(s.getChildViews().map((e=>e)).forEach((e=>{e&&"temp"!=e.config.id&&s.removeView(e)})),!i)return;let r=this.templateField({object:i,isTypeHidden:!0,aliasName:"BASE_OBJECT"});a.addView(r),a.setValue(r.id),this.setSelectedFields("BASE_OBJECT");var l=(e,i)=>{(i||[]).forEach((i=>{if(!e)return;if(!i.fieldID)return;var n=e.fieldByID(i.fieldID);if(!n)return;var o=t.objectByID(n.settings.linkObject);if(!o)return;let s=this.templateField({field:n,joinType:i.type,aliasName:i.alias});a.addView(s),this.setSelectedFields(i.alias),l(o,i.links)}))};l(i,o),$$(n.grouping).define("value",e.settings.grouping),$$(n.grouping).refresh(),$$(n.hidePrefix).define("value",e.settings.hidePrefix),$$(n.hidePrefix).refresh(),a.removeView("temp"),a.adjust(),a.hideProgress(),this.refreshFilter(),this.refreshDataTable()}getChildItems(e,t){let i={data:[]},n=this.getObject(e);return t&&(i.parent=t),n.connectFields().forEach((e=>{let t=this.getObject(e.settings.linkObject);if(null==t)return;if(!this.CurrentApplication.isSystemObj&&t.isSystemObject)return;let n=e.id;var o=`${t.label} (${e.label})`;i.data.push({value:o,fieldID:n,objectId:t.id,objectLinkId:e.settings.linkObject,checked:!1,disabled:!1,open:!1,webix_kids:!0})})),{object:n,treeItems:i}}aliasName(){return this.AB.uuid().replace(/[^a-zA-Z0-9]+/g,"").substring(0,8)}save(e=null){let t=this.ids,i=this.CurrentQuery;return new Promise(((n,o)=>{var a=$$(t.tree);let s={alias:"BASE_OBJECT",objectID:i.objectBase().id,links:[]},r={};(a.getChecked().map((e=>a.getItem(e))).sort(((e,t)=>e.$level-t.$level))||[]).forEach((e=>{let i=e.alias;i||(i=this.aliasName(),a.updateItem(e.id,{alias:i}));let n="innerjoin",o=$$(t.tabObjects).getMultiview().getChildViews().filter((e=>e.config.id==i))[0];o&&(n=o.queryView({name:"joinType"}).getValue()||"innerjoin");let l=s.links,c={alias:i,fieldID:e.fieldID,type:n,links:[]};if(e.$level>1){let t=a.getParentId(e.id),i=a.getItem(t);l=r[i.alias].links}l.push(c),r[i]=c})),i.importJoins(s),null==e&&(e=$$(t.datatable).config.columns.map((e=>{let t=i.objectByAlias(e.alias);if(t)return!t.fieldByID(e.fieldID)||"BASE_OBJECT"!=e.alias&&i.links((t=>t.alias==e.alias)).length<1?void 0:{alias:e.alias,fieldID:e.fieldID}})).filter((e=>null!=e))),i.importFields(e),i.where=this.DataFilter.getValue(),i.settings={grouping:$$(t.grouping).getValue(),hidePrefix:$$(t.hidePrefix).getValue()},i.save().then((()=>i.migrateCreate())).then((()=>{this.refreshDataTable(),this.warningsRefresh(i),n()})).catch((e=>{this.AB.notify.developer(e,{context:`${t.component}:save(): Error saving Query`,query:i.toObj()}),o(e)}))}))}checkObjectLink(e,t){var i=$$(this.ids.tree);i.blockEvent();var n=e;if(t)for(;i.getParentId(n);)(n=i.getParentId(n))!=e&&i.checkItem(n);else i.data.eachSubItem(n,(function(t){t.id!=e&&i.uncheckItem(t.id)}));this.save().then((()=>{this.populateQueryWorkspace(this.CurrentQuery)})),i.unblockEvent()}depthChange(){this.save().then((()=>{this.populateQueryWorkspace(this.CurrentQuery)}))}setSelectedFields(e){let t=$$(e).queryView({name:"fields"});if(t){let i=this.CurrentQuery.fields((t=>t.alias==e),!0).map((e=>e.id));t.setValue(i)}}checkFields(){let e=this.ids;var t=[];$$(e.tabObjects).getMultiview().getChildViews().forEach((e=>{let i=e.queryView({name:"fields"});if(i&&i.getValue()){let n=i.getValue().split(",").map((t=>({alias:e.config.aliasName,fieldID:t})));t=t.concat(n)}}));var i=$$(e.datatable).config.columns.map((e=>e.fieldID));t.sort(((e,t)=>{var n=i.indexOf(e.fieldID),o=i.indexOf(t.fieldID);return n<0&&(n=999),o<0&&(o=999),n-o})),this.save(t).then((()=>{this.refreshFilter()}))}templateField(e){if(null==e.object&&null==e.field)throw new Error("Invalid params");var t=e.object?e.object:this.CurrentQuery.objectByID(e.field.settings.linkObject),i=t.fields((e=>e.fieldSupportQuery()),!0).map((e=>({id:e.id,value:e.label})));let n="";e.field&&(n=` (${e.field.label})`);var o=`${t.label}${n}`;let s=e.aliasName;return{header:o,body:{id:s,aliasName:s,type:"space",css:"bg-white",rows:[{view:"select",name:"joinType",label:a("join records by"),labelWidth:200,placeholder:a("Choose a type of table join"),hidden:1==e.isTypeHidden,value:e.joinType||"innerjoin",options:[{id:"innerjoin",value:a("Returns records that have matching values in both tables (INNER JOIN).")},{id:"left",value:a("Return all records from the left table, and the matched records from the right table (LEFT JOIN).")},{id:"right",value:a("Return all records from the right table, and the matched records from the left table (RIGHT JOIN).")},{id:"fullouterjoin",value:a("Return all records when there is a match in either left or right table (FULL JOIN)")}],on:{onChange:()=>{this.save()}}},{view:"dbllist",name:"fields",list:{height:300},labelLeft:a("Available Fields"),labelRight:a("Included Fields"),labelBottomLeft:a("Move these fields to the right to include in data set."),labelBottomRight:a("These fields will display in your final data set."),data:i,on:{onChange:()=>{this.checkFields()}}},{fillspace:!0}]}}}refreshTree(){let e=(t,i,o,a=0)=>{(o||[]).forEach((o=>{if(!i)return;let s=i.fieldByID(o.fieldID);if(!s)return;let r={fieldID:s.id};null!=a&&(r.$parent=a);let l=null;if((t.find(r)||[]).forEach((e=>{if(e.$parent){let i=t.getItem(e.$parent);i&&i.checked&&(l=e)}else l=e})),l){t.updateItem(l.id,{alias:o.alias,checked:!0,open:!0});let i=this.getChildItems(s.settings.linkObject,l.id);$$(n.tree).parse(i.treeItems),e(t,i.object,o.links,l.id)}}))};const t=this.CurrentQuery.objectBase();let i=this.CurrentQuery.joins().links||[],n=this.ids;if($$(n.tree).clearAll(),$$(n.tree).showProgress({type:"icon"}),t){let o=this.getChildItems(t.id);$$(n.tree).parse(o.treeItems),e($$(n.tree),t,i),$$(n.tree).hideProgress()}}refreshFilter(){let e=this.CurrentQuery;this.DataFilter.fieldsLoad(e?e.fields():[],e),this.DataFilter.setValue(e.where)}refreshDataTable(){if(null==this.mockDatacollection)return;let e=this.CurrentQuery;if(!e)return;let t=$$(this.ids.datatable);t.clearAll();var i=e.columnHeaders(!1,!1);t.refreshColumns(i);let n=e.workspaceViews.getCurrentView();this.mockDatacollection.clearAll(),this.mockDatacollection.datasource=e,this.mockDatacollection.fromValues({query:[e.toObj()],settings:{datasourceID:e.id,objectWorkspace:{sortFields:n.sortFields}}}),this.mockDatacollection.datasource=e,this.mockDatacollection.unbind(t),this.mockDatacollection.bind(t),t.showProgress({type:"icon"}),this.mockDatacollection.loadData(0,50,(()=>{})).then((()=>{this.mockDatacollection.bind(t)}))}getObject(e){let t=this.CurrentQuery.objectByID(e);return t||(t=this.AB.objectByID(e),t||void 0)}show(){$$(this.ids.component).show()}}(void 0)}(e),c=D(e,`${r}_display`,{isReadOnly:!0,showWarnings:!1});var d=s(e,`${r}_view_warnings`,t);return new class extends i{constructor(e={}){super(r,{multiview:"",toolbar:"",modeButton:"",noSelection:"",run:"",design:""}),this.settings=e}ui(){var e=this.ids;return{view:"multiview",animate:!1,cells:[{id:e.noSelection,rows:[{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-filter'></div>"},{view:"label",align:"center",label:a("Select a query to work with.")},{cols:[{},{view:"button",css:"webix_primary",label:a("Add new query"),type:"form",autowidth:!0,click:()=>{this.emit("query.add")}},{}]},{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile}]},{id:e.component,rows:[{id:e.toolbar,view:"tabbar",css:"webix_dark",type:"bottom",borderless:!1,bottomOffset:0,options:[{id:e.design,value:a("Build Query"),icon:"fa fa-sliders",type:"icon"},{id:e.run,value:a("View Query"),icon:"fa fa-table",type:"icon"}],on:{onChange:(e,t)=>{e!=t&&this.changeMode(e)}}},{height:10},{id:e.multiview,view:"multiview",animate:!1,cells:[l.ui(),c.ui()]},d.ui()]}]}}init(e){return this.AB=e,this.warningsPropogate([l,c]),this.on("warnings",(()=>{d.show(this.CurrentQuery)})),Promise.all([l.init(e),c.init(e)])}changeMode(e){let t=this.ids;$$(this.ids.component).show(),$$(t.toolbar).show(!1,!1),e==t.run?(c.show(),c.populateObjectWorkspace(this.CurrentQueryID)):(l.show(!0),l.queryLoad(this.CurrentQuery))}applicationLoad(e){super.applicationLoad(e),this.clearWorkspace(),l.applicationLoad(e),c.applicationLoad(e)}clearWorkspace(){$$(this.ids.noSelection).show(!1,!1),l.clearWorkspace()}loadAll(){c.loadAll()}queryLoad(e){super.queryLoad(e),d.show(e),l.queryLoad(e),c.queryLoad(e),e?($$(this.ids.component).show(),l.show(!0)):this.clearWorkspace()}resetTabs(){$$(this.ids.toolbar)?.setValue?.(this.ids.design)}}(t)}(e)}ui(){return{id:this.ids.component,type:"space",cols:[this.QueryList.ui(),{view:"resizer"},this.QueryWorkspace.ui()]}}init(e){return this.AB=e,this.QueryList.on("selected",(e=>{this.select(e)})),this.QueryWorkspace.on("query.add",(()=>{this.QueryList.emit("addNew")})),this.warningsPropogate([this.QueryList,this.QueryWorkspace]),this.on("warnings",(()=>{this.QueryList.warningsRefresh()})),Promise.all([this.QueryWorkspace.init(e),this.QueryList.init(e)])}applicationLoad(e){super.applicationLoad(e),this.QueryWorkspace.clearWorkspace(),this.QueryList.applicationLoad(e),this.QueryWorkspace.applicationLoad(e)}show(){$$(this.ids.component).show(!1,!1);var e=this.CurrentApplication;e&&this.QueryList?.applicationLoad(e),this.QueryList?.ready(),this._lastSelectedQuery&&(this.QueryList.select(this._lastSelectedQuery),this.select(this._lastSelectedQuery))}select(e){this._lastSelectedQuery=e,this.QueryWorkspace.resetTabs(),this.QueryWorkspace.queryLoad(e)}}}function L(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_interface_list_newPage_blank",{form:"",buttonSave:"",buttonCancel:"",parentList:""})}ui(){return{id:this.ids.component,header:i("Blank"),body:{view:"form",id:this.ids.form,width:400,rules:{},elements:[{view:"select",id:this.ids.parentList,label:i("Parent Page"),name:"parent",options:[],placeholder:i("Root Page"),labelWidth:110},{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Page name"),labelWidth:110,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"ui_work_interface_list_newPage_blank_name")}}},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Add Page"),autowidth:!0,type:"form",click:()=>this.save(),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}]}}}init(e){return this.AB=e,this.$form=$$(this.ids.form),this.on("save.error",(e=>{this.AB.notify.developer(e,{context:"ui_work_interface_list_newPage:init(): there was an error saving the values from our form."})})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}applicationLoad(e){super.applicationLoad(e);var t=[{id:"-",value:i("Root page")}],n=function(e,i){i=i||"",t.push({id:e.urlPointer(),value:i+e.label}),e.pages().forEach((function(e){n(e,i+"-")}))};e.pages().forEach((function(e){n(e,"")})),$$(this.ids?.parentList)?.define&&($$(this.ids.parentList).define("options",t),$$(this.ids.parentList).refresh())}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form.clearValidation(),this.$form.clear()}onError(e){if(e){console.error(e);var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();this.AB.notify.developer(e,{context:"ui_work_interface_list_newPage: the entered data is invalid",base:n}),webix.alert({title:i("Error creating Page: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}$$(this.ids.buttonSave).enable()}onSuccess(){this.formClear(),$$(this.ids.buttonSave).enable()}save(){var e=$$(this.ids.buttonSave);e.disable();var t=this.$form;if(t.clearValidation(),!t.validate())return e.enable(),!1;var i=t.getValues();"-"===i.parent?i.parent=null:i.parent&&(i.parent=this.CurrentApplication.urlResolve(i.parent)),i.primaryColumnName="uuid",this.emit("save",i)}show(){$$(this.ids.component)&&$$(this.ids.component).show()}}}function F(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ab_work_interface_list_newInterface",{tab:""}),this.selectNew=!0,this.BlankTab=new L(e)}ui(){return{view:"window",id:this.ids.component,position:"center",modal:!0,head:i("Add new interface"),selectNewInterface:!0,body:{view:"tabview",id:this.ids.tab,cells:[this.BlankTab.ui()],tabbar:{on:{onAfterTabClick:e=>{this.switchTab(e)},onAfterRender(){this.$view.querySelectorAll(".webix_item_tab").forEach((t=>{var i=t.getAttribute("button_id");e.ClassUI.CYPRESS_REF(t,`${i}_tab`)}))}}}},on:{onBeforeShow:()=>{var e=$$(this.ids.tab).getValue();this.switchTab(e)}}}}async init(e){this.AB=e,webix.ui(this.ui()),webix.extend($$(this.ids.component),webix.ProgressBar),this.$component=$$(this.ids.component),this.$form=$$(this.ids.form);var t=[];["BlankTab"].forEach((i=>{t.push(this[i].init(e)),this[i].on("cancel",(()=>{this.emit("cancel")})),this[i].on("save",(e=>{this.save(e,i)}))})),await Promise.all(t)}applicationLoad(e){super.applicationLoad(e),this.BlankTab.applicationLoad(e)}hide(){this?.$component?.hide()}busy(){this?.$component?.showProgress()}ready(){this?.$component?.hideProgress()}done(e){this.ready(),this.hide(),this.emit("save",e,this.selectNew)}async save(e,t){if(!this.CurrentApplication)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this[t].emit("save.error",!0),!1;if(e){var n=null;if((n=e.useParent&&e.parent?e.parent:e.parent?e.parent.pageNew(e):this.CurrentApplication.pageNew(e)).isValid){var o=n.isValid();if(o.fail())return this[t].emit("save.error",o),!1}n.createdInAppID||(n.createdInAppID=this.CurrentApplication.id),this.busy();try{var a=await n.save();this[t].emit("save.successful",a),this.done(a)}catch(e){this.ready(),await this.CurrentApplication.pageRemove(n),this[t].emit("save.error",e)}}}show(){this.$component?.show()}switchTab(e){}}}function V(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ab_work_interface_list_copyInterface",{form:"",buttonSave:"",buttonCancel:""}),this.ids.parentList={}}ui(t){return{view:"window",id:this.ids.component,width:400,position:"center",modal:!0,head:i("Copy interface"),selectNewInterface:!0,body:{view:"form",id:this.ids.form,rules:{},elements:[{view:"select",id:this.ids.parentList,label:i("Parent Page"),name:"parent",options:[],placeholder:i("Root Page"),labelWidth:110},{view:"text",label:i("Name"),name:"name",required:!0,placeholder:`${i("{0} - copy",[t])}`,labelWidth:110,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"ui_work_interface_list_newPage_blank_name")}}},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Paste Page"),autowidth:!0,type:"form",click:()=>this.save(),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}]}}}async init(e,t){this.AB=e,this.data=t,console.log(t),webix.ui(this.ui(t.name)),webix.extend($$(this.ids.component),webix.ProgressBar),this.$form=$$(this.ids.form),this.$component=$$(this.ids.component),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()}))}applicationLoad(e){super.applicationLoad(e);var t=[{id:"-",value:i("Root page")}],n=function(e,i){i=i||"",t.push({id:e.id,value:i+e.label}),e.pages().forEach((function(e){n(e,i+"-")}))};e.pages().forEach((function(e){n(e,"")})),$$(this.ids?.parentList)?.define("options",t),$$(this.ids?.parentList)?.refresh()}hide(){this?.$component?.hide()}cancel(){this.formClear(),this.emit("cancel")}busy(){this?.$component?.showProgress()}ready(){this?.$component?.hideProgress()}done(e){this.ready(),this.hide(),this.emit("save",e)}async save(){var e=$$(this.ids.buttonSave);e.disable(),this.busy();var t=this.$form;if(t.clearValidation(),!t.validate())return e.enable(),this.ready(),!1;var n=t.getValues();if(!this.CurrentApplication)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this.emit("save.error",!0),!1;if(!n)return;"-"===n.parent?n.parent=null:n.parent&&(n.parent=this.CurrentApplication.urlResolve(n.parent));var o=this.data;let a=await o.copy(null,n.parent,{newName:n.name}).catch((e=>{this.ready(),this.AB.notify.developer(e,{context:"ui_interface_list_copyPage:save(): Error saving copied page",base:o})}));this.emit("save.successful",a),this.done(a)}show(){this?.$component?.show()}formClear(){this?.$form.clearValidation(),this?.$form.clear()}onError(e){if(e){var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();this.AB.notify.developer(e,{context:"ui_interace_list: error",base:n}),webix.alert({title:i("Error creating Page: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}$$(this.ids.buttonSave).enable()}onSuccess(){this.formClear(),$$(this.ids.buttonSave).enable()}}}function B(e){const t=(0,n.Z)(e),o=t.L();var a=function(e){const t=(0,n.Z)(e),i=t.L();return new class extends t{constructor(){super("ui_work_interface_workspace_editor_components",{popup:"",list:""})}ui(){return{id:this.ids.component,css:"webix_primary",view:"button",type:"form",label:i("Add Widget"),align:"center",autowidth:!0,on:{onItemClick:()=>{this.showPopup()}}}}init(e){this.AB=e;let t=this.ids,n=this;webix.ui({view:"window",id:t.popup,modal:!0,width:600,height:550,select:!1,resize:!0,position:"center",head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Add Widget"),css:"modal_title",align:"center"},{view:"button",label:"Close",autowidth:!0,align:"center",click:()=>{this.hidePopup()}}]},body:{id:t.list,view:"dataview",css:"ab-datacollection-table borderless",borderless:!0,xCount:5,yCount:4,type:{borderless:!0,width:100,height:100},template:(e,t)=>this.template(e,t),on:{onItemClick:function(e){var t=this.getItem(e);n.addWidget(t)}}}})}show(){$$(this.ids.component).show()}hide(){$$(this.ids.component).hide()}showPopup(){$$(this.ids.popup).show()}hidePopup(){$$(this.ids.popup).hide()}addWidget(e){const t=e.newInstance(this.CurrentView.application,this.CurrentView);this.emit("widget.adding"),t.save().then((()=>{this.emit("widget.add"),this.emit("warnings")})),this.hidePopup()}template(e){if(e.common){var t=e.common().label;return t||(t=i(e.common().labelKey)),`<div class='ab-component-in-page'><i class='fa fa-2x fa-${e.common().icon}' aria-hidden='true'></i><br/>${t}</div>`}return e.label}viewLoad(e){super.viewLoad(e);let t=this.ids;var i=$$(t.list),n=$$(t.component),o=this.CurrentView.componentList();i.clearAll(),o&&o.length>0?(i.parse(o),n.show()):n.hide(),i.refresh()}}}(e),s=function(e){const t=(0,n.Z)(e),o=t.L(),a=function(e){const t=[];return[i(3759),i(8442),i(1298),i(6062),i(3725),i(3121),i(5250),i(8971),i(760),i(4713),i(2761),i(6720),i(5903),i(2442),i(559),i(2363),i(803),i(5084),i(7895),i(4826),i(6629),i(302),i(5025),i(2279),i(7912)].forEach((i=>{const n=i.default(e);t.push(n)})),{editors:function(e=(()=>!0)){return t.filter(e)}}}(e);return new class extends t{constructor(){super("ui_work_interface_workspace_editor_layout",{editArea:"",editAreaContainer:"",editAreaLeft:"",editAreaRight:"",editAreaTop:"",editAreaBottom:"",editAreaSamplePopup:""}),this.CurrentViewMode=1,this._editorsByType={}}ui(){let e=this.ids;return{view:"scrollview",id:e.component,body:{cols:[{id:e.editAreaLeft,width:1},{id:e.editAreaContainer,type:"clean",rows:[{id:e.editAreaTop,height:1},{id:e.editAreaSamplePopup,view:"toolbar",css:"webix_dark",hidden:!0,cols:[{},{view:"label",label:o("Sample Popup")},{}]},{id:e.editArea,view:"layout",borderless:!0,rows:[]},{id:e.editAreaBottom,height:1}]},{id:e.editAreaRight,width:1}]}}}init(e){this.AB=e;let t=$$(this.ids.editArea);return t&&webix.extend(t,webix.ProgressBar),a.editors().forEach((e=>{this._editorsByType[e.key]=e})),Promise.resolve()}show(){$$(this.ids.component).show()}viewLoad(e){this.currentEditor?.detatch?.(),super.viewLoad(e);let t=this.ids;var i;if($$(t.editArea).getChildViews().forEach((e=>{$$(t.editArea)?.removeView(e)})),"preview"==this.CurrentViewMode)i=e.component(),"popup"==this.CurrentView.settings.type&&this.CurrentView.settings.popupWidth&&this.CurrentView.settings.popupHeight?($$(t.editAreaContainer).define({width:parseInt(this.CurrentView.settings.popupWidth)}),$$(t.editArea).define({height:parseInt(this.CurrentView.settings.popupHeight)}),webix.html.addCss($$(t.editAreaLeft).getNode(),"preview_item"),webix.html.addCss($$(t.editAreaRight).getNode(),"preview_item"),webix.html.addCss($$(t.editAreaTop).getNode(),"preview_item"),webix.html.addCss($$(t.editAreaBottom).getNode(),"preview_item"),$$(t.editAreaLeft).define({width:0}),$$(t.editAreaRight).define({width:0}),$$(t.editAreaTop).define({height:0}),$$(t.editAreaBottom).define({height:0}),$$(t.editAreaSamplePopup).show()):"page"==this.CurrentView.settings.type&&1==this.CurrentView.settings.fixedPageWidth&&this.CurrentView.settings.pageWidth?($$(t.editAreaContainer).define({width:parseInt(this.CurrentView.settings.pageWidth)}),$$(t.editArea).define({height:0}),webix.html.removeCss($$(t.editAreaLeft).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaRight).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaTop).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaBottom).getNode(),"preview_item"),$$(t.editAreaLeft).define({width:0}),$$(t.editAreaRight).define({width:0}),$$(t.editAreaTop).define({height:1}),$$(t.editAreaBottom).define({height:1}),$$(t.editAreaSamplePopup).hide()):($$(t.editAreaContainer).define({width:0}),$$(t.editArea).define({height:0}),webix.html.removeCss($$(t.editAreaLeft).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaRight).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaTop).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaBottom).getNode(),"preview_item"),$$(t.editAreaLeft).define({width:1}),$$(t.editAreaRight).define({width:1}),$$(t.editAreaTop).define({height:1}),$$(t.editAreaBottom).define({height:1}),$$(t.editAreaSamplePopup).hide());else{let n=this._editorsByType[e.key];null==n&&(n=this._editorsByType._default),(i=new n(e)).viewLoad(e),$$(t.editAreaContainer).define({width:0}),$$(t.editArea).define({height:0}),webix.html.removeCss($$(t.editAreaLeft).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaRight).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaTop).getNode(),"preview_item"),webix.html.removeCss($$(t.editAreaBottom).getNode(),"preview_item"),$$(t.editAreaLeft).define({width:1}),$$(t.editAreaRight).define({width:1}),$$(t.editAreaTop).define({height:1}),$$(t.editAreaBottom).define({height:1}),$$(t.editAreaSamplePopup).hide()}$$(t.editArea).addView(i.ui()),i.init(this.AB,2),i.on("view.edit",(e=>{this.emit("view.load",e)})),i.on("view.destroyed",(()=>{this.emit("view.load",this.CurrentView),this.emit("warnings")})),i.onShow&&i.onShow(),this.currentEditor=i,setTimeout((()=>{$$(t.component).adjust(),$$(t.editAreaContainer).adjust()}),150)}viewModeChange(e){this.CurrentViewMode=e}busy(){let e=$$(this.ids.editArea);e?.disable(),e?.showProgress({type:"icon"})}ready(){let e=$$(this.ids.editArea);e?.enable(),e?.hideProgress()}}}(e);return new class extends t{constructor(){super("ui_work_interface_workspace_editor",{toolbar:"",toolbarMap:"",toolbarViewMode:"",toolbarViewPage:"",layoutView:"",dataView:"",noContent:""}),this.CurrentViewPart="layout",this.CurrentViewMode=0,this.PreviousViews=[],this._handlerViewUpdate=()=>{this.viewLoad(this.CurrentView)}}ui(){let e=this.ids,t=this;return{id:e.component,view:"layout",borderless:!1,rows:[{id:e.toolbar,view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{view:"button",type:"icon",icon:"fa fa-arrow-left",autowidth:!0,click:()=>{this.buttonBack()}},{id:e.toolbarMap,view:"list",layout:"x",borderless:!0,multiselect:!1,select:!1,scroll:!1,padding:0,css:"ab_breadcrumb",template:function(e){let i="";return(e.warningsAll?.()||[]).length>0&&(i=t.WARNING_ICON),'<span class="fa fa-chevron-right" aria-hidden="true"></span> '+e.label+i},on:{onItemClick:e=>{this.pageMap(e)}}},{view:"icon",icon:"fa fa-info-circle",tooltip:o('Check "Preview" to see what your layout will look like, Click "Add Widget" to add new items to the page.'),on:{onItemClick:()=>{this.infoAlert()}}}]},{view:"layout",type:"space",css:"gray",cols:[{id:e.toolbarViewMode,view:"checkbox",labelRight:o("Preview"),labelWidth:0,width:85,on:{onChange:(e,t)=>{this.viewModeChange(e,t)}}},{},a.ui()]},s.ui()]}}init(e){this.AB=e;var t=[];return $$(this.ids.toolbarViewMode).setValue(this.CurrentViewMode),t.push(s.init(e)),t.push(a.init(e)),a.on("widget.adding",(()=>{s.busy()})),a.on("widget.add",(()=>{this.viewLoad(this.CurrentView),s.ready()})),s.on("view.load",(e=>{this.emit("view.load",e)})),this.warningsPropogate([s,a]),Promise.all(t)}applicationLoad(e){super.applicationLoad(e),s.applicationLoad(e),a.applicationLoad(e)}buttonBack(){if(this.PreviousViews.length>0){var e=this.PreviousViews.pop();this.CurrentViewPart="layout",this.emit("view.load",e)}else"data"==this.CurrentViewPart&&(this.CurrentViewPart="layout",this.emit("view.load",this.CurrentView))}pageMap(e){var t=$$(this.ids.toolbarMap).getItem(e);this.CurrentViewPart="layout",this.emit("view.load",t)}infoAlert(){webix.alert({title:o("Tip"),text:o('Check "Preview" to see what your layout will look like, Click "Add Widget" to add new items to the page.')})}show(){$$(this.ids.component).show()}viewLoad(e){this.CurrentView&&e&&e.id!=this.CurrentView.id&&(this.PreviousViews.push(this.CurrentView),this.PreviousViews.length>50&&this.PreviousViews.shift()),super.viewLoad(e),this.CurrentView&&this.CurrentView.removeListener("properties.updated",this._handlerViewUpdate).once("properties.updated",this._handlerViewUpdate);let t=$$(this.ids.toolbarMap);t.clearAll(),t.parse(e.allParents()),t.refresh(),s.viewLoad(e),s.show(),a.viewLoad(e)}viewModeChange(e,t){e!=t&&(e=1==e?"preview":"block",this.CurrentViewMode=e,s.viewModeChange(this.CurrentViewMode),this.CurrentView&&this.viewLoad(this.CurrentView))}}}var I=i(7056);function T(e){var t=function(e){var t=a(e),i=new F(e),o=new V(e);const s=e.Config.uiSettings(),r=(0,n.Z)(e);var l=r.L();return new class extends r{constructor(){var e="ui_work_interface_list";super(e,{list:"",buttonNew:""}),this.EditPopup=new t(e),this.viewList=new webix.TreeCollection}ui(){var t=this.ids;return{id:t.component,rows:[{view:"unitlist",uniteBy:l("Pages"),height:34,data:[" "],type:{height:0,headerHeight:35}},{view:e._App.custom.edittree.view,id:t.list,width:s.columnWidthLarge,select:!0,editaction:"custom",editable:!0,editor:"text",editValue:"label",css:"ab-tree-ui",template:(e,t)=>this.templateListItem(e,t),type:{iconGear:"<span class='webix_icon fa fa-cog'></span>"},on:{onAfterRender:()=>{this.onAfterRender()},onAfterSelect:e=>{this.onAfterSelect(e)},onAfterOpen:()=>{this.onAfterOpen()},onAfterClose:()=>{this.onAfterClose()},onBeforeEditStop:(e,t)=>{this.onBeforeEditStop(e,t)},onAfterEditStop:(e,t,i)=>{this.onAfterEditStop(e,t,i)}},onClick:{"ab-page-list-edit":(e,t,i)=>{this.clickEditMenu(e,t,i)}}},{view:"button",css:"webix_primary",id:t.buttonNew,type:"form",value:l("Add new Page"),click:()=>{this.emit("clickNewView")}}]}}async init(e,t){this.AB=e,this.on("clickNewView",(e=>{this.clickNewView(e)})),$$(this.ids.component)&&$$(this.ids.component).adjust();let n=$$(this.ids.list);this.ListComponent=n,n&&(webix.extend(n,webix.ProgressBar),n.data.unsync(),n.data.sync(this.viewList),n.adjust()),await this.EditPopup.init(e,{hideExclude:!0}),this.EditPopup.menuOptions([{label:l("Rename"),icon:"fa fa-pencil-square-o",command:"rename"},{label:l("Copy"),icon:"fa fa-files-o",command:"copy"},{label:l("Delete"),icon:"fa fa-trash",command:"delete"}]),this.EditPopup.on("click",(e=>{switch(e){case"delete":this.remove();break;case"copy":this.copy();break;case"rename":this.rename()}})),await i.init(e),i.on("cancel",(()=>{i.hide()})),i.on("save",((e,t)=>{this.applicationLoad(this.CurrentApplication),this.ListComponent.select(e.id)})),o.on("save",(e=>{this.applicationLoad(this.CurrentApplication),this.callbackNewPage(e),this.ListComponent.select(e.id),this.listReady()})),o.on("cancel",(()=>{o.hide(),this.listReady()}))}addNew(){this.clickNewView(!0)}applicationLoad(e){super.applicationLoad(e),this.listBusy(),this.viewList.clearAll();var t=(e,i,n)=>{e&&(this.viewList.add(e,i,n),e.pages().forEach(((i,n)=>{t(i,n,e.id)})))};e.pages().forEach(((e,i)=>{t(e,i)}));var n=$$(this.ids.list);n.refresh(),n.unselectAll(),this.listReady(),i.applicationLoad(e),o.applicationLoad(e)}clickNewView(){i.show()}showGear(e){var t=$$(this.ids.list).getItemNode(e);if(t){var i=t.querySelector(".ab-page-list-edit");i.style.visibility="visible",i.style.display="block"}}show(){$$(this.ids.component).show()}refreshTemplateItem(e){e=e.updateIcon(e),this.viewList.updateItem(e.id,e)}rename(){var e=$$(this.ids.list).getSelectedId(!1);$$(this.ids.list).edit(e)}copy(){var t=$$(this.ids.list).getSelectedItem(!1);this.listBusy(),o.init(e,t),o.applicationLoad(this.CurrentApplication),o.show()}remove(){var e=$$(this.ids.list).getSelectedItem(!1);e&&webix.confirm({title:l("Delete Page"),text:l("Are you sure you wish to delete this page?"),ok:l("Yes"),cancel:l("No"),callback:async t=>{if(t){this.listBusy();try{await e.destroy(),this.listReady(),$$(this.ids.list).remove($$(this.ids.list).getSelectedId()),this.emit("deleted",e),this.emit("selected",null)}catch(t){this.AB.notify.developer(t,{context:"ui_interface_list:remove(): error removing item",base:e}),this.listReady()}}}})}clickEditMenu(e,t,i){return this.EditPopup.show(i),!1}callbackNewPage(e){var t=e.pageParent()||e.parent,n=t.id!=e.id?t.id:null;this.viewList.exists(e.id)||this.viewList.add(e,null,n),e.pages().forEach(((t,i)=>{this.viewList.exists(t.id)||this.viewList.add(t,i,e.id)})),$$(this.ids.list).refresh(),n&&$$(this.ids.list).open(n),this.select(e),i.hide()}listBusy(){$$(this.ids.list)?.showProgress?.({type:"icon"})}listReady(){$$(this.ids.list)?.hideProgress?.()}select(e){$$(this.ids.list).select(e.id)}templateListItem(e,t,i){i&&console.error("templateListItem(): oldWarnings: How'd we get here?"),e.warningsEval();let n="";e.warningsAll().length>0&&(n=this.WARNING_ICON);var o=`<div class='ab-page-list-item'>\n            ${t.icon(e)} <span class='webix_icon fa fa-${e.icon||e.viewIcon()}'></span> ${e.label}${n}<div class='ab-page-list-edit'>${t.iconGear}</div>\n            </div>`;return e.removeListener("properties.updated",this.refreshTemplateItem).once("properties.updated",this.refreshTemplateItem),o}onAfterOpen(){var e=$$(this.ids.list).getSelectedId(!1);e&&this.showGear(e)}onAfterRender(){var e=$$(this.ids.list).getSelectedId(!1);e&&this.showGear(e)}onAfterSelect(e){this.showGear(e);let t=$$(this.ids.list).getItem(e);this.emit("selected",t)}onBeforeEditStop(e){var t=$$(this.ids.list).getSelectedItem(!1);return t.label=e.value,!t.isValid||!t.isValid().fail()||(t.label=e.old,!1)}onAfterEditStop(e,t,n){if(this.showGear(t.id),e.value!=e.old){this.listBusy();var o=$$(this.ids.list).getSelectedItem(!1);o.label=e.value,o.save().then((()=>{this.listReady(),i.applicationLoad(this.CurrentApplication),webix.alert({text:l("<b>{0}</b> is renamed.",[e.value])})})).catch((t=>{this.listReady(),this.AB.notify.developer(t,{context:"ABFieldProperty: isValid()",base:e.value}),webix.alert({text:l("System could not rename <b>{0}</b>.",[e.value])})}))}}onAfterClose(){$$(this.ids.list).getSelectedId(!0).forEach((e=>{this.showGear(e)}))}}}(e),i=function(e){const t="ui_work_interface_workspace",i=e.Config.uiSettings(),o=(0,n.Z)(e),a=o.L(),r=s(e,`${t}_view_warnings`,{});return new class extends o{constructor(){super(t,{noSelection:"",selectedView:""}),this.ColumnEditor=B(e),this.ColumnDetails=function(e){const t=(0,n.Z)(e);var i=function(e){const t=(0,n.Z)(e),i=t.L(),o=(0,I.Z)(e);return new class extends t{constructor(){super("ui_work_interface_workspace_details_properties",{editors:"",form:""}),this._editorsByType={},this.currentPanel=null,this._handler_onChange=(e=3e3,t=!1)=>{if(!this.CurrentView)return;let i=this.currentPanel.values();Object.keys(i??{}).forEach((e=>{"settings"!=e&&(this.CurrentView[e]=i[e])}));var n=this.CurrentView.toObj();Object.keys(i.settings??{}).forEach((e=>{n.settings[e]=i.settings[e]})),this.CurrentView.fromValues(n);let o=this.CurrentView;this.pendingSave=!0,this.unloadListener||(this.unloadListener=this.AB.Webix.event(window,"beforeunload",(()=>{this._handler_onChange(0,!0)}))),o.__timedSave&&clearTimeout(o.__timedSave),o.__timedSave=setTimeout((async()=>{this.busy();try{await o.save(),delete o.__timedSave}catch(e){this.AB.notify.developer(e,{message:"Error trying to save the View:",view:o.toObj()}),o.AB.message({text:this.label("Error trying to save the View"),type:"error"})}finally{this.ready(),this.pendingSave=!1,this.AB.Webix.eventRemove(this.unloadListener),delete this.unloadListener,this.emit("warnings")}}),e),t||this.emit("view.changed")}}ui(){let e=this.ids;return{id:e.component,rows:[{view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{view:"spacer",width:10},{view:"label",label:i("Properties")},{view:"icon",icon:"fa fa-info-circle",tooltip:i("Tip"),on:{onItemClick:()=>{this.infoAlert()}}}]},{id:e.editors,rows:[{}]}]}}init(e){this.AB=e,o.views().forEach((e=>{this._editorsByType[e.key]=e}));const t=$$(this.ids.component);t&&this.AB.Webix.extend(t,this.AB.Webix.ProgressBar)}infoAlert(){webix.alert({title:i("Tip"),text:i("Edit a widgets properties here.")})}show(){$$(this.ids.component).expand()}viewLoad(e){this.currentPanel&&(this.pendingSave&&this._handler_onChange(10,!0),this.currentPanel.removeAllListeners("changed"),this.currentPanel=null),super.viewLoad(e);let t=this._editorsByType[e.key];if(t){let i=new t;i.applicationLoad(this.CurrentApplication);let n={id:this.ids.editors,rows:[i.ui()]};webix.ui(n,$$(this.ids.editors)),i.init(this.AB),i.populate(e),i.on("changed",this._handler_onChange),this.currentPanel=i}}ready(){const e=$$(this.ids.component);e?.enable?.(),e?.hideProgress?.()}busy(){const e=$$(this.ids.component);e?.showProgress?.({type:"icon"}),e?.disable?.()}}}(e);return new class extends t{constructor(){super("ui_work_interface_workspace_details")}ui(){return{id:this.ids.component,width:350,rows:[i.ui()]}}init(e){return this.AB=e,i.on("view.changed",(()=>{this.emit("view.changed")})),this.warningsPropogate([i]),i.init(e)}applicationLoad(e){super.applicationLoad(e),i.applicationLoad(e)}show(){$$(this.ids.component).show()}viewLoad(e){super.viewLoad(e),i.viewLoad(e)}}}(e),this.classABViewPage=e.Class.ABViewManager.viewClass("page")}ui(){let e=this.ids;return{view:"multiview",id:e.component,scroll:!0,cells:[{id:e.noSelection,rows:[{maxHeight:i.xxxLargeSpacer,hidden:i.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-file-text-o'></div>"},{view:"label",align:"center",label:a("Select a page to edit")},{cols:[{},{view:"button",css:"webix_primary",label:a("Add a new page"),type:"form",autowidth:!0,click:()=>{this.emit("view.new")}},{}]},{maxHeight:i.xxxLargeSpacer,hidden:i.hideMobile}]},{id:e.selectedView,view:"layout",rows:[{cols:[this.ColumnEditor.ui(),{view:"resizer",css:"bg_gray",width:11},this.ColumnDetails.ui()]},r.ui()]}]}}init(e){this.AB=e,$$(this.ids.noSelection).show(),$$(this.ids.selectedView).hide();var t=[];return t.push(this.ColumnEditor.init(e)),t.push(this.ColumnDetails.init(e)),this.ColumnEditor.on("view.load",(e=>{this.viewLoad(e)})),this.ColumnDetails.on("view.changed",(()=>{this.ColumnEditor.viewLoad(this.CurrentView)})),this.warningsPropogate([this.ColumnEditor,this.ColumnDetails]),this.on("warnings",(()=>{this.viewLoad(this.CurrentView)})),Promise.all(t)}applicationLoad(e){super.applicationLoad(e),this.ColumnEditor.applicationLoad(e),this.ColumnDetails.applicationLoad(e)}show(){$$(this.ids.component)?.show()}clearWorkspace(){$$(this.ids.noSelection)?.show(!1,!1)}viewLoad(e){super.viewLoad(e),$$(this.ids.selectedView)?.show(),this.ColumnEditor.viewLoad(e),this.ColumnDetails.viewLoad(e),$$(this.ids.component)?.resize(),e instanceof this.classABViewPage&&this.emit("select.view",e),r.show(e)}}}(e);const o=(0,n.Z)(e);return new class extends o{constructor(){super("ab_work_interface")}ui(){return{id:this.ids.component,type:"space",margin:10,cols:[t.ui(),{view:"resizer"},i.ui()]}}init(e){return this.AB=e,t.on("selected",(e=>{this.select(e)})),i.on("view.new",(()=>{t.clickNewView()})),i.on("select.view",(e=>{t.select(e)})),this.warningsPropogate([t,i]),this.on("warnings",(()=>{t.applicationLoad(this.CurrentApplication)})),Promise.all([i.init(e),t.init(e)])}applicationLoad(e){super.applicationLoad(e),t.applicationLoad(e),i.applicationLoad(e)}show(){$$(this.ids.component).show(),this.CurrentApplication&&t?.applicationLoad(this.CurrentApplication)}select(e){e?i.viewLoad(e):i.clearWorkspace()}}}function j(e){const t=(0,n.Z)(e),i=function(e){const t=(0,n.Z)(e),i=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_datacollection_list_newDataCollection",{tab:""}),this.selectNew=!0,this.BlankTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_dataCollection_list_newDataCollection_blank",{form:"",buttonSave:"",buttonCancel:"",object:""})}ui(){return{id:this.ids.component,header:i("Create"),body:{view:"form",id:this.ids.form,width:400,rules:{},elements:[{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Data Collection name"),labelWidth:70,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_dataCollection_list_newDatacollection_blank_name")}}},{id:this.ids.object,view:"richselect",label:i("Object"),name:"object",required:!0,placeholder:i("Select an object"),labelWidth:70,on:{onAfterRender(){t.CYPRESS_REF(this,"ui_work_dataCollection_list_newDatacollection_blank_object")}}},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.cancel()},on:{onAfterRender(){t.CYPRESS_REF(this)}}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Add Data Collection"),autowidth:!0,type:"form",click:()=>this.save(),on:{onAfterRender(){t.CYPRESS_REF(this)}}}]}]}}}async init(e){return this.AB=e,this.$form=$$(this.ids.form),this.$buttonSave=$$(this.ids.buttonSave),this.$objectList=$$(this.ids.object),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()})),Promise.resolve()}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form&&(this.$form.clearValidation(),this.$form.clear())}onError(e){if(e){console.error(e);var t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;var n=this.$form.getValues();webix.alert({title:i("Error creating DataCollection: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}this.$buttonSave.enable()}onSuccess(){this.formClear(),this.$buttonSave.enable()}save(){this.$buttonSave.disable();var e=this.$form;if(e.clearValidation(),!e.validate())return this.$buttonSave.enable(),!1;let t=e.getValues(),i=t.object,n=this.AB.objectByID(i);n||(n=this.AB.queryByID(i));let o={name:t.name,label:t.name,settings:{datasourceID:i,isQuery:n?.isQuery??!1}};this.emit("save",o)}show(){$$(this.ids.component)&&$$(this.ids.component).show()}onShow(e){if(this.$objectList&&e){let t=[];t=t.concat(e.objectsIncluded().map((e=>({id:e.id,value:e.label,icon:"fa fa-database",isQuery:!1})))),t=t.concat(e.queriesIncluded().map((e=>({id:e.id,value:e.label,icon:"fa fa-filter",isQuery:!0})))),this.$objectList.define("options",t),this.$objectList.refresh();let i=this.$objectList.getPopup();i.attachEvent("onShow",(()=>{i.define("width",350),i.resize()}))}this.$form&&this.$form.setValues({name:"",object:""})}}}(e),this.ImportTab=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_datacollection_list_newDatacollection_import",{form:"",filter:"",datacollectionList:"",buttonSave:"",buttonCancel:""})}ui(){return{id:this.ids.component,header:i("Existing"),body:{view:"form",id:this.ids.form,width:400,elements:[{cols:[{view:"icon",icon:"fa fa-filter",align:"left"},{view:"text",id:this.ids.filter,on:{onTimedKeyPress:()=>this.filter()}}]},{view:"list",id:this.ids.datacollectionList,select:!0,height:200,minHeight:250,maxHeight:250,data:[],template:"<div>#label#</div>"},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>this.cancel()},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Import"),autowidth:!0,type:"form",click:()=>this.save()}]}]}}}async init(e){this.AB=e,this.$form=$$(this.ids.form),this.$filter=$$(this.ids.filter),this.$datacollectionList=$$(this.ids.datacollectionList),this.$buttonSave=$$(this.ids.buttonSave),this.$buttonCancel=$$(this.ids.buttonCancel),this.on("save.error",(e=>{this.onError(e)})),this.on("save.successful",(()=>{this.onSuccess()}))}onShow(e){this.formClear();const t=e.datacollectionsExcluded();this.$datacollectionList.parse(t,"json")}filter(){let e=this.$filter.getValue();this.$datacollectionList.filter("#label#",e)}save(){let e=this.$datacollectionList.getSelectedItem();if(!e)return!1;this.$buttonSave.disable(),this.emit("save",e)}cancel(){this.formClear(),this.emit("cancel")}formClear(){this.$form&&(this.$form.clearValidation(),this.$form.clear()),this.$datacollectionList&&this.$datacollectionList.clearAll()}onError(e){if(e){console.error(e);let t=i("the entered data is invalid");e.updateForm?e.updateForm(this.$form):t=e.code&&e.data?e.data?.sqlMessage??t:e?.message??t;let n=this.$form.getValues();webix.alert({title:i("Error creating DataCollection: {0}",[n.name]),ok:i("fix it"),text:t,type:"alert-error"})}this.$buttonSave.enable()}onSuccess(){this.$buttonSave.enable()}}}(e)}ui(){return{view:"window",id:this.ids.component,position:"center",modal:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Add new Data Collection"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.emit("cancel")},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]},selectNewDataCollection:!0,body:{view:"tabview",id:this.ids.tab,cells:[this.BlankTab.ui(),this.ImportTab.ui()],tabbar:{on:{onAfterTabClick:e=>{this.switchTab(e)},onAfterRender(){this.$view.querySelectorAll(".webix_item_tab").forEach((t=>{var i=t.getAttribute("button_id");e.ClassUI.CYPRESS_REF(t,`${i}_tab`)}))}}}}}}async init(e){this.AB=e,webix.ui(this.ui()),webix.extend($$(this.ids.component),webix.ProgressBar),this.$component=$$(this.ids.component);let t=[];return["BlankTab","ImportTab"].forEach((i=>{t.push(this[i].init(e)),this[i].on("cancel",(()=>{this.emit("cancel")})),this[i].on("save",(e=>{if(e.id)return this.import(e,i);this.save(e,i)}))})),Promise.all(t)}busy(){this.$component?.showProgress?.()}done(e){this.ready(),this.hide(),this.emit("save",e,this.selectNew)}hide(){this.$component?.hide()}async import(e,t){this.busy();try{await this.CurrentApplication.datacollectionInsert(e),this[t].emit("save.successful",e),this.done(e)}catch(e){this.ready(),this[t].emit("save.error",e)}}ready(){this.$component?.hideProgress?.()}async save(e,t){if(!this.CurrentApplication)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this[t].emit("save.error",!0),!1;let n=this.AB.datacollectionNew(e),o=n.isValid();if(o.fail())return this[t].emit("save.error",o),!1;n.createdInAppID||(n.createdInAppID=this.CurrentApplicationID),this.busy();try{let e=await n.save();await this.CurrentApplication.datacollectionInsert(e),this[t].emit("save.successful",e),this.done(e)}catch(e){this.ready(),this[t].emit("save.error",e)}}show(e){null!=e&&(this.selectNew=e),this.$component?.show();const t=$$(this.ids.tab).getValue();this.switchTab(t)}switchTab(e){e!=this.BlankTab?.ui()?.body?.id&&e?e==this.ImportTab?.ui()?.body?.id&&this.ImportTab?.onShow?.(this.CurrentApplication):this.BlankTab?.onShow?.(this.CurrentApplication)}}}(e);return new class extends t{constructor(){super("ui_work_datacollection_list");let t=this;this.ListComponent=l(e,{idBase:this.ids.component,labels:{addNew:"Add new data collection",confirmDeleteTitle:"Delete Data Collection",title:"Data Collections",searchPlaceholder:"Data Collection name"},menu:{copy:!1,exclude:!0},templateListItem:function(e,i,n){let o="";return n?.length>0&&(o=t.WARNING_ICON),`<div class='ab-datacollection-list-item'>\n                  <i class="fa ${e.settings.isQuery?"fa-filter":"fa-database"}"></i>\n                  ${e.label||"??label??"}\n                  ${o}\n                  ${i.iconGear(e)}\n               </div>`}})}ui(){return this.ListComponent.ui()}async init(e){this.AB=e,this.on("addNew",(e=>{this.clickNewDataCollection(e)})),await this.ListComponent.init(e),this.ListComponent.on("selected",(e=>{this.emit("selected",e)})),this.ListComponent.on("addNew",(e=>{this.clickNewDataCollection(e)})),this.ListComponent.on("deleted",(e=>{this.emit("deleted",e)})),this.ListComponent.on("exclude",(e=>{this.exclude(e)})),await i.init(e),i.on("cancel",(()=>{i.hide()})),i.on("save",(e=>{this.applicationLoad(this.CurrentApplication),this.ListComponent.select(e.id)}))}applicationLoad(e){var t=this.CurrentApplicationID,n=null;super.applicationLoad(e),t==this.CurrentApplicationID&&(n=this.ListComponent.selectedItem());var o=e=>!e.isSystemObject;this.AB.Account.isSystemDesigner()&&(o=()=>!0),this.ListComponent.dataLoad(e?.datacollectionsIncluded(o)),n&&this.ListComponent.selectItem(n.id),i.applicationLoad(e)}warningsRefresh(){if(this.CurrentApplication){var e=e=>!e.isSystemObject;this.AB.Account.isSystemDesigner()&&(e=()=>!0);let t=this.ListComponent.selectedItem();this.ListComponent.dataLoad(this.CurrentApplication?.datacollectionsIncluded(e)),this.ListComponent.selectItem(t.id)}}async exclude(e){this.ListComponent.busy();var t=this.CurrentApplication;await(t?.datacollectionRemove(e)),this.ListComponent.dataLoad(t?.datacollectionsIncluded()),this.emit("selected",null)}ready(){this.ListComponent.ready()}clickNewDataCollection(){i.show()}}}(e),o=function(e,t){const i="ui_work_datacollection_workspace",o=e.Config.uiSettings(),a=(0,n.Z)(e),r=a.L(),l=S(e,`${i}_view_grid`,t),c=function(e){const t="ui_work_datacollection_workspace_properties",i=(0,n.Z)(e),o=e.Config.uiSettings(),a=e.custom,s=i.L();return new class extends i{constructor(){super(t,{propertyPanel:"",dataSource:"",linkDatacollection:"",linkField:"",followCursor:"",loadAllPanel:"",loadAll:"",fixSelect:"",filterPanel:"",populate:"",populateOptions:"",sortPanel:"",buttonFilter:"",buttonSort:"",list:"",filter:"",sort:""}),this.AB=e,this._templateListItem="\n            <div class='ab-page-list-item'>\n               {common.icon()} <span class='webix_icon fa fa-#typeIcon#'></span> #label# #hasDataCollection#\n            </div>\n         ",this._handler_loadData=e=>{this.populateFixSelector(e)},this.viewList=null,this.FilterComponent=this.AB.filterComplexNew(this.ids.filter),this.PopupSortFieldComponent=(0,w.Z)(e,t)}ui(){const e=this.ids,t=this;return{width:o.columnWidthXLarge,rows:[{view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{view:"spacer",width:10},{view:"label",label:s("Properties")}]},{view:"scrollview",id:e.propertyPanel,body:{padding:15,rows:[{view:"fieldset",label:s("Data Source:"),labelWidth:o.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.dataSource,view:"richselect",name:"dataSource",label:s("Source:"),labelWidth:o.labelWidthLarge,options:{data:[]},on:{onChange:(e,t)=>{e!=t&&(this.selectSource(e,t),this.save())}}},{id:e.linkDatacollection,view:"select",name:"linkDatacollection",label:s("Linked To:"),labelWidth:o.labelWidthLarge,options:[],hidden:1,on:{onChange:e=>{this.initLinkFieldOptions(e),this.save()}}},{id:e.linkField,view:"select",name:"linkField",label:s("Linked Field:"),labelWidth:o.labelWidthLarge,options:[],hidden:1,on:{onChange:()=>{this.save()}}},{id:e.followCursor,view:"select",name:"followCursor",label:s("Follow Cursor:"),labelWidth:o.labelWidthLarge,hidden:1,on:{onChange:()=>{this.changeFollowCursor(),this.save()}}}]}},{view:"fieldset",label:s("Advanced Options:"),labelWidth:o.labelWidthLarge,body:{type:"clean",padding:10,rows:[{id:e.filterPanel,name:"filterPanel",cols:[{view:"label",label:s("Filter Data:"),width:o.labelWidthLarge},{id:e.buttonFilter,css:"webix_primary",view:"button",name:"buttonFilter",label:s("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:function(){t.showFilterPopup(this.$view)}}]},{id:e.sortPanel,name:"sortPanel",cols:[{view:"label",label:s("Sort Data:"),width:o.labelWidthLarge},{id:e.buttonSort,css:"webix_primary",view:"button",name:"buttonSort",label:s("Settings"),icon:"fa fa-gear",type:"icon",badge:0,click:function(){t.showSortPopup(this.$view)}}]},{id:e.loadAllPanel,cols:[{view:"label",label:s("Load all:"),width:o.labelWidthLarge},{id:e.loadAll,view:"checkbox",name:"loadAll",label:"",on:{onChange:()=>{this.save()}}}]},{id:e.populate,view:"radio",name:"populate",label:s("Load Connections:"),labelWidth:o.labelWidthXLarge,labelPosition:"top",value:"all",tooltip:"#value# - #description#<br>#tip#",options:[{id:"all",value:s("All"),description:s("Load all the connected data"),tip:s("Will impact perfomance if your object has many connections")},{id:"none",value:s("None"),description:s("Don't load any connected data"),tip:s("Will load fast, but won't work with linked data collections")},{id:"custom",value:s("Custom"),description:s("Select the relevant connections to load"),tip:""}],on:{onItemClick:()=>{"custom"==$$(e.populate).getValue()?$$(e.populateOptions).show():(this.save(),$$(e.populateOptions).hide())}}},{id:e.populateOptions,view:"multicombo",name:"populateOptions",hidden:!0,placeholder:s("Select connections to load"),on:{onChange:()=>this.save()}},{id:e.fixSelect,view:"select",name:"fixSelect",label:s("Select:"),labelWidth:o.labelWidthLarge,options:[],on:{onChange:()=>{this.save()}}}]}},{view:"fieldset",label:s("Data used in..."),labelWidth:o.labelWidthLarge,body:{view:a.edittree.view,id:e.list,select:!0,editaction:"custom",editable:!0,editor:"text",editValue:"label",borderless:!0,padding:0,css:"ab-tree-ui",minHeight:300,template:(e,t)=>this.templateListItem(e,t),type:{iconGear:"<span class='webix_icon fa fa-cog'></span>"},on:{onAfterSelect:e=>{this.onAfterSelect(e)}}}},{maxHeight:o.mediumSpacer,height:o.mediumSpacer,minHeight:o.mediumSpacer,hidden:o.hideMobile}]}}]}}async init(e){this.AB=e;const t=this.ids,i=$$(t.list),n=$$(t.propertyPanel);i&&(webix.extend(i,webix.ProgressBar),i.adjust()),n&&webix.extend(n,webix.ProgressBar),this.initPopupEditors(),this.FilterComponent.myPopup=webix.ui({view:"popup",height:240,width:480,hidden:!0,body:this.FilterComponent.ui}),this.FilterComponent.on("save",(()=>{this.onFilterChange(),this.save()})),this.PopupSortFieldComponent.on("changed",(e=>{this.onSortChange(e),this.save()}))}onAfterSelect(e){const t=this.ids,i=$$(t.list).getItem(e),n=this.CurrentApplication.views((e=>e.id==i.id))[0];setTimeout((()=>{this.emit("interface",n)}),50)}applicationLoad(e){super.applicationLoad(e);const t=this.ids;this.refreshDataSourceOptions(),this.listBusy(),this.viewList=new webix.TreeCollection;const i=(e,t,n)=>{const o={id:e.viewId||e.id,label:e.label,icon:e.icon?e.icon:"",viewIcon:e.viewIcon?e.viewIcon():"",datacollection:{id:e.datacollection?e.datacollection.id:""}};this.viewList.add(o,t,n);const a=e.pages?e.pages():[];a.forEach(((t,n)=>{i(t,n,e.id)})),a.forEach(((t,n)=>{const o=a.length+n;i(t,o,e.id)})),a.forEach(((t,n)=>{t.views().forEach(((t,o)=>{const s=a.length+n+o;i(t,s,e.id)}))}))};this.CurrentApplication.pages().forEach(((e,t)=>{i(e,t)}));const n=$$(t.list);n.clearAll(),n.data.unsync(),n.data.sync(this.viewList),n.refresh(),n.parse(this.viewList),n.unselectAll(),this.listReady()}datacollectionLoad(e){const t=this.ids;super.datacollectionLoad(e);let i={};const n=$$(t.filterPanel),o=$$(t.sortPanel),a=$$(t.dataSource),s=$$(t.linkDatacollection),r=$$(t.linkField),l=$$(t.followCursor),c=$$(t.loadAll),d=$$(t.fixSelect),u=$$(t.populate),h=$$(t.list);this.CurrentDatacollection&&(i=this.CurrentDatacollection.settings||{},this.CurrentDatacollection.removeListener("loadData",this._handler_loadData),this.CurrentDatacollection.on("loadData",this._handler_loadData)),this.initLinkDatacollectionOptions(),this.initLinkFieldOptions(this.CurrentDatacollection?.datacollectionLink?.id||null),this.populatePopupEditors(),this.populateBadgeNumber(),i.isQuery?(n.hide(),o.hide()):(n.show(),o.show()),this.refreshDataSourceOptions(),a.define("value",i.datasourceID),s.define("value",i.linkDatacollectionID),r.define("value",i.linkFieldID),l.define("value",i.followDatacollectionID),c.define("value",i.loadAll),d.define("value",i.fixSelect);const p=Array.isArray(i.populate)?"custom":i.populate?"all":"none";u.define("value",p),"custom"==p?($$(t.populateOptions).define("value",i.populate),$$(t.populateOptions).refresh(),$$(t.populateOptions).show()):$$(t.populateOptions).hide(),this.initPopulateOptions(),this.initFollowCursorOptions(),this.changeFollowCursor(),a.refresh(),s.refresh(),r.refresh(),l.refresh(),c.refresh(),d.refresh(),u.refresh(),h.openAll()}initPopulateOptions(){const e=this.ids,t=this.CurrentDatacollection?.datasource??null,i=t?.connectFields()??[];t&&i.length>0?($$(e.populate).enable(),$$(e.populateOptions).define("options",i.map((e=>({id:e.columnName,value:e.label})))),$$(e.populateOptions).refresh()):$$(e.populate).disable()}refreshDataSourceOptions(){if(!this.CurrentApplication)return;const e=this.ids;let t=[];const i=this.CurrentApplication.objectsIncluded().map((e=>e?{id:e.id,value:e.label,isQuery:!1,icon:"fa fa-database"}:null));t=t.concat(i);const n=this.CurrentApplication.queriesIncluded().map((e=>e?{id:e.id,value:e.label,isQuery:!0,icon:"fa fa-filter",disabled:e?.isDisabled()}:null));t=t.concat(n),t=t.filter((e=>null!==e)),t.unshift({id:"",value:s("Select a source")}),$$(e.dataSource).define("options",{body:{scheme:{$init:function(e){e.disabled&&(e.$css="disabled")}},data:t}}),$$(e.dataSource).refresh()}initFollowCursorOptions(){const e=$$(this.ids.followCursor),t=[];let i=[];this.CurrentDatacollection?.datasource&&(i=this.CurrentApplication.datacollectionsIncluded().filter((e=>e?.id!=this.CurrentDatacollection.id&&e?.settings?.datasourceID==this.CurrentDatacollection.datasource.id))),i?.length>0&&i.forEach((e=>{t.push({id:e.id,value:e.label})})),t.unshift({id:"",value:s("Select a data collection")}),e.define("options",t),e.define("value",this.CurrentDatacollection?.settings?.followDatacollectionID??null),e.refresh()}busy(){const e=this.ids,t=$$(e.propertyPanel);t?.showProgress&&t.showProgress({type:"icon"})}ready(){const e=this.ids,t=$$(e.propertyPanel);t?.hideProgress&&t.hideProgress()}changeFollowCursor(){const e=this.ids,t=this.CurrentDatacollection?.settings??{},i=$$(e.followCursor),n=$$(e.linkDatacollection),o=$$(e.linkField),a=$$(e.filterPanel),s=$$(e.sortPanel),r=$$(e.loadAllPanel),l=$$(e.fixSelect);i.getValue()?(n.hide(),o.hide(),a.hide(),s.hide(),r.hide(),l.hide()):(n.show(),t.isQuery||(a.show(),s.show()),r.show(),l.show())}save(){if(!this.CurrentDatacollection)return Promise.resolve();this.busy();const e=this.ids,t=this.CurrentDatacollection.settings||{};t.datasourceID=$$(e.dataSource).getValue(),t.linkDatacollectionID=$$(e.linkDatacollection).getValue(),t.linkFieldID=$$(e.linkField).getValue(),t.followDatacollectionID=$$(e.followCursor).getValue(),t.objectWorkspace={},t.objectWorkspace.filterConditions=this.FilterComponent.getValue(),t.objectWorkspace.sortFields=this.PopupSortFieldComponent.getSettings(),t.loadAll=$$(e.loadAll).getValue(),t.fixSelect=$$(e.fixSelect).getValue();const i=$$(e.populate).getValue();t.populate="all"==i||"none"!=i&&$$(e.populateOptions).getValue().split(","),this.CurrentDatacollection.settings=t;const n=$$(e.dataSource).getPopup().getList().getItem(this.CurrentDatacollection.settings.datasourceID);return this.CurrentDatacollection.settings.isQuery=!!n&&n.isQuery,new Promise(((e,t)=>{this.CurrentDatacollection.save().then((()=>{this.CurrentDatacollection.clearAll(),this.ready(),this.emit("save",this.CurrentDatacollection),e()})).catch((e=>{this.ready(),t(e)}))}))}initLinkDatacollectionOptions(){const e=this.ids,t=this.CurrentDatacollection?.datasource||null,i=$$(e.linkDatacollection),n=$$(e.linkField),o=$$(e.followCursor);if(t){const e=t.connectFields().map((e=>e.settings.linkObject)),a=[],r=this.CurrentApplication.datacollectionsIncluded().filter((t=>e.includes(t?.settings.datasourceID)));r?.length>0?(r.forEach((e=>{a.push({id:e.id,value:e.label})})),a.unshift({id:"",value:s("Select a link source")}),i.show(),i.define("options",a),i.define("value",this.CurrentDatacollection?.settings?.linkDatacollectionID||""),i.refresh(),o.hide()):(i.hide(),n.hide(),o.show())}else i.hide(),n.hide(),o.show()}initLinkFieldOptions(e=null){const t=this.ids,i=[],n=e?this.AB.datacollectionByID(e):null;if(n){const e=this.CurrentDatacollection.datasource,t=n.datasource;e.connectFields().filter((e=>e.settings.linkObject==(t||{}).id)).forEach((e=>{i.push({id:e.id,value:e.label})}))}const o=$$(t.linkField);i.length>0?o.show():o.hide();let a=i[0]?i[0].id:"";this.CurrentDatacollection?.settings&&(a=this.CurrentDatacollection.settings.linkFieldID),o.define("options",i),o.define("value",a),o.refresh();const s=$$(t.followCursor);i.length<1||!a?s.show():s.hide(),s.define("value",this.CurrentDatacollection?.settings?.followCursor),s.refresh()}populatePopupEditors(){const e=this.CurrentDatacollection||null,t=e?.datasource||null;if(t){const i=e?.settings?.objectWorkspace?.filterConditions||{glue:"and",rules:[]},n=e?.settings?.objectWorkspace?.sortFields||[];this.FilterComponent.fieldsLoad(t?t.fields():[]),this.FilterComponent.queriesLoad(this.CurrentApplication?.queriesIncluded()),this.FilterComponent.setValue(i),this.CurrentDatacollection.refreshFilterConditions(i),this.PopupSortFieldComponent.objectLoad(t),this.PopupSortFieldComponent.setSettings(n)}}populateBadgeNumber(){const e=this.ids,t=this.CurrentDatacollection,i=$$(e.buttonFilter),n=$$(e.buttonSort);t?.settings?.objectWorkspace?.filterConditions?.rules?(i.define("badge",t.settings.objectWorkspace.filterConditions.rules?.length||null),i.refresh()):(i.define("badge",null),i.refresh()),t?.settings?.objectWorkspace?.sortFields?(n.define("badge",t.settings.objectWorkspace.sortFields.length||null),n.refresh()):(n.define("badge",null),n.refresh())}populateFixSelector(e){const t=this.ids;let i="";const n=this.CurrentDatacollection.datasource,o=e?.data?.map((e=>({id:e.id,value:n?n.displayData(e):""})))||[];n&&(n.fields((e=>"user"==e.key)).length>0&&o.unshift({id:"_CurrentUser",value:s("Current User")}),o.unshift({id:"_FirstRecord",value:s("First Record")},{id:"_FirstRecordDefault",value:s("Default to First Record")})),o.unshift({id:"",value:s("Select fix cursor")}),i=this.CurrentDatacollection.settings.fixSelect||"";const a=$$(t.fixSelect);a.define("options",o),a.define("value",i),a.refresh()}initPopupEditors(){this.FilterComponent.init(),this.PopupSortFieldComponent.init(this.AB)}selectSource(e,t){const i=this.ids,n=$$(i.dataSource).getList().getItem(e),o=$$(i.dataSource);n?.disabled&&(o.blockEvent(),o.setValue(t||""),o.unblockEvent());const a=this.CurrentDatacollection.toObj()||{};a.settings=a.settings||{},a.settings.datasourceID=e,this.CurrentDatacollection.fromValues(a);const s=$$(i.filterPanel),r=$$(i.sortPanel);n.isQuery?(s.hide(),r.hide()):(this.initLinkDatacollectionOptions(),this.initLinkFieldOptions(this.CurrentDatacollection?.datacollectionLink?.id||null),this.initPopupEditors(),this.populatePopupEditors(),this.populateBadgeNumber(),s.show(),r.show())}showFilterPopup(e){this.FilterComponent.popUp(e,null,{pos:"top"})}showSortPopup(e){this.PopupSortFieldComponent.show(e,null,{pos:"top"})}onFilterChange(){if(!this.CurrentDatacollection)return;const e=this.FilterComponent.getValue();this.FilterComponent.isConditionComplete(e)||this.FilterComponent.setValue({glue:"and",rules:[]}),this.populateBadgeNumber()}onSortChange(e){const t=this.CurrentDatacollection;t&&(t.settings=t.settings||{},t.settings.objectWorkspace=t.settings.objectWorkspace||{},t.settings.objectWorkspace.sortFields=e||[],this.populateBadgeNumber())}switchTab(){}templateListItem(e,t){let i=this._templateListItem,n="";return e.datacollection&&this.CurrentDatacollection?.id&&e.datacollection.id==this.CurrentDatacollection.id&&(n="<i class='webix_icon hasDataCollection fa fa-check-circle'></i>"),i=i.replace("#typeIcon#",e.icon||e.viewIcon()).replace("#label#",e.label).replace("{common.icon()}",t.icon(e)).replace("#hasDataCollection#",n),i}listBusy(){const e=this.ids,t=$$(e.list);t?.showProgress&&t.showProgress({type:"icon"})}listReady(){const e=this.ids,t=$$(e.list);t?.hideProgress&&t.hideProgress()}}}(e),d=s(e,`${i}_view_warnings`,t);return new class extends a{constructor(t,i={}){super(t,{multiview:"",noSelection:"",workspace:""}),this.AB=e,this.settings=i,this.workspaceViews=R(e,`${t}_views`,i),this.hashViewsGrid=l}ui(){const e=this.ids;return{view:"multiview",id:e.multiview,cells:[{id:e.noSelection,rows:[{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-table'></div>"},{view:"label",align:"center",label:r("Select a datacollection to work with.")},{cols:[{},{view:"button",css:"webix_primary",label:r("Add new data collection"),type:"form",autowidth:!0,click:()=>{this.emit("addNew",!0)}},{}]},{maxHeight:o.xxxLargeSpacer,hidden:o.hideMobile}]},{id:e.workspace,view:"layout",rows:[{cols:[l.ui(),{view:"resizer",css:"bg_gray",width:11},c.ui()]},d.ui()]}]}}async init(e){const t=this.ids;this.AB=e,this.warningsPropogate([c,l]),this.on("warnings",(()=>{d.show(this.mockDatacollection)})),this.workspaceViews.init(e),c.on("save",(async e=>{this.datacollectionLoad(e),this.hashViewsGrid&&await this.hashViewsGrid.show(l.defaultSettings()),await this.populateWorkspace(e)})),await l.init(e),await c.init(e),this.mockDatacollection=this.AB.datacollectionNew({}),this.mockDatacollection.init(),l.datacollectionLoad(this.mockDatacollection),c.datacollectionLoad(this.mockDatacollection),$$(t.noSelection).show()}applicationLoad(e){super.applicationLoad(e),l.applicationLoad(e),c.applicationLoad(e)}datacollectionLoad(e){super.datacollectionLoad(e),d.show(e),l.datacollectionLoad(e),c.datacollectionLoad(e),e||this.clearWorkspace()}loadAll(){l.loadAll()}loadData(){this.mockDatacollection.clearAll();try{this.mockDatacollection.loadData(0,20)}catch(e){let t=e.toString();if("string"==typeof e)try{const i=JSON.parse(e);i.data&&i.data.sqlMessage&&(t=i.data.sqlMessage)}catch(e){}this.AB.notify.developer(e,{context:"ui_work_datacollection_workspace.loadData()",message:t,datacollection:this.mockDatacollection.toObj()})}}clearWorkspace(){const e=this.ids;$$(e.noSelection).show(!1,!1)}async populateWorkspace(e){const t=this.ids;$$(t.workspace).show(),this.mockDatacollection=e,this.workspaceViews.objectLoad(null),this.workspaceViews.objectLoad(this.mockDatacollection.datasource);const i=this.workspaceViews.getCurrentView();this.hashViewsGrid&&(this.workspaceViews.setCurrentView(i.id),await this.hashViewsGrid.show(i)),await this.workspaceViews.save(),this.loadData(),this.warningsRefresh(e)}}(i,t)}(e,{allowDelete:0,configureHeaders:!1,detailsView:"",editView:"",isEditable:0,massUpdate:0,isReadOnly:!0});return new class extends t{constructor(){super("ui_work_datacollection")}ui(){return{id:this.ids.component,type:"space",cols:[i.ui(),{view:"resizer",width:11},o.ui()]}}async init(e){this.AB=e,i.on("selected",(e=>{this.select(e)})),o.on("addNew",(e=>{i.emit("addNew",e)})),this.warningsPropogate([i,o]),this.on("warnings",(()=>{i.warningsRefresh()})),await o.init(e),await i.init(e)}applicationLoad(e){const t=this.CurrentApplicationID;super.applicationLoad(e),t!=this.CurrentApplicationID&&o.clearWorkspace(),i.applicationLoad(e),o.applicationLoad(e)}show(){const e=this.ids;$$(e.component).show(!1,!1);const t=this.CurrentApplication;t&&(o.applicationLoad(t),i.applicationLoad(t)),i.ready()}select(e){null==e&&o.clearWorkspace(),o.datacollectionLoad(e),o.populateWorkspace(e)}}}var O,M,N=i(9293),W=i.n(N),z=(O=function(e){var t=e.exports=function(e,i){if(i||(i=16),void 0===e&&(e=128),e<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(i),o=2;n===1/0;o*=2)n=Math.log(Math.pow(2,e/o))/Math.log(i)*o;var a=n-Math.floor(n),s="";for(o=0;o<Math.floor(n);o++)s=Math.floor(Math.random()*i).toString(i)+s;if(a){var r=Math.pow(i,a);s=Math.floor(Math.random()*r).toString(i)+s}var l=parseInt(s,i);return l!==1/0&&l>=Math.pow(2,e)?t(e,i):s};t.rack=function(e,i,n){var o=function(o){var s=0;do{if(s++>10){if(!n)throw new Error("too many ID collisions, use more bits");e+=n}var r=t(e,i)}while(Object.hasOwnProperty.call(a,r));return a[r]=o,r},a=o.hats={};return o.get=function(e){return o.hats[e]},o.set=function(e,t){return o.hats[e]=t,o},o.bits=e||128,o.base=i||16,o}},O(M={exports:{}}),M.exports);function U(e){if(!(this instanceof U))return new U(e);e=e||[128,36,1],this._seed=e.length?z.rack(e[0],e[1],e[2]):e}U.prototype.next=function(e){return this._seed(e||!0)},U.prototype.nextPrefixed=function(e,t){var i;do{i=e+this.next(!0)}while(this.assigned(i));return this.claim(i,t),i},U.prototype.claim=function(e,t){this._seed.set(e,t||!0)},U.prototype.assigned=function(e){return this._seed.get(e)||!1},U.prototype.unclaim=function(e){delete this._seed.hats[e]},U.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};const H=U;function q(e){return Array.prototype.concat.apply([],e)}var G=Object.prototype.toString,Y=Object.prototype.hasOwnProperty;function Z(e){return void 0===e}function K(e){return void 0!==e}function X(e){return null==e}function Q(e){return"[object Array]"===G.call(e)}function J(e){return"[object Object]"===G.call(e)}function ee(e){return"[object Number]"===G.call(e)}function te(e){var t=G.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object AsyncGeneratorFunction]"===t||"[object Proxy]"===t}function ie(e){return"[object String]"===G.call(e)}function ne(e,t){return Y.call(e,t)}function oe(e,t){var i;return t=we(t),se(e,(function(e,n){if(t(e,n))return i=e,!1})),i}function ae(e,t){var i=[];return se(e,(function(e,n){t(e,n)&&i.push(e)})),i}function se(e,t){var i;if(!Z(e)){var n=Q(e)?$e:xe;for(var o in e)if(ne(e,o)&&!1===t(i=e[o],n(o)))return i}}function re(e,t,i){return se(e,(function(e,n){i=t(i,e,n)})),i}function le(e,t){return!!re(e,(function(e,i,n){return e&&t(i,n)}),!0)}function ce(e,t){return!!oe(e,t)}function de(e,t){var i=[];return se(e,(function(e,n){i.push(t(e,n))})),i}function ue(e){return e&&Object.keys(e)||[]}function he(e){return ue(e).length}function pe(e){return de(e,(function(e){return e}))}function me(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=ye(t),se(e,(function(e){var n=t(e)||"_",o=i[n];o||(o=i[n]=[]),o.push(e)})),i}function fe(e){e=ye(e);for(var t={},i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];se(n,(function(i){return me(i,e,t)}));var a=de(t,(function(e,t){return e[0]}));return a}var ge=fe;function ve(e,t){t=ye(t);var i=[];return se(e,(function(e,n){for(var o=t(e,n),a={d:o,v:e},s=0;s<i.length;s++)if(o<i[s].d)return void i.splice(s,0,a);i.push(a)})),de(i,(function(e){return e.v}))}function be(e){return function(t){return le(e,(function(e,i){return t[i]===e}))}}function ye(e){return te(e)?e:function(t){return t[e]}}function we(e){return te(e)?e:function(t){return t===e}}function xe(e){return e}function $e(e){return Number(e)}function _e(e,t){var i,n,o,a;function s(i){var s=Date.now(),c=i?0:a+t-s;if(c>0)return r(c);e.apply(o,n),l()}function r(e){i=setTimeout(s,e)}function l(){i&&clearTimeout(i),i=a=n=o=void 0}function c(){a=Date.now();for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];n=s,o=this,i||r(t)}return c.flush=function(){i&&s(!0),l()},c.cancel=l,c}function Ce(e,t){return e.bind(t)}function Ee(){return Ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Ee.apply(this,arguments)}function Se(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Ee.apply(void 0,[e].concat(i))}function ke(e,t){var i={},n=Object(e);return se(t,(function(t){t in n&&(i[t]=e[t])})),i}function Ae(e,t){var i={};return se(Object(e),(function(e,n){-1===t.indexOf(n)&&(i[n]=e)})),i}function Re(e,t,i){return 2==arguments.length?e.getAttribute(t):null===i?e.removeAttribute(t):(e.setAttribute(t,i),e)}var De=[].indexOf,Pe=function(e,t){if(De)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1},Le=/\s+/,Fe=Object.prototype.toString;function Ve(e){return new Be(e)}function Be(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function Ie(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}Be.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~Pe(t,e)||t.push(e),this.el.className=t.join(" "),this},Be.prototype.remove=function(e){if("[object RegExp]"==Fe.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),i=Pe(t,e);return~i&&t.splice(i,1),this.el.className=t.join(" "),this},Be.prototype.removeMatching=function(e){for(var t=this.array(),i=0;i<t.length;i++)e.test(t[i])&&this.remove(t[i]);return this},Be.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},Be.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(Le);return""===e[0]&&e.shift(),e},Be.prototype.has=Be.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Pe(this.array(),e)};var Te="undefined"!=typeof Element?Element.prototype:{},je=Te.matches||Te.matchesSelector||Te.webkitMatchesSelector||Te.mozMatchesSelector||Te.msMatchesSelector||Te.oMatchesSelector,Oe=function(e,t){if(!e||1!==e.nodeType)return!1;if(je)return je.call(e,t);for(var i=e.parentNode.querySelectorAll(t),n=0;n<i.length;n++)if(i[n]==e)return!0;return!1};function Me(e,t,i){for(var n=i?e:e.parentNode;n&&n.nodeType!==document.DOCUMENT_NODE&&n.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(Oe(n,t))return n;n=n.parentNode}return Oe(n,t)?n:null}var Ne,We=window.addEventListener?"addEventListener":"attachEvent",ze=window.removeEventListener?"removeEventListener":"detachEvent",Ue="addEventListener"!==We?"on":"",He={bind:function(e,t,i,n){return e[We](Ue+t,i,n||!1),i},unbind:function(e,t,i,n){return e[ze](Ue+t,i,n||!1),i}},qe=["focus","blur"],Ge=function(e,t,i,n,o){return-1!==qe.indexOf(i)&&(o=!0),He.bind(e,i,(function(i){var o=i.target||i.srcElement;i.delegateTarget=Me(o,t,!0),i.delegateTarget&&n.call(e,i)}),o)},Ye=function(e,t,i,n){return-1!==qe.indexOf(t)&&(n=!0),He.unbind(e,t,i,n)},Ze=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var i=/<([\w:]+)/.exec(e);if(!i)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var n=i[1];if("body"==n)return(o=t.createElement("html")).innerHTML=e,o.removeChild(o.lastChild);var o,a=Xe[n]||Xe._default,s=a[0],r=a[1],l=a[2];for((o=t.createElement("div")).innerHTML=r+e+l;s--;)o=o.lastChild;if(o.firstChild==o.lastChild)return o.removeChild(o.firstChild);for(var c=t.createDocumentFragment();o.firstChild;)c.appendChild(o.removeChild(o.firstChild));return c},Ke=!1;"undefined"!=typeof document&&((Ne=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Ke=!Ne.getElementsByTagName("link").length,Ne=void 0);var Xe={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Ke?[1,"X<div>","</div>"]:[0,"",""]};function Qe(e,t){return(t=t||document).querySelector(e)}function Je(e,t){return(t=t||document).querySelectorAll(e)}function et(e){e.parentNode&&e.parentNode.removeChild(e)}function tt(e,t){return t.appendChild(function(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}(e,t))}function it(e,t){return tt(t,e),e}Xe.td=Xe.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],Xe.option=Xe.optgroup=[1,'<select multiple="multiple">',"</select>"],Xe.thead=Xe.tbody=Xe.colgroup=Xe.caption=Xe.tfoot=[1,"<table>","</table>"],Xe.polyline=Xe.ellipse=Xe.polygon=Xe.circle=Xe.text=Xe.line=Xe.path=Xe.rect=Xe.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var nt={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":2,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":2,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function ot(e,t,i){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=nt[n];o?(2===o&&"number"==typeof i&&(i=String(i)+"px"),e.style[n]=i):e.setAttributeNS(null,t,i)}function at(e,t,i){if("string"==typeof t){if(void 0===i)return function(e,t){return nt[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);ot(e,t,i)}else!function(e,t){var i,n,o=Object.keys(t);for(i=0;n=o[i];i++)ot(e,n,t[n])}(e,t);return e}function st(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}var rt=/\s+/,lt=Object.prototype.toString;function ct(e){return void 0!==e}function dt(e){return new ut(e)}function ut(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function ht(e){var t=e.parentNode;return t&&t.removeChild(e),e}function pt(e){for(var t;t=e.firstChild;)ht(t);return e}function mt(e){return e.cloneNode(!0)}ut.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~st(t,e)||t.push(e),ct(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},ut.prototype.remove=function(e){if("[object RegExp]"===lt.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),i=st(t,e);return~i&&t.splice(i,1),this.el.className.baseVal=t.join(" "),this},ut.prototype.removeMatching=function(e){for(var t=this.array(),i=0;i<t.length;i++)e.test(t[i])&&this.remove(t[i]);return this},ut.prototype.toggle=function(e,t){return this.list?(ct(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(ct(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},ut.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(rt);return""===e[0]&&e.shift(),e},ut.prototype.has=ut.prototype.contains=function(e){return this.list?this.list.contains(e):!!~st(this.array(),e)};var ft="http://www.w3.org/2000/svg",gt='<svg xmlns="'+ft+'"';function vt(e){var t=!1;"<svg"===e.substring(0,4)?-1===e.indexOf(ft)&&(e=gt+e.substring(4)):(e=gt+">"+e+"</svg>",t=!0);var i=function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e);if(!t)return i;for(var n=document.createDocumentFragment(),o=i.firstChild;o.firstChild;)n.appendChild(o.firstChild);return n}function bt(e,t){var i;return"<"===e.charAt(0)?(i=vt(e).firstChild,i=document.importNode(i,!0)):i=document.createElementNS(ft,e),t&&at(i,t),i}var yt=bt("svg");function wt(e,t){var i,n,o=Object.keys(t);for(i=0;n=o[i];i++)e[n]=t[n];return e}function xt(e){return e?yt.createSVGTransformFromMatrix(e):yt.createSVGTransform()}var $t=/([&<>]{1})/g,_t=/([\n\r"]{1})/g,Ct={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Et(e,t){return e.replace(t,(function(e,t){return Ct[t]||t}))}function St(e,t){var i,n,o,a,s;switch(e.nodeType){case 3:t.push(Et(e.textContent,$t));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(i=0,n=(o=e.attributes).length;i<n;++i)a=o.item(i),t.push(" ",a.name,'="',Et(a.value,_t),'"');if(e.hasChildNodes()){for(t.push(">"),i=0,n=(s=e.childNodes).length;i<n;++i)St(s.item(i),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("\x3c!--",Et(e.nodeValue,$t),"--\x3e");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function kt(e,t){if(void 0!==t){try{!function(e,t){var i=vt(t);if(pt(e),t){(function(e){return"#document-fragment"===e.nodeName})(i)||(i=i.documentElement);for(var n,o=(n=i.childNodes,Array.prototype.slice.call(n)),a=0;a<o.length;a++)tt(o[a],e)}}(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}return function(e){for(var t=e.firstChild,i=[];t;)St(t,i),t=t.nextSibling;return i.join("")}(e)}function At(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function Rt(e,t){var i=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),function(e,t){var i,n;for(e.clear(),i=0;n=t[i];i++)e.appendItem(At(e,n))}(i,t)),i.consolidate()}var Dt=/^class /;function Pt(e){return"[object Array]"===Object.prototype.toString.call(e)}function Lt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ft(){var e=Array.prototype.slice.call(arguments);1===e.length&&Pt(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Vt=/constructor\s*[^(]*\(\s*([^)]*)\)/m,Bt=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,It=/\/\*([^*]*)\*\//m;function Tt(e){if("function"!=typeof e)throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(function(e){return Dt.test(e.toString())}(e)?Vt:Bt);return t&&t[1]&&t[1].split(",").map((function(e){return(t=e.match(It))?t[1].trim():e.trim()}))||[]}function jt(){var e=[];this.factory=function(t,i){return e.push([t,"factory",i]),this},this.value=function(t,i){return e.push([t,"value",i]),this},this.type=function(t,i){return e.push([t,"type",i]),this},this.forEach=function(t){e.forEach(t)}}function Ot(e,t){t=t||{get:function(e,t){if(i.push(e),!1===t)return null;throw s('No provider for "'+e+'"!')}};var i=[],n=this._providers=Object.create(t._providers||null),o=this._instances=Object.create(null),a=o.injector=this,s=function(e){var t=i.join(" -> ");return i.length=0,new Error(t?e+" (Resolving: "+t+")":e)},r=function(e,a){if(!n[e]&&-1!==e.indexOf(".")){for(var l=e.split("."),c=r(l.shift());l.length;)c=c[l.shift()];return c}if(Lt(o,e))return o[e];if(Lt(n,e)){if(-1!==i.indexOf(e))throw i.push(e),s("Cannot resolve circular dependency!");return i.push(e),o[e]=n[e][0](n[e][1]),i.pop(),o[e]}return t.get(e,a)},l=function(e,t){if(void 0===t&&(t={}),"function"!=typeof e){if(!Pt(e))throw new Error('Cannot invoke "'+e+'". Expected a function!');e=Ft(e.slice())}return{fn:e,dependencies:(e.$inject||Tt(e)).map((function(e){return Lt(t,e)?t[e]:r(e)}))}},c=function(e){var t=l(e),i=t.fn,n=t.dependencies;return new(Function.prototype.bind.apply(i,[null].concat(n)))},d=function(e,t,i){var n=l(e,i),o=n.fn,a=n.dependencies;return o.apply(t,a)},u=function(e){return Ft((function(t){return e.get(t)}))},h={factory:d,type:c,value:function(e){return e}};e.forEach((function(e){function t(e,t){return"value"!==e&&Pt(t)&&(t=Ft(t.slice())),t}if(e instanceof jt)e.forEach((function(e){var i=e[0],o=e[1],a=e[2];n[i]=[h[o],t(o,a),o]}));else if("object"==typeof e)if(e.__exports__){var i=Object.keys(e).reduce((function(t,i){return"__"!==i.substring(0,2)&&(t[i]=e[i]),t}),Object.create(null)),o=new Ot((e.__modules__||[]).concat([i]),a),s=Ft((function(e){return o.get(e)}));e.__exports__.forEach((function(e){n[e]=[s,e,"private",o]}))}else Object.keys(e).forEach((function(i){if("private"!==e[i][2]){var o=e[i][0],a=e[i][1];n[i]=[h[o],t(o,a),o]}else n[i]=e[i]}))})),this.get=r,this.invoke=d,this.instantiate=c,this.createChild=function(e,t){if(t&&t.length){var i,o,s,r,l=Object.create(null),c=Object.create(null),d=[],h=[],p=[];for(var m in n)i=n[m],-1!==t.indexOf(m)&&("private"===i[2]?-1===(o=d.indexOf(i[3]))?(s=i[3].createChild([],t),r=u(s),d.push(i[3]),h.push(s),p.push(r),l[m]=[r,m,"private",s]):l[m]=[p[o],m,"private",h[o]]:l[m]=[i[2],i[1]],c[m]=!0),"factory"!==i[2]&&"type"!==i[2]||!i[1].$scope||t.forEach((function(e){-1!==i[1].$scope.indexOf(e)&&(l[m]=[i[2],i[1]],c[e]=!0)}));t.forEach((function(e){if(!c[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')})),e.unshift(l)}return new Ot(e,a)}}var Mt=i(2270),Nt=i.n(Mt);function Wt(e,t){var i=this;t=t||1e3,e.on(["render.shape","render.connection"],t,(function(e,t){var n=e.type,o=t.element,a=t.gfx,s=t.attrs;if(i.canRender(o))return"render.shape"===n?i.drawShape(a,o,s):i.drawConnection(a,o,s)})),e.on(["render.getShapePath","render.getConnectionPath"],t,(function(e,t){if(i.canRender(t))return"render.getShapePath"===e.type?i.getShapePath(t):i.getConnectionPath(t)}))}function zt(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Ut(e){for(var t,i="",n=0;t=e[n];n++)i+=t.x+","+t.y+" ";return i}function Ht(e,t){var i=bt("polyline");return at(i,{points:Ut(e)}),t&&at(i,t),i}function qt(e){return ae(e,(function(t){return!oe(e,(function(e){return e!==t&&Gt(t,e)}))}))}function Gt(e,t){if(t){if(e===t)return t;if(e.parent)return Gt(e.parent,t)}}function Yt(e,t,i){var n=!i||-1===e.indexOf(t);return n&&e.push(t),n}function Zt(e,t,i){i=i||0,Q(e)||(e=[e]),se(e,(function(e,n){var o=t(e,n,i);Q(o)&&o.length&&Zt(o,t,i+1)}))}function Kt(e,t){return function(e,t,i){var n=[],o=[];return Zt(e,(function(e,a,s){Yt(n,e,t);var r=e.children;if((-1===i||s<i)&&r&&Yt(o,r,t))return r})),n}(e,!t,-1)}function Xt(e,t){var i,n,o,a;return t=!!t,Q(e)||(e=[e]),se(e,(function(e){var s=e;e.waypoints&&!t&&(s=Xt(e.waypoints,!0));var r=s.x,l=s.y,c=s.height||0,d=s.width||0;(r<i||void 0===i)&&(i=r),(l<n||void 0===n)&&(n=l),(r+d>o||void 0===o)&&(o=r+d),(l+c>a||void 0===a)&&(a=l+c)})),{x:i,y:n,height:a-n,width:o-i}}function Qt(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Jt(e){return!(!e||!e.isFrame)}function ei(e,t){return Se({},e||{},t||{})}function ti(e,t){Wt.call(this,e,1),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}Wt.prototype.canRender=function(){},Wt.prototype.drawShape=function(){},Wt.prototype.drawConnection=function(){},Wt.prototype.getShapePath=function(){},Wt.prototype.getConnectionPath=function(){},Nt()(ti,Wt),ti.prototype.canRender=function(){return!0},ti.prototype.drawShape=function(e,t,i){var n=bt("rect");return at(n,{x:0,y:0,width:t.width||0,height:t.height||0}),Jt(t)?at(n,Se({},this.FRAME_STYLE,i||{})):at(n,Se({},this.SHAPE_STYLE,i||{})),it(e,n),n},ti.prototype.drawConnection=function(e,t,i){var n=Ht(t.waypoints,Se({},this.CONNECTION_STYLE,i||{}));return it(e,n),n},ti.prototype.getShapePath=function(e){var t=e.x,i=e.y,n=e.width;return zt([["M",t,i],["l",n,0],["l",0,e.height],["l",-n,0],["z"]])},ti.prototype.getConnectionPath=function(e){var t,i,n=e.waypoints,o=[];for(t=0;i=n[t];t++)i=i.original||i,o.push([0===t?"M":"L",i.x,i.y]);return zt(o)},ti.$inject=["eventBus","styles"];const ii={__init__:["defaultRenderer"],defaultRenderer:["type",ti],styles:["type",function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,i){return Se(this.style(t,i),{class:e})},this.style=function(t,i){Q(t)||i||(i=t,t=[]);var n=re(t,(function(t,i){return Se(t,e[i]||{})}),{});return i?Se(n,i):n},this.computeStyle=function(e,i,n){return Q(i)||(n=i,i=[]),t.style(i||[],Se({},n,e||{}))}}]};function ni(e,t){if(!e||!t)return-1;var i=e.indexOf(t);return-1!==i&&e.splice(i,1),i}function oi(e,t,i){if(e&&t){"number"!=typeof i&&(i=-1);var n=e.indexOf(t);if(-1!==n){if(n===i)return;if(-1===i)return;e.splice(n,1)}-1!==i?e.splice(i,0,t):e.push(t)}}function ai(e,t){return e&&t?e.indexOf(t):-1}function si(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}function ri(e,t,i,n){if(void 0===n&&(n=5),!e||!t||!i)return!1;var o=(t.x-e.x)*(i.y-e.y)-(t.y-e.y)*(i.x-e.x),a=si(e,t);return Math.abs(o/a)<=n}function li(e,t){var i;return function(e,t){var i,n=(i=Q(e)?e:[e,void 0]).slice().shift();return le(i,(function(e){return Math.abs(n.y-e.y)<=2}))}(i=Q(e)?e:[e,t])?"h":!!function(e,t){var i,n=(i=Q(e)?e:[e,void 0]).slice().shift();return le(i,(function(e){return Math.abs(n.x-e.x)<=2}))}(i)&&"v"}function ci(e,t,i){return i=i||0,e.x>t.x-i&&e.y>t.y-i&&e.x<t.x+t.width+i&&e.y<t.y+t.height+i}function di(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var ui=i(2720),hi=i.n(ui);function pi(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function mi(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function fi(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function gi(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function vi(e){return mi({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function bi(e,t,i){J(i=i||0)||(i={x:i,y:i});var n=fi(e),o=fi(t),a=n.bottom+i.y<=o.top,s=n.left-i.x>=o.right,r=n.top-i.y>=o.bottom,l=a?"top":r?"bottom":null,c=n.right+i.x<=o.left?"left":s?"right":null;return c&&l?l+"-"+c:c||l||"intersect"}function yi(e,t,i){var n,o,a=(n=e,o=t,hi()(n,o));return 1===a.length||2===a.length&&si(a[0],a[1])<1?mi(a[0]):a.length>1?mi((a=ve(a,(function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t})))[i?0:a.length-1]):null}function wi(e,t){return Math.round(e*t)/t}function xi(e){return ee(e)?e+"px":e}function $i(e,t,i){var n=bt("g");dt(n).add(t);var o=void 0!==i?i:e.childNodes.length-1;return e.insertBefore(n,e.childNodes[o]||null),n}var _i={shape:["x","y","width","height"],connection:["waypoints"]};function Ci(e,t,i,n){this._eventBus=t,this._elementRegistry=n,this._graphicsFactory=i,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._init(e||{})}function Ei(e,t){var i="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",i)}Ci.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],Ci.prototype._init=function(e){var t=this._eventBus,i=this._container=function(e){var t=(e=Se({},{width:"100%",height:"100%"},e)).container||document.body,i=document.createElement("div");return i.setAttribute("class","djs-container"),Se(i.style,{position:"relative",overflow:"hidden",width:xi(e.width),height:xi(e.height)}),t.appendChild(i),i}(e),n=this._svg=bt("svg");at(n,{width:"100%",height:"100%"}),it(i,n);var o=this._viewport=$i(n,"viewport");!1!==e.deferUpdate&&(this._viewboxChanged=_e(Ce(this._viewboxChanged,this),300)),t.on("diagram.init",(function(){t.fire("canvas.init",{svg:n,viewport:o})}),this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],(function(){delete this._cachedViewbox}),this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},Ci.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},Ci.prototype._clear=function(){var e=this;this._elementRegistry.getAll().forEach((function(t){var i=Qt(t);"root"===i?e.removeRootElement(t):e._removeElement(t,i)})),this._planes=[],this._rootElement=null,delete this._cachedViewbox},Ci.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},Ci.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var i=this._layers[e];if(i||(i=this._layers[e]=this._createLayer(e,t)),void 0!==t&&i.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return i.group},Ci.prototype._getChildIndex=function(e){return re(this._layers,(function(t,i){return i.visible&&e>=i.index&&t++,t}),0)},Ci.prototype._createLayer=function(e,t){void 0===t&&(t=1);var i=this._getChildIndex(t);return{group:$i(this._viewport,"layer-"+e,i),index:t,visible:!0}},Ci.prototype.showLayer=function(e){if(!e)throw new Error("must specify a name");var t=this._layers[e];if(!t)throw new Error("layer <"+e+"> does not exist");var i=this._viewport,n=t.group,o=t.index;if(t.visible)return n;var a=this._getChildIndex(o);return i.insertBefore(n,i.childNodes[a]||null),t.visible=!0,n},Ci.prototype.hideLayer=function(e){if(!e)throw new Error("must specify a name");var t=this._layers[e];if(!t)throw new Error("layer <"+e+"> does not exist");var i=t.group;return t.visible?(ht(i),t.visible=!1,i):i},Ci.prototype._removeLayer=function(e){var t=this._layers[e];t&&(delete this._layers[e],ht(t.group))},Ci.prototype.getActiveLayer=function(){var e=this._findPlaneForRoot(this.getRootElement());return e?e.layer:null},Ci.prototype.findRoot=function(e){if("string"==typeof e&&(e=this._elementRegistry.get(e)),e){var t=this._findPlaneForRoot(function(e){for(;e.parent;)e=e.parent;return e}(e))||{};return t.rootElement}},Ci.prototype.getRootElements=function(){return this._planes.map((function(e){return e.rootElement}))},Ci.prototype._findPlaneForRoot=function(e){return oe(this._planes,(function(t){return t.rootElement===e}))},Ci.prototype.getContainer=function(){return this._container},Ci.prototype._updateMarker=function(e,t,i){var n;e.id||(e=this._elementRegistry.get(e)),(n=this._elementRegistry._elements[e.id])&&(se([n.gfx,n.secondaryGfx],(function(e){e&&(i?dt(e).add(t):dt(e).remove(t))})),this._eventBus.fire("element.marker.update",{element:e,gfx:n.gfx,marker:t,add:!!i}))},Ci.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},Ci.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},Ci.prototype.hasMarker=function(e,t){return e.id||(e=this._elementRegistry.get(e)),dt(this.getGraphics(e)).has(t)},Ci.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},Ci.prototype.getRootElement=function(){var e=this._rootElement;return e||this._planes.length?e:this.setRootElement(this.addRootElement(null))},Ci.prototype.addRootElement=function(e){var t=this._rootsIdx++;e||(e={id:"__implicitroot_"+t,children:[],isImplicit:!0});var i=e.layer="root-"+t;this._ensureValid("root",e);var n=this.getLayer(i,0);return this.hideLayer(i),this._addRoot(e,n),this._planes.push({rootElement:e,layer:n}),e},Ci.prototype.removeRootElement=function(e){if("string"==typeof e&&(e=this._elementRegistry.get(e)),this._findPlaneForRoot(e))return this._removeRoot(e),this._removeLayer(e.layer),this._planes=this._planes.filter((function(t){return t.rootElement!==e})),this._rootElement===e&&(this._rootElement=null),e},Ci.prototype.setRootElement=function(e,t){if(K(t))throw new Error("override not supported");if(e!==this._rootElement){if(!e)throw new Error("rootElement required");return this._findPlaneForRoot(e)||(e=this.addRootElement(e)),this._setRoot(e),e}},Ci.prototype._removeRoot=function(e){var t=this._elementRegistry,i=this._eventBus;i.fire("root.remove",{element:e}),i.fire("root.removed",{element:e}),t.remove(e)},Ci.prototype._addRoot=function(e,t){var i=this._elementRegistry,n=this._eventBus;n.fire("root.add",{element:e}),i.add(e,t),n.fire("root.added",{element:e,gfx:t})},Ci.prototype._setRoot=function(e,t){var i=this._rootElement;i&&(this._elementRegistry.updateGraphics(i,null,!0),this.hideLayer(i.layer)),e&&(t||(t=this._findPlaneForRoot(e).layer),this._elementRegistry.updateGraphics(e,this._svg,!0),this.showLayer(e.layer)),this._rootElement=e,this._eventBus.fire("root.set",{element:e})},Ci.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element <"+t.id+"> already exists");var i=_i[e],n=le(i,(function(e){return void 0!==t[e]}));if(!n)throw new Error("must supply { "+i.join(", ")+" } with "+e)},Ci.prototype._setParent=function(e,t,i){oi(t.children,e,i),e.parent=t},Ci.prototype._addElement=function(e,t,i,n){i=i||this.getRootElement();var o=this._eventBus,a=this._graphicsFactory;this._ensureValid(e,t),o.fire(e+".add",{element:t,parent:i}),this._setParent(t,i,n);var s=a.create(e,t,n);return this._elementRegistry.add(t,s),a.update(e,t,s),o.fire(e+".added",{element:t,gfx:s}),t},Ci.prototype.addShape=function(e,t,i){return this._addElement("shape",e,t,i)},Ci.prototype.addConnection=function(e,t,i){return this._addElement("connection",e,t,i)},Ci.prototype._removeElement=function(e,t){var i=this._elementRegistry,n=this._graphicsFactory,o=this._eventBus;if(e=i.get(e.id||e))return o.fire(t+".remove",{element:e}),n.remove(e),ni(e.parent&&e.parent.children,e),e.parent=null,o.fire(t+".removed",{element:e}),i.remove(e),e},Ci.prototype.removeShape=function(e){return this._removeElement(e,"shape")},Ci.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},Ci.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},Ci.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},Ci.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},Ci.prototype.viewbox=function(e){if(void 0===e&&this._cachedViewbox)return this._cachedViewbox;var t,i,n,o,a,s,r,l=this._viewport,c=this.getSize();return e?(this._changeViewbox((function(){a=Math.min(c.width/e.width,c.height/e.height);var t=this._svg.createSVGMatrix().scale(a).translate(-e.x,-e.y);Rt(l,t)})),e):(t=(n=this._rootElement?this.getActiveLayer():null)&&n.getBBox()||{},i=(o=Rt(l))?o.matrix:function(e,t,i,n,o,a){var s=yt.createSVGMatrix();switch(arguments.length){case 0:return s;case 1:return wt(s,e);case 6:return wt(s,{a:e,b:t,c:i,d:n,e:o,f:a})}}(),a=wi(i.a,1e3),s=wi(-i.e||0,1e3),r=wi(-i.f||0,1e3),e=this._cachedViewbox={x:s?s/a:0,y:r?r/a:0,width:c.width/a,height:c.height/a,scale:a,inner:{width:t.width||0,height:t.height||0,x:t.x||0,y:t.y||0},outer:c})},Ci.prototype.scroll=function(e){var t=this._viewport,i=t.getCTM();return e&&this._changeViewbox((function(){e=Se({dx:0,dy:0},e||{}),i=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(i),Ei(t,i)})),{x:i.e,y:i.f}},Ci.prototype.scrollToElement=function(e,t){var i=100;"string"==typeof e&&(e=this._elementRegistry.get(e));var n=this.findRoot(e);n!==this.getRootElement()&&this.setRootElement(n),t||(t={}),"number"==typeof t&&(i=t),t={top:t.top||i,right:t.right||i,bottom:t.bottom||i,left:t.left||i};var o,a,s=Xt(e),r=fi(s),l=this.viewbox(),c=this.zoom();l.y+=t.top/c,l.x+=t.left/c,l.width-=(t.right+t.left)/c,l.height-=(t.bottom+t.top)/c;var d=fi(l);if(s.width<l.width&&s.height<l.height){var u=Math.max(0,r.right-d.right),h=Math.min(0,r.left-d.left),p=Math.max(0,r.bottom-d.bottom),m=Math.min(0,r.top-d.top);o=u||h,a=p||m}else o=s.x-l.x,a=s.y-l.y;this.scroll({dx:-o*c,dy:-a*c})},Ci.prototype.zoom=function(e,t){return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox((function(){"object"!=typeof t&&(i=this.viewbox().outer,t={x:i.width/2,y:i.height/2}),n=this._setZoom(e,t)})),wi(n.a,1e3)):this.viewbox(e).scale;var i,n},Ci.prototype._fitViewport=function(e){var t,i,n=this.viewbox(),o=n.outer,a=n.inner;return a.x>=0&&a.y>=0&&a.x+a.width<=o.width&&a.y+a.height<=o.height&&!e?i={x:0,y:0,width:Math.max(a.width+a.x,o.width),height:Math.max(a.height+a.y,o.height)}:(t=Math.min(1,o.width/a.width,o.height/a.height),i={x:a.x+(e?a.width/2-o.width/t/2:0),y:a.y+(e?a.height/2-o.height/t/2:0),width:o.width/t,height:o.height/t}),this.viewbox(i),this.viewbox(!1).scale},Ci.prototype._setZoom=function(e,t){var i,n,o,a,s=this._svg,r=this._viewport,l=s.createSVGMatrix(),c=s.createSVGPoint(),d=(n=r.getCTM()).a;return t?(i=Se(c,t).matrixTransform(n.inverse()),o=l.translate(i.x,i.y).scale(1/d*e).translate(-i.x,-i.y),a=n.multiply(o)):a=l.scale(e),Ei(this._viewport,a),a},Ci.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},Ci.prototype.getAbsoluteBBox=function(e){var t,i=this.viewbox();return{x:(t=e.waypoints?this.getGraphics(e).getBBox():e).x*i.scale-i.x*i.scale,y:t.y*i.scale-i.y*i.scale,width:t.width*i.scale,height:t.height*i.scale}},Ci.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Si="data-element-id";function ki(e){this._elements={},this._eventBus=e}ki.$inject=["eventBus"],ki.prototype.add=function(e,t,i){var n=e.id;this._validateId(n),at(t,Si,n),i&&at(i,Si,n),this._elements[n]={element:e,gfx:t,secondaryGfx:i}},ki.prototype.remove=function(e){var t=this._elements,i=e.id||e,n=i&&t[i];n&&(at(n.gfx,Si,""),n.secondaryGfx&&at(n.secondaryGfx,Si,""),delete t[i])},ki.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var i=this.getGraphics(e),n=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,i,n)},ki.prototype.updateGraphics=function(e,t,i){var n=e.id||e,o=this._elements[n];return i?o.secondaryGfx=t:o.gfx=t,t&&at(t,Si,n),t},ki.prototype.get=function(e){var t;t="string"==typeof e?e:e&&at(e,Si);var i=this._elements[t];return i&&i.element},ki.prototype.filter=function(e){var t=[];return this.forEach((function(i,n){e(i,n)&&t.push(i)})),t},ki.prototype.find=function(e){for(var t=this._elements,i=Object.keys(t),n=0;n<i.length;n++){var o=t[i[n]],a=o.element;if(e(a,o.gfx))return a}},ki.prototype.getAll=function(){return this.filter((function(e){return e}))},ki.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach((function(i){var n=t[i],o=n.element,a=n.gfx;return e(o,a)}))},ki.prototype.getGraphics=function(e,t){var i=e.id||e,n=this._elements[i];return n&&(t?n.secondaryGfx:n.gfx)},ki.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Ai=i(1235),Ri=i.n(Ai),Di=new(Ri())({name:"children",enumerable:!0,collection:!0},{name:"parent"}),Pi=new(Ri())({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Li=new(Ri())({name:"attachers",collection:!0},{name:"host"}),Fi=new(Ri())({name:"outgoing",collection:!0},{name:"source"}),Vi=new(Ri())({name:"incoming",collection:!0},{name:"target"});function Bi(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,i=this.labels;!e&&t?i.remove(t):i.add(e,0)}}),Di.bind(this,"parent"),Pi.bind(this,"labels"),Fi.bind(this,"outgoing"),Vi.bind(this,"incoming")}function Ii(){Bi.call(this),Di.bind(this,"children"),Li.bind(this,"host"),Li.bind(this,"attachers")}function Ti(){Ii.call(this)}function ji(){Ii.call(this),Pi.bind(this,"labelTarget")}function Oi(){Bi.call(this),Fi.bind(this,"source"),Vi.bind(this,"target")}Nt()(Ii,Bi),Nt()(Ti,Ii),Nt()(ji,Ii),Nt()(Oi,Bi);var Mi={connection:Oi,shape:Ii,label:ji,root:Ti};function Ni(){this._uid=12}Ni.prototype.createRoot=function(e){return this.create("root",e)},Ni.prototype.createLabel=function(e){return this.create("label",e)},Ni.prototype.createShape=function(e){return this.create("shape",e)},Ni.prototype.createConnection=function(e){return this.create("connection",e)},Ni.prototype.create=function(e,t){return(t=Se({},t||{})).id||(t.id=e+"_"+this._uid++),function(e,t){var i=Mi[e];if(!i)throw new Error("unknown type: <"+e+">");return Se(new i,t)}(e,t)};var Wi=Array.prototype.slice;function zi(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Ui(){}function Hi(e){return e.childNodes[0]}function qi(e,t,i,n,o){var a=xt();a.setTranslate(t,i);var s=xt();s.setRotate(n||0,0,0);var r=xt();r.setScale(o||1,o||1),Rt(e,[a,s,r])}function Gi(e,t,i){var n=xt();n.setTranslate(t,i),Rt(e,n)}function Yi(e,t){var i=xt();i.setRotate(t,0,0),Rt(e,i)}function Zi(e,t){this._eventBus=e,this._elementRegistry=t}function Ki(e,t,i){var n=i||t.firstChild;e!==n&&t.insertBefore(e,n)}zi.prototype.on=function(e,t,i,n){if(e=Q(e)?e:[e],te(t)&&(n=i,i=t,t=1e3),!ee(t))throw new Error("priority must be a number");var o=i;n&&((o=Ce(i,n)).__fn=i.__fn||i);var a=this;e.forEach((function(e){a._addListener(e,{priority:t,callback:o,next:null})}))},zi.prototype.once=function(e,t,i,n){var o=this;if(te(t)&&(n=i,i=t,t=1e3),!ee(t))throw new Error("priority must be a number");function a(){a.__isTomb=!0;var t=i.apply(n,arguments);return o.off(e,a),t}a.__fn=i,this.on(e,t,a)},zi.prototype.off=function(e,t){e=Q(e)?e:[e];var i=this;e.forEach((function(e){i._removeListener(e,t)}))},zi.prototype.createEvent=function(e){var t=new Ui;return t.init(e),t},zi.prototype.fire=function(e,t){var i,n,o,a;if(a=Wi.call(arguments),"object"==typeof e&&(e=(t=e).type),!e)throw new Error("no event type specified");if(n=this._listeners[e]){i=t instanceof Ui?t:this.createEvent(t),a[0]=i;var s=i.type;e!==s&&(i.type=e);try{o=this._invokeListeners(i,a,n)}finally{e!==s&&(i.type=s)}return void 0===o&&i.defaultPrevented&&(o=!1),o}},zi.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},zi.prototype._destroy=function(){this._listeners={}},zi.prototype._invokeListeners=function(e,t,i){for(var n;i&&!e.cancelBubble;)n=this._invokeListener(e,t,i),i=i.next;return n},zi.prototype._invokeListener=function(e,t,i){var n;if(i.callback.__isTomb)return n;try{n=function(e,t){return e.apply(null,t)}(i.callback,t),void 0!==n&&(e.returnValue=n,e.stopPropagation()),!1===n&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener",e),e}return n},zi.prototype._addListener=function(e,t){var i,n=this._getListeners(e);if(n){for(;n;){if(n.priority<t.priority)return t.next=n,void(i?i.next=t:this._setListeners(e,t));i=n,n=n.next}i.next=t}else this._setListeners(e,t)},zi.prototype._getListeners=function(e){return this._listeners[e]},zi.prototype._setListeners=function(e,t){this._listeners[e]=t},zi.prototype._removeListener=function(e,t){var i,n,o,a=this._getListeners(e);if(t)for(;a;)i=a.next,(o=a.callback)!==t&&o.__fn!==t||(n?n.next=i:this._setListeners(e,i)),n=a,a=i;else this._setListeners(e,null)},Ui.prototype.stopPropagation=function(){this.cancelBubble=!0},Ui.prototype.preventDefault=function(){this.defaultPrevented=!0},Ui.prototype.init=function(e){Se(this,e||{})},Zi.$inject=["eventBus","elementRegistry"],Zi.prototype._getChildrenContainer=function(e){var t,i=this._elementRegistry.getGraphics(e);return e.parent?(t=function(e){return e.parentNode.childNodes[1]}(i),t||(dt(t=bt("g")).add("djs-children"),it(i.parentNode,t))):t=i,t},Zi.prototype._clear=function(e){var t=Hi(e);return Ie(t),t},Zi.prototype._createContainer=function(e,t,i,n){var o=bt("g");dt(o).add("djs-group"),void 0!==i?Ki(o,t,t.childNodes[i]):it(t,o);var a=bt("g");dt(a).add("djs-element"),dt(a).add("djs-"+e),n&&dt(a).add("djs-frame"),it(o,a);var s=bt("g");return dt(s).add("djs-visual"),it(a,s),a},Zi.prototype.create=function(e,t,i){var n=this._getChildrenContainer(t.parent);return this._createContainer(e,n,i,Jt(t))},Zi.prototype.updateContainments=function(e){var t,i=this,n=this._elementRegistry;t=re(e,(function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e}),{}),se(t,(function(e){var t=e.children;if(t){var o=i._getChildrenContainer(e);se(t.slice().reverse(),(function(e){Ki(n.getGraphics(e).parentNode,o)}))}}))},Zi.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},Zi.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},Zi.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},Zi.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},Zi.prototype.update=function(e,t,i){if(t.parent){var n=this._clear(i);if("shape"===e)this.drawShape(n,t),Gi(i,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(n,t)}t.hidden?at(i,"display","none"):at(i,"display","block")}},Zi.prototype.remove=function(e){ht(this._elementRegistry.getGraphics(e).parentNode)};const Xi={__depends__:[ii],__init__:["canvas"],canvas:["type",Ci],elementRegistry:["type",ki],elementFactory:["type",Ni],eventBus:["type",zi],graphicsFactory:["type",Zi]};function Qi(e,t){this.injector=t=t||function(e){return function(e){var t=[],i=[];function n(e){return t.indexOf(e)>=0}e.forEach((function e(o){n(o)||((o.__depends__||[]).forEach(e),n(o)||(function(e){t.push(e)}(o),(o.__init__||[]).forEach((function(e){i.push(e)}))))}));var o=new Ot(t);return i.forEach((function(e){try{o["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}})),o}([{config:["value",e=e||{}]},Xi].concat(e.modules||[]))}(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}function Ji(){}function en(e,t){this.model=e,this.properties=t}Qi.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},Qi.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")},Ji.prototype.get=function(e){return this.$model.properties.get(this,e)},Ji.prototype.set=function(e,t){this.$model.properties.set(this,e,t)},en.prototype.createType=function(e){var t=this.model,i=this.properties,n=Object.create(Ji.prototype);se(e.properties,(function(e){e.isMany||void 0===e.default||(n[e.name]=e.default)})),i.defineModel(n,t),i.defineDescriptor(n,e);var o=e.ns.name;function a(e){i.define(this,"$type",{value:o,enumerable:!0}),i.define(this,"$attrs",{value:{}}),i.define(this,"$parent",{writable:!0}),se(e,Ce((function(e,t){this.set(t,e)}),this))}return a.prototype=n,a.hasType=n.$instanceOf=this.model.hasType,i.defineModel(a,t),i.defineDescriptor(a,e),a};var tn={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},nn={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function on(e,t){var i=nn[e];return i?i(t):t}function an(e){return!!tn[e]}function sn(e){return!!nn[e]}function rn(e,t){var i,n,o=e.split(/:/);if(1===o.length)i=e,n=t;else{if(2!==o.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);i=o[1],n=o[0]}return{name:e=(n?n+":":"")+i,prefix:n,localName:i}}function ln(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function cn(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,se(e,Ce(this.registerPackage,this))}function dn(e,t,i){var n=t[i];if(n in e)throw new Error("package with "+i+" <"+n+"> already defined")}function un(e){this.model=e}function hn(e,t,i){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:i,configurable:!0})}function pn(e){this.properties=new un(this),this.factory=new en(this,this.properties),this.registry=new cn(e,this.properties),this.typeCache={}}ln.prototype.build=function(){return ke(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},ln.prototype.addProperty=function(e,t,i){"boolean"==typeof t&&(i=t,t=void 0),this.addNamedProperty(e,!1!==i);var n=this.properties;void 0!==t?n.splice(t,0,e):n.push(e)},ln.prototype.replaceProperty=function(e,t,i){var n=e.ns,o=this.properties,a=this.propertiesByName,s=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var r=o.indexOf(e);if(-1===r)throw new Error("property <"+n.name+"> not found in property list");o.splice(r,1),this.addProperty(t,i?void 0:r,s),a[n.name]=a[n.localName]=t},ln.prototype.redefineProperty=function(e,t,i){var n=e.ns.prefix,o=t.split("#"),a=rn(o[0],n),s=rn(o[1],a.prefix).name,r=this.propertiesByName[s];if(!r)throw new Error("refined property <"+s+"> not found");this.replaceProperty(r,e,i),delete e.redefines},ln.prototype.addNamedProperty=function(e,t){var i=e.ns,n=this.propertiesByName;t&&(this.assertNotDefined(e,i.name),this.assertNotDefined(e,i.localName)),n[i.name]=n[i.localName]=e},ln.prototype.removeNamedProperty=function(e){var t=e.ns,i=this.propertiesByName;delete i[t.name],delete i[t.localName]},ln.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},ln.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},ln.prototype.assertNotDefined=function(e,t){var i=e.name,n=this.propertiesByName[i];if(n)throw new Error("property <"+i+"> already defined; override of <"+n.definedBy.ns.name+"#"+n.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},ln.prototype.hasProperty=function(e){return this.propertiesByName[e]},ln.prototype.addTrait=function(e,t){var i=this.allTypesByName,n=this.allTypes,o=e.name;o in i||(se(e.properties,Ce((function(i){i=Se({},i,{name:i.ns.localName,inherited:t}),Object.defineProperty(i,"definedBy",{value:e});var n=i.replaces,o=i.redefines;n||o?this.redefineProperty(i,n||o,n):(i.isBody&&this.setBodyProperty(i),i.isId&&this.setIdProperty(i),this.addProperty(i))}),this)),n.push(e),i[o]=e)},cn.prototype.getPackage=function(e){return this.packageMap[e]},cn.prototype.getPackages=function(){return this.packages},cn.prototype.registerPackage=function(e){e=Se({},e);var t=this.packageMap;dn(t,e,"prefix"),dn(t,e,"uri"),se(e.types,Ce((function(t){this.registerType(t,e)}),this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},cn.prototype.registerType=function(e,t){var i=rn((e=Se({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:Se(e.meta||{})})).name,t.prefix),n=i.name,o={};se(e.properties,Ce((function(e){var t=rn(e.name,i.prefix),n=t.name;an(e.type)||(e.type=rn(e.type,t.prefix).name),Se(e,{ns:t,name:n}),o[n]=e}),this)),Se(e,{ns:i,name:n,propertiesByName:o}),se(e.extends,Ce((function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(n)}),this)),this.definePackage(e,t),this.typeMap[n]=e},cn.prototype.mapTypes=function(e,t,i){var n=an(e.name)?{name:e.name}:this.typeMap[e.name],o=this;function a(e){return s(e,!0)}function s(i,n){var a=rn(i,an(i)?"":e.prefix);o.mapTypes(a,t,n)}if(!n)throw new Error("unknown type <"+e.name+">");se(n.superClass,i?a:s),t(n,!i),se(n.traits,a)},cn.prototype.getEffectiveDescriptor=function(e){var t=rn(e),i=new ln(t);this.mapTypes(t,(function(e,t){i.addTrait(e,t)}));var n=i.build();return this.definePackage(n,n.allTypes[n.allTypes.length-1].$pkg),n},cn.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})},un.prototype.set=function(e,t,i){var n=this.model.getPropertyDescriptor(e,t),o=n&&n.name;void 0===i?n?delete e[o]:delete e.$attrs[t]:n?o in e?e[o]=i:hn(e,n,i):e.$attrs[t]=i},un.prototype.get=function(e,t){var i=this.model.getPropertyDescriptor(e,t);if(!i)return e.$attrs[t];var n=i.name;return!e[n]&&i.isMany&&hn(e,i,[]),e[n]},un.prototype.define=function(e,t,i){if(!i.writable){var n=i.value;delete(i=Se({},i,{get:function(){return n}})).value}Object.defineProperty(e,t,i)},un.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},un.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})},pn.prototype.create=function(e,t){var i=this.getType(e);if(!i)throw new Error("unknown type <"+e+">");return new i(t)},pn.prototype.getType=function(e){var t=this.typeCache,i=ie(e)?e:e.ns.name,n=t[i];return n||(e=this.registry.getEffectiveDescriptor(i),n=t[i]=this.factory.createType(e)),n},pn.prototype.createAny=function(e,t,i){var n=rn(e),o={$type:e,$instanceOf:function(e){return e===this.$type}},a={name:e,isGeneric:!0,ns:{prefix:n.prefix,localName:n.localName,uri:t}};return this.properties.defineDescriptor(o,a),this.properties.defineModel(o,this),this.properties.define(o,"$parent",{enumerable:!1,writable:!0}),this.properties.define(o,"$instanceOf",{enumerable:!1,writable:!0}),se(i,(function(e,t){J(e)&&void 0!==e.value?o[e.name]=e.value:o[t]=e})),o},pn.prototype.getPackage=function(e){return this.registry.getPackage(e)},pn.prototype.getPackages=function(){return this.registry.getPackages()},pn.prototype.getElementDescriptor=function(e){return e.$descriptor},pn.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},pn.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},pn.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var mn=String.fromCharCode,fn=Object.prototype.hasOwnProperty,gn=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,vn={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function bn(e,t,i,n){return n?fn.call(vn,n)?vn[n]:"&"+n+";":mn(t||parseInt(i,16))}function yn(e){return e.length>3&&-1!==e.indexOf("&")?e.replace(gn,bn):e}Object.keys(vn).forEach((function(e){vn[e.toUpperCase()]=vn[e]}));var wn="xsi:type",xn="non-whitespace outside of root node";function $n(e){return new Error(e)}function _n(e){return"missing namespace for prefix <"+e+">"}function Cn(e){return{get:e,enumerable:!0}}function En(e){var t,i={};for(t in e)i[t]=e[t];return i}function Sn(e){return e+"$uri"}function kn(){return{line:0,column:0}}function An(e){throw e}function Rn(e){if(!this)return new Rn(e);var t,i,n,o,a,s,r,l,c,d=e&&e.proxy,u=An,h=kn,p=!1,m=!1,f=null,g=!1;function v(e){e instanceof Error||(e=$n(e)),f=e,u(e,h)}function b(e){a&&(e instanceof Error||(e=$n(e)),a(e,h))}this.on=function(e,c){if("function"!=typeof c)throw $n("required args <name, cb>");switch(e){case"openTag":i=c;break;case"text":t=c;break;case"closeTag":n=c;break;case"error":u=c;break;case"warn":a=c;break;case"cdata":o=c;break;case"attention":l=c;break;case"question":r=c;break;case"comment":s=c;break;default:throw $n("unsupported event: "+e)}return this},this.ns=function(e){if(void 0===e&&(e={}),"object"!=typeof e)throw $n("required args <nsMap={}>");var t,i={};for(t in e)i[t]=e[t];return i["http://www.w3.org/2001/XMLSchema-instance"]="xsi",m=!0,c=i,this},this.parse=function(e){if("string"!=typeof e)throw $n("required args <xml=string>");return f=null,function(e){var a,u,f,y,w,x,$,_,C,E,S,k=m?[]:null,A=m?function(e){var t,i,n={};for(t in e)n[i=e[t]]=i,n[Sn(i)]=t;return n}(c):null,R=[],D=0,P=!1,L=!1,F=0,V=0,B="",I=0;function T(){if(null!==S)return S;var e,t,i,n,o,a,s,r,l,d,u,h=m&&A.xmlns,f=m&&p?[]:null,g=I,v=B,y=v.length,w={},x={};e:for(;g<y;g++)if(l=!1,!(32===(d=v.charCodeAt(g))||d<14&&d>8)){for((d<65||d>122||d>90&&d<97)&&95!==d&&58!==d&&(b("illegal first char attribute name"),l=!0),u=g+1;u<y;u++)if(!((d=v.charCodeAt(u))>96&&d<123||d>64&&d<91||d>47&&d<59||46===d||45===d||95===d)){if(32===d||d<14&&d>8){b("missing attribute value"),g=u;continue e}if(61===d)break;b("illegal attribute name char"),l=!0}if("xmlns:xmlns"===(r=v.substring(g,u))&&(b("illegal declaration of xmlns"),l=!0),34===(d=v.charCodeAt(u+1)))-1===(u=v.indexOf('"',g=u+2))&&-1!==(u=v.indexOf("'",g))&&(b("attribute value quote missmatch"),l=!0);else if(39===d)-1===(u=v.indexOf("'",g=u+2))&&-1!==(u=v.indexOf('"',g))&&(b("attribute value quote missmatch"),l=!0);else for(b("missing attribute value quotes"),l=!0,u+=1;u<y&&!(32===(d=v.charCodeAt(u+1))||d<14&&d>8);u++);for(-1===u&&(b("missing closing quotes"),u=y,l=!0),l||(a=v.substring(g,u)),g=u;u+1<y&&!(32===(d=v.charCodeAt(u+1))||d<14&&d>8);u++)g===u&&(b("illegal character after attribute end"),l=!0);if(g=u+1,!l)if(r in x)b("attribute <"+r+"> already defined");else if(x[r]=!0,m)if(p){if(null!==(o="xmlns"===r?"xmlns":120===r.charCodeAt(0)&&"xmlns:"===r.substr(0,6)?r.substr(6):null)){if(e=yn(a),t=Sn(o),!(s=c[e])){if("xmlns"===o||t in A&&A[t]!==e)do{s="ns"+D++}while(void 0!==A[s]);else s=o;c[e]=s}A[o]!==s&&(n||(A=En(A),n=!0),A[o]=s,"xmlns"===o&&(A[Sn(s)]=e,h=s),A[t]=e),w[r]=a;continue}f.push(r,a)}else-1!==(d=r.indexOf(":"))?(i=A[r.substring(0,d)])?((r=h===i?r.substr(d+1):i+r.substr(d))===wn&&(-1!==(d=a.indexOf(":"))?(i=a.substring(0,d),a=(i=A[i]||i)+a.substring(d)):a=h+":"+a),w[r]=a):b(_n(r.substring(0,d))):w[r]=a;else w[r]=a}if(p)for(g=0,y=f.length;g<y;g++){if(r=f[g++],a=f[g],-1!==(d=r.indexOf(":"))){if(!(i=A[r.substring(0,d)])){b(_n(r.substring(0,d)));continue}(r=h===i?r.substr(d+1):i+r.substr(d))===wn&&(-1!==(d=a.indexOf(":"))?(i=a.substring(0,d),a=(i=A[i]||i)+a.substring(d)):a=h+":"+a)}w[r]=a}return S=w}for(h=function(){for(var t,i,n=/(\r\n|\r|\n)/g,o=0,a=0,s=0,r=V;F>=s&&(t=n.exec(e))&&!((r=t[0].length+t.index)>F);)o+=1,s=r;return-1==F?(a=r,i=e.substring(V)):0===V?i=e.substring(V,F):(a=F-s,i=-1==V?e.substring(F):e.substring(F,V+1)),{data:i,line:o,column:a}},d&&(E=Object.create({},{name:Cn((function(){return _})),originalName:Cn((function(){return C})),attrs:Cn(T),ns:Cn((function(){return A}))}));-1!==V;){if(-1===(F=60===e.charCodeAt(V)?V:e.indexOf("<",V)))return R.length?v("unexpected end of file"):0===V?v("missing start tag"):void(V<e.length&&e.substring(V).trim()&&b(xn));if(V!==F)if(R.length){if(t&&(t(e.substring(V,F),yn,h),g))return}else if(e.substring(V,F).trim()&&(b(xn),g))return;if(33===(w=e.charCodeAt(F+1))){if(91===(y=e.charCodeAt(F+2))&&"CDATA["===e.substr(F+3,6)){if(-1===(V=e.indexOf("]]>",F)))return v("unclosed cdata");if(o&&(o(e.substring(F+9,V),h),g))return;V+=3;continue}if(45===y&&45===e.charCodeAt(F+3)){if(-1===(V=e.indexOf("--\x3e",F)))return v("unclosed comment");if(s&&(s(e.substring(F+4,V),yn,h),g))return;V+=3;continue}}if(63!==w){for(u=F+1;;u++){if(x=e.charCodeAt(u),isNaN(x))return V=-1,v("unclosed tag");if(34===x)u=-1!==(y=e.indexOf('"',u+1))?y:u;else if(39===x)u=-1!==(y=e.indexOf("'",u+1))?y:u;else if(62===x){V=u;break}}if(33!==w){if(S={},47===w){if(P=!1,L=!0,!R.length)return v("missing open tag");if(u=_=R.pop(),y=F+2+u.length,e.substring(F+2,y)!==u)return v("closing tag mismatch");for(;y<V;y++)if(!(32===(w=e.charCodeAt(y))||w>8&&w<14))return v("close tag")}else{if(47===e.charCodeAt(V-1)?(u=_=e.substring(F+1,V-1),P=!0,L=!0):(u=_=e.substring(F+1,V),P=!0,L=!1),!(w>96&&w<123||w>64&&w<91||95===w||58===w))return v("illegal first char nodeName");for(y=1,f=u.length;y<f;y++)if(!((w=u.charCodeAt(y))>96&&w<123||w>64&&w<91||w>47&&w<59||45===w||95===w||46==w)){if(32===w||w<14&&w>8){_=u.substring(0,y),S=null;break}return v("invalid nodeName")}L||R.push(_)}if(m){if(a=A,P&&(L||k.push(a),null===S&&(p=-1!==u.indexOf("xmlns",y))&&(I=y,B=u,T(),p=!1)),C=_,-1!==(w=_.indexOf(":"))){if(!($=A[_.substring(0,w)]))return v("missing namespace on <"+C+">");_=_.substr(w+1)}else $=A.xmlns;$&&(_=$+":"+_)}if(P&&(I=y,B=u,i&&(d?i(E,yn,L,h):i(_,T,yn,L,h),g)))return;if(L){if(n&&(n(d?E:_,yn,P,h),g))return;m&&(A=P?a:k.pop())}V+=1}else{if(l&&(l(e.substring(F,V+1),yn,h),g))return;V+=1}}else{if(-1===(V=e.indexOf("?>",F)))return v("unclosed question");if(r&&(r(e.substring(F,V+2),h),g))return;V+=2}}}(e),h=kn,g=!1,f},this.stop=function(){g=!0}}function Dn(e){return e.xml&&"lowerCase"===e.xml.tagAlias}var Pn={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},Ln="xsi:type";function Fn(e){return e.xml&&e.xml.serialize}function Vn(e){return Fn(e)===Ln}function Bn(e,t){return Dn(t)?e.prefix+":"+((i=e.localName).charAt(0).toUpperCase()+i.slice(1)):e.name;var i}function In(e){return new Error(e)}function Tn(e){return e.$descriptor}function jn(e){Se(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw In("expected element");var t,i=this.elementsById,n=Tn(e).idProperty;if(n&&(t=e.get(n.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(t))throw new Error("illegal ID <"+t+">");if(i[t])throw In("duplicate ID <"+t+">");i[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function On(){}function Mn(){}function Nn(){}function Wn(e,t){this.property=e,this.context=t}function zn(e,t){this.element=t,this.propertyDesc=e}function Un(){}function Hn(e,t,i){this.model=e,this.type=e.getType(t),this.context=i}function qn(e,t,i){Hn.call(this,e,t,i)}function Gn(e,t,i){this.model=e,this.context=i}function Yn(e){e instanceof pn&&(e={model:e}),Se(this,{lax:!1},e)}On.prototype.handleEnd=function(){},On.prototype.handleText=function(){},On.prototype.handleNode=function(){},Mn.prototype=Object.create(On.prototype),Mn.prototype.handleNode=function(){return this},Nn.prototype=Object.create(On.prototype),Nn.prototype.handleText=function(e){this.body=(this.body||"")+e},Wn.prototype=Object.create(Nn.prototype),Wn.prototype.handleNode=function(e){if(this.element)throw In("expected no sub nodes");return this.element=this.createReference(e),this},Wn.prototype.handleEnd=function(){this.element.id=this.body},Wn.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},zn.prototype=Object.create(Nn.prototype),zn.prototype.handleEnd=function(){var e=this.body||"",t=this.element,i=this.propertyDesc;e=on(i.type,e),i.isMany?t.get(i.name).push(e):t.set(i.name,e)},Un.prototype=Object.create(Nn.prototype),Un.prototype.handleNode=function(e){var t=this,i=this.element;return i?t=this.handleChild(e):(i=this.element=this.createElement(e),this.context.addElement(i)),t},Hn.prototype=Object.create(Un.prototype),Hn.prototype.addReference=function(e){this.context.addReference(e)},Hn.prototype.handleText=function(e){if(!Tn(this.element).bodyProperty)throw In("unexpected body text <"+e+">");Nn.prototype.handleText.call(this,e)},Hn.prototype.handleEnd=function(){var e=this.body,t=this.element,i=Tn(t).bodyProperty;i&&void 0!==e&&(e=on(i.type,e),t.set(i.name,e))},Hn.prototype.createElement=function(e){var t,i=e.attributes,n=this.type,o=Tn(n),a=this.context,s=new n({}),r=this.model;return se(i,(function(e,i){var n=o.propertiesByName[i];n&&n.isReference?n.isMany?se(e.split(" "),(function(e){a.addReference({element:s,property:n.ns.name,id:e})})):a.addReference({element:s,property:n.ns.name,id:e}):(n?e=on(n.type,e):"xmlns"!==i&&(t=rn(i,o.ns.prefix),r.getPackage(t.prefix)&&a.addWarning({message:"unknown attribute <"+i+">",element:s,property:i,value:e})),s.set(i,e))})),s},Hn.prototype.getPropertyForNode=function(e){var t,i,n=rn(e.name),o=this.type,a=this.model,s=Tn(o),r=n.name,l=s.propertiesByName[r];if(l&&!l.isAttr)return Vn(l)&&(t=e.attributes["xsi:type"])?(t=function(e,t){var i=rn(e);return function(e,t){var i=e.name,n=e.localName,o=t.xml&&t.xml.typePrefix;return o&&0===n.indexOf(o)?e.prefix+":"+n.slice(o.length):i}(i,t.getPackage(i.prefix))}(t,a),Se({},l,{effectiveType:Tn(i=a.getType(t)).name})):l;var c=a.getPackage(n.prefix);if(c){if(t=Bn(n,c),i=a.getType(t),l=oe(s.properties,(function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&i.hasType(e.type)})))return Se({},l,{effectiveType:Tn(i).name})}else if(l=oe(s.properties,(function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type})))return l;throw In("unrecognized element <"+n.name+">")},Hn.prototype.toString=function(){return"ElementDescriptor["+Tn(this.type).name+"]"},Hn.prototype.valueHandler=function(e,t){return new zn(e,t)},Hn.prototype.referenceHandler=function(e){return new Wn(e,this.context)},Hn.prototype.handler=function(e){return"Element"===e?new Gn(this.model,e,this.context):new Hn(this.model,e,this.context)},Hn.prototype.handleChild=function(e){var t,i,n,o;if(t=this.getPropertyForNode(e),n=this.element,sn(i=t.effectiveType||t.type))return this.valueHandler(t,n);var a=(o=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(i).handleNode(e)).element;return void 0!==a&&(t.isMany?n.get(t.name).push(a):n.set(t.name,a),t.isReference?(Se(a,{element:n}),this.context.addReference(a)):a.$parent=n),o},qn.prototype=Object.create(Hn.prototype),qn.prototype.createElement=function(e){var t=e.name,i=rn(t),n=this.model,o=this.type,a=n.getPackage(i.prefix),s=a&&Bn(i,a)||t;if(!o.hasType(s))throw In("unexpected element <"+e.originalName+">");return Hn.prototype.createElement.call(this,e)},Gn.prototype=Object.create(Un.prototype),Gn.prototype.createElement=function(e){var t=e.name,i=rn(t).prefix,n=e.ns[i+"$uri"],o=e.attributes;return this.model.createAny(t,n,o)},Gn.prototype.handleChild=function(e){var t=new Gn(this.model,"Element",this.context).handleNode(e),i=this.element,n=t.element;return void 0!==n&&((i.$children=i.$children||[]).push(n),n.$parent=i),t},Gn.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Yn.prototype.fromXML=function(e,t,i){var n=t.rootHandler;t instanceof Hn?(n=t,t={}):"string"==typeof t?(n=this.handler(t),t={}):"string"==typeof n&&(n=this.handler(n));var o=this.model,a=this.lax,s=new jn(Se({},t,{rootHandler:n})),r=new Rn({proxy:!0}),l=function(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}();function c(e,t,i){var n=t(),o=n.line,a=n.column,r=n.data;"<"===r.charAt(0)&&-1!==r.indexOf(" ")&&(r=r.slice(0,r.indexOf(" "))+">");var l="unparsable content "+(r?r+" ":"")+"detected\n\tline: "+o+"\n\tcolumn: "+a+"\n\tnested error: "+e.message;if(i)return s.addWarning({message:l,error:e}),!0;throw In(l)}function d(e,t){return c(e,t,!0)}n.context=s,l.push(n);var u=/^<\?xml /i,h=/ encoding="([^"]+)"/i,p=/^utf-8$/i;function m(e,t){try{l.peek().handleText(e)}catch(e){d(e,t)}}var f=o.getPackages().reduce((function(e,t){return e[t.uri]=t.prefix,e}),{"http://www.w3.org/XML/1998/namespace":"xml"});return r.ns(f).on("openTag",(function(e,t,i,n){var o=e.attrs||{},s=Object.keys(o).reduce((function(e,i){var n=t(o[i]);return e[i]=n,e}),{});!function(e,t){var i=l.peek();try{l.push(i.handleNode(e))}catch(e){c(e,t,a)&&l.push(new Mn)}}({name:e.name,originalName:e.originalName,attributes:s,ns:e.ns},n)})).on("question",(function(e){if(u.test(e)){var t=h.exec(e),i=t&&t[1];i&&!p.test(i)&&s.addWarning({message:"unsupported document encoding <"+i+">, falling back to UTF-8"})}})).on("closeTag",(function(){l.pop().handleEnd()})).on("cdata",m).on("text",(function(e,t,i){!function(e,t){e.trim()&&m(e,t)}(t(e),i)})).on("error",c).on("warn",d),new Promise((function(t,i){var o;try{r.parse(e),function(){var e,t,i=s.elementsById,n=s.references;for(e=0;t=n[e];e++){var o=t.element,a=i[t.id],r=Tn(o).propertiesByName[t.property];if(a||s.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),r.isMany){var l=o.get(r.name),c=l.indexOf(t);-1===c&&(c=l.length),a?l[c]=a:l.splice(c,1)}else o.set(r.name,a)}}()}catch(e){o=e}var a=n.element;o||a||(o=In("failed to parse document as <"+n.type.$descriptor.name+">"));var l=s.warnings,c=s.references,d=s.elementsById;return o?(o.warnings=l,i(o)):t({rootElement:a,elementsById:d,references:c,warnings:l})}))},Yn.prototype.handler=function(e){return new qn(this.model,e)};var Zn=/<|>|'|"|&|\n\r|\n/g,Kn=/<|>|&/g;function Xn(e){var t={},i={},n={},o=[],a=[];this.byUri=function(t){return i[t]||e&&e.byUri(t)},this.add=function(e,t){i[e.uri]=e,t?o.push(e):a.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,i){t[e||"xmlns"]=i},this.getNSKey=function(e){return void 0!==e.prefix?e.uri+"|"+e.prefix:e.uri},this.logUsed=function(t){var i=t.uri,o=this.getNSKey(t);n[o]=this.byUri(i),e&&e.logUsed(t)},this.getUsed=function(e){var t=this;return[].concat(o,a).filter((function(e){var i=t.getNSKey(e);return n[i]}))}}function Qn(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Jn(e){return ie(e)?e:(e.prefix?e.prefix+":":"")+e.localName}var eo={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},to={"<":"lt",">":"gt","&":"amp"};function io(e,t,i){return(e=ie(e)?e:""+e).replace(t,(function(e){return"&"+i[e]+";"}))}function no(e){this.tagName=e}function oo(){}function ao(e){this.tagName=e}function so(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function ro(e,t){so.call(this,e,t)}function lo(){this.value="",this.write=function(e){this.value+=e}}function co(e,t){var i=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(i.join("  ")),this},this.indent=function(){return i.push(""),this},this.unindent=function(){return i.pop(),this}}function uo(e){return e=Se({format:!1,preamble:!0},e||{}),{toXML:function(t,i){var n=i||new lo,o=new co(n,e.format);if(e.preamble&&o.append('<?xml version="1.0" encoding="UTF-8"?>\n'),(new so).build(t).serializeTo(o),!i)return n.value}}}function ho(e,t){pn.call(this,e,t)}no.prototype.build=function(e){return this.element=e,this},no.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},oo.prototype.serializeValue=oo.prototype.serializeTo=function(e){e.append(this.escape?io(this.value,Kn,to):this.value)},oo.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(Kn)&&(this.escape=!0),this},Qn(ao,oo),ao.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},so.prototype.build=function(e){this.element=e;var t,i,n=e.$descriptor,o=this.propertyDescriptor,a=n.isGeneric;return t=a?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=o?this.nsPropertyTagName(o):this.nsTagName(n),this.tagName=this.addTagName(this.ns),a||(i=function(e){return ae(e.$descriptor.properties,(function(t){var i=t.name;if(t.isVirtual)return!1;if(!ne(e,i))return!1;var n=e[i];return n!==t.default&&null!==n&&(!t.isMany||n.length)}))}(e),this.parseAttributes(ae(i,(function(e){return e.isAttr}))),this.parseContainments(ae(i,(function(e){return!e.isAttr})))),this.parseGenericAttributes(e,t),this},so.prototype.nsTagName=function(e){return function(e,t){return t.isGeneric?Se({localName:t.ns.localName},e):Se({localName:(i=t.ns.localName,n=t.$pkg,Dn(n)?(o=i).charAt(0).toLowerCase()+o.slice(1):i)},e);var i,n,o}(this.logNamespaceUsed(e.ns),e)},so.prototype.nsPropertyTagName=function(e){return function(e,t){return Se({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},so.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},so.prototype.nsAttributeName=function(e){var t;if(t=ie(e)?rn(e):e.ns,e.inherited)return{localName:t.localName};var i=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(i),this.isLocalNs(i)?{localName:t.localName}:Se({localName:t.localName},i)},so.prototype.parseGeneric=function(e){var t=this,i=this.body,n=[];return se(e,(function(o,a){"$body"===a?i.push((new oo).build({type:"String"},o)):"$children"===a?se(o,(function(e){i.push(new so(t).build(e))})):0!==a.indexOf("$")&&t.parseNsAttribute(e,a,o)&&n.push({name:a,value:o})})),n},so.prototype.parseNsAttribute=function(e,t,i){var n,o=e.$model,a=rn(t);if("xmlns"===a.prefix&&(n={prefix:a.localName,uri:i}),a.prefix||"xmlns"!==a.localName||(n={uri:i}),!n)return{name:t,value:i};if(o&&o.getPackage(i))this.logNamespace(n,!0,!0);else{var s=this.logNamespaceUsed(n,!0);this.getNamespaces().logUsed(s)}},so.prototype.parseNsAttributes=function(e,t){var i=this,n=e.$attrs,o=[];return se(n,(function(t,n){var a=i.parseNsAttribute(e,n,t);a&&o.push(a)})),o},so.prototype.parseGenericAttributes=function(e,t){var i=this;se(t,(function(t){if(t.name!==Ln)try{i.addAttribute(i.nsAttributeName(t.name),t.value)}catch(i){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,i)}}))},so.prototype.parseContainments=function(e){var t=this,i=this.body,n=this.element;se(e,(function(e){var o=n.get(e.name),a=e.isReference;if(e.isMany||(o=[o]),e.isBody)i.push((new oo).build(e,o[0]));else if(sn(e.type))se(o,(function(n){i.push(new ao(t.addTagName(t.nsPropertyTagName(e))).build(e,n))}));else if(a)se(o,(function(n){i.push(new no(t.addTagName(t.nsPropertyTagName(e))).build(n))}));else{var s=Vn(e),r=function(e){return"property"===Fn(e)}(e);se(o,(function(n){var o;o=s?new ro(t,e):r?new so(t,e):new so(t),i.push(o.build(n))}))}}))},so.prototype.getNamespaces=function(e){var t,i=this.namespaces,n=this.parent;return i||(t=n&&n.getNamespaces(),e||!t?this.namespaces=i=new Xn(t):i=t),i},so.prototype.logNamespace=function(e,t,i){var n=this.getNamespaces(i),o=e.uri,a=e.prefix;return n.byUri(o)&&!i||n.add(e,t),n.mapPrefix(a,o),e},so.prototype.logNamespaceUsed=function(e,t){var i,n,o,a=this.element.$model,s=this.getNamespaces(t),r=e.prefix,l=e.uri;if(!r&&!l)return{localName:e.localName};if(o=Pn[r]||a&&(a.getPackage(r)||{}).uri,!(l=l||o||s.uriByPrefix(r)))throw new Error("no namespace uri given for prefix <"+r+">");if(!(e=s.byUri(l))){for(i=r,n=1;s.uriByPrefix(i);)i=r+"_"+n++;e=this.logNamespace({prefix:i,uri:l},o===l)}return r&&s.mapPrefix(r,l),e},so.prototype.parseAttributes=function(e){var t=this,i=this.element;se(e,(function(e){var n=i.get(e.name);if(e.isReference)if(e.isMany){var o=[];se(n,(function(e){o.push(e.id)})),n=o.join(" ")}else n=n.id;t.addAttribute(t.nsAttributeName(e),n)}))},so.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),Jn(e)},so.prototype.addAttribute=function(e,t){var i=this.attrs;ie(t)&&(t=io(t,Zn,eo)),i.push({name:e,value:t})},so.prototype.serializeAttributes=function(e){var t=this.attrs,i=this.namespaces;i&&(t=function(e){return e.getUsed().filter((function(e){return"xml"!==e.prefix})).map((function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}}))}(i).concat(t)),se(t,(function(t){e.append(" ").append(Jn(t.name)).append('="').append(t.value).append('"')}))},so.prototype.serializeTo=function(e){var t=this.body[0],i=t&&t.constructor!==oo;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(i&&e.appendNewLine().indent(),se(this.body,(function(t){t.serializeTo(e)})),i&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},Qn(ro,so),ro.prototype.parseNsAttributes=function(e){var t=so.prototype.parseNsAttributes.call(this,e),i=e.$descriptor;if(i.name===this.propertyDescriptor.type)return t;var n=this.typeNs=this.nsTagName(i);this.getNamespaces().logUsed(this.typeNs);var o=e.$model.getPackage(n.uri),a=o.xml&&o.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Ln),(n.prefix?n.prefix+":":"")+a+i.ns.localName),t},ro.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri},ho.prototype=Object.create(pn.prototype),ho.prototype.fromXML=function(e,t,i){ie(t)||(i=t,t="bpmn:Definitions");var n=new Yn(Se({model:this,lax:!0},i)),o=n.handler(t);return n.fromXML(e,o)},ho.prototype.toXML=function(e,t){var i=new uo(t);return new Promise((function(t,n){try{return t({xml:i.toXML(e)})}catch(e){return n(e)}}))};var po={bpmn:{name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",prefix:"bpmn",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],enumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],xml:{tagAlias:"lowerCase",typePrefix:"t"}},bpmndi:{name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",prefix:"bpmndi",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],enumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[]},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",prefix:"dc",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],associations:[]},di:{name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",prefix:"di",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],associations:[],xml:{tagAlias:"lowerCase"}},bioc:{name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]},color:{name:"BPMN in Color",uri:"http://www.omg.org/spec/BPMN/non-normative/color/1.0",prefix:"color",types:[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]}};const mo=function(e,t){return new ho(Se({},po,e),t)};function fo(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}function go(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(!(t>=1&&te(arguments[t-1])))return e.apply(this,arguments);var i=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var n=Array.prototype.slice.call(arguments,0,-1);e.apply(this,n).then((function(e){var t=Object.keys(e)[0];return i(null,e[t])}),(function(e){return i(e,e.warnings)}))}}function vo(e){ne(e,"di")||Object.defineProperty(e,"di",{get:function(){throw new Error("Tried to access di from the businessObject. The di is available through the diagram element only. For more information, see https://github.com/bpmn-io/bpmn-js/issues/1472")}})}function bo(e,t){return e.$instanceOf(t)}function yo(e,t){var i={},n=[],o={};function a(e,t){return function(i){e(i,t)}}function s(e){i[e.id]=e}function r(i,n){try{var a=o[i.id]&&function(i,n){if(i.gfx)throw new Error(t("already rendered {element}",{element:fo(i)}));return e.element(i,o[i.id],n)}(i,n);return s(i),a}catch(e){l(e.message,{element:i,error:e}),console.error(t("failed to import {element}",{element:fo(i)})),console.error(e)}}function l(t,i){e.error(t,i)}function c(e){var i=e.bpmnElement;i?o[i.id]?l(t("multiple DI elements defined for {element}",{element:fo(i)}),{element:i}):(o[i.id]=e,vo(i)):l(t("no bpmnElement referenced in {element}",{element:fo(e)}),{element:e})}function d(e){c(e)}function u(){for(;n.length;)n.shift()()}function h(e,t){C(e,t),y(e.ioSpecification,t),b(e.artifacts,t),s(e)}function p(e,t){r(e,t)}function m(e,t){r(e,t)}function f(e,t){r(e,t)}function g(e,t){r(e,t)}function v(e,t){r(e,t)}function b(e,t){se(e,(function(e){bo(e,"bpmn:Association")?n.push((function(){v(e,t)})):v(e,t)}))}function y(e,t){e&&(se(e.dataInputs,a(f,t)),se(e.dataOutputs,a(g,t)))}function w(e,t){C(e,t),b(e.artifacts,t)}function x(e,t){var i=r(e,t);bo(e,"bpmn:SubProcess")&&w(e,i||t),bo(e,"bpmn:Activity")&&y(e.ioSpecification,t),n.push((function(){se(e.dataInputAssociations,a(m,t)),se(e.dataOutputAssociations,a(m,t))}))}function $(e,t){n.push((function(){var i=r(e,t);e.childLaneSet&&_(e.childLaneSet,i||t),function(e){se(e.flowNodeRef,(function(t){var i=t.get("lanes");i&&i.push(e)}))}(e)}))}function _(e,t){se(e.lanes,a($,t))}function C(e,i){!function(e,i){se(e,(function(e){bo(e,"bpmn:SequenceFlow")?n.push((function(){!function(e,t){r(e,t)}(e,i)})):bo(e,"bpmn:BoundaryEvent")?n.unshift((function(){x(e,i)})):bo(e,"bpmn:FlowNode")?x(e,i):bo(e,"bpmn:DataObject")||(bo(e,"bpmn:DataStoreReference")||bo(e,"bpmn:DataObjectReference")?function(e,t){r(e,t)}(e,i):l(t("unrecognized flowElement {element} in context {context}",{element:fo(e),context:i?fo(i.businessObject):"null"}),{element:e,context:i}))}))}(e.flowElements,i),e.laneSets&&function(e,t){se(e,a(_,t))}(e.laneSets,i)}function E(e,t){var i=r(e,t),n=e.processRef;n&&h(n,i||t)}return{handleDeferred:u,handleDefinitions:function(s,r){var m=s.diagrams;if(r&&-1===m.indexOf(r))throw new Error(t("diagram not part of bpmn:Definitions"));if(!r&&m&&m.length&&(r=m[0]),!r)throw new Error(t("no diagram to display"));o={},function(e){var t;c(t=e.plane),se(t.planeElement,d)}(r);var f=r.plane;if(!f)throw new Error(t("no plane for {element}",{element:fo(r)}));var g=f.bpmnElement;if(!g){if(g=function(e){return oe(e.rootElements,(function(e){return bo(e,"bpmn:Process")||bo(e,"bpmn:Collaboration")}))}(s),!g)throw new Error(t("no process or collaboration to display"));l(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:fo(f),rootElement:fo(g)})),f.bpmnElement=g,c(f)}var v,y,w=function(t,i){return e.root(t,o[t.id],i)}(g,f);if(bo(g,"bpmn:Process")||bo(g,"bpmn:SubProcess"))h(g,w);else{if(!bo(g,"bpmn:Collaboration"))throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:fo(f),rootElement:fo(g)}));y=w,se((v=g).participants,a(E,y)),b(v.artifacts,y),n.push((function(){!function(e,t){se(e,a(p,t))}(v.messageFlows,y)})),function(e,t){ae(e,(function(e){return!i[e.id]&&bo(e,"bpmn:Process")&&e.laneSets})).forEach(a(h,t))}(s.rootElements,w)}u()},handleSubProcess:w,registerDi:c}}function wo(e,t){var i=$o(e);return i&&"function"==typeof i.$instanceOf&&i.$instanceOf(t)}function xo(e,t){return ce(t,(function(t){return wo(e,t)}))}function $o(e){return e&&e.businessObject||e}function _o(e){return e&&e.di}function Co(e,t,i){var n,o,a,s,r=[];function l(e,t){var i=new yo({root:function(e,t){return n.add(e,t)},element:function(e,t,i){return n.add(e,t,i)},error:function(e,t){r.push({message:e,context:t})}},a);t=t||e.diagrams&&e.diagrams[0];var o=function(e,t){if(t){var i,n=t.plane.bpmnElement,o=n;wo(n,"bpmn:Process")||wo(n,"bpmn:Collaboration")||(o=function(e){for(var t=e;t;){if(wo(t,"bpmn:Process"))return t;t=t.$parent}}(n)),i=wo(o,"bpmn:Collaboration")?o:oe(e.rootElements,(function(e){if(wo(e,"bpmn:Collaboration"))return oe(e.participants,(function(e){return e.processRef===o}))}));var a=[o];i&&(a=de(i.participants,(function(e){return e.processRef}))).push(i);var s=Eo(a),r=[t],l=[n];return se(e.diagrams,(function(e){var t=e.plane.bpmnElement;-1!==s.indexOf(t)&&-1===l.indexOf(t)&&(r.push(e),l.push(t))})),r}}(e,t);if(!o)throw new Error(a("no diagram to display"));se(o,(function(t){i.handleDefinitions(e,t)}));var l=t.plane.bpmnElement.id;s.setRootElement(s.findRoot(l+"_plane")||s.findRoot(l))}return new Promise((function(c,d){try{return n=e.get("bpmnImporter"),o=e.get("eventBus"),a=e.get("translate"),s=e.get("canvas"),o.fire("import.render.start",{definitions:t}),l(t,i),o.fire("import.render.complete",{error:void 0,warnings:r}),c({warnings:r})}catch(e){return e.warnings=r,d(e)}}))}function Eo(e){var t=[];return se(e,(function(e){e&&(t.push(e),t=t.concat(Eo(e.flowElements)))})),t}var So='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>';function ko(e){return e.join(";")}var Ao,Ro=ko(["color: #404040"]),Do='<div class="bjs-powered-by-lightbox" style="'+ko(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+ko(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"])+'"></div><div class="notice" style="'+ko(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"])+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+Ro+'">'+So+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';function Po(e){var t,i;e=Se({},Fo,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),t=this._container,i=Ze('<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+Ro+'">'+So+"</a>"),t.appendChild(i),He.bind(i,"click",(function(e){Ao||(Ao=Ze(Do),Ge(Ao,".backdrop","click",(function(e){document.body.removeChild(Ao)}))),document.body.appendChild(Ao),e.preventDefault()})),this._init(this._container,this._moddle,e)}function Lo(e,t){return e.warnings=t,e}W()(Po,Qi),Po.prototype.importXML=go((function(e,t){var i=this;return new Promise((function(n,o){e=i._emit("import.parse.start",{xml:e})||e,i._moddle.fromXML(e,"bpmn:Definitions").then((function(e){var a,s,r=e.rootElement,l=e.references,c=e.warnings,d=e.elementsById;r=i._emit("import.parse.complete",(a={error:null,definitions:r,elementsById:d,references:l,warnings:c},s=i.get("eventBus").createEvent(a),Object.defineProperty(s,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:a.warnings,references:a.references,elementsById:a.elementsById}}}),s))||r,i.importDefinitions(r,t).then((function(e){var t=[].concat(c,e.warnings||[]);return i._emit("import.done",{error:null,warnings:t}),n({warnings:t})})).catch((function(e){var t=[].concat(c,e.warnings||[]);return i._emit("import.done",{error:e,warnings:t}),o(Lo(e,t))}))})).catch((function(e){return i._emit("import.parse.complete",{error:e}),e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+t[2]),e}(e),i._emit("import.done",{error:e,warnings:e.warnings}),o(e)}))}))})),Po.prototype.importDefinitions=go((function(e,t){var i=this;return new Promise((function(n,o){i._setDefinitions(e),i.open(t).then((function(e){var t=e.warnings;return n({warnings:t})})).catch((function(e){return o(e)}))}))})),Po.prototype.open=go((function(e){var t=this._definitions,i=e,n=this;return new Promise((function(o,a){if(!t){var s=new Error("no XML imported");return a(Lo(s,[]))}if("string"==typeof e&&(i=function(e,t){return t&&oe(e.diagrams,(function(e){return e.id===t}))||null}(t,e),!i)){var r=new Error("BPMNDiagram <"+e+"> not found");return a(Lo(r,[]))}try{n.clear()}catch(e){return a(Lo(e,[]))}Co(n,t,i).then((function(e){var t=e.warnings;return o({warnings:t})})).catch((function(e){return a(e)}))}))})),Po.prototype.saveXML=go((function(e){e=e||{};var t=this,i=this._definitions;return new Promise((function(n){if(!i)return n({error:new Error("no definitions loaded")});i=t._emit("saveXML.start",{definitions:i})||i,t._moddle.toXML(i,e).then((function(e){var i=e.xml;return i=t._emit("saveXML.serialized",{xml:i})||i,n({xml:i})}))})).catch((function(e){return{error:e}})).then((function(e){t._emit("saveXML.done",e);var i=e.error;return i?Promise.reject(i):e}))})),Po.prototype.saveSVG=go((function(e){e=e||{};var t=this;return new Promise((function(e,i){var n,o;t._emit("saveSVG.start");try{var a=t.get("canvas"),s=a.getActiveLayer(),r=Qe("defs",a._svg),l=kt(s),c=r?"<defs>"+kt(r)+"</defs>":"",d=s.getBBox();n='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+d.width+'" height="'+d.height+'" viewBox="'+d.x+" "+d.y+" "+d.width+" "+d.height+'" version="1.1">'+c+l+"</svg>"}catch(e){o=e}return t._emit("saveSVG.done",{error:o,svg:n}),o?i(o):e({svg:n})}))})),Po.prototype._setDefinitions=function(e){this._definitions=e},Po.prototype.getModules=function(){return this._modules},Po.prototype.clear=function(){this.getDefinitions()&&Qi.prototype.clear.call(this)},Po.prototype.destroy=function(){Qi.prototype.destroy.call(this),et(this._container)},Po.prototype.on=function(e,t,i,n){return this.get("eventBus").on(e,t,i,n)},Po.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Po.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=Qe(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},Po.prototype.getDefinitions=function(){return this._definitions},Po.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Po.prototype._init=function(e,t,i){var n=i.modules||this.getModules(),o=i.additionalModules||[],a=[].concat([{bpmnjs:["value",this],moddle:["value",t]}],n,o),s=Se(Ae(i,["additionalModules"]),{canvas:Se({},i.canvas,{container:e}),modules:a});Qi.call(this,s),i&&i.container&&this.attachTo(i.container)},Po.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Po.prototype._createContainer=function(e){var t=Ze('<div class="bjs-container"></div>');return Se(t.style,{width:Vo(e.width),height:Vo(e.height),position:e.position}),t},Po.prototype._createModdle=function(e){var t=Se({},this._moddleExtensions,e.moddleExtensions);return new mo(t)},Po.prototype._modules=[];var Fo={width:"100%",height:"100%",position:"relative"};function Vo(e){return e+(ee(e)?"px":"")}function Bo(e){Po.call(this,e),this.on("import.parse.complete",(function(e){e.error||this._collectIds(e.definitions,e.elementsById)}),this),this.on("diagram.destroy",(function(){this.get("moddle").ids.clear()}),this)}function Io(e,t){return!wo(e,"bpmn:CallActivity")&&(wo(e,"bpmn:SubProcess")?!(!(t=t||_o(e))||!wo(t,"bpmndi:BPMNPlane"))||t&&!!t.isExpanded:!wo(e,"bpmn:Participant")||!!$o(e).processRef)}function To(e){return e&&!!$o(e).triggeredByEvent}function jo(e,t){var i=$o(e),n=!1;return i.eventDefinitions&&se(i.eventDefinitions,(function(e){wo(e,t)&&(n=!0)})),n}function Oo(e){return wo(e,"bpmn:FlowElement")||wo(e,"bpmn:Participant")||wo(e,"bpmn:Lane")||wo(e,"bpmn:SequenceFlow")||wo(e,"bpmn:MessageFlow")||wo(e,"bpmn:DataInput")||wo(e,"bpmn:DataOutput")?"name":wo(e,"bpmn:TextAnnotation")?"text":wo(e,"bpmn:Group")?"categoryValueRef":void 0}function Mo(e){var t=e.businessObject,i=Oo(t);if(i)return"categoryValueRef"===i?function(e){var t=e.categoryValueRef;return t&&t.value||""}(t):t[i]||""}function No(e,t,i){return ce(e.eventDefinitions,(function(n){return n.$type===t&&function(e,t){return le(t,(function(t,i){return e[i]==t}))}(e,i)}))}function Wo(e){return e.businessObject}function zo(e,t){var i=_o(e);return i.get("color:background-color")||i.get("bioc:fill")||t||"white"}function Uo(e,t){var i=_o(e);return i.get("color:border-color")||i.get("bioc:stroke")||t||"black"}function Ho(e,t,i){var n=_o(e).get("label");return n&&n.get("color:color")||t||Uo(e,i)}function qo(e,t){var i=e.x,n=e.y,o=e.width,a=e.height;return zt([["M",i+t,n],["l",o-2*t,0],["a",t,t,0,0,1,t,t],["l",0,a-2*t],["a",t,t,0,0,1,-t,t],["l",2*t-o,0],["a",t,t,0,0,1,-t,-t],["l",0,2*t-a],["a",t,t,0,0,1,t,-t],["z"]])}W()(Bo,Po),Bo.prototype._createModdle=function(e){var t=Po.prototype._createModdle.call(this,e);return t.ids=new H([32,36,1]),t},Bo.prototype._collectIds=function(e,t){var i,n=e.$model.ids;for(i in n.clear(),t)n.claim(i,t[i])};var Go=new H,Yo=.95;function Zo(e,t,i,n,o,a,s){Wt.call(this,t,s);var r=e&&e.defaultFillColor,l=e&&e.defaultStrokeColor,c=e&&e.defaultLabelColor,d=Go.next(),u={},h=i.computeStyle;function p(e,t){var i=Se({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},t.attrs),n=t.ref||{x:0,y:0},a=t.scale||1;"none"===i.strokeDasharray&&(i.strokeDasharray=[1e4,1]);var s=bt("marker");at(t.element,i),it(s,t.element),at(s,{id:e,viewBox:"0 0 20 20",refX:n.x,refY:n.y,markerWidth:20*a,markerHeight:20*a,orient:"auto"});var r=Qe("defs",o._svg);r||(r=bt("defs"),it(o._svg,r)),it(r,s),u[e]=s}function m(e){return e.replace(/[^0-9a-zA-z]+/g,"_")}function f(e,t,i){var n=e+"-"+m(t)+"-"+m(i)+"-"+d;return u[n]||function(e,t,i,n){if("sequenceflow-end"===t){var o=bt("path");at(o,{d:"M 1 5 L 11 10 L 1 15 Z"}),p(e,{element:o,ref:{x:11,y:10},scale:.5,attrs:{fill:n,stroke:n}})}if("messageflow-start"===t){var a=bt("circle");at(a,{cx:6,cy:6,r:3.5}),p(e,{element:a,attrs:{fill:i,stroke:n},ref:{x:6,y:6}})}if("messageflow-end"===t){var s=bt("path");at(s,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),p(e,{element:s,attrs:{fill:i,stroke:n,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if("association-start"===t){var r=bt("path");at(r,{d:"M 11 5 L 1 10 L 11 15"}),p(e,{element:r,attrs:{fill:"none",stroke:n,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if("association-end"===t){var l=bt("path");at(l,{d:"M 1 5 L 11 10 L 1 15"}),p(e,{element:l,attrs:{fill:"none",stroke:n,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if("conditional-flow-marker"===t){var c=bt("path");at(c,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),p(e,{element:c,attrs:{fill:i,stroke:n},ref:{x:-1,y:10},scale:.5})}if("conditional-default-flow-marker"===t){var d=bt("path");at(d,{d:"M 6 4 L 10 16"}),p(e,{element:d,attrs:{stroke:n},ref:{x:0,y:10},scale:.5})}}(n,e,t,i),"url(#"+n+")"}function g(e,t,i,n,o){J(n)&&(o=n,n=0),n=n||0,"none"===(o=h(o,{stroke:"black",strokeWidth:2,fill:"white"})).fill&&delete o.fillOpacity;var a=t/2,s=i/2,r=bt("circle");return at(r,{cx:a,cy:s,r:Math.round((t+i)/4-n)}),at(r,o),it(e,r),r}function v(e,t,i,n,o,a){J(o)&&(a=o,o=0),o=o||0,a=h(a,{stroke:"black",strokeWidth:2,fill:"white"});var s=bt("rect");return at(s,{x:o,y:o,width:t-2*o,height:i-2*o,rx:n,ry:n}),at(s,a),it(e,s),s}function b(e,t,i){var n=Ht(t,i=h(i,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"}));return it(e,n),n}function y(e,t,i){i=h(i,["no-fill"],{strokeWidth:2,stroke:"black"});var n=bt("path");return at(n,{d:t}),at(n,i),it(e,n),n}function w(e,t,i,n){return y(t,i,Se({"data-marker":e},n))}function x(e){return A[e]}function $(e){return function(t,i){return x(e)(t,i)}}function _(e,t){var i=Wo(e),n=function(e){return"bpmn:IntermediateThrowEvent"===e.$type||"bpmn:EndEvent"===e.$type}(i);return i.eventDefinitions&&i.eventDefinitions.length>1?i.parallelMultiple?x("bpmn:ParallelMultipleEventDefinition")(t,e,n):x("bpmn:MultipleEventDefinition")(t,e,n):No(i,"bpmn:MessageEventDefinition")?x("bpmn:MessageEventDefinition")(t,e,n):No(i,"bpmn:TimerEventDefinition")?x("bpmn:TimerEventDefinition")(t,e,n):No(i,"bpmn:ConditionalEventDefinition")?x("bpmn:ConditionalEventDefinition")(t,e):No(i,"bpmn:SignalEventDefinition")?x("bpmn:SignalEventDefinition")(t,e,n):No(i,"bpmn:EscalationEventDefinition")?x("bpmn:EscalationEventDefinition")(t,e,n):No(i,"bpmn:LinkEventDefinition")?x("bpmn:LinkEventDefinition")(t,e,n):No(i,"bpmn:ErrorEventDefinition")?x("bpmn:ErrorEventDefinition")(t,e,n):No(i,"bpmn:CancelEventDefinition")?x("bpmn:CancelEventDefinition")(t,e,n):No(i,"bpmn:CompensateEventDefinition")?x("bpmn:CompensateEventDefinition")(t,e,n):No(i,"bpmn:TerminateEventDefinition")?x("bpmn:TerminateEventDefinition")(t,e,n):null}function C(e,t,i){i=Se({size:{width:100}},i);var n=a.createText(t||"",i);return dt(n).add("djs-label"),it(e,n),n}function E(e,t,i){return C(e,Wo(t).name,{box:t,align:i,padding:5,style:{fill:Ho(t,c,l)}})}function S(e,t,i){qi(C(e,t,{box:{height:30,width:i.height},align:"center-middle",style:{fill:Ho(i,c,l)}}),0,1*i.height,270)}function k(e){for(var t=e.waypoints,i="m  "+t[0].x+","+t[0].y,n=1;n<t.length;n++)i+="L"+t[n].x+","+t[n].y+" ";return i}var A=this.handlers={"bpmn:Event":function(e,t,i){return"fillOpacity"in i||(i.fillOpacity=Yo),g(e,t.width,t.height,i)},"bpmn:StartEvent":function(e,t){var i={fill:zo(t,r),stroke:Uo(t,l)};Wo(t).isInterrupting||(i={strokeDasharray:"6",strokeLinecap:"round",fill:zo(t,r),stroke:Uo(t,l)});var n=x("bpmn:Event")(e,t,i);return _(t,e),n},"bpmn:MessageEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:i?Uo(t,l):zo(t,r),stroke:i?zo(t,r):Uo(t,l)})},"bpmn:TimerEventDefinition":function(e,t){var i=g(e,t.width,t.height,.2*t.height,{strokeWidth:2,fill:zo(t,r),stroke:Uo(t,l)});y(e,n.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:Uo(t,l)});for(var o=0;o<12;o++){var a=n.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),s=t.width/2;y(e,a,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*o+","+t.height/2+","+s+")",stroke:Uo(t,l)})}return i},"bpmn:EscalationEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)})},"bpmn:ConditionalEventDefinition":function(e,t){return y(e,n.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:Uo(t,l)})},"bpmn:LinkEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)})},"bpmn:ErrorEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)})},"bpmn:CancelEventDefinition":function(e,t,i){var o=y(e,n.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.638,my:-.055}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)});return Yi(o,45),o},"bpmn:CompensateEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)})},"bpmn:SignalEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:i?Uo(t,l):"none",stroke:Uo(t,l)})},"bpmn:MultipleEventDefinition":function(e,t,i){return y(e,n.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:i?Uo(t,l):"none"})},"bpmn:ParallelMultipleEventDefinition":function(e,t){return y(e,n.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:t.width,containerHeight:t.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:Uo(t,l),stroke:Uo(t,l)})},"bpmn:EndEvent":function(e,t){var i=x("bpmn:Event")(e,t,{strokeWidth:4,fill:zo(t,r),stroke:Uo(t,l)});return _(t,e),i},"bpmn:TerminateEventDefinition":function(e,t){return g(e,t.width,t.height,8,{strokeWidth:4,fill:Uo(t,l),stroke:Uo(t,l)})},"bpmn:IntermediateEvent":function(e,t){var i=x("bpmn:Event")(e,t,{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)});return g(e,t.width,t.height,3,{strokeWidth:1,fill:zo(t,"none"),stroke:Uo(t,l)}),_(t,e),i},"bpmn:IntermediateCatchEvent":$("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":$("bpmn:IntermediateEvent"),"bpmn:Activity":function(e,t,i){return"fillOpacity"in(i=i||{})||(i.fillOpacity=Yo),v(e,t.width,t.height,10,i)},"bpmn:Task":function(e,t){var i={fill:zo(t,r),stroke:Uo(t,l)},n=x("bpmn:Activity")(e,t,i);return E(e,t,"center-middle"),R(e,t),n},"bpmn:ServiceTask":function(e,t){var i=x("bpmn:Task")(e,t);return y(e,n.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)}),y(e,n.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:zo(t,r)}),y(e,n.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)}),i},"bpmn:UserTask":function(e,t){var i=x("bpmn:Task")(e,t);return y(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:zo(t,r),stroke:Uo(t,l)}),y(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:zo(t,r),stroke:Uo(t,l)}),y(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:Uo(t,l),stroke:Uo(t,l)}),i},"bpmn:ManualTask":function(e,t){var i=x("bpmn:Task")(e,t);return y(e,n.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:zo(t,r),stroke:Uo(t,l)}),i},"bpmn:SendTask":function(e,t){var i=x("bpmn:Task")(e,t);return y(e,n.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:Uo(t,l),stroke:zo(t,r)}),i},"bpmn:ReceiveTask":function(e,t){var i,o=Wo(t),a=x("bpmn:Task")(e,t);return o.instantiate?(g(e,28,28,4.4,{strokeWidth:1}),i=n.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):i=n.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),y(e,i,{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)}),a},"bpmn:ScriptTask":function(e,t){var i=x("bpmn:Task")(e,t);return y(e,n.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:Uo(t,l)}),i},"bpmn:BusinessRuleTask":function(e,t){var i=x("bpmn:Task")(e,t);return at(y(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}})),{strokeWidth:1,fill:zo(t,"#aaaaaa"),stroke:Uo(t,l)}),at(y(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}})),{strokeWidth:1,stroke:Uo(t,l)}),i},"bpmn:SubProcess":function(e,t,i){i=Se({fill:zo(t,r),stroke:Uo(t,l)},i);var n=x("bpmn:Activity")(e,t,i),o=Io(t);return To(t)&&at(n,{strokeDasharray:"1,2"}),E(e,t,o?"center-top":"center-middle"),o?R(e,t):R(e,t,["SubProcessMarker"]),n},"bpmn:AdHocSubProcess":function(e,t){return x("bpmn:SubProcess")(e,t)},"bpmn:Transaction":function(e,t){var n=x("bpmn:SubProcess")(e,t),o=i.style(["no-fill","no-events"],{stroke:Uo(t,l)});return v(e,t.width,t.height,8,3,o),n},"bpmn:CallActivity":function(e,t){return x("bpmn:SubProcess")(e,t,{strokeWidth:5})},"bpmn:Participant":function(e,t){var i={fillOpacity:Yo,fill:zo(t,r),stroke:Uo(t,l)},n=x("bpmn:Lane")(e,t,i);return Io(t)?(b(e,[{x:30,y:0},{x:30,y:t.height}],{stroke:Uo(t,l)}),S(e,Wo(t).name,t)):C(e,Wo(t).name,{box:t,align:"center-middle",style:{fill:Ho(t,c,l)}}),!!Wo(t).participantMultiplicity&&x("ParticipantMultiplicityMarker")(e,t),n},"bpmn:Lane":function(e,t,i){var n=v(e,t.width,t.height,0,Se({fill:zo(t,r),fillOpacity:.35,stroke:Uo(t,l)},i)),o=Wo(t);return"bpmn:Lane"===o.$type&&S(e,o.name,t),n},"bpmn:InclusiveGateway":function(e,t){var i=x("bpmn:Gateway")(e,t);return g(e,t.width,t.height,.24*t.height,{strokeWidth:2.5,fill:zo(t,r),stroke:Uo(t,l)}),i},"bpmn:ExclusiveGateway":function(e,t){var i=x("bpmn:Gateway")(e,t),o=n.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return _o(t).isMarkerVisible&&y(e,o,{strokeWidth:1,fill:Uo(t,l),stroke:Uo(t,l)}),i},"bpmn:ComplexGateway":function(e,t){var i=x("bpmn:Gateway")(e,t);return y(e,n.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:Uo(t,l),stroke:Uo(t,l)}),i},"bpmn:ParallelGateway":function(e,t){var i=x("bpmn:Gateway")(e,t);return y(e,n.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:Uo(t,l),stroke:Uo(t,l)}),i},"bpmn:EventBasedGateway":function(e,t){var i=Wo(t),o=x("bpmn:Gateway")(e,t);g(e,t.width,t.height,.2*t.height,{strokeWidth:1,fill:"none",stroke:Uo(t,l)});var a=i.eventGatewayType,s=!!i.instantiate;if("Parallel"===a){var r=n.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}});at(y(e,r),{strokeWidth:1,fill:"none"})}else"Exclusive"===a&&(s||at(g(e,t.width,t.height,.26*t.height),{strokeWidth:1,fill:"none",stroke:Uo(t,l)}),function(){var i=n.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:t.width,containerHeight:t.height,position:{mx:.36,my:.44}}),o={strokeWidth:2,fill:zo(t,"none"),stroke:Uo(t,l)};y(e,i,o)}());return o},"bpmn:Gateway":function(e,t){var i={fill:zo(t,r),fillOpacity:Yo,stroke:Uo(t,l)};return function(e,t,i,n){var o=t/2,a=i/2,s=[{x:o,y:0},{x:t,y:a},{x:o,y:i},{x:0,y:a}].map((function(e){return e.x+","+e.y})).join(" ");n=h(n,{stroke:"black",strokeWidth:2,fill:"white"});var r=bt("polygon");return at(r,{points:s}),at(r,n),it(e,r),r}(e,t.width,t.height,i)},"bpmn:SequenceFlow":function(e,t){var i,n=k(t),o=zo(t,r),a=Uo(t,l),s=y(e,n,{strokeLinejoin:"round",markerEnd:f("sequenceflow-end",o,a),stroke:Uo(t,l)}),c=Wo(t);return t.source&&(i=t.source.businessObject,c.conditionExpression&&i.$instanceOf("bpmn:Activity")&&at(s,{markerStart:f("conditional-flow-marker",o,a)}),i.default&&(i.$instanceOf("bpmn:Gateway")||i.$instanceOf("bpmn:Activity"))&&i.default===c&&at(s,{markerStart:f("conditional-default-flow-marker",o,a)})),s},"bpmn:Association":function(e,t,i){var n=Wo(t),o=zo(t,r),a=Uo(t,l);return i=Se({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:Uo(t,l)},i||{}),"One"!==n.associationDirection&&"Both"!==n.associationDirection||(i.markerEnd=f("association-end",o,a)),"Both"===n.associationDirection&&(i.markerStart=f("association-start",o,a)),b(e,t.waypoints,i)},"bpmn:DataInputAssociation":function(e,t){var i=zo(t,r),n=Uo(t,l);return x("bpmn:Association")(e,t,{markerEnd:f("association-end",i,n)})},"bpmn:DataOutputAssociation":function(e,t){var i=zo(t,r),n=Uo(t,l);return x("bpmn:Association")(e,t,{markerEnd:f("association-end",i,n)})},"bpmn:MessageFlow":function(e,t){var i=Wo(t),o=_o(t),a=zo(t,r),s=Uo(t,l),d=y(e,k(t),{markerEnd:f("messageflow-end",a,s),markerStart:f("messageflow-start",a,s),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:Uo(t,l)});if(i.messageRef){var u=d.getPointAtLength(d.getTotalLength()/2),h=n.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:u.x,y:u.y}}),p={strokeWidth:1};"initiating"===o.messageVisibleKind?(p.fill="white",p.stroke="black"):(p.fill="#888",p.stroke="white");var m=y(e,h,p),g=C(e,i.messageRef.name,{align:"center-top",fitBox:!0,style:{fill:Uo(t,c)}}),v=m.getBBox(),b=g.getBBox();qi(g,u.x-b.width/2,u.y+v.height/2+10,0)}return d},"bpmn:DataObject":function(e,t){var i=y(e,n.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:zo(t,r),fillOpacity:Yo,stroke:Uo(t,l)});return function(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}(Wo(t))&&function(e,t){var i=(t.height-18)/t.height;y(e,n.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.33,my:i}}),{strokeWidth:2})}(e,t),i},"bpmn:DataObjectReference":$("bpmn:DataObject"),"bpmn:DataInput":function(e,t){var i=n.getRawPath("DATA_ARROW"),o=x("bpmn:DataObject")(e,t);return y(e,i,{strokeWidth:1}),o},"bpmn:DataOutput":function(e,t){var i=n.getRawPath("DATA_ARROW"),o=x("bpmn:DataObject")(e,t);return y(e,i,{strokeWidth:1,fill:"black"}),o},"bpmn:DataStoreReference":function(e,t){return y(e,n.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:zo(t,r),fillOpacity:Yo,stroke:Uo(t,l)})},"bpmn:BoundaryEvent":function(e,t){var i=Wo(t).cancelActivity,n={strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)};i||(n.strokeDasharray="6",n.strokeLinecap="round");var o=Se({},n,{fillOpacity:1}),a=Se({},n,{fill:"none"}),s=x("bpmn:Event")(e,t,o);return g(e,t.width,t.height,3,a),_(t,e),s},"bpmn:Group":function(e,t){return v(e,t.width,t.height,10,{stroke:Uo(t,l),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(e,t){return function(e,t){var i={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return C(e,Mo(t),{box:i,fitBox:!0,style:Se({},a.getExternalStyle(),{fill:Ho(t,c,l)})})}(e,t)},"bpmn:TextAnnotation":function(e,t){var i=v(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return y(e,n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}}),{stroke:Uo(t,l)}),C(e,Wo(t).text||"",{box:t,align:"left-top",padding:5,style:{fill:Ho(t,c,l)}}),i},ParticipantMultiplicityMarker:function(e,t){w("participant-multiplicity",e,n.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:t.width/2/t.width,my:(t.height-15)/t.height}}),{strokeWidth:2,fill:zo(t,r),stroke:Uo(t,l)})},SubProcessMarker:function(e,t){Gi(v(e,14,14,0,{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)}),t.width/2-7.5,t.height-20),w("sub-process",e,n.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7.5)/t.width,my:(t.height-20)/t.height}}),{fill:zo(t,r),stroke:Uo(t,l)})},ParallelMarker:function(e,t,i){w("parallel",e,n.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i.parallel)/t.width,my:(t.height-20)/t.height}}),{fill:zo(t,r),stroke:Uo(t,l)})},SequentialMarker:function(e,t,i){w("sequential",e,n.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i.seq)/t.width,my:(t.height-19)/t.height}}),{fill:zo(t,r),stroke:Uo(t,l)})},CompensationMarker:function(e,t,i){w("compensation",e,n.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i.compensation)/t.width,my:(t.height-13)/t.height}}),{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l)})},LoopMarker:function(e,t,i){w("loop",e,n.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i.loop)/t.width,my:(t.height-7)/t.height}}),{strokeWidth:1,fill:zo(t,r),stroke:Uo(t,l),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(e,t,i){w("adhoc",e,n.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i.adhoc)/t.width,my:(t.height-15)/t.height}}),{strokeWidth:1,fill:Uo(t,l),stroke:Uo(t,l)})}};function R(e,t,i){var n,o=Wo(t),a=i&&-1!==i.indexOf("SubProcessMarker");n=a?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},se(i,(function(i){x(i)(e,t,n)})),o.isForCompensation&&x("CompensationMarker")(e,t,n),"bpmn:AdHocSubProcess"===o.$type&&x("AdhocMarker")(e,t,n);var s=o.loopCharacteristics,r=s&&s.isSequential;s&&(void 0===r&&x("LoopMarker")(e,t,n),!1===r&&x("ParallelMarker")(e,t,n),!0===r&&x("SequentialMarker")(e,t,n))}this._drawPath=y,this._renderer=x}W()(Zo,Wt),Zo.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],Zo.prototype.canRender=function(e){return wo(e,"bpmn:BaseElement")},Zo.prototype.drawShape=function(e,t){var i=t.type;return this._renderer(i)(e,t)},Zo.prototype.drawConnection=function(e,t){var i=t.type;return this._renderer(i)(e,t)},Zo.prototype.getShapePath=function(e){return wo(e,"bpmn:Event")?zt([["M",(t=e).x+t.width/2,t.y+t.height/2],["m",0,-(i=t.width/2)],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]]):wo(e,"bpmn:Activity")?qo(e,10):wo(e,"bpmn:Gateway")?function(e){var t=e.width/2,i=e.height/2;return zt([["M",e.x+t,e.y],["l",t,i],["l",-t,i],["l",-t,-i],["z"]])}(e):function(e){var t=e.x,i=e.y,n=e.width;return zt([["M",t,i],["l",n,0],["l",0,e.height],["l",-n,0],["z"]])}(e);var t,i};var Ko={width:150,height:50};function Xo(e,t){var i;t.textContent=e;try{var n,o=""===e;return t.textContent=o?"dummy":e,n={width:(i=t.getBBox()).width+2*i.x,height:i.height},o&&(n.width=0),n}catch(e){return{width:0,height:0}}}function Qo(e,t,i){for(var n,o=e.shift(),a=o;;){if((n=Xo(a,i)).width=a?n.width:0," "===a||""===a||n.width<Math.round(t)||a.length<2)return Jo(e,a,o,n);a=ea(a,n.width,t)}}function Jo(e,t,i,n){if(t.length<i.length){var o=i.slice(t.length).trim();e.unshift(o)}return{width:n.width,height:n.height,text:t}}function ea(e,t,i){var n=Math.max(e.length*(i/t),1),o=function(e,t){var i,n=e.split(/(\s|-|\u00AD)/g),o=[],a=0;if(n.length>1)for(;i=n.shift();){if(!(i.length+a<t)){"-"!==i&&"­"!==i||o.pop();break}o.push(i),a+=i.length}var s=o[o.length-1];return s&&"­"===s&&(o[o.length-1]="-"),o.join("")}(e,n);return o||(o=e.slice(0,Math.max(Math.round(n-1),1))),o}function ta(e){this._config=Se({},{size:Ko,padding:0,style:{},align:"center-top"},e||{})}function ia(e){var t=Se({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),i=parseInt(t.fontSize,10)-1,n=Se({},t,{fontSize:i},e&&e.externalStyle||{}),o=new ta({style:t});this.getExternalLabelBounds=function(e,t){var i=o.getDimensions(t,{box:{width:90,height:30,x:e.width/2+e.x,y:e.height/2+e.y},style:n});return{x:Math.round(e.x+e.width/2-i.width/2),y:Math.round(e.y),width:Math.ceil(i.width),height:Math.ceil(i.height)}},this.getTextAnnotationBounds=function(e,i){var n=o.getDimensions(i,{box:e,style:t,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(n.height))}},this.createText=function(e,t){return o.createText(e,t||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return n}}ta.prototype.createText=function(e,t){return this.layoutText(e,t).element},ta.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},ta.prototype.layoutText=function(e,t){var i,n=Se({},this._config.size,t.box),o=Se({},this._config.style,t.style),a=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),s=function(e){return J(e)?Se({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),r=t.fitBox||!1,l=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(o),c=e.split(/\u00AD?\r?\n/),d=[],u=n.width-s.left-s.right,h=bt("text");for(at(h,{x:0,y:0}),at(h,o),it((i=void 0,(i=document.getElementById("helper-svg"))||(at(i=bt("svg"),{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(i)),i),h);c.length;)d.push(Qo(c,u,h));"middle"===a.vertical&&(s.top=s.bottom=0);var p=re(d,(function(e,t,i){return e+(l||t.height)}),0)+s.top+s.bottom,m=re(d,(function(e,t,i){return t.width>e?t.width:e}),0),f=s.top;"middle"===a.vertical&&(f+=(n.height-p)/2),f-=(l||d[0].height)/4;var g=bt("text");return at(g,o),se(d,(function(e){var t;switch(f+=l||e.height,a.horizontal){case"left":t=s.left;break;case"right":t=(r?m:u)-s.right-e.width;break;default:t=Math.max(((r?m:u)-e.width)/2+s.left,0)}var i=bt("tspan");at(i,{x:t,y:f}),i.textContent=e.text,it(g,i)})),ht(h),{dimensions:{width:m,height:p},element:g}},ia.$inject=["config.textRenderer"];var na=/\{([^{}]+)\}/g,oa=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;const aa={__init__:["bpmnRenderer"],bpmnRenderer:["type",Zo],textRenderer:["type",ia],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var i,n,o=this.pathMap[e];t.abspos?(i=t.abspos.x,n=t.abspos.y):(i=t.containerWidth*t.position.mx,n=t.containerHeight*t.position.my);var a,s,r={};if(t.position){for(var l=t.containerHeight/o.height*t.yScaleFactor,c=t.containerWidth/o.width*t.xScaleFactor,d=0;d<o.heightElements.length;d++)r["y"+d]=o.heightElements[d]*l;for(var u=0;u<o.widthElements.length;u++)r["x"+u]=o.widthElements[u]*c}return a=o.d,s={mx:i,my:n,e:r},String(a).replace(na,(function(e,t){return function(e,t,i){var n=i;return t.replace(oa,(function(e,t,i,o,a){t=t||o,n&&(t in n&&(n=n[t]),"function"==typeof n&&a&&(n=n()))})),n=(null==n||n==i?e:n)+""}(e,t,s)}))}}]},sa={translate:["value",function(e,t){return t=t||{},e.replace(/{([^}]+)}/g,(function(e,i){return t[i]||"{"+i+"}"}))}]};var ra={width:90,height:20};function la(e){return wo(e,"bpmn:Event")||wo(e,"bpmn:Gateway")||wo(e,"bpmn:DataStoreReference")||wo(e,"bpmn:DataObjectReference")||wo(e,"bpmn:DataInput")||wo(e,"bpmn:DataOutput")||wo(e,"bpmn:SequenceFlow")||wo(e,"bpmn:MessageFlow")||wo(e,"bpmn:Group")}function ca(e){return ua(e.label)}function da(e){return e.waypoints?function(e){var t=e.length/2-1,i=e[Math.floor(t)],n=e[Math.ceil(t+.01)],o=function(e){var t=e.length/2-1,i=e[Math.floor(t)],n=e[Math.ceil(t+.01)];return{x:i.x+(n.x-i.x)/2,y:i.y+(n.y-i.y)/2}}(e),a=Math.atan((n.y-i.y)/(n.x-i.x)),s=o.x,r=o.y;return Math.abs(a)<Math.PI/2?r-=15:s+=15,{x:s,y:r}}(e.waypoints):wo(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+ra.height/2}:{x:e.x+e.width/2,y:e.y+e.height+ra.height/2}}function ua(e){return e&&!!e.labelTarget}function ha(e,t,i){return Se({id:e.id,type:e.$type,businessObject:e,di:t},i)}function pa(e,t,i){var n=e.waypoint;return!n||n.length<2?[vi(t),vi(i)]:n.map((function(e){return{x:e.x,y:e.y}}))}function ma(e,t,i,n){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:fo(i),referenced:fo(t),property:n}))}function fa(e,t,i,n,o,a){this._eventBus=e,this._canvas=t,this._elementFactory=i,this._elementRegistry=n,this._translate=o,this._textRenderer=a}fa.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"],fa.prototype.add=function(e,t,i){var n,o,a,s,r,l,c,d=this._translate;if(wo(t,"bpmndi:BPMNPlane")){var u=wo(e,"bpmn:SubProcess")?{id:e.id+"_plane"}:{};n=this._elementFactory.createRoot(ha(e,t,u)),this._canvas.addRootElement(n)}else if(wo(t,"bpmndi:BPMNShape")){var h=!Io(e,t),p=function(e){return wo(e,"bpmn:Group")}(e);o=i&&(i.hidden||i.collapsed);var m=t.bounds;n=this._elementFactory.createShape(ha(e,t,{collapsed:h,hidden:o,x:Math.round(m.x),y:Math.round(m.y),width:Math.round(m.width),height:Math.round(m.height),isFrame:p})),wo(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,n),wo(e,"bpmn:Lane")&&(a=0),wo(e,"bpmn:DataStoreReference")&&(s=i,l=(r=vi(m)).x,c=r.y,l>=s.x&&l<=s.x+s.width&&c>=s.y&&c<=s.y+s.height||(i=this._canvas.findRoot(i))),this._canvas.addShape(n,i,a)}else{if(!wo(t,"bpmndi:BPMNEdge"))throw new Error(d("unknown di {di} for element {semantic}",{di:fo(t),semantic:fo(e)}));var f=this._getSource(e),g=this._getTarget(e);o=i&&(i.hidden||i.collapsed),n=this._elementFactory.createConnection(ha(e,t,{hidden:o,source:f,target:g,waypoints:pa(t,f,g)})),wo(e,"bpmn:DataAssociation")&&(i=this._canvas.findRoot(i)),wo(e,"bpmn:SequenceFlow")&&(a=0),this._canvas.addConnection(n,i,a)}return la(e)&&Mo(n)&&this.addLabel(e,t,n),this._eventBus.fire("bpmnElement.added",{element:n}),n},fa.prototype._attachBoundary=function(e,t){var i=this._translate,n=e.attachedToRef;if(!n)throw new Error(i("missing {semantic}#attachedToRef",{semantic:fo(e)}));var o=this._elementRegistry.get(n.id),a=o&&o.attachers;if(!o)throw ma(i,e,n,"attachedToRef");t.host=o,a||(o.attachers=a=[]),-1===a.indexOf(t)&&a.push(t)},fa.prototype.addLabel=function(e,t,i){var n,o,a;return n=function(e,t){var i,n,o,a=e.label;return a&&a.bounds?(o=a.bounds,n={width:Math.max(ra.width,o.width),height:o.height},i={x:o.x+o.width/2,y:o.y+o.height/2}):(i=da(t),n=ra),Se({x:i.x-n.width/2,y:i.y-n.height/2},n)}(t,i),(o=Mo(i))&&(n=this._textRenderer.getExternalLabelBounds(n,o)),a=this._elementFactory.createLabel(ha(e,t,{id:e.id+"_label",labelTarget:i,type:"label",hidden:i.hidden||!Mo(i),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(a,i.parent)},fa.prototype._getEnd=function(e,t){var i,n,o=e.$type,a=this._translate;if(n=e[t+"Ref"],"source"===t&&"bpmn:DataInputAssociation"===o&&(n=n&&n[0]),("source"===t&&"bpmn:DataOutputAssociation"===o||"target"===t&&"bpmn:DataInputAssociation"===o)&&(n=e.$parent),i=n&&this._getElement(n))return i;throw n?ma(a,e,n,t+"Ref"):new Error(a("{semantic}#{side} Ref not specified",{semantic:fo(e),side:t}))},fa.prototype._getSource=function(e){return this._getEnd(e,"source")},fa.prototype._getTarget=function(e){return this._getEnd(e,"target")},fa.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};const ga={__depends__:[aa,{__depends__:[sa],bpmnImporter:["type",fa]}]};function va(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function ba(e){return e.originalEvent||e.srcEvent}function ya(e,t){va(e),va(ba(e))}function wa(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function xa(e,t){return(ba(e)||e).button===t}function $a(e){return xa(e,0)}function _a(e){var t=ba(e)||e;return!!$a(e)&&(/mac/i.test(navigator.platform)?t.metaKey:t.ctrlKey)}function Ca(e){var t=ba(e)||e;return $a(e)&&t.shiftKey}function Ea(e){return!0}function Sa(e){return $a(e)||function(e){return xa(e,1)}(e)}function ka(e,t,i){var n=this;function o(i,n,o){var a,s;(function(e,t){return!(l[e]||$a)(t)})(i,n)||(o?s=t.getGraphics(o):(a=n.delegateTarget||n.target)&&(s=a,o=t.get(s)),s&&o&&!1===e.fire(i,{element:o,gfx:s,originalEvent:n})&&(n.stopPropagation(),n.preventDefault()))}var a={};function s(e){return a[e]}var r={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},l={"element.contextmenu":Ea,"element.mousedown":Sa,"element.mouseup":Sa,"element.click":Sa,"element.dblclick":Sa};function c(e,t,i,n){var s=a[i]=function(e){o(i,e)};n&&(l[i]=n),s.$delegate=Ge(e,"svg, .djs-element",t,s)}function d(e,t,i){var n=s(i);n&&Ye(e,t,n.$delegate)}e.on("canvas.destroy",(function(e){var t;t=e.svg,se(r,(function(e,i){d(t,i,e)}))})),e.on("canvas.init",(function(e){var t;t=e.svg,se(r,(function(e,i){c(t,i,e)}))})),e.on(["shape.added","connection.added"],(function(t){var i=t.element,n=t.gfx;e.fire("interactionEvents.createHit",{element:i,gfx:n})})),e.on(["shape.changed","connection.changed"],500,(function(t){var i=t.element,n=t.gfx;e.fire("interactionEvents.updateHit",{element:i,gfx:n})})),e.on("interactionEvents.createHit",500,(function(e){var t=e.element,i=e.gfx;n.createDefaultHit(t,i)})),e.on("interactionEvents.updateHit",(function(e){var t=e.element,i=e.gfx;n.updateDefaultHit(t,i)}));var u=m("djs-hit djs-hit-stroke"),h=m("djs-hit djs-hit-click-stroke"),p={all:m("djs-hit djs-hit-all"),"click-stroke":h,stroke:u};function m(e,t){return t=Se({stroke:"white",strokeWidth:15},t||{}),i.cls(e,["no-fill","no-border"],t)}function f(e,t){var i=p[t];if(!i)throw new Error("invalid hit type <"+t+">");return at(e,i),e}function g(e,t){it(e,t)}this.removeHits=function(e){se(Je(".djs-hit",e),ht)},this.createDefaultHit=function(e,t){var i,n=e.waypoints,o=e.isFrame;return n?this.createWaypointsHit(t,n):(i=o?"stroke":"all",this.createBoxHit(t,i,{width:e.width,height:e.height}))},this.createWaypointsHit=function(e,t){var i=Ht(t);return f(i,"stroke"),g(e,i),i},this.createBoxHit=function(e,t,i){i=Se({x:0,y:0},i);var n=bt("rect");return f(n,t),at(n,i),g(e,n),n},this.updateDefaultHit=function(e,t){var i=Qe(".djs-hit",t);if(i)return e.waypoints?function(e,t){at(e,{points:Ut(t)})}(i,e.waypoints):at(i,{width:e.width,height:e.height}),i},this.fire=o,this.triggerMouseEvent=function(e,t,i){var n=r[e];if(!n)throw new Error("unmapped DOM event name <"+e+">");return o(n,t,i)},this.mouseHandler=s,this.registerEvent=c,this.unregisterEvent=d}ka.$inject=["eventBus","elementRegistry","styles"];const Aa={__init__:["interactionEvents"],interactionEvents:["type",ka]};function Ra(e,t,i){this.offset=6;var n=t.cls("djs-outline",["no-fill"]),o=this;function a(e,t){var i=bt("rect");return at(i,Se({x:10,y:10,width:100,height:100},n)),it(e,i),i}e.on(["shape.added","shape.changed"],500,(function(e){var t=e.element,i=e.gfx,n=Qe(".djs-outline",i);n||(n=a(i)),o.updateShapeOutline(n,t)})),e.on(["connection.added","connection.changed"],(function(e){var t=e.element,i=e.gfx,n=Qe(".djs-outline",i);n||(n=a(i)),o.updateConnectionOutline(n,t)}))}Ra.prototype.updateShapeOutline=function(e,t){at(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},Ra.prototype.updateConnectionOutline=function(e,t){var i=Xt(t);at(e,{x:i.x-this.offset,y:i.y-this.offset,width:i.width+2*this.offset,height:i.height+2*this.offset})},Ra.$inject=["eventBus","styles","elementRegistry"];const Da={__init__:["outline"],outline:["type",Ra]};function Pa(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var i=this;e.on(["shape.remove","connection.remove"],(function(e){var t=e.element;i.deselect(t)})),e.on(["diagram.clear","root.set"],(function(e){i.select(null)}))}Pa.$inject=["eventBus","canvas"],Pa.prototype.deselect=function(e){var t=this._selectedElements,i=t.indexOf(e);if(-1!==i){var n=t.slice();t.splice(i,1),this._eventBus.fire("selection.changed",{oldSelection:n,newSelection:t})}},Pa.prototype.get=function(){return this._selectedElements},Pa.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},Pa.prototype.select=function(e,t){var i=this._selectedElements,n=i.slice();Q(e)||(e=e?[e]:[]);var o=this._canvas,a=o.getRootElement();e=e.filter((function(e){var t=o.findRoot(e);return a===t})),t?se(e,(function(e){-1===i.indexOf(e)&&i.push(e)})):this._selectedElements=i=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:n,newSelection:i})};var La="hover",Fa="selected";function Va(e,t,i,n){function o(e,i){t.addMarker(e,i)}function a(e,i){t.removeMarker(e,i)}this._multiSelectionBox=null,e.on("element.hover",(function(e){o(e.element,La)})),e.on("element.out",(function(e){a(e.element,La)})),e.on("selection.changed",(function(e){var t=e.oldSelection,i=e.newSelection;se(t,(function(e){-1===i.indexOf(e)&&a(e,Fa)})),se(i,(function(e){-1===t.indexOf(e)&&o(e,Fa)}))}))}function Ba(e,t,i,n){e.on("create.end",500,(function(e){var i=e.context,n=i.canExecute,o=i.elements,a=(i.hints||{}).autoSelect;if(n){if(!1===a)return;Q(a)?t.select(a):t.select(o.filter(Ia))}})),e.on("connect.end",500,(function(e){var i=e.context,n=i.canExecute,o=i.hover;n&&o&&t.select(o)})),e.on("shape.move.end",500,(function(e){var i=e.previousSelection||[],o=n.get(e.context.shape.id);oe(i,(function(e){return o.id===e.id}))||t.select(o)})),e.on("element.click",(function(e){if($a(e)){var n=e.element;n===i.getRootElement()&&(n=null);var o=t.isSelected(n),a=t.get().length>1,s=_a(e)||Ca(e);if(o&&a)return s?t.deselect(n):t.select(n);o?t.deselect(n):t.select(n,s)}}))}function Ia(e){return!e.hidden}Va.$inject=["eventBus","canvas","selection","styles"],Ba.$inject=["eventBus","selection","canvas","elementRegistry"];const Ta={__init__:["selectionVisuals","selectionBehavior"],__depends__:[Aa,Da],selection:["type",Pa],selectionVisuals:["type",Va],selectionBehavior:["type",Ba]};function ja(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}ja.prototype.next=function(){return this._prefix+ ++this._counter};var Oa=new ja("ov");function Ma(e,t,i,n){var o,a;this._eventBus=t,this._canvas=i,this._elementRegistry=n,this._ids=Oa,this._overlayDefaults=Se({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(o=i.getContainer(),a=Ze('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),o.insertBefore(a,o.firstChild),a),this._init()}function Na(e,t,i){Se(e.style,{left:t+"px",top:i+"px"})}function Wa(e,t){e.style.display=!1===t?"none":""}function za(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach((function(i){e.style[i+"transform"]=t}))}Ma.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Ma.prototype.get=function(e){if(ie(e)&&(e={id:e}),ie(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?ae(t.overlays,be({type:e.type})):t.overlays.slice():[]}return e.type?ae(this._overlays,be({type:e.type})):e.id?this._overlays[e.id]:null},Ma.prototype.add=function(e,t,i){if(J(t)&&(i=t,t=null),e.id||(e=this._elementRegistry.get(e)),!i.position)throw new Error("must specifiy overlay position");if(!i.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var n=this._ids.next();return i=Se({},this._overlayDefaults,i,{id:n,type:t,element:e,html:i.html}),this._addOverlay(i),n},Ma.prototype.remove=function(e){var t=this.get(e)||[];Q(t)||(t=[t]);var i=this;se(t,(function(e){var t=i._getOverlayContainer(e.element,!0);if(e&&(et(e.html),et(e.htmlContainer),delete e.htmlContainer,delete e.element,delete i._overlays[e.id]),t){var n=t.overlays.indexOf(e);-1!==n&&t.overlays.splice(n,1)}}))},Ma.prototype.show=function(){Wa(this._overlayRoot)},Ma.prototype.hide=function(){Wa(this._overlayRoot,!1)},Ma.prototype.clear=function(){this._overlays={},this._overlayContainers=[],Ie(this._overlayRoot)},Ma.prototype._updateOverlayContainer=function(e){var t=e.element,i=e.html,n=t.x,o=t.y;if(t.waypoints){var a=Xt(t);n=a.x,o=a.y}Na(i,n,o),Re(e.html,"data-container-id",t.id)},Ma.prototype._updateOverlay=function(e){var t,i,n=e.position,o=e.htmlContainer,a=e.element,s=n.left,r=n.top;void 0!==n.right&&(t=a.waypoints?Xt(a).width:a.width,s=-1*n.right+t),void 0!==n.bottom&&(i=a.waypoints?Xt(a).height:a.height,r=-1*n.bottom+i),Na(o,s||0,r||0),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Ma.prototype._createOverlayContainer=function(e){var t=Ze('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var i={html:t,element:e,overlays:[]};return this._updateOverlayContainer(i),this._overlayContainers.push(i),i},Ma.prototype._updateRoot=function(e){var t=e.scale||1,i="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";za(this._overlayRoot,i)},Ma.prototype._getOverlayContainer=function(e,t){var i=oe(this._overlayContainers,(function(t){return t.element===e}));return i||t?i:this._createOverlayContainer(e)},Ma.prototype._addOverlay=function(e){var t,i,n=e.id,o=e.element,a=e.html;a.get&&a.constructor.prototype.jquery&&(a=a.get(0)),ie(a)&&(a=Ze(a)),i=this._getOverlayContainer(o),(t=Ze('<div class="djs-overlay" data-overlay-id="'+n+'" style="position: absolute">')).appendChild(a),e.type&&Ve(t).add("djs-overlay-"+e.type),Wa(t,this._canvas.findRoot(o)===this._canvas.getRootElement()),e.htmlContainer=t,i.overlays.push(e),i.html.appendChild(t),this._overlays[n]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Ma.prototype._updateOverlayVisibilty=function(e,t){var i=e.show,n=this._canvas.findRoot(e.element),o=i&&i.minZoom,a=i&&i.maxZoom,s=e.htmlContainer,r=!0;(n!==this._canvas.getRootElement()||i&&(K(o)&&o>t.scale||K(a)&&a<t.scale))&&(r=!1),Wa(s,r),this._updateOverlayScale(e,t)},Ma.prototype._updateOverlayScale=function(e,t){var i,n,o,a=e.scale,s=e.htmlContainer,r="";!0!==a&&(!1===a?(i=1,n=1):(i=a.min,n=a.max),K(i)&&t.scale<i&&(o=(1/t.scale||1)*i),K(n)&&t.scale>n&&(o=(1/t.scale||1)*n)),K(o)&&(r="scale("+o+","+o+")"),za(s,r)},Ma.prototype._updateOverlaysVisibilty=function(e){var t=this;se(this._overlays,(function(i){t._updateOverlayVisibilty(i,e)}))},Ma.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",(function(e){t.hide()})),e.on("canvas.viewbox.changed",(function(e){var i;i=e.viewbox,t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()})),e.on(["shape.remove","connection.remove"],(function(e){var i=e.element;se(t.get({element:i}),(function(e){t.remove(e.id)}));var n=t._getOverlayContainer(i);if(n){et(n.html);var o=t._overlayContainers.indexOf(n);-1!==o&&t._overlayContainers.splice(o,1)}})),e.on("element.changed",500,(function(e){var i=e.element,n=t._getOverlayContainer(i,!0);n&&(se(n.overlays,(function(e){t._updateOverlay(e)})),t._updateOverlayContainer(n))})),e.on("element.marker.update",(function(e){var i=t._getOverlayContainer(e.element,!0);i&&Ve(i.html)[e.add?"add":"remove"](e.marker)})),e.on("root.set",(function(){t._updateOverlaysVisibilty(t._canvas.viewbox())})),e.on("diagram.clear",this.clear,this)};const Ua={__init__:["overlays"],overlays:["type",Ma]};function Ha(e,t,i,n){e.on("element.changed",(function(n){var o=n.element;(o.parent||o===t.getRootElement())&&(n.gfx=i.getGraphics(o)),n.gfx&&e.fire(Qt(o)+".changed",n)})),e.on("elements.changed",(function(t){var i=t.elements;i.forEach((function(t){e.fire("element.changed",{element:t})})),n.updateContainments(i)})),e.on("shape.changed",(function(e){n.update("shape",e.element,e.gfx)})),e.on("connection.changed",(function(e){n.update("connection",e.element,e.gfx)}))}Ha.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];const qa={__init__:["changeSupport"],changeSupport:["type",Ha]};function Ga(e){this._eventBus=e}function Ya(e,t){t.invoke(Ga,this),this.executed((function(t){var i=t.context;i.rootElement?e.setRootElement(i.rootElement):i.rootElement=e.getRootElement()})),this.revert((function(t){var i=t.context;i.rootElement&&e.setRootElement(i.rootElement)}))}Ga.$inject=["eventBus"],Ga.prototype.on=function(e,t,i,n,o,a){if((te(t)||ee(t))&&(a=o,o=n,n=i,i=t,t=null),te(i)&&(a=o,o=n,n=i,i=1e3),J(o)&&(a=o,o=!1),!te(n))throw new Error("handlerFn must be a function");Q(e)||(e=[e]);var s=this._eventBus;se(e,(function(e){var r=["commandStack",e,t].filter((function(e){return e})).join(".");s.on(r,i,o?function(e,t){return function(i){return e.call(t||null,i.context,i.command,i)}}(n,a):n,a)}))},se(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],(function(e){Ga.prototype[e]=function(t,i,n,o,a){(te(t)||ee(t))&&(a=o,o=n,n=i,i=t,t=null),this.on(t,e,i,n,o,a)}})),Nt()(Ya,Ga),Ya.$inject=["canvas","injector"];const Za={__init__:["rootElementsBehavior"],rootElementsBehavior:["type",Ya]};var Ka=i(8269),Xa=i.n(Ka),Qa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ja(e){return(e=""+e)&&e.replace(/[&<>"']/g,(function(e){return Qa[e]}))}function es(e){return e.id.replace(new RegExp("_plane$"),"")}function ts(e){var t=e.id;return wo(e,"bpmn:SubProcess")?os(t):t}function is(e){return os(e)}function ns(e){return wo(_o(e),"bpmndi:BPMNPlane")}function os(e){return e+"_plane"}function as(e,t,i,n){var o=Ze('<ul class="bjs-breadcrumbs"></ul>'),a=n.getContainer(),s=Ve(a);a.appendChild(o);var r=[];function l(e){e&&(r=function(e){for(var t=[],i=$o(e);i;i=i.$parent)(wo(i,"bpmn:SubProcess")||wo(i,"bpmn:Process"))&&t.push(i);return t.reverse()}(e));var i=r.map((function(e){var i=Ja(e.name||e.id),o=Ze('<li><span class="bjs-crumb"><a title="'+i+'">'+i+"</a></span></li>"),a=n.findRoot(ts(e))||n.findRoot(e.id);if(!a&&wo(e,"bpmn:Process")){var s=t.find((function(t){var i=$o(t);return i&&i.processRef&&i.processRef===e}));a=n.findRoot(s.id)}return o.addEventListener("click",(function(){n.setRootElement(a)})),o}));o.innerHTML="";var a=i.length>1;s.toggle("bjs-breadcrumbs-shown",a),i.forEach((function(e){o.appendChild(e)}))}e.on("element.changed",(function(e){var t=$o(e.element);oe(r,(function(e){return e===t}))&&l()})),e.on("root.set",(function(e){l(e.element)}))}function ss(e,t){var i=null,n=new rs;e.on("root.set",(function(e){var o=e.element,a=t.viewbox(),s=n.get(o);if(n.set(i,{x:a.x,y:a.y,zoom:a.scale}),i=o,!wo(o,"bpmn:Collaboration")||s){s=s||{x:0,y:0,zoom:1};var r=(a.x-s.x)*a.scale,l=(a.y-s.y)*a.scale;0===r&&0===l||t.scroll({dx:r,dy:l}),s.zoom!==a.scale&&t.zoom(s.zoom,{x:0,y:0})}})),e.on("diagram.clear",(function(){n.clear(),i=null}))}function rs(){this._entries=[],this.set=function(e,t){var i=!1;for(var n in this._entries)if(this._entries[n][0]===e){this._entries[n][1]=t,i=!0;break}i||this._entries.push([e,t])},this.get=function(e){for(var t in this._entries)if(this._entries[t][0]===e)return this._entries[t][1];return null},this.clear=function(){this._entries.length=0},this.remove=function(e){var t=-1;for(var i in this._entries)if(this._entries[i][0]===e){t=i;break}-1!==t&&this._entries.splice(t,1)}}as.$inject=["eventBus","elementRegistry","overlays","canvas"],ss.$inject=["eventBus","canvas"];function ls(e,t){this._eventBus=e,this._moddle=t;var i=this;e.on("import.render.start",1500,(function(e,t){i.handleImport(t.definitions)}))}function cs(e){return wo(e,"bpmndi:BPMNDiagram")?e:cs(e.$parent)}ls.prototype.handleImport=function(e){if(e.diagrams){var t=this;this._definitions=e,this._processToDiagramMap={},e.diagrams.forEach((function(e){e.plane&&e.plane.bpmnElement&&(t._processToDiagramMap[e.plane.bpmnElement.id]=e)}));var i=[];e.diagrams.forEach((function(e){var n=t.createNewDiagrams(e.plane);Array.prototype.push.apply(i,n)})),i.forEach((function(e){t.movePlaneElementsToOrigin(e.plane)}))}},ls.prototype.createNewDiagrams=function(e){var t=this,i=[],n=[];e.get("planeElement").forEach((function(t){var o=t.bpmnElement;if(o){var a=o.$parent;wo(o,"bpmn:SubProcess")&&!t.isExpanded&&i.push(o),wo(a,"bpmn:SubProcess")&&a!==e.bpmnElement&&n.push({diElement:t,parent:a})}}));var o=[];return i.forEach((function(e){if(!t._processToDiagramMap[e.id]){var i=t.createDiagram(e);t._processToDiagramMap[e.id]=i,o.push(i)}})),n.forEach((function(e){for(var n=e.diElement,o=e.parent;o&&-1===i.indexOf(o);)o=o.$parent;if(o){var a=t._processToDiagramMap[o.id];t.moveToDiPlane(n,a.plane)}})),o},ls.prototype.movePlaneElementsToOrigin=function(e){var t=e.get("planeElement"),i=function(e){var t={top:1/0,right:-1/0,bottom:-1/0,left:1/0};return e.planeElement.forEach((function(e){if(e.bounds){var i=fi(e.bounds);t.top=Math.min(i.top,t.top),t.left=Math.min(i.left,t.left)}})),gi(t)}(e),n=i.x-180,o=i.y-160;t.forEach((function(e){e.waypoint?e.waypoint.forEach((function(e){e.x=e.x-n,e.y=e.y-o})):e.bounds&&(e.bounds.x=e.bounds.x-n,e.bounds.y=e.bounds.y-o)}))},ls.prototype.moveToDiPlane=function(e,t){var i=cs(e).plane.get("planeElement");i.splice(i.indexOf(e),1),t.get("planeElement").push(e)},ls.prototype.createDiagram=function(e){var t=this._moddle.create("bpmndi:BPMNPlane",{bpmnElement:e}),i=this._moddle.create("bpmndi:BPMNDiagram",{plane:t});return t.$parent=i,t.bpmnElement=e,i.$parent=this._definitions,this._definitions.diagrams.push(i),i},ls.$inject=["eventBus","moddle"];var ds=250;function us(e,t,i,n){Ga.call(this,t),this._canvas=e,this._eventBus=t,this._elementRegistry=i,this._overlays=n;var o=this;this.executed("shape.toggleCollapse",ds,(function(e){var t=e.shape;o.canDrillDown(t)?o.addOverlay(t):o.removeOverlay(t)}),!0),this.reverted("shape.toggleCollapse",ds,(function(e){var t=e.shape;o.canDrillDown(t)?o.addOverlay(t):o.removeOverlay(t)}),!0),this.executed(["shape.create","shape.move","shape.delete"],ds,(function(e){var t=e.oldParent,i=e.newParent||e.parent,n=e.shape;o.canDrillDown(n)&&o.addOverlay(n),o.updateDrilldownOverlay(t),o.updateDrilldownOverlay(i),o.updateDrilldownOverlay(n)}),!0),this.reverted(["shape.create","shape.move","shape.delete"],ds,(function(e){var t=e.oldParent,i=e.newParent||e.parent,n=e.shape;o.canDrillDown(n)&&o.addOverlay(n),o.updateDrilldownOverlay(t),o.updateDrilldownOverlay(i),o.updateDrilldownOverlay(n)}),!0),t.on("import.done",(function(){i.filter((function(e){return o.canDrillDown(e)})).map((function(e){o.addOverlay(e)}))}))}W()(us,Ga),us.prototype.updateDrilldownOverlay=function(e){var t=this._canvas;if(e){var i=t.findRoot(e);i&&this.updateOverlayVisibility(i)}},us.prototype.canDrillDown=function(e){var t=this._canvas;return wo(e,"bpmn:SubProcess")&&t.findRoot(ts(e))},us.prototype.updateOverlayVisibility=function(e){var t=this._overlays,i=e.businessObject,n=t.get({element:i.id,type:"drilldown"})[0];if(n){var o=i&&i.flowElements&&i.flowElements.length;Ve(n.html).toggle("bjs-drilldown-empty",!o)}},us.prototype.addOverlay=function(e){var t=this._canvas,i=this._overlays;i.get({element:e,type:"drilldown"}).length&&this.removeOverlay(e);var n=Ze('<button class="bjs-drilldown"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.81801948,3.50735931 L10.4996894,9.1896894 L10.5,4 L12,4 L12,12 L4,12 L4,10.5 L9.6896894,10.4996894 L3.75735931,4.56801948 C3.46446609,4.27512627 3.46446609,3.80025253 3.75735931,3.50735931 C4.05025253,3.21446609 4.52512627,3.21446609 4.81801948,3.50735931 Z"/></svg></button>');n.addEventListener("click",(function(){t.setRootElement(t.findRoot(ts(e)))})),i.add(e,"drilldown",{position:{bottom:-7,right:-8},html:n}),this.updateOverlayVisibility(e)},us.prototype.removeOverlay=function(e){this._overlays.remove({element:e,type:"drilldown"})},us.$inject=["canvas","eventBus","elementRegistry","overlays"];const hs={__depends__:[Ua,qa,Za],__init__:["drilldownBreadcrumbs","drilldownOverlayBehavior","drilldownCentering","subprocessCompatibility"],drilldownBreadcrumbs:["type",as],drilldownCentering:["type",ss],drilldownOverlayBehavior:["type",us],subprocessCompatibility:["type",ls]};function ps(e){Po.call(this,e)}function ms(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function fs(e,t){return-1!==(e=Q(e)?e:[e]).indexOf(t.key)||-1!==e.indexOf(t.keyCode)}function gs(e){return e.shiftKey}W()(ps,Po),ps.prototype._modules=[ga,sa,Ta,Ua,hs],ps.prototype._moddleExtensions={};var vs="keyboard.keydown";function bs(e,t){var i=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",(function(){i._fire("destroy"),i.unbind()})),t.on("diagram.init",(function(){i._fire("init")})),t.on("attach",(function(){e&&e.bindTo&&i.bind(e.bindTo)})),t.on("detach",(function(){i.unbind()}))}bs.$inject=["config.keyboard","eventBus"],bs.prototype._keydownHandler=function(e){this._keyHandler(e,vs)},bs.prototype._keyupHandler=function(e){this._keyHandler(e,"keyboard.keyup")},bs.prototype._keyHandler=function(e,t){if(!this._isEventIgnored(e)){var i={keyEvent:e};this._eventBus.fire(t||vs,i)&&e.preventDefault()}},bs.prototype._isEventIgnored=function(e){return(t=e.target)&&(Oe(t,"input, textarea")||"true"===t.contentEditable)&&this._isModifiedKeyIgnored(e);var t},bs.prototype._isModifiedKeyIgnored=function(e){return!ms(e)||-1===this._getAllowedModifiers(e.target).indexOf(e.key)},bs.prototype._getAllowedModifiers=function(e){var t=Me(e,"[input-handle-modified-keys]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute("input-handle-modified-keys").split(",")},bs.prototype.bind=function(e){this.unbind(),this._node=e,He.bind(e,"keydown",this._keydownHandler,!0),He.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")},bs.prototype.getBinding=function(){return this._node},bs.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),He.unbind(e,"keydown",this._keydownHandler,!0),He.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null},bs.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},bs.prototype.addListener=function(e,t,i){te(e)&&(i=t,t=e,e=1e3),this._eventBus.on(i||vs,e,t)},bs.prototype.removeListener=function(e,t){this._eventBus.off(t||vs,e)},bs.prototype.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},bs.prototype.isCmd=ms,bs.prototype.isShift=gs,bs.prototype.isKey=fs;var ys=["c","C",67],ws=["v","V",86],xs=["y","Y",89],$s=["z","Z",90];function _s(e,t){var i=this;e.on("editorActions.init",500,(function(e){var n=e.editorActions;i.registerBindings(t,n)}))}_s.$inject=["eventBus","keyboard"],_s.prototype.registerBindings=function(e,t){function i(i,n){t.isRegistered(i)&&e.addListener(n)}i("undo",(function(e){var i=e.keyEvent;if(ms(i)&&!gs(i)&&fs($s,i))return t.trigger("undo"),!0})),i("redo",(function(e){var i=e.keyEvent;if(ms(i)&&(fs(xs,i)||fs($s,i)&&gs(i)))return t.trigger("redo"),!0})),i("copy",(function(e){var i=e.keyEvent;if(ms(i)&&fs(ys,i))return t.trigger("copy"),!0})),i("paste",(function(e){var i=e.keyEvent;if(ms(i)&&fs(ws,i))return t.trigger("paste"),!0})),i("stepZoom",(function(e){var i=e.keyEvent;if(fs(["+","Add","="],i)&&ms(i))return t.trigger("stepZoom",{value:1}),!0})),i("stepZoom",(function(e){var i=e.keyEvent;if(fs(["-","Subtract"],i)&&ms(i))return t.trigger("stepZoom",{value:-1}),!0})),i("zoom",(function(e){var i=e.keyEvent;if(fs("0",i)&&ms(i))return t.trigger("zoom",{value:1}),!0})),i("removeSelection",(function(e){if(fs(["Backspace","Delete","Del"],e.keyEvent))return t.trigger("removeSelection"),!0}))};const Cs={__init__:["keyboard","keyboardBindings"],keyboard:["type",bs],keyboardBindings:["type",_s]};var Es={moveSpeed:50,moveSpeedAccelerated:200};function Ss(e,t,i){var n=this;this._config=Se({},Es,e||{}),t.addListener((function(e){var i=e.keyEvent,o=n._config;if(t.isCmd(i)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],i)){var a,s=t.isShift(i)?o.moveSpeedAccelerated:o.moveSpeed;switch(i.key){case"ArrowLeft":case"Left":a="left";break;case"ArrowUp":case"Up":a="up";break;case"ArrowRight":case"Right":a="right";break;case"ArrowDown":case"Down":a="down"}return n.moveCanvas({speed:s,direction:a}),!0}})),this.moveCanvas=function(e){var t=0,n=0,o=e.speed/Math.min(Math.sqrt(i.viewbox().scale),1);switch(e.direction){case"left":t=o;break;case"up":n=o;break;case"right":t=-o;break;case"down":n=-o}i.scroll({dx:t,dy:n})}}Ss.$inject=["config.keyboardMove","keyboard","canvas"];const ks={__depends__:[Cs],__init__:["keyboardMove"],keyboardMove:["type",Ss]};var As=/^djs-cursor-.*$/;function Rs(e){var t=Ve(document.body);t.removeMatching(As),e&&t.add("djs-cursor-"+e)}function Ds(){Rs(null)}function Ps(e,t){function i(){return!1}return t=t||"element.click",e.once(t,5e3,i),function(){e.off(t,i)}}function Ls(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Fs(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Vs(e,t){var i;function n(n){var o,a=i.start,s=i.button,r=wa(n),l=Fs(r,a);!i.dragging&&(o=l,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>15)&&(i.dragging=!0,0===s&&Ps(e),Rs("grab")),i.dragging&&(l=Fs(r,i.last||i.start),t.scroll({dx:l.x,dy:l.y}),i.last=r),n.preventDefault()}function o(e){He.unbind(document,"mousemove",n),He.unbind(document,"mouseup",o),i=null,Ds()}e.on("element.mousedown",500,(function(e){return function(e){if(!Me(e.target,".djs-draggable")){var t=e.button;if(!(t>=2||e.ctrlKey||e.shiftKey||e.altKey))return i={button:t,start:wa(e)},He.bind(document,"mousemove",n),He.bind(document,"mouseup",o),!0}}(e.originalEvent)})),this.isActive=function(){return!!i}}Vs.$inject=["eventBus","canvas"];const Bs={__init__:["moveCanvas"],moveCanvas:["type",Vs]};function Is(e){return Math.log(e)/Math.log(10)}function Ts(e,t){var i=Is(e.min),n=Is(e.max);return(Math.abs(i)+Math.abs(n))/t}var js=Math.sign||function(e){return e>=0?1:-1},Os={min:.2,max:4};function Ms(e,t,i){e=e||{},this._enabled=!1,this._canvas=i,this._container=i._container,this._handleWheel=Ce(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||.75;var n=this;t.on("canvas.init",(function(t){n._init(!1!==e.enabled)}))}Ms.$inject=["config.zoomScroll","eventBus","canvas"],Ms.prototype.scroll=function(e){this._canvas.scroll(e)},Ms.prototype.reset=function(){this._canvas.zoom("fit-viewport")},Ms.prototype.zoom=function(e,t){var i=Ts(Os,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,i),this._totalDelta=0)},Ms.prototype._handleWheel=function(e){if(!Me(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var i,n=e.ctrlKey,o=e.shiftKey,a=-1*this._scale;if(a*=n?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,n){var s=t.getBoundingClientRect(),r={x:e.clientX-s.left,y:e.clientY-s.top};i=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*js(e.deltaY)*a,this.zoom(i,r)}else i=o?{dx:a*e.deltaY,dy:0}:{dx:a*e.deltaX,dy:a*e.deltaY},this.scroll(i)}},Ms.prototype.stepZoom=function(e,t){var i=Ts(Os,10);this._zoom(e,t,i)},Ms.prototype._zoom=function(e,t,i){var n=this._canvas,o=e>0?1:-1,a=Is(n.zoom()),s=Math.round(a/i)*i;s+=i*o;var r,l,c=Math.pow(10,s);n.zoom((r=Os,l=c,Math.max(r.min,Math.min(r.max,l))),t)},Ms.prototype.toggle=function(e){var t=this._container,i=this._handleWheel,n=this._enabled;return void 0===e&&(e=!n),n!==e&&He[e?"bind":"unbind"](t,"wheel",i,!1),this._enabled=e,e},Ms.prototype._init=function(e){this.toggle(e)};const Ns={__init__:["zoomScroll"],zoomScroll:["type",Ms]};function Ws(e){ps.call(this,e)}W()(Ws,ps),Ws.prototype._navigationModules=[ks,Bs,Ns],Ws.prototype._modules=[].concat(ps.prototype._modules,Ws.prototype._navigationModules);var zs=i(840),Us=i.n(zs),Hs=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function qs(e,t){return t.get(e,!1)}function Gs(e){e.preventDefault(),"function"==typeof e.stopPropagation?e.stopPropagation():e.srcEvent&&"function"==typeof e.srcEvent.stopPropagation&&e.srcEvent.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation()}function Ys(e){function t(t){setTimeout((function(){se(Hs,(function(t){He.unbind(e,t,Gs,!0)}))}),500)}He.bind(e,"touchstart",(function(t){se(Hs,(function(t){He.bind(e,t,Gs,!0)}))}),!0),He.bind(e,"touchend",t,!0),He.bind(e,"touchcancel",t,!0);var i=new(Us().Manager)(e,{inputClass:Us().TouchInput,recognizers:[],domEvents:!0}),n=new(Us().Tap),o=new(Us().Pan)({threshold:10}),a=new(Us().Press),s=new(Us().Pinch),r=new(Us().Tap)({event:"doubletap",taps:2});return s.requireFailure(o),s.requireFailure(a),i.add([o,a,s,r,n]),i.reset=function(e){var t=this.recognizers,n=this.session;n.stopped||(i.stop(e),setTimeout((function(){var e,i;for(e=0;i=t[e];e++)i.reset(),i.state=8;n.curRecognizer=null}),0))},i.on("hammer.input",(function(e){e.srcEvent.defaultPrevented&&i.reset(!0)})),i}function Zs(e,t,i,n,o){var a,s=qs("dragging",e),r=qs("move",e),l=qs("contextPad",e),c=qs("palette",e);function d(e,t){return function(i){var a=u(i.target),s=a&&n.get(a);return t&&(i.srcEvent.button=t),o.fire(e,i,s)}}function u(e){return Me(e,"svg, .djs-element",!0)}s&&i.on("drag.move",(function(e){var t=e.originalEvent;if(t&&!(t instanceof MouseEvent)){var i=wa(t),o=u(document.elementFromPoint(i.x,i.y)),a=o&&n.get(o);a!==e.hover&&(e.hover&&s.out(e),a&&(s.hover({element:a,gfx:o}),e.hover=a,e.hoverGfx=o))}})),l&&i.on("contextPad.create",(function(e){var t=Ys(e.pad.html);t.on("panstart",(function(e){l.trigger("dragstart",e,!0)})),t.on("press",(function(e){l.trigger("dragstart",e,!0)})),t.on("tap",(function(e){l.trigger("click",e)}))})),c&&i.on("palette.create",(function(e){var t=Ys(e.container);t.on("panstart",(function(e){c.trigger("dragstart",e,!0)})),t.on("press",(function(e){c.trigger("dragstart",e,!0)})),t.on("tap",(function(e){c.trigger("click",e)}))})),i.on("canvas.init",(function(e){!function(e){function i(e){var i=u(e.target),o=i&&n.get(i);if(r&&t.getRootElement()!==o)return r.start(e,o,!0);!function(e){var i=0,n=0;function o(e){var o=e.deltaX-i,a=e.deltaY-n;t.scroll({dx:o,dy:a}),i=e.deltaX,n=e.deltaY}function s(e){a.off("panmove",o),a.off("panend",s),a.off("pancancel",s)}a.on("panmove",o),a.on("panend",s),a.on("pancancel",s)}()}(a=Ys(e)).on("tap",d("element.click")),a.on("doubletap",d("element.dblclick",1)),a.on("panstart",i),a.on("press",i),a.on("pinchstart",(function(e){var i=t.zoom(),n=e.center;function o(e){var o=1-(1-e.scale)/1.5,a=Math.max(.2,Math.min(4,o*i));t.zoom(a,n),Gs(e)}function s(e){a.off("pinchmove",o),a.off("pinchend",s),a.off("pinchcancel",s),a.reset(!0)}a.on("pinchmove",o),a.on("pinchend",s),a.on("pinchcancel",s)}))}(e.svg)}))}function Ks(e,t){var i=this;t.on("canvas.init",(function(e){i.addBBoxMarker(e.svg)}))}Zs.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"],Ks.$inject=["canvas","eventBus"],Ks.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},i=bt("rect");at(i,{x:-1e4,y:1e4,width:10,height:10}),at(i,t),it(e,i);var n=bt("rect");at(n,{x:1e4,y:1e4,width:10,height:10}),at(n,t),it(e,n)};const Xs={__depends__:[{__depends__:[Aa],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Zs],touchFix:["type",Ks]}]};function Qs(e){return e&&e[e.length-1]}function Js(e){return e.y}function er(e){return e.x}var tr={left:er,center:er,right:function(e){return e.x+e.width},top:Js,middle:Js,bottom:function(e){return e.y+e.height}};function ir(e){this._modeling=e}ir.$inject=["modeling"],ir.prototype._getOrientationDetails=function(e){var t="x",i="width";return-1!==["top","bottom","middle"].indexOf(e)&&(t="y",i="height"),{axis:t,dimension:i}},ir.prototype._isType=function(e,t){return-1!==t.indexOf(e)},ir.prototype._alignmentPosition=function(e,t){var i,n,o,a=this._getOrientationDetails(e),s=a.axis,r=a.dimension,l={},c={},d=!1;if(this._isType(e,["left","top"]))l[e]=t[0][s];else if(this._isType(e,["right","bottom"]))o=Qs(t),l[e]=o[s]+o[r];else if(this._isType(e,["center","middle"])){if(se(t,(function(e){var t=e[s]+Math.round(e[r]/2);c[t]?c[t].elements.push(e):c[t]={elements:[e],center:t}})),i=ve(c,(function(e){return e.elements.length>1&&(d=!0),e.elements.length})),d)return l[e]=Qs(i).center,l;n=t[0],o=Qs(t=ve(t,(function(e){return e[s]+e[r]}))),l[e]=function(e,t){return Math.round((e[s]+t[s]+t[r])/2)}(n,o)}return l},ir.prototype.trigger=function(e,t){var i=this._modeling,n=ae(e,(function(e){return!(e.waypoints||e.host||e.labelTarget)}));if(!(n.length<2)){var o=ve(n,tr[t]),a=this._alignmentPosition(t,o);i.alignElements(o,a)}};const nr={__init__:["alignElements"],alignElements:["type",ir]};function or(e,t,i,n){for(var o;o=sr(e,i,t);)i=n(t,i,o);return i}function ar(e){return function(t,i,n){var o={x:i.x,y:i.y};return["x","y"].forEach((function(a){var s=e[a];if(s){var r="x"===a?"width":"height",l=s.margin,c=s.minDistance;o[a]=l<0?Math.min(n[a]+l-t[r]/2,i[a]-c+l):Math.max(n[a]+n[r]+l+t[r]/2,i[a]+c+l)}})),o}}function sr(e,t,i){var n={x:t.x-i.width/2,y:t.y-i.height/2,width:i.width,height:i.height},o=function(e){var t=rr(e);return e.host&&(t=t.concat(rr(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce((function(e,t){return e.concat(rr(t))}),[]))),t}(e);return oe(o,(function(e){return e!==i&&"intersect"===bi(e,n,10)}))}function rr(e){return(t=e,t.outgoing.map((function(e){return e.target}))).concat(function(e){return e.incoming.map((function(e){return e.source}))}(e));var t}function lr(){return!0}function cr(e,t,i){e.on("autoPlace",100,(function(e){var t=e.shape;return function(e,t,i){i||(i={});var n=i.defaultDistance||50,o=vi(e);return{x:fi(e).right+n+t.width/2,y:o.y}}(e.source,t)})),e.on("autoPlace.end",(function(e){i.scrollToElement(e.shape)})),this.append=function(i,n,o){e.fire("autoPlace.start",{source:i,shape:n});var a=e.fire("autoPlace",{source:i,shape:n}),s=t.appendShape(i,n,a,i.parent,o);return e.fire("autoPlace.end",{source:i,shape:s}),s}}function dr(e,t){e.on("autoPlace.end",500,(function(e){t.select(e.shape)}))}cr.$inject=["eventBus","modeling","canvas"],dr.$inject=["eventBus","selection"];const ur={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",cr],autoPlaceSelectionBehavior:["type",dr]};function hr(e,t){return wo(t,"bpmn:TextAnnotation")?function(e,t){var i=fi(e);return or(e,t,{x:i.right+t.width/2,y:i.top-50-t.height/2},ar({y:{margin:-30,minDistance:20}}))}(e,t):xo(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?function(e,t){var i=fi(e);return or(e,t,{x:i.right-10+t.width/2,y:i.bottom+40+t.width/2},ar({x:{margin:30,minDistance:30}}))}(e,t):wo(t,"bpmn:FlowNode")?function(e,t){var i=fi(e),n=vi(e),o=function(e,t){t||(t={});var i=t.defaultDistance||50,n=t.direction||"e",o=t.filter,a=t.getWeight||function(t){return t.source===e?1:-1},s=t.maxDistance||250,r=t.reference||"start";function l(e,t){return"n"===n?"start"===r?fi(e).top-fi(t).bottom:"center"===r?fi(e).top-vi(t).y:fi(e).top-fi(t).top:"w"===n?"start"===r?fi(e).left-fi(t).right:"center"===r?fi(e).left-vi(t).x:fi(e).left-fi(t).left:"s"===n?"start"===r?fi(t).top-fi(e).bottom:"center"===r?vi(t).y-fi(e).bottom:fi(t).bottom-fi(e).bottom:"start"===r?fi(t).left-fi(e).right:"center"===r?vi(t).x-fi(e).right:fi(t).right-fi(e).right}o||(o=lr);var c=e.incoming.filter(o).map((function(t){var i=a(t),n=i<0?l(t.source,e):l(e,t.source);return{id:t.source.id,distance:n,weight:i}})),d=e.outgoing.filter(o).map((function(t){var i=a(t),n=i>0?l(e,t.target):l(t.target,e);return{id:t.target.id,distance:n,weight:i}}));return re(c.concat(d).reduce((function(e,t){return e[t.id+"__weight_"+t.weight]=t,e}),{}),(function(e,t){var i=t.distance,n=t.weight;return i<0||i>s||(e[String(i)]||(e[String(i)]=0),e[String(i)]+=1*n,(!e.distance||e[e.distance]<e[String(i)])&&(e.distance=i)),e}),{}).distance||i}(e,{filter:function(e){return wo(e,"bpmn:SequenceFlow")}}),a=30,s="left";return wo(e,"bpmn:BoundaryEvent")&&-1!==(s=bi(e,e.host,-25)).indexOf("top")&&(a*=-1),or(e,t,{x:i.right+o+t.width/2,y:n.y+pr(s,80)},ar({y:{margin:a,minDistance:80}}))}(e,t):void 0}function pr(e,t){return-1!=e.indexOf("top")?-1*t:-1!=e.indexOf("bottom")?t:0}function mr(e){e.on("autoPlace",(function(e){var t=e.shape;return hr(e.source,t)}))}mr.$inject=["eventBus"];const fr={__depends__:[ur],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",mr]};function gr(e,t,i,n){Ga.call(this,e),this._elementRegistry=t,this._modeling=i,this._rules=n;var o=this;this.postExecuted(["shape.create"],(function(e){var t=e.context,i=t.hints||{},n=t.shape,a=t.parent||t.newParent;!1!==i.autoResize&&o._expand([n],a)})),this.postExecuted(["elements.move"],(function(e){var t=e.context,i=q(pe(t.closure.topLevel)),n=t.hints,a=!n||n.autoResize;!1!==a&&se(me(i,(function(e){return e.parent.id})),(function(e,t){Q(a)&&(e=e.filter((function(e){return oe(a,be({id:e.id}))}))),o._expand(e,t)}))})),this.postExecuted(["shape.toggleCollapse"],(function(e){var t=e.context,i=t.hints,n=t.shape;i&&!1===i.autoResize||n.collapsed||o._expand(n.children||[],n)})),this.postExecuted(["shape.resize"],(function(e){var t=e.context,i=t.hints,n=t.shape,a=n.parent;i&&!1===i.autoResize||a&&o._expand([n],a)}))}function vr(e){e.invoke(gr,this)}function br(e){Ga.call(this,e),this.init()}function yr(e){br.call(this,e);var t=this;this.addRule("element.autoResize",(function(e){return t.canResize(e.elements,e.target)}))}function wr(e,t){yr.call(this,e),this._modeling=t}gr.$inject=["eventBus","elementRegistry","modeling","rules"],Nt()(gr,Ga),gr.prototype._getOptimalBounds=function(e,t){var i=this.getOffset(t),n=this.getPadding(t),o=fi(Xt(e)),a=fi(t),s={};return o.top-a.top<n.top&&(s.top=o.top-i.top),o.left-a.left<n.left&&(s.left=o.left-i.left),a.right-o.right<n.right&&(s.right=o.right+i.right),a.bottom-o.bottom<n.bottom&&(s.bottom=o.bottom+i.bottom),gi(Se({},a,s))},gr.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var i=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(i,t)){var n=function(e,t){var i="";return e=fi(e),t=fi(t),e.top>t.top&&(i=i.concat("n")),e.right<t.right&&(i=i.concat("w")),e.bottom<t.bottom&&(i=i.concat("s")),e.left>t.left&&(i=i.concat("e")),i}(ke(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:n});var o=t.parent;o&&this._expand([t],o)}}},gr.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},gr.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},gr.prototype.resize=function(e,t,i){this._modeling.resizeShape(e,t,null,i)},vr.$inject=["injector"],W()(vr,gr),vr.prototype.resize=function(e,t,i){wo(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,i):this._modeling.resizeShape(e,t,null,i)},br.$inject=["eventBus"],Nt()(br,Ga),br.prototype.addRule=function(e,t,i){var n=this;"string"==typeof e&&(e=[e]),e.forEach((function(e){n.canExecute(e,t,(function(e,t,n){return i(e)}),!0)}))},br.prototype.init=function(){},yr.$inject=["eventBus"],Nt()(yr,br),yr.prototype.canResize=function(e,t){return!1},W()(wr,yr),wr.$inject=["eventBus","modeling"],wr.prototype.canResize=function(e,t){if(wo(t.di,"bpmndi:BPMNPlane"))return!1;if(!wo(t,"bpmn:Participant")&&!wo(t,"bpmn:Lane")&&!wo(t,"bpmn:SubProcess"))return!1;var i=!0;return se(e,(function(e){(wo(e,"bpmn:Lane")||e.labelTarget)&&(i=!1)})),i};const xr={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",vr],bpmnAutoResizeProvider:["type",wr]};function $r(e,t,i){var n,o,a=this,s=i.get("dragging",!1);s&&t.on("drag.start",(function(i){t.once("drag.move",1500,(function(t){!function(t){if(!t.hover){var i=t.originalEvent,n=a._findTargetGfx(i),o=n&&e.get(n);n&&o&&(t.stopPropagation(),s.hover({element:o,gfx:n}),s.move(i))}}(t)}))})),t.on("element.hover",(function(e){n=e.gfx,o=e.element})),t.on("element.hover",1500,(function(e){o&&t.fire("element.out",{element:o,gfx:n})})),t.on("element.out",(function(){n=null,o=null})),this._findTargetGfx=function(e){var t;if(e instanceof MouseEvent)return t=wa(e),Me(document.elementFromPoint(t.x,t.y),"svg, .djs-element",!0)}}$r.$inject=["elementRegistry","eventBus","injector"];const _r={__init__:["hoverFix"],hoverFix:["type",$r]};var Cr=Math.round,Er="djs-drag-active";function Sr(e){e.preventDefault()}function kr(e,t,i,n){var o,a={threshold:5,trapClick:!0};function s(e){var i=t.viewbox(),n=t._container.getBoundingClientRect();return{x:i.x+(e.x-n.left)/i.scale,y:i.y+(e.y-n.top)/i.scale}}function r(t,i){i=i||o;var n=e.createEvent(Se({},i.payload,i.data,{isTouch:i.isTouch}));return!1!==e.fire("drag."+t,n)&&e.fire(i.prefix+"."+t,n)}function l(e,n){var a,l=o.payload,c=o.displacement,d=o.globalStart,u=wa(e),h=Fs(u,d),p=o.localStart,m=s(u),g=Fs(m,p);if(!o.active&&(n||(a=h,Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))>o.threshold))){if(Se(l,{x:Cr(p.x+c.x),y:Cr(p.y+c.y),dx:0,dy:0},{originalEvent:e}),!1===r("start"))return f();o.active=!0,o.keepSelection||(l.previousSelection=i.get(),i.select(null)),o.cursor&&Rs(o.cursor),t.addMarker(t.getRootElement(),Er)}ya(e),o.active&&(Se(l,{x:Cr(m.x+c.x),y:Cr(m.y+c.y),dx:Cr(g.x),dy:Cr(g.y)},{originalEvent:e}),r("move"))}function c(e){var t=!0;o.active&&(e&&(o.payload.originalEvent=e,ya(e)),t=r("end")),!1===t&&r("rejected"),r("ended",g(!0!==t))}function d(e){27===e.which&&(Sr(e),f())}function u(t){var i;o.active&&(i=Ps(e),setTimeout(i,400),Sr(t)),c(t)}function h(e){l(e)}function p(e){var t=o.payload;t.hoverGfx=e.gfx,t.hover=e.element,r("hover")}function m(e){r("out");var t=o.payload;t.hoverGfx=null,t.hover=null}function f(e){var t;if(o){var i=o.active;i&&r("cancel"),t=g(e),i&&r("canceled",t)}}function g(a){var s,g;r("cleanup"),Ds(),g=o.trapClick?u:c,He.unbind(document,"mousemove",l),He.unbind(document,"dragstart",Sr),He.unbind(document,"selectstart",Sr),He.unbind(document,"mousedown",g,!0),He.unbind(document,"mouseup",g,!0),He.unbind(document,"keyup",d),He.unbind(document,"touchstart",h,!0),He.unbind(document,"touchcancel",f,!0),He.unbind(document,"touchmove",l,!0),He.unbind(document,"touchend",c,!0),e.off("element.hover",p),e.off("element.out",m),t.removeMarker(t.getRootElement(),Er);var v=o.payload.previousSelection;return!1!==a&&v&&!i.get().length&&function(e){var t=e.filter((function(e){return n.get(e.id)}));t.length&&i.select(t)}(v),s=o,o=null,s}e.on("diagram.destroy",f),this.init=function(t,i,n,g){o&&f(!1),"string"==typeof i&&(g=n,n=i,i=null);var v,b,y,w,x,$=(g=Se({},a,g||{})).data||{};w=g.trapClick?u:c,t?(v=ba(t)||t,b=wa(t),ya(t),"dragstart"===v.type&&Sr(v)):(v=null,b={x:0,y:0}),y=s(b),i||(i=y),x=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(v),o=Se({prefix:n,data:$,payload:{},globalStart:b,displacement:Fs(i,y),localStart:y,isTouch:x},g),g.manual||(x?(He.bind(document,"touchstart",h,!0),He.bind(document,"touchcancel",f,!0),He.bind(document,"touchmove",l,!0),He.bind(document,"touchend",c,!0)):(He.bind(document,"mousemove",l),He.bind(document,"dragstart",Sr),He.bind(document,"selectstart",Sr),He.bind(document,"mousedown",w,!0),He.bind(document,"mouseup",w,!0)),He.bind(document,"keyup",d),e.on("element.hover",p),e.on("element.out",m)),r("init"),g.autoActivate&&l(t,!0)},this.move=l,this.hover=p,this.out=m,this.end=c,this.cancel=f,this.context=function(){return o},this.setOptions=function(e){Se(a,e)}}kr.$inject=["eventBus","canvas","selection","elementRegistry"];const Ar={__depends__:[_r,Ta],dragging:["type",kr]};function Rr(e,t,i){this._canvas=i,this._opts=Se({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var n=this;t.on("drag.move",(function(e){var t=n._toBorderPoint(e);n.startScroll(t)})),t.on(["drag.cleanup"],(function(){n.stopScroll()}))}Rr.$inject=["config.autoScroll","eventBus","canvas"],Rr.prototype.startScroll=function(e){var t,i,n,o=this._canvas,a=this._opts,s=this,r=o.getContainer().getBoundingClientRect(),l=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var c=0,d=0,u=0;u<4;u++)t=l[u],i=a.scrollThresholdOut[u],n=a.scrollThresholdIn[u],i<t&&t<n&&(0===u?c=a.scrollStep:1==u?d=a.scrollStep:2==u?c=-a.scrollStep:3==u&&(d=-a.scrollStep));0===c&&0===d||(o.scroll({dx:c,dy:d}),this._scrolling=setTimeout((function(){s.startScroll(e)}),a.scrollRepeatTimeout))},Rr.prototype.stopScroll=function(){clearTimeout(this._scrolling)},Rr.prototype.setOptions=function(e){this._opts=Se({},this._opts,e)},Rr.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),i=wa(e.originalEvent);return{x:i.x-t.left,y:i.y-t.top}};const Dr={__depends__:[Ar],__init__:["autoScroll"],autoScroll:["type",Rr]};function Pr(e){this._commandStack=e.get("commandStack",!1)}Pr.$inject=["injector"],Pr.prototype.allowed=function(e,t){var i=!0,n=this._commandStack;return n&&(i=n.canExecute(e,t)),void 0===i||i};const Lr={__init__:["rules"],rules:["type",Pr]};var Fr=Math.round,Vr=Math.max;function Br(e,t){return function(e,t){var i,n;for(i=0;n=e[i];i++)if(si(n,t)<=10)return{point:e[i],bendpoint:!0,index:i};return null}(e,t)||function(e,t){var i,n,o=hi()(function(e,t){return[["M",e.x,e.y],["m",0,-t],["a",t,t,0,1,1,0,20],["a",t,t,0,1,1,0,-20],["z"]]}(t,10),(i=[],e.forEach((function(e,t){i.push([0===t?"M":"L",e.x,e.y])})),i)),a=o[0],s=o[o.length-1];return a?a!==s?a.segment2!==s.segment2?{point:e[n=Vr(a.segment2,s.segment2)-1],bendpoint:!0,index:n}:{point:{x:Fr(a.x+s.x)/2,y:Fr(a.y+s.y)/2},index:a.segment2}:{point:{x:Fr(a.x),y:Fr(a.y)},index:a.segment2}:null}(e,t)}function Ir(e,t,i){var n=function(e,t){var i,n=wa(t),o=e._container.getBoundingClientRect();i={x:o.left,y:o.top};var a=e.viewbox();return{x:a.x+(n.x-i.x)/a.scale,y:a.y+(n.y-i.y)/a.scale}}(e,i);return Br(t,n)}function Tr(e,t){var i=bt("g");dt(i).add("djs-bendpoint"),it(e,i);var n=bt("circle");at(n,{cx:0,cy:0,r:4}),dt(n).add("djs-visual"),it(i,n);var o=bt("circle");return at(o,{cx:0,cy:0,r:10}),dt(o).add("djs-hit"),it(i,o),t&&dt(i).add(t),i}function jr(e,t,i){var n=bt("g"),o=di(t,i),a=li(t,i);return it(e,n),function(e,t,i,n){var o=bt("g");it(e,o);var a=function(e,t,i){var n=t.x-e.x,o=t.y-e.y;return Or("h"===i?n:o)}(t,i,n),s=bt("rect");at(s,{x:-7,y:-1.5,width:14,height:3}),dt(s).add("djs-visual"),it(o,s);var r=bt("rect");at(r,{x:-a/2,y:-7,width:a,height:14}),dt(r).add("djs-hit"),it(o,r),Yi(o,"v"===n?90:0)}(n,t,i,a),dt(n).add("djs-segment-dragger"),dt(n).add("h"===a?"horizontal":"vertical"),Gi(n,o.x,o.y),n}function Or(e){return Math.abs(Math.round(2*e/3))}function Mr(e,t,i,n,o){function a(e,t,n){He.bind(e,t,(function(e){i.triggerMouseEvent(t,e,n),e.stopPropagation()}))}function s(e,i){var n=t.getLayer("overlays"),o=Qe('.djs-bendpoints[data-element-id="'+Xa()(e.id)+'"]',n);return!o&&i&&(at(o=bt("g"),{"data-element-id":e.id}),dt(o).add("djs-bendpoints"),it(n,o),a(o,"mousedown",e),a(o,"click",e),a(o,"dblclick",e)),o}function r(e,t){return Qe('.djs-segment-dragger[data-segment-idx="'+e+'"]',t)}function l(e,t){t.waypoints.forEach((function(t,i){var n=Tr(e);it(e,n),Gi(n,t.x,t.y)})),Tr(e,"floating")}function c(e,t){for(var i,n,o,s=t.waypoints,r=1;r<s.length;r++)li(i=s[r-1],n=s[r])&&(at(o=jr(e,i,n),{"data-segment-idx":r}),a(o,"mousemove",t))}function d(e){var t=s(e);return t||(l(t=s(e,!0),e),c(t,e)),t}function u(e){var t=s(e);t&&(function(e){se(Je(".djs-segment-dragger",e),(function(e){ht(e)}))}(t),function(e){se(Je(".djs-bendpoint",e),(function(e){ht(e)}))}(t),c(t,e),l(t,e))}e.on("connection.changed",(function(e){u(e.element)})),e.on("connection.remove",(function(e){var t=s(e.element);t&&ht(t)})),e.on("element.marker.update",(function(e){var t,i=e.element;i.waypoints&&(t=d(i),e.add?dt(t).add(e.marker):dt(t).remove(e.marker))})),e.on("element.mousemove",(function(e){var i,n,o=e.element,a=o.waypoints;if(a){if(i=s(o,!0),!(n=Ir(t,a,e.originalEvent)))return;!function(e,t){var i=Qe(".floating",e),n=t.point;i&&Gi(i,n.x,n.y)}(i,n),n.bendpoint||function(e,t,i){var n,o,a=r(t.index,e),s=i[t.index-1],l=i[t.index],c=t.point,d=di(s,l),u=li(s,l);a&&(n=function(e){return Qe(".djs-visual",e)}(a),o={x:c.x-d.x,y:c.y-d.y},"v"===u&&(o={x:o.y,y:o.x}),Gi(n,o.x,o.y))}(i,n,a)}})),e.on("element.mousedown",(function(e){if($a(e)){var i=e.originalEvent,a=e.element;if(a.waypoints)return function(e,i){var a,s=i.waypoints,r=Ir(t,s,e);if(r)return a=function(e,t){var i,n,o=e.waypoints;return t.index<=0||t.bendpoint?null:(n=li((i={start:o[t.index-1],end:o[t.index]}).start,i.end))?Or("h"===n?i.end.x-i.start.x:i.end.y-i.start.y)/2:null}(i,r),function(e,t,i){var n,o,a,s,r,l,c=e.index,d=e.point;return!(c<=0||e.bendpoint)&&(a=di(n=t[c-1],o=t[c]),s=li(n,o),r=Math.abs(d.x-a.x),l=Math.abs(d.y-a.y),s&&r<=i&&l<=i)}(r,s,a)?o.start(e,i,r.index):n.start(e,i,r.index,!r.bendpoint),!0}(i,a)}})),e.on("selection.changed",(function(e){var t=e.newSelection[0];t&&t.waypoints&&d(t)})),e.on("element.hover",(function(e){var t=e.element;t.waypoints&&(d(t),i.registerEvent(e.gfx,"mousemove","element.mousemove"))})),e.on("element.out",(function(e){i.unregisterEvent(e.gfx,"mousemove","element.mousemove")})),e.on("element.updateId",(function(e){var t=e.element,i=e.newId;if(t.waypoints){var n=s(t);n&&at(n,{"data-element-id":i})}})),this.addHandles=d,this.updateHandles=u,this.getBendpointsContainer=s,this.getSegmentDragger=r}Mr.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var Nr=Math.round,Wr="reconnectStart",zr="reconnectEnd",Ur="updateWaypoints";function Hr(e,t,i,n,o,a){this._injector=e,this.start=function(e,t,a,s){var r,l=i.getGraphics(t),c=t.source,d=t.target,u=t.waypoints,h=(r=s||0!==a?s||a!==u.length-1?Ur:zr:Wr)===Ur?"connection.updateWaypoints":"connection.reconnect",p=o.allowed(h,{connection:t,source:c,target:d});!1===p&&(p=o.allowed(h,{connection:t,source:d,target:c})),!1!==p&&n.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:l,context:{allowed:p,bendpointIndex:a,connection:t,source:c,target:d,insert:s,type:r}}})},t.on("bendpoint.move.hover",(function(e){var t,i=e.context,n=i.connection,a=n.source,s=n.target,r=e.hover,l=i.type;if(i.hover=r,r){var c=l===Ur?"connection.updateWaypoints":"connection.reconnect";if(t=i.allowed=o.allowed(c,{connection:n,source:l===Wr?r:a,target:l===zr?r:s}))return i.source=l===Wr?r:a,void(i.target=l===zr?r:s);!1===t&&(t=i.allowed=o.allowed(c,{connection:n,source:l===zr?r:s,target:l===Wr?r:a})),t&&(i.source=l===zr?r:s,i.target=l===Wr?r:a)}})),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],(function(e){var t=e.context,i=t.type;t.hover=null,t.source=null,t.target=null,i!==Ur&&(t.allowed=!1)})),t.on("bendpoint.move.end",(function(e){var t=e.context,i=t.allowed,n=t.bendpointIndex,o=t.connection,s=t.insert,r=o.waypoints.slice(),l=t.source,c=t.target,d=t.type,u=t.hints||{},h={x:Nr(e.x),y:Nr(e.y)};if(!i)return!1;d===Ur?(s?r.splice(n,0,h):r[n]=h,u.bendpointMove={insert:s,bendpointIndex:n},r=this.cropWaypoints(o,r),a.updateWaypoints(o,function(e){e=e.slice();for(var t,i,n,o=0;e[o];)t=e[o],i=e[o-1],0===si(t,n=e[o+1])||ri(i,n,t)?e.splice(o,1):o++;return e}(r),u)):(d===Wr?(u.docking="source",qr(t)&&(u.docking="target",u.newWaypoints=r.reverse())):d===zr&&(u.docking="target",qr(t)&&(u.docking="source",u.newWaypoints=r.reverse())),a.reconnect(o,l,c,h,u))}),this)}function qr(e){var t=e.hover,i=e.source,n=e.target,o=e.type;return o===Wr?t&&n&&t===n&&i!==n:o===zr?t&&i&&t===i&&i!==n:void 0}Hr.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],Hr.prototype.cropWaypoints=function(e,t){var i=this._injector.get("connectionDocking",!1);if(!i)return t;var n=e.waypoints;return e.waypoints=t,e.waypoints=i.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=n,t};var Gr="updateWaypoints",Yr="connect-ok",Zr="connect-not-ok",Kr="connect-hover",Xr="djs-updating",Qr="djs-element-hidden";function Jr(e,t,i,n){this._injector=t;var o=t.get("connectionPreview",!1);i.on("bendpoint.move.start",(function(e){var t=e.context,i=t.bendpointIndex,o=t.connection,a=t.insert,s=o.waypoints,r=s.slice();t.waypoints=s,a&&r.splice(i,0,{x:e.x,y:e.y}),o.waypoints=r,dt(t.draggerGfx=Tr(n.getLayer("overlays"))).add("djs-dragging"),n.addMarker(o,Qr),n.addMarker(o,Xr)})),i.on("bendpoint.move.hover",(function(e){var t=e.context,i=t.allowed,o=t.hover,a=t.type;if(o){if(n.addMarker(o,Kr),a===Gr)return;i?(n.removeMarker(o,Zr),n.addMarker(o,Yr)):!1===i&&(n.removeMarker(o,Yr),n.addMarker(o,Zr))}})),i.on(["bendpoint.move.out","bendpoint.move.cleanup"],1100,(function(e){var t=e.context,i=t.hover,o=t.target;i&&(n.removeMarker(i,Kr),n.removeMarker(i,o?Yr:Zr))})),i.on("bendpoint.move.move",(function(t){var i=t.context,n=i.allowed,a=i.bendpointIndex,s=i.draggerGfx,r=i.hover,l=i.type,c=i.connection,d=c.source,u=c.target,h=c.waypoints.slice(),p={x:t.x,y:t.y},m=i.hints||{},f={};o&&(m.connectionStart&&(f.connectionStart=m.connectionStart),m.connectionEnd&&(f.connectionEnd=m.connectionEnd),"reconnectStart"===l?qr(i)?(f.connectionEnd=f.connectionEnd||p,f.source=u,f.target=r||d,h=h.reverse()):(f.connectionStart=f.connectionStart||p,f.source=r||d,f.target=u):"reconnectEnd"===l?qr(i)?(f.connectionStart=f.connectionStart||p,f.source=r||u,f.target=d,h=h.reverse()):(f.connectionEnd=f.connectionEnd||p,f.source=d,f.target=r||u):(f.noCropping=!0,f.noLayout=!0,h[a]=p),l===Gr&&(h=e.cropWaypoints(c,h)),f.waypoints=h,o.drawPreview(i,n,f)),Gi(s,t.x,t.y)}),this),i.on(["bendpoint.move.end","bendpoint.move.cancel"],1100,(function(e){var t=e.context,i=t.connection,a=t.draggerGfx,s=t.hover,r=t.target,l=t.waypoints;i.waypoints=l,ht(a),n.removeMarker(i,Xr),n.removeMarker(i,Qr),s&&(n.removeMarker(s,Yr),n.removeMarker(s,r?Yr:Zr)),o&&o.cleanUp(t)}))}Jr.$inject=["bendpointMove","injector","eventBus","canvas"];var el="connect-hover",tl="djs-updating";function il(e,t,i){return nl(e,t,e[t]+i)}function nl(e,t,i){return{x:"x"===t?i:e.x,y:"y"===t?i:e.y}}function ol(e){return"x"===e?"y":"x"}function al(e,t,i){var n,o;return e.original?e.original:(n=vi(t),nl(e,o=ol(i),n[o]))}function sl(e,t,i,n,o,a){var s=e.get("connectionDocking",!1);function r(e,t){if(!s)return t;var i,n=e.waypoints;return e.waypoints=t,i=s.getCroppedWaypoints(e),e.waypoints=n,i}function l(e){o.update("connection",e.connection,e.connectionGfx)}this.start=function(e,t,o){var a,s,r,l,c=i.getGraphics(t),d=o-1,u=o,h=t.waypoints,p=h[d],m=h[u],f=Ir(i,h,e);(s=li(p,m))&&(r="v"===s?"x":"y",0===d&&(p=al(p,t.source,r)),u===h.length-1&&(m=al(m,t.target,r)),a={connection:t,segmentStartIndex:d,segmentEndIndex:u,segmentStart:p,segmentEnd:m,axis:r,dragPosition:l=f?f.point:{x:(p.x+m.x)/2,y:(p.y+m.y)/2}},n.init(e,l,"connectionSegment.move",{cursor:"x"===r?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:c,context:a}}))},t.on("connectionSegment.move.start",(function(e){var t=e.context,n=e.connection,o=i.getLayer("overlays");t.originalWaypoints=n.waypoints.slice(),t.draggerGfx=jr(o,t.segmentStart,t.segmentEnd),dt(t.draggerGfx).add("djs-dragging"),i.addMarker(n,tl)})),t.on("connectionSegment.move.move",(function(e){var t,i,n=e.context,o=n.connection,a=n.segmentStartIndex,s=n.segmentEndIndex,c=n.segmentStart,d=n.segmentEnd,u=n.axis,h=n.originalWaypoints.slice(),p=il(c,u,e["d"+u]),m=il(d,u,e["d"+u]),f=h.length,g=0;h[a]=p,h[s]=m,a<2&&(t=bi(o.source,p),1===a?"intersect"===t&&(h.shift(),h[0]=p,g--):"intersect"!==t&&(h.unshift(c),g++)),s>f-3&&(i=bi(o.target,m),s===f-2?"intersect"===i&&(h.pop(),h[h.length-1]=m):"intersect"!==i&&h.push(d)),n.newWaypoints=o.waypoints=r(o,h),function(e,t,i){var n,o,a,s,r,l,c=e.newWaypoints,d=(n=i,o=c[e.segmentStartIndex+t],a=c[e.segmentEndIndex+t],s=ol(e.axis),r=Math.max(o[s],a[s]),l=Math.min(o[s],a[s]),nl(o,s,Math.min(Math.max(l+20,n[s]),r-20)));Gi(e.draggerGfx,d.x,d.y)}(n,g,e),n.newSegmentStartIndex=a+g,l(e)})),t.on("connectionSegment.move.hover",(function(e){e.context.hover=e.hover,i.addMarker(e.hover,el)})),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],(function(e){var t=e.context.hover;t&&i.removeMarker(t,el)})),t.on("connectionSegment.move.cleanup",(function(e){var t=e.context,n=t.connection;t.draggerGfx&&ht(t.draggerGfx),i.removeMarker(n,tl)})),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],(function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,l(e)})),t.on("connectionSegment.move.end",(function(e){var t=e.context,i=t.connection,n=t.newWaypoints,o=t.newSegmentStartIndex,s=function(e,t){var i=0;return{waypoints:e.filter((function(n,o){return!ri(e[o-1],e[o+1],n)||(i=o<=t?i-1:i,!1)})),segmentOffset:i}}(n=n.map((function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}})),o),l=r(i,s.waypoints),c=s.segmentOffset,d={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:o+c}};a.updateWaypoints(i,l,d)}))}sl.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var rl=Math.abs,ll=Math.round;function cl(e){return{x:e.x,y:e.y}}function dl(e){return{x:e.x+e.width,y:e.y+e.height}}function ul(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:ll(e.x+e.width/2),y:ll(e.y+e.height/2)}}function hl(e,t){var i=e.snapped;return!!i&&("string"==typeof t?i[t]:i.x&&i.y)}function pl(e,t,i){if("string"!=typeof t)throw new Error("axis must be in [x, y]");if("number"!=typeof i&&!1!==i)throw new Error("value must be Number or false");var n,o=e[t],a=e.snapped=e.snapped||{};return!1===i?a[t]=!1:(a[t]=!0,n=i-o,e[t]+=n,e["d"+t]+=n),o}function ml(e){return e.children||[]}var fl=Math.abs,gl=Math.round;function vl(e){function t(e,t){if(Q(e)){for(var i=e.length;i--;)if(fl(e[i]-t)<=10)return e[i]}else{var n=t%(e=+e);if(n<10)return t-n;if(n>e-10)return t-n+e}return t}function i(e){if(e.width)return{x:gl(e.width/2+e.x),y:gl(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,(function(e){var n,o,a=function(e){var t=e.snapPoints,n=e.connection,o=n.waypoints,a=e.segmentStart,s=e.segmentStartIndex,r=e.segmentEnd,l=e.segmentEndIndex,c=e.axis;if(t)return t;var d=[o[s-1],a,r,o[l+1]];return s<2&&d.unshift(i(n.source)),l>o.length-3&&d.unshift(i(n.target)),e.snapPoints=t={horizontal:[],vertical:[]},se(d,(function(e){e&&(e=e.original||e,"y"===c&&t.horizontal.push(e.y),"x"===c&&t.vertical.push(e.x))})),t}(e.context),s=e.x,r=e.y;if(a){var l=s-(n=t(a.vertical,s)),c=r-(o=t(a.horizontal,r));Se(e,{dx:e.dx-l,dy:e.dy-c,x:n,y:o}),(l||-1!==a.vertical.indexOf(s))&&pl(e,"x",n),(c||-1!==a.horizontal.indexOf(r))&&pl(e,"y",o)}})),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,(function(e){var n,o,a=e.context,s=function(e){var t=e.snapPoints,i=e.connection.waypoints,n=e.bendpointIndex;if(t)return t;var o=[i[n-1],i[n+1]];return e.snapPoints=t={horizontal:[],vertical:[]},se(o,(function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))})),t}(a),r=a.hover,l=r&&i(r),c=e.x,d=e.y;if(s){var u=c-(n=t(l?s.vertical.concat([l.x]):s.vertical,c)),h=d-(o=t(l?s.horizontal.concat([l.y]):s.horizontal,d));Se(e,{dx:e.dx-u,dy:e.dy-h,x:e.x-u,y:e.y-h}),(u||-1!==s.vertical.indexOf(c))&&pl(e,"x",n),(h||-1!==s.horizontal.indexOf(d))&&pl(e,"y",o)}}))}vl.$inject=["eventBus"];const bl={__depends__:[Ar,Lr],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",Mr],bendpointMove:["type",Hr],bendpointMovePreview:["type",Jr],connectionSegmentMove:["type",sl],bendpointSnapping:["type",vl]};function yl(e,t,i,n){function o(e,t){return n.allowed("connection.create",{source:e,target:t})}e.on("connect.hover",(function(e){var t,i=e.context,n=i.start,a=e.hover;if(i.hover=a,!X(t=i.canExecute=o(n,a))){if(!1!==t)return i.source=n,void(i.target=a);X(t=i.canExecute=o(a,n))||!1!==t&&(i.source=a,i.target=n)}})),e.on(["connect.out","connect.cleanup"],(function(e){var t=e.context;t.hover=null,t.source=null,t.target=null,t.canExecute=!1})),e.on("connect.end",(function(e){var t=e.context,n=t.canExecute,o=t.connectionStart,a={x:e.x,y:e.y},s=t.source,r=t.target;if(!n)return!1;var l=null,c={connectionStart:wl(t)?a:o,connectionEnd:wl(t)?o:a};J(n)&&(l=n),i.connect(s,r,l,c)})),this.start=function(e,i,n,o){J(n)||(o=n,n=vi(i)),t.init(e,"connect",{autoActivate:o,data:{shape:i,context:{start:i,connectionStart:n}}})}}function wl(e){var t=e.hover,i=e.source,n=e.target;return t&&i&&t===i&&i!==n}yl.$inject=["eventBus","dragging","modeling","rules"];var xl="connect-ok",$l="connect-not-ok";function _l(e,t,i){var n=e.get("connectionPreview",!1);n&&t.on("connect.move",(function(e){var t=e.context,i=t.canExecute,o=t.hover,a=t.source,s=t.start,r=t.startPosition,l=t.target,c=t.connectionStart||r,d=t.connectionEnd||{x:e.x,y:e.y},u=c,h=d;wl(t)&&(u=d,h=c),n.drawPreview(t,i,{source:a||s,target:l||o,connectionStart:u,connectionEnd:h})})),t.on("connect.hover",900,(function(e){var t=e.context,n=e.hover,o=t.canExecute;null!==o&&i.addMarker(n,o?xl:$l)})),t.on(["connect.out","connect.cleanup"],1100,(function(e){var t=e.hover;t&&(i.removeMarker(t,xl),i.removeMarker(t,$l))})),n&&t.on("connect.cleanup",(function(e){n.cleanUp(e.context)}))}_l.$inject=["injector","eventBus","canvas"];const Cl={__depends__:[Ta,Lr,Ar],__init__:["connectPreview"],connect:["type",yl],connectPreview:["type",_l]};function El(e,t,i,n){this._canvas=t,this._graphicsFactory=i,this._elementFactory=n,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}El.$inject=["injector","canvas","graphicsFactory","elementFactory"],El.prototype.drawPreview=function(e,t,i){i=i||{};var n,o=e.connectionPreviewGfx,a=e.getConnection,s=i.source,r=i.target,l=i.waypoints,c=i.connectionStart,d=i.connectionEnd,u=i.noLayout,h=i.noCropping,p=i.noNoop,m=this;o||(o=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),pt(o),a||(a=e.getConnection=function(e){var t={};return function(i){var n=JSON.stringify(i),o=t[n];return o||(o=t[n]=e.apply(null,arguments)),o}}((function(e,t,i){return m.getConnection(e,t,i)}))),t&&(n=a(t,s,r)),n?(n.waypoints=l||[],this._layouter&&!u&&(n.waypoints=this._layouter.layoutConnection(n,{source:s,target:r,connectionStart:c,connectionEnd:d,waypoints:i.waypoints||n.waypoints})),n.waypoints&&n.waypoints.length||(n.waypoints=[s?vi(s):c,r?vi(r):d]),this._connectionDocking&&(s||r)&&!h&&(n.waypoints=this._connectionDocking.getCroppedWaypoints(n,s,r)),this._graphicsFactory.drawConnection(o,n)):!p&&this.drawNoopPreview(o,i)},El.prototype.drawNoopPreview=function(e,t){var i=t.source,n=t.target,o=t.connectionStart||vi(i),a=t.connectionEnd||vi(n),s=this.cropWaypoints(o,a,i,n);it(e,this.createNoopConnection(s[0],s[1]))},El.prototype.cropWaypoints=function(e,t,i,n){var o=this._graphicsFactory,a=i&&o.getShapePath(i),s=n&&o.getShapePath(n),r=o.getConnectionPath({waypoints:[e,t]});return[e=i&&yi(a,r,!0)||e,t=n&&yi(s,r,!1)||t]},El.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&ht(e.connectionPreviewGfx)},El.prototype.getConnection=function(e){var t=function(e){return J(e)?e:{}}(e);return this._elementFactory.createConnection(t)},El.prototype.createConnectionPreviewGfx=function(){var e=bt("g");return at(e,{pointerEvents:"none"}),dt(e).add("djs-connection-preview"),it(this._canvas.getActiveLayer(),e),e},El.prototype.createNoopConnection=function(e,t){var i=bt("polyline");return at(i,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),at(i,{points:[e.x,e.y,t.x,t.y]}),i};const Sl={__init__:["connectionPreview"],connectionPreview:["type",El]};var kl=Math.min,Al=Math.max;function Rl(e){e.preventDefault()}function Dl(e){e.stopPropagation()}function Pl(e){this.container=e.container,this.parent=Ze('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=Qe("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=Ce(this.autoResize,this),this.handlePaste=Ce(this.handlePaste,this)}function Ll(e,t){this._eventBus=e,this._providers=[],this._textbox=new Pl({container:t.getContainer(),keyHandler:Ce(this._handleKey,this),resizeHandler:Ce(this._handleResize,this)})}Pl.prototype.create=function(e,t,i,n){var o=this.parent,a=this.content,s=this.container;n=this.options=n||{};var r=ke(t=this.style=t||{},["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);Se(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},r);var l=ke(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return Se(a.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},l),n.centerVertically&&Se(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},l),a.innerText=i,He.bind(a,"keydown",this.keyHandler),He.bind(a,"mousedown",Dl),He.bind(a,"paste",this.handlePaste),n.autoResize&&He.bind(a,"input",this.autoResize),n.resizable&&this.resizable(t),s.appendChild(o),this.setSelection(a.lastChild,a.lastChild&&a.lastChild.length),o},Pl.prototype.handlePaste=function(e){var t,i=this.options,n=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(t),i.autoResize){var o=this.autoResize(n);o&&this.resizeHandler(o)}},Pl.prototype.insertText=function(e){e=e.replace(/\r\n|\r|\n/g,"\n"),document.execCommand("insertText",!1,e)||this._insertTextIE(e)},Pl.prototype._insertTextIE=function(e){var t,i,n,o=this.getSelection(),a=o.startContainer,s=o.endContainer,r=o.startOffset,l=o.endOffset,c=o.commonAncestorContainer,d=(t=c.childNodes,[].slice.call(t));if(function(e){return e.nodeType===Node.TEXT_NODE}(c)){var u=a.textContent;a.textContent=u.substring(0,r)+e+u.substring(l),i=a,n=r+e.length}else if(a===this.content&&s===this.content){var h=document.createTextNode(e);this.content.insertBefore(h,d[r]),i=h,n=h.textContent.length}else{var p=d.indexOf(a),m=d.indexOf(s);d.forEach((function(t,i){i===p?t.textContent=a.textContent.substring(0,r)+e+s.textContent.substring(l):i>p&&i<=m&&et(t)})),i=a,n=r+e.length}i&&void 0!==n&&setTimeout((function(){self.setSelection(i,n)}))},Pl.prototype.autoResize=function(){var e=this.parent,t=this.content,i=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-i){var n=e.getBoundingClientRect(),o=t.scrollHeight;e.style.height=o+"px",this.resizeHandler({width:n.width,height:n.height,dx:0,dy:o-n.height})}},Pl.prototype.resizable=function(){var e=this,t=this.parent,i=this.resizeHandle,n=parseInt(this.style.minWidth)||0,o=parseInt(this.style.minHeight)||0,a=parseInt(this.style.maxWidth)||1/0,s=parseInt(this.style.maxHeight)||1/0;if(!i){var r,l,c,d;i=this.resizeHandle=Ze('<div class="djs-direct-editing-resize-handle"></div>');var u=function(i){Rl(i),Dl(i);var u=kl(Al(c+i.clientX-r,n),a),h=kl(Al(d+i.clientY-l,o),s);t.style.width=u+"px",t.style.height=h+"px",e.resizeHandler({width:c,height:d,dx:i.clientX-r,dy:i.clientY-l})},h=function(e){Rl(e),Dl(e),He.unbind(document,"mousemove",u,!1),He.unbind(document,"mouseup",h,!1)};He.bind(i,"mousedown",(function(e){Rl(e),Dl(e),r=e.clientX,l=e.clientY;var i=t.getBoundingClientRect();c=i.width,d=i.height,He.bind(document,"mousemove",u),He.bind(document,"mouseup",h)}))}Se(i.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(i)},Pl.prototype.destroy=function(){var e=this.parent,t=this.content,i=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),He.unbind(t,"keydown",this.keyHandler),He.unbind(t,"mousedown",Dl),He.unbind(t,"input",this.autoResize),He.unbind(t,"paste",this.handlePaste),i&&(i.removeAttribute("style"),et(i)),et(e)},Pl.prototype.getValue=function(){return this.content.innerText.trim()},Pl.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Pl.prototype.setSelection=function(e,t){var i=document.createRange();null===e?i.selectNodeContents(this.content):(i.setStart(e,t),i.setEnd(e,t));var n=window.getSelection();n.removeAllRanges(),n.addRange(i)},Ll.$inject=["eventBus","canvas"],Ll.prototype.registerProvider=function(e){this._providers.push(e)},Ll.prototype.isActive=function(){return!!this._active},Ll.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},Ll.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},Ll.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},Ll.prototype.complete=function(){var e=this._active;if(e){var t,i=e.context.bounds,n=this.$textbox.getBoundingClientRect(),o=this.getValue();o===e.context.text&&n.height===i.height&&n.width===i.width||(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,o,e.context.text,{x:n.left-t.left,y:n.top-t.top,width:n.width,height:n.height})),this._fire("complete"),this.close()}},Ll.prototype.getValue=function(){return this._textbox.getValue()},Ll.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},Ll.prototype._handleResize=function(e){this._fire("resize",e)},Ll.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var i=oe(this._providers,(function(i){return(t=i.activate(e))?i:null}));return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:i},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const Fl={__depends__:[Aa],__init__:["directEditing"],directEditing:["type",Ll]};var Vl=".entry";function Bl(e,t,i){this._eventBus=t,this._overlays=i;var n=K(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:n},this._current=null,this._init()}Bl.$inject=["config.contextPad","eventBus","overlays"],Bl.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",(function(e){var i=e.newSelection;1===i.length?t.open(i[0]):t.close()})),e.on("elements.delete",(function(e){se(e.elements,(function(e){t.isOpen(e)&&t.close()}))})),e.on("element.changed",(function(e){var i=e.element,n=t._current;n&&n.element===i&&t.open(i,!0)}))},Bl.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("contextPad.getProviders",e,(function(e){e.providers.push(t)}))},Bl.prototype.getEntries=function(e){var t=this._getProviders(),i={};return se(t,(function(t){var n=t.getContextPadEntries(e);te(n)?i=n(i):se(n,(function(e,t){i[t]=e}))})),i},Bl.prototype.trigger=function(e,t,i){var n,o,a=this._current.element,s=this._current.entries,r=t.delegateTarget||t.target;if(!r)return t.preventDefault();if(n=s[Re(r,"data-action")].action,o=t.originalEvent||t,te(n)){if("click"===e)return n(o,a,i)}else if(n[e])return n[e](o,a,i);t.preventDefault()},Bl.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},Bl.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},Bl.prototype._updateAndOpen=function(e){var t=this.getEntries(e),i=this.getPad(e),n=i.html;se(t,(function(e,t){var i,o=e.group||"default",a=Ze(e.html||'<div class="entry" draggable="true"></div>');Re(a,"data-action",t),(i=Qe("[data-group="+o+"]",n))||(i=Ze('<div class="group" data-group="'+o+'"></div>'),n.appendChild(i)),i.appendChild(a),e.className&&function(e,t){var i=Ve(e);(Q(t)?t:t.split(/\s+/g)).forEach((function(e){i.add(e)}))}(a,e.className),e.title&&Re(a,"title",e.title),e.imageUrl&&a.appendChild(Ze('<img src="'+e.imageUrl+'">'))})),Ve(n).add("open"),this._current={element:e,pad:i,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})},Bl.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,i=this._overlays,n=Ze('<div class="djs-context-pad"></div>'),o=Se({html:n},this._overlaysConfig);Ge(n,Vl,"click",(function(e){t.trigger("click",e)})),Ge(n,Vl,"dragstart",(function(e){t.trigger("dragstart",e)})),He.bind(n,"mousedown",(function(e){e.stopPropagation()})),this._overlayId=i.add(e,"context-pad",o);var a=i.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:a}),a},Bl.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},Bl.prototype.isOpen=function(e){return!(!this._current||e&&this._current.element!==e)};const Il={__depends__:[Aa,Ua],contextPad:["type",Bl]};var Tl=["marker-start","marker-mid","marker-end"],jl=["circle","ellipse","line","path","polygon","polyline","rect"];function Ol(e,t,i,n){this._elementRegistry=e,this._canvas=i,this._styles=n,this._clonedMarkers={};var o=this;t.on("drag.cleanup",(function(){se(o._clonedMarkers,(function(e){ht(e)})),o._clonedMarkers={}}))}Ol.$inject=["elementRegistry","eventBus","canvas","styles"],Ol.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},Ol.prototype.addDragger=function(e,t,i){var n=mt(i=i||this.getGfx(e)),o=i.getBoundingClientRect();return this._cloneMarkers(Hi(n)),at(n,this._styles.cls("djs-dragger",[],{x:o.top,y:o.left})),it(t,n),n},Ol.prototype.addFrame=function(e,t){var i=bt("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return it(t,i),i},Ol.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var i=0;i<e.childNodes.length;i++)t._cloneMarkers(e.childNodes[i]);(function(e){return-1!==jl.indexOf(e.nodeName)})(e)&&Tl.forEach((function(i){if(at(e,i)){var n=function(e,t,i){return Qe("marker#"+at(e,t).match(/url\(['"]?#([^'"]*)['"]?\)/)[1],i||document)}(e,i,t._canvas.getContainer());t._cloneMarker(e,n,i)}}))},Ol.prototype._cloneMarker=function(e,t,i){var n=t.id,o=this._clonedMarkers[n];if(!o){var a=n+"-clone";(o=mt(t)).id=a,dt(o).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[n]=o;var s=Qe("defs",this._canvas._svg);s||(s=bt("defs"),it(this._canvas._svg,s)),it(s,o)}at(e,i,"url(#"+this._clonedMarkers[n].id+")")};const Ml={__init__:["previewSupport"],previewSupport:["type",Ol]};var Nl="drop-ok",Wl="drop-not-ok",zl="attach-ok",Ul="new-parent",Hl="create";function ql(e,t,i,n,o){function a(t,i){[zl,Nl,Wl,Ul].forEach((function(n){n===i?e.addMarker(t,n):e.removeMarker(t,n)}))}function s(){var e=t.context();e&&e.prefix===Hl&&t.cancel()}i.on(["create.move","create.hover"],(function(e){var t=e.context,i=t.elements,n=e.hover,s=t.source,r=t.hints||{};if(!n)return t.canExecute=!1,void(t.target=null);Gl(e);var l={x:e.x,y:e.y},c=t.canExecute=n&&function(e,t,i,n,a){if(!t)return!1;var s=oe(e=ae(e,(function(t){var i=t.labelTarget;return!(t.parent||function(e){return!!e.labelTarget}(t)&&-1!==e.indexOf(i))})),(function(e){return!Yl(e)})),r=!1,l=!1,c=!1;Zl(e)&&(r=o.allowed("shape.attach",{position:i,shape:s,target:t})),r||(c=Zl(e)?o.allowed("shape.create",{position:i,shape:s,source:n,target:t}):o.allowed("elements.create",{elements:e,position:i,target:t}));var d=a.connectionTarget;return c||r?(s&&n&&(l=o.allowed("connection.create",{source:d===n?s:n,target:d===n?n:s,hints:{targetParent:t,targetAttach:r}})),{attach:r,connect:l}):(null===c||null===r)&&null}(i,n,l,s,r);n&&null!==c&&(t.target=n,c&&c.attach?a(n,zl):a(n,c?Ul:Wl))})),i.on(["create.end","create.out","create.cleanup"],(function(e){var t=e.hover;t&&a(t,null)})),i.on("create.end",(function(e){var t=e.context,i=t.source,o=t.shape,a=t.elements,s=t.target,r=t.canExecute,l=r&&r.attach,c=r&&r.connect,d=t.hints||{};if(!1===r||!s)return!1;Gl(e);var u={x:e.x,y:e.y};o=c?n.appendShape(i,o,u,s,{attach:l,connection:!0===c?{}:c,connectionTarget:d.connectionTarget}):oe(a=n.createElements(a,u,s,Se({},d,{attach:l})),(function(e){return!Yl(e)})),Se(t,{elements:a,shape:o}),Se(e,{elements:a,shape:o})})),i.on("create.init",(function(){i.on("elements.changed",s),i.once(["create.cancel","create.end"],2e3,(function(){i.off("elements.changed",s)}))})),this.start=function(e,i,n){Q(i)||(i=[i]);var o=oe(i,(function(e){return!Yl(e)}));if(o){n=Se({elements:i,hints:{},shape:o},n||{}),se(i,(function(e){ee(e.x)||(e.x=0),ee(e.y)||(e.y=0)}));var a=Xt(ae(i,(function(e){return!e.hidden})));se(i,(function(e){Yl(e)&&(e.waypoints=de(e.waypoints,(function(e){return{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2}}))),Se(e,{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2})})),t.init(e,Hl,{cursor:"grabbing",autoActivate:!0,data:{shape:o,elements:i,context:n}})}}}function Gl(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom&&(e.y=Math.min(e.y,t.bottom)))}function Yl(e){return!!e.waypoints}function Zl(e){return e&&1===e.length&&!Yl(e[0])}function Kl(e,t,i,n,o){t.on("create.move",750,(function(t){var a=t.hover,s=t.context,r=s.elements,l=s.dragGroup;l||(l=s.dragGroup=function(e){var t=bt("g");at(t,o.cls("djs-drag-group",["no-events"]));var a=bt("g");return e.forEach((function(e){var o;e.hidden||(e.waypoints?(o=i._createContainer("connection",a),i.drawConnection(Hi(o),e)):(o=i._createContainer("shape",a),i.drawShape(Hi(o),e),Gi(o,e.x,e.y)),n.addDragger(e,t,o))})),t}(r)),a?(l.parentNode||it(e.getActiveLayer(),l),Gi(l,t.x,t.y)):ht(l)})),t.on("create.cleanup",(function(e){var t=e.context.dragGroup;t&&ht(t)}))}ql.$inject=["canvas","dragging","eventBus","modeling","rules"],Kl.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const Xl={__depends__:[Ar,Ml,Lr,Ta],__init__:["create","createPreview"],create:["type",ql],createPreview:["type",Kl]};var Ql="data-id",Jl=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function ec(e,t,i){var n=K(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:n},this._eventBus=t,this._canvas=i,this._providers={},this._current={}}ec.$inject=["config.popupMenu","eventBus","canvas"],ec.prototype.registerProvider=function(e,t,i){i||(i=t,t=1e3),this._eventBus.on("popupMenu.getProviders."+e,t,(function(e){e.providers.push(i)}))},ec.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var i=this._getProviders(t);if(!i)return!0;var n=this._getEntries(e,i),o=this._getHeaderEntries(e,i),a=he(n)>0,s=o&&he(o)>0;return!a&&!s},ec.prototype.open=function(e,t,i){var n=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!n||!n.length)throw new Error("No registered providers for: "+t);if(!i)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var o=this._current={className:t,element:e,position:i},a=this._getEntries(e,n),s=this._getHeaderEntries(e,n);o.entries=Se({},a,s),o.container=this._createContainer(),he(s)&&o.container.appendChild(this._createEntries(s,"djs-popup-header")),he(a)&&o.container.appendChild(this._createEntries(a,"djs-popup-body"));var r=this._canvas.getContainer();this._attachContainer(o.container,r,i.cursor),this._bindAutoClose()},ec.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindAutoClose(),et(this._current.container),this._current.container=null)},ec.prototype.isOpen=function(){return!!this._current.container},ec.prototype.trigger=function(e){e.preventDefault();var t=Re(e.delegateTarget||e.target,Ql),i=this._getEntry(t);if(i.action)return i.action.call(null,e,i)},ec.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers},ec.prototype._getEntries=function(e,t){var i={};return se(t,(function(t){if(t.getPopupMenuEntries){var n=t.getPopupMenuEntries(e);te(n)?i=n(i):se(n,(function(e,t){i[t]=e}))}else se(t.getEntries(e),(function(e){var t=e.id;if(!t)throw new Error("every entry must have the id property set");i[t]=Ae(e,["id"])}))})),i},ec.prototype._getHeaderEntries=function(e,t){var i={};return se(t,(function(t){if(t.getPopupMenuHeaderEntries){var n=t.getPopupMenuHeaderEntries(e);te(n)?i=n(i):se(n,(function(e,t){i[t]=e}))}else{if(!t.getHeaderEntries)return;se(t.getHeaderEntries(e),(function(e){var t=e.id;if(!t)throw new Error("every entry must have the id property set");i[t]=Ae(e,["id"])}))}})),i},ec.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t},ec.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)},ec.prototype._createContainer=function(){var e=Ze('<div class="djs-popup">'),t=this._current.position,i=this._current.className;return Se(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),Ve(e).add(i),e},ec.prototype._attachContainer=function(e,t,i){var n=this;Ge(e,".entry","click",(function(e){n.trigger(e)})),this._updateScale(e),t.appendChild(e),i&&this._assureIsInbounds(e,i)},ec.prototype._updateScale=function(e){var t,i,n=this._canvas.zoom(),o=this._config.scale,a=n;!0!==o&&(!1===o?(t=1,i=1):(t=o.min,i=o.max),K(t)&&n<t&&(a=t),K(i)&&n>i&&(a=i)),function(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach((function(i){e.style[i+"transform"]=t}))}(e,"scale("+a+")")},ec.prototype._assureIsInbounds=function(e,t){var i,n,o=this._canvas._container.getBoundingClientRect(),a=e.offsetLeft,s=e.offsetTop,r=e.scrollWidth,l=e.scrollHeight,c={},d=t.x-o.left,u=t.y-o.top;a+r>o.width&&(c.x=!0),s+l>o.height&&(c.y=!0),c.x&&c.y?(i=d-r+"px",n=u-l+"px"):c.x?(i=d-r+"px",n=u+"px"):c.y&&u<l?(i=d+"px",n="10px"):c.y&&(i=d+"px",n=u-l+"px"),Se(e.style,{left:i,top:n},{visibility:"visible","z-index":1e3})},ec.prototype._createEntries=function(e,t){var i=Ze("<div>"),n=this;return Ve(i).add(t),se(e,(function(e,t){var o=n._createEntry(e,t);i.appendChild(o)})),i},ec.prototype._createEntry=function(e,t){var i=Ze("<div>"),n=Ve(i);if(n.add("entry"),e.className&&e.className.split(" ").forEach((function(e){n.add(e)})),Re(i,Ql,t),e.label){var o=Ze("<span>");o.textContent=e.label,i.appendChild(o)}return e.imageUrl&&i.appendChild(Ze('<img src="'+e.imageUrl+'" />')),!0===e.active&&n.add("active"),!0===e.disabled&&n.add("disabled"),e.title&&(i.title=e.title),i},ec.prototype._bindAutoClose=function(){this._eventBus.once(Jl,this.close,this)},ec.prototype._unbindAutoClose=function(){this._eventBus.off(Jl,this.close,this)};const tc={__init__:["popupMenu"],popupMenu:["type",ec]};function ic(){}ic.prototype.get=function(){return this._data},ic.prototype.set=function(e){this._data=e},ic.prototype.clear=function(){var e=this._data;return delete this._data,e},ic.prototype.isEmpty=function(){return!this._data};const nc={clipboard:["type",ic]};function oc(e){var t=this;function i(e){t._lastMoveEvent=e}this._lastMoveEvent=null,e.on("canvas.init",(function(e){(t._svg=e.svg).addEventListener("mousemove",i)})),e.on("canvas.destroy",(function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",i)}))}oc.$inject=["eventBus"],oc.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||((e=document.createEvent("MouseEvent")).initMouseEvent&&e.initMouseEvent("mousemove",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e);var e};const ac={__init__:["mouse"],mouse:["type",oc]};function sc(e,t,i,n,o,a,s,r){this._canvas=e,this._create=t,this._clipboard=i,this._elementFactory=n,this._eventBus=o,this._modeling=a,this._mouse=s,this._rules=r,o.on("copyPaste.copyElement",(function(e){var t=e.descriptor,i=e.element,n=e.elements;t.priority=1,t.id=i.id,oe(n,(function(e){return e===i.parent}))&&(t.parent=i.parent.id),function(e){return!!e.host}(i)&&(t.priority=2,t.host=i.host.id),rc(i)&&(t.priority=3,t.source=i.source.id,t.target=i.target.id,t.waypoints=function(e){return de(e.waypoints,(function(e){return(e=cc(e)).original&&(e.original=cc(e.original)),e}))}(i)),lc(i)&&(t.priority=4,t.labelTarget=i.labelTarget.id),se(["x","y","width","height"],(function(e){ee(i[e])&&(t[e]=i[e])})),t.hidden=i.hidden,t.collapsed=i.collapsed})),o.on("copyPaste.pasteElements",(function(e){Se(e.hints,{createElementsBehavior:!1})}))}function rc(e){return!!e.waypoints}function lc(e){return!!e.labelTarget}function cc(e){return Se({},e)}function dc(e,t){var i=t.indexOf(e);return-1===i?t:t.splice(i,1)}sc.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],sc.prototype.copy=function(e){var t,i;return Q(e)||(e=e?[e]:[]),i=!1===(t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}))?{}:this.createTree(Q(t)?t:e),this._clipboard.set(i),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:i}),i},sc.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var i=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:i});var n=this._createElements(t);if(e&&e.element&&e.point)return this._paste(n,e.element,e.point,i);this._create.start(this._mouse.getLastMoveEvent(),n,{hints:i||{}})}},sc.prototype._paste=function(e,t,i,n){se(e,(function(e){ee(e.x)||(e.x=0),ee(e.y)||(e.y=0)}));var o=Xt(e);return se(e,(function(e){rc(e)&&(e.waypoints=de(e.waypoints,(function(e){return{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2}}))),Se(e,{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2})})),this._modeling.createElements(e,i,t,Se({},n))},sc.prototype._createElements=function(e){var t=this,i=this._eventBus,n={},o=[];return se(e,(function(e,a){a=parseInt(a,10),se(e=ve(e,"priority"),(function(e){var a,s=Se({},Ae(e,["priority"]));return n[e.parent]?s.parent=n[e.parent]:delete s.parent,i.fire("copyPaste.pasteElement",{cache:n,descriptor:s}),rc(s)?(s.source=n[e.source],s.target=n[e.target],a=n[e.id]=t.createConnection(s),void o.push(a)):lc(s)?(s.labelTarget=n[s.labelTarget],a=n[e.id]=t.createLabel(s),void o.push(a)):(s.host&&(s.host=n[s.host]),a=n[e.id]=t.createShape(s),void o.push(a))}))})),o},sc.prototype.createConnection=function(e){return this._elementFactory.createConnection(Ae(e,["id"]))},sc.prototype.createLabel=function(e){return this._elementFactory.createLabel(Ae(e,["id"]))},sc.prototype.createShape=function(e){return this._elementFactory.createShape(Ae(e,["id"]))},sc.prototype.hasRelations=function(e,t){var i,n;return!(rc(e)&&(i=oe(t,be({id:e.source.id})),n=oe(t,be({id:e.target.id})),!i||!n)||lc(e)&&!oe(t,be({id:e.labelTarget.id})))},sc.prototype.createTree=function(e){var t=this._rules,i=this,n={},o=[];function a(e,t){var i=oe(o,(function(t){return e===t.element}));i?i.depth<t&&(o=function(e,t){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t}(i,o),o.push({element:i.element,depth:t})):o.push({element:e,depth:t})}return Zt(qt(e),(function(e,t,n){if(!lc(e)){se(e.labels,(function(e){a(e,n)})),se([e.attachers,e.incoming,e.outgoing],(function(e){e&&e.length&&se(e,(function(e){se(e.labels,(function(e){a(e,n)})),a(e,n)}))})),a(e,n);var o=[];return e.children&&(o=e.children.slice()),i._eventBus.fire("copyPaste.createTree",{element:e,children:o}),o}})),e=de(o,(function(e){return e.element})),o=de(o,(function(t){return t.descriptor={},i._eventBus.fire("copyPaste.copyElement",{descriptor:t.descriptor,element:t.element,elements:e}),t})),o=ve(o,(function(e){return e.descriptor.priority})),e=de(o,(function(e){return e.element})),se(o,(function(o){var a=o.depth;i.hasRelations(o.element,e)&&function(e,i){return t.allowed("element.copy",{element:e,elements:i})}(o.element,e)?(n[a]||(n[a]=[]),n[a].push(o.descriptor)):dc(o.element,e)})),n};const uc={__depends__:[nc,Xl,ac,Lr],__init__:["copyPaste"],copyPaste:["type",sc]};function hc(e,t,i){Q(i)||(i=[i]),se(i,(function(i){Z(e[i])||(t[i]=e[i])}))}function pc(e,t,i){var n;t.on("copyPaste.copyElement",750,(function(e){var t=e.descriptor,i=e.element,n=t.oldBusinessObject=$o(i),o=t.oldDi=_o(i);if(t.type=i.type,hc(n,t,"name"),hc(o,t,"isExpanded"),mc(t))return t;n.default&&(t.default=n.default.id)})),t.on("moddleCopy.canCopyProperty",(function(t){var n,o=t.parent,a=t.property;if("processRef"===t.propertyName&&wo(o,"bpmn:Participant")&&wo(a,"bpmn:Process"))return n=e.create("bpmn:Process"),i.copyElement(a,n)})),t.on("copyPaste.pasteElements",(function(){n={}})),t.on("copyPaste.pasteElement",(function(t){var o,a,s,r,l=t.cache,c=t.descriptor,d=c.oldBusinessObject,u=c.oldDi;if(mc(c))return c.businessObject=$o(l[c.labelTarget]),void(c.di=_o(l[c.labelTarget]));o=e.create(d.$type),c.businessObject=i.copyElement(d,o),(a=e.create(u.$type)).bpmnElement=o,c.di=i.copyElement(u,a),function(e,t){var i=$o(e);e.default&&(n[e.default]={element:i,property:"default"}),e.host&&($o(e).attachedToRef=$o(t[e.host])),n=Ae(n,re(n,(function(t,n,o){var a=n.element,s=n.property;return o===e.id&&(a[s]=i,t.push(e.id)),t}),[]))}(c,l),hc(c,o,["isExpanded","name"]),s=c,Q(r="oldBusinessObject")||(r=[r]),se(r,(function(e){s[e]&&delete s[e]}))}))}function mc(e){return!!e.labelTarget}pc.$inject=["bpmnFactory","eventBus","moddleCopy"];var fc=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function gc(e,t,i){this._bpmnFactory=t,this._eventBus=e,this._moddle=i,e.on("moddleCopy.canCopyProperties",(function(e){var t=e.propertyNames;if(t&&t.length)return ve(t,(function(e){return"extensionElements"===e}))})),e.on("moddleCopy.canCopyProperty",(function(e){var t=e.parent,i=J(t)&&t.$descriptor,n=e.propertyName;return(!n||-1===fc.indexOf(n))&&!(n&&i&&!oe(i.properties,be({name:n})))&&void 0})),e.on("moddleCopy.canSetCopiedProperty",(function(e){var t,i=e.property;if("bpmn:ExtensionElements",(t=i)&&"function"==typeof t.$instanceOf&&t.$instanceOf("bpmn:ExtensionElements")&&(!i.values||!i.values.length))return!1}))}function vc(e,t){return re(e.properties,(function(e,i){return t&&i.default?e:e.concat(i.name)}),[])}gc.$inject=["eventBus","bpmnFactory","moddle"],gc.prototype.copyElement=function(e,t,i){var n=this;i&&!Q(i)&&(i=[i]),i=i||vc(e.$descriptor);var o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:i,sourceElement:e,targetElement:t});return!1===o||(Q(o)&&(i=o),se(i,(function(i){var o;ne(e,i)&&(o=e.get(i));var a=n.copyProperty(o,t,i);!1!==n._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:a,propertyName:i})&&K(a)&&t.set(i,a)}))),t},gc.prototype.copyProperty=function(e,t,i){var n=this,o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:i});if(!1!==o){if(o)return J(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;var a=this._moddle.getPropertyDescriptor(t,i);if(!a.isReference){if(a.isId)return this._copyId(e,t);if(Q(e))return re(e,(function(e,a){return(o=n.copyProperty(a,t,i))?(o.$parent=t,e.concat(o)):e}),[]);if(J(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return(o=n._bpmnFactory.create(e.$type)).$parent=t,o=n.copyElement(e,o)}return e}}},gc.prototype._copyId=function(e,t){return this._moddle.ids.assigned(e)?void 0:(this._moddle.ids.claim(e,t),e)};const bc={__depends__:[uc],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",pc],moddleCopy:["type",gc]};var yc=Math.round;function wc(e){this._modeling=e}wc.$inject=["modeling"],wc.prototype.replaceElement=function(e,t,i){if(e.waypoints)return null;var n=this._modeling,o=t.width||e.width,a=t.height||e.height,s=t.x||e.x,r=t.y||e.y,l=yc(s+o/2),c=yc(r+a/2);return n.replaceShape(e,Se({},t,{x:l,y:c,width:o,height:a}),i)};const xc={__init__:["replace"],replace:["type",wc]};var $c=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function _c(e,t,i,n,o,a,s){this.replaceElement=function(r,l,c){c=c||{};var d=l.type,u=r.businessObject;if(Cc(u)&&"bpmn:SubProcess"===d&&function(e,t){var i=e&&ne(e,"collapsed")?e.collapsed:!Io(e);return i!==(t&&(ne(t,"collapsed")||ne(t,"isExpanded"))?ne(t,"collapsed")?t.collapsed:!t.isExpanded:i)}(r,l))return n.toggleCollapse(r),r;var h=e.create(d),p={type:d,businessObject:h,di:{}};!function(e,t,i){Q(i)||(i=[i]),se(i,(function(i){Z(e[i])||(t[i]=e[i])}))}(r.di,p.di,["fill","stroke","background-color","border-color","color"]);var m,f=vc(u.$descriptor),g=vc(h.$descriptor,!0),v=(m=g,f.filter((function(e){return-1!==m.indexOf(e)})));Se(h,ke(l,$c));var b=ae(v,(function(e){return"eventDefinitions"===e?Ec(r,l.eventDefinitionType):"loopCharacteristics"===e?!To(h):!ne(h,e)&&("processRef"!==e||!1!==l.isExpanded)&&"triggeredByEvent"!==e}));return h=i.copyElement(u,h,b),l.eventDefinitionType&&(Ec(h,l.eventDefinitionType)||(p.eventDefinitionType=l.eventDefinitionType,p.eventDefinitionAttrs=l.eventDefinitionAttrs)),wo(u,"bpmn:Activity")&&(Cc(u)?p.isExpanded=Io(r):l&&ne(l,"isExpanded")&&(p.isExpanded=l.isExpanded),Io(r)&&!wo(u,"bpmn:Task")&&p.isExpanded&&(p.width=r.width,p.height=r.height)),Cc(u)&&!Cc(h)&&(c.moveChildren=!1),wo(u,"bpmn:Participant")&&(!0===l.isExpanded?h.processRef=e.create("bpmn:Process"):c.moveChildren=!1,p.width=r.width,p.height=t.getDefaultSize(p).height),a.allowed("shape.resize",{shape:h})||(p.height=t.getDefaultSize(p).height,p.width=t.getDefaultSize(p).width),h.name=u.name,xo(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&xo(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(h.default=u.default),l.host&&!wo(u,"bpmn:BoundaryEvent")&&wo(h,"bpmn:BoundaryEvent")&&(p.host=l.host),"bpmn:DataStoreReference"!==p.type&&"bpmn:DataObjectReference"!==p.type||(p.x=r.x+(r.width-p.width)/2),p=o.replaceElement(r,p,c),!1!==c.select&&s.select(p),p}}function Cc(e){return wo(e,"bpmn:SubProcess")}function Ec(e,t){var i=$o(e);return t&&i.get("eventDefinitions").some((function(e){return wo(e,t)}))}_c.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];const Sc={__depends__:[bc,xc,Ta],bpmnReplace:["type",_c]};function kc(e){return function(t){var i=t.target,n=$o(e),o=n.eventDefinitions&&n.eventDefinitions[0],a=n.$type===i.type,s=(o&&o.$type)===i.eventDefinitionType,r=n.triggeredByEvent===i.triggeredByEvent,l=void 0===i.isExpanded||i.isExpanded===Io(e);return!(a&&s&&r&&l)}}var Ac=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Rc=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],Dc=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Pc=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],Lc=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],Fc=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],Vc=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],Bc=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Ic=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],Tc=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],jc=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],Oc=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],Mc=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],Nc=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],Wc=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function zc(e,t,i,n,o,a,s){this._bpmnFactory=e,this._popupMenu=t,this._modeling=i,this._moddle=n,this._bpmnReplace=o,this._rules=a,this._translate=s,this.register()}zc.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"],zc.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},zc.prototype.getEntries=function(e){var t,i=e.businessObject;if(!this._rules.allowed("shape.replace",{element:e}))return[];var n=kc(e);return wo(i,"bpmn:DataObjectReference")?this._createEntries(e,Tc):wo(i,"bpmn:DataStoreReference")&&!wo(e.parent,"bpmn:Collaboration")?this._createEntries(e,jc):wo(i,"bpmn:StartEvent")&&!wo(i.$parent,"bpmn:SubProcess")?(t=ae(Ac,n),this._createEntries(e,t)):wo(i,"bpmn:Participant")?(t=ae(Wc,(function(t){return Io(e)!==t.target.isExpanded})),this._createEntries(e,t)):wo(i,"bpmn:StartEvent")&&To(i.$parent)?(t=ae(Mc,(function(t){var i=!1!==t.target.isInterrupting,o=$o(e).isInterrupting===i;return n(t)||!n(t)&&!o})),this._createEntries(e,t)):wo(i,"bpmn:StartEvent")&&!To(i.$parent)&&wo(i.$parent,"bpmn:SubProcess")?(t=ae(Rc,n),this._createEntries(e,t)):wo(i,"bpmn:EndEvent")?(t=ae(Pc,(function(e){return!("bpmn:CancelEventDefinition"==e.target.eventDefinitionType&&!wo(i.$parent,"bpmn:Transaction"))&&n(e)})),this._createEntries(e,t)):wo(i,"bpmn:BoundaryEvent")?(t=ae(Oc,(function(e){var t=e.target;if("bpmn:CancelEventDefinition"==t.eventDefinitionType&&!wo(i.attachedToRef,"bpmn:Transaction"))return!1;var o=!1!==t.cancelActivity,a=i.cancelActivity==o;return n(e)||!n(e)&&!a})),this._createEntries(e,t)):wo(i,"bpmn:IntermediateCatchEvent")||wo(i,"bpmn:IntermediateThrowEvent")?(t=ae(Dc,n),this._createEntries(e,t)):wo(i,"bpmn:Gateway")?(t=ae(Lc,n),this._createEntries(e,t)):wo(i,"bpmn:Transaction")?(t=ae(Vc,n),this._createEntries(e,t)):To(i)&&Io(e)?(t=ae(Bc,n),this._createEntries(e,t)):wo(i,"bpmn:SubProcess")&&Io(e)?(t=ae(Fc,n),this._createEntries(e,t)):wo(i,"bpmn:AdHocSubProcess")&&!Io(e)?(t=ae(Ic,(function(t){var i=t.target,n="bpmn:SubProcess"===i.type,o=!0===i.isExpanded;return kc(e)&&(!n||o)})),this._createEntries(e,t)):wo(i,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Nc):wo(i,"bpmn:FlowNode")?(t=ae(Ic,n),wo(i,"bpmn:SubProcess")&&!Io(e)&&(t=ae(t,(function(e){return"Sub Process (collapsed)"!==e.label}))),this._createEntries(e,t)):[]},zc.prototype.getHeaderEntries=function(e){var t=[];return wo(e,"bpmn:Activity")&&!To(e)&&(t=t.concat(this._getLoopEntries(e))),wo(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),wo(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),!wo(e,"bpmn:SubProcess")||wo(e,"bpmn:Transaction")||To(e)||t.push(this._getAdHocEntry(e)),t},zc.prototype._createEntries=function(e,t){var i=[],n=this;return se(t,(function(t){var o=n._createMenuEntry(t,e);i.push(o)})),i},zc.prototype._createSequenceFlowEntries=function(e,t){var i=$o(e),n=[],o=this._modeling,a=this._moddle,s=this;return se(t,(function(t){switch(t.actionName){case"replace-with-default-flow":i.sourceRef.default!==i&&(wo(i.sourceRef,"bpmn:ExclusiveGateway")||wo(i.sourceRef,"bpmn:InclusiveGateway")||wo(i.sourceRef,"bpmn:ComplexGateway")||wo(i.sourceRef,"bpmn:Activity"))&&n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e.source,{default:i})})));break;case"replace-with-conditional-flow":!i.conditionExpression&&wo(i.sourceRef,"bpmn:Activity")&&n.push(s._createMenuEntry(t,e,(function(){var t=a.create("bpmn:FormalExpression",{body:""});o.updateProperties(e,{conditionExpression:t})})));break;default:if(wo(i.sourceRef,"bpmn:Activity")&&i.conditionExpression)return n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e,{conditionExpression:void 0})})));if((wo(i.sourceRef,"bpmn:ExclusiveGateway")||wo(i.sourceRef,"bpmn:InclusiveGateway")||wo(i.sourceRef,"bpmn:ComplexGateway")||wo(i.sourceRef,"bpmn:Activity"))&&i.sourceRef.default===i)return n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e.source,{default:void 0})})))}})),n},zc.prototype._createMenuEntry=function(e,t,i){var n=this._translate,o=this._bpmnReplace.replaceElement,a=e.label;return a&&"function"==typeof a&&(a=a(t)),i=i||function(){return o(t,e.target)},{label:n(a),className:e.className,id:e.actionName,action:i}},zc.prototype._getLoopEntries=function(e){var t=this,i=this._translate;function n(i,n){var o;n.active?o=void 0:(o=t._moddle.create(n.options.loopCharacteristics),n.options.isSequential&&(o.isSequential=n.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:o})}var o,a,s,r=$o(e).loopCharacteristics;return r&&(o=r.isSequential,a=void 0===r.isSequential,s=void 0!==r.isSequential&&!r.isSequential),[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:i("Parallel Multi Instance"),active:s,action:n,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:i("Sequential Multi Instance"),active:o,action:n,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:i("Loop"),active:a,action:n,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}]},zc.prototype._getDataObjectIsCollection=function(e){var t=this,i=this._translate,n=e.businessObject.dataObjectRef,o=n.isCollection;return[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:i("Collection"),active:o,action:function(i,o){t._modeling.updateModdleProperties(e,n,{isCollection:!o.active})}}]},zc.prototype._getParticipantMultiplicity=function(e){var t=this,i=this._bpmnFactory,n=this._translate,o=e.businessObject.participantMultiplicity,a=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:n("Participant Multiplicity"),active:!!o,action:function(n,o){var a;o.active||(a=i.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:a})}}];return a},zc.prototype._getAdHocEntry=function(e){var t=this._translate,i=wo($o(e),"bpmn:AdHocSubProcess"),n=this._bpmnReplace.replaceElement;return{id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(t,o){return n(e,i?{type:"bpmn:SubProcess"}:{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}};const Uc={__depends__:[tc,Sc],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",zc]};function Hc(e,t){for("string"==typeof t&&(t=[t]);e=e.parent;)if(xo(e,t))return e;return null}var qc=Math.max,Gc=Math.min;function Yc(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function Zc(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function Kc(e,t,i){var n=t[e],o=i.min&&i.min[e],a=i.max&&i.max[e];return ee(o)&&(n=(/top|left/.test(e)?Gc:qc)(n,o)),ee(a)&&(n=(/top|left/.test(e)?qc:Gc)(n,a)),n}function Xc(e,t){return void 0!==e?e:20}function Qc(e){return!e.waypoints&&"label"!==e.type}function Jc(e,t){var i;if((i=void 0===e.length?ae(e.children,Qc):e).length)return function(e,t){var i,n,o,a;return"object"==typeof t?(i=Xc(t.left),n=Xc(t.right),o=Xc(t.top),a=Xc(t.bottom)):i=n=o=a=Xc(t),{x:e.x-i,y:e.y-o,width:e.width+i+n,height:e.height+o+a}}(Xt(i),t)}var ed=Math.abs,td=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],id=30;function nd(e,t){return t=t||[],e.children.filter((function(e){wo(e,"bpmn:Lane")&&(nd(e,t),t.push(e))})),t}function od(e){return e.children.filter((function(e){return wo(e,"bpmn:Lane")}))}function ad(e){return Hc(e,td)||e}function sd(e,t,i,n,o,a,s,r,l,c,d,u){e=e||{},n.registerProvider(this),this._contextPad=n,this._modeling=o,this._elementFactory=a,this._connect=s,this._create=r,this._popupMenu=l,this._canvas=c,this._rules=d,this._translate=u,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),i.on("create.end",250,(function(e){var t=e.context.shape;if(_a(e)&&n.isOpen(t)){var i=n.getEntries(t);i.replace&&i.replace.action.click(e,t)}}))}function rd(e,t,i){var n=e.$instanceOf(t),o=!1;return se(e.eventDefinitions||[],(function(e){e.$type===i&&(o=!0)})),n&&o}sd.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"],sd.prototype.getContextPadEntries=function(e){var t=this._contextPad,i=this._modeling,n=this._elementFactory,o=this._connect,a=this._create,s=this._popupMenu,r=this._canvas,l=this._rules,c=this._autoPlace,d=this._translate,u={};if("label"===e.type)return u;var h=e.businessObject;function p(e,t){o.start(e,t)}function m(e,t,i,o){function s(t,i){var s=n.createShape(Se({type:e},o));a.start(t,s,{source:i})}"string"!=typeof i&&(o=i,i=d("Append {type}",{type:e.replace(/^bpmn:/,"")}));var r=c?function(t,i){var a=n.createShape(Se({type:e},o));c.append(i,a)}:s;return{group:"model",className:t,title:i,action:{dragstart:s,click:r}}}function f(e){return function(n,o){i.splitLane(o,e),t.open(o,!0)}}if(xo(h,["bpmn:Lane","bpmn:Participant"])&&Io(e)){var g=od(e);Se(u,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:d("Add Lane above"),action:{click:function(e,t){i.addLane(t,"top")}}}}),g.length<2&&(e.height>=120&&Se(u,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:d("Divide into two Lanes"),action:{click:f(2)}}}),e.height>=180&&Se(u,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:d("Divide into three Lanes"),action:{click:f(3)}}})),Se(u,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:d("Add Lane below"),action:{click:function(e,t){i.addLane(t,"bottom")}}}})}wo(h,"bpmn:FlowNode")&&(wo(h,"bpmn:EventBasedGateway")?Se(u,{"append.receive-task":m("bpmn:ReceiveTask","bpmn-icon-receive-task",d("Append ReceiveTask")),"append.message-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",d("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",d("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",d("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":m("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",d("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):rd(h,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?Se(u,{"append.compensation-activity":m("bpmn:Task","bpmn-icon-task",d("Append compensation activity"),{isForCompensation:!0})}):wo(h,"bpmn:EndEvent")||h.isForCompensation||rd(h,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||To(h)||Se(u,{"append.end-event":m("bpmn:EndEvent","bpmn-icon-end-event-none",d("Append EndEvent")),"append.gateway":m("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",d("Append Gateway")),"append.append-task":m("bpmn:Task","bpmn-icon-task",d("Append Task")),"append.intermediate-event":m("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",d("Append Intermediate/Boundary Event"))})),s.isEmpty(e,"bpmn-replace")||Se(u,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:d("Change type"),action:{click:function(e,i){var n=Se(function(e){var i=r.getContainer(),n=t.getPad(e).html,o=i.getBoundingClientRect(),a=n.getBoundingClientRect(),s=a.top-o.top;return{x:a.left-o.left,y:s+a.height+5}}(i),{cursor:{x:e.x,y:e.y}});s.open(i,"bpmn-replace",n)}}}}),xo(h,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Se(u,{"append.text-annotation":m("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:d("Connect using "+(h.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:p,dragstart:p}}}),wo(h,"bpmn:TextAnnotation")&&Se(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:d("Connect using Association"),action:{click:p,dragstart:p}}}),xo(h,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Se(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:d("Connect using DataInputAssociation"),action:{click:p,dragstart:p}}}),wo(h,"bpmn:Group")&&Se(u,{"append.text-annotation":m("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var v=l.allowed("elements.delete",{elements:[e]});return Q(v)&&(v=v[0]===e),v&&Se(u,{delete:{group:"edit",className:"bpmn-icon-trash",title:d("Remove"),action:{click:function(t){i.removeElements([e])}}}}),u};const ld={__depends__:[Fl,Il,Ta,Cl,Xl,Uc],__init__:["contextPadProvider"],contextPadProvider:["type",sd]};var cd={horizontal:["x","width"],vertical:["y","height"]};function dd(e){this._modeling=e,this._filters=[],this.registerFilter((function(e,t,i){var n,o=0,a=0;return se(e,(function(e){e.waypoints||e.labelTarget||(o+=e[i],a+=1)})),n=Math.round(o/a),ae(e,(function(e){return e[i]<n+50}))}))}dd.$inject=["modeling"],dd.prototype.registerFilter=function(e){if("function"!=typeof e)throw new Error("the filter has to be a function");this._filters.push(e)},dd.prototype.trigger=function(e,t){var i,n,o=this._modeling;if(!(e.length<3||(this._setOrientation(t),n=this._filterElements(e),(i=this._createGroups(n)).length<=2)))return o.distributeElements(i,this._axis,this._dimension),i},dd.prototype._filterElements=function(e){var t=this._filters,i=this._axis,n=this._dimension,o=[].concat(e);return t.length?(se(t,(function(e){o=e(o,i,n)})),o):e},dd.prototype._createGroups=function(e){var t=[],i=this,n=this._axis,o=this._dimension;if(!n)throw new Error('must have a defined "axis" and "dimension"');return se(ve(e,n),(function(e,a){var s,r=i._findRange(e,n,o),l=t[t.length-1];l&&i._hasIntersection(l.range,r)?t[t.length-1].elements.push(e):(s={range:r,elements:[e]},t.push(s))})),t},dd.prototype._setOrientation=function(e){var t=cd[e];this._axis=t[0],this._dimension=t[1]},dd.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)},dd.prototype._findRange=function(e){var t=e[this._axis];return{min:t+5,max:t+e[this._dimension]-5}};const ud={__init__:["distributeElements"],distributeElements:["type",dd]};function hd(e){e.registerFilter((function(e){return ae(e,(function(e){var t=xo(e,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(e.labelTarget||t)}))}))}hd.$inject=["distributeElements"];const pd={__depends__:[ud],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",hd]};var md="is not a registered action";function fd(e,t){this._actions={};var i=this;e.on("diagram.init",(function(){i._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:i})}))}function gd(e,t){return new Error(e+" "+t)}fd.$inject=["eventBus","injector"],fd.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),i=e.get("modeling",!1),n=e.get("selection",!1),o=e.get("zoomScroll",!1),a=e.get("copyPaste",!1),s=e.get("canvas",!1),r=e.get("rules",!1),l=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",(function(){t.undo()})),this.register("redo",(function(){t.redo()}))),a&&n&&this.register("copy",(function(){var e=n.get();a.copy(e)})),a&&this.register("paste",(function(){a.paste()})),o&&this.register("stepZoom",(function(e){o.stepZoom(e.value)})),s&&this.register("zoom",(function(e){s.zoom(e.value)})),i&&n&&r&&this.register("removeSelection",(function(){var e=n.get();if(e.length){var t,o=r.allowed("elements.delete",{elements:e});!1!==o&&(t=Q(o)?o:e).length&&i.removeElements(t.slice())}})),l&&this.register("moveCanvas",(function(e){l.moveCanvas(e)})),c&&this.register("moveSelection",(function(e){c.moveSelection(e.direction,e.accelerated)}))},fd.prototype.trigger=function(e,t){if(!this._actions[e])throw gd(e,md);return this._actions[e](t)},fd.prototype.register=function(e,t){var i=this;if("string"==typeof e)return this._registerAction(e,t);se(e,(function(e,t){i._registerAction(t,e)}))},fd.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw gd(e,"is already registered");this._actions[e]=t},fd.prototype.unregister=function(e){if(!this.isRegistered(e))throw gd(e,md);this._actions[e]=void 0},fd.prototype.getActions=function(){return Object.keys(this._actions)},fd.prototype.isRegistered=function(e){return!!this._actions[e]};const vd={__init__:["editorActions"],editorActions:["type",fd]};function bd(e){e.invoke(fd,this)}W()(bd,fd),bd.$inject=["injector"],bd.prototype._registerDefaultActions=function(e){fd.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),i=e.get("elementRegistry",!1),n=e.get("selection",!1),o=e.get("spaceTool",!1),a=e.get("lassoTool",!1),s=e.get("handTool",!1),r=e.get("globalConnect",!1),l=e.get("distributeElements",!1),c=e.get("alignElements",!1),d=e.get("directEditing",!1),u=e.get("searchPad",!1),h=e.get("modeling",!1);t&&i&&n&&this._registerAction("selectElements",(function(){var e=t.getRootElement(),o=i.filter((function(t){return t!==e}));return n.select(o),o})),o&&this._registerAction("spaceTool",(function(){o.toggle()})),a&&this._registerAction("lassoTool",(function(){a.toggle()})),s&&this._registerAction("handTool",(function(){s.toggle()})),r&&this._registerAction("globalConnectTool",(function(){r.toggle()})),n&&l&&this._registerAction("distributeElements",(function(e){var t=n.get(),i=e.type;t.length&&l.trigger(t,i)})),n&&c&&this._registerAction("alignElements",(function(e){var t=n.get(),i=[],o=e.type;t.length&&(i=ae(t,(function(e){return!wo(e,"bpmn:Lane")})),c.trigger(i,o))})),n&&h&&this._registerAction("setColor",(function(e){var t=n.get();t.length&&h.setColor(t,e)})),n&&d&&this._registerAction("directEditing",(function(){var e=n.get();e.length&&d.activate(e[0])})),u&&this._registerAction("find",(function(){u.toggle()})),t&&h&&this._registerAction("moveToOrigin",(function(){var e,n,o=t.getRootElement();e=Xt(n=wo(o,"bpmn:Collaboration")?i.filter((function(e){return wo(e.parent,"bpmn:Collaboration")})):i.filter((function(e){return e!==o&&!wo(e.parent,"bpmn:SubProcess")}))),h.moveElements(n,{x:-e.x,y:-e.y},o)}))};const yd={__depends__:[vd],editorActions:["type",bd]};function wd(e){e.on(["create.init","shape.move.init"],(function(e){var t=e.context;xo(e.shape,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(t.gridSnappingContext||(t.gridSnappingContext={}),t.gridSnappingContext.snapLocation="top-left")}))}function xd(e,t,i){return i||(i="round"),Math[i](e/t)*t}function $d(e,t,i){var n=!i||!1!==i.active;this._eventBus=t;var o=this;t.on("diagram.init",800,(function(){o.setActive(n)})),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],1200,(function(t){var i=t.originalEvent;if(!(!o.active||i&&ms(i))){var n=t.context,a=n.gridSnappingContext;a||(a=n.gridSnappingContext={}),["x","y"].forEach((function(i){var n={},a=function(e,t,i){var n=e.context,o=e.shape,a=n.gridSnappingContext,s=a.snapLocation,r=a.snapOffset;return r&&ee(r[t])?r[t]:(r||(r=a.snapOffset={}),ee(r[t])||(r[t]=0),o?(i.get(o.id)||(_d(t)?r[t]+=o[t]+o.width/2:r[t]+=o[t]+o.height/2),s?("x"===t?/left/.test(s)?r[t]-=o.width/2:/right/.test(s)&&(r[t]+=o.width/2):/top/.test(s)?r[t]-=o.height/2:/bottom/.test(s)&&(r[t]+=o.height/2),r[t]):r[t]):r[t])}(t,i,e);a&&(n.offset=a);var s=function(e,t){var i=e.context,n=i.createConstraints,o=i.resizeConstraints||{},a=i.gridSnappingContext,s=a.snapConstraints;if(s&&s[t])return s[t];s||(s=a.snapConstraints={}),s[t]||(s[t]={});var r=i.direction;n&&(_d(t)?(s.x.min=n.left,s.x.max=n.right):(s.y.min=n.top,s.y.max=n.bottom));var l=o.min,c=o.max;return l&&(_d(t)?Ed(r)?s.x.max=l.left:s.x.min=l.right:Cd(r)?s.y.max=l.top:s.y.min=l.bottom),c&&(_d(t)?Ed(r)?s.x.min=c.left:s.x.max=c.right:Cd(r)?s.y.min=c.top:s.y.max=c.bottom),s[t]}(t,i);s&&Se(n,s),hl(t,i)||o.snapEvent(t,i,n)}))}}))}function _d(e){return"x"===e}function Cd(e){return-1!==e.indexOf("n")}function Ed(e){return-1!==e.indexOf("w")}function Sd(e,t){Ga.call(this,e),this._gridSnapping=t;var i=this;this.preExecute("shape.resize",(function(e){var t=e.context,n=(t.hints||{}).autoResize;if(n){var o=t.shape,a=t.newBounds;ie(n)?t.newBounds=i.snapComplex(a,n):t.newBounds=i.snapSimple(o,a)}}))}function kd(e,t){e.on(["spaceTool.move","spaceTool.end"],2e3,(function(e){var i,n=e.context;n.initialized&&("x"===n.axis?(i=t.snapValue(e.dx),e.x=e.x+i-e.dx,e.dx=i):(i=t.snapValue(e.dy),e.y=e.y+i-e.dy,e.dy=i))}))}wd.$inject=["eventBus"],$d.prototype.snapEvent=function(e,t,i){pl(e,t,this.snapValue(e[t],i))},$d.prototype.getGridSpacing=function(){return 10},$d.prototype.snapValue=function(e,t){var i,n,o=0;return t&&t.offset&&(o=t.offset),e=xd(e+=o,10),t&&t.min&&ee(i=t.min)&&(i=xd(i+o,10,"ceil"),e=Math.max(e,i)),t&&t.max&&ee(n=t.max)&&(n=xd(n+o,10,"floor"),e=Math.min(e,n)),e-o},$d.prototype.isActive=function(){return this.active},$d.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})},$d.prototype.toggleActive=function(){this.setActive(!this.active)},$d.$inject=["elementRegistry","eventBus","config.gridSnapping"],Sd.$inject=["eventBus","gridSnapping","modeling"],Nt()(Sd,Ga),Sd.prototype.snapSimple=function(e,t){var i=this._gridSnapping;return t.width=i.snapValue(t.width,{min:t.width}),t.height=i.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t},Sd.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e},Sd.prototype.snapHorizontally=function(e,t){var i=this._gridSnapping,n=/w/.test(t),o=/e/.test(t),a={};return a.width=i.snapValue(e.width,{min:e.width}),o&&(n?(a.x=i.snapValue(e.x,{max:e.x}),a.width+=i.snapValue(e.x-a.x,{min:e.x-a.x})):e.x=e.x+e.width-a.width),Se(e,a),e},Sd.prototype.snapVertically=function(e,t){var i=this._gridSnapping,n=/n/.test(t),o=/s/.test(t),a={};return a.height=i.snapValue(e.height,{min:e.height}),n&&(o?(a.y=i.snapValue(e.y,{max:e.y}),a.height+=i.snapValue(e.y-a.y,{min:e.y-a.y})):e.y=e.y+e.height-a.height),Se(e,a),e},kd.$inject=["eventBus","gridSnapping"];const Ad={__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",Sd],gridSnappingSpaceToolBehavior:["type",kd]}],__init__:["gridSnapping"],gridSnapping:["type",$d]};function Rd(e,t){e.on("autoPlace",2e3,(function(e){var i=e.source,n=vi(i),o=e.shape,a=hr(i,o);return["x","y"].forEach((function(e){var i={};a[e]!==n[e]&&(a[e]>n[e]?i.min=a[e]:i.max=a[e],wo(o,"bpmn:TextAnnotation")&&(function(e){return"x"===e}(e)?i.offset=-o.width/2:i.offset=-o.height/2),a[e]=t.snapValue(a[e],i))})),a}))}function Dd(e,t,i){t.on(["create.start","shape.move.start"],1750,(function(t){var n=t.context,o=n.shape,a=e.getRootElement();wo(o,"bpmn:Participant")&&wo(a,"bpmn:Process")&&a.children.length&&n.createConstraints&&(o.width=i.snapValue(o.width,{min:o.width}),o.height=i.snapValue(o.height,{min:o.height}))}))}function Pd(e,t,i){Ga.call(this,e),this._gridSnapping=t;var n=this;this.postExecuted(["connection.create","connection.layout"],3e3,(function(e){var t=e.context,o=t.connection,a=t.hints||{},s=o.waypoints;a.connectionStart||a.connectionEnd||!1===a.createElementsBehavior||function(e){return e.length>3}(s)&&i.updateWaypoints(o,n.snapMiddleSegments(s))}))}function Ld(e,t,i){var n=li(t,i),o={};return function(e){return"h"===e}(n)&&(o.y=e.snapValue(t.y)),function(e){return"v"===e}(n)&&(o.x=e.snapValue(t.x)),("x"in o||"y"in o)&&(t=Se({},t,o),i=Se({},i,o)),[t,i]}Rd.$inject=["eventBus","gridSnapping"],Dd.$inject=["canvas","eventBus","gridSnapping"],Pd.$inject=["eventBus","gridSnapping","modeling"],W()(Pd,Ga),Pd.prototype.snapMiddleSegments=function(e){var t,i=this._gridSnapping;e=e.slice();for(var n=1;n<e.length-2;n++)t=Ld(i,e[n],e[n+1]),e[n]=t[0],e[n+1]=t[1];return e};const Fd={__depends__:[Ad,{__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",Rd],gridSnappingCreateParticipantBehavior:["type",Dd],gridSnappingLayoutConnectionBehavior:["type",Pd]}],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",wd]};function Vd(e,t){this._interactionEvents=t;var i=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],(function(e){var t=e.element,n=e.gfx;return wo(t,"bpmn:Lane")?i.createParticipantHit(t,n):wo(t,"bpmn:Participant")?Io(t)?i.createParticipantHit(t,n):i.createDefaultHit(t,n):wo(t,"bpmn:SubProcess")?Io(t)?i.createSubProcessHit(t,n):i.createDefaultHit(t,n):void 0}))}Vd.$inject=["eventBus","interactionEvents"],Vd.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0},Vd.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:30,height:e.height}),!0},Vd.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:30}),!0};const Bd={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Vd]};function Id(e){e.invoke(_s,this)}W()(Id,_s),Id.$inject=["injector"],Id.prototype.registerBindings=function(e,t){function i(i,n){t.isRegistered(i)&&e.addListener(n)}_s.prototype.registerBindings.call(this,e,t),i("selectElements",(function(i){var n=i.keyEvent;if(e.isKey(["a","A"],n)&&e.isCmd(n))return t.trigger("selectElements"),!0})),i("find",(function(i){var n=i.keyEvent;if(e.isKey(["f","F"],n)&&e.isCmd(n))return t.trigger("find"),!0})),i("spaceTool",(function(i){var n=i.keyEvent;if(!e.hasModifier(n))return e.isKey(["s","S"],n)?(t.trigger("spaceTool"),!0):void 0})),i("lassoTool",(function(i){var n=i.keyEvent;if(!e.hasModifier(n))return e.isKey(["l","L"],n)?(t.trigger("lassoTool"),!0):void 0})),i("handTool",(function(i){var n=i.keyEvent;if(!e.hasModifier(n))return e.isKey(["h","H"],n)?(t.trigger("handTool"),!0):void 0})),i("globalConnectTool",(function(i){var n=i.keyEvent;if(!e.hasModifier(n))return e.isKey(["c","C"],n)?(t.trigger("globalConnectTool"),!0):void 0})),i("directEditing",(function(i){var n=i.keyEvent;if(!e.hasModifier(n))return e.isKey(["e","E"],n)?(t.trigger("directEditing"),!0):void 0}))};const Td={__depends__:[Cs],__init__:["keyboardBindings"],keyboardBindings:["type",Id]};var jd={moveSpeed:1,moveSpeedAccelerated:10},Od="left",Md="right",Nd="down",Wd={ArrowLeft:Od,Left:Od,ArrowUp:"up",Up:"up",ArrowRight:Md,Right:Md,ArrowDown:Nd,Down:Nd},zd={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Ud(e,t,i,n,o){var a=this;this._config=Se({},jd,e||{}),t.addListener(1500,(function(e){var i=e.keyEvent,n=Wd[i.key];if(n&&!t.isCmd(i)){var o=t.isShift(i);return a.moveSelection(n,o),!0}})),this.moveSelection=function(e,t){var a=o.get();if(a.length){var s=this._config[t?"moveSpeedAccelerated":"moveSpeed"],r=zd[e](s);n.allowed("elements.move",{shapes:a})&&i.moveElements(a,r)}}}Ud.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const Hd={__depends__:[Cs,Ta],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Ud]};function qd(e,t,i,n){this._dragging=n,this._rules=t;var o=this;e.on("resize.start",(function(e){var t,i,n;i=(t=e.context).resizeConstraints,n=t.minBounds,void 0===i&&(void 0===n&&(n=o.computeMinResizeBox(t)),t.resizeConstraints={min:fi(n)})})),e.on("resize.move",(function(e){var t={x:e.dx,y:e.dy};!function(e,t){var i,n=e.shape,a=e.direction,s=e.resizeConstraints;e.delta=t,i=function(e,t,i){var n=i.x,o=i.y,a={x:e.x,y:e.y,width:e.width,height:e.height};return-1!==t.indexOf("n")?(a.y=e.y+o,a.height=e.height-o):-1!==t.indexOf("s")&&(a.height=e.height+o),-1!==t.indexOf("e")?a.width=e.width+n:-1!==t.indexOf("w")&&(a.x=e.x+n,a.width=e.width-n),a}(n,a,t),e.newBounds=function(e,t){if(!t)return e;var i=fi(e);return gi({top:Kc("top",i,t),right:Kc("right",i,t),bottom:Kc("bottom",i,t),left:Kc("left",i,t)})}(i,s),e.canExecute=o.canResize(e)}(e.context,t)})),e.on("resize.end",(function(e){!function(e){var t=e.shape,n=e.canExecute,o=e.newBounds;if(n){if(!function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(t,o=pi(o)))return;i.resizeShape(t,o)}}(e.context)}))}function Gd(e,t){var i=vi(e),n=fi(e),o={x:i.x,y:i.y};return-1!==t.indexOf("n")?o.y=n.top:-1!==t.indexOf("s")&&(o.y=n.bottom),-1!==t.indexOf("e")?o.x=n.right:-1!==t.indexOf("w")&&(o.x=n.left),o}function Yd(e){return"n"===e||"s"===e?"resize-ns":"e"===e||"w"===e?"resize-ew":"nw"===e||"se"===e?"resize-nwse":"resize-nesw"}qd.prototype.canResize=function(e){var t=this._rules,i=ke(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",i)},qd.prototype.activate=function(e,t,i){var n,o,a=this._dragging;if("string"==typeof i&&(i={direction:i}),!(o=(n=Se({shape:t},i)).direction))throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");a.init(e,Gd(t,o),"resize",{autoActivate:!0,cursor:Yd(o),data:{shape:t,context:n}})},qd.prototype.computeMinResizeBox=function(e){var t,i,n,o,a,s,r,l=e.shape;return t=e.direction,i=l,n=e.minDimensions||{width:10,height:10},o=Jc(l,e.childrenBoxPadding),a=fi(i),s={top:/n/.test(t)?a.bottom-n.height:a.top,left:/w/.test(t)?a.right-n.width:a.left,bottom:/s/.test(t)?a.top+n.height:a.bottom,right:/e/.test(t)?a.left+n.width:a.right},r=o?fi(o):s,gi({top:Gc(s.top,r.top),left:Gc(s.left,r.left),bottom:qc(s.bottom,r.bottom),right:qc(s.right,r.right)})},qd.$inject=["eventBus","rules","modeling","dragging"];var Zd="djs-resizing",Kd="resize-not-ok";function Xd(e,t,i){e.on("resize.move",500,(function(e){var n,o,a,s;o=(n=e.context).shape,a=n.newBounds,(s=n.frame)||(s=n.frame=i.addFrame(o,t.getActiveLayer()),t.addMarker(o,Zd)),a.width>5&&at(s,{x:a.x,width:a.width}),a.height>5&&at(s,{y:a.y,height:a.height}),n.canExecute?dt(s).remove(Kd):dt(s).add(Kd)})),e.on("resize.cleanup",(function(e){var i,n;n=(i=e.context).shape,i.frame&&ht(i.frame),t.removeMarker(n,Zd)}))}Xd.$inject=["eventBus","canvas","previewSupport"];var Qd=["n","w","s","e","nw","ne","se","sw"];function Jd(e,t,i,n){this._resize=n,this._canvas=t;var o=this;e.on("selection.changed",(function(e){var t=e.newSelection;o.removeResizers(),1===t.length&&se(t,Ce(o.addResizer,o))})),e.on("shape.changed",(function(e){var t=e.element;i.isSelected(t)&&(o.removeResizers(),o.addResizer(t))}))}Jd.prototype.makeDraggable=function(e,t,i){var n=this._resize;function o(t){$a(t)&&n.activate(t,e,i)}He.bind(t,"mousedown",o),He.bind(t,"touchstart",o)},Jd.prototype._createResizer=function(e,t,i,n){var o=this._getResizersParent(),a=function(e){var t={x:0,y:0};return-1!==e.indexOf("e")?t.x=6:-1!==e.indexOf("w")&&(t.x=-6),-1!==e.indexOf("s")?t.y=6:-1!==e.indexOf("n")&&(t.y=-6),t}(n),s=bt("g");dt(s).add("djs-resizer"),dt(s).add("djs-resizer-"+e.id),dt(s).add("djs-resizer-"+n),it(o,s);var r=bt("rect");at(r,{x:-2+a.x,y:-2+a.y,width:4,height:4}),dt(r).add("djs-resizer-visual"),it(s,r);var l=bt("rect");return at(l,{x:-10+a.x,y:-10+a.y,width:20,height:20}),dt(l).add("djs-resizer-hit"),it(s,l),qi(s,t,i),s},Jd.prototype.createResizer=function(e,t){var i=Gd(e,t),n=this._createResizer(e,i.x,i.y,t);this.makeDraggable(e,n,t)},Jd.prototype.addResizer=function(e){var t=this;this._resize.canResize({shape:e})&&se(Qd,(function(i){t.createResizer(e,i)}))},Jd.prototype.removeResizers=function(){pt(this._getResizersParent())},Jd.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},Jd.$inject=["eventBus","canvas","selection","resize"];const eu={__depends__:[Lr,Ar,Ml],__init__:["resize","resizePreview","resizeHandles"],resize:["type",qd],resizePreview:["type",Xd],resizeHandles:["type",Jd]};function tu(e,t){var i=t.create("bpmn:CategoryValue"),n=t.create("bpmn:Category",{categoryValue:[i]});return oi(e.get("rootElements"),n),$o(n).$parent=e,$o(i).$parent=n,i}function iu(e,t,i,n,o,a,s){function r(e,t){(t||xo(e,["bpmn:Task","bpmn:TextAnnotation"])||nu(e))&&n.activate(e)}this._bpmnFactory=t,this._canvas=i,this._modeling=o,this._textRenderer=s,n.registerProvider(this),e.on("element.dblclick",(function(e){r(e.element,!0)})),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set"],(function(e){n.isActive()&&n.complete()})),e.on(["commandStack.changed"],(function(e){n.isActive()&&n.cancel()})),e.on("directEditing.activate",(function(e){a.removeResizers()})),e.on("create.end",500,(function(e){var t=e.context,i=t.shape,n=e.context.canExecute;e.isTouch||n&&(t.hints&&!1===t.hints.createElementsBehavior||r(i))})),e.on("autoPlace.end",500,(function(e){r(e.shape)}))}function nu(e){return wo(e,"bpmn:SubProcess")&&!Io(e)}iu.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],iu.prototype.activate=function(e){var t=Mo(e);if(void 0!==t){var i={text:t};Se(i,this.getEditingBBox(e));var n={};return(xo(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||nu(e))&&Se(n,{centerVertically:!0}),la(e)&&Se(n,{autoResize:!0}),wo(e,"bpmn:TextAnnotation")&&Se(n,{resizable:!0,autoResize:!0}),Se(i,{options:n}),i}},iu.prototype.getEditingBBox=function(e){var t=this._canvas,i=e.label||e,n=t.getAbsoluteBBox(i),o=n.x+n.width/2,a=n.y+n.height/2,s={x:n.x,y:n.y},r=t.zoom(),l=this._textRenderer.getDefaultStyle(),c=this._textRenderer.getExternalStyle(),d=c.fontSize*r,u=c.lineHeight,h=l.fontSize*r,p=l.lineHeight,m={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(wo(e,"bpmn:Lane")||function(e){return wo(e,"bpmn:Participant")&&Io(e)}(e))&&(Se(s,{width:n.height,height:30*r,x:n.x-n.height/2+15*r,y:a-30*r/2}),Se(m,{fontSize:h+"px",lineHeight:p,paddingTop:7*r+"px",paddingBottom:7*r+"px",paddingLeft:5*r+"px",paddingRight:5*r+"px",transform:"rotate(-90deg)"})),(xo(e,["bpmn:Task","bpmn:CallActivity"])||function(e){return wo(e,"bpmn:Participant")&&!Io(e)}(e)||nu(e))&&(Se(s,{width:n.width,height:n.height}),Se(m,{fontSize:h+"px",lineHeight:p,paddingTop:7*r+"px",paddingBottom:7*r+"px",paddingLeft:5*r+"px",paddingRight:5*r+"px"})),function(e){return wo(e,"bpmn:SubProcess")&&Io(e)}(e)&&(Se(s,{width:n.width,x:n.x}),Se(m,{fontSize:h+"px",lineHeight:p,paddingTop:7*r+"px",paddingBottom:7*r+"px",paddingLeft:5*r+"px",paddingRight:5*r+"px"}));var f=90*r,g=7*r,v=4*r;if(i.labelTarget&&(Se(s,{width:f,height:n.height+g+v,x:o-f/2,y:n.y-g}),Se(m,{fontSize:d+"px",lineHeight:u,paddingTop:g+"px",paddingBottom:v+"px"})),la(i)&&!ca(i)&&!ua(i)){var b=da(e),y=t.getAbsoluteBBox({x:b.x,y:b.y,width:0,height:0}),w=d+g+v;Se(s,{width:f,height:w,x:y.x-f/2,y:y.y-w/2}),Se(m,{fontSize:d+"px",lineHeight:u,paddingTop:g+"px",paddingBottom:v+"px"})}return wo(e,"bpmn:TextAnnotation")&&(Se(s,{width:n.width,height:n.height,minWidth:30*r,minHeight:10*r}),Se(m,{textAlign:"left",paddingTop:5*r+"px",paddingBottom:7*r+"px",paddingLeft:7*r+"px",paddingRight:5*r+"px",fontSize:h+"px",lineHeight:p})),{bounds:s,style:m}},iu.prototype.update=function(e,t,i,n){var o,a,s;if(wo(e,"bpmn:TextAnnotation")&&(a=this._canvas.getAbsoluteBBox(e),o={x:e.x,y:e.y,width:e.width/a.width*n.width,height:e.height/a.height*n.height}),wo(e,"bpmn:Group")&&!$o(e).categoryValueRef){var r=tu($o(this._canvas.getRootElement()).$parent,this._bpmnFactory);$o(e).categoryValueRef=r}(s=t)&&s.trim()||(t=null),this._modeling.updateLabel(e,t,o)};var ou="djs-element-hidden",au="djs-label-hidden";function su(e,t,i,n){var o,a,s,r=this,l=t.getDefaultLayer();e.on("directEditing.activate",(function(e){var i=e.active;if(wo(o=i.element.label||i.element,"bpmn:TextAnnotation")){a=t.getAbsoluteBBox(o),s=bt("g");var c=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),d=r.path=bt("path");at(d,{d:c,strokeWidth:2,stroke:ru(o)}),it(s,d),it(l,s),Gi(s,o.x,o.y)}wo(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,ou):(wo(o,"bpmn:Task")||wo(o,"bpmn:CallActivity")||wo(o,"bpmn:SubProcess")||wo(o,"bpmn:Participant"))&&t.addMarker(o,au)})),e.on("directEditing.resize",(function(e){if(wo(o,"bpmn:TextAnnotation")){var t=e.height,i=e.dy,s=Math.max(o.height/a.height*(t+i),0),l=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:s,position:{mx:0,my:0}});at(r.path,{d:l})}})),e.on(["directEditing.complete","directEditing.cancel"],(function(e){var i=e.active;i&&(t.removeMarker(i.element.label||i.element,ou),t.removeMarker(o,au)),o=void 0,a=void 0,s&&(ht(s),s=void 0)}))}function ru(e,t){return _o(e).get("stroke")||t||"black"}su.$inject=["eventBus","canvas","elementRegistry","pathMap"];const lu={__depends__:[qa,eu,Fl],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",iu],labelEditingPreview:["type",su]};var cu=["top","bottom","left","right"];function du(e,t){function i(e){if(ca(e)){var i=function(e){var t=vi(e.label),i=uu(vi(e),t);if(n=i,-1!==cu.indexOf(n)){var n,o=function(e){var t=vi(e);return[].concat(e.incoming.map((function(e){return e.waypoints[e.waypoints.length-2]})),e.outgoing.map((function(e){return e.waypoints[1]}))).map((function(e){return uu(t,e)}))}(e);if(e.host){var a=function(e){var t,i=e.host,n=bi(vi(e),i);return t=n.indexOf("-")>=0?n.split("-"):[n],cu.filter((function(e){return-1===t.indexOf(e)}))}(e);o=o.concat(a)}var s=cu.filter((function(e){return-1===o.indexOf(e)}));if(-1===s.indexOf(i))return s[0]}}(e);i&&function(e,i){var n=vi(e),o=e.label,a=vi(o);if(o.parent){var s,r=fi(e);switch(i){case"top":s={x:n.x,y:r.top-10-o.height/2};break;case"left":s={x:r.left-10-o.width/2,y:n.y};break;case"bottom":s={x:n.x,y:r.bottom+10+o.height/2};break;case"right":s={x:r.right+10+o.width/2,y:n.y}}var l=Fs(s,a);t.moveShape(o,l)}}(e,i)}}Ga.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],(function(e){var t=e.context,n=t.connection,o=n.source,a=n.target;!1!==(t.hints||{}).createElementsBehavior&&(i(o),i(a))})),this.postExecuted(["label.create"],(function(e){var t=e.context,n=t.shape;!1!==(t.hints||{}).createElementsBehavior&&i(n.labelTarget)})),this.postExecuted(["elements.create"],(function(e){var t=e.context,n=t.elements;!1!==(t.hints||{}).createElementsBehavior&&n.forEach((function(e){i(e)}))}))}function uu(e,t){return bi(t,e,5)}function hu(e,t,i){Ga.call(this,e),this.preExecute("shape.append",(function(e){var t=e.source,i=e.shape;e.position||(wo(i,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-i.height/2}:e.position={x:t.x+t.width+80+i.width/2,y:t.y+t.height/2})}),!0)}function pu(e,t){e.invoke(Ga,this),this.postExecute("shape.move",(function(e){var i=e.newParent,n=e.shape;se(ae(n.incoming.concat(n.outgoing),(function(e){return wo(e,"bpmn:Association")})),(function(e){t.moveConnection(e,{x:0,y:0},i)}))}),!0)}function mu(e,t){t.invoke(Ga,this),this._bpmnReplace=e;var i=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;1===(t=t.filter((function(e){return fu(e,e.host)}))).length&&t.map((function(e){return t.indexOf(e)})).forEach((function(n){var o=t[n];e.elements[n]=i.replaceShape(t[n],o)}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,n=e.newHost;if(1===t.length){var o=t[0];fu(o,n)&&(e.shapes=[i.replaceShape(o,n)])}}),!0)}function fu(e,t){return!ua(e)&&xo(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function gu(e,t,i){function n(e){return ae(e.attachers,(function(e){return wo(e,"bpmn:BoundaryEvent")}))}Ga.call(this,e),this.postExecute("connection.create",(function(e){var t=e.context.source,o=e.context.target,a=n(o);wo(t,"bpmn:EventBasedGateway")&&wo(o,"bpmn:ReceiveTask")&&a.length>0&&i.removeElements(a)})),this.postExecute("connection.reconnect",(function(e){var t=e.context.oldSource,o=e.context.newSource;wo(t,"bpmn:Gateway")&&wo(o,"bpmn:EventBasedGateway")&&se(o.outgoing,(function(e){var t=e.target,o=n(t);wo(t,"bpmn:ReceiveTask")&&o.length>0&&i.removeElements(o)}))})),e.on("moddleCopy.canCopyProperty",2e3,(function(e){var i=e.parent,n=e.property,o=e.propertyName,a=t.getPropertyDescriptor(i,o);a&&a.isReference&&wo(n,"bpmn:RootElement")&&i.set(o,n)}))}function vu(e){e.invoke(Ga,this),this.preExecute("shape.create",1500,(function(e){var t=e.context,i=t.parent,n=t.shape;wo(i,"bpmn:Lane")&&!wo(n,"bpmn:Lane")&&(t.parent=Hc(i,"bpmn:Participant"))}))}function bu(e,t,i){Ga.call(this,e),this.preExecute("shape.create",(function(e){var i=e.context.shape;if(wo(i,"bpmn:DataObjectReference")&&"label"!==i.type){var n=t.create("bpmn:DataObject");i.businessObject.dataObjectRef=n}}))}W()(du,Ga),du.$inject=["eventBus","modeling"],W()(hu,Ga),hu.$inject=["eventBus","elementFactory","bpmnRules"],W()(pu,Ga),pu.$inject=["injector","modeling"],mu.$inject=["bpmnReplace","injector"],W()(mu,Ga),mu.prototype.replaceShape=function(e,t){var i,n=(i=$o(e).eventDefinitions)&&i[0],o={type:"bpmn:BoundaryEvent",host:t};return n&&(o.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,o,{layoutConnection:!1})},gu.$inject=["eventBus","moddle","modeling"],W()(gu,Ga),vu.$inject=["injector"],W()(vu,Ga),bu.$inject=["eventBus","bpmnFactory","moddle"],W()(bu,Ga);var yu=2e3;function wu(e,t,i){function n(){var t=e.getRootElement();return wo(t,"bpmn:Collaboration")?t:i.makeCollaboration()}Ga.call(this,t),t.on(["create.start","shape.move.start"],yu,(function(t){var i=t.context,n=i.shape,o=e.getRootElement();if(wo(n,"bpmn:Participant")&&wo(o,"bpmn:Process")&&o.children.length){var a=o.children.filter((function(e){return!wo(e,"bpmn:Group")&&!ua(e)&&!function(e){return!!e.waypoints}(e)}));if(a.length){var s=Xt(a),r=function(e,t){t={width:t.width+40+30,height:t.height+40};var i=Math.max(e.width,t.width),n=Math.max(e.height,t.height);return{x:-i/2,y:-n/2,width:i,height:n}}(n,s);Se(n,r),i.createConstraints=function(e,t){return{bottom:(t=fi(t)).top+e.height/2-20,left:t.right-e.width/2+20,top:t.bottom-e.height/2+20,right:t.left+e.width/2-20-30}}(n,s)}}})),t.on("create.start",yu,(function(i){var n=i.context.shape,o=e.getRootElement(),a=e.getGraphics(o);function s(e){e.element=o,e.gfx=a}wo(n,"bpmn:Participant")&&wo(o,"bpmn:Process")&&(t.on("element.hover",yu,s),t.once("create.cleanup",(function(){t.off("element.hover",s)})))})),this.preExecute("elements.create",yu,(function(e){var t,i=e.elements,o=e.parent,a=function(e){return oe(e,(function(e){return wo(e,"bpmn:Participant")}))}(i);a&&wo(o,"bpmn:Process")&&(e.parent=n(),(t=e.hints=e.hints||{}).participant=a,t.process=o,t.processRef=$o(a).get("processRef"))}),!0),this.preExecute("shape.create",(function(e){var t=e.parent,i=e.shape;wo(i,"bpmn:Participant")&&wo(t,"bpmn:Process")&&(e.parent=n(),e.process=t,e.processRef=$o(i).get("processRef"))}),!0),this.execute("shape.create",(function(e){var t=e.hints||{},i=e.process||t.process,n=e.shape,o=t.participant;!i||o&&n!==o||$o(n).set("processRef",$o(i))}),!0),this.revert("shape.create",(function(e){var t=e.hints||{},i=e.process||t.process,n=e.processRef||t.processRef,o=e.shape,a=t.participant;!i||a&&o!==a||$o(o).set("processRef",n)}),!0),this.postExecute("shape.create",(function(e){var t=e.hints||{},n=e.process||e.hints.process,o=e.shape,a=t.participant;if(n){var s=n.children.slice();a?o===a&&i.moveElements(s,{x:0,y:0},a):i.moveElements(s,{x:0,y:0},o)}}),!0)}wu.$inject=["canvas","eventBus","modeling"],W()(wu,Ga);var xu="__targetRef_placeholder";function $u(e,t){function i(e,i){var n=e.get("properties"),o=oe(n,(function(e){return e.name===xu}));return!o&&i&&oi(n,o=t.create("bpmn:Property",{name:xu})),o}function n(e,t){var n=i(e);n&&(function(e,t,i){return oe(e.get("dataInputAssociations"),(function(e){return e!==i&&e.targetRef===t}))}(e,n,t)||ni(e.get("properties"),n))}function o(e){var t,o=e.context,a=o.connection,s=a.businessObject,r=a.target,l=r&&r.businessObject,c=o.newTarget,d=c&&c.businessObject,u=o.oldTarget||o.target,h=u&&u.businessObject,p=a.businessObject;h&&h!==l&&n(h,s),d&&d!==l&&n(d,s),l?(t=i(l,!0),p.targetRef=t):p.targetRef=null}Ga.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],_u(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],_u(o))}function _u(e){return function(t){if(wo(t.context.connection,"bpmn:DataInputAssociation"))return e(t)}}function Cu(e){this._bpmnUpdater=e}function Eu(e,t,i,n){function o(e){return e.children.filter((function(e){return wo(e,"bpmn:DataStoreReference")&&!e.labelTarget}))}function a(e,n){var o=e.businessObject||e;if(n=n||i.filter((function(e){return wo(e,"bpmn:Participant")&&$o(e).processRef}))[0]){var a=n.businessObject||n;t.execute("dataStore.updateContainment",{dataStoreBo:o,dataStoreDi:_o(e),newSemanticParent:a.processRef||a,newDiParent:_o(n)})}}Ga.call(this,n),t.registerHandler("dataStore.updateContainment",Cu),this.preExecute("shape.create",(function(e){var t=e.context,i=t.shape;wo(i,"bpmn:DataStoreReference")&&"label"!==i.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)})),this.preExecute("elements.move",(function(e){var t=e.context,i=t.shapes;i.filter((function(e){return wo(e,"bpmn:DataStoreReference")})).length&&(t.hints||(t.hints={}),t.hints.autoResize=i.filter((function(e){return!wo(e,"bpmn:DataStoreReference")})))})),this.postExecute("shape.create",(function(e){var t=e.context.shape,i=t.parent;wo(t,"bpmn:DataStoreReference")&&"label"!==t.type&&wo(i,"bpmn:Collaboration")&&a(t)})),this.postExecute("shape.move",(function(e){var t=e.context,i=t.shape,n=t.oldParent,o=i.parent;wo(n,"bpmn:Collaboration")||wo(i,"bpmn:DataStoreReference")&&"label"!==i.type&&wo(o,"bpmn:Collaboration")&&a(i,wo(n,"bpmn:Participant")?n:function(e,t){for(;e.parent;){if(wo(e.parent,"bpmn:Participant"))return e.parent;e=e.parent}}(n))})),this.postExecute("shape.delete",(function(t){var i=t.context.shape,n=e.getRootElement();xo(i,["bpmn:Participant","bpmn:SubProcess"])&&wo(n,"bpmn:Collaboration")&&o(n).filter((function(e){return function(e,t){for(var i=e.businessObject||e,n=t.businessObject||t;i.$parent;){if(i.$parent===n.processRef||n)return!0;i=i.$parent}return!1}(e,i)})).forEach((function(e){a(e)}))})),this.postExecute("canvas.updateRoot",(function(e){var t=e.context,i=t.oldRoot,n=t.newRoot;o(i).forEach((function(e){wo(n,"bpmn:Process")&&a(e,n)}))}))}function Su(e,t,i){Ga.call(this,e),this.postExecuted("shape.delete",500,(function(e){var t=e.context,n=t.hints,o=t.shape,a=t.oldParent;wo(o,"bpmn:Lane")&&(n&&n.nested||function(e,t){var n,o,a,s=od(t),r=[],l=[];Zt(s,(function(t){return t.y>e.y?l.push(t):r.push(t),t.children})),s.length&&(n=l.length&&r.length?e.height/2:e.height,r.length&&(o=i.calculateAdjustments(r,"y",n,e.y-10),i.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:n},"s")),l.length&&(a=i.calculateAdjustments(l,"y",-n,e.y+e.height+10),i.makeSpace(a.movingShapes,a.resizingShapes,{x:0,y:-n},"n")))}(o,a))}))}function ku(e,t){t.invoke(Ga,this),this._bpmnReplace=e;var i=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;t.filter((function(e){return Au(e,e.host)})).map((function(e){return t.indexOf(e)})).forEach((function(n){e.elements[n]=i.replaceShape(t[n])}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,n=e.newHost;t.forEach((function(e,o){var a,s=e.host;Au(e,(a=s,-1!==t.indexOf(a)?s:n))&&(t[o]=i.replaceShape(e))}))}),!0)}function Au(e,t){return!ua(e)&&wo(e,"bpmn:BoundaryEvent")&&!t}function Ru(e,t,i){function n(e,n,o){var a,s,r,l,c,d,u,h,p=n.waypoints,m=e.outgoing.slice(),f=e.incoming.slice(),g=Br(p,h=ee(o.width)?vi(o):o);if(g){if(a=p.slice(0,g.index),s=p.slice(g.index+(g.bendpoint?1:0)),!a.length||!s.length)return;r=g.bendpoint?p[g.index]:h,1!==a.length&&Du(e,a[a.length-1])||a.push(Pu(r)),1!==s.length&&Du(e,s[0])||s.unshift(Pu(r))}l=n.source,c=n.target,t.canConnect(l,e,n)&&(i.reconnectEnd(n,e,a||h),d=n),t.canConnect(e,c,n)&&(d?u=i.connect(e,c,{type:n.type,waypoints:s}):(i.reconnectStart(n,e,s||h),u=n));var v=[].concat(d&&ae(f,(function(e){return e.source===d.source}))||[],u&&ae(m,(function(e){return e.target===u.target}))||[]);v.length&&i.removeElements(v)}Ga.call(this,e),this.preExecute("elements.move",(function(e){var i=e.newParent,n=e.shapes,o=e.delta,a=n[0];if(a&&i){i&&i.waypoints&&(e.newParent=i=i.parent);var s=vi(a),r={x:s.x+o.x,y:s.y+o.y},l=oe(i.children,(function(e){return t.canInsert(n,e)&&Br(e.waypoints,r)}));l&&(e.targetFlow=l,e.position=r)}}),!0),this.postExecuted("elements.move",(function(e){var t=e.shapes,i=e.targetFlow,o=e.position;i&&n(t[0],i,o)}),!0),this.preExecute("shape.create",(function(e){var i=e.parent,n=e.shape;t.canInsert(n,i)&&(e.targetFlow=i,e.parent=i.parent)}),!0),this.postExecuted("shape.create",(function(e){var t=e.shape,i=e.targetFlow,o=e.position;i&&n(t,i,o)}),!0)}function Du(e,t){var i=t.x,n=t.y;return i>=e.x&&i<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Pu(e){return Se({},e)}function Lu(e,t){Ga.call(this,e),this.preExecuted("connection.create",(function(e){var i=e.context,n=i.source,o=i.target,a=o.incoming.slice();i.hints&&!1===i.hints.createElementsBehavior||wo(n,"bpmn:EventBasedGateway")&&o.incoming.length&&a.filter(Fu).forEach((function(e){t.removeConnection(e)}))})),this.preExecuted("shape.replace",(function(e){var i=e.context.newShape;wo(i,"bpmn:EventBasedGateway")&&i.outgoing.filter(Fu).map((function(e){return e.target})).reduce((function(e,t){var i=t.incoming.filter(Fu);return e.concat(i)}),[]).forEach((function(e){e.source!==i&&t.removeConnection(e)}))}))}function Fu(e){return wo(e,"bpmn:SequenceFlow")}$u.$inject=["eventBus","bpmnFactory"],W()($u,Ga),Cu.$inject=["bpmnUpdater"],Cu.prototype.execute=function(e){var t=e.dataStoreBo,i=e.dataStoreDi,n=e.newSemanticParent,o=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=i.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(i,o)},Cu.prototype.revert=function(e){var t=e.dataStoreBo,i=e.dataStoreDi,n=e.oldSemanticParent,o=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(i,o)},Eu.$inject=["canvas","commandStack","elementRegistry","eventBus"],W()(Eu,Ga),Su.$inject=["eventBus","modeling","spaceTool"],W()(Su,Ga),ku.$inject=["bpmnReplace","injector"],W()(ku,Ga),ku.prototype.replaceShape=function(e){var t,i,n=(i=$o(e).eventDefinitions)&&i[0];return t=n?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:n.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,t,{layoutConnection:!1})},W()(Ru,Ga),Ru.$inject=["eventBus","bpmnRules","modeling"],Lu.$inject=["eventBus","modeling"],W()(Lu,Ga);var Vu=1500;function Bu(e,t,i){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Vu,(function(t){var n=t.context.shape||t.shape,o=t.hover;wo(o,"bpmn:Lane")&&!xo(n,["bpmn:Lane","bpmn:Participant"])&&(t.hover=ad(o),t.hoverGfx=e.getGraphics(t.hover));var a=i.getRootElement();o!==a&&(n.labelTarget||wo(n,"bpmn:Group"))&&(t.hover=a,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Vu,(function(t){var i=t.hover;wo(i,"bpmn:Lane")&&(t.hover=ad(i)||i,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["bendpoint.move.hover"],Vu,(function(t){var i=t.context,n=t.hover,o=i.type;wo(n,"bpmn:Lane")&&/reconnect/.test(o)&&(t.hover=ad(n)||n,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.start"],Vu,(function(e){var t=e.context,i=t.start;wo(i,"bpmn:Lane")&&(t.start=ad(i)||i)})),t.on("shape.move.start",2e3,(function(e){var t=e.shape;wo(t,"bpmn:Lane")&&(e.shape=ad(t)||t)}))}function Iu(e,t,i,n,o,a){function s(e){var i=$o(e).categoryValueRef;if(i){var n=i.$parent;i&&(ni(n.categoryValue,i),n&&!n.categoryValue.length&&function(e){ni(t.getDefinitions().get("rootElements"),e)}(n))}}o.invoke(Ga,this),this.executed("shape.delete",(function(e){var t,n=e.context.shape;if(wo(n,"bpmn:Group")){var o=$o(n).categoryValueRef,a=i.filter((function(e){return wo(e,"bpmn:Group")}));t=o,a.some((function(e){var i=$o(e);return i.categoryValueRef&&i.categoryValueRef===t}))||s(n)}})),this.reverted("shape.delete",(function(e){var i=e.context.shape;if(wo(i,"bpmn:Group")){var n=$o(i).categoryValueRef,o=t.getDefinitions(),a=n?n.$parent:null;oi(a.get("categoryValue"),n),oi(o.get("rootElements"),a)}})),this.execute("shape.create",(function(i){var n=$o(i.context.shape);if(wo(n,"bpmn:Group")&&!n.categoryValueRef){var o=tu(t.getDefinitions(),e);n.categoryValueRef=o}})),this.revert("shape.create",(function(e){var t=e.context.shape;wo(t,"bpmn:Group")&&(s(t),delete $o(t).categoryValueRef)})),n.on("moddleCopy.canCopyProperty",2e3,(function(i){var n,o=i.property;if(wo(o,"bpmn:CategoryValue"))return n=tu(t.getDefinitions(),e),a.copyElement(o,n)}))}function Tu(e,t,i,n){var o,a,s,r;return 0==(o=(n.y-i.y)*(t.x-e.x)-(n.x-i.x)*(t.y-e.y))?null:(a=e.y-i.y,s=e.x-i.x,r=((n.x-i.x)*a-(n.y-i.y)*s)/o,{x:Math.round(e.x+r*(t.x-e.x)),y:Math.round(e.y+r*(t.y-e.y))})}function ju(e){function t(e,t,i){var n,o={x:i.x,y:i.y-50},a={x:i.x-50,y:i.y},s=Tu(e,t,i,o),r=Tu(e,t,i,a);n=s&&r?Ou(s,i)>Ou(r,i)?r:s:s||r,e.original=n}e.on("bpmnElement.added",(function(e){var i,n,o=e.element;o.waypoints&&(t((n=(i=o).waypoints)[0],n[1],vi(i.source)),t(n[n.length-1],n[n.length-2],vi(i.target)))}))}function Ou(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Mu(e){Ga.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],(function(e){var i=e.context.shape,n=$o(i),o=_o(i);xo(n,t)&&!o.get("isHorizontal")&&o.set("isHorizontal",!0)}))}function Nu(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function Wu(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function zu(e,t){var i=t[0],n=t[1],o={x:n.x-i.x,y:n.y-i.y},a=function(e,t,i){var n=[{n:e[0]-i[0],lambda:t[0]},{n:e[1]-i[1],lambda:t[1]}];return-(n[0].n*t[0]+n[1].n*t[1])/(n[0].lambda*t[0]+n[1].lambda*t[1])}([i.x,i.y],[o.x,o.y],[e.x,e.y]);return{x:i.x+a*o.x,y:i.y+a*o.y}}function Uu(e,t){var i=zu(e,t);return Nu({x:i.x-e.x,y:i.y-e.y})}function Hu(e,t){return Nu({x:e.x-t.x,y:e.y-t.y})}Bu.$inject=["elementRegistry","eventBus","canvas"],Iu.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"],W()(Iu,Ga),ju.$inject=["eventBus"],Mu.$inject=["eventBus"],W()(Mu,Ga);var qu=Math.sqrt,Gu=Math.min,Yu=Math.max,Zu=Math.abs;function Ku(e){return Math.pow(e,2)}function Xu(e,t){return qu(Ku(e.x-t.x)+Ku(e.y-t.y))}function Qu(e,t,i,n){var o=t.x-e.x,a=t.y-e.y,s=i.x-e.x,r=i.y-e.y,l=o*o+a*a,c=(o*s+a*r)/l,d=c*c-(s*s+r*r-n*n)/l;if(d<0&&d>-1e-6&&(d=0),d<0)return[];var u=qu(d),h=-c+u,p=-c-u,m={x:e.x-o*h,y:e.y-a*h};return 0===d?[m]:[m,{x:e.x-o*p,y:e.y-a*p}].filter((function(i){return function(e,t,i){return Ju(e.x,t.x,i.x)&&Ju(e.y,t.y,i.y)}(i,e,t)}))}function Ju(e,t,i){return e>=Gu(t,i)-eh&&e<=Yu(t,i)+eh}var eh=.1;function th(e,t){return Zu(e.x-t.x)<=eh&&Zu(e.y-t.y)<=eh}function ih(e,t){var i=Hu(e[t-1],e[t]);return i/(i+Hu(e[t],e[t+1]))}function nh(e,t){return[e[t],e[t+1]]}function oh(e,t,i){var n=Ls(t),o=Ls(i),a=Fs(e,n),s=a.x*(i.width/t.width),r=a.y*(i.height/t.height);return mi({x:o.x+s,y:o.y+r})}function ah(e,t,i){var n=Ls(e),o=Ls(t),a=Ls(i),s=Fs(e,n),r=Fs(n,o),l=function(e,t,i){var n=fi(t),o=fi(i);if(function(e,t){return function(e,t){return e.right!==t.right&&e.left!==t.left}(e,t)||function(e,t){return e.top!==t.top&&e.bottom!==t.bottom}(e,t)}(n,o))return null;var a,s=bi(t,e);if("top"===s)a={x:0,y:o.bottom-n.bottom};else if("bottom"===s)a={x:0,y:o.top-n.top};else if("right"===s)a={x:o.left-n.left,y:0};else{if("left"!==s)return null;a={x:o.right-n.right,y:0}}return bi(i,{x:e.x+a.x,y:e.y+a.y})!==s?null:a}(n,t,i);if(l)return l;var c=r.x*(i.width/t.width),d=r.y*(i.height/t.height),u=a.x+c,h=a.y+d;return mi({x:u+s.x-e.x,y:h+s.y-e.y})}var sh={width:90,height:20};function rh(e,t,i,n){Ga.call(this,e),this.postExecute("element.updateProperties",(function(e){var i=e.context,o=i.element,a=i.properties;if("name"in a&&t.updateLabel(o,a.name),"text"in a&&wo(o,"bpmn:TextAnnotation")){var s=n.getTextAnnotationBounds({x:o.x,y:o.y,width:o.width,height:o.height},a.text||"");t.updateLabel(o,a.text,s)}})),this.postExecute(["shape.create","connection.create"],(function(e){var i=e.context;if(!1!==(i.hints||{}).createElementsBehavior){var o=i.shape||i.connection,a=o.businessObject;if(!ua(o)&&la(o)&&Mo(o)){var s=da(o),r=n.getExternalLabelBounds(sh,Mo(o));t.createLabel(o,s,{id:a.id+"_label",businessObject:a,width:r.width,height:r.height})}}})),this.postExecute("shape.delete",(function(e){var i=e.context,n=i.labelTarget,o=i.hints||{};n&&!1!==o.unsetLabel&&t.updateLabel(n,null,null,{removeShape:!1})})),this.postExecute(["label.create"],(function(e){var t,n=e.context,o=n.shape,a=n.labelTarget;a&&wo(a,"bpmn:BaseElement")&&((t=_o(a)).label||(t.label=i.create("bpmndi:BPMNLabel",{bounds:i.create("dc:Bounds")}),o.di=t),Se(t.label.bounds,{x:o.x,y:o.y,width:o.width,height:o.height}))})),this.postExecute(["connection.layout","connection.updateWaypoints"],(function(e){var i=e.context;if(!1!==(i.hints||{}).labelBehavior){var n,o=i.connection.label;o&&o.parent&&(n=function(e){var t=e.context,i=t.connection,n=i.label,o=Se({},t.hints),a=t.newWaypoints||i.waypoints,s=t.oldWaypoints;return void 0===o.startChanged&&(o.startChanged=!!o.connectionStart),void 0===o.endChanged&&(o.endChanged=!!o.connectionEnd),function(e,t,i,n){var o=0,a=0,s=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}(e),r=function(e,t){var i,n,o,a,s,r,l,c,d,u,h,p,m=0;for(m=0;m<t.length-1;m++){if(th(i=t[m],n=t[m+1])?r=[i]:(o=Xu(e,i),a=Xu(e,n),r=Qu(i,n,e,Gu(o,a))),r.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===r.length&&(l={type:"bendpoint",position:r[0],segmentIndex:m,bendpointIndex:th(i,r[0])?m:m+1}),2===r.length&&(h=r[0],p=r[1],l={type:"segment",position:s={x:(h.x+p.x)/2,y:(h.y+p.y)/2},segmentIndex:m,relativeLocation:Xu(i,s)/Xu(i,n)}),c=Xu(l.position,e),(!u||d>c)&&(u=l,d=c)}return u}(s,i),l=r.segmentIndex,c=function(e,t,i,n){var o=i.segmentIndex,a=t.length-e.length;if(n.segmentMove){var s=n.segmentMove.segmentStartIndex,r=n.segmentMove.newSegmentStartIndex;return o===s?r:o>=r?o+a<r?r:o+a:o}if(n.bendpointMove){var l,c=n.bendpointMove.insert,d=n.bendpointMove.bendpointIndex;return 0===a?o:(o>=d&&(l=c?o+1:o-1),o<d&&(l=o,c&&"bendpoint"!==i.type&&d-1===o&&ih(t,d)<i.relativeLocation&&l++),l)}return 0===a?o:n.connectionStart?0===o?0:null:n.connectionEnd&&o===e.length-2?t.length-2:null}(i,t,r,n);if(null===c)return{x:o,y:a};if(c<0||c>t.length-2)return{x:o,y:a};var d,u,h,p,m,f,g=nh(i,l),v=nh(t,c),b=r.position,y=(p=b,m=Hu((h=g)[0],h[1]),f=Hu(h[0],p),0===m?0:f/m),w=(d=v,u=Wu(g),Wu(d)-u);if("bendpoint"===r.type){var x=t.length-i.length,$=r.bendpointIndex,_=i[$];if(-1!==t.indexOf(_))return{x:o,y:a};if(0===x){var C=t[$];return{x:C.x-r.position.x,y:C.y-r.position.y}}x<0&&0!==$&&$<i.length-1&&(y=ih(i,$))}var E,S,k=(v[1].x-v[0].x)*y+v[0].x,A=(v[1].y-v[0].y)*y+v[0].y,R=(E={x:s.x-b.x,y:s.y-b.y},(S=w)?{x:Math.cos(S)*E.x-Math.sin(S)*E.y,y:Math.sin(S)*E.x+Math.cos(S)*E.y}:E);return mi({x:o=k+R.x-s.x,y:a=A+R.y-s.y})}(n,a,s,o)}(e),t.moveShape(o,n))}})),this.postExecute(["shape.replace"],(function(e){var t=e.context,i=t.newShape,n=t.oldShape,o=$o(i);o&&la(o)&&n.label&&i.label&&(i.label.x=n.label.x,i.label.y=n.label.y)})),this.postExecute("shape.resize",(function(e){var i,n=e.context,o=n.shape,a=n.newBounds,s=n.oldBounds;if(ca(o)){var r=o.label,l=function(e,t,i){return mi(Fs(oh(e,t,i),e))}(function(e,t){if(t.length){var i=function(e,t){return ve(t.map((function(t){return{line:t,distance:Uu(e,t)}})),"distance")[0].line}(e,t);return zu(e,i)}}(vi(r),[[{x:(i=s).x,y:i.y},{x:i.x+(i.width||0),y:i.y}],[{x:i.x+(i.width||0),y:i.y},{x:i.x+(i.width||0),y:i.y+(i.height||0)}],[{x:i.x,y:i.y+(i.height||0)},{x:i.x+(i.width||0),y:i.y+(i.height||0)}],[{x:i.x,y:i.y},{x:i.x,y:i.y+(i.height||0)}]]),s,a);t.moveShape(r,l)}}))}function lh(e,t,i){var n=ph(e),o=mh(n,t),a=n[0];return o.length?o[o.length-1]:oh(a.original||a,i,t)}function ch(e,t,i){var n=ph(e),o=mh(n,t),a=n[n.length-1];return o.length?o[0]:oh(a.original||a,i,t)}function dh(e,t,i){var n=ph(e),o=hh(t,i),a=n[0];return oh(a.original||a,o,t)}function uh(e,t,i){var n=ph(e),o=hh(t,i),a=n[n.length-1];return oh(a.original||a,o,t)}function hh(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function ph(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function mh(e,t){return ae(de(e,fh),(function(e){return function(e,t){return"intersect"===bi(t,e,1)}(e,t)}))}function fh(e){return e.original||e}function gh(e,t){Ga.call(this,e),this.postExecute("shape.replace",(function(e){var i=e.oldShape,n=e.newShape;if(function(e,t){return wo(e,"bpmn:Participant")&&Io(e)&&wo(t,"bpmn:Participant")&&!Io(t)}(i,n)){var o,a,s,r,l=(a=Kt([o=i],!1),s=[],r=[],a.forEach((function(e){e!==o&&(e.incoming.forEach((function(e){wo(e,"bpmn:MessageFlow")&&s.push(e)})),e.outgoing.forEach((function(e){wo(e,"bpmn:MessageFlow")&&r.push(e)})))}),[]),{incoming:s,outgoing:r});l.incoming.forEach((function(e){var o=ch(e,n,i);t.reconnectEnd(e,n,o)})),l.outgoing.forEach((function(e){var o=lh(e,n,i);t.reconnectStart(e,n,o)}))}}),!0)}function vh(e,t,i){e.on(["shape.move.rejected","create.rejected"],(function(e){var n,o,a=e.context,s=a.shape;wo(a.target,"bpmn:Collaboration")&&wo(s,"bpmn:FlowNode")&&(n=e,o=i("flow elements must be children of pools/participants"),t.add({position:{x:n.x+5,y:n.y+5},type:"error",timeout:2e3,html:"<div>"+o+"</div>"}))}))}function bh(e,t){Ga.call(this,e),this.preExecute("shape.resize",(function(e){var i=e.shape,n=_o(i),o=n&&n.get("label");o&&o.get("bounds")&&t.updateModdleProperties(i,o,{bounds:void 0})}),!0)}function yh(e,t,i){Ga.call(this,e),this.preExecute("shape.delete",(function(e){var n,o,a,s=e.context.shape;if(1===s.incoming.length&&1===s.outgoing.length){var r=s.incoming[0],l=s.outgoing[0];if(wo(r,"bpmn:SequenceFlow")&&wo(l,"bpmn:SequenceFlow")&&t.canConnect(r.source,l.target,r)){var c=(n=r.waypoints,o=l.waypoints,(a=Tu(wh(n[n.length-2]),wh(n[n.length-1]),wh(o[1]),wh(o[0])))?[].concat(n.slice(0,n.length-1),[a],o.slice(1)):[wh(n[0]),wh(o[o.length-1])]);i.reconnectEnd(r,l.target,c)}}}))}function wh(e){return e.original||e}function xh(e,t){Ga.call(this,e),this.preExecute("shape.delete",(function(e){var t=e.shape,i=t.parent;wo(t,"bpmn:Participant")&&(e.collaborationRoot=i)}),!0),this.postExecute("shape.delete",(function(e){var i=e.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()}),!0)}function $h(e,t,i,n){Ga.call(this,e);var o=n.get("dragging",!1);function a(e){var n,o,a=e.source,s=e.target;e.parent&&(wo(e,"bpmn:SequenceFlow")&&(i.canConnectSequenceFlow(a,s)||(o=!0),i.canConnectMessageFlow(a,s)&&(n="bpmn:MessageFlow")),wo(e,"bpmn:MessageFlow")&&(i.canConnectMessageFlow(a,s)||(o=!0),i.canConnectSequenceFlow(a,s)&&(n="bpmn:SequenceFlow")),wo(e,"bpmn:Association")&&!i.canConnectAssociation(a,s)&&(o=!0),o&&t.removeConnection(e),n&&t.connect(a,s,{type:n,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",(function(e){se(e.closure.allConnections,a)}),!0),this.preExecute("connection.reconnect",(function(e){var n,a,s=e.context,r=s.connection,l=s.newSource||r.source,c=s.newTarget||r.target;(n=i.canConnect(l,c))&&n.type!==r.type&&(a=t.connect(l,c,{type:n.type,waypoints:r.waypoints.slice()}),t.removeConnection(r),s.connection=a,o&&function(e,t){var i,n=o.context(),a=n&&n.payload.previousSelection;a&&a.length&&-1!==(i=a.indexOf(e))&&a.splice(i,1,t)}(r,a))})),this.postExecuted("element.updateProperties",(function(e){var i,n=e.context,o=n.properties,a=n.element,s=a.businessObject;o.default&&(i=oe(a.outgoing,be({id:a.businessObject.default.id})))&&t.updateProperties(i,{conditionExpression:void 0}),o.conditionExpression&&s.sourceRef.default===s&&t.updateProperties(a.source,{default:void 0})}))}function _h(e,t,i,n,o,a){n.invoke(Ga,this),this._bpmnReplace=e,this._elementRegistry=i,this._selection=a,this.postExecuted(["elements.create"],500,(function(e){var i=e.context,n=i.parent,o=i.elements,a=t.canReplace(o,n);a&&this.replaceElements(o,a.replacements)}),this),this.postExecuted(["elements.move"],500,(function(e){var i=e.context,n=i.newParent,o=i.newHost,a=[];se(i.closure.topLevel,(function(e){a=To(e)?a.concat(e.children):a.concat(e)})),1===a.length&&o&&(n=o);var s=t.canReplace(a,n);s&&this.replaceElements(a,s.replacements,o)}),this),this.postExecute(["shape.replace"],1500,(function(e){var i,n=e.context,o=n.oldShape,a=n.newShape,s=o.attachers;s&&s.length&&(i=t.canReplace(s,a),this.replaceElements(s,i.replacements))}),this),this.postExecuted(["shape.replace"],1500,(function(e){var t=e.context,i=t.oldShape,n=t.newShape;o.unclaimId(i.businessObject.id,i.businessObject),o.updateProperties(n,{id:i.id})}))}W()(rh,Ga),rh.$inject=["eventBus","modeling","bpmnFactory","textRenderer"],gh.$inject=["eventBus","modeling"],W()(gh,Ga),vh.$inject=["eventBus","tooltips","translate"],W()(bh,Ga),bh.$inject=["eventBus","modeling"],W()(yh,Ga),yh.$inject=["eventBus","bpmnRules","modeling"],xh.$inject=["eventBus","modeling"],W()(xh,Ga),W()($h,Ga),$h.$inject=["eventBus","modeling","bpmnRules","injector"],W()(_h,Ga),_h.prototype.replaceElements=function(e,t){var i=this._elementRegistry,n=this._bpmnReplace,o=this._selection;se(t,(function(t){var o={type:t.newElementType},a=i.get(t.oldElementId),s=e.indexOf(a);e[s]=n.replaceElement(a,o,{select:!1})})),t&&o.select(e)},_h.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var Ch={width:300,height:150},Eh={width:140,height:120},Sh={width:50,height:30};function kh(e){e.on("resize.start",1500,(function(e){var t=e.context,i=t.shape,n=t.direction,o=t.balanced;(wo(i,"bpmn:Lane")||wo(i,"bpmn:Participant"))&&(t.resizeConstraints=function(e,t,i){var n=ad(e),o=!0,a=!0,s=nd(n,[n]),r=fi(e),l={},c={};return/e/.test(t)?c.right=r.left+300:/w/.test(t)&&(c.left=r.right-300),s.forEach((function(e){var n=fi(e);/n/.test(t)&&(n.top<r.top-10&&(o=!1),i&&Ah(r.top-n.bottom)<10&&Fh(l,"top",n.top+60),Ah(r.top-n.top)<5&&Lh(c,"top",n.bottom-60)),/s/.test(t)&&(n.bottom>r.bottom+10&&(a=!1),i&&Ah(r.bottom-n.top)<10&&Lh(l,"bottom",n.bottom-60),Ah(r.bottom-n.bottom)<5&&Fh(c,"bottom",n.top+60))})),n.children.filter((function(e){return!e.hidden&&!e.waypoints&&(wo(e,"bpmn:FlowElement")||wo(e,"bpmn:Artifact"))})).forEach((function(e){var i=fi(e);o&&/n/.test(t)&&Lh(c,"top",i.top-20),/e/.test(t)&&Fh(c,"right",i.right+20),a&&/s/.test(t)&&Fh(c,"bottom",i.bottom+20),/w/.test(t)&&Lh(c,"left",i.left-50)})),{min:c,max:l}}(i,n,o)),wo(i,"bpmn:Participant")&&(t.minDimensions=Ch),wo(i,"bpmn:SubProcess")&&Io(i)&&(t.minDimensions=Eh),wo(i,"bpmn:TextAnnotation")&&(t.minDimensions=Sh)}))}kh.$inject=["eventBus"];var Ah=Math.abs,Rh=Math.min,Dh=Math.max;function Ph(e,t,i,n){var o=e[t];e[t]=void 0===o?i:n(i,o)}function Lh(e,t,i){return Ph(e,t,i,Rh)}function Fh(e,t,i){return Ph(e,t,i,Dh)}function Vh(e,t){e.on("resize.start",1501,(function(e){var t=e.context,i=t.shape;(wo(i,"bpmn:Lane")||wo(i,"bpmn:Participant"))&&(t.balanced=!_a(e))})),e.on("resize.end",1001,(function(e){var i=e.context,n=i.shape,o=i.canExecute,a=i.newBounds;if(wo(n,"bpmn:Lane")||wo(n,"bpmn:Participant"))return o&&(a=pi(a),t.resizeLane(n,a,i.balanced)),!1}))}function Bh(e,t,i,n,o){function a(e){return xo(e,["bpmn:ReceiveTask","bpmn:SendTask"])||function(e,t){return Q(t)||(t=[t]),ce(t,(function(t){return jo(e,t)}))}(e,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function s(t){return!!oe(e.getDefinitions().get("rootElements"),be({id:t.id}))}function r(e){return wo(e,"bpmn:ErrorEventDefinition")?"errorRef":wo(e,"bpmn:EscalationEventDefinition")?"escalationRef":wo(e,"bpmn:MessageEventDefinition")?"messageRef":wo(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function l(e){if(xo(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(r(t))}i.invoke(Ga,this),this.executed("shape.create",(function(t){var i=t.shape;if(a(i)){var n=l($o(i));n&&!s(n)&&(oi(e.getDefinitions().get("rootElements"),n),t.addedRootElement=n)}}),!0),this.reverted("shape.create",(function(t){var i=t.addedRootElement;i&&ni(e.getDefinitions().get("rootElements"),i)}),!0),t.on("copyPaste.copyElement",(function(e){var t=e.descriptor,i=e.element;if(a(i)){var n=l($o(i));n&&(t.referencedRootElement=n)}})),t.on("copyPaste.pasteElement",500,(function(e){var t=e.descriptor,i=t.businessObject;if(a(i)){var l=t.referencedRootElement;l&&(s(l)||(l=n.copyElement(l,o.create(l.$type))),function(e,t){if(xo(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var i=e.get("eventDefinitions")[0];i.set(r(i),t)}(i,l))}}))}Vh.$inject=["eventBus","modeling"],Bh.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],W()(Bh,Ga);var Ih=Math.max;function Th(e){e.on("spaceTool.getMinDimensions",(function(e){var t=e.shapes,i=e.axis,n=e.start,o={};return se(t,(function(e){var t=e.id;wo(e,"bpmn:Participant")&&(function(e){return"x"===e}(i)?o[t]=Ch:o[t]={width:Ch.width,height:jh(e,n)}),wo(e,"bpmn:SubProcess")&&Io(e)&&(o[t]=Eh),wo(e,"bpmn:TextAnnotation")&&(o[t]=Sh)})),o}))}function jh(e,t){var i;return od(e).length?(i=function(e,t){var i;return i=Oh(od(e),t),e.height-i.height+60}(e,t),Ih(Ch.height,i)):Ch.height}function Oh(e,t){var i,n,o;for(i=0;i<e.length;i++)if(t>=(n=e[i]).y&&t<=n.y+n.height)return(o=od(n)).length?Oh(o,t):n}Th.$inject=["eventBus"];function Mh(e,t,i,n,o,a,s){Ga.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=i,this._elementFactory=n,this._bpmnFactory=o,this._bpmnjs=a,this._elementRegistry=s;var r=this;function l(e){return wo(e,"bpmn:SubProcess")&&!Io(e)}function c(t){var i=t.shape,n=t.newRootElement,o=$o(i);n=r._addDiagram(n||o),t.newRootElement=e.addRootElement(n)}function d(t){var i=$o(t.shape);r._removeDiagram(i);var n=t.newRootElement=s.get(ts(i));e.removeRootElement(n)}this.executed("shape.create",(function(e){l(e.shape)&&c(e)}),!0),this.postExecuted("shape.create",(function(e){var t=e.shape,i=e.newRootElement;i&&t.children&&(r._showRecursively(t.children),r._moveChildrenToShape(t,i))}),!0),this.reverted("shape.create",(function(e){l(e.shape)&&d(e)}),!0),this.preExecuted("shape.delete",(function(e){var t=e.shape;if(l(t)){var n=s.get(ts(t));n&&i.removeElements(n.children.slice())}}),!0),this.executed("shape.delete",(function(e){l(e.shape)&&d(e)}),!0),this.reverted("shape.delete",(function(e){l(e.shape)&&c(e)}),!0),this.preExecuted("shape.replace",(function(t){var i=t.oldShape,n=t.newShape;l(i)&&l(n)&&(t.oldRoot=e.removeRootElement(ts(i)))}),!0),this.postExecuted("shape.replace",(function(t){var n=t.newShape,o=t.oldRoot,a=e.findRoot(ts(n));if(o&&a){var s=o.children;i.moveElements(s,{x:0,y:0},a)}}),!0),this.executed("element.updateProperties",(function(e){var t=e.element;if(wo(t,"bpmn:SubProcess")){var i=e.properties,n=e.oldProperties.id,o=i.id;if(n!==o){if(ns(t))return s.updateId(t,is(o)),void s.updateId(n,o);s.get(is(n))&&s.updateId(is(n),is(o))}}}),!0),this.reverted("element.updateProperties",(function(e){var t=e.element;if(wo(t,"bpmn:SubProcess")){var i=e.properties,n=e.oldProperties.id,o=i.id;if(n!==o){if(ns(t))return s.updateId(t,is(n)),void s.updateId(o,n);var a=s.get(is(o));a&&s.updateId(a,is(n))}}}),!0),t.on("element.changed",(function(e){var i=e.element;if(ns(i)){var n=i,o=s.get(es(n));o&&o!==n&&t.fire("element.changed",{element:o})}})),this.executed("shape.toggleCollapse",400,(function(e){var t=e.shape;wo(t,"bpmn:SubProcess")&&(Io(t)?d(e):(c(e),r._showRecursively(t.children)))}),!0),this.reverted("shape.toggleCollapse",400,(function(e){var t=e.shape;wo(t,"bpmn:SubProcess")&&(Io(t)?d(e):(c(e),r._showRecursively(t.children)))}),!0),this.postExecuted("shape.toggleCollapse",600,(function(e){var t=e.shape;if(wo(t,"bpmn:SubProcess")){var i=e.newRootElement;i&&(Io(t)?r._moveChildrenToShape(i,t):r._moveChildrenToShape(t,i))}}),!0),t.on("copyPaste.createTree",(function(e){var t=e.element,i=e.children;if(l(t)){var n=ts(t),o=s.get(n);o&&i.push.apply(i,o.children)}})),t.on("copyPaste.copyElement",(function(e){var t=e.descriptor,i=e.element,n=e.elements,o=i.parent;if(wo(_o(o),"bpmndi:BPMNPlane")){var a=es(o),s=oe(n,(function(e){return e.id===a}));s&&(t.parent=s.id)}})),t.on("copyPaste.pasteElement",(function(e){var t=e.descriptor;t.parent&&(l(t.parent)||t.parent.hidden)&&(t.hidden=!0)}))}function Nh(e,t){e.invoke(Ga,this),this.postExecuted("shape.replace",(function(e){var i=e.context.oldShape,n=e.context.newShape;if(wo(n,"bpmn:SubProcess")&&wo(i,"bpmn:Task")&&Io(n)){var o,a={x:(o=n).x+o.width/6,y:o.y+o.height/2};t.createShape({type:"bpmn:StartEvent"},a,n)}}))}function Wh(e,t){Ga.call(this,e),this.postExecuted("shape.toggleCollapse",1500,(function(e){var i=e.shape;if(!Io(i)){var n=Kt(i);n.forEach((function(e){var t=e.incoming.slice(),i=e.outgoing.slice();se(t,(function(e){o(e,!0)})),se(i,(function(e){o(e,!1)}))}))}function o(e,o){-1!==n.indexOf(e.source)&&-1!==n.indexOf(e.target)||(o?t.reconnectEnd(e,i,vi(i)):t.reconnectStart(e,i,vi(i)))}}),!0)}function zh(e,t,i,n){Ga.call(this,e),this.executed(["shape.toggleCollapse"],500,(function(e){var t,i=e.context.shape;wo(i,"bpmn:SubProcess")&&(i.collapsed?_o(i).isExpanded=!1:((t=i.children).length&&t.forEach((function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)})),_o(i).isExpanded=!0))})),this.reverted(["shape.toggleCollapse"],500,(function(e){var t=e.context.shape;t.collapsed?_o(t).isExpanded=!1:_o(t).isExpanded=!0})),this.postExecuted(["shape.toggleCollapse"],500,(function(e){var n,o=e.context.shape,a=t.getDefaultSize(o);n=o.collapsed?function(e,t){return{x:e.x+(e.width-t.width)/2,y:e.y+(e.height-t.height)/2,width:t.width,height:t.height}}(o,a):function(e,t){var i,n,o=t;return(i=Jc((n=e.children,n.filter((function(e){return!e.hidden}))).concat([e])))?(o.width=Math.max(i.width,o.width),o.height=Math.max(i.height,o.height),o.x=i.x+(i.width-o.width)/2,o.y=i.y+(i.height-o.height)/2):(o.x=e.x+(e.width-o.width)/2,o.y=e.y+(e.height-o.height)/2),o}(o,a),i.resizeShape(o,n,null,{autoResize:!o.collapsed&&"nwse"})}))}function Uh(e,t,i,n){t.invoke(Ga,this),this.preExecute("shape.delete",(function(e){var t=e.context.shape,o=t.businessObject;ua(t)||(wo(t,"bpmn:Participant")&&Io(t)&&i.ids.unclaim(o.processRef.id),n.unclaimId(o.id,o))})),this.preExecute("connection.delete",(function(e){var t=e.context.connection.businessObject;n.unclaimId(t.id,t)})),this.preExecute("canvas.updateRoot",(function(){var t=e.getRootElement(),n=t.businessObject;wo(t,"bpmn:Collaboration")&&i.ids.unclaim(n.id)}))}function Hh(e,t){Ga.call(this,e),this.preExecute("connection.delete",(function(e){var i=e.context.connection,n=i.source;(function(e,t){if(!wo(e,"bpmn:SequenceFlow"))return!1;var i=$o(t),n=$o(e);return i.get("default")===n})(i,n)&&t.updateProperties(n,{default:null})}))}function qh(e,t,i){var n;Ga.call(this,e);var o=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(o,5e3,(function(e){(n=n||new Gh).enter()})),this.postExecuted(o,500,(function(e){!function(){if(!n)throw new Error(i("out of bounds release"));n.leave()&&(t.updateLaneRefs(n.flowNodes,n.lanes),n=null)}()})),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],(function(e){var t=e.context.shape,o=function(){if(!n)throw new Error(i("out of bounds release"));return n}();t.labelTarget||(wo(t,"bpmn:Lane")&&o.addLane(t),wo(t,"bpmn:FlowNode")&&o.addFlowNode(t))}))}function Gh(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}W()(Mh,Ga),Mh.prototype._moveChildrenToShape=function(e,t){var i,n=this._modeling,o=e.children;if(o){var a=o.filter((function(e){return!e.hidden}));if(a.length){var s=Xt(a);if(t.x){var r=vi(t),l=vi(s);i={x:r.x-l.x,y:r.y-l.y}}else i={x:180-s.x,y:160-s.y};n.moveElements(o,i,t,{autoResize:!1})}else n.moveElements(o,{x:0,y:0},t,{autoResize:!1})}},Mh.prototype._showRecursively=function(e,t){var i=this,n=[];return e.forEach((function(e){e.hidden=!!t,n=n.concat(e),e.children&&(n=n.concat(i._showRecursively(e.children,e.collapsed||t)))})),n},Mh.prototype._addDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),t.push(e.di.$parent),e},Mh.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,i=this._elementFactory,n=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),o=t.create("bpmndi:BPMNDiagram",{plane:n});return n.$parent=o,i.createRoot({id:ts(e),type:e.$type,di:n,businessObject:e,collapsed:!0})},Mh.prototype._removeDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams,i=oe(t,(function(t){return t.plane.bpmnElement.id===e.id}));return t.splice(t.indexOf(i),1),i},Mh.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"],Nh.$inject=["injector","modeling"],W()(Nh,Ga),W()(Wh,Ga),Wh.$inject=["eventBus","modeling"],W()(zh,Ga),zh.$inject=["eventBus","elementFactory","modeling"],W()(Uh,Ga),Uh.$inject=["canvas","injector","moddle","modeling"],W()(Hh,Ga),Hh.$inject=["eventBus","modeling"],qh.$inject=["eventBus","modeling","translate"],W()(qh,Ga);const Yh={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior"],adaptiveLabelPositioningBehavior:["type",du],appendBehavior:["type",hu],associationBehavior:["type",pu],attachEventBehavior:["type",mu],boundaryEventBehavior:["type",gu],createBehavior:["type",vu],createDataObjectBehavior:["type",bu],createParticipantBehavior:["type",wu],dataInputAssociationBehavior:["type",$u],dataStoreBehavior:["type",Eu],deleteLaneBehavior:["type",Su],detachEventBehavior:["type",ku],dropOnFlowBehavior:["type",Ru],eventBasedGatewayBehavior:["type",Lu],fixHoverBehavior:["type",Bu],groupBehavior:["type",Iu],importDockingFix:["type",ju],isHorizontalFix:["type",Mu],labelBehavior:["type",rh],messageFlowBehavior:["type",gh],modelingFeedback:["type",vh],removeElementBehavior:["type",yh],removeEmbeddedLabelBoundsBehavior:["type",bh],removeParticipantBehavior:["type",xh],replaceConnectionBehavior:["type",$h],replaceElementBehaviour:["type",_h],resizeBehavior:["type",kh],resizeLaneBehavior:["type",Vh],rootElementReferenceBehavior:["type",Bh],spaceToolBehavior:["type",Th],subProcessPlaneBehavior:["type",Mh],subProcessStartEventBehavior:["type",Nh],toggleCollapseConnectionBehaviour:["type",Wh],toggleElementCollapseBehaviour:["type",zh],unclaimIdBehavior:["type",Uh],unsetDefaultFlowBehavior:["type",Hh],updateFlowNodeRefsBehavior:["type",qh]};function Zh(e,t){var i=bi(e,t,-15);return"intersect"!==i?i:null}function Kh(e){br.call(this,e)}function Xh(e){return!e||ua(e)}function Qh(e){do{if(wo(e,"bpmn:Process"))return $o(e);if(wo(e,"bpmn:Participant"))return $o(e).processRef||$o(e)}while(e=e.parent)}function Jh(e){return wo(e,"bpmn:TextAnnotation")}function ep(e){return wo(e,"bpmn:Group")&&!e.labelTarget}function tp(e){return wo(e,"bpmn:BoundaryEvent")&&op(e,"bpmn:CompensateEventDefinition")}function ip(e){return $o(e).isForCompensation}function np(e){for(var t=e;t=t.parent;){if(wo(t,"bpmn:FlowElementsContainer"))return $o(t);if(wo(t,"bpmn:Participant"))return $o(t).processRef}return null}function op(e,t){return!!oe($o(e).eventDefinitions||[],(function(e){return wo(e,t)}))}function ap(e,t){return($o(e).eventDefinitions||[]).every((function(e){return wo(e,t)}))}function sp(e){return wo(e,"bpmn:ReceiveTask")||wo(e,"bpmn:IntermediateCatchEvent")&&(op(e,"bpmn:MessageEventDefinition")||op(e,"bpmn:TimerEventDefinition")||op(e,"bpmn:ConditionalEventDefinition")||op(e,"bpmn:SignalEventDefinition"))}function rp(e){return e.waypoints}function lp(e,t){var i=function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t}(t);return-1!==i.indexOf(e)}function cp(e,t,i){if(Xh(e)||Xh(t))return null;if(!wo(i,"bpmn:DataAssociation")){if(xp(e,t))return{type:"bpmn:MessageFlow"};if($p(e,t))return{type:"bpmn:SequenceFlow"}}return _p(e,t)||(tp(e)&&ip(t)?{type:"bpmn:Association",associationDirection:"One"}:!!wp(e,t)&&{type:"bpmn:Association"})}function dp(e,t,i){return!(!ua(e)&&!ep(e))||!(wo(t,"bpmn:Participant")&&!Io(t))&&(wo(e,"bpmn:Participant")?wo(t,"bpmn:Process")||wo(t,"bpmn:Collaboration"):xo(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:wo(e,"bpmn:Lane")?wo(t,"bpmn:Participant")||wo(t,"bpmn:Lane"):!(wo(e,"bpmn:BoundaryEvent")&&(n=e,!$o(n).cancelActivity||!hp(n)&&!pp(n)))&&(wo(e,"bpmn:FlowElement")&&!wo(e,"bpmn:DataStoreReference")?wo(t,"bpmn:FlowElementsContainer")?Io(t):xo(t,["bpmn:Participant","bpmn:Lane"]):wo(e,"bpmn:DataStoreReference")&&wo(t,"bpmn:Collaboration")?ce($o(t).get("participants"),(function(e){return!!e.get("processRef")})):xo(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?xo(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!wo(e,"bpmn:MessageFlow")&&(wo(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t)));var n}function up(e){return wo(e,"bpmn:Lane")}function hp(e){var t=$o(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function pp(e){return mp(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function mp(e,t){return t.some((function(t){return op(e,t)}))}function fp(e,t,i,n){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var o=e[0];return!ua(o)&&!!function(e){return!!function(e){return!ua(e)&&wo(e,"bpmn:BoundaryEvent")}(e)||!(!wo(e,"bpmn:IntermediateThrowEvent")||!hp(e))||wo(e,"bpmn:IntermediateCatchEvent")&&pp(e)}(o)&&!To(t)&&!(!wo(t,"bpmn:Activity")||ip(t))&&!(n&&!Zh(n,t))&&!function(e){return wo(e,"bpmn:ReceiveTask")&&oe(e.incoming,(function(e){return wo(e.source,"bpmn:EventBasedGateway")}))}(t)&&"attach"}function gp(e,t,i){if(!t)return!1;var n={replacements:[]};return se(e,(function(e){To(t)||wo(e,"bpmn:StartEvent")&&"label"!==e.type&&dp(e,t)&&(function(e){return e&&!1!==$o(e).isInterrupting}(e)||n.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),(function(e){return jo(e,"bpmn:ErrorEventDefinition")}(e)||function(e){return jo(e,"bpmn:EscalationEventDefinition")}(e)||function(e){return jo(e,"bpmn:CompensateEventDefinition")}(e))&&n.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),mp(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&wo(t,"bpmn:SubProcess")&&n.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),wo(t,"bpmn:Transaction")||op(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&(wo(e,"bpmn:EndEvent")&&dp(e,t)&&n.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),wo(e,"bpmn:BoundaryEvent")&&fp(e,t,0,i)&&n.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))})),!!n.replacements.length&&n}function vp(e,t){return!ce(e,up)&&(!t||e.every((function(e){return dp(e,t)})))}function bp(e,t,i,n){return!!t&&(!(!ua(e)&&!ep(e))||i!==t&&(!i||!lp(i,t))&&(dp(e,t)||Cp(e,t)))}function yp(e,t){return wo(e,"bpmn:SubProcess")?Io(e)&&(!t||t.width>=100&&t.height>=80):wo(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:wo(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!Jh(e)||!!ep(e)}function wp(e,t){return!(rp(e)||rp(t)||(!tp(e)||!ip(t))&&(lp(t,e)||lp(e,t)||!function(e,t){var i=Jh(e),n=Jh(t);return(i||n)&&i!==n}(e,t)&&!_p(e,t)))}function xp(e,t){return!(kp(e)&&!kp(t))&&wo(n=e,"bpmn:InteractionNode")&&!wo(n,"bpmn:BoundaryEvent")&&(!wo(n,"bpmn:Event")||wo(n,"bpmn:ThrowEvent")&&ap(n,"bpmn:MessageEventDefinition"))&&function(e){return wo(e,"bpmn:InteractionNode")&&!ip(e)&&(!wo(e,"bpmn:Event")||wo(e,"bpmn:CatchEvent")&&ap(e,"bpmn:MessageEventDefinition"))&&!(wo(e,"bpmn:BoundaryEvent")&&!op(e,"bpmn:MessageEventDefinition"))}(t)&&(i=t,!(Qh(e)===Qh(i)));var i,n}function $p(e,t){return!(sp(t)&&t.incoming.length>0&&(i=t.incoming,(i=i||[]).some(Sp))&&!wo(e,"bpmn:EventBasedGateway"))&&wo(o=e,"bpmn:FlowNode")&&!wo(o,"bpmn:EndEvent")&&!To(o)&&!(wo(o,"bpmn:IntermediateThrowEvent")&&op(o,"bpmn:LinkEventDefinition"))&&!tp(o)&&!ip(o)&&function(e){return wo(e,"bpmn:FlowNode")&&!wo(e,"bpmn:StartEvent")&&!wo(e,"bpmn:BoundaryEvent")&&!To(e)&&!(wo(e,"bpmn:IntermediateCatchEvent")&&op(e,"bpmn:LinkEventDefinition"))&&!ip(e)}(t)&&(n=t,np(e)===np(n))&&!(wo(e,"bpmn:EventBasedGateway")&&!sp(t));var i,n,o}function _p(e,t){return xo(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&xo(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!xo(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!xo(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function Cp(e,t,i){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&xo(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!ua(t)&&wo(e,"bpmn:FlowNode")&&!wo(e,"bpmn:BoundaryEvent")&&dp(e,t.parent)}function Ep(e,t){return!!ua(t)||!(wo(t,"bpmn:Lane")&&!function(e,t){return e&&t&&-1!==e.indexOf(t)}(e,t.parent))}function Sp(e){if(e&&e.source)return wo(e.source,"bpmn:EventBasedGateway")}function kp(e){return Hc(e,"bpmn:Process")||Hc(e,"bpmn:Collaboration")}W()(Kh,br),Kh.$inject=["eventBus"],Kh.prototype.init=function(){this.addRule("connection.start",(function(e){return Xh(t=e.source)?null:xo(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"]);var t})),this.addRule("connection.create",(function(e){var t=e.source,i=e.target,n=e.hints||{},o=n.targetParent;if(n.targetAttach)return!1;o&&(i.parent=o);try{return cp(t,i)}finally{o&&(i.parent=null)}})),this.addRule("connection.reconnect",(function(e){var t=e.connection;return cp(e.source,e.target,t)})),this.addRule("connection.updateWaypoints",(function(e){return{type:e.connection.type}})),this.addRule("shape.resize",(function(e){return yp(e.shape,e.newBounds)})),this.addRule("elements.create",(function(e){var t=e.elements,i=e.position,n=e.target;return!(rp(n)&&!Cp(t,n))&&le(t,(function(e){return rp(e)?cp(e.source,e.target,e):e.host?fp(e,e.host,0,i):bp(e,n,null)}))})),this.addRule("elements.move",(function(e){var t=e.target,i=e.shapes,n=e.position;return fp(i,t,0,n)||gp(i,t,n)||vp(i,t)||Cp(i,t)})),this.addRule("shape.create",(function(e){return bp(e.shape,e.target,e.source,e.position)})),this.addRule("shape.attach",(function(e){return fp(e.shape,e.target,0,e.position)})),this.addRule("element.copy",(function(e){var t=e.element;return Ep(e.elements,t)}))},Kh.prototype.canConnectMessageFlow=xp,Kh.prototype.canConnectSequenceFlow=$p,Kh.prototype.canConnectDataAssociation=_p,Kh.prototype.canConnectAssociation=wp,Kh.prototype.canMove=vp,Kh.prototype.canAttach=fp,Kh.prototype.canReplace=gp,Kh.prototype.canDrop=dp,Kh.prototype.canInsert=Cp,Kh.prototype.canCreate=bp,Kh.prototype.canConnect=cp,Kh.prototype.canResize=yp,Kh.prototype.canCopy=Ep;const Ap={__depends__:[Lr],__init__:["bpmnRules"],bpmnRules:["type",Kh]};function Rp(e,t){e.on("saveXML.start",2e3,(function(){se(t.getRootElements(),(function(e){var t,i=_o(e);t=de(ae(Kt([e],!1),(function(t){return t!==e&&!t.labelTarget})),_o),i.set("planeElement",t)}))}))}Rp.$inject=["eventBus","canvas"];const Dp={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",Rp]};function Pp(e){Ga.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],(function(e){var i=e.context,n=i.shape||i.connection,o=i.parent,a=t.getOrdering(n,o);a&&(void 0!==a.parent&&(i.parent=a.parent),i.parentIndex=a.index)})),this.preExecute(["shape.move","connection.move"],(function(e){var i=e.context,n=i.shape||i.connection,o=i.newParent||n.parent,a=t.getOrdering(n,o);a&&(void 0!==a.parent&&(i.newParent=a.parent),i.newParentIndex=a.index)}))}function Lp(e,t,i){Pp.call(this,e);var n=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function o(e){var t=e.order;if(t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=oe(n,(function(t){return xo(e,[t.type])}));return t&&t.order||{level:1}}(e)),!t)throw new Error("no order for <"+e.id+">");return t}this.getOrdering=function(e,i){if(e.labelTarget)return{parent:t.findRoot(e.labelTarget)||t.getRootElement(),index:-1};var n=o(e);n.containers&&(i=function(e,t,i){for(var n=t;n&&!xo(n,i);)n=n.parent;if(!n)throw new Error("no parent for <"+e.id+"> in <"+(t&&t.id)+">");return n}(e,i,n.containers));var a=i.children.indexOf(e),s=function(e,t){t=we(t);var i=Q(e)?-1:void 0;return se(e,(function(e,n){if(t(e,n))return i=n,!1})),i}(i.children,(function(t){return!(!e.labelTarget&&t.labelTarget)&&n.level<o(t).level}));return-1!==s&&-1!==a&&a<s&&(s-=1),{index:s,parent:i}}}Pp.prototype.getOrdering=function(e,t){return null},Nt()(Pp,Ga),Lp.$inject=["eventBus","canvas","translate"],W()(Lp,Pp);const Fp={__depends__:[sa],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Lp]};function Vp(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],(function(){this.clear(!1)}),this)}Vp.$inject=["eventBus","injector"],Vp.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var i={command:e,context:t};this._pushAction(i),this._internalExecute(i),this._popAction(i)},Vp.prototype.canExecute=function(e,t){var i={command:e,context:t},n=this._getHandler(e),o=this._fire(e,"canExecute",i);if(void 0===o){if(!n)return!1;n.canExecute&&(o=n.canExecute(t))}return o},Vp.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed",{trigger:"clear"})},Vp.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._currentExecution.trigger="undo",this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},Vp.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._currentExecution.trigger="redo",this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},Vp.prototype.register=function(e,t){this._setHandler(e,t)},Vp.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var i=this._injector.instantiate(t);this.register(e,i)},Vp.prototype.canUndo=function(){return!!this._getUndoAction()},Vp.prototype.canRedo=function(){return!!this._getRedoAction()},Vp.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},Vp.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},Vp.prototype._internalUndo=function(e){var t=this,i=e.command,n=e.context,o=this._getHandler(i);this._atomicDo((function(){t._fire(i,"revert",e),o.revert&&t._markDirty(o.revert(n)),t._revertedAction(e),t._fire(i,"reverted",e)}))},Vp.prototype._fire=function(e,t,i){arguments.length<3&&(i=t,t=null);var n,o,a,s=t?[e+"."+t,t]:[e];for(i=this._eventBus.createEvent(i),n=0;(o=s[n])&&(a=this._eventBus.fire("commandStack."+o,i),!i.cancelBubble);n++);return a},Vp.prototype._createId=function(){return this._uid++},Vp.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},Vp.prototype._internalExecute=function(e,t){var i=this,n=e.command,o=e.context,a=this._getHandler(n);if(!a)throw new Error("no command handler registered for <"+n+">");this._pushAction(e),t||(this._fire(n,"preExecute",e),a.preExecute&&a.preExecute(o),this._fire(n,"preExecuted",e)),this._atomicDo((function(){i._fire(n,"execute",e),a.execute&&i._markDirty(a.execute(o)),i._executedAction(e,t),i._fire(n,"executed",e)})),t||(this._fire(n,"postExecute",e),a.postExecute&&a.postExecute(o),this._fire(n,"postExecuted",e)),this._popAction(e)},Vp.prototype._pushAction=function(e){var t=this._currentExecution,i=t.actions,n=i[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=n&&n.id||this._createId()),i.push(e)},Vp.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,i=e.actions,n=e.dirty;i.pop(),i.length||(this._eventBus.fire("elements.changed",{elements:fe("id",n.reverse())}),n.length=0,this._fire("changed",{trigger:t}),e.trigger=null)},Vp.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=Q(e)?e:[e],t.dirty=t.dirty.concat(e))},Vp.prototype._executedAction=function(e,t){var i=++this._stackIdx;t||this._stack.splice(i,this._stack.length,e)},Vp.prototype._revertedAction=function(e){this._stackIdx--},Vp.prototype._getHandler=function(e){return this._handlerMap[e]},Vp.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const Bp={commandStack:["type",Vp]};var Ip=new ja("tt");function Tp(e,t){e.style.display=!1===t?"none":""}var jp=".djs-tooltip";function Op(e,t){var i,n;this._eventBus=e,this._canvas=t,this._ids=Ip,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(i=t.getContainer(),n=Ze('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />'),i.insertBefore(n,i.firstChild),n);var o=this;Ge(this._tooltipRoot,jp,"mousedown",(function(e){e.stopPropagation()})),Ge(this._tooltipRoot,jp,"mouseover",(function(e){o.trigger("mouseover",e)})),Ge(this._tooltipRoot,jp,"mouseout",(function(e){o.trigger("mouseout",e)})),this._init()}Op.$inject=["eventBus","canvas"],Op.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=Se({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t},Op.prototype.trigger=function(e,t){var i=t.delegateTarget||t.target,n=this.get(Re(i,"data-tooltip-id"));n&&("mouseover"===e&&n.timeout&&this.clearTimeout(n),"mouseout"===e&&n.timeout&&(n.timeout=1e3,this.setTimeout(n)))},Op.prototype.get=function(e){return"string"!=typeof e&&(e=e.id),this._tooltips[e]},Op.prototype.clearTimeout=function(e){if(e=this.get(e)){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}},Op.prototype.setTimeout=function(e){if(e=this.get(e)){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout((function(){t.remove(e)}),e.timeout)}},Op.prototype.remove=function(e){var t=this.get(e);t&&(et(t.html),et(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])},Op.prototype.show=function(){Tp(this._tooltipRoot)},Op.prototype.hide=function(){Tp(this._tooltipRoot,!1)},Op.prototype._updateRoot=function(e){var t=e.scale||1,i=e.scale||1,n="matrix("+t+",0,0,"+i+","+-1*e.x*t+","+-1*e.y*i+")";this._tooltipRoot.style.transform=n,this._tooltipRoot.style["-ms-transform"]=n},Op.prototype._addTooltip=function(e){var t,i=e.id,n=e.html,o=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),ie(n)&&(n=Ze(n)),(t=Ze('<div data-tooltip-id="'+i+'" class="djs-tooltip" style="position: absolute">')).appendChild(n),e.type&&Ve(t).add("djs-tooltip-"+e.type),e.className&&Ve(t).add(e.className),e.htmlContainer=t,o.appendChild(t),this._tooltips[i]=e,this._updateTooltip(e)},Op.prototype._updateTooltip=function(e){var t,i,n,o=e.position;t=e.htmlContainer,i=o.x,n=o.y,Se(t.style,{left:i+"px",top:n+"px"})},Op.prototype._updateTooltipVisibilty=function(e){se(this._tooltips,(function(t){var i=t.show,n=t.htmlContainer,o=!0;i&&((i.minZoom>e.scale||i.maxZoom<e.scale)&&(o=!1),Tp(n,o))}))},Op.prototype._init=function(){var e=this;this._eventBus.on("canvas.viewbox.changing",(function(t){e.hide()})),this._eventBus.on("canvas.viewbox.changed",(function(t){var i;i=t.viewbox,e._updateRoot(i),e._updateTooltipVisibilty(i),e.show()}))};const Mp={__init__:["tooltips"],tooltips:["type",Op]};function Np(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(e){for(var i;i=e[0];)t(i);return e}}function Wp(e,t,i){Ga.call(this,t);var n=e.get("movePreview",!1);t.on("shape.move.start",1400,(function(e){var t=e.context,i=t.shapes,n=t.validatedShapes;t.shapes=zp(i),t.validatedShapes=zp(n)})),n&&t.on("shape.move.start",250,(function(e){var t=e.context,i=t.shapes,o=[];se(i,(function(e){se(e.labels,(function(i){i.hidden||-1!==t.shapes.indexOf(i)||o.push(i),e.labelTarget&&o.push(e)}))})),se(o,(function(e){n.makeDraggable(t,e,!0)}))})),this.preExecuted("elements.move",1400,(function(e){var t=e.context.closure,i=t.enclosedElements,n=[];se(i,(function(e){se(e.labels,(function(e){i[e.id]||n.push(e)}))})),t.addAll(n)})),this.preExecute(["connection.delete","shape.delete"],(function(e){var t=e.context;Np((t.connection||t.shape).labels,(function(e){i.removeShape(e,{nested:!0})}))})),this.execute("shape.delete",(function(e){var t=e.context,i=t.shape,n=i.labelTarget;n&&(t.labelTargetIndex=ai(n.labels,i),t.labelTarget=n,i.labelTarget=null)})),this.revert("shape.delete",(function(e){var t=e.context,i=t.shape,n=t.labelTarget,o=t.labelTargetIndex;n&&(oi(n.labels,i,o),i.labelTarget=n)}))}function zp(e){return ae(e,(function(t){return-1===e.indexOf(t.labelTarget)}))}Nt()(Wp,Ga),Wp.$inject=["injector","eventBus","modeling"];const Up={__init__:["labelSupport"],labelSupport:["type",Wp]};var Hp="attach-ok";function qp(e,t,i,n,o){Ga.call(this,t);var a=e.get("movePreview",!1);t.on("shape.move.start",1401,(function(e){var t,i,n=e.context,o=n.shapes,a=n.validatedShapes;n.shapes=(i=Gp(t=o),ge("id",t,i)),n.validatedShapes=function(e){var t=me(e,"id");return ae(e,(function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0}))}(a)})),a&&t.on("shape.move.start",251,(function(e){var t=e.context;se(Gp(t.shapes),(function(e){a.makeDraggable(t,e,!0),se(e.labels,(function(e){a.makeDraggable(t,e,!0)}))}))})),a&&t.on("shape.move.start",(function(e){var n=e.context.shapes;if(1===n.length){var o=n[0].host;o&&(i.addMarker(o,Hp),t.once(["shape.move.out","shape.move.cleanup"],(function(){i.removeMarker(o,Hp)})))}})),this.preExecuted("elements.move",1401,(function(e){var t=e.context,i=t.closure;se(Gp(t.shapes),(function(e){i.add(e,i.topLevel[e.host.id])}))})),this.postExecuted("elements.move",(function(e){var t=e.context,i=t.shapes,n=t.newHost;n&&1!==i.length||se(n?i:ae(i,(function(e){var t,n=e.host;return function(e){return!!e.host}(e)&&(t=n,!(-1!==i.indexOf(t)))})),(function(e){o.updateAttachment(e,n)}))})),this.postExecuted("elements.move",(function(e){se(e.context.shapes,(function(e){se(e.attachers,(function(e){se(e.outgoing.slice(),(function(e){n.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)})),se(e.incoming.slice(),(function(e){n.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)}))}))}))})),this.postExecute("shape.create",(function(e){var t=e.context,i=t.shape,n=t.host;n&&o.updateAttachment(i,n)})),this.postExecute("shape.replace",(function(e){var t=e.context,i=t.oldShape,a=t.newShape;Np(i.attachers,(function(e){"attach"===n.allowed("elements.move",{target:a,shapes:[e]})?o.updateAttachment(e,a):o.removeShape(e)})),a.attachers.length&&se(a.attachers,(function(e){var t=ah(e,i,a);o.moveShape(e,t,e.parent)}))})),this.postExecute("shape.resize",(function(e){var t=e.context,i=t.shape,n=t.oldBounds,a=t.newBounds,s=i.attachers;!1!==(t.hints||{}).attachSupport&&se(s,(function(e){var t=ah(e,n,a);o.moveShape(e,t,e.parent),se(e.labels,(function(e){o.moveShape(e,t,e.parent)}))}))})),this.preExecute("shape.delete",(function(e){var t=e.context.shape;Np(t.attachers,(function(e){o.removeShape(e)})),t.host&&o.updateAttachment(t,null)}))}function Gp(e){return q(de(e,(function(e){return e.attachers||[]})))}Nt()(qp,Ga),qp.$inject=["injector","eventBus","canvas","rules","modeling"];const Yp={__depends__:[Lr],__init__:["attachSupport"],attachSupport:["type",qp]};function Zp(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}Zp.$inject=["eventBus","dragging"],Zp.prototype.registerTool=function(e,t){var i=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');i.push(e),this.bindEvents(e,t)},Zp.prototype.isActive=function(e){return e&&this._active===e},Zp.prototype.length=function(e){return this._tools.length},Zp.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},Zp.prototype.bindEvents=function(e,t){var i=this._eventBus,n=this._dragging,o=[];i.on(t.tool+".init",(function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void n.cancel();this.setActive(e)}),this),se(t,(function(e){o.push(e+".ended"),o.push(e+".canceled")})),i.on(o,250,(function(e){this._active&&(function(e){var t=e.originalEvent&&e.originalEvent.target;return t&&Me(t,'.group[data-group="tools"]')}(e)||this.setActive(null))}),this)};const Kp={__depends__:[Ar],__init__:["toolManager"],toolManager:["type",Zp]};function Xp(e,t){return-1!==e.indexOf(t)}var Qp=Math.abs,Jp=Math.round,em={x:"width",y:"height"},tm="crosshair",im={n:"top",w:"left",s:"bottom",e:"right"},nm={n:"s",w:"e",s:"n",e:"w"};function om(e,t,i,n,o,a,s){this._canvas=e,this._dragging=t,this._eventBus=i,this._modeling=n,this._rules=o,this._toolManager=a,this._mouse=s;var r=this;a.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),i.on("spaceTool.selection.end",(function(e){i.once("spaceTool.selection.ended",(function(){r.activateMakeSpace(e.originalEvent)}))})),i.on("spaceTool.move",1500,(function(e){var t=e.context,i=t.initialized;i||(i=t.initialized=r.init(e,t)),i&&sm(e)})),i.on("spaceTool.end",(function(e){var t=e.context,n=t.axis,o=t.direction,a=t.movingShapes,s=t.resizingShapes,l=t.start;if(t.initialized){sm(e);var c={x:0,y:0};c[n]=Jp(e["d"+n]),r.makeSpace(a,s,c,o,l),i.once("spaceTool.ended",(function(e){r.activateSelection(e.originalEvent,!0,!0)}))}}))}function am(e){return{top:e.top-20,right:e.right+20,bottom:e.bottom+20,left:e.left-20}}function sm(e){var t,i,n=e.context.spaceToolConstraints;n&&(ee(n.left)&&(t=Math.max(e.x,n.left),e.dx=e.dx+t-e.x,e.x=t),ee(n.right)&&(t=Math.min(e.x,n.right),e.dx=e.dx+t-e.x,e.x=t),ee(n.top)&&(i=Math.max(e.y,n.top),e.dy=e.dy+i-e.y,e.y=i),ee(n.bottom)&&(i=Math.min(e.y,n.bottom),e.dy=e.dy+i-e.y,e.y=i))}function rm(e,t){return-1!==e.indexOf(t)}function lm(e){return!!e.waypoints}function cm(e){return!!e.labelTarget}om.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"],om.prototype.activateSelection=function(e,t,i){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:tm,data:{context:{reactivate:i}},trapClick:!1})},om.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:tm,data:{context:{}}})},om.prototype.makeSpace=function(e,t,i,n,o){return this._modeling.createSpace(e,t,i,n,o)},om.prototype.init=function(e,t){var i=Qp(e.dx)>Qp(e.dy)?"x":"y",n=e["d"+i],o=e[i]-n;if(Qp(n)<5)return!1;n<0&&(n*=-1),_a(e)&&(n*=-1);var a=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null}(i,n),s=Kt(this._canvas.getRootElement(),!0),r=this.calculateAdjustments(s,i,n,o),l=function(e,t,i,n,o){var a=e.movingShapes,s=e.resizingShapes;if(s.length){var r,l,c={};return se(s,(function(e){var d,u,h,p=fi(e),m=ae(e.children,(function(e){return!(lm(e)||cm(e)||rm(a,e)||rm(s,e))})),f=ae(e.children,(function(e){return!lm(e)&&!cm(e)&&rm(a,e)}));m.length&&(u=am(fi(Xt(m))),d=n-p[im[i]]+u[im[i]],"n"===i?c.bottom=l=ee(l)?Math.min(l,d):d:"w"===i?c.right=l=ee(l)?Math.min(l,d):d:"s"===i?c.top=r=ee(r)?Math.max(r,d):d:"e"===i&&(c.left=r=ee(r)?Math.max(r,d):d)),f.length&&(h=am(fi(Xt(f))),d=n-h[im[nm[i]]]+p[im[nm[i]]],"n"===i?c.bottom=l=ee(l)?Math.min(l,d):d:"w"===i?c.right=l=ee(l)?Math.min(l,d):d:"s"===i?c.top=r=ee(r)?Math.max(r,d):d:"e"===i&&(c.left=r=ee(r)?Math.max(r,d):d));var g=o&&o[e.id];g&&("n"===i?(d=n+e[em[t]]-g[em[t]],c.bottom=l=ee(l)?Math.min(l,d):d):"w"===i?(d=n+e[em[t]]-g[em[t]],c.right=l=ee(l)?Math.min(l,d):d):"s"===i?(d=n-e[em[t]]+g[em[t]],c.top=r=ee(r)?Math.max(r,d):d):"e"===i&&(d=n-e[em[t]]+g[em[t]],c.left=r=ee(r)?Math.max(r,d):d))})),c}}(r,i,a,o,this._eventBus.fire("spaceTool.getMinDimensions",{axis:i,direction:a,shapes:r.resizingShapes,start:o}));return Se(t,r,{axis:i,direction:a,spaceToolConstraints:l,start:o}),Rs("resize-"+("x"===i?"ew":"ns")),!0},om.prototype.calculateAdjustments=function(e,t,i,n){var o=this._rules,a=[],s=[];return se(e,(function(e){if(e.parent&&!lm(e)){var r=e[t],l=r+e[em[t]];return i>0&&r>n||i<0&&l<n?a.push(e):r<n&&l>n&&o.allowed("shape.resize",{shape:e})?s.push(e):void 0}})),{movingShapes:a,resizingShapes:s}},om.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},om.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};var dm="djs-dragging",um="djs-resizing",hm=Math.max;function pm(e,t,i,n,o){function a(e,t){se(e,(function(e){o.addDragger(e,t),i.addMarker(e,dm)}))}e.on("spaceTool.selection.start",(function(e){var t=i.getLayer("space"),o=e.context,a=bt("g");at(a,n.cls("djs-crosshair-group",["no-events"])),it(t,a);var s=bt("path");at(s,"d","M 0,-10000 L 0,10000"),dt(s).add("djs-crosshair"),it(a,s);var r=bt("path");at(r,"d","M -10000,0 L 10000,0"),dt(r).add("djs-crosshair"),it(a,r),o.crosshairGroup=a})),e.on("spaceTool.selection.move",(function(e){Gi(e.context.crosshairGroup,e.x,e.y)})),e.on("spaceTool.selection.cleanup",(function(e){var t=e.context.crosshairGroup;t&&ht(t)})),e.on("spaceTool.move",250,(function(e){var s=e.context,r=s.line,l=s.axis,c=s.movingShapes,d=s.resizingShapes;if(s.initialized){if(!s.dragGroup){var u=i.getLayer("space");at(r=bt("path"),"d","M0,0 L0,0"),dt(r).add("djs-crosshair"),it(u,r),s.line=r;var h=bt("g");at(h,n.cls("djs-drag-group",["no-events"])),it(i.getActiveLayer(),h),a(c,h),a(s.movingConnections=t.filter((function(e){var t=!1;se(c,(function(i){se(i.outgoing,(function(i){e===i&&(t=!0)}))}));var i=!1;se(c,(function(t){se(t.incoming,(function(t){e===t&&(i=!0)}))}));var n=!1;se(d,(function(t){se(t.outgoing,(function(t){e===t&&(n=!0)}))}));var o=!1;return se(d,(function(t){se(t.incoming,(function(t){e===t&&(o=!0)}))})),function(e){return e.waypoints}(e)&&(t||n)&&(i||o)})),h),s.dragGroup=h}if(!s.frameGroup){var p=bt("g");at(p,n.cls("djs-frame-group",["no-events"])),it(i.getActiveLayer(),p);var m=[];se(d,(function(e){var t=o.addFrame(e,p),n=t.getBBox();m.push({element:t,initialBounds:n}),i.addMarker(e,um)})),s.frameGroup=p,s.frames=m}at(r,{d:{x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y}[l]});var f={x:e.dx,y:e.dy};f[{x:"y",y:"x"}[s.axis]]=0,Gi(s.dragGroup,f.x,f.y),se(s.frames,(function(e){var t,i,n=e.element,o=e.initialBounds;"e"===s.direction?at(n,{width:hm(o.width+f.x,5)}):at(n,{width:t=hm(o.width-f.x,5),x:o.x+o.width-t}),"s"===s.direction?at(n,{height:hm(o.height+f.y,5)}):at(n,{height:i=hm(o.height-f.y,5),y:o.y+o.height-i})}))}})),e.on("spaceTool.cleanup",(function(e){var t=e.context,n=t.movingShapes,o=t.movingConnections,a=t.resizingShapes,s=t.line,r=t.dragGroup,l=t.frameGroup;se(n,(function(e){i.removeMarker(e,dm)})),se(o,(function(e){i.removeMarker(e,dm)})),r&&(ht(s),ht(r)),se(a,(function(e){i.removeMarker(e,um)})),l&&ht(l)}))}pm.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const mm={__init__:["spaceToolPreview"],__depends__:[Ar,Lr,Kp,Ml,ac],spaceTool:["type",om],spaceToolPreview:["type",pm]};function fm(e){this._model=e}function gm(e,t,i,n){Ga.call(this,e),this._bpmnFactory=t,this._translate=n;var o=this;function a(e){se(e.context.oldRoot.children,(function(e){wo(e,"bpmn:BaseElement")&&o.updateParent(e)}))}function s(e){var t=e.context.shape;wo(t,"bpmn:BaseElement")&&o.updateBounds(t)}function r(e){o.updateConnection(e.context)}function l(e){o.updateConnectionWaypoints(e.context.connection)}function c(e){o.updateAttachment(e.context)}this.executed(["connection.layout","connection.create"],(function(e){var t,n=e.context,o=n.hints||{};n.cropped||!1===o.createElementsBehavior||((t=n.connection).waypoints=i.getCroppedWaypoints(t),n.cropped=!0)})),this.reverted(["connection.layout"],(function(e){delete e.context.cropped})),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],vm((function(e){var t=e.context;o.updateParent(t.shape||t.connection,t.oldParent)}))),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],vm((function(e){var t=e.context,i=t.shape||t.connection,n=t.parent||t.newParent;o.updateParent(i,n)}))),this.executed(["canvas.updateRoot"],a),this.reverted(["canvas.updateRoot"],a),this.executed(["shape.move","shape.create","shape.resize"],vm((function(e){"label"!==e.context.shape.type&&s(e)}))),this.reverted(["shape.move","shape.create","shape.resize"],vm((function(e){"label"!==e.context.shape.type&&s(e)}))),e.on("shape.changed",(function(e){"label"===e.element.type&&s({context:{shape:e.element}})})),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],vm(r)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],vm(r)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],vm(l)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],vm(l)),this.executed("connection.reconnect",vm((function(e){var t=e.context,i=t.connection,n=t.oldSource,o=t.newSource,a=$o(i),s=$o(n),r=$o(o);a.conditionExpression&&!xo(r,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=a.conditionExpression,delete a.conditionExpression),n!==o&&s.default===a&&(t.oldDefault=s.default,delete s.default)}))),this.reverted("connection.reconnect",vm((function(e){var t=e.context,i=t.connection,n=t.oldSource,o=t.newSource,a=$o(i),s=$o(n),r=$o(o);t.oldConditionExpression&&(a.conditionExpression=t.oldConditionExpression),t.oldDefault&&(s.default=t.oldDefault,delete r.default)}))),this.executed(["element.updateAttachment"],vm(c)),this.reverted(["element.updateAttachment"],vm(c))}function vm(e){return function(t){var i=t.context;wo(i.shape||i.connection,"bpmn:BaseElement")&&e(t)}}function bm(e,t,i){Ni.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=i}function ym(e,t,i){e[i]=t[i],delete t[i]}function wm(e,t){this._modeling=e,this._canvas=t}function xm(e){this._modeling=e}function $m(e,t){this._canvas=e,this._layouter=t}fm.$inject=["moddle"],fm.prototype._needsId=function(e){return xo(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},fm.prototype._ensureId=function(e){var t;e.id?this._model.ids.claim(e.id,e):(t=wo(e,"bpmn:Activity")?"Activity":wo(e,"bpmn:Event")?"Event":wo(e,"bpmn:Gateway")?"Gateway":xo(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e)))},fm.prototype.create=function(e,t){var i=this._model.create(e,t||{});return this._ensureId(i),i},fm.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},fm.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",Se({bpmnElement:e,bounds:this.createDiBounds()},t))},fm.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},fm.prototype.createDiWaypoints=function(e){var t=this;return de(e,(function(e){return t.createDiWaypoint(e)}))},fm.prototype.createDiWaypoint=function(e){return this.create("dc:Point",ke(e,["x","y"]))},fm.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",Se({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))},fm.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",Se({bpmnElement:e},t))},W()(gm,Ga),gm.$inject=["eventBus","bpmnFactory","connectionDocking","translate"],gm.prototype.updateAttachment=function(e){var t=e.shape,i=t.businessObject,n=t.host;i.attachedToRef=n&&n.businessObject},gm.prototype.updateParent=function(e,t){if(!(e instanceof ji||wo(e,"bpmn:DataStoreReference")&&e.parent&&wo(e.parent,"bpmn:Collaboration"))){var i=e.parent,n=e.businessObject,o=_o(e),a=i&&i.businessObject,s=_o(i);wo(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(n,a,t&&t.businessObject),wo(e,"bpmn:DataOutputAssociation")&&(a=e.source?e.source.businessObject:null),wo(e,"bpmn:DataInputAssociation")&&(a=e.target?e.target.businessObject:null),this.updateSemanticParent(n,a),wo(e,"bpmn:DataObjectReference")&&n.dataObjectRef&&this.updateSemanticParent(n.dataObjectRef,a),this.updateDiParent(o,s)}},gm.prototype.updateBounds=function(e){var t=_o(e),i=function(e){if(wo(e,"bpmn:Activity")){var t=_o(e);if(t){var i=t.get("label");if(i)return i.get("bounds")}}}(e);if(i){var n=Fs(i,t.get("bounds"));Se(i,{x:e.x+n.x,y:e.y+n.y})}var o=e instanceof ji?this._getLabel(t):t,a=o.bounds;a||(a=this._bpmnFactory.createDiBounds(),o.set("bounds",a)),Se(a,{x:e.x,y:e.y,width:e.width,height:e.height})},gm.prototype.updateFlowNodeRefs=function(e,t,i){i!==t&&(wo(i,"bpmn:Lane")&&ni(i.get("flowNodeRef"),e),wo(t,"bpmn:Lane")&&oi(t.get("flowNodeRef"),e))},gm.prototype.updateDiConnection=function(e,t,i){var n=_o(e),o=_o(t),a=_o(i);n.sourceElement&&n.sourceElement.bpmnElement!==$o(t)&&(n.sourceElement=t&&o),n.targetElement&&n.targetElement.bpmnElement!==$o(i)&&(n.targetElement=i&&a)},gm.prototype.updateDiParent=function(e,t){if(t&&!wo(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var i=(t||e.$parent).get("planeElement");t?(i.push(e),e.$parent=t):(ni(i,e),e.$parent=null)}},gm.prototype.getLaneSet=function(e){var t,i;return wo(e,"bpmn:Lane")?((t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(wo(e,"bpmn:Participant")&&(e=e.processRef),(t=(i=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,i.push(t)),t)},gm.prototype.updateSemanticParent=function(e,t,i){var n,o=this._translate;if(e.$parent!==t&&(!wo(e,"bpmn:DataInput")&&!wo(e,"bpmn:DataOutput")||(wo(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),!("ioSpecification"in t)||t.ioSpecification!==e.$parent))){if(wo(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),n="lanes";else if(wo(e,"bpmn:FlowElement")){if(t)if(wo(t,"bpmn:Participant"))t=t.processRef;else if(wo(t,"bpmn:Lane"))do{t=t.$parent.$parent}while(wo(t,"bpmn:Lane"));n="flowElements"}else if(wo(e,"bpmn:Artifact")){for(;t&&!wo(t,"bpmn:Process")&&!wo(t,"bpmn:SubProcess")&&!wo(t,"bpmn:Collaboration");){if(wo(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}n="artifacts"}else if(wo(e,"bpmn:MessageFlow"))n="messageFlows";else if(wo(e,"bpmn:Participant")){n="participants";var a,s=e.processRef;s&&(a=function(e){for(;e&&!wo(e,"bpmn:Definitions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&(ni(a.get("rootElements"),s),s.$parent=null),t&&(oi(a.get("rootElements"),s),s.$parent=a))}else wo(e,"bpmn:DataOutputAssociation")?n="dataOutputAssociations":wo(e,"bpmn:DataInputAssociation")&&(n="dataInputAssociations");if(!n)throw new Error(o("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var r;if(e.$parent&&ni(r=e.$parent.get(n),e),t?((r=t.get(n)).push(e),e.$parent=t):e.$parent=null,i){var l=i.get(n);ni(r,e),t&&(l||(l=[],t.set(n,l)),l.push(e))}}},gm.prototype.updateConnectionWaypoints=function(e){_o(e).set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},gm.prototype.updateConnection=function(e){var t,i=e.connection,n=$o(i),o=i.source,a=$o(o),s=i.target,r=$o(i.target);if(wo(n,"bpmn:DataAssociation"))wo(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=a,t=e.parent||e.newParent||r,this.updateSemanticParent(n,r,t)):wo(n,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||a,this.updateSemanticParent(n,a,t),n.targetRef=r);else{var l=wo(n,"bpmn:SequenceFlow");n.sourceRef!==a&&(l&&(ni(n.sourceRef&&n.sourceRef.get("outgoing"),n),a&&a.get("outgoing")&&a.get("outgoing").push(n)),n.sourceRef=a),n.targetRef!==r&&(l&&(ni(n.targetRef&&n.targetRef.get("incoming"),n),r&&r.get("incoming")&&r.get("incoming").push(n)),n.targetRef=r)}this.updateConnectionWaypoints(i),this.updateDiConnection(i,o,s)},gm.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label},W()(bm,Ni),bm.$inject=["bpmnFactory","moddle","translate"],bm.prototype.baseCreate=Ni.prototype.create,bm.prototype.create=function(e,t){if("label"===e){var i=t.di||this._bpmnFactory.createDiLabel();return this.baseCreate(e,Se({type:"label",di:i},ra,t))}return this.createBpmnElement(e,t)},bm.prototype.createBpmnElement=function(e,t){var i,n,o,a=this._translate,s=(t=t||{}).businessObject,r=t.di;if(!s){if(!t.type)throw new Error(a("no shape type specified"));vo(s=this._bpmnFactory.create(t.type))}if(!xo(r,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])){var l=Se(r||{},{id:s.id+"_di"});r="root"===e?this._bpmnFactory.createDiPlane(s,l):"connection"===e?this._bpmnFactory.createDiEdge(s,l):this._bpmnFactory.createDiShape(s,l)}return wo(s,"bpmn:Group")&&(t=Se({isFrame:!0},t)),function(e,t,i){se(["processRef","isInterrupting","associationDirection","isForCompensation"],(function(i){void 0!==t[i]&&ym(e,t,i)}))}(s,t),t.isExpanded&&ym(r,t,"isExpanded"),wo(s,"bpmn:SubProcess")&&(t.collapsed=!Io(s,r)),wo(s,"bpmn:ExclusiveGateway")&&(r.isMarkerVisible=!0),t.eventDefinitionType&&(n=s.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),n.push(o),o.$parent=s,s.eventDefinitions=n,delete t.eventDefinitionType),i=this.getDefaultSize(s,r),t=Se({id:s.id},i,t,{businessObject:s,di:r}),this.baseCreate(e,t)},bm.prototype.getDefaultSize=function(e,t){var i=$o(e);return t=t||_o(e),wo(i,"bpmn:SubProcess")?Io(i,t)?{width:350,height:200}:{width:100,height:80}:wo(i,"bpmn:Task")?{width:100,height:80}:wo(i,"bpmn:Gateway")?{width:50,height:50}:wo(i,"bpmn:Event")?{width:36,height:36}:wo(i,"bpmn:Participant")?Io(i,t)?{width:600,height:250}:{width:400,height:60}:wo(i,"bpmn:Lane")?{width:400,height:100}:wo(i,"bpmn:DataObjectReference")?{width:36,height:50}:wo(i,"bpmn:DataStoreReference")?{width:50,height:50}:wo(i,"bpmn:TextAnnotation")?{width:100,height:30}:wo(i,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},bm.prototype.createParticipantShape=function(e){return J(e)||(e={isExpanded:e}),!1!==(e=Se({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)},wm.$inject=["modeling","canvas"],wm.prototype.preExecute=function(e){var t=this._modeling,i=e.elements,n=e.alignment;se(i,(function(e){var i={x:0,y:0};n.left?i.x=n.left-e.x:n.right?i.x=n.right-e.width-e.x:n.center?i.x=n.center-Math.round(e.width/2)-e.x:n.top?i.y=n.top-e.y:n.bottom?i.y=n.bottom-e.height-e.y:n.middle&&(i.y=n.middle-Math.round(e.height/2)-e.y),t.moveElements([e],i,e.parent)}))},wm.prototype.postExecute=function(e){},xm.$inject=["modeling"],xm.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var i=e.target||t.parent,n=e.shape,o=e.hints||{};n=e.shape=this._modeling.createShape(n,e.position,i,{attach:o.attach}),e.shape=n},xm.prototype.postExecute=function(e){var t,i,n=e.hints||{};t=e.source,i=e.shape,ce(t.outgoing,(function(e){return e.target===i}))||(n.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))},$m.$inject=["canvas","layouter"],$m.prototype.execute=function(e){var t=e.connection,i=e.source,n=e.target,o=e.parent,a=e.parentIndex,s=e.hints;if(!i||!n)throw new Error("source and target required");if(!o)throw new Error("parent required");return t.source=i,t.target=n,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,s)),this._canvas.addConnection(t,o,a),t},$m.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var _m=Math.round;function Cm(e){this._modeling=e}function Em(e){return!!e.waypoints}Cm.$inject=["modeling"],Cm.prototype.preExecute=function(e){var t=e.elements,i=e.parent,n=e.parentIndex,o=e.position,a=e.hints,s=this._modeling;se(t,(function(e){ee(e.x)||(e.x=0),ee(e.y)||(e.y=0)}));var r=Xt(ae(t,(function(e){return!e.hidden})));se(t,(function(e){Em(e)&&(e.waypoints=de(e.waypoints,(function(e){return{x:_m(e.x-r.x-r.width/2+o.x),y:_m(e.y-r.y-r.height/2+o.y)}}))),Se(e,{x:_m(e.x-r.x-r.width/2+o.x),y:_m(e.y-r.y-r.height/2+o.y)})}));var l=qt(t),c={};se(t,(function(e){if(Em(e))c[e.id]=ee(n)?s.createConnection(c[e.source.id],c[e.target.id],n,e,e.parent||i,a):s.createConnection(c[e.source.id],c[e.target.id],e,e.parent||i,a);else{var t=Se({},a);-1===l.indexOf(e)&&(t.autoResize=!1),c[e.id]=ee(n)?s.createShape(e,ke(e,["x","y","width","height"]),e.parent||i,n,t):s.createShape(e,ke(e,["x","y","width","height"]),e.parent||i,t)}})),e.elements=pe(c)};var Sm=Math.round;function km(e){this._canvas=e}function Am(e){km.call(this,e)}km.$inject=["canvas"],km.prototype.execute=function(e){var t=e.shape,i=e.position,n=e.parent,o=e.parentIndex;if(!n)throw new Error("parent required");if(!i)throw new Error("position required");return void 0!==i.width?Se(t,i):Se(t,{x:i.x-Sm(t.width/2),y:i.y-Sm(t.height/2)}),this._canvas.addShape(t,n,o),t},km.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t},Nt()(Am,km),Am.$inject=["canvas"];var Rm=km.prototype.execute;Am.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach((function(t){void 0===e[t]&&(e[t]=0)}))}(t),t.labelTarget=e.labelTarget,Rm.call(this,e)};var Dm=km.prototype.revert;function Pm(e,t){this._canvas=e,this._modeling=t}function Lm(e,t){this._modeling=e,this._elementRegistry=t}function Fm(e,t){this._canvas=e,this._modeling=t}function Vm(e){this._modeling=e}Am.prototype.revert=function(e){return e.shape.labelTarget=null,Dm.call(this,e)},Pm.$inject=["canvas","modeling"],Pm.prototype.execute=function(e){var t=e.connection,i=t.parent;return e.parent=i,e.parentIndex=ai(i.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},Pm.prototype.revert=function(e){var t=e.connection,i=e.parent,n=e.parentIndex;return t.source=e.source,t.target=e.target,oi(i.children,t,n),this._canvas.addConnection(t,i),t},Lm.$inject=["modeling","elementRegistry"],Lm.prototype.postExecute=function(e){var t=this._modeling,i=this._elementRegistry;se(e.elements,(function(e){i.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))}))},Fm.$inject=["canvas","modeling"],Fm.prototype.preExecute=function(e){var t=this._modeling,i=e.shape;Np(i.incoming,(function(e){t.removeConnection(e,{nested:!0})})),Np(i.outgoing,(function(e){t.removeConnection(e,{nested:!0})})),Np(i.children,(function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})}))},Fm.prototype.execute=function(e){var t=this._canvas,i=e.shape,n=i.parent;return e.oldParent=n,e.oldParentIndex=ai(n.children,i),t.removeShape(i),i},Fm.prototype.revert=function(e){var t=this._canvas,i=e.shape,n=e.oldParent,o=e.oldParentIndex;return oi(n.children,i,o),t.addShape(i,n),i},Vm.$inject=["modeling"];var Bm={x:"y",y:"x"};function Im(e,t){this._layouter=e,this._canvas=t}function Tm(){}function jm(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function Om(e){this._modeling=e}function Mm(e){this._helper=new Om(e)}function Nm(e){this._modeling=e,this._helper=new Om(e)}function Wm(e){this._modeling=e}function zm(e){return e.original||e}function Um(e,t){this._modeling=e,this._rules=t}function Hm(e){this._modeling=e}function qm(e){this._modeling=e}function Gm(e){return Se({},e)}function Ym(e){switch(e){case"n":case"s":return"y";case"w":case"e":return"x"}}function Zm(e,t,i){var n=Ym(i);return/e|s/.test(i)?e[n]>t:/n|w/.test(i)?e[n]<t:void 0}function Km(e,t){return-1!==e.indexOf(t)}function Xm(e){this._modeling=e}function Qm(e){var t={};return se(e,(function(e){t[e.id]=e.hidden,e.children&&(t=Se({},t,Qm(e.children)))})),t}function Jm(e,t){var i=[];return se(e,(function(e){e.hidden=t,i=i.concat(e),e.children&&(i=i.concat(Jm(e.children,e.collapsed||t)))})),i}function ef(e,t){var i=[];return se(e,(function(e){e.hidden=t[e.id],i=i.concat(e),e.children&&(i=i.concat(ef(e.children,t)))})),i}function tf(e){this._modeling=e}function nf(e,t){return ni(e&&e.attachers,t)}function of(e,t,i){if(e){var n=e.attachers;n||(e.attachers=n=[]),oi(n,t,i)}}function af(){}function sf(e,t,i){this._eventBus=e,this._elementFactory=t,this._commandStack=i;var n=this;e.on("diagram.init",(function(){n.registerHandlers(i)}))}function rf(e){this._elementRegistry=e}function lf(e,t){se(t,(function(t,i){e.set(i,t)}))}Vm.prototype.preExecute=function(e){var t=this._modeling,i=e.groups,n=e.axis,o=e.dimension;function a(e,t){e.range.min=Math.min(t[n],e.range.min),e.range.max=Math.max(t[n]+t[o],e.range.max)}function s(e){return e[n]+e[o]/2}function r(e){return e.length-1}function l(e){return e.max-e.min}var c,d,u=i[0],h=r(i),p=i[h],m=0;se(i,(function(e,c){var d,u,p;e.elements.length<2?c&&c!==i.length-1&&(a(e,e.elements[0]),m+=l(e.range)):(u=(d=ve(e.elements,n))[0],c===h&&(u=d[r(d)]),p=s(u),e.range=null,se(d,(function(i){!function(e,i){var o={y:0};o[n]=e-s(i),o[n]&&(o[Bm[n]]=0,t.moveElements([i],o,i.parent))}(p,i),null!==e.range?a(e,i):e.range={min:i[n],max:i[n]+i[o]}})),c&&c!==i.length-1&&(m+=l(e.range)))})),d=Math.abs(p.range.min-u.range.max),(c=Math.round((d-m)/(i.length-1)))<i.length-1||se(i,(function(e,a){var s,r={};e!==u&&e!==p&&(s=i[a-1],e.range.max=0,se(e.elements,(function(i,a){r[Bm[n]]=0,r[n]=s.range.max-i[n]+c,e.range.min!==i[n]&&(r[n]+=i[n]-e.range.min),r[n]&&t.moveElements([i],r,i.parent),e.range.max=Math.max(i[n]+i[o],a?e.range.max:0)})))}))},Vm.prototype.postExecute=function(e){},Im.$inject=["layouter","canvas"],Im.prototype.execute=function(e){var t=e.connection;return Se(e,{oldWaypoints:t.waypoints}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},Im.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},Tm.prototype.execute=function(e){var t=e.connection,i=e.delta,n=e.newParent||t.parent,o=e.newParentIndex,a=t.parent;return e.oldParent=a,e.oldParentIndex=ni(a.children,t),oi(n.children,t,o),t.parent=n,se(t.waypoints,(function(e){e.x+=i.x,e.y+=i.y,e.original&&(e.original.x+=i.x,e.original.y+=i.y)})),t},Tm.prototype.revert=function(e){var t=e.connection,i=t.parent,n=e.oldParent,o=e.oldParentIndex,a=e.delta;return ni(i.children,t),oi(n.children,t,o),t.parent=n,se(t.waypoints,(function(e){e.x-=a.x,e.y-=a.y,e.original&&(e.original.x-=a.x,e.original.y-=a.y)})),t},jm.prototype.add=function(e,t){return this.addAll([e],t)},jm.prototype.addAll=function(e,t){var i=function(e,t,i){Z(t)&&(t=!0),J(t)&&(i=t,t=!0);var n=ei((i=i||{}).allShapes),o=ei(i.allConnections),a=ei(i.enclosedElements),s=ei(i.enclosedConnections),r=ei(i.topLevel,t&&me(e,(function(e){return e.id})));function l(e){r[e.source.id]&&r[e.target.id]&&(r[e.id]=[e]),n[e.source.id]&&n[e.target.id]&&(s[e.id]=a[e.id]=e),o[e.id]=e}return Zt(e,(function(e){if(a[e.id]=e,!e.waypoints)return n[e.id]=e,se(e.incoming,l),se(e.outgoing,l),e.children;s[e.id]=o[e.id]=e})),{allShapes:n,allConnections:o,topLevel:r,enclosedConnections:s,enclosedElements:a}}(e,!!t,this);return Se(this,i),this},Om.prototype.moveRecursive=function(e,t,i){return e?this.moveClosure(this.getClosure(e),t,i):[]},Om.prototype.moveClosure=function(e,t,i,n,o){var a=this._modeling,s=e.allShapes,r=e.allConnections,l=e.enclosedConnections,c=e.topLevel,d=!1;o&&o.parent===i&&(d=!0),se(s,(function(e){a.moveShape(e,t,c[e.id]&&!d&&i,{recurse:!1,layout:!1})})),se(r,(function(e){var n=!!s[e.source.id],o=!!s[e.target.id];l[e.id]&&n&&o?a.moveConnection(e,t,c[e.id]&&!d&&i):a.layoutConnection(e,{connectionStart:n&&dh(e,e.source,t),connectionEnd:o&&uh(e,e.target,t)})}))},Om.prototype.getClosure=function(e){return(new jm).addAll(e,!0)},Mm.$inject=["modeling"],Mm.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},Mm.prototype.postExecute=function(e){var t,i=e.hints;i&&i.primaryShape&&(t=i.primaryShape,i.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},Nm.$inject=["modeling"],Nm.prototype.execute=function(e){var t=e.shape,i=e.delta,n=e.newParent||t.parent,o=e.newParentIndex,a=t.parent;return e.oldBounds=ke(t,["x","y","width","height"]),e.oldParent=a,e.oldParentIndex=ni(a.children,t),oi(n.children,t,o),Se(t,{parent:n,x:t.x+i.x,y:t.y+i.y}),t},Nm.prototype.postExecute=function(e){var t=e.shape,i=e.delta,n=e.hints,o=this._modeling;!1!==n.layout&&(se(t.incoming,(function(e){o.layoutConnection(e,{connectionEnd:uh(e,t,i)})})),se(t.outgoing,(function(e){o.layoutConnection(e,{connectionStart:dh(e,t,i)})}))),!1!==n.recurse&&this.moveChildren(e)},Nm.prototype.revert=function(e){var t=e.shape,i=e.oldParent,n=e.oldParentIndex,o=e.delta;return oi(i.children,t,n),Se(t,{parent:i,x:t.x-o.x,y:t.y-o.y}),t},Nm.prototype.moveChildren=function(e){var t=e.delta,i=e.shape;this._helper.moveRecursive(i.children,t,null)},Nm.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},Wm.$inject=["modeling"],Wm.prototype.execute=function(e){var t=e.newSource,i=e.newTarget,n=e.connection,o=e.dockingOrPoints;if(!t&&!i)throw new Error("newSource or newTarget required");return Q(o)&&(e.oldWaypoints=n.waypoints,n.waypoints=o),t&&(e.oldSource=n.source,n.source=t),i&&(e.oldTarget=n.target,n.target=i),n},Wm.prototype.postExecute=function(e){var t=e.connection,i=e.newSource,n=e.newTarget,o=e.dockingOrPoints,a=e.hints||{},s={};a.connectionStart&&(s.connectionStart=a.connectionStart),a.connectionEnd&&(s.connectionEnd=a.connectionEnd),!1!==a.layoutConnection&&(!i||n&&"source"!==a.docking||(s.connectionStart=s.connectionStart||zm(Q(o)?o[0]:o)),!n||i&&"target"!==a.docking||(s.connectionEnd=s.connectionEnd||zm(Q(o)?o[o.length-1]:o)),a.newWaypoints&&(s.waypoints=a.newWaypoints),this._modeling.layoutConnection(t,s))},Wm.prototype.revert=function(e){var t=e.oldSource,i=e.oldTarget,n=e.oldWaypoints,o=e.connection;return t&&(o.source=t),i&&(o.target=i),n&&(o.waypoints=n),o},Um.$inject=["modeling","rules"],Um.prototype.preExecute=function(e){var t,i=this,n=this._modeling,o=this._rules,a=e.oldShape,s=e.newData,r=e.hints||{};function l(e,t,i){return o.allowed("connection.reconnect",{connection:i,source:e,target:t})}var c,d={x:s.x,y:s.y},u={x:a.x,y:a.y,width:a.width,height:a.height};t=e.newShape=e.newShape||i.createShape(s,d,a.parent,r),a.host&&n.updateAttachment(t,a.host),!1!==r.moveChildren&&(c=a.children.slice(),n.moveElements(c,{x:0,y:0},t,r));var h=a.incoming.slice(),p=a.outgoing.slice();se(h,(function(e){l(e.source,t,e)&&i.reconnectEnd(e,t,ch(e,t,u),r)})),se(p,(function(e){var n=e.target;l(t,n,e)&&i.reconnectStart(e,t,lh(e,t,u),r)}))},Um.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)},Um.prototype.execute=function(e){},Um.prototype.revert=function(e){},Um.prototype.createShape=function(e,t,i,n){return this._modeling.createShape(e,t,i,n)},Um.prototype.reconnectStart=function(e,t,i,n){this._modeling.reconnectStart(e,t,i,n)},Um.prototype.reconnectEnd=function(e,t,i,n){this._modeling.reconnectEnd(e,t,i,n)},Hm.$inject=["modeling"],Hm.prototype.execute=function(e){var t=e.shape,i=e.newBounds,n=e.minBounds;if(void 0===i.x||void 0===i.y||void 0===i.width||void 0===i.height)throw new Error("newBounds must have {x, y, width, height} properties");if(n&&(i.width<n.width||i.height<n.height))throw new Error("width and height cannot be less than minimum height and width");if(!n&&i.width<10||i.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},Se(t,{width:i.width,height:i.height,x:i.x,y:i.y}),t},Hm.prototype.postExecute=function(e){var t=this._modeling,i=e.shape,n=e.oldBounds;!1!==(e.hints||{}).layout&&(se(i.incoming,(function(e){t.layoutConnection(e,{connectionEnd:ch(e,i,n)})})),se(i.outgoing,(function(e){t.layoutConnection(e,{connectionStart:lh(e,i,n)})})))},Hm.prototype.revert=function(e){var t=e.shape,i=e.oldBounds;return Se(t,{width:i.width,height:i.height,x:i.x,y:i.y}),t},qm.$inject=["modeling"],qm.prototype.preExecute=function(e){var t=e.delta,i=e.direction,n=e.movingShapes,o=e.resizingShapes,a=e.start,s={};this.moveShapes(n,t),se(o,(function(e){s[e.id]=function(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}(e)})),this.resizeShapes(o,t,i),this.updateConnectionWaypoints(function(e,t){var i=[];return se(e.concat(t),(function(n){var o=n.incoming,a=n.outgoing;se(o.concat(a),(function(n){var o=n.source,a=n.target;(Xp(e,o)||Xp(e,a)||Xp(t,o)||Xp(t,a))&&(Xp(i,n)||i.push(n))}))})),i}(n,o),t,i,a,n,o,s)},qm.prototype.execute=function(){},qm.prototype.revert=function(){},qm.prototype.moveShapes=function(e,t){var i=this;se(e,(function(e){i._modeling.moveShape(e,t,null,{autoResize:!1,layout:!1,recurse:!1})}))},qm.prototype.resizeShapes=function(e,t,i){var n=this;se(e,(function(e){var o=function(e,t,i){var n=e.x,o=e.y,a=e.width,s=e.height,r=i.x,l=i.y;switch(t){case"n":return{x:n,y:o+l,width:a,height:s-l};case"s":return{x:n,y:o,width:a,height:s+l};case"w":return{x:n+r,y:o,width:a-r,height:s};case"e":return{x:n,y:o,width:a+r,height:s};default:throw new Error("unknown direction: "+t)}}(e,i,t);n._modeling.resizeShape(e,o,null,{attachSupport:!1,autoResize:!1,layout:!1})}))},qm.prototype.updateConnectionWaypoints=function(e,t,i,n,o,a,s){var r=this,l=o.concat(a);se(e,(function(e){var c=e.source,d=e.target,u=function(e){return de(e.waypoints,(function(e){return(e=Gm(e)).original&&(e.original=Gm(e.original)),e}))}(e),h=Ym(i),p={labelBehavior:!1};Km(l,c)&&Km(l,d)?(u=de(u,(function(e){return Zm(e,n,i)&&(e[h]=e[h]+t[h]),e.original&&Zm(e.original,n,i)&&(e.original[h]=e.original[h]+t[h]),e})),r._modeling.updateWaypoints(e,u,{labelBehavior:!1})):(Km(l,c)||Km(l,d))&&(Km(o,c)?p.connectionStart=dh(e,c,t):Km(o,d)?p.connectionEnd=uh(e,d,t):Km(a,c)?p.connectionStart=lh(e,c,s[c.id]):Km(a,d)&&(p.connectionEnd=ch(e,d,s[d.id])),r._modeling.layoutConnection(e,p))}))},Xm.$inject=["modeling"],Xm.prototype.execute=function(e){var t=e.shape,i=t.children;e.oldChildrenVisibility=Qm(i),t.collapsed=!t.collapsed;var n=Jm(i,t.collapsed);return[t].concat(n)},Xm.prototype.revert=function(e){var t=e.shape,i=e.oldChildrenVisibility,n=ef(t.children,i);return t.collapsed=!t.collapsed,[t].concat(n)},tf.$inject=["modeling"],tf.prototype.execute=function(e){var t=e.shape,i=e.newHost,n=t.host;return e.oldHost=n,e.attacherIdx=nf(n,t),of(i,t),t.host=i,t},tf.prototype.revert=function(e){var t=e.shape,i=e.newHost,n=e.oldHost,o=e.attacherIdx;return t.host=n,nf(i,t),of(n,t,o),t},af.prototype.execute=function(e){var t=e.connection,i=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=i,t},af.prototype.revert=function(e){var t=e.connection,i=e.oldWaypoints;return t.waypoints=i,t},sf.$inject=["eventBus","elementFactory","commandStack"],sf.prototype.getHandlers=function(){return{"shape.append":xm,"shape.create":km,"shape.delete":Fm,"shape.move":Nm,"shape.resize":Hm,"shape.replace":Um,"shape.toggleCollapse":Xm,spaceTool:qm,"label.create":Am,"connection.create":$m,"connection.delete":Pm,"connection.move":Tm,"connection.layout":Im,"connection.updateWaypoints":af,"connection.reconnect":Wm,"elements.create":Cm,"elements.move":Mm,"elements.delete":Lm,"elements.distribute":Vm,"elements.align":wm,"element.updateAttachment":tf}},sf.prototype.registerHandlers=function(e){se(this.getHandlers(),(function(t,i){e.registerHandler(i,t)}))},sf.prototype.moveShape=function(e,t,i,n,o){"object"==typeof n&&(o=n,n=null);var a={shape:e,delta:t,newParent:i,newParentIndex:n,hints:o||{}};this._commandStack.execute("shape.move",a)},sf.prototype.updateAttachment=function(e,t){var i={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",i)},sf.prototype.moveElements=function(e,t,i,n){var o,a=(n=n||{}).attach,s=i;!0===a?(o=i,s=i.parent):!1===a&&(o=null);var r={shapes:e,delta:t,newParent:s,newHost:o,hints:n};this._commandStack.execute("elements.move",r)},sf.prototype.moveConnection=function(e,t,i,n,o){"object"==typeof n&&(o=n,n=void 0);var a={connection:e,delta:t,newParent:i,newParentIndex:n,hints:o||{}};this._commandStack.execute("connection.move",a)},sf.prototype.layoutConnection=function(e,t){var i={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",i)},sf.prototype.createConnection=function(e,t,i,n,o,a){"object"==typeof i&&(a=o,o=n,n=i,i=void 0);var s={source:e,target:t,parent:o,parentIndex:i,connection:n=this._create("connection",n),hints:a};return this._commandStack.execute("connection.create",s),s.connection},sf.prototype.createShape=function(e,t,i,n,o){"number"!=typeof n&&(o=n,n=void 0);var a,s,r=(o=o||{}).attach;e=this._create("shape",e),r?(a=i.parent,s=i):a=i;var l={position:t,shape:e,parent:a,parentIndex:n,host:s,hints:o};return this._commandStack.execute("shape.create",l),l.shape},sf.prototype.createElements=function(e,t,i,n,o){Q(e)||(e=[e]),"number"!=typeof n&&(o=n,n=void 0);var a={position:t,elements:e,parent:i,parentIndex:n,hints:o=o||{}};return this._commandStack.execute("elements.create",a),a.elements},sf.prototype.createLabel=function(e,t,i,n){i=this._create("label",i);var o={labelTarget:e,position:t,parent:n||e.parent,shape:i};return this._commandStack.execute("label.create",o),o.shape},sf.prototype.appendShape=function(e,t,i,n,o){o=o||{};var a={source:e,position:i,target:n,shape:t=this._create("shape",t),connection:o.connection,connectionParent:o.connectionParent,hints:o};return this._commandStack.execute("shape.append",a),a.shape},sf.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},sf.prototype.distributeElements=function(e,t,i){var n={groups:e,axis:t,dimension:i};this._commandStack.execute("elements.distribute",n)},sf.prototype.removeShape=function(e,t){var i={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",i)},sf.prototype.removeConnection=function(e,t){var i={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",i)},sf.prototype.replaceShape=function(e,t,i){var n={oldShape:e,newData:t,hints:i||{}};return this._commandStack.execute("shape.replace",n),n.newShape},sf.prototype.alignElements=function(e,t){var i={elements:e,alignment:t};this._commandStack.execute("elements.align",i)},sf.prototype.resizeShape=function(e,t,i,n){var o={shape:e,newBounds:t,minBounds:i,hints:n};this._commandStack.execute("shape.resize",o)},sf.prototype.createSpace=function(e,t,i,n,o){var a={delta:i,direction:n,movingShapes:e,resizingShapes:t,start:o};this._commandStack.execute("spaceTool",a)},sf.prototype.updateWaypoints=function(e,t,i){var n={connection:e,newWaypoints:t,hints:i||{}};this._commandStack.execute("connection.updateWaypoints",n)},sf.prototype.reconnect=function(e,t,i,n,o){var a={connection:e,newSource:t,newTarget:i,dockingOrPoints:n,hints:o||{}};this._commandStack.execute("connection.reconnect",a)},sf.prototype.reconnectStart=function(e,t,i,n){n||(n={}),this.reconnect(e,t,e.target,i,Se(n,{docking:"source"}))},sf.prototype.reconnectEnd=function(e,t,i,n){n||(n={}),this.reconnect(e,e.source,t,i,Se(n,{docking:"target"}))},sf.prototype.connect=function(e,t,i,n){return this.createConnection(e,t,i||{},e.parent,n)},sf.prototype._create=function(e,t){return t instanceof Bi?t:this._elementFactory.create(e,t)},sf.prototype.toggleCollapse=function(e,t){var i={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",i)},rf.$inject=["elementRegistry"],rf.prototype.execute=function(e){var t=e.element,i=e.moddleElement,n=e.properties;if(!i)throw new Error("<moddleElement> required");var o=e.changed||this.getVisualReferences(i).concat(t),a=e.oldProperties||function(e,t){return re(t,(function(t,i){return t[i]=e.get(i),t}),{})}(i,ue(n));return lf(i,n),e.oldProperties=a,e.changed=o,o},rf.prototype.revert=function(e){var t=e.oldProperties,i=e.moddleElement,n=e.changed;return lf(i,t),n},rf.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return wo(e,"bpmn:DataObject")?function(e,t){return t.filter((function(t){return wo(t,"bpmn:DataObjectReference")&&$o(t).dataObjectRef===e}))}(e,t):[]};var cf={width:0,height:0};function df(e,t,i,n,o){this._elementRegistry=e,this._moddle=t,this._translate=i,this._modeling=n,this._textRenderer=o}function uf(e,t){return"id"in e&&e.id!==t.id}function hf(e,t){var i=e.businessObject,n=_o(e);se(t,(function(e,t){"di"!==t?i.set(t,e):n&&function(e,t){se(t,(function(t,i){e.set(i,t)}))}(n,e)}))}df.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"],df.prototype.execute=function(e){var t=e.element,i=[t],n=this._translate;if(!t)throw new Error(n("element required"));var o=this._elementRegistry,a=this._moddle.ids,s=t.businessObject,r=function(e){var t=Se({},e);return pf.forEach((function(i){i in e&&(t[i]=$o(t[i]))})),t}(e.properties),l=e.oldProperties||function(e,t){var i=ue(t),n=e.businessObject,o=_o(e);return re(i,(function(e,i){return e[i]="di"!==i?n.get(i):function(e,t){return re(t,(function(t,i){return t[i]=e&&e.get(i),t}),{})}(o,ue(t.di)),e}),{})}(t,r);return uf(r,s)&&(a.unclaim(s.id),o.updateId(t,r.id),a.claim(r.id,s)),"default"in r&&(r.default&&i.push(o.get(r.default.id)),s.default&&i.push(o.get(s.default.id))),hf(t,r),e.oldProperties=l,e.changed=i,i},df.prototype.postExecute=function(e){var t=e.element.label,i=t&&$o(t).name;if(i){var n=this._textRenderer.getExternalLabelBounds(t,i);this._modeling.resizeShape(t,n,cf)}},df.prototype.revert=function(e){var t=e.element,i=e.properties,n=e.oldProperties,o=t.businessObject,a=this._elementRegistry,s=this._moddle.ids;return hf(t,n),uf(i,o)&&(s.unclaim(i.id),a.updateId(t,n.id),s.claim(n.id,o)),e.changed};var pf=["default"];function mf(e,t){this._canvas=e,this._modeling=t}function ff(e,t){this._modeling=e,this._spaceTool=t}function gf(e,t){this._modeling=e,this._translate=t}function vf(e,t){this._modeling=e,this._spaceTool=t}mf.$inject=["canvas","modeling"],mf.prototype.execute=function(e){var t=this._canvas,i=e.newRoot,n=i.businessObject,o=t.getRootElement(),a=o.businessObject,s=a.$parent,r=_o(o);t.setRootElement(i),t.removeRootElement(o),oi(s.rootElements,n),n.$parent=s,ni(s.rootElements,a),a.$parent=null,o.di=null,r.bpmnElement=n,i.di=r,e.oldRoot=o},mf.prototype.revert=function(e){var t=this._canvas,i=e.newRoot,n=i.businessObject,o=e.oldRoot,a=o.businessObject,s=n.$parent,r=_o(i);t.setRootElement(o),t.removeRootElement(i),ni(s.rootElements,n),n.$parent=null,oi(s.rootElements,a),a.$parent=s,i.di=null,r.bpmnElement=a,o.di=r},ff.$inject=["modeling","spaceTool"],ff.prototype.preExecute=function(e){var t=this._spaceTool,i=this._modeling,n=e.shape,o=e.location,a=ad(n),s=a===n,r=s?n:n.parent;od(r).length||i.createShape({type:"bpmn:Lane"},{x:n.x+id,y:n.y,width:n.width-id,height:n.height},r);var l=[];Zt(a,(function(e){return l.push(e),e.label&&l.push(e.label),e===n?[]:ae(e.children,(function(e){return e!==n}))}));var c="top"===o?-120:120,d="top"===o?n.y:n.y+n.height,u=d+("top"===o?10:-10),h="top"===o?"n":"s",p=t.calculateAdjustments(l,"y",c,u);t.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:c},h,u),e.newLane=i.createShape({type:"bpmn:Lane"},{x:n.x+(s?id:0),y:d-("top"===o?120:0),width:n.width-(s?id:0),height:120},r)},gf.$inject=["modeling","translate"],gf.prototype.preExecute=function(e){var t=this._modeling,i=this._translate,n=e.shape,o=e.count,a=od(n),s=a.length;if(s>o)throw new Error(i("more than {count} child lanes",{count:o}));var r,l,c,d,u,h=Math.round(n.height/o);for(u=0;u<o;u++)r=n.y+u*h,l=u===o-1?n.height-h*u:h,c={x:n.x+id,y:r,width:n.width-id,height:l},u<s?t.resizeShape(a[u],c):(d={type:"bpmn:Lane"},t.createShape(d,c,n))},vf.$inject=["modeling","spaceTool"],vf.prototype.preExecute=function(e){var t=e.shape,i=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,i):this.resizeSpace(t,i)},vf.prototype.resizeBalanced=function(e,t){var i=this._modeling,n=function(e,t){var i=ad(e),n=nd(i,wo(i,"bpmn:Process")?[]:[i]),o=fi(e),a=fi(t),s=function(e,t){return Yc(fi(t),fi(e))}(e,t),r=[];return n.forEach((function(t){if(t!==e){var i=0,n=s.right,l=0,c=s.left,d=fi(t);s.top&&(ed(d.bottom-o.top)<10&&(l=a.top-d.bottom),ed(d.top-o.top)<5&&(i=a.top-d.top)),s.bottom&&(ed(d.top-o.bottom)<10&&(i=a.bottom-d.top),ed(d.bottom-o.bottom)<5&&(l=a.bottom-d.bottom)),(i||n||l||c)&&r.push({shape:t,newBounds:Zc(t,{top:i,right:n,bottom:l,left:c})})}})),r}(e,t);i.resizeShape(e,t),n.forEach((function(e){i.resizeShape(e.shape,e.newBounds)}))},vf.prototype.resizeSpace=function(e,t){var i,n,o,a,s,r=this._spaceTool,l=fi(e),c=Yc(fi(t),l),d=ad(e),u=[],h=[];Zt(d,(function(e){return u.push(e),(wo(e,"bpmn:Lane")||wo(e,"bpmn:Participant"))&&h.push(e),e.children})),(c.bottom||c.top)&&(i=c.bottom||c.top,n=e.y+(c.bottom?e.height:0)+(c.bottom?-10:10),o=c.bottom?"s":"n",a=c.top>0||c.bottom<0?-i:i,s=r.calculateAdjustments(u,"y",a,n),r.makeSpace(s.movingShapes,s.resizingShapes,{x:0,y:i},o)),(c.left||c.right)&&(i=c.right||c.left,n=e.x+(c.right?e.width:0)+(c.right?-10:100),o=c.right?"e":"w",a=c.left>0||c.right<0?-i:i,s=r.calculateAdjustments(h,"x",a,n),r.makeSpace(s.movingShapes,s.resizingShapes,{x:i,y:0},o))};var bf="flowNodeRef",yf="lanes";function wf(e){this._elementRegistry=e}function xf(e){this._moddle=e}wf.$inject=["elementRegistry"],wf.prototype.computeUpdates=function(e,t){var i=[],n=[],o={},a=[];function s(e){-1===i.indexOf(e)&&(a.push(e),i.push(e))}return t.forEach((function(e){var t=ad(e);t&&-1===i.indexOf(t)&&(t.children.filter((function(e){return wo(e,"bpmn:FlowNode")})).forEach(s),i.push(t))})),e.forEach(s),a.forEach((function(e){var t=e.businessObject,i=t.get(yf).slice(),a=function(e){if(!e.parent)return[];var t=function(e){var t=ad(e);return o[t.id]||(o[t.id]=nd(t)),o[t.id]}(e);return t.filter((function(t){return i=e,n=fi(t),o=i.x+i.width/2,a=i.y+i.height/2,o>n.left&&o<n.right&&a>n.top&&a<n.bottom;var i,n,o,a})).map((function(e){return e.businessObject}))}(e);n.push({flowNode:t,remove:i,add:a})})),t.forEach((function(e){var t=e.businessObject;e.parent||t.get(bf).forEach((function(e){n.push({flowNode:e,remove:[t],add:[]})}))})),n},wf.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach((function(e){var t=e.flowNode,i=t.get(yf);e.remove.forEach((function(e){ni(i,e),ni(e.get(bf),t)})),e.add.forEach((function(e){oi(i,e),oi(e.get(bf),t)}))}))},wf.prototype.revert=function(e){e.updates.forEach((function(e){var t=e.flowNode,i=t.get(yf);e.add.forEach((function(e){ni(i,e),ni(e.get(bf),t)})),e.remove.forEach((function(e){oi(i,e),oi(e.get(bf),t)}))}))},xf.$inject=["moddle"],xf.prototype.execute=function(e){var t=this._moddle.ids,i=e.id,n=e.element;e.claiming?t.claim(i,n):t.unclaim(i)},xf.prototype.revert=function(e){var t=this._moddle.ids,i=e.id,n=e.element;e.claiming?t.unclaim(i):t.claim(i,n)};var $f={fill:void 0,stroke:void 0};function _f(e){this._commandStack=e,this._normalizeColor=function(e){if(e){if(ie(e)){var t=function(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}(e);if(t)return t}throw new Error("invalid color value: "+e)}}}_f.$inject=["commandStack"],_f.prototype.postExecute=function(e){var t=e.elements,i=e.colors||$f,n=this,o={};"fill"in i&&Se(o,{"background-color":this._normalizeColor(i.fill)}),"stroke"in i&&Se(o,{"border-color":this._normalizeColor(i.stroke)}),se(t,(function(e){var t=function(e){return!!e.waypoints}(e)?ke(o,["border-color"]):o;!function(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}(t),e.labelTarget?n._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:_o(e).label,properties:{color:o["background-color"]}}):n._commandStack.execute("element.updateProperties",{element:e,properties:{di:t}})}))};var Cf={width:0,height:0};function Ef(e,t,i){function n(e,t){var n=e.label||e,o=e.labelTarget||e;return function(e,t,i){var n=e.businessObject,o=Oo(n);o&&("categoryValueRef"===o?n.categoryValueRef.value=t:n[o]=t)}(n,t),function(e,t){if(!la(e)){var n=_o(e);t&&!n.label&&(n.label=i.create("bpmndi:BPMNLabel")),!t&&n.label&&(n.label=null)}}(e,t),[n,o]}this.preExecute=function(t){var i=t.element,n=i.businessObject,o=t.newLabel;if(!ua(i)&&la(i)&&!ca(i)&&!Sf(o)){var a=da(i);a={x:a.x,y:a.y+7},e.createLabel(i,a,{id:n.id+"_label",businessObject:n,di:i.di})}},this.execute=function(e){return e.oldLabel=Mo(e.element),n(e.element,e.newLabel)},this.revert=function(e){return n(e.element,e.oldLabel)},this.postExecute=function(i){var n=i.element,o=n.label||n,a=i.newLabel,s=i.newBounds,r=i.hints||{};if(ua(o)||wo(o,"bpmn:TextAnnotation"))if(ua(o)&&Sf(a))!1!==r.removeShape&&e.removeShape(o,{unsetLabel:!1});else{var l=Mo(o);void 0===s&&(s=t.getExternalLabelBounds(o,l)),s&&e.resizeShape(o,s,Cf)}}}function Sf(e){return!e||!e.trim()}function kf(e,t,i,n){sf.call(this,e,t,i),this._bpmnRules=n}function Af(){}Ef.$inject=["modeling","textRenderer","bpmnFactory"],W()(kf,sf),kf.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],kf.prototype.getHandlers=function(){var e=sf.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=rf,e["element.updateProperties"]=df,e["canvas.updateRoot"]=mf,e["lane.add"]=ff,e["lane.resize"]=vf,e["lane.split"]=gf,e["lane.updateRefs"]=wf,e["id.updateClaim"]=xf,e["element.setColor"]=_f,e["element.updateLabel"]=Ef,e},kf.prototype.updateLabel=function(e,t,i,n){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:i,hints:n||{}})},kf.prototype.connect=function(e,t,i,n){var o=this._bpmnRules;if(i||(i=o.canConnect(e,t)),i)return this.createConnection(e,t,i,e.parent,n)},kf.prototype.updateModdleProperties=function(e,t,i){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:i})},kf.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},kf.prototype.resizeLane=function(e,t,i){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:i})},kf.prototype.addLane=function(e,t){var i={shape:e,location:t};return this._commandStack.execute("lane.add",i),i.newLane},kf.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},kf.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},kf.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},kf.prototype.makeProcess=function(){var e={newRoot:this._create("root",{type:"bpmn:Process"})};this._commandStack.execute("canvas.updateRoot",e)},kf.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},kf.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},kf.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})},Af.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||vi(t.source||e.source),t.connectionEnd||vi(t.target||e.target)]};var Rf=Math.round,Df={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function Pf(e,t,i){var n,o,a,s=bi(t,e,5),r=i.split(":")[0],l=Rf((t.x-e.x)/2+e.x),c=Rf((t.y-e.y)/2+e.y),d=(a=s,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[r].test(a)),u=/h|r|l/.test(r),h=!1,p=!1;return d?(n=u?{x:l,y:e.y}:{x:e.x,y:c},o=u?"h:h":"v:v"):(h=function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(s,r),o=u?"h:v":"v:h",h?u?(p=c===e.y,n={x:e.x+20*(/l/.test(r)?-1:1),y:p?c+20:c}):n={x:(p=l===e.x)?l+20:l,y:e.y+20*(/t/.test(r)?-1:1)}:n={x:l,y:c}),{waypoints:Ff(e,n,o).concat(n),directions:o,turnNextDirections:p}}function Lf(e){return e.split(":").reverse().join(":")}function Ff(e,t,i){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(i=i||"h:h"))throw new Error("unknown directions: <"+i+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Tf(i)){var n=function(e,t,i){return Pf(e,t,i)}(e,t,i),o=function(e,t,i){var n=Pf(t,e,Lf(i));return{waypoints:n.waypoints.slice().reverse(),directions:Lf(n.directions),turnNextDirections:n.turnNextDirections}}(e,t,i),a=function(e,t){var i=e.directions.split(":")[1],n=t.directions.split(":")[0];e.turnNextDirections&&(i="h"==i?"v":"h"),t.turnNextDirections&&(n="h"==n?"v":"h");var o=i+":"+n;return{waypoints:Ff(e.waypoints[e.waypoints.length-1],t.waypoints[0],o),directions:o}}(n,o);return[].concat(n.waypoints,a.waypoints,o.waypoints)}return function(e,t,i){var n=Rf((t.x-e.x)/2+e.x),o=Rf((t.y-e.y)/2+e.y);if("h:v"===i)return[{x:t.x,y:e.y}];if("v:h"===i)return[{x:e.x,y:t.y}];if("h:h"===i)return[{x:n,y:e.y},{x:n,y:t.y}];if("v:v"===i)return[{x:e.x,y:o},{x:t.x,y:o}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,i)}function Vf(e,t,i,n,o){var a,s,r=(a=o&&o.preferredLayouts||[],s="straight",Z(a)?[]:(function(e){if(!Q(e))throw new Error("must supply array")}(a),s=we(s),a.filter((function(e,t){return!s(e,t)}))))[0]||"h:h",l=bi(e,t,Df[r]||0),c=function(e,t){if(Tf(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(l,r);i=i||vi(e),n=n||vi(t);var d=c.split(":"),u=jf(i,e,d[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(l));return function(e,t,i){var n=Ff(e,t,i);return n.unshift(e),n.push(t),Of(n)}(u,jf(n,t,d[1],l),c)}function Bf(e,t,i){return function(e,t,i){return e>=t&&e<=i}(t[e],i[e],i[e]+i[{x:"width",y:"height"}[e]])}function If(e,t,i,n){if(function(e){return e.length<3||!(e.length>4)&&!!oe(e,(function(t,i){var n=e[i-1];return n&&si(t,n)<3}))}(n))return null;var o,a=n[0],s=n.slice();return s[0]=i,s[1]=function(e,t,i){switch(li(t,e)){case"v":return{x:i.x,y:e.y};case"h":return{x:e.x,y:i.y}}return{x:e.x,y:e.y}}(s[1],a,i),o=function(e,t,i){var n;for(n=e.length-2;0!==n;n--)if(ci(e[n],t,20)||ci(e[n],i,20))return e.slice(n);return e}(s,e,t),o!==s&&(s=If(e,t,i,o)),s&&li(s)?null:s}function Tf(e){return e&&/t|r|b|l/.test(e)}function jf(e,t,i,n){if("h"===i&&(i=/left/.test(n)?"l":"r"),"v"===i&&(i=/top/.test(n)?"t":"b"),"t"===i)return{original:e,x:e.x,y:t.y};if("r"===i)return{original:e,x:t.x+t.width,y:e.y};if("b"===i)return{original:e,x:e.x,y:t.y+t.height};if("l"===i)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+i+">")}function Of(e){return e.reduce((function(t,i,n){return ri(t[t.length-1],e[n+1],i,0)||t.push(i),t}),[])}var Mf={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Nf={top:"t",right:"r",bottom:"b",left:"l"};function Wf(){}function zf(e,t){return wo(t,"bpmn:Participant")?"source":wo(e,"bpmn:Participant")?"target":Gf(t)?"source":Gf(e)||wo(t,"bpmn:Event")?"target":wo(e,"bpmn:Event")?"source":null}function Uf(e){return Gf(e)?"target":"source"}function Hf(e,t){return e?e.original||e:vi(t)}function qf(e,t){return wo(t,"bpmn:Activity")&&wo(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Gf(e){return wo(e,"bpmn:SubProcess")&&Io(e)}function Yf(e,t){return e===t}function Zf(e){var t=/right|left/.exec(e);return t&&t[0]}function Kf(e){var t=/top|bottom/.exec(e);return t&&t[0]}function Xf(e){return"right"===e||"left"===e}function Qf(e,t){var i=t.waypoints,n=i&&i.length&&bi(i[0],e);return"top"===n?["t:r"]:"right"===n?["r:b"]:"left"===n?["l:t"]:["b:l"]}function Jf(e,t,i){var n,o,a,s,r=vi(e),l=vi(t),c=(s=(a=e).host,bi(vi(a),s,-10)),d=Yf(e.host,t),u=-1!==["top","right","bottom","left"].indexOf(c),h=bi(l,r,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return d?function(e,t,i,n,o){var a=t?e:Kf(e);return[Nf[a]+":"+(t?Xf(e)?eg("y",i,n,o)?"h":"b":eg("x",i,n,o)?"v":"l":"v")]}(c,u,e,t,i):(n=function(e,t,i){return i?Nf[e]:Yf(Kf(e),Kf(t))||(n=Zf(e),o=Zf(t),Mf[n]===o)?Nf[Kf(e)]:Nf[Zf(e)];var n,o}(c,h,u),o=function(e,t,i){return i?Xf(e)?(n=t,o=Zf(e),a=Mf[o],-1!==n.indexOf(a)||Yf(e,t)?"h":"v"):function(e,t){var i=Kf(e),n=Mf[i];return-1!==t.indexOf(n)}(e,t)||Yf(e,t)?"v":"h":Xf(t)||Yf(Kf(e),Kf(t))&&Zf(t)?"h":"v";var n,o,a}(c,h,u),[n+":"+o])}function eg(e,t,i,n){return!(tg(e,n,i,40)||tg(e,n,{x:i.x+i.width,y:i.y+i.height},40)||tg(e,n,vi(t),40))}function tg(e,t,i,n){return Math.abs(t[e]-i[e])<n}function ig(e){return Se({original:e.point.original||e.point},e.actual)}function ng(e,t){this._elementRegistry=e,this._graphicsFactory=t}W()(Wf,Af),Wf.prototype.layoutConnection=function(e,t){t||(t={});var i,n,o=t.source||e.source,a=t.target||e.target,s=t.waypoints||e.waypoints,r=t.connectionStart,l=t.connectionEnd;return r||(r=Hf(s&&s[0],o)),l||(l=Hf(s&&s[s.length-1],a)),(wo(e,"bpmn:Association")||wo(e,"bpmn:DataAssociation"))&&s&&!qf(o,a)?[].concat([r],s.slice(1,-1),[l]):(wo(e,"bpmn:MessageFlow")?i=function(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:zf(e,t)}}(o,a):(wo(e,"bpmn:SequenceFlow")||qf(o,a))&&(i=o===a?{preferredLayouts:Qf(o,e)}:wo(o,"bpmn:BoundaryEvent")?{preferredLayouts:Jf(o,a,l)}:Gf(o)||Gf(a)?function(e){return{preferredLayouts:["straight","h:h"],preserveDocking:Uf(e)}}(o):wo(o,"bpmn:Gateway")?{preferredLayouts:["v:h"]}:wo(a,"bpmn:Gateway")?{preferredLayouts:["h:v"]}:{preferredLayouts:["h:h"]}),i&&(n=Of(function(e,t,i,n,o,a){var s;return Q(i)&&(o=i,a=n,i=vi(e),n=vi(t)),o=o||[],s=-1!==(a=Se({preferredLayouts:[]},a)).preferredLayouts.indexOf("straight")&&function(e,t,i,n,o){var a,s,r={};return s=bi(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(a="x"),/left|right/.test(s)&&(a="y"),"target"===o.preserveDocking?Bf(a,n,e)?(r[a]=n[a],[{x:void 0!==r.x?r.x:i.x,y:void 0!==r.y?r.y:i.y,original:{x:void 0!==r.x?r.x:i.x,y:void 0!==r.y?r.y:i.y}},{x:n.x,y:n.y}]):null:Bf(a,i,t)?(r[a]=i[a],[{x:i.x,y:i.y},{x:void 0!==r.x?r.x:n.x,y:void 0!==r.y?r.y:n.y,original:{x:void 0!==r.x?r.x:n.x,y:void 0!==r.y?r.y:n.y}}]):null):null}(e,t,i,n,a),s||(s=a.connectionEnd&&function(e,t,i,n){var o=n.slice().reverse();return(o=If(e,t,i,o))?o.reverse():null}(t,e,n,o),s||(s=a.connectionStart&&If(e,t,i,o))||(!a.connectionStart&&!a.connectionEnd&&o&&o.length?o:Vf(e,t,i,n,a)))}(o,a,r,l,s,i=Se(i,t)))),n||[r,l])},ng.$inject=["elementRegistry","graphicsFactory"],ng.prototype.getCroppedWaypoints=function(e,t,i){t=t||e.source,i=i||e.target;var n=this.getDockingPoint(e,t,!0),o=this.getDockingPoint(e,i),a=e.waypoints.slice(n.idx+1,o.idx);return a.unshift(ig(n)),a.push(ig(o)),a},ng.prototype.getDockingPoint=function(e,t,i){var n,o,a=e.waypoints;return{point:o=a[n=i?0:a.length-1],actual:this._getIntersection(t,e,i)||o,idx:n}},ng.prototype._getIntersection=function(e,t,i){return yi(this._getShapePath(e),this._getConnectionPath(t),i)},ng.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},ng.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},ng.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const og={__init__:["modeling","bpmnUpdater"],__depends__:[Yh,Ap,Dp,Fp,Sc,Bp,Mp,Up,Yp,Ta,qa,mm],bpmnFactory:["type",fm],bpmnUpdater:["type",gm],elementFactory:["type",bm],modeling:["type",kf],layouter:["type",Wf],connectionDocking:["type",ng]};var ag=Math.round;function sg(e,t,i,n,o){function a(e,t,i,n){return o.allowed("elements.move",{shapes:e,delta:t,position:i,target:n})}function s(e,i,n,o){if(J(n)&&(o=n,n=!1),!i.waypoints&&i.parent){var a=function(e){return{x:e.x+ag(e.width/2),y:e.y+ag(e.height/2)}}(i);return t.init(e,a,"shape.move",{cursor:"grabbing",autoActivate:n,data:{shape:i,context:o||{}}}),!0}}e.on("shape.move.start",1500,(function(e){var t=e.context,i=e.shape,o=n.get().slice();-1===o.indexOf(i)&&(o=[i]),o=function(e){var t=me(e,"id");return ae(e,(function(e){for(;e=e.parent;)if(t[e.id])return!1;return!0}))}(o),Se(t,{shapes:o,validatedShapes:o,shape:i})})),e.on("shape.move.start",1250,(function(e){var t=e.context,i=t.validatedShapes;if(!(t.canExecute=a(i)))return!1})),e.on("shape.move.move",500,(function(e){var t,i=e.context,n=i.validatedShapes,o=e.hover,s={x:e.dx,y:e.dy};t=a(n,s,{x:e.x,y:e.y},o),i.delta=s,i.canExecute=t,i.target=null!==t?o:null})),e.on("shape.move.end",(function(e){var t=e.context,n=t.delta,o=t.canExecute,a="attach"===o,s=t.shapes;if(!1===o)return!1;n.x=ag(n.x),n.y=ag(n.y),0===n.x&&0===n.y||i.moveElements(s,n,t.target,{primaryShape:t.shape,attach:a})})),e.on("element.mousedown",(function(e){if($a(e)){var t=ba(e);if(!t)throw new Error("must supply DOM mousedown event");return s(t,e.element)}})),this.start=s}sg.$inject=["eventBus","dragging","modeling","selection","rules"];var rg="djs-dragging",lg="drop-ok",cg="drop-not-ok",dg="new-parent",ug="attach-ok";function hg(e,t,i,n){function o(e){var t=Kt(e,!0),i=de(t,(function(e){return(e.incoming||[]).concat(e.outgoing||[])}));return q(t.concat(i))}function a(e,i){[ug,lg,cg,dg].forEach((function(n){n===i?t.addMarker(e,n):t.removeMarker(e,n)}))}e.on("shape.move.start",499,(function(e){var a,s=e.context,r=s.shapes,l=s.allDraggedElements,c=ae(a=o(r),(function(e){return!function(e){return e.waypoints}(e)||oe(a,be({id:e.source.id}))&&oe(a,be({id:e.target.id}))}));if(!s.dragGroup){var d=bt("g");at(d,i.cls("djs-drag-group",["no-events"])),it(t.getActiveLayer(),d),s.dragGroup=d}c.forEach((function(e){n.addDragger(e,s.dragGroup)})),se(l=l?q([l,o(r)]):o(r),(function(e){t.addMarker(e,rg)})),s.allDraggedElements=l,s.differentParents=1!==he(me(r,(function(e){return e.parent&&e.parent.id})))})),e.on("shape.move.move",499,(function(e){var t=e.context,i=t.dragGroup,n=t.target,o=t.shape.parent,s=t.canExecute;n&&("attach"===s?a(n,ug):t.canExecute&&n&&n.id!==o.id?a(n,dg):a(n,t.canExecute?lg:cg)),Gi(i,e.dx,e.dy)})),e.on(["shape.move.out","shape.move.cleanup"],(function(e){var t=e.context.target;t&&a(t,null)})),e.on("shape.move.cleanup",(function(e){var i=e.context,n=i.allDraggedElements,o=i.dragGroup;se(n,(function(e){t.removeMarker(e,rg)})),o&&ht(o)})),this.makeDraggable=function(e,i,o){n.addDragger(i,e.dragGroup),o&&t.addMarker(i,rg),e.allDraggedElements?e.allDraggedElements.push(i):e.allDraggedElements=[i]}}hg.$inject=["eventBus","canvas","styles","previewSupport"];const pg={__depends__:[Aa,Ta,Da,Lr,Ar,Ml],__init__:["move","movePreview"],move:["type",sg],movePreview:["type",hg]};var mg="open";function fg(e,t){this._eventBus=e,this._canvas=t;var i=this;e.on("tool-manager.update",(function(e){var t=e.tool;i.updateToolHighlight(t)})),e.on("i18n.changed",(function(){i._update()})),e.on("diagram.init",(function(){i._diagramInitialized=!0,i._rebuild()}))}function gg(e,t){var i=t.getPaletteEntries();return te(i)?i(e):(se(i,(function(t,i){e[i]=t})),e)}fg.$inject=["eventBus","canvas"],fg.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("palette.getProviders",e,(function(e){e.providers.push(t)})),this._rebuild()},fg.prototype.getEntries=function(){return this._getProviders().reduce(gg,{})},fg.prototype._rebuild=function(){this._diagramInitialized&&this._getProviders().length&&(this._container||this._init(),this._update())},fg.prototype._init=function(){var e=this,t=this._eventBus,i=this._getParentContainer(),n=this._container=Ze(fg.HTML_MARKUP);i.appendChild(n),Ve(i).add("djs-palette-shown"),Ge(n,".djs-palette-toggle, .entry","click",(function(t){var i=t.delegateTarget;if(Oe(i,".djs-palette-toggle"))return e.toggle();e.trigger("click",t)})),He.bind(n,"mousedown",(function(e){e.stopPropagation()})),Ge(n,".entry","dragstart",(function(t){e.trigger("dragstart",t)})),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:n})},fg.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},fg.prototype._toggleState=function(e){e=e||{};var t,i=this._getParentContainer(),n=this._container,o=this._eventBus,a=Ve(n),s=Ve(i);t="twoColumn"in e?e.twoColumn:this._needsCollapse(i.clientHeight,this._entries||{}),a.toggle("two-column",t),s.toggle("djs-palette-two-column",t),"open"in e&&(a.toggle(mg,e.open),s.toggle("djs-palette-open",e.open)),o.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},fg.prototype._update=function(){var e=Qe(".djs-palette-entries",this._container),t=this._entries=this.getEntries();Ie(e),se(t,(function(t,i){var n=t.group||"default",o=Qe("[data-group="+n+"]",e);o||(o=Ze('<div class="group" data-group="'+n+'"></div>'),e.appendChild(o));var a=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=Ze(a);o.appendChild(s),t.separator||(Re(s,"data-action",i),t.title&&Re(s,"title",t.title),t.className&&function(e,t){var i=Ve(e);(Q(t)?t:t.split(/\s+/g)).forEach((function(e){i.add(e)}))}(s,t.className),t.imageUrl&&s.appendChild(Ze('<img src="'+t.imageUrl+'">')))})),this.open()},fg.prototype.trigger=function(e,t,i){var n,o,a,s=this._entries,r=t.delegateTarget||t.target;if(!r)return t.preventDefault();(n=s[Re(r,"data-action")])&&(o=n.action,a=t.originalEvent||t,te(o)?"click"===e&&o(a,i):o[e]&&o[e](a,i),t.preventDefault())},fg.prototype._layoutChanged=function(){this._toggleState({})},fg.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},fg.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},fg.prototype.open=function(){this._toggleState({open:!0})},fg.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},fg.prototype.isActiveTool=function(e){return e&&this._activeTool===e},fg.prototype.updateToolHighlight=function(e){var t;this._toolsContainer||(t=Qe(".djs-palette-entries",this._container),this._toolsContainer=Qe("[data-group=tools]",t)),se(this._toolsContainer.children,(function(t){var i=t.getAttribute("data-action");if(i){var n=Ve(t);i=i.replace("-tool",""),n.contains("entry")&&i===e?n.add("highlighted-entry"):n.remove("highlighted-entry")}}))},fg.prototype.isOpen=function(){return Ve(this._container).has(mg)},fg.prototype._getParentContainer=function(){return this._canvas.getContainer()},fg.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';const vg={__init__:["palette"],palette:["type",fg]};var bg="crosshair";function yg(e,t,i,n,o,a,s){this._selection=o,this._dragging=i,this._mouse=s;var r=this;a.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",(function(t){var i=t.originalEvent.target;(t.hover||i instanceof SVGElement)&&e.once("lasso.selection.ended",(function(){r.activateLasso(t.originalEvent,!0)}))})),e.on("lasso.end",(function(e){var t=wg(e),i=n.filter((function(e){return e}));r.select(i,t)})),e.on("lasso.start",(function(e){var i=e.context;i.bbox=wg(e),function(e){var i,n=t.getActiveLayer();at(i=e.frame=bt("rect"),{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),it(n,i)}(i)})),e.on("lasso.move",(function(e){var t=e.context;t.bbox=wg(e),function(e){var t=e.frame,i=e.bbox;at(t,{x:i.x,y:i.y,width:i.width,height:i.height})}(t)})),e.on("lasso.cleanup",(function(e){!function(e){e.frame&&ht(e.frame)}(e.context)})),e.on("element.mousedown",1500,(function(e){if(Ca(e))return r.activateLasso(e.originalEvent),!0}))}function wg(e){var t={x:e.x-e.dx,y:e.y-e.dy},i={x:e.x,y:e.y};return t.x<=i.x&&t.y<i.y||t.x<i.x&&t.y<=i.y?{x:t.x,y:t.y,width:i.x-t.x,height:i.y-t.y}:t.x>=i.x&&t.y<i.y||t.x>i.x&&t.y<=i.y?{x:i.x,y:t.y,width:t.x-i.x,height:i.y-t.y}:t.x<=i.x&&t.y>i.y||t.x<i.x&&t.y>=i.y?{x:t.x,y:i.y,width:i.x-t.x,height:t.y-i.y}:t.x>=i.x&&t.y>i.y||t.x>i.x&&t.y>=i.y?{x:i.x,y:i.y,width:t.x-i.x,height:t.y-i.y}:{x:i.x,y:i.y,width:0,height:0}}yg.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"],yg.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:bg,data:{context:{}}})},yg.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:bg,data:{context:{}}})},yg.prototype.select=function(e,t){var i=function(e,t){var i={};return se(e,(function(e){var n=e;n.waypoints&&(n=Xt(n)),!ee(t.y)&&n.x>t.x&&(i[e.id]=e),!ee(t.x)&&n.y>t.y&&(i[e.id]=e),n.x>t.x&&n.y>t.y&&(ee(t.width)&&ee(t.height)&&n.width+n.x<t.width+t.x&&n.height+n.y<t.height+t.y?i[e.id]=e:ee(t.width)&&ee(t.height)||(i[e.id]=e))})),i}(e,t);this._selection.select(pe(i))},yg.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},yg.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};const xg={__depends__:[Kp,ac],__init__:["lassoTool"],lassoTool:["type",yg]};var $g=1500,_g="grab";function Cg(e,t,i,n,o,a){this._dragging=i,this._mouse=a;var s=this,r=n.get("keyboard",!1);o.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",$g,(function(e){if(_a(e))return s.activateMove(e.originalEvent,!0),!1})),r&&r.addListener($g,(function(e){if(Eg(e.keyEvent)&&!s.isActive()){var t=s._mouse.getLastMoveEvent();s.activateMove(t,!!t)}}),"keyboard.keydown"),r&&r.addListener($g,(function(e){Eg(e.keyEvent)&&s.isActive()&&s.toggle()}),"keyboard.keyup"),e.on("hand.end",(function(t){var i=t.originalEvent.target;if(!(t.hover||i instanceof SVGElement))return!1;e.once("hand.ended",(function(){s.activateMove(t.originalEvent,{reactivate:!0})}))})),e.on("hand.move.move",(function(e){var i=t.viewbox().scale;t.scroll({dx:e.dx*i,dy:e.dy*i})})),e.on("hand.move.end",(function(t){var i=t.context.reactivate;return!_a(t)&&i&&e.once("hand.move.ended",(function(e){s.activateHand(e.originalEvent,!0,!0)})),!1}))}function Eg(e){return fs(" ",e)}Cg.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"],Cg.prototype.activateMove=function(e,t,i){"object"==typeof t&&(i=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:_g,data:{context:i||{}}})},Cg.prototype.activateHand=function(e,t,i){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:_g,data:{context:{reactivate:i}}})},Cg.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)},Cg.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^(hand|hand\.move)$/.test(e.prefix)};const Sg={__depends__:[Kp,ac],__init__:["handTool"],handTool:["type",Cg]};var kg="connect-ok",Ag="connect-not-ok";function Rg(e,t,i,n,o,a,s){var r=this;this._dragging=t,this._rules=a,this._mouse=s,o.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",(function(e){var t=e.context,i=e.hover,o=t.canStartConnect=r.canStartConnect(i);null!==o&&(t.startTarget=i,n.addMarker(i,o?kg:Ag))})),e.on(["global-connect.out","global-connect.cleanup"],(function(e){var t=e.context.startTarget,i=e.context.canStartConnect;t&&n.removeMarker(t,i?kg:Ag)})),e.on(["global-connect.ended"],(function(t){var n=t.context.startTarget,o={x:t.x,y:t.y};if(r.canStartConnect(n))return e.once("element.out",(function(){e.once(["connect.ended","connect.canceled"],(function(){e.fire("global-connect.drag.ended")})),i.start(null,n,o)})),!1}))}Rg.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"],Rg.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})},Rg.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)},Rg.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},Rg.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const Dg={__depends__:[Cl,Lr,Ar,Kp,ac],globalConnect:["type",Rg]};function Pg(e,t,i,n,o,a,s,r){this._palette=e,this._create=t,this._elementFactory=i,this._spaceTool=n,this._lassoTool=o,this._handTool=a,this._globalConnect=s,this._translate=r,e.registerProvider(this)}Pg.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],Pg.prototype.getPaletteEntries=function(e){var t={},i=this._create,n=this._elementFactory,o=this._spaceTool,a=this._lassoTool,s=this._handTool,r=this._globalConnect,l=this._translate;function c(e,t,o,a,s){function r(t){var o=n.createShape(Se({type:e},s));s&&(_o(o).isExpanded=s.isExpanded),i.start(t,o)}var c=e.replace(/^bpmn:/,"");return{group:t,className:o,title:a||l("Create {type}",{type:c}),action:{dragstart:r,click:r}}}function d(e){var t=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),o=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:t});i.start(e,[t,o],{hints:{autoSelect:[t]}})}function u(e){i.start(e,n.createParticipantShape())}return Se(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:l("Activate the hand tool"),action:{click:function(e){s.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:l("Activate the lasso tool"),action:{click:function(e){a.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:l("Activate the create/remove space tool"),action:{click:function(e){o.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:l("Activate the global connect tool"),action:{click:function(e){r.start(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",l("Create StartEvent")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",l("Create Intermediate/Boundary Event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",l("Create EndEvent")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",l("Create Gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",l("Create Task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",l("Create DataObjectReference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",l("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:l("Create expanded SubProcess"),action:{dragstart:d,click:d}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:l("Create Pool/Participant"),action:{dragstart:u,click:u}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",l("Create Group"))}),t};const Lg={__depends__:[vg,Xl,mm,xg,Sg,Dg,sa],__init__:["paletteProvider"],paletteProvider:["type",Pg]};function Fg(e,t,i,n,o){Ga.call(this,e),e.on("shape.move.move",250,(function(e){var a=e.context,s=a.canExecute;a.visualReplacements||(a.visualReplacements={}),s&&s.replacements?function(e){se(e.canExecute.replacements,(function(a){var s=a.oldElementId,r={type:a.newElementType};if(!e.visualReplacements[s]){var l=t.get(s);Se(r,{x:l.x,y:l.y});var c=i.createShape(r);n.addShape(c,l.parent);var d=Qe('[data-element-id="'+Xa()(l.id)+'"]',e.dragGroup);d&&at(d,{display:"none"});var u=o.addDragger(c,e.dragGroup);e.visualReplacements[s]=u,n.removeShape(c)}}))}(a):function(e){var t=e.visualReplacements;se(t,(function(i,n){var o=Qe('[data-element-id="'+Xa()(n)+'"]',e.dragGroup);o&&at(o,{display:"inline"}),i.remove(),t[n]&&delete t[n]}))}(a)}))}Fg.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],W()(Fg,Ga);const Vg={__depends__:[Ml],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Fg]};var Bg=["x","y"],Ig=Math.abs;function Tg(e){e.on(["connect.hover","connect.move","connect.end"],1250,(function(e){var t,i=e.context,n=i.canExecute,o=i.start,a=i.hover,s=i.source,r=i.target;e.originalEvent&&ms(e.originalEvent)||(i.initialConnectionStart||(i.initialConnectionStart=i.connectionStart),n&&a&&function(e,t,i){Bg.forEach((function(n){var o=Mg(n,t);e[n]<t[n]+i?pl(e,n,t[n]+i):e[n]>t[n]+o-i&&pl(e,n,t[n]+o-i)}))}(e,a,function(e){return wo(e,"bpmn:Task")?10:20}(a)),a&&(t=n,ce(["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],(function(e){return Og(t,e)})))?(i.connectionStart=ul(o),xo(a,["bpmn:Event","bpmn:Gateway"])&&jg(e,ul(a)),xo(a,["bpmn:Task","bpmn:SubProcess"])&&function(e,t){var i=ul(t);Bg.forEach((function(n){(function(e,t,i){return e[i]>t[i]+20&&e[i]<t[i]+Mg(i,t)-20})(e,t,n)&&pl(e,n,i[n])}))}(e,a),wo(s,"bpmn:BoundaryEvent")&&r===s.host&&function(e){var t=e.context,i=t.source,n=t.target;if(!function(e){var t=e.hover,i=e.source;return t&&i&&t===i}(t)){var o=ul(i),a=bi(o,n,-10),s=[];/top|bottom/.test(a)&&s.push("x"),/left|right/.test(a)&&s.push("y"),s.forEach((function(t){var i,n=e[t];Ig(n-o[t])<40&&(i=n>o[t]?o[t]+40:o[t]-40,pl(e,t,i))}))}}(e)):Og(n,"bpmn:MessageFlow")?(wo(o,"bpmn:Event")&&(i.connectionStart=ul(o)),wo(a,"bpmn:Event")&&jg(e,ul(a))):i.connectionStart=i.initialConnectionStart)}))}function jg(e,t){pl(e,"x",t.x),pl(e,"y",t.y)}function Og(e,t){return e&&e.type===t}function Mg(e,t){return"x"===e?t.width:t.height}function Ng(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function Wg(e){this._snapValues={}}function zg(e,t,i){var n=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],(function(e){n.initSnap(e)})),t.on(["create.move","create.end","shape.move.move","shape.move.end"],1250,(function(e){var t=e.context,o=t.shape,a=t.snapContext,s=t.target;if((!e.originalEvent||!ms(e.originalEvent))&&!hl(e)&&s){var r=a.pointsForTarget(s);r.initialized||((r=n.addSnapTargetPoints(r,o,s)).initialized=!0),i.snap(e,r)}})),t.on(["create.cleanup","shape.move.cleanup"],(function(){i.hide()}))}function Ug(e){return!!e.labelTarget}function Hg(e,t){t.invoke(zg,this),e.on(["create.move","create.end"],1500,qg),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,(function(e){var t=e.context,i=t.canExecute,n=t.target;i&&("attach"===i||i.attach)&&!hl(e)&&function(e,t){var i,n=fi(t),o=Zh(e,t),a=e.context.shape;i=a.parent?{x:0,y:0}:vi(a),/top/.test(o)?pl(e,"y",n.top-i.y):/bottom/.test(o)&&pl(e,"y",n.bottom-i.y),/left/.test(o)?pl(e,"x",n.left-i.x):/right/.test(o)&&pl(e,"x",n.right-i.x)}(e,n)}))}function qg(e){var t=e.context.createConstraints;if(t){var i=t.top,n=t.right,o=t.bottom,a=t.left;(a&&a>=e.x||n&&n<=e.x)&&pl(e,"x",e.x),(i&&i>=e.y||o&&o<=e.y)&&pl(e,"y",e.y)}}function Gg(e,t){return-1!==e.indexOf(t)}function Yg(e,t,i){return t?{x:e.x-i.x,y:e.y-i.y}:{x:e.x,y:e.y}}function Zg(e,t){var i=this;e.on(["resize.start"],(function(e){i.initSnap(e)})),e.on(["resize.move","resize.end"],1250,(function(e){var n=e.context,o=n.shape,a=o.parent,s=n.direction,r=n.snapContext;if(!(e.originalEvent&&ms(e.originalEvent)||hl(e))){var l=r.pointsForTarget(a);l.initialized||((l=i.addSnapTargetPoints(l,o,a,s)).initialized=!0),function(e){return"n"===e||"s"===e}(s)&&pl(e,"x",e.x),function(e){return"e"===e||"w"===e}(s)&&pl(e,"y",e.y),t.snap(e,l)}})),e.on(["resize.cleanup"],(function(){t.hide()}))}function Kg(e,t){var i=vi(e),n=fi(e),o={x:i.x,y:i.y};return-1!==t.indexOf("n")?o.y=n.top:-1!==t.indexOf("s")&&(o.y=n.bottom),-1!==t.indexOf("e")?o.x=n.right:-1!==t.indexOf("w")&&(o.x=n.left),o}function Xg(e){this._canvas=e,this._asyncHide=_e(Ce(this.hide,this),1e3)}Tg.$inject=["eventBus"],Ng.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},Ng.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},Ng.prototype.addDefaultSnap=function(e,t){var i=this._defaultSnaps[e];i||(i=this._defaultSnaps[e]=[]),i.push(t)},Ng.prototype.getSnapLocations=function(){return this._snapLocations},Ng.prototype.setSnapLocations=function(e){this._snapLocations=e},Ng.prototype.pointsForTarget=function(e){var t=e.id||e,i=this._targets[t];return i||(i=this._targets[t]=new Wg).initDefaults(this._defaultSnaps),i},Wg.prototype.add=function(e,t){var i=this._snapValues[e];i||(i=this._snapValues[e]={x:[],y:[]}),-1===i.x.indexOf(t.x)&&i.x.push(t.x),-1===i.y.indexOf(t.y)&&i.y.push(t.y)},Wg.prototype.snap=function(e,t,i,n){var o=this._snapValues[t];return o&&function(e,t,i){var n,o;for(i=void 0===i?10:i,n=0;n<t.length;n++)if(o=t[n],rl(o-e)<=i)return o}(e[i],o[i],n)},Wg.prototype.initDefaults=function(e){var t=this;se(e||{},(function(e,i){se(e,(function(e){t.add(i,e)}))}))},zg.$inject=["elementRegistry","eventBus","snapping"],zg.prototype.initSnap=function(e){var t,i=this._elementRegistry,n=e.context,o=n.shape,a=n.snapContext;a||(a=n.snapContext=new Ng);var s=(t=i.get(o.id)?ul(o,e):{x:e.x+ul(o).x,y:e.y+ul(o).y}).x-o.width/2,r=t.y-o.height/2,l=t.x+o.width/2,c=t.y+o.height/2;return a.setSnapOrigin("mid",{x:t.x-e.x,y:t.y-e.y}),Ug(o)||(a.setSnapOrigin("top-left",{x:s-e.x,y:r-e.y}),a.setSnapOrigin("bottom-right",{x:l-e.x,y:c-e.y})),a},zg.prototype.addSnapTargetPoints=function(e,t,i){return se(this.getSnapTargets(t,i),(function(i){if(Ug(i))Ug(t)&&e.add("mid",ul(i));else if(i.waypoints){if(i.waypoints.length<3)return;se(i.waypoints.slice(1,-1),(function(t){e.add("mid",t)}))}else e.add("mid",ul(i))})),ee(t.x)&&ee(t.y)?(this._elementRegistry.get(t.id)&&e.add("mid",ul(t)),e):e},zg.prototype.getSnapTargets=function(e,t){return ml(t).filter((function(e){return!e.hidden}))},W()(Hg,zg),Hg.$inject=["eventBus","injector"],Hg.prototype.initSnap=function(e){var t=zg.prototype.initSnap.call(this,e),i=e.shape,n=!!this._elementRegistry.get(i.id);return se(i.outgoing,(function(i){var o=i.waypoints[0];o=o.original||o,t.setSnapOrigin(i.id+"-docking",Yg(o,n,e))})),se(i.incoming,(function(i){var o=i.waypoints[i.waypoints.length-1];o=o.original||o,t.setSnapOrigin(i.id+"-docking",Yg(o,n,e))})),wo(i,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t},Hg.prototype.addSnapTargetPoints=function(e,t,i){zg.prototype.addSnapTargetPoints.call(this,e,t,i);var n=this.getSnapTargets(t,i);se(n,(function(i){var n;(wo(n=i,"bpmn:SubProcess")&&Io(n)||wo(n,"bpmn:Participant")||("bpmn:TextAnnotation",[t,i].every((function(e){return wo(e,"bpmn:TextAnnotation")}))))&&(e.add("top-left",cl(i)),e.add("bottom-right",dl(i)))}));var o=this._elementRegistry;return se(t.incoming,(function(i){if(o.get(t.id)){Gg(n,i.source)||e.add("mid",vi(i.source));var a=i.waypoints[0];e.add(i.id+"-docking",a.original||a)}})),se(t.outgoing,(function(i){if(o.get(t.id)){Gg(n,i.target)||e.add("mid",vi(i.target));var a=i.waypoints[i.waypoints.length-1];e.add(i.id+"-docking",a.original||a)}})),wo(i,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,i.parent)),e},Hg.prototype.getSnapTargets=function(e,t){return zg.prototype.getSnapTargets.call(this,e,t).filter((function(e){return!wo(e,"bpmn:Lane")}))},Zg.prototype.initSnap=function(e){var t=e.context,i=t.shape,n=t.direction,o=t.snapContext;o||(o=t.snapContext=new Ng);var a=Kg(i,n);return o.setSnapOrigin("corner",{x:a.x-e.x,y:a.y-e.y}),o},Zg.prototype.addSnapTargetPoints=function(e,t,i,n){return se(this.getSnapTargets(t,i),(function(t){e.add("corner",dl(t)),e.add("corner",cl(t))})),e.add("corner",Kg(t,n)),e},Zg.$inject=["eventBus","snapping"],Zg.prototype.getSnapTargets=function(e,t){return ml(t).filter((function(t){return i=e,!(t.host===i||function(e){return!!e.waypoints}(t)||function(e){return!!e.hidden}(t)||function(e){return!!e.labelTarget}(t));var i}))},Xg.$inject=["canvas"],Xg.prototype.snap=function(e,t){var i=e.context.snapContext,n=i.getSnapLocations(),o={x:hl(e,"x"),y:hl(e,"y")};se(n,(function(n){var a=i.getSnapOrigin(n),s={x:e.x+a.x,y:e.y+a.y};if(se(["x","y"],(function(e){var i;o[e]||void 0!==(i=t.snap(s,n,e,7))&&(o[e]={value:i,originValue:i-a[e]})})),o.x&&o.y)return!1})),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),se(["x","y"],(function(t){var i=o[t];J(i)&&pl(e,t,i.originValue)}))},Xg.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),i=bt("path");return at(i,{d:"M0,0 L0,0"}),dt(i).add("djs-snap-line"),it(t,i),{update:function(t){ee(t)?at(i,"horizontal"===e?{d:"M-100000,"+t+" L+100000,"+t,display:""}:{d:"M "+t+",-100000 L "+t+", +100000",display:""}):at(i,{display:"none"})}}},Xg.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},Xg.prototype.showSnapLine=function(e,t){var i=this.getSnapLine(e);i&&i.update(t),this._asyncHide()},Xg.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},Xg.prototype.hide=function(){se(this._snapLines,(function(e){e.update()}))};const Qg={__depends__:[{__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",zg],resizeSnapping:["type",Zg],snapping:["type",Xg]}],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Tg],createMoveSnapping:["type",Hg]};function Jg(e,t,i,n){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=i,this._selection=n,this._container=Ze(Jg.BOX_HTML),this._searchInput=Qe(Jg.INPUT_SELECTOR,this._container),this._resultsContainer=Qe(Jg.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}function ev(e,t,i){var n=function(e){var t="";return e.forEach((function(e){e.matched?t+='<strong class="'+Jg.RESULT_HIGHLIGHT_CLASS+'">'+Ja(e.matched)+"</strong>":t+=Ja(e.normal)})),""!==t?t:null}(t),o=Ze(i);o.innerHTML=n,e.appendChild(o)}Jg.$inject=["canvas","eventBus","overlays","selection"],Jg.prototype._bindEvents=function(){var e=this;function t(t,i,n,o){e._eventMaps.push({el:t,type:n,listener:Ge(t,i,n,o)})}t(document,"html","click",(function(t){e.close()})),t(this._container,Jg.INPUT_SELECTOR,"click",(function(e){e.stopPropagation(),e.delegateTarget.focus()})),t(this._container,Jg.RESULT_SELECTOR,"mouseover",(function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)})),t(this._container,Jg.RESULT_SELECTOR,"click",(function(t){t.stopPropagation(),e._select(t.delegateTarget)})),t(this._container,Jg.INPUT_SELECTOR,"keydown",(function(e){38===e.keyCode&&e.preventDefault(),40===e.keyCode&&e.preventDefault()})),t(this._container,Jg.INPUT_SELECTOR,"keyup",(function(t){if(27===t.keyCode)return e.close();if(13===t.keyCode){var i=e._getCurrentResult();return i?e._select(i):e.close()}return 38===t.keyCode?e._scrollToDirection(!0):40===t.keyCode?e._scrollToDirection():void(37!==t.keyCode&&39!==t.keyCode&&e._search(t.delegateTarget.value))}))},Jg.prototype._unbindEvents=function(){this._eventMaps.forEach((function(e){Ye(e.el,e.type,e.listener)}))},Jg.prototype._search=function(e){var t=this;if(this._clearResults(),e&&""!==e){var i=this._searchProvider.find(e);if(i.length){i.forEach((function(e){var i=e.element.id,n=t._createResultNode(e,i);t._results[i]={element:e.element,node:n}}));var n=Qe(Jg.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(n),this._preselect(n)}}},Jg.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var i=e?t.previousElementSibling:t.nextElementSibling;i&&(this._scrollToNode(i),this._preselect(i))}},Jg.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,i=this._resultsContainer.scrollTop,n=t-this._resultsContainer.clientHeight+e.clientHeight;t<i?this._resultsContainer.scrollTop=t:i<n&&(this._resultsContainer.scrollTop=n)}},Jg.prototype._clearResults=function(){Ie(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},Jg.prototype._getCurrentResult=function(){return Qe(Jg.RESULT_SELECTED_SELECTOR,this._resultsContainer)},Jg.prototype._createResultNode=function(e,t){var i=Ze(Jg.RESULT_HTML);return e.primaryTokens.length>0&&ev(i,e.primaryTokens,Jg.RESULT_PRIMARY_HTML),ev(i,e.secondaryTokens,Jg.RESULT_SECONDARY_HTML),Re(i,Jg.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(i),i},Jg.prototype.registerProvider=function(e){this._searchProvider=e},Jg.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,Ve(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},Jg.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,Ve(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},Jg.prototype.toggle=function(){this.isOpen()?this.close():this.open()},Jg.prototype.isOpen=function(){return this._open},Jg.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&Ve(t).remove(Jg.RESULT_SELECTED_CLASS);var i=Re(e,Jg.RESULT_ID_ATTRIBUTE),n=this._results[i].element;Ve(e).add(Jg.RESULT_SELECTED_CLASS),this._resetOverlay(n),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.preselected",n)}},Jg.prototype._select=function(e){var t=Re(e,Jg.RESULT_ID_ATTRIBUTE),i=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.selected",i)},Jg.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=(i=Xt(e),n=i.width+12,{position:{bottom:(o=i.height+12)-6,right:n-6},show:!0,html:'<div style="'+["width: "+n+"px","height: "+o+"px"].join("; ")+'" class="'+Jg.OVERLAY_CLASS+'"></div>'});this._overlayId=this._overlays.add(e,t)}var i,n,o},Jg.CONTAINER_SELECTOR=".djs-search-container",Jg.INPUT_SELECTOR=".djs-search-input input",Jg.RESULTS_CONTAINER_SELECTOR=".djs-search-results",Jg.RESULT_SELECTOR=".djs-search-result",Jg.RESULT_SELECTED_CLASS="djs-search-result-selected",Jg.RESULT_SELECTED_SELECTOR="."+Jg.RESULT_SELECTED_CLASS,Jg.RESULT_ID_ATTRIBUTE="data-result-id",Jg.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",Jg.OVERLAY_CLASS="djs-search-overlay",Jg.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',Jg.RESULT_HTML='<div class="djs-search-result"></div>',Jg.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',Jg.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const tv={__depends__:[Ua,Ta],searchPad:["type",Jg]};function iv(e,t,i){this._elementRegistry=e,this._canvas=i,t.registerProvider(this)}function nv(e){return ae(e,(function(e){return!!e.matched})).length>0}function ov(e,t){var i=[],n=e;if(!e)return i;e=e.toLowerCase(),t=t.toLowerCase();var o=e.indexOf(t);return o>-1?(0!==o&&i.push({normal:n.substr(0,o)}),i.push({matched:n.substr(o,t.length)}),t.length+o<e.length&&i.push({normal:n.substr(t.length+o,e.length)})):i.push({normal:n}),i}iv.$inject=["elementRegistry","searchPad","canvas"],iv.prototype.find=function(e){var t=this._canvas.getRootElement(),i=this._elementRegistry.filter((function(e){return!e.labelTarget}));return i=ae(i,(function(e){return e!==t})),ve(i=ae(i=de(i,(function(t){return{primaryTokens:ov(Mo(t),e),secondaryTokens:ov(t.id,e),element:t}})),(function(e){return nv(e.primaryTokens)||nv(e.secondaryTokens)})),(function(e){return Mo(e.element)+e.element.id}))};const av={__depends__:[tv],__init__:["bpmnSearch"],bpmnSearch:["type",iv]};function sv(e){Bo.call(this,e)}W()(sv,Bo),sv.Viewer=ps,sv.NavigatedViewer=Ws,sv.prototype.createDiagram=go((function(){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>')})),sv.prototype._interactionModules=[ks,Bs,Xs,Ns],sv.prototype._modelingModules=[nr,fr,Dr,xr,bl,Cl,Sl,ld,bc,Xl,pd,yd,Fd,Bd,Td,Hd,lu,og,pg,Lg,Vg,eu,Qg,av],sv.prototype._modules=[].concat(ps.prototype._modules,sv.prototype._interactionModules,sv.prototype._modelingModules);var rv=i(3379),lv=i.n(rv),cv=i(7795),dv=i.n(cv),uv=i(569),hv=i.n(uv),pv=i(3565),mv=i.n(pv),fv=i(9216),gv=i.n(fv),vv=i(4589),bv=i.n(vv),yv=i(1629),wv={};wv.styleTagTransform=bv(),wv.setAttributes=mv(),wv.insert=hv().bind(null,"head"),wv.domAPI=dv(),wv.insertStyleElement=gv(),lv()(yv.Z,wv),yv.Z&&yv.Z.locals&&yv.Z.locals;var xv=i(2622),$v={};$v.styleTagTransform=bv(),$v.setAttributes=mv(),$v.insert=hv().bind(null,"head"),$v.domAPI=dv(),$v.insertStyleElement=gv(),lv()(xv.Z,$v),xv.Z&&xv.Z.locals&&xv.Z.locals;var _v=i(5367),Cv={};Cv.styleTagTransform=bv(),Cv.setAttributes=mv(),Cv.insert=hv().bind(null,"head"),Cv.domAPI=dv(),Cv.insertStyleElement=gv(),lv()(_v.Z,Cv),_v.Z&&_v.Z.locals&&_v.Z.locals;class Ev extends Wt{constructor(e,t){super(e,1500),this.bpmnRenderer=t}canRender(e){return xo(e,["bpmn:Task","bpmn:Event","bpmn:ExclusiveGateway"])&&!e.labelTarget}drawShape(e,t){const i=this.bpmnRenderer.drawShape(e,t);if(t.___abwarnings){const t=function(e,t,i){let n=[{x:0,y:0},{x:t,y:0},{x:t/2,y:-20}].map((function(e){return e.x+","+e.y})).join(" ");const o=bt("polygon");return at(o,{points:n,stroke:"#f90",strokeWidth:2,fill:"#f90"}),it(e,o),o}(e,20);at(t,{transform:"translate(-10, 10)"})}return i}getShapePath(e){return wo(e,"bpmn:Task")?qo(e,2):this.bpmnRenderer.getShapePath(e)}}function Sv(){return Ev}function kv(e,t,i,n,o,a,s){this._palette=e,this._create=t,this._elementFactory=i,this._spaceTool=n,this._lassoTool=o,this._handTool=a,this._translate=s,e.registerProvider(this)}Ev.$inject=["eventBus","bpmnRenderer"],kv.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","translate","eventBus"],kv.prototype.getPaletteEntries=function(){var e=this._create,t=this._elementFactory,i=this._spaceTool,n=this._lassoTool,o=this._handTool,a=this._translate;function s(i,n,o,s,r){function l(n){var o={type:i};if(r)for(var a in r)o[a]=r[a];var s=t.createShape(o);r&&(s.businessObject.di.isExpanded=r.isExpanded),e.start(n,s)}var c=i.replace(/^bpmn:/,"");return{group:n,className:o,title:s||a("Create {type}",{type:c}),action:{dragstart:l,click:l}}}function r(i,n){e.start(i,t.createParticipantShape(n))}return{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:a("Activate the hand tool"),action:{click:function(e){o.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:a("Activate the lasso tool"),action:{click:function(e){n.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:a("Activate the create/remove space tool"),action:{click:function(e){i.activateSelection(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":s("bpmn:StartEvent","event","bpmn-icon-start-event-none"),"create.end-event":s("bpmn:EndEvent","event","bpmn-icon-end-event-none"),"create.exclusive-gateway":s("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-xor"),"create.task":s("bpmn:Task","activity","bpmn-icon-task"),"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:a("Create Pool/Participant"),action:{dragstart:r,click:r}}}};const Av=["bpmn:Task","bpmn:StartEvent","bpmn:EndEvent"];function Rv(e,t){0==e.length?t():e.shift()((i=>{if(i)return t(i);Rv(e,t)}))}function Dv(e){return"bpmn:SubProcess"==e.parent?.type}function Pv(e){const t="ui_work_process_workspace_model",i=e.Config.uiSettings(),o=(0,n.Z)(e),a=o.L(),r=s(e,`${t}_view_warnings`),l=function(e){const t=Sv(),i=kv,n=function(e){const t=e.Class.ABProcessTaskManager;function i(e,t,i,n,o,a){this._popupMenu=e,this._modeling=t,this._moddle=i,this._bpmnReplace=n,this._rules=o,this._translate=a,this.register()}return i.$inject=["popupMenu","modeling","moddle","bpmnReplace","rules","translate"],i.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},i.prototype.getEntries=function(e){var i,n=e.businessObject;if(!this._rules.allowed("shape.replace",{element:e}))return[];var o=kc(e);return wo(n,"bpmn:StartEvent")&&!To(n.$parent)?n.$parent&&"bpmn:SubProcess"==n.$parent.$type?[]:(i=ae(t.StartEvents(),o),this._createEntries(e,i)):wo(n,"bpmn:Participant")?(i=ae(Wc,(function(e){return Io(n)!==e.target.isExpanded})),this._createEntries(e,i)):wo(n,"bpmn:StartEvent")&&To(n.$parent)?n.$parent&&"bpmn:SubProcess"==n.$parent.$type?[]:(i=ae(Mc,(function(t){var i=!1!==t.target.isInterrupting,n=$o(e).isInterrupting===i;return o(t)||!o(t)&&!n})),this._createEntries(e,i)):wo(n,"bpmn:EndEvent")?(i=ae(t.EndEvents(),(function(e){return!("bpmn:CancelEventDefinition"==e.target.eventDefinitionType&&!wo(n.$parent,"bpmn:Transaction"))&&o(e)})),this._createEntries(e,i)):wo(n,"bpmn:BoundaryEvent")?(i=ae(Oc,(function(e){var t=e.target;if("bpmn:CancelEventDefinition"==t.eventDefinition&&!wo(n.attachedToRef,"bpmn:Transaction"))return!1;var i=!1!==t.cancelActivity,a=n.cancelActivity==i;return o(e)||!o(e)&&!a})),this._createEntries(e,i)):wo(n,"bpmn:IntermediateCatchEvent")||wo(n,"bpmn:IntermediateThrowEvent")?(i=ae(Dc,o),this._createEntries(e,i)):wo(n,"bpmn:Gateway")?(i=ae(t.Gateways(),o),this._createEntries(e,i)):wo(n,"bpmn:Transaction")?(i=ae(Vc,o),this._createEntries(e,i)):To(n)&&Io(n)?(i=ae(Bc,o),this._createEntries(e,i)):wo(e,"bpmn:SubProcess")&&Io(e)?(i=ae(Fc,o),this._createEntries(e,i)):wo(n,"bpmn:AdHocSubProcess")&&!Io(n)?(i=ae(Ic,(function(t){var i=t.target,n="bpmn:SubProcess"===i.type,o=!0===i.isExpanded;return kc(e)&&(!n||o)})),this._createEntries(e,i)):wo(n,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Nc):wo(n,"bpmn:FlowNode")?(i=ae(t.Tasks(),o),wo(n,"bpmn:SubProcess")&&!Io(n)&&(i=ae(i,(function(e){return"Sub Process (collapsed)"!==e.label}))),this._createEntries(e,i)):[]},i.prototype.getHeaderEntries=function(e){var t=[];return wo(e,"bpmn:Activity")&&!To(e)&&(t=t.concat(this._getLoopEntries(e))),!wo(e,"bpmn:SubProcess")||wo(e,"bpmn:Transaction")||To(e)||t.push(this._getAdHocEntry(e)),t},i.prototype._createEntries=function(e,t){var i=[],n=this;return se(t,(function(t){var o=n._createMenuEntry(t,e);i.push(o)})),i},i.prototype._createSequenceFlowEntries=function(e,t){var i=$o(e),n=[],o=this._modeling,a=this._moddle,s=this;return se(t,(function(t){switch(t.actionName){case"replace-with-default-flow":i.sourceRef.default!==i&&(wo(i.sourceRef,"bpmn:ExclusiveGateway")||wo(i.sourceRef,"bpmn:InclusiveGateway")||wo(i.sourceRef,"bpmn:ComplexGateway")||wo(i.sourceRef,"bpmn:Activity"))&&n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e.source,{default:i})})));break;case"replace-with-conditional-flow":!i.conditionExpression&&wo(i.sourceRef,"bpmn:Activity")&&n.push(s._createMenuEntry(t,e,(function(){var t=a.create("bpmn:FormalExpression",{body:""});o.updateProperties(e,{conditionExpression:t})})));break;default:if(wo(i.sourceRef,"bpmn:Activity")&&i.conditionExpression)return n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e,{conditionExpression:void 0})})));if((wo(i.sourceRef,"bpmn:ExclusiveGateway")||wo(i.sourceRef,"bpmn:InclusiveGateway")||wo(i.sourceRef,"bpmn:ComplexGateway")||wo(i.sourceRef,"bpmn:Activity"))&&i.sourceRef.default===i)return n.push(s._createMenuEntry(t,e,(function(){o.updateProperties(e.source,{default:void 0})})))}})),n},i.prototype._createMenuEntry=function(e,t,i){var n=this._translate,o=this._bpmnReplace.replaceElement;i=i||function(){return o(t,e.target)};let a=e.label;return"function"==typeof e.label&&(a=e.label(t)),{label:n(a),className:e.className,id:e.actionName,action:i}},i.prototype._getLoopEntries=function(e){var t=this,i=this._translate;function n(i,n){var o;n.active?o=void 0:(o=t._moddle.create(n.options.loopCharacteristics),n.options.isSequential&&(o.isSequential=n.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:o})}var o,a,s,r=$o(e).loopCharacteristics;return r&&(o=r.isSequential,a=void 0===r.isSequential,s=void 0!==r.isSequential&&!r.isSequential),[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:i("Parallel Multi Instance"),active:s,action:n,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:i("Sequential Multi Instance"),active:o,action:n,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:i("Loop"),active:a,action:n,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}]},i.prototype._getAdHocEntry=function(e){var t=this._translate,i=wo($o(e),"bpmn:AdHocSubProcess"),n=this._bpmnReplace.replaceElement;return{id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(){return n(e,i?{type:"bpmn:SubProcess"}:{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}},i}(e);return{__init__:["customRenderer","paletteProvider","replaceMenuProvider"],customRenderer:["type",t],paletteProvider:["type",i],replaceMenuProvider:["type",n]}}(e),c=(0,I.Z)(e);return new class extends o{constructor(){super(t,{button:"",component:"",modeler:"",modelerBroken:"",modelerWorking:"",properties:"",propertyPanel:""}),this.viewer=null,this.unsavedChanges=!1,this.CurrentPropertiesObj=null,this.panelsByType={},this.panelSelectElement={id:this.ids.properties,view:"template",template:`<div id="${this.ids.properties}_div">${a("Select an element to edit.")}</div>`},this.panelGenericEndEvent={id:this.ids.properties,view:"template",template:`<div id="${this.ids.properties}_div">${a("This is a generic BPMN End Event placeholder. Change it to one of our Specific End Event Types to edit.")}</div>`},this.panelGenericTrigger={id:this.ids.properties,view:"template",template:`<div id="${this.ids.properties}_div">${a("This is a generic BPMN Trigger placeholder. Change it to one of our Specific Trigger Types to edit.")}</div>`},this.panelGenericService={id:this.ids.properties,view:"template",template:`<div id="${this.ids.properties}_div">${a("This is a generic BPMN Task placeholder. Change it to one of our Specific Tasks to edit.")}</div>`}}ui(){let e=this.ids;return{id:e.component,css:"bg_gray",rows:[{id:e.button,view:"button",css:"webix_primary",type:"form",label:a("Save"),icon:"fa fa-save",click:()=>{this.saveProcess(this.CurrentProcess)}},{id:e.modelerWorking,cols:[{view:"template",template:`<div id="${e.modeler}" style="width: 100%; height: 100%;"></div>`},{view:"resizer",css:"bg_gray",width:11},{width:i.columnWidthXXLarge,rows:[{view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{type:"spacer",width:15},{view:"label",label:a("Properties")}]},{view:"scrollview",id:e.propertyPanel,body:{padding:15,rows:[{id:e.properties,view:"template",template:`<div id="${e.properties}_div">properties here!</div>`}]}}]}]},{id:e.modelerBroken,view:"template",template:'<div  style="width: 100%; height: 100%;"> Big Broken Icon Here </div>'},r.ui()]}}init(e){this.AB=e;let t=this.ids;$$(t.button)?.hide(),$$(t.modelerBroken)?.hide(),$$(t.modelerWorking)?.show(),c.processElements().forEach((e=>{this.panelsByType[e.key]=new e})),webix.ui(this.panelSelectElement,$$(t.properties))}applicationLoad(e){super.applicationLoad(e),Object.keys(this.panelsByType).forEach((t=>{this.panelsByType[t].applicationLoad(e)}))}checkKnownElement(e,t){const i=this.CurrentProcess.elementForDiagramID(e.id);if(Av.indexOf(e.type)>-1&&!i){let i=t?.type??"unknown";i=e.parent?.type??e.businessObject?.$parent?.$type??i,"bpmn:SubProcess"!=i||-1==["bpmn:StartEvent","bpmn:EndEvent"].indexOf(e.type)?(e.___abwarnings=["generic task"],this.CurrentProcess.unknownShape(e),this.emit("warnings")):delete e.___abwarnings}if(i){const t=i.warnings();t.length>0&&(e.___abwarnings=t)}}clearWorkspace(){this.CurrentProcessID=null,this.unsavedChanges=!1}async saveProcess(e){this.CurrentPropertiesObj&&this.propertiesSave();try{let{xml:t}=await this.viewer.saveXML({preamble:!0});e.modelUpdate(t),await e.save(),this.unsavedChanges=!1,this.warningsRefresh(this.CurrentProcess),r.show(this.CurrentProcess),$$(this.ids.button).hide()}catch(e){this.AB.notify.developer(e,{context:"ui_work_process_workspace_model:saveProcess()"})}}processLoad(e){var t=this.ids;if(Object.keys(this.panelsByType).forEach((t=>{this.panelsByType[t]?.processLoad?.(e)})),!this.viewer){$$(t.modelerBroken).hide(),$$(t.modelerWorking).show();const e=document.getElementById(t.modeler);this.viewer=new sv({container:e,additionalModules:[l],moddleExtensions:{ab:{name:"AppBuilder",uri:"http://some-company/schema/bpmn/ab",prefix:"ab",xml:{tagAlias:"lowerCase"},types:[{name:"SignalLifecycle",extends:["bpmn:SignalEventDefinition"],properties:[]},{name:"SignalTriggerTimer",extends:["bpmn:SignalEventDefinition"],properties:[]}],emumerations:[],associations:[]}}}),this.viewer.on(["bpmnElement.added"],(e=>{var t=e.element;"bpmn:SequenceFlow"!=t.type&&"bpmn:MessageFlow"!=t.type||this.CurrentProcess?.connectionUpsert(t)})),this.viewer.on("shape.add",(e=>{this.checkKnownElement(e.element,e.parent)})),this.viewer.on("shape.remove",(e=>{if(this.CurrentProcess){let n=this.CurrentProcess;var t=e.element;if(Dv(t)&&(n=this.CurrentProcess.elementForDiagramID(t.parent.id)||this.CurrentProcess),"bpmn:SequenceFlow"==t.type||"bpmn:MessageFlow"==t.type)n.connectionRemove(t);else{var i=n.elementForDiagramID(t.id);i&&i.destroy(),this.CurrentProcess.connectionsIncoming(t.id).forEach((e=>{this.CurrentProcess.connectionRemove(e);var t=this.CurrentProcess.elementForDiagramID(e.from);t&&(t.warningsEval(),this.timedUpdate(t))}))}this.CurrentProcess.unknownShapeRemove(t)}})),this.viewer.on("element.changed",(e=>{let i=e.element;if("label"==i.type)return;let n=this.CurrentProcess;if(Dv(i)&&(n=this.CurrentProcess.elementForDiagramID(i.parent.id)||this.CurrentProcess),null!=n)if("bpmn:SequenceFlow"!=i.type&&"bpmn:MessageFlow"!=i.type){var o=n.elementForDiagramID(i.id);if(o)o.onChange(i,t.properties);else if(this.viewer.get("elementRegistry").get(i.id)){var a=null,s=null;e.element.businessObject.eventDefinitions&&(a=e.element.businessObject.eventDefinitions[0]),a&&(s=a.$type),-1==Av.indexOf(i.type)||s?n.elementNewForModelDefinition(i)?this.viewer.get("canvas").removeMarker(i.id,"highlight-undefined-task"):this.AB.notify.developer(new Error("no ProcessElement for BPMN Element"),{element:i}):this.viewer.get("canvas").addMarker(i.id,"highlight-undefined-task")}}else{n.connectionUpsert(i);let e=this.CurrentProcess.connectionForDiagramID(i.id);if(e){let t=this.CurrentProcess.elementForDiagramID(e.from);if(t)if(t.___pendingUpdate)t.___pendingUpdate--,0==t.___pendingUpdate&&delete t.___pendingUpdate;else{let e=t.diagramProperties(this.viewer);e=e.filter((e=>e.id.indexOf("Flow")>-1)),e.length>0&&(t.___pendingUpdate=e.length),t.warningsEval(),this.timedUpdate(t)}}}})),this.viewer.on("selection.changed",(e=>{if(this.CurrentProcess)if(1==e.newSelection.length){let n=e.newSelection[0];var i=this.CurrentProcess.elementForDiagramID(n.id);if(Dv(n)&&null==i){let e=this.CurrentProcess.elementForDiagramID(n.parent.id);e&&(i=e.elementForDiagramID(n.id))}if(i)this.CurrentPropertiesObj&&this.CurrentPropertiesObj.diagramID!=i.diagramID&&this.propertiesSave(),this.CurrentPropertiesObj=i,this.CurrentPropertiesObj._handlerSwitchTo||(this.CurrentPropertiesObj._handlerSwitchTo=e=>{this.CurrentPropertiesObj=e,this.panelShow(e)},this.CurrentPropertiesObj.on("switchTo",this.CurrentPropertiesObj._handlerSwitchTo)),this.panelShow(i),this.CurrentPropertiesObj._handlerSave||(this.CurrentPropertiesObj._handlerSave=()=>{this.saveProcess(this.CurrentProcess),this.CurrentPropertiesObj?.propertiesShow(t.properties)},this.CurrentPropertiesObj.on("save",this.CurrentPropertiesObj._handlerSave));else{this.CurrentPropertiesObj=null,Dv(n)&&-1!=["bpmn:StartEvent","bpmn:EndEvent"].indexOf(n.type)||console.warn("Selected Element is unknown to this Process: "+e.newSelection[0].id);let i=this.panelSelectElement;switch(n.type){case"bpmn:EndEvent":i=this.panelGenericEndEvent;break;case"bpmn:StartEvent":i=this.panelGenericTrigger;break;case"bpmn:Task":i=this.panelGenericService}webix.ui(i,$$(t.properties)),this.CurrentPanel=i}}else this.CurrentPropertiesObj&&this.propertiesSave(),this.CurrentPropertiesObj=null,$$(t.properties).hide()})),this.viewer.on("commandStack.changed",(()=>{this.unsavedChanges=!0,$$(t.button).show()}))}var i=[];this.CurrentProcess&&this.unsavedChanges&&i.push((e=>{webix.confirm({title:a("Save?"),text:a("Save your changes to {0}?",[this.CurrentProcess.label]),callback:i=>{i?this.saveProcess(this.CurrentProcess).then((()=>{e()})).catch(e):(this.unsavedChanges=!1,$$(t.button).hide(),e())}})})),i.push((async i=>{this.CurrentProcessID=null,this.viewer.clear(),super.processLoad(e),this.CurrentPropertiesObj=null,$$(t.properties).hide();var n=e.modelDefinition();n||(e.modelNew(),n=e.modelDefinition());try{await this.viewer.importXML(n),this.viewer.get("canvas").zoom("fit-viewport","auto"),i()}catch(e){i(e)}})),Rv(i,(i=>{i&&(i.toString().indexOf("no diagram to display")&&webix.confirm({title:a("Error Displaying Process"),message:a("Could not display the process definition for {0}. Do you want to start a blank process?",[this.CurrentProcess.name]),callback:i=>{i?(e.modelNew(),this.processLoad(this.CurrentProcess)):($$(t.modelerWorking).hide(),$$(t.modelerBroken).show(),this.viewer.clear(),this.viewer.destroy(),this.viewer=null)}}),this.AB.notify.developer(i,{context:"error during the process of changing the Process"})),$$(t.modelerBroken).hide(),$$(t.modelerWorking).show(),this.warningsRefresh(this.CurrentProcess),r.show(this.CurrentProcess)}))}panelShow(e){let t={ui:()=>this.panelSelectElement};this.panelsByType[e.key]&&(t=this.panelsByType[e.key]);let i={id:this.ids.properties,rows:[t.ui(e),{}]};webix.ui(i,$$(this.ids.properties)),t.populate?.(e),this.CurrentPanel=t}propertiesSave(){if(this.CurrentPanel){var e=this.CurrentPropertiesObj,t=this.CurrentPanel.values(),i=e.toObj();Object.keys(t).forEach((e=>{i[e]=t[e]})),e.name||(i.name=t.label),e.fromValues(i),e.warningsEval(),this.timedUpdate(e)}}show(){$$(this.ids.component).show()}timedUpdate(e){setTimeout((()=>{e.diagramProperties(this.viewer).forEach((e=>{this.updateElementProperties(e.id,e.def,e.warn)})),this.warningsRefresh(this.CurrentProcess),r.show(this.CurrentProcess)}),0)}updateElementProperties(e,t,i){var n=this.viewer.get("elementRegistry").get(e);n&&(i?n.___abwarnings=i:delete n.___abwarnings,this.viewer.get("modeling").updateProperties(n,t))}warningsRefresh(e){let t=e.elements();super.warningsRefresh(e),t.forEach((t=>e.elementAdd(t)))}}}function Lv(e){const t=(0,n.Z)(e),i=function(e){const t=(0,n.Z)(e);return new class extends t{constructor(){super("ui_work_version_list"),this.AB={},this.ListComponent=function(e,t){const i=e.Config.uiSettings();var n=function(...t){return e.Multilingual.labelPlugin("ABDesigner",...t)};class o extends e.ClassUI{constructor(e){e.idBase=e.idBase||"ui_common_list";var t=e.idBase||"ui_common_list";if(super(t,{listSetting:"",vList:"",buttonNew:""}),this.idBase=t,this.labels={addNew:"Add new item",confirmDeleteTitle:"Delete Item"},e.labels)for(var i in e.labels)this.labels[i]=e.labels[i];e.menu=e.menu||{},e.menu.copy=void 0===e.menu.copy||e.menu.copy,e.menu.exclude=void 0===e.menu.exclude||e.menu.exclude,this.attributes=e,this._templateListItem="<div class='ab-object-list-item'>#version# - #changelog.author# <div style='padding-left:18px'>#changelog.commitMessage#</div></div>",this.cacheTemplate={},this.CurrentApplication=null,this.itemList=null,this._initialized=!1,this._settings={}}ui(){var t=this.ids;return{id:this.ids.component,rows:[{view:"list",id:this.ids.vList,width:i.columnWidthLarge,select:!0,editaction:"custom",editable:!0,editor:"text",editValue:"label",type:{height:57},template:(e,t)=>this.templateListItem(e,t),on:{onAfterSelect:e=>{this.onSelectItem(e)},onBeforeEditStop:(e,t)=>{this.onBeforeEditStop(e,t)},onAfterEditStop:(e,t,i)=>{this.onAfterEditStop(e,t,i)},onAfterRender(){this.data.each((i=>{e.ClassUI.CYPRESS_REF(this.getItemNode(i.id),`${t.list}_${i.id}`)}))}}},{view:"button",css:"webix_primary",id:this.ids.buttonNew,value:"Clear",type:"form",click:()=>{this.clearForm(!0)},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}]}}init(e){this.AB=e,$$(this.ids.component)&&$$(this.ids.component).adjust(),this.$list=$$(this.ids.vList),this._initialized=!0}applicationLoad(e){this.CurrentApplication=e}dataLoad(t){if(this.busy(),!t)return this.AB.notify.developer("No version Data",{context:"ui_work_version_list:dataLoad()",versionData:t}),this.clearForm(),void this.ready();var i=t.changeLog;this.itemList=new webix.DataCollection({data:function(t){const i=t,n=Object.keys(t).sort(((e,t)=>{const[i,n,o]=e.split(".").map((e=>parseInt(e))),[a,s,r]=t.split(".").map((e=>parseInt(e)));return i!==a?a-i:n!==s?s-n:r-o})).map(((n,o)=>"string"==typeof t[n]?(e.notify.developer(new Error,{context:"ui_version_list.loadData()",message:"The changelog object is not in the correct format.",version:n}),{version:n,id:o}):(t[n].versionNumber=n,{id:o,label:n,version:n,changelog:t[n],commitMessage:i[n].commitMessage,author:i[n].author,timestamp:i[n].timestamp,changeSize:i[n].changeSize})));return n}(i)});var n=this.$list||$$(this.ids.vList);n&&(n.clearAll(),n.data.unsync(),n.data.sync(this.itemList),n.refresh(),n.unselectAll()),this.ready()}busy(){this.$list?.showProgress?.({type:"icon"})}ready(){this.$list?.hideProgress?.()}onSelectItem(e){var t=this.$list.getItem(e);this.emit("selected",t)}clearForm(){this.emit("selected")}save(){this._initialized&&this.AB.Storage.set(this.idBase,this._settings)}selectItem(e){this.$list.blockEvent(),this.select(e),this.$list.unblockEvent()}templateListItem(e,t){return this.cacheTemplate[e.id]||("string"==typeof this._templateListItem?this.cacheTemplate[e.id]=this._templateListItem.replace("#label#",e.label||"??label??").replace("#title#",e.title||"??title??").replace("#year#",e.year||"??year??").replace("#version#",e.version||"??version??").replace("#changelog.author#",e.changelog?.author||"??changelog.author??").replace("#changelog.commitMessage#",e.changelog?.commitMessage||"??changelog.commitMessage??"):this.cacheTemplate[e.id]=this._templateListItem(e,t),setTimeout((()=>{delete this.cacheTemplate[e.id]}),400)),this.cacheTemplate[e.id]}exclude(){var e=this.$list.getSelectedItem(!1);this.emit("exclude",e)}rename(){var e=this.$list.getSelectedId(!1);this.$list.edit(e)}remove(){var e=this.$list.getSelectedItem(!1);webix.confirm({title:n(this.labels.confirmDeleteTitle),text:n(this.labels.confirmDeleteMessage,[e.label]),ok:n("Yes"),cancel:n("No"),callback:async t=>{if(t){this.busy();try{await e.destroy(),this.ready(),this.itemList.remove(e.id),this.emit("deleted",e),this.emit("selected",null)}catch(e){this.AB.notify.developer(e,{context:"ui_common_list:remove(): error removing item"}),this.ready()}}}})}select(e){this.$list.select(e)}callbackProcessEditorMenu(e){switch(e){case"rename":this.rename();break;case"exclude":this.exclude();break;case"delete":this.remove()}}}return new o(t)}(e,{idBase:this.ids.component,labels:{addNew:"Add new Version",title:"Versions",searchPlaceholder:"Version"}})}ui(){return this.ListComponent.ui()}async init(e){this.AB=e,await this.ListComponent.init(e),this.on("addNew",((e,t)=>{let i=e.versionData||e.json.versionData;this.ListComponent.dataLoad(i),this.emit("selected",t)})),this.ListComponent.on("selected",(e=>{this.emit("selected",e)})),this.ListComponent.on("clearForm",(()=>{this.emit("clearForm")}))}applicationLoad(e){super.applicationLoad(e),this.AB=e;let t=e.versionData||e.json.versionData;this.ListComponent.dataLoad(t)}ready(){this.ListComponent.ready()}}}(e),o=function(e,t){e.Config.uiSettings();const i=(0,n.Z)(e),o=i.L();return new class extends i{constructor(t,i={}){super(t,{form:"",versionForm:"",versionOption:"",multiview:"",noSelection:"",workspace:""}),this.AB=e,this.versionNumber="1.0.0",this.settings=i}ui(){return{cells:[{id:this.ids.noSelection,rows:[{css:"webix_dark",id:this.ids.versionOption,view:"toolbar",cols:[{width:12},{view:"label",label:"App Version"}]},{view:"form",id:this.ids.form,rows:[{label:"Version number options for Current Changes",view:"label",height:10},{cols:[{id:this.ids.versionOption,options:this.getVersionOptions(this.versionNumber||"1.0.0"),view:"segmented",height:40},{width:15}]},{view:"text",label:"Author",name:"author",id:"author",labelPosition:"top"},{label:"Release Notes",view:"textarea",name:"commitMessage",id:"commitMessage",labelPosition:"top",placeholder:"Explain your changes. Users will see this."},{view:"text",label:"Version Number",name:"version",id:"version",labelPosition:"top",hidden:!0},{view:"text",label:"Date",name:"timestamp",id:"timestamp",labelPosition:"top",hidden:!0},{view:"checkbox",label:"Force keep this version",name:"keepVersion",id:"keepVersion",labelPosition:"top",hidden:!0},{id:"save_button",label:"Save Log Message",view:"button",height:38,type:"icon",css:"webix_primary",disabled:!1,click:()=>this.saveNew()},{id:"update_button",label:"Update Change Log",view:"button",height:38,type:"icon",css:"webix_primary",disabled:!1,hidden:!0,click:()=>this.saveUpdate()},{id:"rollback_button",label:"Rollback module to this version",view:"button",height:38,type:"icon",css:"webix_primary",disabled:!1,hidden:!0},{id:"export_button",label:"Export",view:"button",height:38,type:"icon",css:"webix_primary",icon:"fa fa-download",disabled:!1}]}]}]}}async init(e){const t=this.ids;this.AB=e,this.$form=$$(this.ids.form),this.$versionOption=$$(this.ids.versionOption),$$(t.noSelection).show()}applicationLoad(e){super.applicationLoad(e);let t=this.getVersionData(e);this.versionNumber=t?.versionNumber?t.versionNumber:"1.0.0",this.CurrentVersionID=this.versionNumber,this.setOptions(this.versionNumber)}getVersionData(e){let t=(e=e||this.CurrentApplication).versionData||e.json.versionData;return t||(this.AB.notify.developer("there is no versionData",{context:"ui_work_version_workspace:getVersionData()",application:e.toObj()}),t={}),t}setOptions(e){let t=this.$versionOption;t&&(t.data.options=this.getVersionOptions(e),t.refresh())}versionLoad(e){if(!e)return this.clearForm(),!1;super.versionLoad(e),this.$versionOption.disable(),$$("save_button").hide(),$$("update_button").show(),$$("version").show(),$$("timestamp").show(),$$("export_button").hide(),this.$form.setValues(e),this.setOptions(this.versionNumber),this.$versionOption.refresh(),this.versionData=e}clearForm(){this.$versionOption.enable(),$$("save_button").show(),$$("update_button").hide(),$$("version").hide(),$$("timestamp").hide(),$$("export_button").show(),this.$form.setValues({}),this.setOptions(this.versionNumber),this.$versionOption.refresh()}loadData(e){console.error("no function should be here",e)}async saveNew(){let e=this.$form.getValues();if(e.version=this.getVersionNumber(this.$versionOption.$getValue()),e.timestamp=(new Date).toISOString(),!this.CurrentApplication)return webix.alert({title:o("Shoot!"),test:o("No Application Set!  Why?")}),!1;try{await this.applicationChangeLogAdd(this.CurrentApplication,e),this.emit("versionDataUpdate",!0),this.toList()}catch(e){}}async saveUpdate(){let e=this.$form.getValues(),t={};if(t.version=e.version,t.author=e.author,t.date=e.date,t.commitMessage=e.commitMessage,!this.CurrentApplication)return webix.alert({title:o("Shoot!"),test:o("No Application Set!  Why?")}),!1;try{await this.applicationChangeLogUpdate(this.CurrentApplication,e),this.emit("versionDataUpdate",!0),this.toList()}catch(e){}}getVersionNumber(e){const t=/^(\d+\.\d+\.\d+)/.exec(e);if(t)return t[1];{const t=new Error("Failed to extract version number from input string.");return this.AB.notify.developer(t,{context:"ui_work_version_workspace:getVersionNumber()",application:this.Application.toObj(),string:e}),null}}getVersionOptions(e){const t=e.split(".")[0],i=e.split(".")[1],n=e.split(".")[2];return[`${parseInt(t)+1}.0.0 <i>major</i>`,`${t}.${parseInt(i)+1}.0 <i>minor</i>`,`${t}.${i}.${parseInt(n)+1} <i>patch</i>`]}async applicationChangeLogAdd(e,t){let i=this.getVersionData(e);var n=i?.versionNumber;let a=t.version;i.changeLog[a]=t,i.versionNumber=a,e.json.versionData=i;try{await e.save(),webix.message({type:"success",text:o("{0} Successfully logged update of ",[e.label]," to version: ",a)}),this.versionNumber=a,this.clearForm(),this.emit("addNew",e,a)}catch(i){webix.message({type:"error",text:o("Error Updating {0}",[e.label]," to version: ",a)}),this.AB.notify.developer(i,{context:"ui_work_version_workspace:applicationChangeLogAdd()",application:e.toObj(),values:t}),e.versionData.versionNumber=n,Reflect.deleteProperty(e.versionData.changeLog,a)}}async applicationChangeLogUpdate(e,t){e=this.CurrentApplication||e;let i=t.version;var n=this.getVersionData(e).changeLog[i];n||console.error("They are trying to change the version number..."),e.json.versionData.changeLog[i]=t;try{await e.save(),webix.message({type:"success",text:o("{0} Successfully logged update of ",[e.label]," to version: ",i)}),this.emit("addNew",e,t)}catch(a){webix.message({type:"error",text:o("Error Updating {0}",[e.label]," to version: ",i)}),this.AB.notify.developer(a,{context:"ui_work_version_workspace:applicationChangeLogUpdate()",application:e.toObj(),values:t}),e.json.versionData.versionNumber=n.versionNumber,Reflect.deleteProperty(e.json.versionData.changeLog,i)}}}("ui_work_version_workspace",{allowDelete:0,configureHeaders:!1,detailsView:"",editView:"",isEditable:0,massUpdate:0,isReadOnly:!0})}(e);return new class extends t{constructor(){super("ui_work_version")}ui(){return{id:this.ids.component,type:"space",cols:[i.ui(),{view:"resizer",width:11},o.ui()]}}async init(e){this.AB=e,i.on("selected",(e=>{this.select(e)})),o.on("addNew",((e,t)=>{i.emit("addNew",e,t)})),await o.init(e),await i.init(e),this.on("versionDataUpdate",(()=>{this.VersionList.refresh()})),this.on("clearForm",(()=>{this.VersionWorkspace.clearForm()}))}applicationLoad(e){const t=this.CurrentApplicationID;super.applicationLoad(e),t&&t!=this.CurrentApplicationID&&o.clearForm(),i.applicationLoad(e),o.applicationLoad(e)}show(){const e=this.ids;$$(e.component).show(!1,!1);const t=this.CurrentApplication;t&&(o.applicationLoad(t),i.applicationLoad(t)),i.ready()}select(e){null==e&&o.clearForm(),o.versionLoad(e)}}}function Fv(e){const t=(0,n.Z)(e);var i=t.L();const o=function(e){const t=(0,n.Z)(e);var i=function(e){const t=(0,n.Z)(e);var i=new u(e);return new class extends t{constructor(){super("ui_work_object_list"),this.ListComponent=l(e,{idBase:this.ids.component,labels:{addNew:"Add new object",confirmDeleteTitle:"Delete Object",title:"Objects",searchPlaceholder:"Object name"},menu:{copy:!1,exclude:!0}})}ui(){return this.ListComponent.ui()}async init(e){this.AB=e,this.on("addNew",(e=>{this.clickNewProcess(e)})),await this.ListComponent.init(e),this.ListComponent.on("selected",(e=>{this.emit("selected",e?.id)})),this.ListComponent.on("addNew",(e=>{this.clickNewProcess(e)})),this.ListComponent.on("deleted",(e=>{this.emit("deleted",e)})),this.ListComponent.on("exclude",(e=>{this.exclude(e)})),await i.init(e),i.on("cancel",(()=>{i.hide()})),i.on("save",(e=>{this.applicationLoad(this.CurrentApplication),this.ListComponent.select(e.id)}))}applicationLoad(e){var t=this.CurrentApplicationID,n=null;super.applicationLoad(e),t==this.CurrentApplicationID&&(n=this.ListComponent.selectedItem());var o=e=>!e.isSystemObject;this.AB.Account.isSystemDesigner()&&(o=()=>!0),this.ListComponent.dataLoad(e?.objectsIncluded(o)),n&&this.ListComponent.selectItem(n.id),i.applicationLoad(e)}warningsRefresh(){if(this.CurrentApplication){var e=e=>!e.isSystemObject;this.AB.Account.isSystemDesigner()&&(e=()=>!0);let t=this.ListComponent.selectedItem();this.ListComponent.dataLoad(this.CurrentApplication?.objectsIncluded(e)),this.ListComponent.selectItem(t.id)}}clickNewProcess(){i.show()}async exclude(e){this.ListComponent.busy();var t=this.CurrentApplication;await t.objectRemove(e),this.ListComponent.dataLoad(t.objectsIncluded()),this.emit("selected",null)}ready(){this.ListComponent.ready()}}}(e),o=D(e);return new class extends t{constructor(){super("ui_work_object")}ui(){return{id:this.ids.component,type:"space",margin:10,cols:[i.ui(),{view:"resizer"},o.ui()]}}init(e){return this.AB=e,this.warningsPropogate([i,o]),this.on("warnings",(()=>{i.warningsRefresh()})),i.on("selected",(e=>{null==e?o.clearObjectWorkspace():o.populateObjectWorkspace(e)})),o.on("addNew",(e=>{i.emit("addNew",e)})),Promise.all([o.init(e),i.init(e)])}applicationLoad(e){var t=this.CurrentApplicationID;super.applicationLoad(e),t!=this.CurrentApplicationID&&o.clearObjectWorkspace(),i.applicationLoad(e),o.applicationLoad(e)}show(){$$(this.ids.component).show(!1,!1),i?.ready()}}}(e),a=P(e),s=j(e),r=function(e){const t=(0,n.Z)(e);return new class extends t{constructor(){super("ui_work_process"),this.CurrentProcessID=null,this.ProcessList=function(e){const t=(0,n.Z)(e);return new class extends t{constructor(){super("ui_work_process_list"),this.ListComponent=l(e,{idBase:this.ids.component,labels:{addNew:"Add new process",confirmDeleteTitle:"Delete Process",title:"Processes",searchPlaceholder:"Process name"},menu:{copy:!1,exclude:!0}}),this.AddForm=function(e){const t=(0,n.Z)(e);var i=t.L();return new class extends t{constructor(){super("ui_work_process_list_newProcess",{form:"",buttonCancel:"",buttonSave:""}),this.selectNew=!0}ui(){return{view:"window",id:this.ids.component,position:"center",modal:!0,head:{view:"toolbar",css:"webix_dark",cols:[{view:"label",label:i("Add new Process"),css:"modal_title",align:"center"},{view:"button",autowidth:!0,type:"icon",icon:"nomargin fa fa-times",click:()=>{this.emit("cancel")},on:{onAfterRender(){t.CYPRESS_REF(this)}}}]},body:{view:"form",id:this.ids.form,width:400,rules:{},elements:[{view:"text",label:i("Name"),name:"name",required:!0,placeholder:i("Enter process name"),labelWidth:70},{margin:5,cols:[{fillspace:!0},{view:"button",id:this.ids.buttonCancel,value:i("Cancel"),css:"ab-cancel-button",autowidth:!0,click:()=>{this.emit("cancel")}},{view:"button",id:this.ids.buttonSave,css:"webix_primary",value:i("Save"),autowidth:!0,type:"form",click:()=>{let e=$$(this.ids.form).getValues();return this.save(e)}}]}]}}}init(e){this.AB=e,webix.ui(this.ui()),this.$component=$$(this.ids.component),this.$form=$$(this.ids.form),this.$buttonSave=$$(this.ids.buttonSave),webix.extend(this.$component,webix.ProgressBar),this.hide()}async save(e){if(!this.CurrentApplication)return webix.alert({title:i("Shoot!"),test:i("No Application Set!  Why?")}),this.emit("save.error",!0),!1;this.busy();try{let t=await this.AB.processNew(e);await t.save(),await this.CurrentApplication.processInsert(t),this.emit("save",t),this.clear(),this.hide()}catch(e){return console.error(e),this.emit("save.error",e),!1}return this.ready(),!0}show(){this.$component&&this.$component.show()}hide(){this.$component&&this.$component.hide()}clear(){this.$form.clearValidation(),this.$form.clear(),this.$buttonSave.enable()}busy(){this.$component&&this.$component.showProgress&&this.$component.showProgress({type:"icon"})}ready(){this.$component&&this.$component.hideProgress&&this.$component.hideProgress()}}}(e)}ui(){return this.ListComponent.ui()}async init(e){this.AB=e,this.on("addNew",(e=>{this.clickNewProcess(e)})),await this.ListComponent.init(e),this.ListComponent.on("selected",(e=>{this.emit("selected",e)})),this.ListComponent.on("addNew",(e=>{this.clickNewProcess(e)})),this.ListComponent.on("deleted",(e=>{this.emit("deleted",e)})),this.ListComponent.on("exclude",(e=>{this.exclude(e)})),this.ListComponent.on("copied",(e=>{this.copy(e)})),await this.AddForm.init(e),this.AddForm.on("cancel",(()=>{this.AddForm.hide()})),this.AddForm.on("save",(e=>{this.applicationLoad(this.CurrentApplication),this.ListComponent.select(e.id)}))}applicationLoad(e){super.applicationLoad(e),this.ListComponent.dataLoad(e?.processes()),this.AddForm.applicationLoad(e)}clickNewProcess(){this.AddForm.show()}copy(e){this.ListComponent.busy(),this.CurrentApplication.processCreate(e.item).then((e=>{this.ListComponent.ready(),this.ListComponent.dataLoad(this.CurrentApplication.processes()),this.ListComponent.select(e.id)}))}async exclude(e){this.ListComponent.busy(),await this.CurrentApplication.processRemove(e),this.ListComponent.dataLoad(this.CurrentApplication.processes()),this.emit("selected",null)}busy(){this.ListComponent.busy()}ready(){this.ListComponent.ready()}warningsRefresh(){if(this.CurrentApplication){var e=e=>!e.isSystemObject;this.AB.Account.isSystemDesigner()&&(e=()=>!0);let t=this.ListComponent.selectedItem();this.ListComponent.dataLoad(this.CurrentApplication?.processes(e)),this.ListComponent.selectItem(t?.id)}}}}(e),this.ProcessWorkspace=function(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e);var o=i.L();let a={ui:()=>{},init:()=>Promise.resolve(),applicationLoad:()=>{},clearWorkspace:()=>{},processLoad:()=>{}};const s=Pv(e),r=a,l=function(e){const t=(0,n.Z)(e),i=t.L();return new class extends t{constructor(){super("ui_work_process_workspace_monitor",{component:"",taskList:"",processLogs:"",detailView:"",resetButton:"",deleteButton:"",context:"",error:"",tabGroup:""})}ui(){const e=this.ids;return{id:e.component,cols:[{gravity:1,rows:[{view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{type:"spacer",width:15},{view:"label",label:i("Instances")},{view:"icon",id:"filterIcon",css:"icon-disable",icon:"fa fa-filter",align:"right",popup:{view:"checksuggest",id:"instanceFilter",button:!1,body:{template:`${i("Hide")} #value#`},data:[{id:"completed",value:i("Completed")},{id:"created",value:i("Created")},{id:"error",value:i("Error")}],on:{onValueSuggest:()=>{const t=$$("instanceFilter").config.value.split(",").filter((e=>""!==e)),i=this.instances.filter((e=>-1==t.indexOf(e.status)));$$(e.taskList).clearAll(),$$(e.taskList).parse(i),$$("filterIcon").config.badge=0==t.length?"":t.length,$$("filterIcon").refresh()}}}}]},{view:"list",id:e.taskList,select:!0,navigation:!0,item:{height:74,template:e=>{const{icon:t,color:i}={error:{icon:"fa-times-circle",color:"#FF5C4C"},created:{icon:"fa-clock-o",color:"#FFAE38"},completed:{icon:"fa-check-circle",color:"#38AEA2"}}[e.status]??{icon:"fa-question",color:"gray"};return`<div\n                                    style="float:left;height:70px;line-height:70px;margin-right:10px;color:${i};"\n                                    class="fa ${t} fa-2x">\n                                 </div>\n                                 <div style="margin:5px 0;height:60px;overflow:hidden;line-height:20px">\n                                    <div style="font-size: 16px; font-weight: 600;">\n                                       ${new Date(e.updated_at).toLocaleString(window?.webixLocale??"en-US")}\n                                    </div>\n                                    <div>${e.log[e.log.length-1].split(":")[2]}</div>\n                                 </div>`}},on:{onItemClick:e=>this.showInstance(e)}}]},{view:"resizer",css:"bg_gray",width:11},{gravity:2,rows:[{gravity:2,rows:[{view:"toolbar",css:"ab-data-toolbar webix_dark",cols:[{type:"spacer",width:15},{view:"label",label:i("Instance Details")},{id:e.resetButton,view:"button",width:100,css:"webix_secondary",type:"icon",icon:"fa fa-refresh",label:i("Reset"),click:()=>this.resetInstance()},{id:e.deleteButton,view:"button",width:100,css:"webix_danger",type:"icon",icon:"fa fa-trash",label:i("Delete"),click:()=>this.deleteInstance()},{type:"spacer",width:1}]},{view:"property",height:200,id:e.detailView,editable:!1,elements:[{label:i("Instance"),type:"label"},{label:i("ID"),type:"text",id:"id"},{label:i("Created"),type:"date",id:"created"},{label:i("Updated"),type:"date",id:"updated"},{label:i("Job ID"),type:"text",id:"jobId"},{label:i("Status"),type:"text",id:"status"},{label:i("Triggered By"),type:"text",id:"triggeredBy"}]}]},{view:"tabview",id:e.tabGroup,css:"webix_dark",cells:[{header:i("Logs"),body:{id:e.processLogs,view:"list",type:{height:"auto"},template:'<div style="padding:5px 0; line-height:20px;color:black">#value#</div>'}},{header:i("Context"),body:{view:"treetable",id:e.context,css:{color:"black !important"},resizable:!0,scroll:!0,columns:[{id:"title",header:i("Property"),width:300,template:"{common.treetable()} #key#"},{id:"value",header:i("Value"),width:500}]}}]}]}]}}async init(e){this.model=e.objectProcessInstance().model()}async processLoad(e){super.processLoad(e);const t={};t["d5afbc83-17dd-4b38-bded-1bf3f4594135"]=e.id;const i=await this.model.findAll({where:t});this.instances=i.data.sort(((e,t)=>new Date(t.updated_at)-new Date(e.updated_at)));const n=$$(this.ids.taskList);n.clearAll(),n.parse(this.instances),this.instances[0]&&(this.showInstance(this.instances[0].id),n.select(this.instances[0].id))}showInstance(e){this.instance=e;const t=this.ids;if(!e)return $$(t.processLogs).clearAll(),$$(t.detailView).clear(),$$(t.tabGroup).removeView(t.error),$$(t.context).clearAll(),$$(t.resetButton).hide(),void $$(t.deleteButton).hide();const i=$$(t.taskList).getItem(e),n=i.log.map(((e,t)=>({id:t,value:e})));if($$(t.processLogs).clearAll(),$$(t.processLogs).parse(n),$$(t.detailView).setValues({id:i.id,created:new Date(i.created_at),updated:new Date(i.updated_at),jobId:i.jobID,status:i.status,triggeredBy:i.triggeredBy}),$$(t.context).clearAll(),$$(t.context).parse(this.processContext(i.context),"json"),$$(t.context).refresh(),$$(t.detailView).refresh(),$$(t.tabGroup).removeView(t.error),i.errorTasks){const e=[];for(var o in i.errorTasks)e.push({key:o,error:i.errorTasks[o]});$$(t.tabGroup).addView({header:"Errors",body:{id:t.error,view:"list",type:{height:"auto"},template:'<div style="color:black">#key# #error#</div>',data:e}})}"error"==i.status?$$(t.resetButton).show():$$(t.resetButton).hide(),$$(t.deleteButton).show()}async deleteInstance(){const e=this.instance;if(await webix.confirm({title:i("Delete Instance"),text:i("Are you sure? This can't be undone."),type:"confirm-warning"}).catch((()=>{})))if((await this.model.delete(e)).numRows>0){const t=$$(this.ids.taskList),n=t.getNextId(this.instance);t.remove(this.instance),this.showInstance(n),webix.message({text:`${i("Deleted Instance")} ${e}`,type:"success"})}else webix.messages({text:i("No rows were effected.  This does not seem right."),type:"warn"})}async resetInstance(){const e=$$(this.ids.taskList).getItem(this.instance),t=Object.keys(e.errorTasks);if(t.length<1)return;const n=this.CurrentProcess.elements().filter((e=>e.diagramID===t[0]))[0];await webix.confirm({title:i("Reset Instance"),text:`${i("Restart from")} '${n.label}' (${n.key} ${i("Task")})?`}).catch((()=>{}))&&1==await this.AB.Network.put({url:`/process/reset/${n.id}`,params:{instanceID:this.instance}})&&(webix.message({text:i("Instance Reset"),type:"success"}),this.processLoad(this.CurrentProcess))}processContext(e){const t=[];for(const i in e)"object"!=typeof e[i]||Array.isArray(e[i])||null===e[i]?t.push({key:i,value:e[i]}):t.push({key:i,open:!0,data:this.processContext(e[i])});return t}show(){$$(this.ids.component).show()}}}(e);return new class extends i{constructor(){super("ui_work_process_workspace",{multiview:"",tabbar:"",tabModel:"",tabTest:"",tabMonitor:"",noSelection:"",selectedItem:""})}ui(){let e=this.ids;return{view:"multiview",id:e.component,keepViews:!0,rows:[{id:e.noSelection,rows:[{maxHeight:t.xxxLargeSpacer,hidden:t.hideMobile},{view:"label",align:"center",height:200,label:"<div style='display: block; font-size: 180px; background-color: #666; color: transparent; text-shadow: 0px 1px 1px rgba(255,255,255,0.5); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text;' class='fa fa-code-fork'></div>"},{view:"label",align:"center",label:o("Select a process to work with.")},{cols:[{},{view:"button",label:o("Add new process"),type:"form",css:"webix_primary",autowidth:!0,click:()=>{this.addNewProcess()}},{}]},{maxHeight:t.xxxLargeSpacer,hidden:t.hideMobile}]},{id:e.selectedItem,type:"wide",paddingY:0,rows:[{id:e.tabbar,view:"tabbar",css:"webix_dark",type:"bottom",borderless:!1,bottomOffset:0,options:[{id:e.tabModel,value:o("Model"),icon:"fa fa-code-fork",type:"icon",on:{click:()=>{this.changeTab("model")}}},{id:e.tabTest,value:o("Test"),icon:"fa fa-check-square",type:"icon",on:{click:()=>{this.changeTab("test")}}},{id:e.tabMonitor,value:o("Monitor"),icon:"fa fa-tachometer",type:"icon",on:{click:()=>{this.changeTab("monitor")}}}],on:{onChange:(e,t)=>{e!=t&&this.changeTab(e)}}},{id:e.multiview,view:"multiview",cells:[s.ui(),l.ui()]}]}]}}async init(e){this.AB=e,this.warningsPropogate([s,l]),$$(this.ids.noSelection).show();var t=[s.init(e),r.init(e),l.init(e)];await Promise.all(t)}addNewProcess(){this.emit("addNew")}applicationLoad(e){super.applicationLoad(e),s.applicationLoad(e),r.applicationLoad(e),l.applicationLoad(e)}changeTab(e){let t=this.ids;switch(e){case t.tabModel:$$(t.multiview).setValue(s.ids.component);break;case t.tabTest:$$(t.multiview).setValue(r.ids.component);break;case t.tabMonitor:$$(t.multiview).setValue(l.ids.component)}}clearWorkspace(){$$(this.ids.noSelection).show(!1,!1),s.clearWorkspace(),r.clearWorkspace(),l.clearWorkspace()}processLoad(e){super.processLoad(e),$$(this.ids.selectedItem).show(),s.processLoad(this.CurrentProcess),r.processLoad(this.CurrentProcess),l.processLoad(this.CurrentProcess)}}}(e)}ui(){return{id:this.ids.component,type:"space",margin:10,cols:[this.ProcessList.ui(),{view:"resizer",css:"bg_gray",width:11},this.ProcessWorkspace.ui()]}}init(e){return this.AB=e,this.warningsPropogate([this.ProcessList,this.ProcessWorkspace]),this.on("warnings",(()=>{this.ProcessList.warningsRefresh()})),this.ProcessWorkspace.on("addNew",(()=>{this.ProcessList.clickNewProcess(!0)})),this.ProcessList.on("selected",(e=>{this.select(e)})),this.ProcessList.on("deleted",(e=>{this.CurrentProcessID==e.id&&this.select(null)})),Promise.all([this.ProcessWorkspace.init(e),this.ProcessList.init(e)])}applicationLoad(e){super.applicationLoad(e),this.ProcessWorkspace.applicationLoad(e),this.ProcessList.applicationLoad(e)}show(){$$(this.ids.component).show(!1,!1);var e=this.CurrentApplication;e&&(!e.loadedProcesss||this.ProcessList?.count()<1)&&(this.ProcessList?.busy(),this.ProcessList?.applicationLoad(e),this.ProcessList?.ready())}select(e){this.CurrentProcessID=e?.id,e?this.ProcessWorkspace?.processLoad(e):this.ProcessWorkspace?.clearWorkspace()}}}(e),c=T(e),d=Lv(e);return new class extends t{constructor(e={}){super("abd_work",{toolBar:"",labelAppName:"",tabbar:"",tab_object:"",tab_query:"",tab_datacollection:"",tab_processview:"",tab_interface:"",tab_version:"",workspace:"",collapseMenu:"",expandMenu:""}),this.options=e,this.cacheSidebarItems={},this.selectedItem=this.ids.tab_object}scanTopic(e,t){let i=0,n={};return e&&e[t]().forEach((e=>{e.warningsEval(),i+=(e.warningsAll()||[]).length})),i&&(n.icon=this.WARNING_ICON_DARK,n.count=i),n}sidebarItems(e){let t=e?.id??null;if(!this.cacheSidebarItems[t]){const n=this.scanTopic(e,"objectsIncluded"),o=this.scanTopic(e,"queriesIncluded"),a=this.scanTopic(e,"datacollectionsIncluded"),s=this.scanTopic(e,"processes"),r=this.scanTopic(e,"pages");this.cacheSidebarItems[t]=[{id:this.ids.tab_object,value:`${i("Objects")}`,icon:"fa fa-fw fa-database",issues:n},{id:this.ids.tab_query,value:`${i("Queries")}`,icon:"fa fa-fw fa-filter",issues:o},{id:this.ids.tab_datacollection,value:i("Data Collections"),icon:"fa fa-fw fa-table",issues:a},{id:this.ids.tab_processview,value:i("Process"),icon:"fa fa-fw fa-code-fork",issues:s},{id:this.ids.tab_interface,value:i("Interface"),icon:"fa fa-fw fa-id-card-o",issues:r},{id:this.ids.tab_version,value:i("Version"),icon:"fa fa-fw fa-code-fork",on:{onclick:()=>{d.show()}}}],setTimeout((()=>{this.cacheSidebarItems[t]=null}),500)}return this.cacheSidebarItems[t]}ui(){var e=this.sidebarItems(),t=this.expandMenu={id:this.ids.expandMenu,value:i("Expand Menu"),icon:"fa fa-fw fa-chevron-circle-right"},n={id:this.ids.collapseMenu,value:i("Collapse Menu"),icon:"fa fa-fw fa-chevron-circle-left"};return{id:this.ids.component,rows:[{view:"toolbar",id:this.ids.toolBar,autowidth:!0,elements:[{view:"button",css:"webix_transparent",label:i("Back to Applications page"),autowidth:!0,type:"icon",icon:"fa fa-arrow-left",hidden:this.options?.IsBackHidden??!1,click:()=>{this.emit("view.chooser")}},{},{view:"label",css:"appTitle",id:this.ids.labelAppName,align:"center"},{}]},{cols:[{id:this.ids.tabbar,css:"webix_dark",view:"sidebar",animate:!1,width:160,data:e.concat(n),on:{onAfterSelect:e=>{e==this.ids.collapseMenu?setTimeout((()=>{this.$tabbar.remove(this.ids.collapseMenu),this.$tabbar.add(t),this.$tabbar.toggle(),this.$tabbar.select(this.selectedItem),this.saveState()}),0):e==this.ids.expandMenu?setTimeout((()=>{this.$tabbar.remove(this.ids.expandMenu),this.$tabbar.add(n),this.$tabbar.toggle(),this.$tabbar.select(this.selectedItem),this.saveState()}),0):(this.tabSwitch(e),this.selectedItem=e)}},template:function(e,t){return t.collapsed?t.icon(e,t):(e.issues?.icon||"")+t.icon(e,t)+"<span>"+e.value+"</span>"},tooltip:{template:function(e){return e.issues?.count?`${e.issues?.count} issues`:""}}},{id:this.ids.workspace,cells:[o.ui(),a.ui(),s.ui(),r.ui(),c.ui(),d.ui()]}]}]}}async init(e){this.AB=e,this.warningsPropogate([o,a,s,r,c]),this.on("warnings",(()=>{this.CurrentApplication.warningsEval(),this.refreshSideBar(this.CurrentApplication)})),o.init(e),a.init(e),s.init(e),r.init(e),c.init(e),d.init(e),this.$tabbar=$$(this.ids.tabbar);var t=this.AB.Storage.get(this.ids.component);t&&(this.$tabbar.setState(t),t.collapsed&&setTimeout((()=>{this.$tabbar.remove(this.ids.collapseMenu),this.$tabbar.add(this.expandMenu)}),0)),this.tabSwitch(this.ids.tab_object),this.$tabbar.select(this.ids.tab_object)}applicationInit(e){if(e){var t=$$(this.ids.labelAppName);t.define("label",e?.label),t.refresh()}super.applicationLoad(e)}saveState(){this.AB.Storage.set(this.ids.component,this.$tabbar.getState())}show(){$$(this.ids.component).show();let e=this.$tabbar.getSelectedId();this.tabSwitch(e)}refreshSideBar(e){let t=$$(this.ids.tabbar),i=this.sidebarItems(e);t?.define("data",i),t?.refresh()}transitionWorkspace(e){this.CurrentApplicationID!=e?.id&&this.applicationInit(e),o.applicationLoad(e),a.applicationLoad(e),s.applicationLoad(e),r.applicationLoad(e),c.applicationLoad(e),d.applicationLoad(e),this.refreshSideBar(e),this.show()}tabSwitch(e){switch(e){case this.ids.tab_object:o.show();break;case this.ids.tab_query:a.show();break;case this.ids.tab_datacollection:s.show();break;case this.ids.tab_processview:r.show();break;case this.ids.tab_interface:c.show();break;case"interface":c.show(),this.$tabbar.select(this.ids.tab_interface);break;case this.ids.tab_version:d.show()}}}}const Vv=[i(7980).Z];function Bv(e){var t=function(e){const t=(0,n.Z)(e),i=function(e){const t=function(e){const t=e.Config.uiSettings(),i=(0,n.Z)(e);var o=i.L();const s=a(e);return new class extends i{constructor(){super("abd_choose_list",{toolbar:"",buttonCreateNewApplication:"",uploader:"",exporter:"",list:""}),this.cacheTemplate={}}ui(){return{id:this.ids.component,responsive:"hide",type:"space",cols:[{maxWidth:t.appListSpacerColMaxWidth,minWidth:t.appListSpacerColMinWidth,width:t.appListSpacerColMaxWidth},{responsiveCell:!1,rows:[{maxHeight:t.appListSpacerRowHeight,hidden:t.hideMobile},{view:"toolbar",css:"webix_dark",id:this.ids.toolBar,cols:[{view:"spacer",width:10},{view:"label",label:o("Applications"),fillspace:!0,on:{onAfterRender(){i.CYPRESS_REF(this)}}},{id:this.ids.buttonCreateNewApplication,view:"button",label:o("Add new application"),autowidth:!0,type:"icon",icon:"fa fa-plus",css:"webix_transparent",click:()=>{this.emit("view.form",null)},on:{onAfterRender(){i.CYPRESS_REF(this)}}},{view:"uploader",id:this.ids.uploader,label:o("Import"),autowidth:!0,upload:"/definition/import",multiple:!1,type:"icon",icon:"fa fa-upload no-margin",autosend:!0,css:"webix_transparent",on:{onAfterFileAdd:()=>{$$(this.ids.uploader).disable()},onFileUpload:()=>(window.location.reload(),!1),onFileUploadError:e=>(this.AB.notify.developer("Error uploading file",{url:e.xhr.responseURL,status:e.status,code:e.xhr.status,response:e.xhr.responseText}),$$(this.ids.uploader).enable(),!1),onAfterRender(){i.CYPRESS_REF(this)}}},{view:"button",id:this.ids.exporter,label:o("Export All"),autowidth:!0,type:"icon",icon:"fa fa-download",css:"webix_transparent",click:function(){window.location.assign("/definition/export/all?download=1")},on:{onAfterRender(){i.CYPRESS_REF(this)}}}]},{id:this.ids.list,view:"list",css:"ab-app-select-list",template:(e,t)=>this.templateListItem(e,t),tooltip:e=>this.toolTipListItem(e),type:{height:t.appListRowHeight,iconGear:function(e){return`<span class="webix_icon fa fa-cog" data-cy="edit_${e.id}"></span>`},iconAdmin:function(e){return e.isAdminApp?"<span class='webix_icon fa fa-circle-o-notch'></span> ":""}},select:!1,onClick:{"ab-app-list-item":(e,t,i)=>this.onClickListItem(e,t,i),"ab-app-list-edit":(e,t,i)=>this.onClickListEdit(e,t,i)},onHover:{},on:{onAfterRender(){this.data.each((e=>{i.CYPRESS_REF(this.getItemNode(e.id),e.id)}))}}},{maxHeight:t.appListSpacerRowHeight,hidden:t.hideMobile}]},{maxWidth:t.appListSpacerColMaxWidth,minWidth:t.appListSpacerColMinWidth,width:t.appListSpacerColMaxWidth}]}}async init(e){this.AB=e,this.$list=$$(this.ids.list),webix.extend(this.$list,webix.ProgressBar),webix.extend(this.$list,webix.OverlayBox),this.MenuComponent=new s(this.ids.component),this.MenuComponent.init(e);var t=[{label:o("Edit"),icon:"fa fa-pencil-square-o",command:"edit"},{label:o("Export"),icon:"fa fa-download",command:"export"},{label:o("Delete"),icon:"fa fa-trash",command:"delete"}];return this.MenuComponent.menuOptions(t),this.MenuComponent.on("click",(e=>{var t=this.$list.getSelectedItem();switch(e){case"edit":this.emit("edit.form",t);break;case"delete":webix.confirm({title:o("Delete {0}?",[o("Application")]),text:o("Do you want to delete <b>{0}</b>?",[t.label]),ok:o("Yes"),cancel:o("No"),callback:async e=>{if(e){this.busy();try{await t.destroy(),this.refreshList(),webix.message({type:"success",text:o("{0}&nbsp; Successfully Deleted",[t.label])})}catch(e){webix.message({type:"error",text:o("There was an error deleting {0}.",[t.label])})}this.ready()}}});break;case"export":window.location.assign(`/definition/export/${t.id}?download=1`)}})),this.AB.Network.on("definitions.allapplications",((e,t,i)=>{if(this.ready(),t)return this.AB.notify.developer(t,{plugin:"ABDesigner",context:"ui_choose_list:init(): /definition/allapplications"}),void e?.reject?.(t);this.AB.definitionsParse(i),e?.resolve?.()})),this._handler_reload=e=>{"application"==e?.type?(this.loaded=!1,this.loadData()):e||this.AB.notify.developer(new Error("No def passed"),{plugin:"ABDesigner",context:"_handler_reload(): /definition/allapplications"})},this.loadAllApps().then((()=>{this.AB.on("definition.created",this._handler_reload)}))}busy(){this.$list.disable(),this.$list.showProgress&&this.$list.showProgress({type:"icon"})}async loadAllApps(){return this._loadInProgress||(this.busy(),this._loadInProgress=new Promise(((e,t)=>{var i={key:"definitions.allapplications",context:{resolve:e,reject:t}};this.AB.Network.get({url:"/definition/allapplications"},i)}))),this._loadInProgress}async loadData(){if(await this.loadAllApps(),!this.loaded){this.loaded=!0,this.busy();var e=e=>!e.isSystemObj;this.AB.Account.isSystemDesigner()&&(e=()=>!0);var t=this.AB.applications(e);this.dcEditableApplications=new webix.DataCollection({data:t||[]}),["definition.updated","definition.deleted"].forEach((e=>{t.forEach((t=>{t.removeListener(e,this._handler_reload),t.on(e,this._handler_reload)}))})),this.dcEditableApplications.attachEvent("onAfterAdd",(()=>{this.refreshOverlay()})),this.dcEditableApplications.attachEvent("onAfterDelete",(()=>{this.refreshOverlay()})),this.refreshList(),this.ready()}}onClickListEdit(e,t,i){return this.MenuComponent.show(i),this.$list.select(t),!1}onClickListItem(e,t){this.$list.select(t);let i=this.$list.getItem(t);return i&&(i.App=this.AB.App,this.emit("view.workplace",i)),!1}ready(){this.$list.enable(),this.$list.hideProgress&&this.$list.hideProgress()}refreshList(){this.$list.clearAll(),this.$list.data.unsync(),this.$list.data.sync(this.dcEditableApplications),this.$list.sort("label","asc"),this.refreshOverlay(),this.$list.refresh(),this.ready()}refreshOverlay(){this.$list.count()?this.$list.hideOverlay():this.$list.showOverlay(o("There is no application data"))}show(){super.show(),this.loadData()}templateListItem(e,t){if(!this.cacheTemplate[e.id]){var i={icon:"",count:0};e.warningsAll().length&&(i.icon=this.WARNING_ICON,i.count=e.warningsAll().length),this.cacheTemplate[e.id]=`<div class='ab-app-list-item'>\n   <div class='ab-app-list-info'>\n      <div class='ab-app-list-name'><i class="lighten fa-fw fa ${e.icon}"></i> ${t.iconAdmin(e)}${e.label??""}</div>\n      <div class='ab-app-list-description'>${e.description??""}</div>\n   </div>\n   <div class='ab-app-list-edit'>\n      ${i.icon}\n      ${t.iconGear(e)}\n   </div>\n</div>`,setTimeout((()=>{delete this.cacheTemplate[e.id]}),400)}return this.cacheTemplate[e.id]}toolTipListItem(e){let t=$$(this.ids.list).data.getItem(e.id).warningsAll().length;return t?`${t} issues`:""}}}(e),i=function(e,t){const i=e.Config.uiSettings(),o=(0,n.Z)(e);var a=o.L();const l=(0,r.Z)(e);s(e,"view_warnings",void 0);var c="<span class='webix_icon wxi-alert' style='font-size:18px; color:#EED202;'>&nbsp;</span>",d=e.UISettings.icons.map((e=>`fa-${e}`));return new class extends o{constructor(){super("abd_choose_form",{form:"",appFormPermissionList:"",appFormCreateRoleButton:"",saveButton:"",accessManager:"",accessManagerToolbar:"",translationManager:"",translationManagerToolbar:"",icon:"",issue_id:"",issue_list:""})}ui(){return this.accessManagerUI=new l("application_amp"),this.translationManagerUI=new l("application_translate"),{view:"window",id:this.ids.component,css:"app_form_window",height:670,width:770,position:"center",move:!0,scroll:!0,resize:!0,modal:!0,head:{type:"clean",cols:[{view:"spacer",width:4},{view:"icon",icon:"wxi-alert",css:"alert",on:{onItemClick:()=>{const e=$$(this.ids.issue_id),t=$$(this.ids.issue_list);t.define("data",this.warningData()),t.refresh(),e.show()}}},{template:a("Application Info"),type:"header",css:"webix_win_title"},{view:"icon",icon:"wxi-close",click(){this.getTopParentView().hide()}},{view:"spacer",width:4}]},body:{view:"scrollview",scroll:!0,body:{padding:4,cols:[{view:"spacer",width:2},{rows:[{view:"form",id:this.ids.form,rules:{label:e=>0<e.length&&e.length<=20},borderless:!0,elements:[{name:"label",view:"text",label:a("Name"),labelWidth:100,placeholder:a("Application Name"),invalidMessage:a("&nbsp; Name must be less than or equal to 20 letters."),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_label")}}},{name:"version",view:"text",label:a("Version"),labelWidth:100,placeholder:a("1.0.0"),invalidMessage:a("&nbsp; can only contain numbers or '.'s ."),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_version_number")}}},{name:"icon",view:"richselect",id:"richselect1",label:a("Icon"),labelWidth:100,placeholder:a("Menu Icon"),options:{body:{template:"<span class='fa #value#' style='color: #33b5e5;'></span>&nbsp; #value#",yCount:3,data:d}},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_icon")}}},{height:i.smallSpacer},{name:"description",view:"textarea",label:a("Description"),labelWidth:100,height:100,placeholder:a("Application Description"),on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_description")}}},{view:"spacer",height:4},{name:"isSystemObject",view:"checkbox",labelRight:a("Is this a System Object?"),labelWidth:0,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_isSystemObj")}}},{view:"label",label:a("Who can use this app?"),css:"npr_smallLabels"},{name:"roleAccess",view:"multicombo",id:this.ids.appFormPermissionList,label:"",labelPosition:"top",placeholder:a("Click to add Role"),button:!0,on:{onAfterRender(){this.data.value.forEach((t=>{e.ClassUI.CYPRESS_REF(`perm_role_${t.id}`)}))}}},{name:"isAccessManaged",view:"checkbox",labelRight:a("Enable Page / Tab Access Management"),labelWidth:0,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_isAccessManaged")},onChange:e=>{e?($$(this.ids.accessManager).show(),$$(this.ids.accessManagerToolbar).show()):($$(this.ids.accessManager).hide(),$$(this.ids.accessManagerToolbar).hide())},onItemClick:e=>{$$(e).getValue()?($$(this.ids.accessManager).show(),$$(this.ids.accessManagerToolbar).show()):($$(this.ids.accessManager).hide(),$$(this.ids.accessManagerToolbar).hide())}}},{view:"toolbar",id:this.ids.accessManagerToolbar,cols:[{view:"label",label:a("Who can manage page / tab access for this app?"),css:"npr_smallLabels"}],borderless:!0,hidden:1!=parseInt(this.accessManagement)},{id:this.ids.accessManager,rows:[this.accessManagerUI.ui()],paddingY:10,hidden:1!=parseInt(this.accessManagement)},{view:"spacer",height:6},{name:"isTranslationManaged",view:"checkbox",labelRight:a("Enable Translation Tool"),labelWidth:0,on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_isTranslationManaged")},onChange:e=>{e?($$(this.ids.translationManager).show(),$$(this.ids.translationManagerToolbar).show()):($$(this.ids.translationManager).hide(),$$(this.ids.translationManagerToolbar).hide())},onItemClick:e=>{$$(e).getValue()?($$(this.ids.translationManager).show(),$$(this.ids.translationManagerToolbar).show()):($$(this.ids.translationManager).hide(),$$(this.ids.translationManagerToolbar).hide())}}},{view:"toolbar",id:this.ids.translationManagerToolbar,cols:[{view:"label",label:a("Who can translate this app?"),css:"npr_smallLabels"}],borderless:!0,hidden:1!=parseInt(this.translationManagement)},{id:this.ids.translationManager,rows:[this.translationManagerUI.ui()],paddingY:10,hidden:1!=parseInt(this.translationManagement)},{view:"spacer",height:2},{view:"toolbar",margin:14,paddingY:20,cols:[{view:"button",value:a("Cancel"),css:"ab-cancel-button",inputWidth:100,align:"right",click:()=>{this.cancel()},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this,"abd_choose_form_cancel")}}},{view:"button",id:this.ids.saveButton,value:a("Save"),css:"webix_primary",inputWidth:100,click:()=>{this.buttonSaveClick()},on:{onAfterRender(){e.ClassUI.CYPRESS_REF(this)}}}],borderless:!0}]}]},{view:"spacer",width:8}]}}}}init(e){this.AB=e,this.AB.Webix.ui(this.ui()),webix.extend($$(this.ids.form),this.AB.Webix.ProgressBar),webix.extend($$(this.ids.appFormPermissionList),this.AB.Webix.ProgressBar),this.AB.Webix.ui({view:"window",id:this.ids.issue_id,css:"app_form_window_2",height:222,width:700,head:{type:"clean",cols:[{view:"spacer",width:50},{template:c+a(" Issues"),type:"header",css:"webix_win_title"},{view:"icon",icon:"wxi-close",click(){this.getTopParentView().hide()}},{view:"spacer",width:4}]},position:"center",close:!0,modal:!0,move:!0,scroll:!0,body:{rows:[{view:"list",id:this.ids.issue_list,template:c+" #issue#",scrollX:!0,scrollY:!0,select:!0,editable:!1,autoheight:!1,autowidth:!1,data:[],click(){this.getParentView().show()}}]}}),this.permissionPopulate()}toList(){this.emit("view.list")}warningData(){const e=this.AB.applications(),t=[];return e.forEach((e=>{t.push(...e.warningsAll())})),t?.length?t.map(((e,t)=>({id:t,issue:a(e.message)}))):[{id:1,issue:a("No Issues Found")}]}async applicationCreate(e){e.name=e.label;var t=this.AB.applicationNew(e);try{await t.save(),webix.message({type:"success",text:a("{0}&nbsp; Successfully Created",[e.label])})}catch(t){webix.message({type:"error",text:a("Error Creating {0}",[e.label])}),this.AB.notify.developer(t,{plugin:"ABDesigner",context:"ui_choose_form:applicationCreate()",values:e})}}async applicationUpdate(e){var t=this.formValues(),i={};Object.keys(t).forEach((n=>{i[n]=e[n],e[n]=t[n]}));try{await e.save(),webix.message({type:"success",text:a("{0} Successfully Updated",[e.label])})}catch(n){webix.message({type:"error",text:a("Error Updating {0}",[e.label])}),this.AB.notify.developer(n,{context:"ui_choose_form:applicationUpdate()",application:e.toObj(),values:t}),Object.keys(i).forEach((t=>{e[t]=i[t]}))}}async buttonSaveClick(){if(this.buttonSaveDisable(),this.formBusy(),this.CurrentApplication){if(this.formValidate("update")){try{await this.applicationUpdate(this.CurrentApplication),this.toList()}catch(e){}this.formReady(),this.buttonSaveEnable(),$$(this.ids.component).hide()}}else if(this.formValidate("add")){try{await this.applicationCreate(this.formValues()),this.formReset(),this.toList()}catch(e){}this.formReady(),this.buttonSaveEnable(),$$(this.ids.component).hide()}}buttonSaveDisable(){$$(this.ids.saveButton).disable()}buttonSaveEnable(){$$(this.ids.saveButton).enable()}cancel(){this.formReset(),this.toList(),$$(this.ids.component).hide()}formBusy(){$$(this.ids.form).showProgress({type:"icon"})}formPopulate(e){if(super.applicationLoad(e),e){["label","description","version","icon","isSystemObject","isAccessManaged","isTranslationManaged"].forEach((t=>{$$(this.ids.form).elements[t]&&$$(this.ids.form).elements[t].setValue(e[t]||e.json[t])}));var t=$$(this.ids.accessManager);t.removeView(t.getChildViews()[0]),t.addView(this.accessManagerUI.ui(e.accessManagers||{}),0);var i=$$(this.ids.translationManager);i.removeView(i.getChildViews()[0]),i.addView(this.translationManagerUI.ui(e.translationManagers||{}),0)}this.permissionPopulate(e)}formReady(){$$(this.ids.form).hideProgress()}formReset(){super.applicationLoad(null),$$(this.ids.form).clear(),$$(this.ids.form).clearValidation(),this.permissionPopulate(),$$(this.ids.accessManager).removeView($$(this.ids.accessManager).getChildViews()[0]),$$(this.ids.translationManager).removeView($$(this.ids.translationManager).getChildViews()[0]),$$(this.ids.accessManager).addView(this.accessManagerUI.ui(),0),$$(this.ids.translationManager).addView(this.translationManagerUI.ui(),0)}formValidate(e){if(!$$(this.ids.form).validate())return this.formReady(),this.buttonSaveEnable(),!1;var t=[];if("add"===e){var i=this.formValues();i.name=i.label;var n=this.AB.applicationNew(i),o=[];(this.AB.applications()||[]).forEach((e=>{e.areaKey()==n.areaKey()&&o.push(e)})),o.length>0&&t.push({attr:"label",msg:a("&nbsp; Name ({0}) is already in use.",[n.label])})}if(t.length>0){var s=!1;return t.forEach((e=>{$$(this.ids.form).markInvalid(e.attr,e.msg),s||($$(this.ids.form).elements[e.attr].focus(),s=!0)})),this.formReady(),this.buttonSaveEnable(),!1}return!0}formValues(){const e=$$(this.ids.form).getValues();return e.roleAccess=(e.roleAccess??"").split(","),e.accessManagers=this.accessManagerUI.values(),e.translationManagers=this.translationManagerUI.values(),e}permissionPopulate(e){const t=$$(this.ids.appFormPermissionList),i=this.AB.Account.rolesAll().map((e=>({id:e.id,value:e.name})));e&&i.filter((t=>e.roleAccess.indexOf(t.id)>-1)).map((e=>{e.markCheckbox=1}));const n=i.filter((e=>e.markCheckbox)).map((e=>e.id));t.define("suggest",i),t.setValue(n),t.refresh()}show(){$$(this.ids.component).show()}}}(e),o=(0,n.Z)(e);return new class extends o{constructor(){super("abd_choose")}ui(){return{id:this.ids.component,view:"multiview",animate:!1,cells:[t.ui()]}}async init(e){return this.AB=e,this.warningsPropogate([t,i]),this.on("warnings",(()=>{t.refreshList()})),t.on("view.workplace",(e=>{this.emit("view.workplace",e)})),t.on("view.form",(()=>{i.formReset(),i.show()})),t.on("edit.form",(e=>{i.formPopulate(e),i.show()})),i.on("view.list",(()=>{t.show()})),Promise.all([t.init(e),i.init(e)])}show(){super.show(),t.show()}}}(e),o=Fv(e);var l=t.L();return new class extends t{constructor(){super("abd"),this.id=this.ids.component,this.icon="connectdevelop"}label(){return l("AB Designer")}type(){return"page"}pages(){return[]}component(){return{ui:this.ui(),init:()=>this.init(e),onShow:()=>{this.show()}}}getUserAccess(){return 2}ui(){return{id:this.ids.component,view:"multiview",borderless:!0,animate:!1,rows:[i.ui(),o.ui()]}}async init(e){this.AB=e,i.on("view.workplace",(e=>{o.transitionWorkspace(e)})),o.on("view.chooser",(()=>{i.show()})),o.on("warnings",(()=>{i.emit("warnings")})),await Promise.all([i.init(e),o.init(e)]);try{await this.AB.Network.post({url:"/definition/register"})}catch(e){"E_NOPERM"==e?.code&&this.AB.notify.developer(e,{plugin:"ABDesigner",context:"ui::init():/definition/register",msg:"User is not able to access /definition/register"})}}isRoot(){return!0}show(){super.show(),i.show()}}}(e),i={id:"ABDesigner",label:"AB Designer",icon:"fa-connectdevelop",isPlugin:!0,pages:function(){return this._pages},_pages:[t],datacollectionsIncluded:()=>{var t=[];return e.datacollections((e=>t.indexOf(e.id)>-1))}};return t.application=i,function(e){Vv.forEach((t=>{new t(e)}))}(e),i}var Iv=i(8023),Tv=i.n(Iv),jv=i(1597),Ov={};Ov.styleTagTransform=bv(),Ov.setAttributes=mv(),Ov.insert=hv().bind(null,"head"),Ov.domAPI=dv(),Ov.insertStyleElement=gv(),lv()(jv.Z,Ov),jv.Z&&jv.Z.locals&&jv.Z.locals,window.__ABBS&&window.__ABBS.addPlugin({version:"0.0.0",key:"ABDesigner",apply:function(e){e.pluginLoad(Bv(e))},definitions:function(){return t()},labels:function(e){return Tv()[e]||Tv().en}})})()})();