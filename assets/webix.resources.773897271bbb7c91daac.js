/*! For license information please see webix.resources.773897271bbb7c91daac.js.LICENSE.txt */
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9c0f8054-ab3d-409a-85be-df542a0fe8a6",e._sentryDebugIdIdentifier="sentry-dbid-9c0f8054-ab3d-409a-85be-df542a0fe8a6")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"aa8d2ea067cbcd8f2916a3f03c22f9b64690a928"},(self.webpackChunkab_platform_web=self.webpackChunkab_platform_web||[]).push([[214],{69907:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=69907,e.exports=t},24327:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=24327,e.exports=t},31163:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=31163,e.exports=t},38509:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=38509,e.exports=t},1724:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,'@charset "UTF-8";.webix_gantt_tree .wxi-plus,.webix_gantt_tree .wxi-plus-circle{line-height:42px;font-size:22px}.webix_gantt_link{top:6px;width:16px;height:16px}.webix_gantt_milestone .webix_gantt_link{top:2px}.webix_gantt_milestone .webix_gantt_link_left.webix_gantt_link{left:-24px}.webix_gantt_milestone .webix_gantt_link_right.webix_gantt_link{right:-24px}.webix_gantt_scale .webix_template{padding:0}.webix_gantt_scale_row{display:flex;box-sizing:border-box}.webix_gantt_scale_row:not(:last-child){border-bottom:1px solid #dadee0}.webix_gantt_scale_cell{display:flex;flex:0 0 auto;justify-content:center;align-items:center;border-right:1px solid #dadee0;box-sizing:border-box;background-color:#f4f5f9}.webix_gantt_layer{position:absolute;top:0;left:0;width:100%;height:100%}.webix_gantt_task_base{position:absolute;box-sizing:border-box;border-radius:2px;color:#fff;cursor:pointer}.webix_gantt_project{background-color:#38aea2}.webix_gantt_task{background-color:#6ba8cb}.webix_gantt_project:hover,.webix_gantt_task:hover{z-index:3;box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_milestone{background-color:transparent}.webix_gantt_in_action .webix_gantt_task_base,.webix_gantt_task_in_action{pointer-events:none}.webix_drag_zone.webix_gantt_task_base{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_drag_zone.webix_gantt_task_base.webix_gantt_milestone{box-shadow:none}.webix_drag_zone.webix_gantt_task_base.webix_gantt_milestone .webix_gantt_content{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_progress{height:100%;background-color:#4d96c0;border-radius:2px 0 0 2px}.webix_gantt_project .webix_gantt_progress{background-color:#2e8f85}.webix_gantt_milestone .webix_gantt_content{transform:rotate(45deg);background-color:#cf89d5;border-radius:inherit;padding:0;width:100%;text-overflow:clip}.webix_gantt_milestone .webix_gantt_content span{visibility:hidden}.webix_gantt_milestone:hover .webix_gantt_content,.webix_gantt_milestone .webix_gantt_content:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_progress_drag{position:absolute;z-index:1;cursor:ew-resize;top:100%;border:10px solid transparent;border-bottom:10px solid #dadee0;margin-top:-19px;margin-left:-10px;visibility:hidden}.webix_gantt_task_base:hover .webix_gantt_progress_drag,.webix_gantt_mode_progress .webix_gantt_progress_drag{visibility:visible}.webix_gantt_progress_drag::before{content:"";position:absolute;border:8px solid transparent;border-bottom:8px solid #fff;top:-7px;left:-8px}.webix_gantt_progress_percent{position:absolute;left:-10px;top:9px;display:inline-block;line-height:14px;width:20px;border:1px solid #dadee0;border-top:0;border-radius:2px 2px 4px 4px;box-sizing:border-box;background:#fff;color:#1ca1c1;text-align:center;font-size:10px}.webix_gantt_content{text-align:center;line-height:30px;position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;user-select:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 12px}.webix_gantt_link{position:absolute;z-index:2;border-radius:50%;border:1px solid #dadee0;background-color:#fff;cursor:pointer;user-select:none;opacity:0}.webix_gantt_link_visible .webix_gantt_content:hover,.webix_gantt_task_base.webix_gantt_link_visible:hover,.webix_gantt_task_base.webix_gantt_link_visible:hover .webix_gantt_content{box-shadow:none}.webix_gantt_task,.webix_gantt_project{box-shadow:#fff 1px 0 0}.webix_gantt_milestone .webix_gantt_content{box-shadow:#fff 1px -1px 0}.webix_gantt_task.webix_gantt_link_visible .webix_gantt_progress_drag{visibility:hidden}.webix_gantt_link_visible .webix_gantt_link{opacity:1}.webix_gantt_link_left{left:-9px}.webix_gantt_link_right{right:-9px}.webix_gantt_task_base:hover .webix_gantt_link,.webix_gantt_link:hover{opacity:1}.webix_gantt_readonly .webix_gantt_task_base .webix_gantt_link{display:none}.webix_gantt_group.webix_gantt_project{cursor:default}.webix_gantt_group.webix_gantt_project .webix_gantt_link{display:none}.webix_gantt_touch_bars .webix_gantt_task .webix_gantt_content{padding:0 32px}.webix_gantt_touch_bars .webix_gantt_task::before,.webix_gantt_touch_bars .webix_gantt_task::after{content:"";font-size:20px;font-family:"Webix Material Icons";position:absolute;visibility:hidden;top:50%;margin-top:-10px}.webix_gantt_touch_bars .webix_gantt_task::before{left:12px}.webix_gantt_touch_bars .webix_gantt_task::after{right:12px}.webix_gantt_touch_bars .webix_gantt_task_base .webix_gantt_progress_drag{visibility:hidden}.webix_gantt_touch_bars .webix_gantt_mode_start::before,.webix_gantt_touch_bars .webix_gantt_mode_end::after,.webix_gantt_touch_bars .webix_gantt_task:hover::before,.webix_gantt_touch_bars .webix_gantt_task:hover::after{visibility:visible}.webix_gantt_task_base.webix_gantt_last::after{content:"";display:block;height:7px}.webix_gantt_task_base.webix_gantt_last .webix_gantt_progress_drag{transform:rotate(180deg);top:unset;bottom:100%;margin-bottom:-19px}.webix_gantt_task_base.webix_gantt_last .webix_gantt_progress_percent{transform:rotate(180deg);top:8.5px;border-radius:4px 4px 2px 2px;border:1px solid #dadee0;border-bottom:0}.webix_gantt_bars,.webix_gantt_touch_bars,.webix_gantt_links,.webix_gantt_holidays{background:transparent}.webix_gantt_bars,.webix_gantt_touch_bars{border-color:#fff}.webix_gantt_links .webix_template{position:relative;padding:0}.webix_gantt_links polyline{stroke:orange;fill:transparent;stroke-width:2}.webix_gantt_temp_line{pointer-events:none;position:absolute;z-index:1;top:0;left:0}.webix_gantt_bar_selection{background-color:rgba(195,200,222,0.2);position:absolute;top:-100px;pointer-events:none}.webix_gantt_markers{pointer-events:none;position:absolute}.webix_gantt_marker{position:absolute;left:-100px;top:0;width:2px;height:inherit;margin-left:-1px;background-color:#1ca1c1;opacity:.6}.webix_gantt_marker_text{display:inline-block;padding:4px 8px;line-height:16px;white-space:nowrap;border-bottom-right-radius:4px;background-color:inherit;color:#fff}.webix_gantt_marker.webix_gantt_today_marker{background-color:#ff5c4c}.webix_gantt_holidays .webix_template{position:relative;padding:0}.webix_gantt_bar_holidays,.webix_gantt_bar_resource_holidays{position:absolute;pointer-events:none}.webix_gantt_holiday{position:absolute;background-color:rgba(97,120,151,0.12)}.webix_gantt_bar_resource_holidays .webix_gantt_holiday{background-color:rgba(97,120,151,0.12)}.webix_gantt_bar_resource_holidays .webix_gantt_work_day{position:absolute;background-color:#fff}.webix_gantt_bar_holidays .webix_gantt_holiday{top:0;height:inherit}.webix_gantt_scale_cell.webix_gantt_holiday_scale{background-color:rgba(97,120,151,0.12)}.webix_gantt_critical.webix_gantt_task{background:#ff5c4c}.webix_gantt_critical.webix_gantt_task .webix_gantt_progress{background:#ff3723}.webix_gantt_critical.webix_gantt_milestone{background-color:transparent}.webix_gantt_critical.webix_gantt_milestone .webix_gantt_content{background:#ff5c4c}.webix_gantt_critical.webix_gantt_project{background-color:#f50}.webix_gantt_critical.webix_gantt_project .webix_gantt_progress{background-color:#d64700}.webix_gantt_links polyline.webix_gantt_line_critical{stroke:#ff5c4c}.webix_gantt_split_selection{position:absolute;z-index:2;background-color:rgba(107,168,203,0.2);border:1px solid #6ba8cb;border-radius:2px}.webix_gantt_split_task .webix_tree_close{visibility:hidden}.webix_gantt_split_container{position:absolute;pointer-events:none;background-image:linear-gradient(to right,#1ca1c1 50%,rgba(255,255,255,0) 0);background-position:bottom;background-size:14px 2px;background-repeat:repeat-x}.webix_gantt_baseline_task,.webix_gantt_baseline_project{position:absolute;height:5px;border-radius:2px}.webix_gantt_baseline_task{background-color:rgba(24,80,111,0.75)}.webix_gantt_baseline_project{background-color:rgba(7,80,73,0.8)}.webix_gantt_task_info ul{margin:0;padding:5px 0 0 15px}.webix_gantt_task_info .webix_template{overflow:auto;padding:0 0 0 2px;line-height:20px}ul.webix_gantt_info_list_resources{padding:5px 0 0}.webix_gantt_info_resource{display:flex;align-items:stretch;padding:0 0 1px;line-height:normal}.webix_gantt_info_list_text_row{display:flex;align-items:baseline;padding-top:4px}.webix_gantt_info_list_text{min-width:130px;margin-left:8px;margin-right:8px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.webix_gantt_info_list_text.webix_gantt_resource_section{padding-left:0}.webix_gantt_task_title{color:#313131;font-weight:500;font-size:16px}.webix_gantt_task_text{line-height:20px}.webix_gantt_info_list_planned{padding-top:5px}.webix_gantt_form_tree .webix_gantt_title .webix_cell{padding-left:8px}.webix_gantt_form_tree .webix_gantt_action .wxi-trash{margin-left:-10px;height:20px;font-size:18px}.webix_gantt_form_tree .webix_cell{border-bottom-color:transparent}.webix_gantt_form_tree .webix_gantt_type .webix_cell,.webix_gantt_form_tree .webix_gantt_value .webix_cell{padding-right:4px;text-align:right}.webix_gantt_form_tree .webix_dt_editor input{text-align:right}.webix_gantt_form_counter .webix_inp_counter_value{width:calc(50% - 60px)}.webix_list .webix_gantt_resource_section{float:right;text-align:right}.webix_gantt_resource_section{padding-left:5px;color:#888;width:80px;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.webix_gantt_resource_table .webix_gantt_title .webix_cell.webix_gantt_select_editor{box-shadow:inset 0 0 0 1px #1ca1c1;border-radius:2px;padding-left:8px;background:#fff}.webix_gantt_select_editor_popup .webix_selected{box-shadow:none}.webix_gantt_select_editor_popup .webix_list_item,.webix_gantt_select_editor_popup .webix_list_item.webix_selected{padding:0 8px;line-height:36px}.webix_gantt_form_unit_title{padding-right:12px}.webix_gantt_table_hover[aria-level="2"],.webix_gantt_link_table_hover[aria-level="2"]{background:rgba(244,245,249,0.6)}.webix_gantt .webix_transparent .webix_button{color:#1ca1c1}.webix_gantt .webix_transparent .webix_el_box:not(.webix_disabled_box) .webix_icon_btn{color:#1ca1c1}.webix_gantt_select_editor_popup .webix_scroll_cont:empty:before{content:attr(placeholder);font-size:12px;font-style:italic;color:#888;text-align:center;display:inline-block;width:100%;line-height:28px}.webix_gantt_datepicker .webix_cal_icon_clear{display:none}.webix_gantt_tree .webix_gantt_action .webix_icon{cursor:pointer}.webix_gantt_tree .webix_gantt_action .webix_icon:hover{color:#1ca1c1}.webix_gantt_tree .webix_column.webix_gantt_action>div,.webix_gantt_tree .webix_hcell.webix_gantt_action{padding:0 11px}.webix_gantt_tree .webix_gantt_title .webix_cell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.webix_gantt_tree .webix_column>div.webix_row_select{background-color:#f4f5f9;color:#475466}.webix_gantt_tree .webix_ss_body .webix_column>div{border-right-color:transparent;border-left-color:transparent}.webix_gantt_resizer{background-color:#ebedf0}.webix_gantt_resizer.webix_resizer_x{z-index:5;position:relative;overflow:visible}.webix_gantt_resizer.webix_resizer_x:after{position:absolute;left:-4px;height:100%;content:"";width:9px}.webix_drag_zone .webix_dd_drag.webix_gantt_tree_no_icon .webix_tree_close{visibility:hidden}@font-face{font-family:"gantt-webfont";src:url("fonts/gantt-webfont.woff2") format("woff2"),url("fonts/gantt-webfont.woff") format("woff");font-weight:normal;font-style:normal}[class^=gti-]:before,[class*=gti-]:before{font-family:"gantt-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.gti-menu:before{content:""}.webix_gantt_accordion .webix_accordionitem{border-color:transparent}.webix_gantt_accordion .webix_accordionitem_header{border-color:transparent;font-size:inherit}.webix_gantt_accordion .webix_accordionitem_header .webix_accordionitem_button{color:#94a1b3}.webix_gantt_accordion .webix_accordionitem.collapsed .webix_accordionitem_header .webix_accordionitem_button{color:#94a1b3}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header.collapsed .webix_accordionitem_button:before{content:""}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header .webix_accordionitem_button{margin:0 6px 0 1px}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header .webix_accordionitem_button:before{content:""}.webix_gantt_accordion .webix_accordionitem.collapsed .webix_accordionitem_header:hover,.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header:hover{background-color:rgba(195,200,222,0.2)}.webix_gantt_accordion .webix_accordionitem_label{color:#313131}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header{background-color:#f4f5f9}.webix_gantt_person_avatar,.webix_gantt_cell_remain_num{vertical-align:middle;margin:4px 4px 4px 0;height:24px;line-height:24px;flex-shrink:0;width:24px;font-size:12px;border-radius:50%;display:inline-block;text-align:center;color:rgba(255,255,255,0.9)}.webix_gantt_person_avatar_big{height:32px;line-height:32px;width:32px;font-size:14px}.webix_gantt_person_avatar_0{background:#00a037}.webix_gantt_person_avatar_1{background:#13a1aa}.webix_gantt_person_avatar_2{background:#fd772c}.webix_gantt_person_avatar_3{background:#b26bd3}.webix_gantt_person_avatar_4{background:#c87095}.webix_gantt_person_avatar_5{background:#eb2f89}.webix_gantt_person_avatar_6{background:#9bb402}.webix_gantt_person_avatar_7{background:#e7a90b}.webix_gantt_person_avatar_8{background:#0bbed7}.webix_gantt_person_avatar_9{background:#038cd9}.webix_gantt_tree_column_resources .webix_cell{padding:0 8px}.webix_gantt_cell_assigned_text{font-size:12px}.webix_gantt_cell_assigned_last{width:24px;display:inline-block}.webix_gantt_cell_remain_num{position:relative;left:-28px;z-index:1;background:rgba(0,0,0,0.5)}.webix_gantt_avatar_box{height:100%;display:flex;align-items:center}.webix_gantt_avatar_box .webix_icon{flex-basis:20px}.webix_gantt_avatar_box_inline{display:inline-flex;align-items:center}.webix_gantt_avatar_option_box{display:flex;align-items:center;justify-content:space-between}.webix_gantt_editor_avatar_name{max-width:170px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding-left:2px}.webix_popup .webix_gantt_editor_avatar_name{max-width:190px}.webix_gantt_absbutton{border-radius:50%;z-index:91}.webix_gantt_absbutton .webix_el_box{background-color:#1ca1c1}.webix_gantt_absbutton .webix_el_box .webix_icon_button:hover:before{background-color:#1992af}.webix_gantt_absbutton .webix_el_box .webix_icon{color:#fff}.webix_gantt_resdiagram_tree .webix_tree_none,.webix_gantt_resdiagram_tree .webix_tree_folder_open{cursor:default}.webix_gantt_resdiagram_tree .webix_cell{text-overflow:ellipsis}.webix_gantt_resdiagram_tree .webix_ss_body .webix_column>div{border-right-color:transparent;border-left-color:transparent}.webix_gantt_resdiagram_chart.webix_tree .webix_scroll_cont>.webix_tree_leaves{padding:0}.webix_gantt_resdiagram_chart.webix_tree .webix_scroll_cont>.webix_tree_leaves:last-child::after{content:"";display:block;height:2px}.webix_gantt_diagram_marker{display:inline-block;position:absolute;color:#fff;text-align:center;background-color:#55cd97;border-radius:32px;width:32px;height:32px;line-height:32px}.webix_gantt_diagram_marker.webix_gantt_overload{background-color:#ff5c4c}.webix_gantt_diagram_line.webix_tree_item{padding:4px}.webix_gantt .webix_progress_top{z-index:10000}.webix_gantt_scale{border-bottom-color:#5ccce7}.webix_gantt_danger .webix_button{color:#ff5c4c;background-color:#fff1ef}.webix_gantt_danger .webix_button:hover,.webix_gantt_danger .webix_button:focus{background-color:#ffe7e5}.webix_gantt_danger .webix_button:active{background-color:#ffdedb}',"",{version:3,sources:["webpack://./js/webix/components/gantt/gantt.min.css"],names:[],mappings:"AAAA,gBAAgB,CAAC,+DAA+D,gBAAgB,CAAC,cAAc,CAAC,kBAAkB,OAAO,CAAC,UAAU,CAAC,WAAW,CAAC,yCAAyC,OAAO,CAAC,+DAA+D,UAAU,CAAC,gEAAgE,WAAW,CAAC,mCAAmC,SAAS,CAAC,uBAAuB,YAAY,CAAC,qBAAqB,CAAC,wCAAwC,+BAA+B,CAAC,wBAAwB,YAAY,CAAC,aAAa,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,8BAA8B,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,mBAAmB,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,uBAAuB,iBAAiB,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,UAAU,CAAC,cAAc,CAAC,qBAAqB,wBAAwB,CAAC,kBAAkB,wBAAwB,CAAC,mDAAmD,SAAS,CAAC,kEAAkE,CAAC,uBAAuB,4BAA4B,CAAC,0EAA0E,mBAAmB,CAAC,uCAAuC,kEAAkE,CAAC,6DAA6D,eAAe,CAAC,kFAAkF,kEAAkE,CAAC,sBAAsB,WAAW,CAAC,wBAAwB,CAAC,yBAAyB,CAAC,2CAA2C,wBAAwB,CAAC,4CAA4C,uBAAuB,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,kBAAkB,CAAC,iDAAiD,iBAAiB,CAAC,oGAAoG,kEAAkE,CAAC,2BAA2B,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,CAAC,QAAQ,CAAC,6BAA6B,CAAC,gCAAgC,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,8GAA8G,kBAAkB,CAAC,mCAAmC,UAAU,CAAC,iBAAiB,CAAC,4BAA4B,CAAC,4BAA4B,CAAC,QAAQ,CAAC,SAAS,CAAC,8BAA8B,iBAAiB,CAAC,UAAU,CAAC,OAAO,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,UAAU,CAAC,wBAAwB,CAAC,YAAY,CAAC,6BAA6B,CAAC,qBAAqB,CAAC,eAAe,CAAC,aAAa,CAAC,iBAAiB,CAAC,cAAc,CAAC,qBAAqB,iBAAiB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC,eAAe,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,cAAc,CAAC,kBAAkB,iBAAiB,CAAC,SAAS,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,cAAc,CAAC,gBAAgB,CAAC,SAAS,CAAC,sLAAsL,eAAe,CAAC,uCAAuC,uBAAuB,CAAC,4CAA4C,0BAA0B,CAAC,sEAAsE,iBAAiB,CAAC,4CAA4C,SAAS,CAAC,uBAAuB,SAAS,CAAC,wBAAwB,UAAU,CAAC,uEAAuE,SAAS,CAAC,+DAA+D,YAAY,CAAC,uCAAuC,cAAc,CAAC,yDAAyD,YAAY,CAAC,+DAA+D,cAAc,CAAC,mGAAmG,WAAW,CAAC,cAAc,CAAC,kCAAkC,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,OAAO,CAAC,gBAAgB,CAAC,kDAAkD,SAAS,CAAC,iDAAiD,UAAU,CAAC,0EAA0E,iBAAiB,CAAC,4NAA4N,kBAAkB,CAAC,+CAA+C,UAAU,CAAC,aAAa,CAAC,UAAU,CAAC,mEAAmE,wBAAwB,CAAC,SAAS,CAAC,WAAW,CAAC,mBAAmB,CAAC,sEAAsE,wBAAwB,CAAC,SAAS,CAAC,6BAA6B,CAAC,wBAAwB,CAAC,eAAe,CAAC,mFAAmF,sBAAsB,CAAC,0CAA0C,iBAAiB,CAAC,mCAAmC,iBAAiB,CAAC,SAAS,CAAC,4BAA4B,aAAa,CAAC,gBAAgB,CAAC,cAAc,CAAC,uBAAuB,mBAAmB,CAAC,iBAAiB,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,2BAA2B,sCAAsC,CAAC,iBAAiB,CAAC,UAAU,CAAC,mBAAmB,CAAC,qBAAqB,mBAAmB,CAAC,iBAAiB,CAAC,oBAAoB,iBAAiB,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,cAAc,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,UAAU,CAAC,yBAAyB,oBAAoB,CAAC,eAAe,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,8BAA8B,CAAC,wBAAwB,CAAC,UAAU,CAAC,6CAA6C,wBAAwB,CAAC,sCAAsC,iBAAiB,CAAC,SAAS,CAAC,6DAA6D,iBAAiB,CAAC,mBAAmB,CAAC,qBAAqB,iBAAiB,CAAC,sCAAsC,CAAC,wDAAwD,sCAAsC,CAAC,yDAAyD,iBAAiB,CAAC,qBAAqB,CAAC,+CAA+C,KAAK,CAAC,cAAc,CAAC,kDAAkD,sCAAsC,CAAC,uCAAuC,kBAAkB,CAAC,6DAA6D,kBAAkB,CAAC,4CAA4C,4BAA4B,CAAC,iEAAiE,kBAAkB,CAAC,0CAA0C,qBAAqB,CAAC,gEAAgE,wBAAwB,CAAC,sDAAsD,cAAc,CAAC,6BAA6B,iBAAiB,CAAC,SAAS,CAAC,sCAAsC,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,0CAA0C,iBAAiB,CAAC,6BAA6B,iBAAiB,CAAC,mBAAmB,CAAC,4EAA4E,CAAC,0BAA0B,CAAC,wBAAwB,CAAC,0BAA0B,CAAC,yDAAyD,iBAAiB,CAAC,UAAU,CAAC,iBAAiB,CAAC,2BAA2B,qCAAqC,CAAC,8BAA8B,kCAAkC,CAAC,0BAA0B,QAAQ,CAAC,oBAAoB,CAAC,uCAAuC,aAAa,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,mCAAmC,eAAe,CAAC,2BAA2B,YAAY,CAAC,mBAAmB,CAAC,eAAe,CAAC,kBAAkB,CAAC,gCAAgC,YAAY,CAAC,oBAAoB,CAAC,eAAe,CAAC,4BAA4B,eAAe,CAAC,eAAe,CAAC,gBAAgB,CAAC,eAAe,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,yDAAyD,cAAc,CAAC,wBAAwB,aAAa,CAAC,eAAe,CAAC,cAAc,CAAC,uBAAuB,gBAAgB,CAAC,+BAA+B,eAAe,CAAC,sDAAsD,gBAAgB,CAAC,sDAAsD,iBAAiB,CAAC,WAAW,CAAC,cAAc,CAAC,mCAAmC,+BAA+B,CAAC,2GAA2G,iBAAiB,CAAC,gBAAgB,CAAC,8CAA8C,gBAAgB,CAAC,mDAAmD,sBAAsB,CAAC,0CAA0C,WAAW,CAAC,gBAAgB,CAAC,8BAA8B,gBAAgB,CAAC,UAAU,CAAC,UAAU,CAAC,cAAc,CAAC,kBAAkB,CAAC,eAAe,CAAC,sBAAsB,CAAC,qFAAqF,kCAAkC,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,eAAe,CAAC,iDAAiD,eAAe,CAAC,mHAAmH,aAAa,CAAC,gBAAgB,CAAC,6BAA6B,kBAAkB,CAAC,uFAAuF,gCAAgC,CAAC,8CAA8C,aAAa,CAAC,uFAAuF,aAAa,CAAC,iEAAiE,yBAAyB,CAAC,cAAc,CAAC,iBAAiB,CAAC,UAAU,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,UAAU,CAAC,gBAAgB,CAAC,8CAA8C,YAAY,CAAC,kDAAkD,cAAc,CAAC,wDAAwD,aAAa,CAAC,yGAAyG,cAAc,CAAC,iDAAiD,eAAe,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,qDAAqD,wBAAwB,CAAC,aAAa,CAAC,mDAAmD,8BAA8B,CAAC,6BAA6B,CAAC,qBAAqB,wBAAwB,CAAC,qCAAqC,SAAS,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,2CAA2C,iBAAiB,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,2EAA2E,iBAAiB,CAAC,WAAW,2BAA2B,CAAC,mGAAmG,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,0CAA0C,2BAA2B,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,aAAa,CAAC,kCAAkC,CAAC,iCAAiC,CAAC,wBAAwB,CAAC,iBAAiB,WAAW,CAAC,4CAA4C,wBAAwB,CAAC,mDAAmD,wBAAwB,CAAC,iBAAiB,CAAC,+EAA+E,aAAa,CAAC,8GAA8G,aAAa,CAAC,qHAAqH,WAAW,CAAC,oGAAoG,kBAAkB,CAAC,2GAA2G,WAAW,CAAC,sKAAsK,sCAAsC,CAAC,kDAAkD,aAAa,CAAC,wEAAwE,wBAAwB,CAAC,wDAAwD,qBAAqB,CAAC,oBAAoB,CAAC,WAAW,CAAC,gBAAgB,CAAC,aAAa,CAAC,UAAU,CAAC,cAAc,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,2BAA2B,CAAC,+BAA+B,WAAW,CAAC,gBAAgB,CAAC,UAAU,CAAC,cAAc,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,6BAA6B,kBAAkB,CAAC,+CAA+C,aAAa,CAAC,gCAAgC,cAAc,CAAC,gCAAgC,UAAU,CAAC,oBAAoB,CAAC,6BAA6B,iBAAiB,CAAC,UAAU,CAAC,SAAS,CAAC,0BAA0B,CAAC,wBAAwB,WAAW,CAAC,YAAY,CAAC,kBAAkB,CAAC,oCAAoC,eAAe,CAAC,+BAA+B,mBAAmB,CAAC,kBAAkB,CAAC,+BAA+B,YAAY,CAAC,kBAAkB,CAAC,6BAA6B,CAAC,gCAAgC,eAAe,CAAC,eAAe,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,6CAA6C,eAAe,CAAC,uBAAuB,iBAAiB,CAAC,UAAU,CAAC,qCAAqC,wBAAwB,CAAC,qEAAqE,wBAAwB,CAAC,iDAAiD,UAAU,CAAC,mGAAmG,cAAc,CAAC,yCAAyC,sBAAsB,CAAC,8DAA8D,8BAA8B,CAAC,6BAA6B,CAAC,+EAA+E,SAAS,CAAC,iGAAiG,UAAU,CAAC,aAAa,CAAC,UAAU,CAAC,4BAA4B,oBAAoB,CAAC,iBAAiB,CAAC,UAAU,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,kBAAkB,CAAC,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,iDAAiD,wBAAwB,CAAC,0CAA0C,WAAW,CAAC,iCAAiC,aAAa,CAAC,mBAAmB,2BAA2B,CAAC,kCAAkC,aAAa,CAAC,wBAAwB,CAAC,gFAAgF,wBAAwB,CAAC,yCAAyC,wBAAwB",sourcesContent:['@charset "UTF-8";.webix_gantt_tree .wxi-plus,.webix_gantt_tree .wxi-plus-circle{line-height:42px;font-size:22px}.webix_gantt_link{top:6px;width:16px;height:16px}.webix_gantt_milestone .webix_gantt_link{top:2px}.webix_gantt_milestone .webix_gantt_link_left.webix_gantt_link{left:-24px}.webix_gantt_milestone .webix_gantt_link_right.webix_gantt_link{right:-24px}.webix_gantt_scale .webix_template{padding:0}.webix_gantt_scale_row{display:flex;box-sizing:border-box}.webix_gantt_scale_row:not(:last-child){border-bottom:1px solid #dadee0}.webix_gantt_scale_cell{display:flex;flex:0 0 auto;justify-content:center;align-items:center;border-right:1px solid #dadee0;box-sizing:border-box;background-color:#f4f5f9}.webix_gantt_layer{position:absolute;top:0;left:0;width:100%;height:100%}.webix_gantt_task_base{position:absolute;box-sizing:border-box;border-radius:2px;color:#fff;cursor:pointer}.webix_gantt_project{background-color:#38aea2}.webix_gantt_task{background-color:#6ba8cb}.webix_gantt_project:hover,.webix_gantt_task:hover{z-index:3;box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_milestone{background-color:transparent}.webix_gantt_in_action .webix_gantt_task_base,.webix_gantt_task_in_action{pointer-events:none}.webix_drag_zone.webix_gantt_task_base{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_drag_zone.webix_gantt_task_base.webix_gantt_milestone{box-shadow:none}.webix_drag_zone.webix_gantt_task_base.webix_gantt_milestone .webix_gantt_content{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_progress{height:100%;background-color:#4d96c0;border-radius:2px 0 0 2px}.webix_gantt_project .webix_gantt_progress{background-color:#2e8f85}.webix_gantt_milestone .webix_gantt_content{transform:rotate(45deg);background-color:#cf89d5;border-radius:inherit;padding:0;width:100%;text-overflow:clip}.webix_gantt_milestone .webix_gantt_content span{visibility:hidden}.webix_gantt_milestone:hover .webix_gantt_content,.webix_gantt_milestone .webix_gantt_content:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_gantt_progress_drag{position:absolute;z-index:1;cursor:ew-resize;top:100%;border:10px solid transparent;border-bottom:10px solid #dadee0;margin-top:-19px;margin-left:-10px;visibility:hidden}.webix_gantt_task_base:hover .webix_gantt_progress_drag,.webix_gantt_mode_progress .webix_gantt_progress_drag{visibility:visible}.webix_gantt_progress_drag::before{content:"";position:absolute;border:8px solid transparent;border-bottom:8px solid #fff;top:-7px;left:-8px}.webix_gantt_progress_percent{position:absolute;left:-10px;top:9px;display:inline-block;line-height:14px;width:20px;border:1px solid #dadee0;border-top:0;border-radius:2px 2px 4px 4px;box-sizing:border-box;background:#fff;color:#1ca1c1;text-align:center;font-size:10px}.webix_gantt_content{text-align:center;line-height:30px;position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;user-select:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 12px}.webix_gantt_link{position:absolute;z-index:2;border-radius:50%;border:1px solid #dadee0;background-color:#fff;cursor:pointer;user-select:none;opacity:0}.webix_gantt_link_visible .webix_gantt_content:hover,.webix_gantt_task_base.webix_gantt_link_visible:hover,.webix_gantt_task_base.webix_gantt_link_visible:hover .webix_gantt_content{box-shadow:none}.webix_gantt_task,.webix_gantt_project{box-shadow:#fff 1px 0 0}.webix_gantt_milestone .webix_gantt_content{box-shadow:#fff 1px -1px 0}.webix_gantt_task.webix_gantt_link_visible .webix_gantt_progress_drag{visibility:hidden}.webix_gantt_link_visible .webix_gantt_link{opacity:1}.webix_gantt_link_left{left:-9px}.webix_gantt_link_right{right:-9px}.webix_gantt_task_base:hover .webix_gantt_link,.webix_gantt_link:hover{opacity:1}.webix_gantt_readonly .webix_gantt_task_base .webix_gantt_link{display:none}.webix_gantt_group.webix_gantt_project{cursor:default}.webix_gantt_group.webix_gantt_project .webix_gantt_link{display:none}.webix_gantt_touch_bars .webix_gantt_task .webix_gantt_content{padding:0 32px}.webix_gantt_touch_bars .webix_gantt_task::before,.webix_gantt_touch_bars .webix_gantt_task::after{content:"";font-size:20px;font-family:"Webix Material Icons";position:absolute;visibility:hidden;top:50%;margin-top:-10px}.webix_gantt_touch_bars .webix_gantt_task::before{left:12px}.webix_gantt_touch_bars .webix_gantt_task::after{right:12px}.webix_gantt_touch_bars .webix_gantt_task_base .webix_gantt_progress_drag{visibility:hidden}.webix_gantt_touch_bars .webix_gantt_mode_start::before,.webix_gantt_touch_bars .webix_gantt_mode_end::after,.webix_gantt_touch_bars .webix_gantt_task:hover::before,.webix_gantt_touch_bars .webix_gantt_task:hover::after{visibility:visible}.webix_gantt_task_base.webix_gantt_last::after{content:"";display:block;height:7px}.webix_gantt_task_base.webix_gantt_last .webix_gantt_progress_drag{transform:rotate(180deg);top:unset;bottom:100%;margin-bottom:-19px}.webix_gantt_task_base.webix_gantt_last .webix_gantt_progress_percent{transform:rotate(180deg);top:8.5px;border-radius:4px 4px 2px 2px;border:1px solid #dadee0;border-bottom:0}.webix_gantt_bars,.webix_gantt_touch_bars,.webix_gantt_links,.webix_gantt_holidays{background:transparent}.webix_gantt_bars,.webix_gantt_touch_bars{border-color:#fff}.webix_gantt_links .webix_template{position:relative;padding:0}.webix_gantt_links polyline{stroke:orange;fill:transparent;stroke-width:2}.webix_gantt_temp_line{pointer-events:none;position:absolute;z-index:1;top:0;left:0}.webix_gantt_bar_selection{background-color:rgba(195,200,222,0.2);position:absolute;top:-100px;pointer-events:none}.webix_gantt_markers{pointer-events:none;position:absolute}.webix_gantt_marker{position:absolute;left:-100px;top:0;width:2px;height:inherit;margin-left:-1px;background-color:#1ca1c1;opacity:.6}.webix_gantt_marker_text{display:inline-block;padding:4px 8px;line-height:16px;white-space:nowrap;border-bottom-right-radius:4px;background-color:inherit;color:#fff}.webix_gantt_marker.webix_gantt_today_marker{background-color:#ff5c4c}.webix_gantt_holidays .webix_template{position:relative;padding:0}.webix_gantt_bar_holidays,.webix_gantt_bar_resource_holidays{position:absolute;pointer-events:none}.webix_gantt_holiday{position:absolute;background-color:rgba(97,120,151,0.12)}.webix_gantt_bar_resource_holidays .webix_gantt_holiday{background-color:rgba(97,120,151,0.12)}.webix_gantt_bar_resource_holidays .webix_gantt_work_day{position:absolute;background-color:#fff}.webix_gantt_bar_holidays .webix_gantt_holiday{top:0;height:inherit}.webix_gantt_scale_cell.webix_gantt_holiday_scale{background-color:rgba(97,120,151,0.12)}.webix_gantt_critical.webix_gantt_task{background:#ff5c4c}.webix_gantt_critical.webix_gantt_task .webix_gantt_progress{background:#ff3723}.webix_gantt_critical.webix_gantt_milestone{background-color:transparent}.webix_gantt_critical.webix_gantt_milestone .webix_gantt_content{background:#ff5c4c}.webix_gantt_critical.webix_gantt_project{background-color:#f50}.webix_gantt_critical.webix_gantt_project .webix_gantt_progress{background-color:#d64700}.webix_gantt_links polyline.webix_gantt_line_critical{stroke:#ff5c4c}.webix_gantt_split_selection{position:absolute;z-index:2;background-color:rgba(107,168,203,0.2);border:1px solid #6ba8cb;border-radius:2px}.webix_gantt_split_task .webix_tree_close{visibility:hidden}.webix_gantt_split_container{position:absolute;pointer-events:none;background-image:linear-gradient(to right,#1ca1c1 50%,rgba(255,255,255,0) 0);background-position:bottom;background-size:14px 2px;background-repeat:repeat-x}.webix_gantt_baseline_task,.webix_gantt_baseline_project{position:absolute;height:5px;border-radius:2px}.webix_gantt_baseline_task{background-color:rgba(24,80,111,0.75)}.webix_gantt_baseline_project{background-color:rgba(7,80,73,0.8)}.webix_gantt_task_info ul{margin:0;padding:5px 0 0 15px}.webix_gantt_task_info .webix_template{overflow:auto;padding:0 0 0 2px;line-height:20px}ul.webix_gantt_info_list_resources{padding:5px 0 0}.webix_gantt_info_resource{display:flex;align-items:stretch;padding:0 0 1px;line-height:normal}.webix_gantt_info_list_text_row{display:flex;align-items:baseline;padding-top:4px}.webix_gantt_info_list_text{min-width:130px;margin-left:8px;margin-right:8px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.webix_gantt_info_list_text.webix_gantt_resource_section{padding-left:0}.webix_gantt_task_title{color:#313131;font-weight:500;font-size:16px}.webix_gantt_task_text{line-height:20px}.webix_gantt_info_list_planned{padding-top:5px}.webix_gantt_form_tree .webix_gantt_title .webix_cell{padding-left:8px}.webix_gantt_form_tree .webix_gantt_action .wxi-trash{margin-left:-10px;height:20px;font-size:18px}.webix_gantt_form_tree .webix_cell{border-bottom-color:transparent}.webix_gantt_form_tree .webix_gantt_type .webix_cell,.webix_gantt_form_tree .webix_gantt_value .webix_cell{padding-right:4px;text-align:right}.webix_gantt_form_tree .webix_dt_editor input{text-align:right}.webix_gantt_form_counter .webix_inp_counter_value{width:calc(50% - 60px)}.webix_list .webix_gantt_resource_section{float:right;text-align:right}.webix_gantt_resource_section{padding-left:5px;color:#888;width:80px;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.webix_gantt_resource_table .webix_gantt_title .webix_cell.webix_gantt_select_editor{box-shadow:inset 0 0 0 1px #1ca1c1;border-radius:2px;padding-left:8px;background:#fff}.webix_gantt_select_editor_popup .webix_selected{box-shadow:none}.webix_gantt_select_editor_popup .webix_list_item,.webix_gantt_select_editor_popup .webix_list_item.webix_selected{padding:0 8px;line-height:36px}.webix_gantt_form_unit_title{padding-right:12px}.webix_gantt_table_hover[aria-level="2"],.webix_gantt_link_table_hover[aria-level="2"]{background:rgba(244,245,249,0.6)}.webix_gantt .webix_transparent .webix_button{color:#1ca1c1}.webix_gantt .webix_transparent .webix_el_box:not(.webix_disabled_box) .webix_icon_btn{color:#1ca1c1}.webix_gantt_select_editor_popup .webix_scroll_cont:empty:before{content:attr(placeholder);font-size:12px;font-style:italic;color:#888;text-align:center;display:inline-block;width:100%;line-height:28px}.webix_gantt_datepicker .webix_cal_icon_clear{display:none}.webix_gantt_tree .webix_gantt_action .webix_icon{cursor:pointer}.webix_gantt_tree .webix_gantt_action .webix_icon:hover{color:#1ca1c1}.webix_gantt_tree .webix_column.webix_gantt_action>div,.webix_gantt_tree .webix_hcell.webix_gantt_action{padding:0 11px}.webix_gantt_tree .webix_gantt_title .webix_cell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.webix_gantt_tree .webix_column>div.webix_row_select{background-color:#f4f5f9;color:#475466}.webix_gantt_tree .webix_ss_body .webix_column>div{border-right-color:transparent;border-left-color:transparent}.webix_gantt_resizer{background-color:#ebedf0}.webix_gantt_resizer.webix_resizer_x{z-index:5;position:relative;overflow:visible}.webix_gantt_resizer.webix_resizer_x:after{position:absolute;left:-4px;height:100%;content:"";width:9px}.webix_drag_zone .webix_dd_drag.webix_gantt_tree_no_icon .webix_tree_close{visibility:hidden}@font-face{font-family:"gantt-webfont";src:url("fonts/gantt-webfont.woff2") format("woff2"),url("fonts/gantt-webfont.woff") format("woff");font-weight:normal;font-style:normal}[class^=gti-]:before,[class*=gti-]:before{font-family:"gantt-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.gti-menu:before{content:""}.webix_gantt_accordion .webix_accordionitem{border-color:transparent}.webix_gantt_accordion .webix_accordionitem_header{border-color:transparent;font-size:inherit}.webix_gantt_accordion .webix_accordionitem_header .webix_accordionitem_button{color:#94a1b3}.webix_gantt_accordion .webix_accordionitem.collapsed .webix_accordionitem_header .webix_accordionitem_button{color:#94a1b3}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header.collapsed .webix_accordionitem_button:before{content:""}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header .webix_accordionitem_button{margin:0 6px 0 1px}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header .webix_accordionitem_button:before{content:""}.webix_gantt_accordion .webix_accordionitem.collapsed .webix_accordionitem_header:hover,.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header:hover{background-color:rgba(195,200,222,0.2)}.webix_gantt_accordion .webix_accordionitem_label{color:#313131}.webix_gantt_accordion .webix_accordionitem .webix_accordionitem_header{background-color:#f4f5f9}.webix_gantt_person_avatar,.webix_gantt_cell_remain_num{vertical-align:middle;margin:4px 4px 4px 0;height:24px;line-height:24px;flex-shrink:0;width:24px;font-size:12px;border-radius:50%;display:inline-block;text-align:center;color:rgba(255,255,255,0.9)}.webix_gantt_person_avatar_big{height:32px;line-height:32px;width:32px;font-size:14px}.webix_gantt_person_avatar_0{background:#00a037}.webix_gantt_person_avatar_1{background:#13a1aa}.webix_gantt_person_avatar_2{background:#fd772c}.webix_gantt_person_avatar_3{background:#b26bd3}.webix_gantt_person_avatar_4{background:#c87095}.webix_gantt_person_avatar_5{background:#eb2f89}.webix_gantt_person_avatar_6{background:#9bb402}.webix_gantt_person_avatar_7{background:#e7a90b}.webix_gantt_person_avatar_8{background:#0bbed7}.webix_gantt_person_avatar_9{background:#038cd9}.webix_gantt_tree_column_resources .webix_cell{padding:0 8px}.webix_gantt_cell_assigned_text{font-size:12px}.webix_gantt_cell_assigned_last{width:24px;display:inline-block}.webix_gantt_cell_remain_num{position:relative;left:-28px;z-index:1;background:rgba(0,0,0,0.5)}.webix_gantt_avatar_box{height:100%;display:flex;align-items:center}.webix_gantt_avatar_box .webix_icon{flex-basis:20px}.webix_gantt_avatar_box_inline{display:inline-flex;align-items:center}.webix_gantt_avatar_option_box{display:flex;align-items:center;justify-content:space-between}.webix_gantt_editor_avatar_name{max-width:170px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding-left:2px}.webix_popup .webix_gantt_editor_avatar_name{max-width:190px}.webix_gantt_absbutton{border-radius:50%;z-index:91}.webix_gantt_absbutton .webix_el_box{background-color:#1ca1c1}.webix_gantt_absbutton .webix_el_box .webix_icon_button:hover:before{background-color:#1992af}.webix_gantt_absbutton .webix_el_box .webix_icon{color:#fff}.webix_gantt_resdiagram_tree .webix_tree_none,.webix_gantt_resdiagram_tree .webix_tree_folder_open{cursor:default}.webix_gantt_resdiagram_tree .webix_cell{text-overflow:ellipsis}.webix_gantt_resdiagram_tree .webix_ss_body .webix_column>div{border-right-color:transparent;border-left-color:transparent}.webix_gantt_resdiagram_chart.webix_tree .webix_scroll_cont>.webix_tree_leaves{padding:0}.webix_gantt_resdiagram_chart.webix_tree .webix_scroll_cont>.webix_tree_leaves:last-child::after{content:"";display:block;height:2px}.webix_gantt_diagram_marker{display:inline-block;position:absolute;color:#fff;text-align:center;background-color:#55cd97;border-radius:32px;width:32px;height:32px;line-height:32px}.webix_gantt_diagram_marker.webix_gantt_overload{background-color:#ff5c4c}.webix_gantt_diagram_line.webix_tree_item{padding:4px}.webix_gantt .webix_progress_top{z-index:10000}.webix_gantt_scale{border-bottom-color:#5ccce7}.webix_gantt_danger .webix_button{color:#ff5c4c;background-color:#fff1ef}.webix_gantt_danger .webix_button:hover,.webix_gantt_danger .webix_button:focus{background-color:#ffe7e5}.webix_gantt_danger .webix_button:active{background-color:#ffdedb}'],sourceRoot:""}]);const s=a},43008:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,".webix_hint_view.webix_hint_animated .webix_hint_overlay_hole_el {\n  fill: #000;\n  -webkit-transition: fill 0.4s ease-in;\n  -o-transition: fill 0.4s ease-in;\n  transition: fill 0.4s ease-in;\n}\n.webix_hint_view.webix_hint_animated .webix_hint {\n  opacity: 1;\n  -webkit-transition: opacity 0.4s ease-in;\n  -o-transition: opacity 0.4s ease-in;\n  transition: opacity 0.4s ease-in;\n}\n.webix_hint_overlay {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1010;\n  pointer-events: none;\n  overflow: hidden;\n  opacity: 0.6;\n}\n.webix_hint_view svg {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n}\n.webix_hint_overflow {\n  pointer-events: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  position: relative;\n  height: 100%;\n  width: 100%;\n  min-width: 100%;\n}\n.webix_hint_overflow .webix_window,\n.webix_hint_overflow .webix_popup {\n  pointer-events: all;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n.webix_hint {\n  position: fixed;\n  pointer-events: all;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n  display: block;\n  z-index: 1012;\n  width: 310px;\n  border-radius: 2px;\n  background-color: #FFFFFF;\n  padding: 22px 50px 80px 22px;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.1);\n  box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.1);\n  opacity: 0;\n}\n.webix_hint .webix_hint_label {\n  color: rgba(0, 0, 0, 0.54);\n  font-size: 16px;\n  line-height: 24px;\n  margin: -5px 0;\n}\n.webix_hint .webix_hint_title {\n  color: rgba(0, 0, 0, 0.87);\n  font-size: 20px;\n  font-weight: 500;\n  line-height: 1;\n  margin-bottom: 15px;\n}\n.webix_hint_buttons {\n  position: absolute;\n  bottom: 11px;\n  right: 22px;\n}\n.webix_hint_buttons .webix_hint_button {\n  display: inline-block;\n  pointer-events: all;\n  -webkit-box-sizing: content-box;\n  box-sizing: content-box;\n  cursor: pointer;\n  margin: 0 auto;\n  height: 32px;\n  padding: 0px 16px;\n  border: none;\n  border-radius: 2px;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 16px;\n  text-transform: uppercase;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_next {\n  margin-left: 17px;\n  background-color: #00BFC7;\n  color: #fff;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_next:hover {\n  background-color: #27D6DD;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev {\n  color: #0097A7;\n  background-color: #fff;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev:hover {\n  background-color: rgba(0, 191, 199, 0.1);\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev.webix_hint_button_hidden {\n  display: none;\n}\n.webix_hint_progress {\n  position: absolute;\n  bottom: 17px;\n  left: 22px;\n  color: rgba(0, 0, 0, 0.54);\n  font-size: 14px;\n}\n.webix_hint_button_close {\n  position: absolute;\n  right: 22px;\n  top: 20px;\n  z-index: 1012;\n  background: transparent;\n  border: none;\n  font-size: 22px;\n  color: rgba(0, 0, 0, 0.54);\n  pointer-events: all;\n  cursor: pointer;\n  padding: 0;\n  line-height: 1;\n}\n.webix_hint_button_close:hover {\n  color: rgba(0, 0, 0, 0.7);\n}\n","",{version:3,sources:["webpack://./js/webix/components/hint/hint.css"],names:[],mappings:"AAAA;EACE,UAAU;EACV,qCAAqC;EACrC,gCAAgC;EAChC,6BAA6B;AAC/B;AACA;EACE,UAAU;EACV,wCAAwC;EACxC,mCAAmC;EACnC,gCAAgC;AAClC;AACA;EACE,eAAe;EACf,WAAW;EACX,YAAY;EACZ,MAAM;EACN,OAAO;EACP,aAAa;EACb,oBAAoB;EACpB,gBAAgB;EAChB,YAAY;AACd;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,OAAO;EACP,MAAM;AACR;AACA;EACE,oBAAoB;EACpB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,eAAe;AACjB;AACA;;EAEE,mBAAmB;EACnB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;AACnB;AACA;EACE,eAAe;EACf,mBAAmB;EACnB,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,cAAc;EACd,aAAa;EACb,YAAY;EACZ,kBAAkB;EAClB,yBAAyB;EACzB,4BAA4B;EAC5B,8BAA8B;EAC9B,sBAAsB;EACtB,kFAAkF;EAClF,0EAA0E;EAC1E,UAAU;AACZ;AACA;EACE,0BAA0B;EAC1B,eAAe;EACf,iBAAiB;EACjB,cAAc;AAChB;AACA;EACE,0BAA0B;EAC1B,eAAe;EACf,gBAAgB;EAChB,cAAc;EACd,mBAAmB;AACrB;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;AACA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,+BAA+B;EAC/B,uBAAuB;EACvB,eAAe;EACf,cAAc;EACd,YAAY;EACZ,iBAAiB;EACjB,YAAY;EACZ,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;EACjB,yBAAyB;AAC3B;AACA;EACE,iBAAiB;EACjB,yBAAyB;EACzB,WAAW;AACb;AACA;EACE,yBAAyB;AAC3B;AACA;EACE,cAAc;EACd,sBAAsB;AACxB;AACA;EACE,wCAAwC;AAC1C;AACA;EACE,aAAa;AACf;AACA;EACE,kBAAkB;EAClB,YAAY;EACZ,UAAU;EACV,0BAA0B;EAC1B,eAAe;AACjB;AACA;EACE,kBAAkB;EAClB,WAAW;EACX,SAAS;EACT,aAAa;EACb,uBAAuB;EACvB,YAAY;EACZ,eAAe;EACf,0BAA0B;EAC1B,mBAAmB;EACnB,eAAe;EACf,UAAU;EACV,cAAc;AAChB;AACA;EACE,yBAAyB;AAC3B",sourcesContent:[".webix_hint_view.webix_hint_animated .webix_hint_overlay_hole_el {\n  fill: #000;\n  -webkit-transition: fill 0.4s ease-in;\n  -o-transition: fill 0.4s ease-in;\n  transition: fill 0.4s ease-in;\n}\n.webix_hint_view.webix_hint_animated .webix_hint {\n  opacity: 1;\n  -webkit-transition: opacity 0.4s ease-in;\n  -o-transition: opacity 0.4s ease-in;\n  transition: opacity 0.4s ease-in;\n}\n.webix_hint_overlay {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1010;\n  pointer-events: none;\n  overflow: hidden;\n  opacity: 0.6;\n}\n.webix_hint_view svg {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n}\n.webix_hint_overflow {\n  pointer-events: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  position: relative;\n  height: 100%;\n  width: 100%;\n  min-width: 100%;\n}\n.webix_hint_overflow .webix_window,\n.webix_hint_overflow .webix_popup {\n  pointer-events: all;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n.webix_hint {\n  position: fixed;\n  pointer-events: all;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n  display: block;\n  z-index: 1012;\n  width: 310px;\n  border-radius: 2px;\n  background-color: #FFFFFF;\n  padding: 22px 50px 80px 22px;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.1);\n  box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.1);\n  opacity: 0;\n}\n.webix_hint .webix_hint_label {\n  color: rgba(0, 0, 0, 0.54);\n  font-size: 16px;\n  line-height: 24px;\n  margin: -5px 0;\n}\n.webix_hint .webix_hint_title {\n  color: rgba(0, 0, 0, 0.87);\n  font-size: 20px;\n  font-weight: 500;\n  line-height: 1;\n  margin-bottom: 15px;\n}\n.webix_hint_buttons {\n  position: absolute;\n  bottom: 11px;\n  right: 22px;\n}\n.webix_hint_buttons .webix_hint_button {\n  display: inline-block;\n  pointer-events: all;\n  -webkit-box-sizing: content-box;\n  box-sizing: content-box;\n  cursor: pointer;\n  margin: 0 auto;\n  height: 32px;\n  padding: 0px 16px;\n  border: none;\n  border-radius: 2px;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 16px;\n  text-transform: uppercase;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_next {\n  margin-left: 17px;\n  background-color: #00BFC7;\n  color: #fff;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_next:hover {\n  background-color: #27D6DD;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev {\n  color: #0097A7;\n  background-color: #fff;\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev:hover {\n  background-color: rgba(0, 191, 199, 0.1);\n}\n.webix_hint_buttons .webix_hint_button.webix_hint_button_prev.webix_hint_button_hidden {\n  display: none;\n}\n.webix_hint_progress {\n  position: absolute;\n  bottom: 17px;\n  left: 22px;\n  color: rgba(0, 0, 0, 0.54);\n  font-size: 14px;\n}\n.webix_hint_button_close {\n  position: absolute;\n  right: 22px;\n  top: 20px;\n  z-index: 1012;\n  background: transparent;\n  border: none;\n  font-size: 22px;\n  color: rgba(0, 0, 0, 0.54);\n  pointer-events: all;\n  cursor: pointer;\n  padding: 0;\n  line-height: 1;\n}\n.webix_hint_button_close:hover {\n  color: rgba(0, 0, 0, 0.7);\n}\n"],sourceRoot:""}]);const s=a},32543:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,'.wbq-query_list .wbq-field-value,.wbq-query_bar .wbq-field-value{color:#1ca1c1}.wbq-query_list .wbq-field-name,.wbq-query_bar .wbq-field-name{font-weight:500}.wbq-query_list .action-close,.wbq-query_list .action-menu{cursor:pointer;margin-top:10px;right:4px;position:absolute}.wbq-query_bar .action-close,.wbq-query_bar .action-menu{cursor:pointer;margin:8px -10px 0 8px}.wbq-query_list .webix_scroll_cont>.webix_tree_leaves{padding:8px 0}.wbq-query_list .webix_tree_item{height:auto;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_list .webix_tree_item.active-editor{line-height:32px;padding:0;margin-left:4px;margin-right:4px;background-color:#fff}.wbq-query_list .webix_tree_item+.webix_tree_leaves{padding-top:10px;border-left:1px solid #ccd7e6;margin-left:20px;padding-left:16px}.wbq-query_list .webix_tree_item.group{margin:0}.wbq-filter_join{position:absolute;z-index:2;top:-24px;height:20px;line-height:20px;left:0;width:40px;border-radius:20px;text-align:center;display:block;cursor:pointer}.wbq-filter_join_and{color:#fff;background:#fdbf4c}.wbq-filter_join_or{color:#fff;background:#55cd97}.wbq-query_list .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-query_bar .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-field-box{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:250px}.wbq-query_bar .webix_scroll_cont>.webix_tree_leaves{padding:0;white-space:nowrap;padding:4px 0 4px 0}.wbq-query_bar .webix_tree_leaves,.wbq-query_bar .webix_tree_leaves div{display:inline-block}.wbq-query_bar .webix_tree_item{height:32px;line-height:32px;margin:0 52px 0 0;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:after{color:#a78fd5}.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:after{color:#68ccd2}.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:after{color:#999}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{content:"(";margin:0 2px 0 -4px;display:inline-block;transform:scaleX(0.75);font-size:30px;line-height:0;position:relative}.wbq-query_bar .group+.webix_tree_leaves:after{content:")";margin:0 -4px 0 2px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{border-radius:2px;margin-left:0;margin-right:52px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves .webix_tree_item{background:#fff;margin-top:0;line-height:32px}.wbq-query_bar .webix_tree_leaves>div:last-child>div{margin-right:0}.wbq-query_bar .webix_tree_leaves>.webix_tree_branch_1>.webix_tree_leaves{padding:4px;margin-top:-4px;margin-bottom:-4px}.wbq-query_bar .wbq-filter_join{top:6px;left:-44px;width:36px}.wbq-query_bar .group{padding:0;height:20px;margin-right:0;background:transparent}.webix_toolbar .wbq-query_bar{background-color:transparent}.wbq-query_list.webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{display:inline-block}.wbq-filter_join_disabled{cursor:default;pointer-events:none}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{background:#f4f5f9}.wbq-query_list .webix_tree_item{line-height:36px;margin-bottom:32px}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{top:4px}.wbq-field-box{margin-bottom:-13px}',"",{version:3,sources:["webpack://./js/webix/components/query/query.min.css"],names:[],mappings:"AAAA,iEAAiE,aAAa,CAAC,+DAA+D,eAAe,CAAC,2DAA2D,cAAc,CAAC,eAAe,CAAC,SAAS,CAAC,iBAAiB,CAAC,yDAAyD,cAAc,CAAC,sBAAsB,CAAC,sDAAsD,aAAa,CAAC,iCAAiC,WAAW,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,+CAA+C,gBAAgB,CAAC,SAAS,CAAC,eAAe,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,oDAAoD,gBAAgB,CAAC,6BAA6B,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,uCAAuC,QAAQ,CAAC,iBAAiB,iBAAiB,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,UAAU,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,aAAa,CAAC,cAAc,CAAC,qBAAqB,UAAU,CAAC,kBAAkB,CAAC,oBAAoB,UAAU,CAAC,kBAAkB,CAAC,oFAAoF,YAAY,CAAC,mFAAmF,YAAY,CAAC,eAAe,oBAAoB,CAAC,eAAe,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,eAAe,CAAC,qDAAqD,SAAS,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,wEAAwE,oBAAoB,CAAC,gCAAgC,WAAW,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,2HAA2H,aAAa,CAAC,2HAA2H,aAAa,CAAC,2HAA2H,UAAU,CAAC,+FAA+F,WAAW,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,sBAAsB,CAAC,cAAc,CAAC,aAAa,CAAC,iBAAiB,CAAC,+CAA+C,WAAW,CAAC,mBAAmB,CAAC,qDAAqD,iBAAiB,CAAC,aAAa,CAAC,iBAAiB,CAAC,sEAAsE,eAAe,CAAC,YAAY,CAAC,gBAAgB,CAAC,qDAAqD,cAAc,CAAC,0EAA0E,WAAW,CAAC,eAAe,CAAC,kBAAkB,CAAC,gCAAgC,OAAO,CAAC,UAAU,CAAC,UAAU,CAAC,sBAAsB,SAAS,CAAC,WAAW,CAAC,cAAc,CAAC,sBAAsB,CAAC,8BAA8B,4BAA4B,CAAC,iEAAiE,aAAa,CAAC,qDAAqD,oBAAoB,CAAC,0BAA0B,cAAc,CAAC,mBAAmB,CAAC,qDAAqD,kBAAkB,CAAC,iCAAiC,gBAAgB,CAAC,kBAAkB,CAAC,+FAA+F,OAAO,CAAC,eAAe,mBAAmB",sourcesContent:['.wbq-query_list .wbq-field-value,.wbq-query_bar .wbq-field-value{color:#1ca1c1}.wbq-query_list .wbq-field-name,.wbq-query_bar .wbq-field-name{font-weight:500}.wbq-query_list .action-close,.wbq-query_list .action-menu{cursor:pointer;margin-top:10px;right:4px;position:absolute}.wbq-query_bar .action-close,.wbq-query_bar .action-menu{cursor:pointer;margin:8px -10px 0 8px}.wbq-query_list .webix_scroll_cont>.webix_tree_leaves{padding:8px 0}.wbq-query_list .webix_tree_item{height:auto;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_list .webix_tree_item.active-editor{line-height:32px;padding:0;margin-left:4px;margin-right:4px;background-color:#fff}.wbq-query_list .webix_tree_item+.webix_tree_leaves{padding-top:10px;border-left:1px solid #ccd7e6;margin-left:20px;padding-left:16px}.wbq-query_list .webix_tree_item.group{margin:0}.wbq-filter_join{position:absolute;z-index:2;top:-24px;height:20px;line-height:20px;left:0;width:40px;border-radius:20px;text-align:center;display:block;cursor:pointer}.wbq-filter_join_and{color:#fff;background:#fdbf4c}.wbq-filter_join_or{color:#fff;background:#55cd97}.wbq-query_list .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-query_bar .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-field-box{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:250px}.wbq-query_bar .webix_scroll_cont>.webix_tree_leaves{padding:0;white-space:nowrap;padding:4px 0 4px 0}.wbq-query_bar .webix_tree_leaves,.wbq-query_bar .webix_tree_leaves div{display:inline-block}.wbq-query_bar .webix_tree_item{height:32px;line-height:32px;margin:0 52px 0 0;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:after{color:#a78fd5}.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:after{color:#68ccd2}.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:after{color:#999}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{content:"(";margin:0 2px 0 -4px;display:inline-block;transform:scaleX(0.75);font-size:30px;line-height:0;position:relative}.wbq-query_bar .group+.webix_tree_leaves:after{content:")";margin:0 -4px 0 2px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{border-radius:2px;margin-left:0;margin-right:52px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves .webix_tree_item{background:#fff;margin-top:0;line-height:32px}.wbq-query_bar .webix_tree_leaves>div:last-child>div{margin-right:0}.wbq-query_bar .webix_tree_leaves>.webix_tree_branch_1>.webix_tree_leaves{padding:4px;margin-top:-4px;margin-bottom:-4px}.wbq-query_bar .wbq-filter_join{top:6px;left:-44px;width:36px}.wbq-query_bar .group{padding:0;height:20px;margin-right:0;background:transparent}.webix_toolbar .wbq-query_bar{background-color:transparent}.wbq-query_list.webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{display:inline-block}.wbq-filter_join_disabled{cursor:default;pointer-events:none}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{background:#f4f5f9}.wbq-query_list .webix_tree_item{line-height:36px;margin-bottom:32px}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{top:4px}.wbq-field-box{margin-bottom:-13px}'],sourceRoot:""}]);const s=a},26997:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,'@font-face{font-family:Webix Querybuilder Icons;font-style:normal;font-weight:400;src:url(fonts/querybuilder-webfont.woff2) format("woff2"),url(fonts/querybuilder-webfont.woff) format("woff"),url(fonts/querybuilder-webfont.ttf) format("truetype"),url(fonts/querybuilder-webfont.svg) format("svg")}.webix_qb_filter_icon{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:inherit;cursor:pointer;display:inline-block;font:400 400 400 24px/1 "Webix Querybuilder Icons";font-size:18px;line-height:inherit;text-rendering:auto}.webix_qb_filter_icon:hover{color:#1992af}.webix_qb_filter_icon:before{content:"\\F001"}.webix_qb_filter{text-align:center}.webix_qb_wrap{background-color:#ebedf0;position:relative}.webix_qb_wrap .webix_view{background-color:transparent}.webix_qb_wrap .webix_template{padding:0}.webix_qb_wrap .webix_el_combo span.webix_input_icon,.webix_qb_wrap .webix_el_datepicker span.webix_input_icon,.webix_qb_wrap .webix_el_richselect .webix_inp_static,.webix_qb_wrap .webix_el_richselect span.webix_input_icon,.webix_qb_wrap .webix_el_select select{border-radius:0}.webix_qb_wrap .webix_qb_wrap{border-left:1px solid #ccd7e6!important}.webix_qb_add{white-space:nowrap}.webix_qb_add_group,.webix_qb_add_rule{background:transparent;border:0;box-shadow:none;color:#1ca1c1;font-size:14px;line-height:1pc;margin:0 10px 0 0;outline:0;text-transform:uppercase}.webix_qb_add_group:active,.webix_qb_add_group:focus,.webix_qb_add_group:hover,.webix_qb_add_rule:active,.webix_qb_add_rule:focus,.webix_qb_add_rule:hover{color:#1992af}.webix_qb_line .webix_qb_close{cursor:pointer;right:25px;top:0}.webix_qb_line .webix_qb_close button{background-color:transparent;border:0;color:#94a1b3;padding:2px 1px;width:20px}.webix_qb_line .webix_qb_close button:active,.webix_qb_line .webix_qb_close button:focus,.webix_qb_line .webix_qb_close button:hover{box-shadow:none;color:#ff5c4c;outline:0}.webix_qb_buttons{background-color:#606060;border-radius:2px;height:26px;margin-top:2px;padding:3px 0;text-align:center;width:87px}.webix_qb_buttons button{background-color:#606060;border:0;border-radius:0;color:#ccc;cursor:pointer;font-size:14px;height:26px;padding:0;text-transform:capitalize;width:38px}.webix_qb_and{margin-right:3px}.webix_qb_and.webix_active,.webix_qb_or.webix_active{background-color:#1ca1c1;color:#fff}.webix_qb_line{position:relative}.webix_qb_line .webix_control,.webix_qb_line .webix_inp_static,.webix_qb_line input{border-radius:0}.webix_qb_line .webix_el_slider.webix_invalid .webix_el_box{background-color:rgba(254,165,168,.2392)}.webix_qb_line .webix_qb_rule_input,.webix_qb_line .webix_qb_rule_select,.webix_qb_line .webix_qb_value_select{display:inline-block;font-size:14px}.webix_qb_line .webix_qb_rule_input .webix_input_icon,.webix_qb_line .webix_qb_rule_select .webix_input_icon,.webix_qb_line .webix_qb_value_select .webix_input_icon{display:none}.webix_column_qb .webix_qb_rule_input,.webix_column_qb .webix_qb_rule_select,.webix_column_qb .webix_qb_value_select{display:block}.webix_qb_sorting{position:absolute;right:7px;top:9px;width:390px;z-index:2}.webix_qb_sorting .webix_control{display:inline-block;margin-right:10px}',"",{version:3,sources:["webpack://./js/webix/components/querybuilder/querybuilder.min.css"],names:[],mappings:"AAAA,WAAW,oCAAoC,CAAC,iBAAiB,CAAC,eAAe,CAAC,sNAAsN,CAAC,sBAAsB,iCAAiC,CAAC,kCAAkC,CAAC,aAAa,CAAC,cAAc,CAAC,oBAAoB,CAAC,kDAAkD,CAAC,cAAc,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,4BAA4B,aAAa,CAAC,6BAA6B,eAAe,CAAC,iBAAiB,iBAAiB,CAAC,eAAe,wBAAwB,CAAC,iBAAiB,CAAC,2BAA2B,4BAA4B,CAAC,+BAA+B,SAAS,CAAC,sQAAsQ,eAAe,CAAC,8BAA8B,uCAAuC,CAAC,cAAc,kBAAkB,CAAC,uCAAuC,sBAAsB,CAAC,QAAQ,CAAC,eAAe,CAAC,aAAa,CAAC,cAAc,CAAC,eAAe,CAAC,iBAAiB,CAAC,SAAS,CAAC,wBAAwB,CAAC,2JAA2J,aAAa,CAAC,+BAA+B,cAAc,CAAC,UAAU,CAAC,KAAK,CAAC,sCAAsC,4BAA4B,CAAC,QAAQ,CAAC,aAAa,CAAC,eAAe,CAAC,UAAU,CAAC,qIAAqI,eAAe,CAAC,aAAa,CAAC,SAAS,CAAC,kBAAkB,wBAAwB,CAAC,iBAAiB,CAAC,WAAW,CAAC,cAAc,CAAC,aAAa,CAAC,iBAAiB,CAAC,UAAU,CAAC,yBAAyB,wBAAwB,CAAC,QAAQ,CAAC,eAAe,CAAC,UAAU,CAAC,cAAc,CAAC,cAAc,CAAC,WAAW,CAAC,SAAS,CAAC,yBAAyB,CAAC,UAAU,CAAC,cAAc,gBAAgB,CAAC,qDAAqD,wBAAwB,CAAC,UAAU,CAAC,eAAe,iBAAiB,CAAC,oFAAoF,eAAe,CAAC,4DAA4D,wCAAwC,CAAC,+GAA+G,oBAAoB,CAAC,cAAc,CAAC,qKAAqK,YAAY,CAAC,qHAAqH,aAAa,CAAC,kBAAkB,iBAAiB,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,CAAC,iCAAiC,oBAAoB,CAAC,iBAAiB",sourcesContent:['@font-face{font-family:Webix Querybuilder Icons;font-style:normal;font-weight:400;src:url(fonts/querybuilder-webfont.woff2) format("woff2"),url(fonts/querybuilder-webfont.woff) format("woff"),url(fonts/querybuilder-webfont.ttf) format("truetype"),url(fonts/querybuilder-webfont.svg) format("svg")}.webix_qb_filter_icon{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:inherit;cursor:pointer;display:inline-block;font:400 400 400 24px/1 "Webix Querybuilder Icons";font-size:18px;line-height:inherit;text-rendering:auto}.webix_qb_filter_icon:hover{color:#1992af}.webix_qb_filter_icon:before{content:"\\F001"}.webix_qb_filter{text-align:center}.webix_qb_wrap{background-color:#ebedf0;position:relative}.webix_qb_wrap .webix_view{background-color:transparent}.webix_qb_wrap .webix_template{padding:0}.webix_qb_wrap .webix_el_combo span.webix_input_icon,.webix_qb_wrap .webix_el_datepicker span.webix_input_icon,.webix_qb_wrap .webix_el_richselect .webix_inp_static,.webix_qb_wrap .webix_el_richselect span.webix_input_icon,.webix_qb_wrap .webix_el_select select{border-radius:0}.webix_qb_wrap .webix_qb_wrap{border-left:1px solid #ccd7e6!important}.webix_qb_add{white-space:nowrap}.webix_qb_add_group,.webix_qb_add_rule{background:transparent;border:0;box-shadow:none;color:#1ca1c1;font-size:14px;line-height:1pc;margin:0 10px 0 0;outline:0;text-transform:uppercase}.webix_qb_add_group:active,.webix_qb_add_group:focus,.webix_qb_add_group:hover,.webix_qb_add_rule:active,.webix_qb_add_rule:focus,.webix_qb_add_rule:hover{color:#1992af}.webix_qb_line .webix_qb_close{cursor:pointer;right:25px;top:0}.webix_qb_line .webix_qb_close button{background-color:transparent;border:0;color:#94a1b3;padding:2px 1px;width:20px}.webix_qb_line .webix_qb_close button:active,.webix_qb_line .webix_qb_close button:focus,.webix_qb_line .webix_qb_close button:hover{box-shadow:none;color:#ff5c4c;outline:0}.webix_qb_buttons{background-color:#606060;border-radius:2px;height:26px;margin-top:2px;padding:3px 0;text-align:center;width:87px}.webix_qb_buttons button{background-color:#606060;border:0;border-radius:0;color:#ccc;cursor:pointer;font-size:14px;height:26px;padding:0;text-transform:capitalize;width:38px}.webix_qb_and{margin-right:3px}.webix_qb_and.webix_active,.webix_qb_or.webix_active{background-color:#1ca1c1;color:#fff}.webix_qb_line{position:relative}.webix_qb_line .webix_control,.webix_qb_line .webix_inp_static,.webix_qb_line input{border-radius:0}.webix_qb_line .webix_el_slider.webix_invalid .webix_el_box{background-color:rgba(254,165,168,.2392)}.webix_qb_line .webix_qb_rule_input,.webix_qb_line .webix_qb_rule_select,.webix_qb_line .webix_qb_value_select{display:inline-block;font-size:14px}.webix_qb_line .webix_qb_rule_input .webix_input_icon,.webix_qb_line .webix_qb_rule_select .webix_input_icon,.webix_qb_line .webix_qb_value_select .webix_input_icon{display:none}.webix_column_qb .webix_qb_rule_input,.webix_column_qb .webix_qb_rule_select,.webix_column_qb .webix_qb_value_select{display:block}.webix_qb_sorting{position:absolute;right:7px;top:9px;width:390px;z-index:2}.webix_qb_sorting .webix_control{display:inline-block;margin-right:10px}'],sourceRoot:""}]);const s=a},94285:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,'@charset "UTF-8";.wbq-query_list .wbq-field-value,.wbq-query_bar .wbq-field-value{color:#1ca1c1}.wbq-query_list .wbq-field-name,.wbq-query_bar .wbq-field-name{font-weight:500}.wbq-query_list .action-close,.wbq-query_list .action-menu{cursor:pointer;margin-top:10px;right:4px;position:absolute}.wbq-query_bar .action-close,.wbq-query_bar .action-menu{cursor:pointer;margin:8px -10px 0 8px}.wbq-query_list .webix_scroll_cont>.webix_tree_leaves{padding:8px 0}.wbq-query_list .webix_tree_item{height:auto;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_list .webix_tree_item.active-editor{line-height:32px;padding:0;margin-left:4px;margin-right:4px;background-color:#fff}.wbq-query_list .webix_tree_item+.webix_tree_leaves{padding-top:10px;border-left:1px solid #ccd7e6;margin-left:20px;padding-left:16px}.wbq-query_list .webix_tree_item.group{margin:0}.wbq-filter_join{position:absolute;z-index:2;top:-24px;height:20px;line-height:20px;left:0;width:40px;border-radius:20px;text-align:center;display:block;cursor:pointer}.wbq-filter_join_and{color:#fff;background:#fdbf4c}.wbq-filter_join_or{color:#fff;background:#55cd97}.wbq-query_list .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-query_bar .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-field-box{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:250px}.wbq-query_bar .webix_scroll_cont>.webix_tree_leaves{padding:0;white-space:nowrap;padding:4px 0 4px 0}.wbq-query_bar .webix_tree_leaves,.wbq-query_bar .webix_tree_leaves div{display:inline-block}.wbq-query_bar .webix_tree_item{height:32px;line-height:32px;margin:0 52px 0 0;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:after{color:#a78fd5}.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:after{color:#68ccd2}.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:after{color:#999}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{content:"(";margin:0 2px 0 -4px;display:inline-block;transform:scaleX(0.75);font-size:30px;line-height:0;position:relative}.wbq-query_bar .group+.webix_tree_leaves:after{content:")";margin:0 -4px 0 2px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{border-radius:2px;margin-left:0;margin-right:52px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves .webix_tree_item{background:#fff;margin-top:0;line-height:32px}.wbq-query_bar .webix_tree_leaves>div:last-child>div{margin-right:0}.wbq-query_bar .webix_tree_leaves>.webix_tree_branch_1>.webix_tree_leaves{padding:4px;margin-top:-4px;margin-bottom:-4px}.wbq-query_bar .wbq-filter_join{top:6px;left:-44px;width:36px}.wbq-query_bar .group{padding:0;height:20px;margin-right:0;background:transparent}.webix_toolbar .wbq-query_bar{background-color:transparent}.wbq-query_list.webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{display:inline-block}.wbq-filter_join_disabled{cursor:default;pointer-events:none}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{background:#f4f5f9}.wbq-query_list .webix_tree_item{line-height:36px;margin-bottom:32px}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{top:4px}.wbq-field-box{margin-bottom:-13px}.webix_el_label.webix_rpt_not_saved .webix_el_box{color:#ff5c4c}.webix_reports .webix_pressed .webix_button{box-shadow:none}.webix_rpt_found_record{background:#f9eab3}.webix_rpt_list .webix_scroll_cont:empty:before{content:attr(placeholder);color:#8693a5;text-align:center;display:inline-block;width:100%;line-height:60px}.webix_rpt_empty{position:relative;background:transparent}.webix_rpt_empty .webix_template{display:flex;justify-content:center;flex-flow:row wrap}.webix_rpt_empty_placeholder{color:#8693a5;font-size:16px;font-weight:500;position:absolute;top:15%}.webix_rpt_empty svg{width:80%;height:80%;display:block;margin:auto;max-width:390px}.webix_rpt_query .webix_el_toggle button,.webix_rpt_query .webix_el_toggle .webix_pressed button{box-shadow:none}.webix_rpt_query .webix_el_toggle{text-align:center}.webix_rpt_query .webix_el_toggle button{width:300px}.webix_rpt_query .webix_el_toggle .wxi-checkbox-blank{color:#94a1b3}.webix_rpt_query .webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}@font-face{font-family:"report-webfont";src:url("fonts/report-webfont.woff2?1597778382139") format("woff2"),url("fonts/report-webfont.woff?1597778382139") format("woff");font-weight:normal;font-style:normal}[class^=rpi-]:before,[class*=rpi-]:before{font-family:"report-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.rpi-plus:before{content:""}.rpi-delete:before{content:""}.rpi-content-copy:before{content:""}.rpi-export:before{content:""}.rpi-sort-alphabetical-descending:before{content:""}.rpi-sort-alphabetical-ascending:before{content:""}.rpi-sort-calendar-descending:before{content:""}.rpi-sort-calendar-ascending:before{content:""}.rpi-pencil:before{content:""}.rpi-square-edit-outline:before{content:""}.rpi-menu:before{content:""}.rpi-menu-open:before{content:""}.rpi-dots-vertical:before{content:""}.rpi-magnify:before{content:""}.rpi-close:before{content:""}.rpi-drag-vertical:before{content:""}.rpi-eye:before{content:""}.rpi-eye-off-outline:before{content:""}.rpi-arrow-horizontal-lock:before{content:""}.rpi-cog:before{content:""}.rpi-arrow-up:before{content:""}.rpi-arrow-down:before{content:""}.rpi-table:before{content:""}.rpi-poll:before{content:""}.rpi-chart-tree:before{content:""}.rpi-chart-line:before{content:""}.rpi-chart-bell-curve-cumulative:before{content:""}.rpi-chart-areaspline:before{content:""}.rpi-chart-line-stacked:before{content:""}.rpi-chart-areaspline-variant:before{content:""}.rpi-chart-bar-stacked:before{content:""}.rpi-vector-triangle:before{content:""}.rpi-chart-bar:before{content:""}.rpi-circle-outline:before{content:""}.rpi-square-outline:before{content:""}.rpi-triangle-outline:before{content:""}.rpi-rhombus-outline:before{content:""}.rpi-trash-can-outline:before{content:""}.rpi-pail-outline:before{content:""}.wbx-mark_frozen{text-align:center;cursor:ns-resize}.wbx-mark_frozen .webix_rpt_config_row_name{width:100%;font-size:13px}.wbx-mark_frozen .webix_rpt_config_row_name .webix_icon{vertical-align:middle}.wbx-mark_frozen.webix_dd_drag div{border-color:transparent;background:inherit}.webix_rpt_config_row,.webix_rpt_item_suggest{display:flex;justify-content:space-between;align-items:center}.webix_rpt_config_row .webix_icon,.webix_rpt_item_suggest .webix_icon{line-height:inherit}.webix_rpt_config_row_name{width:310px}.webix_rpt_chart_config .webix_rpt_config_row_name{padding-left:10px}.webix_rpt_columns_list .rpi-drag-vertical{color:#94a1b3;cursor:ns-resize}.webix_rpt_columns_list .webix_cell:not(.webix_dtable_subview):hover{background:#f4f5f9}.webix_rpt_columns_list .webix_cell:not(.webix_dtable_subview):hover .rpi-drag-vertical{color:#475466}.webix_rpt_columns_list .webix_dtable_subview .webix_view{border-left-width:0}.webix_rpt_columns_list .webix_dtable_subview{background-color:transparent}.webix_rpt_columns_list .webix_dtable_subview .webix_inp_label{font-weight:normal}.webix_rpt_drag{cursor:ns-resize}.webix_drag_zone .webix_rpt_config_row .rpi-drag-vertical,.webix_drag_zone .webix_rpt_config_row .webix_tree_close{visibility:hidden}.webix_rpt_delete .webix_button{color:#ff5c4c}.webix_rpt_title{color:#313131;font-weight:500}.webix_rpt_subtitle .webix_inp_label,.webix_rpt_subtitle .webix_el_box{color:#475466;font-weight:normal}.webix_rpt_date_selector{color:#1ca1c1;display:inline-block;line-height:1}.webix_rpt_date_selector .webix_rpt_sort_selector .webix_rpt_date_selector .webix_icon{cursor:pointer}.webix_rpt_grouppopup .webix_icon{padding-top:6px;float:right}.webix_rpt_grouppopup .wxi-radiobox-marked{color:#1ca1c1}.webix_rpt_grouppopup .wxi-radiobox-blank{color:#94a1b3}.webix_rpt_groupselect_delete,.webix_rpt_multicombo .webix_multicombo_delete{font-size:16px;width:20px;line-height:20px}.webix_rpt_groupselect_delete:after,.webix_rpt_multicombo .webix_multicombo_delete:after{content:""}.webix_rpt_summary_form{border-color:transparent}.webix_rpt_chart_color{width:24px;height:24px;border-radius:2px;margin-left:10px}.webix_rpt_config_row_hover{background:#f4f5f9}.webix_rpt_colorpicker .webix_input_icon{position:absolute;right:32px}.webix_rpt_colorpicker .webix_input_icon:before{font-size:20px;content:"";left:30px;position:absolute;color:#94a1b3;top:2px}.webix_rpt_markerselect .webix_icon{font-size:18px;margin-right:2px}.webix_rpt_markerselect_list .webix_icon{font-size:18px;margin-right:17px}.webix_rpt_action_remove{color:#94a1b3;margin-top:6px}.webix_rpt_description .webix_template{padding-left:2px;font-size:13px}.webix_rpt_qselect_icon{padding-top:7px;float:right;color:#94a1b3}.webix_rpt_qselect_suggest .webix_scroll_cont:empty:before{content:attr(placeholder);font-size:13px;font-style:italic;color:#8693a5;text-align:center;display:inline-block;width:100%;line-height:25px}.webix_rpt_groupselect .webix_multicombo_value{display:flex;align-items:center;padding-right:6px}.webix_rpt_groupselect .webix_multicombo_value .webix_rpt_groupselect_delete{margin-top:0;position:static;line-height:1;margin-left:5px;height:auto}.webix_rpt_groupselect .webix_multicombo_value>span{vertical-align:middle}.webix_rpt_groupselect_sep{padding:0 6px 0 3px}.webix_rpt_bcols .webix_dtable_subview{padding-left:0}.webix_rpt_bucket_values .webix_list_item{display:flex;align-items:center}.webix_rpt_bucket_values .webix_list_item .webix_rpt_bucket_value{width:170px}.webix_rpt_multicombo .webix_multicombo_text{display:flex;align-items:center}.webix_rpt_bucket_value{max-width:170px;text-overflow:ellipsis;display:inline-block;overflow:hidden}.webix_multicombo_value .webix_rpt_bucket_icon{display:none}.webix_rpt_bucket_icon{width:25px;text-align:right;color:#94a1b3}.webix_rpt_bucket_sublabel{font-size:13px;color:#8693a5}.webix_rpt_bucket_sublabel.webix_icon{font-size:15px}.webix_rpt_buckets_num{margin-right:15px}.webix_rpt_subview .webix_invalid .webix_el_box input,.webix_rpt_subview .webix_invalid .webix_el_box .webix_inp_static{background:#fff;color:#475466}.webix_rpt_bucket_delete{width:40px;color:#94a1b3}.webix_rpt_bucket_delete:hover{color:#475466}.webix_rpt_bucket_value_selected{color:#8693a5}.webix_el_search .webix_badge{cursor:default;padding-left:4px}.webix_rpt .webix_treemap_item.l0{background-color:#42a5f5}.webix_rpt .webix_treemap_item.l1{background-color:#64b5f6}.webix_rpt .webix_treemap_item.l2{background-color:#90caf9}.webix_rpt .webix_treemap_item.l3{background-color:#bbdefb}.webix_rpt_list_btn .webix_cell{padding:0}.webix_rpt_list_btn .webix_icon{line-height:38px;border-radius:50%;width:38px;height:38px;color:#8693a5}.webix_rpt_list_btn .webix_icon:hover{background:rgba(0,0,0,0.07);color:#475466}.webix_rpt_list .webix_selected .webix_rpt_list_report_date,.webix_rpt_list .webix_selected .webix_icon,.webix_rpt_list .webix_selected:focus .webix_rpt_list_report_date,.webix_rpt_list .webix_selected:focus .webix_icon{color:#8693a5}.webix_rpt_list .webix_selected .webix_icon:hover,.webix_rpt_list .webix_selected:focus .webix_icon:hover{color:#475466}.webix_rpt_list_block{position:relative;padding-top:6px}.webix_rpt_list_report_date,.webix_rpt_list_report_name{width:260px;line-height:22px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.webix_rpt_list_report_date{color:#8693a5;font-size:13px;line-height:20px;height:20px;overflow:hidden}.webix_rpt_action_menu{position:absolute;right:0;top:50%;color:#94a1b3;margin-top:-8px}.webix_rpt_action_menu:hover{color:#475466}.webix_rpt_btn_active.webix_rpt_sort_icon .webix_icon,.webix_rpt_btn_active.webix_rpt_sort_icon button:hover .webix_icon{color:#1ca1c1}.webix_rpt_sort_icon .webix_icon{color:#94a1b3}.webix_rpt_sources_path{float:right;color:#888;font-size:12px}.webix_multicombo_value .webix_rpt_sources_path{display:none}.wbq-field-name .webix_rpt_sources_path{position:absolute;right:30px}.webix_rpt_popup_menu .webix_list_item{padding-left:7px}.webix_rpt_popup_menu .webix_icon{color:#94a1b3;float:left;font-size:19px;margin-top:6px;margin-right:5px}.webix_rpt_popup_menu .webix_disabled .webix_icon{color:#bfccdf}.webix_rpt_popup_menu .webix_list_item:active,.webix_rpt_popup_menu .webix_list_item:focus{background:transparent}.webix_rpt_vertical_chart_labels .webix_axis_item_x{transform:rotate(-45deg);text-align:right;transform-origin:75% 320%}.webix_rpt_vertical_chart_labels .webix_rpt_chart_label{width:80px}.webix_rpt_chart_label{max-width:80px}.webix_rpt_vertical_chart_labels .webix_rpt_chart_label0{left:40px !important}.webix_el_search .webix_badge{top:9px;right:29px}.webix_rpt_cls1{fill:#9dbabf;fill-opacity:.25}.webix_rpt_cls2{fill:#edeff0}.webix_rpt_cls3{fill:#b4dfea}.webix_rpt_cls4{fill:#fafbff}.webix_rpt_cls5{fill:#dedede}.webix_rpt_cls6{fill:#f2f2f2}.webix_rpt_cls7{fill:#fff}.webix_rpt_cls8{fill:#b4dfea}.webix_rpt_cls9{fill:#f4f5f9}',"",{version:3,sources:["webpack://./js/webix/components/reports/reports.min.css"],names:[],mappings:"AAAA,gBAAgB,CAAC,iEAAiE,aAAa,CAAC,+DAA+D,eAAe,CAAC,2DAA2D,cAAc,CAAC,eAAe,CAAC,SAAS,CAAC,iBAAiB,CAAC,yDAAyD,cAAc,CAAC,sBAAsB,CAAC,sDAAsD,aAAa,CAAC,iCAAiC,WAAW,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,+CAA+C,gBAAgB,CAAC,SAAS,CAAC,eAAe,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,oDAAoD,gBAAgB,CAAC,6BAA6B,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,uCAAuC,QAAQ,CAAC,iBAAiB,iBAAiB,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,gBAAgB,CAAC,MAAM,CAAC,UAAU,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,aAAa,CAAC,cAAc,CAAC,qBAAqB,UAAU,CAAC,kBAAkB,CAAC,oBAAoB,UAAU,CAAC,kBAAkB,CAAC,oFAAoF,YAAY,CAAC,mFAAmF,YAAY,CAAC,eAAe,oBAAoB,CAAC,eAAe,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,eAAe,CAAC,qDAAqD,SAAS,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,wEAAwE,oBAAoB,CAAC,gCAAgC,WAAW,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,2BAA2B,CAAC,2HAA2H,aAAa,CAAC,2HAA2H,aAAa,CAAC,2HAA2H,UAAU,CAAC,+FAA+F,WAAW,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,sBAAsB,CAAC,cAAc,CAAC,aAAa,CAAC,iBAAiB,CAAC,+CAA+C,WAAW,CAAC,mBAAmB,CAAC,qDAAqD,iBAAiB,CAAC,aAAa,CAAC,iBAAiB,CAAC,sEAAsE,eAAe,CAAC,YAAY,CAAC,gBAAgB,CAAC,qDAAqD,cAAc,CAAC,0EAA0E,WAAW,CAAC,eAAe,CAAC,kBAAkB,CAAC,gCAAgC,OAAO,CAAC,UAAU,CAAC,UAAU,CAAC,sBAAsB,SAAS,CAAC,WAAW,CAAC,cAAc,CAAC,sBAAsB,CAAC,8BAA8B,4BAA4B,CAAC,iEAAiE,aAAa,CAAC,qDAAqD,oBAAoB,CAAC,0BAA0B,cAAc,CAAC,mBAAmB,CAAC,qDAAqD,kBAAkB,CAAC,iCAAiC,gBAAgB,CAAC,kBAAkB,CAAC,+FAA+F,OAAO,CAAC,eAAe,mBAAmB,CAAC,kDAAkD,aAAa,CAAC,4CAA4C,eAAe,CAAC,wBAAwB,kBAAkB,CAAC,gDAAgD,yBAAyB,CAAC,aAAa,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,iBAAiB,CAAC,sBAAsB,CAAC,iCAAiC,YAAY,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,6BAA6B,aAAa,CAAC,cAAc,CAAC,eAAe,CAAC,iBAAiB,CAAC,OAAO,CAAC,qBAAqB,SAAS,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,eAAe,CAAC,iGAAiG,eAAe,CAAC,kCAAkC,iBAAiB,CAAC,yCAAyC,WAAW,CAAC,sDAAsD,aAAa,CAAC,mEAAmE,aAAa,CAAC,WAAW,4BAA4B,CAAC,iIAAiI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,0CAA0C,4BAA4B,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,aAAa,CAAC,kCAAkC,CAAC,iCAAiC,CAAC,wBAAwB,CAAC,iBAAiB,WAAW,CAAC,mBAAmB,WAAW,CAAC,yBAAyB,WAAW,CAAC,mBAAmB,WAAW,CAAC,yCAAyC,WAAW,CAAC,wCAAwC,WAAW,CAAC,qCAAqC,WAAW,CAAC,oCAAoC,WAAW,CAAC,mBAAmB,WAAW,CAAC,gCAAgC,WAAW,CAAC,iBAAiB,WAAW,CAAC,sBAAsB,WAAW,CAAC,0BAA0B,WAAW,CAAC,oBAAoB,WAAW,CAAC,kBAAkB,WAAW,CAAC,0BAA0B,WAAW,CAAC,gBAAgB,WAAW,CAAC,4BAA4B,WAAW,CAAC,kCAAkC,WAAW,CAAC,gBAAgB,WAAW,CAAC,qBAAqB,WAAW,CAAC,uBAAuB,WAAW,CAAC,kBAAkB,WAAW,CAAC,iBAAiB,WAAW,CAAC,uBAAuB,WAAW,CAAC,uBAAuB,WAAW,CAAC,wCAAwC,WAAW,CAAC,6BAA6B,WAAW,CAAC,+BAA+B,WAAW,CAAC,qCAAqC,WAAW,CAAC,8BAA8B,WAAW,CAAC,4BAA4B,WAAW,CAAC,sBAAsB,WAAW,CAAC,2BAA2B,WAAW,CAAC,2BAA2B,WAAW,CAAC,6BAA6B,WAAW,CAAC,4BAA4B,WAAW,CAAC,8BAA8B,WAAW,CAAC,yBAAyB,WAAW,CAAC,iBAAiB,iBAAiB,CAAC,gBAAgB,CAAC,4CAA4C,UAAU,CAAC,cAAc,CAAC,wDAAwD,qBAAqB,CAAC,mCAAmC,wBAAwB,CAAC,kBAAkB,CAAC,8CAA8C,YAAY,CAAC,6BAA6B,CAAC,kBAAkB,CAAC,sEAAsE,mBAAmB,CAAC,2BAA2B,WAAW,CAAC,mDAAmD,iBAAiB,CAAC,2CAA2C,aAAa,CAAC,gBAAgB,CAAC,qEAAqE,kBAAkB,CAAC,wFAAwF,aAAa,CAAC,0DAA0D,mBAAmB,CAAC,8CAA8C,4BAA4B,CAAC,+DAA+D,kBAAkB,CAAC,gBAAgB,gBAAgB,CAAC,mHAAmH,iBAAiB,CAAC,gCAAgC,aAAa,CAAC,iBAAiB,aAAa,CAAC,eAAe,CAAC,uEAAuE,aAAa,CAAC,kBAAkB,CAAC,yBAAyB,aAAa,CAAC,oBAAoB,CAAC,aAAa,CAAC,uFAAuF,cAAc,CAAC,kCAAkC,eAAe,CAAC,WAAW,CAAC,2CAA2C,aAAa,CAAC,0CAA0C,aAAa,CAAC,6EAA6E,cAAc,CAAC,UAAU,CAAC,gBAAgB,CAAC,yFAAyF,WAAW,CAAC,wBAAwB,wBAAwB,CAAC,uBAAuB,UAAU,CAAC,WAAW,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,4BAA4B,kBAAkB,CAAC,yCAAyC,iBAAiB,CAAC,UAAU,CAAC,gDAAgD,cAAc,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,aAAa,CAAC,OAAO,CAAC,oCAAoC,cAAc,CAAC,gBAAgB,CAAC,yCAAyC,cAAc,CAAC,iBAAiB,CAAC,yBAAyB,aAAa,CAAC,cAAc,CAAC,uCAAuC,gBAAgB,CAAC,cAAc,CAAC,wBAAwB,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,2DAA2D,yBAAyB,CAAC,cAAc,CAAC,iBAAiB,CAAC,aAAa,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,UAAU,CAAC,gBAAgB,CAAC,+CAA+C,YAAY,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,6EAA6E,YAAY,CAAC,eAAe,CAAC,aAAa,CAAC,eAAe,CAAC,WAAW,CAAC,oDAAoD,qBAAqB,CAAC,2BAA2B,mBAAmB,CAAC,uCAAuC,cAAc,CAAC,0CAA0C,YAAY,CAAC,kBAAkB,CAAC,kEAAkE,WAAW,CAAC,6CAA6C,YAAY,CAAC,kBAAkB,CAAC,wBAAwB,eAAe,CAAC,sBAAsB,CAAC,oBAAoB,CAAC,eAAe,CAAC,+CAA+C,YAAY,CAAC,uBAAuB,UAAU,CAAC,gBAAgB,CAAC,aAAa,CAAC,2BAA2B,cAAc,CAAC,aAAa,CAAC,sCAAsC,cAAc,CAAC,uBAAuB,iBAAiB,CAAC,wHAAwH,eAAe,CAAC,aAAa,CAAC,yBAAyB,UAAU,CAAC,aAAa,CAAC,+BAA+B,aAAa,CAAC,iCAAiC,aAAa,CAAC,8BAA8B,cAAc,CAAC,gBAAgB,CAAC,kCAAkC,wBAAwB,CAAC,kCAAkC,wBAAwB,CAAC,kCAAkC,wBAAwB,CAAC,kCAAkC,wBAAwB,CAAC,gCAAgC,SAAS,CAAC,gCAAgC,gBAAgB,CAAC,iBAAiB,CAAC,UAAU,CAAC,WAAW,CAAC,aAAa,CAAC,sCAAsC,2BAA2B,CAAC,aAAa,CAAC,4NAA4N,aAAa,CAAC,0GAA0G,aAAa,CAAC,sBAAsB,iBAAiB,CAAC,eAAe,CAAC,wDAAwD,WAAW,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,eAAe,CAAC,sBAAsB,CAAC,4BAA4B,aAAa,CAAC,cAAc,CAAC,gBAAgB,CAAC,WAAW,CAAC,eAAe,CAAC,uBAAuB,iBAAiB,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,eAAe,CAAC,6BAA6B,aAAa,CAAC,yHAAyH,aAAa,CAAC,iCAAiC,aAAa,CAAC,wBAAwB,WAAW,CAAC,UAAU,CAAC,cAAc,CAAC,gDAAgD,YAAY,CAAC,wCAAwC,iBAAiB,CAAC,UAAU,CAAC,uCAAuC,gBAAgB,CAAC,kCAAkC,aAAa,CAAC,UAAU,CAAC,cAAc,CAAC,cAAc,CAAC,gBAAgB,CAAC,kDAAkD,aAAa,CAAC,2FAA2F,sBAAsB,CAAC,oDAAoD,wBAAwB,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,wDAAwD,UAAU,CAAC,uBAAuB,cAAc,CAAC,yDAAyD,oBAAoB,CAAC,8BAA8B,OAAO,CAAC,UAAU,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,SAAS,CAAC,gBAAgB,YAAY,CAAC,gBAAgB,YAAY",sourcesContent:['@charset "UTF-8";.wbq-query_list .wbq-field-value,.wbq-query_bar .wbq-field-value{color:#1ca1c1}.wbq-query_list .wbq-field-name,.wbq-query_bar .wbq-field-name{font-weight:500}.wbq-query_list .action-close,.wbq-query_list .action-menu{cursor:pointer;margin-top:10px;right:4px;position:absolute}.wbq-query_bar .action-close,.wbq-query_bar .action-menu{cursor:pointer;margin:8px -10px 0 8px}.wbq-query_list .webix_scroll_cont>.webix_tree_leaves{padding:8px 0}.wbq-query_list .webix_tree_item{height:auto;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_list .webix_tree_item.active-editor{line-height:32px;padding:0;margin-left:4px;margin-right:4px;background-color:#fff}.wbq-query_list .webix_tree_item+.webix_tree_leaves{padding-top:10px;border-left:1px solid #ccd7e6;margin-left:20px;padding-left:16px}.wbq-query_list .webix_tree_item.group{margin:0}.wbq-filter_join{position:absolute;z-index:2;top:-24px;height:20px;line-height:20px;left:0;width:40px;border-radius:20px;text-align:center;display:block;cursor:pointer}.wbq-filter_join_and{color:#fff;background:#fdbf4c}.wbq-filter_join_or{color:#fff;background:#55cd97}.wbq-query_list .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-query_bar .webix_tree_leaves>div:first-child>div:first-child .wbq-filter_join{display:none}.wbq-field-box{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:250px}.wbq-query_bar .webix_scroll_cont>.webix_tree_leaves{padding:0;white-space:nowrap;padding:4px 0 4px 0}.wbq-query_bar .webix_tree_leaves,.wbq-query_bar .webix_tree_leaves div{display:inline-block}.wbq-query_bar .webix_tree_item{height:32px;line-height:32px;margin:0 52px 0 0;padding:0 16px;user-select:none;position:relative;background:#f4f5f9;border-radius:2px;white-space:nowrap;overflow:visible !important}.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_1 .webix_tree_leaves:after{color:#a78fd5}.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_2 .webix_tree_leaves:after{color:#68ccd2}.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:before,.wbq-query_bar .webix_tree_branch_3 .webix_tree_leaves:after{color:#999}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{content:"(";margin:0 2px 0 -4px;display:inline-block;transform:scaleX(0.75);font-size:30px;line-height:0;position:relative}.wbq-query_bar .group+.webix_tree_leaves:after{content:")";margin:0 -4px 0 2px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{border-radius:2px;margin-left:0;margin-right:52px}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves .webix_tree_item{background:#fff;margin-top:0;line-height:32px}.wbq-query_bar .webix_tree_leaves>div:last-child>div{margin-right:0}.wbq-query_bar .webix_tree_leaves>.webix_tree_branch_1>.webix_tree_leaves{padding:4px;margin-top:-4px;margin-bottom:-4px}.wbq-query_bar .wbq-filter_join{top:6px;left:-44px;width:36px}.wbq-query_bar .group{padding:0;height:20px;margin-right:0;background:transparent}.webix_toolbar .wbq-query_bar{background-color:transparent}.wbq-query_list.webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{display:inline-block}.wbq-filter_join_disabled{cursor:default;pointer-events:none}.wbq-query_bar .webix_tree_leaves .webix_tree_leaves{background:#f4f5f9}.wbq-query_list .webix_tree_item{line-height:36px;margin-bottom:32px}.wbq-query_bar .group+.webix_tree_leaves:before,.wbq-query_bar .group+.webix_tree_leaves:after{top:4px}.wbq-field-box{margin-bottom:-13px}.webix_el_label.webix_rpt_not_saved .webix_el_box{color:#ff5c4c}.webix_reports .webix_pressed .webix_button{box-shadow:none}.webix_rpt_found_record{background:#f9eab3}.webix_rpt_list .webix_scroll_cont:empty:before{content:attr(placeholder);color:#8693a5;text-align:center;display:inline-block;width:100%;line-height:60px}.webix_rpt_empty{position:relative;background:transparent}.webix_rpt_empty .webix_template{display:flex;justify-content:center;flex-flow:row wrap}.webix_rpt_empty_placeholder{color:#8693a5;font-size:16px;font-weight:500;position:absolute;top:15%}.webix_rpt_empty svg{width:80%;height:80%;display:block;margin:auto;max-width:390px}.webix_rpt_query .webix_el_toggle button,.webix_rpt_query .webix_el_toggle .webix_pressed button{box-shadow:none}.webix_rpt_query .webix_el_toggle{text-align:center}.webix_rpt_query .webix_el_toggle button{width:300px}.webix_rpt_query .webix_el_toggle .wxi-checkbox-blank{color:#94a1b3}.webix_rpt_query .webix_tree .webix_scroll_cont>.webix_tree_leaves{display:block}@font-face{font-family:"report-webfont";src:url("fonts/report-webfont.woff2?1597778382139") format("woff2"),url("fonts/report-webfont.woff?1597778382139") format("woff");font-weight:normal;font-style:normal}[class^=rpi-]:before,[class*=rpi-]:before{font-family:"report-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.rpi-plus:before{content:""}.rpi-delete:before{content:""}.rpi-content-copy:before{content:""}.rpi-export:before{content:""}.rpi-sort-alphabetical-descending:before{content:""}.rpi-sort-alphabetical-ascending:before{content:""}.rpi-sort-calendar-descending:before{content:""}.rpi-sort-calendar-ascending:before{content:""}.rpi-pencil:before{content:""}.rpi-square-edit-outline:before{content:""}.rpi-menu:before{content:""}.rpi-menu-open:before{content:""}.rpi-dots-vertical:before{content:""}.rpi-magnify:before{content:""}.rpi-close:before{content:""}.rpi-drag-vertical:before{content:""}.rpi-eye:before{content:""}.rpi-eye-off-outline:before{content:""}.rpi-arrow-horizontal-lock:before{content:""}.rpi-cog:before{content:""}.rpi-arrow-up:before{content:""}.rpi-arrow-down:before{content:""}.rpi-table:before{content:""}.rpi-poll:before{content:""}.rpi-chart-tree:before{content:""}.rpi-chart-line:before{content:""}.rpi-chart-bell-curve-cumulative:before{content:""}.rpi-chart-areaspline:before{content:""}.rpi-chart-line-stacked:before{content:""}.rpi-chart-areaspline-variant:before{content:""}.rpi-chart-bar-stacked:before{content:""}.rpi-vector-triangle:before{content:""}.rpi-chart-bar:before{content:""}.rpi-circle-outline:before{content:""}.rpi-square-outline:before{content:""}.rpi-triangle-outline:before{content:""}.rpi-rhombus-outline:before{content:""}.rpi-trash-can-outline:before{content:""}.rpi-pail-outline:before{content:""}.wbx-mark_frozen{text-align:center;cursor:ns-resize}.wbx-mark_frozen .webix_rpt_config_row_name{width:100%;font-size:13px}.wbx-mark_frozen .webix_rpt_config_row_name .webix_icon{vertical-align:middle}.wbx-mark_frozen.webix_dd_drag div{border-color:transparent;background:inherit}.webix_rpt_config_row,.webix_rpt_item_suggest{display:flex;justify-content:space-between;align-items:center}.webix_rpt_config_row .webix_icon,.webix_rpt_item_suggest .webix_icon{line-height:inherit}.webix_rpt_config_row_name{width:310px}.webix_rpt_chart_config .webix_rpt_config_row_name{padding-left:10px}.webix_rpt_columns_list .rpi-drag-vertical{color:#94a1b3;cursor:ns-resize}.webix_rpt_columns_list .webix_cell:not(.webix_dtable_subview):hover{background:#f4f5f9}.webix_rpt_columns_list .webix_cell:not(.webix_dtable_subview):hover .rpi-drag-vertical{color:#475466}.webix_rpt_columns_list .webix_dtable_subview .webix_view{border-left-width:0}.webix_rpt_columns_list .webix_dtable_subview{background-color:transparent}.webix_rpt_columns_list .webix_dtable_subview .webix_inp_label{font-weight:normal}.webix_rpt_drag{cursor:ns-resize}.webix_drag_zone .webix_rpt_config_row .rpi-drag-vertical,.webix_drag_zone .webix_rpt_config_row .webix_tree_close{visibility:hidden}.webix_rpt_delete .webix_button{color:#ff5c4c}.webix_rpt_title{color:#313131;font-weight:500}.webix_rpt_subtitle .webix_inp_label,.webix_rpt_subtitle .webix_el_box{color:#475466;font-weight:normal}.webix_rpt_date_selector{color:#1ca1c1;display:inline-block;line-height:1}.webix_rpt_date_selector .webix_rpt_sort_selector .webix_rpt_date_selector .webix_icon{cursor:pointer}.webix_rpt_grouppopup .webix_icon{padding-top:6px;float:right}.webix_rpt_grouppopup .wxi-radiobox-marked{color:#1ca1c1}.webix_rpt_grouppopup .wxi-radiobox-blank{color:#94a1b3}.webix_rpt_groupselect_delete,.webix_rpt_multicombo .webix_multicombo_delete{font-size:16px;width:20px;line-height:20px}.webix_rpt_groupselect_delete:after,.webix_rpt_multicombo .webix_multicombo_delete:after{content:""}.webix_rpt_summary_form{border-color:transparent}.webix_rpt_chart_color{width:24px;height:24px;border-radius:2px;margin-left:10px}.webix_rpt_config_row_hover{background:#f4f5f9}.webix_rpt_colorpicker .webix_input_icon{position:absolute;right:32px}.webix_rpt_colorpicker .webix_input_icon:before{font-size:20px;content:"";left:30px;position:absolute;color:#94a1b3;top:2px}.webix_rpt_markerselect .webix_icon{font-size:18px;margin-right:2px}.webix_rpt_markerselect_list .webix_icon{font-size:18px;margin-right:17px}.webix_rpt_action_remove{color:#94a1b3;margin-top:6px}.webix_rpt_description .webix_template{padding-left:2px;font-size:13px}.webix_rpt_qselect_icon{padding-top:7px;float:right;color:#94a1b3}.webix_rpt_qselect_suggest .webix_scroll_cont:empty:before{content:attr(placeholder);font-size:13px;font-style:italic;color:#8693a5;text-align:center;display:inline-block;width:100%;line-height:25px}.webix_rpt_groupselect .webix_multicombo_value{display:flex;align-items:center;padding-right:6px}.webix_rpt_groupselect .webix_multicombo_value .webix_rpt_groupselect_delete{margin-top:0;position:static;line-height:1;margin-left:5px;height:auto}.webix_rpt_groupselect .webix_multicombo_value>span{vertical-align:middle}.webix_rpt_groupselect_sep{padding:0 6px 0 3px}.webix_rpt_bcols .webix_dtable_subview{padding-left:0}.webix_rpt_bucket_values .webix_list_item{display:flex;align-items:center}.webix_rpt_bucket_values .webix_list_item .webix_rpt_bucket_value{width:170px}.webix_rpt_multicombo .webix_multicombo_text{display:flex;align-items:center}.webix_rpt_bucket_value{max-width:170px;text-overflow:ellipsis;display:inline-block;overflow:hidden}.webix_multicombo_value .webix_rpt_bucket_icon{display:none}.webix_rpt_bucket_icon{width:25px;text-align:right;color:#94a1b3}.webix_rpt_bucket_sublabel{font-size:13px;color:#8693a5}.webix_rpt_bucket_sublabel.webix_icon{font-size:15px}.webix_rpt_buckets_num{margin-right:15px}.webix_rpt_subview .webix_invalid .webix_el_box input,.webix_rpt_subview .webix_invalid .webix_el_box .webix_inp_static{background:#fff;color:#475466}.webix_rpt_bucket_delete{width:40px;color:#94a1b3}.webix_rpt_bucket_delete:hover{color:#475466}.webix_rpt_bucket_value_selected{color:#8693a5}.webix_el_search .webix_badge{cursor:default;padding-left:4px}.webix_rpt .webix_treemap_item.l0{background-color:#42a5f5}.webix_rpt .webix_treemap_item.l1{background-color:#64b5f6}.webix_rpt .webix_treemap_item.l2{background-color:#90caf9}.webix_rpt .webix_treemap_item.l3{background-color:#bbdefb}.webix_rpt_list_btn .webix_cell{padding:0}.webix_rpt_list_btn .webix_icon{line-height:38px;border-radius:50%;width:38px;height:38px;color:#8693a5}.webix_rpt_list_btn .webix_icon:hover{background:rgba(0,0,0,0.07);color:#475466}.webix_rpt_list .webix_selected .webix_rpt_list_report_date,.webix_rpt_list .webix_selected .webix_icon,.webix_rpt_list .webix_selected:focus .webix_rpt_list_report_date,.webix_rpt_list .webix_selected:focus .webix_icon{color:#8693a5}.webix_rpt_list .webix_selected .webix_icon:hover,.webix_rpt_list .webix_selected:focus .webix_icon:hover{color:#475466}.webix_rpt_list_block{position:relative;padding-top:6px}.webix_rpt_list_report_date,.webix_rpt_list_report_name{width:260px;line-height:22px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.webix_rpt_list_report_date{color:#8693a5;font-size:13px;line-height:20px;height:20px;overflow:hidden}.webix_rpt_action_menu{position:absolute;right:0;top:50%;color:#94a1b3;margin-top:-8px}.webix_rpt_action_menu:hover{color:#475466}.webix_rpt_btn_active.webix_rpt_sort_icon .webix_icon,.webix_rpt_btn_active.webix_rpt_sort_icon button:hover .webix_icon{color:#1ca1c1}.webix_rpt_sort_icon .webix_icon{color:#94a1b3}.webix_rpt_sources_path{float:right;color:#888;font-size:12px}.webix_multicombo_value .webix_rpt_sources_path{display:none}.wbq-field-name .webix_rpt_sources_path{position:absolute;right:30px}.webix_rpt_popup_menu .webix_list_item{padding-left:7px}.webix_rpt_popup_menu .webix_icon{color:#94a1b3;float:left;font-size:19px;margin-top:6px;margin-right:5px}.webix_rpt_popup_menu .webix_disabled .webix_icon{color:#bfccdf}.webix_rpt_popup_menu .webix_list_item:active,.webix_rpt_popup_menu .webix_list_item:focus{background:transparent}.webix_rpt_vertical_chart_labels .webix_axis_item_x{transform:rotate(-45deg);text-align:right;transform-origin:75% 320%}.webix_rpt_vertical_chart_labels .webix_rpt_chart_label{width:80px}.webix_rpt_chart_label{max-width:80px}.webix_rpt_vertical_chart_labels .webix_rpt_chart_label0{left:40px !important}.webix_el_search .webix_badge{top:9px;right:29px}.webix_rpt_cls1{fill:#9dbabf;fill-opacity:.25}.webix_rpt_cls2{fill:#edeff0}.webix_rpt_cls3{fill:#b4dfea}.webix_rpt_cls4{fill:#fafbff}.webix_rpt_cls5{fill:#dedede}.webix_rpt_cls6{fill:#f2f2f2}.webix_rpt_cls7{fill:#fff}.webix_rpt_cls8{fill:#b4dfea}.webix_rpt_cls9{fill:#f4f5f9}'],sourceRoot:""}]);const s=a},60898:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var n=i(60445),r=i.n(n),o=i(60352),a=i.n(o)()(r());a.push([e.id,'@charset "UTF-8";@font-face{font-family:"scheduler-webfont";src:url("fonts/scheduler-webfont.woff2") format("woff2"),url("fonts/scheduler-webfont.woff") format("woff");font-weight:normal;font-style:normal}[class^=shi-]:before,[class*=shi-]:before{font-family:"scheduler-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.shi-agenda:before{content:""}.shi-day:before{content:""}.shi-month:before{content:""}.shi-week:before{content:""}.shi-back:before{content:""}.shi-menu:before{content:""}.shi-timeline:before{content:""}.shi-units:before{content:""}.shi-content-copy:before{content:""}.shi-year:before{content:""}.webix_scheduler_info .webix_template{overflow:auto;padding:0 0 0 2px}.webix_scheduler_info .webix_template .webix_scheduler_event_title{color:#313131;font-weight:500;margin-top:7px;margin-bottom:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_from_to,.webix_scheduler_info .webix_template .webix_scheduler_event_recurring_pattern{margin-bottom:20px;line-height:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_details_title,.webix_scheduler_info .webix_template .webix_scheduler_event_units_title{color:#313131;font-weight:500;margin-bottom:10px}.webix_scheduler_info .webix_template .webix_scheduler_event_text{line-height:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_units{margin-bottom:10px}.webix_scheduler_info .webix_template .webix_scheduler_event_units .webix_scheduler_event_unit_item{display:inline-block;margin-right:6px}.webix_scheduler_section_tpl{margin-top:20px;margin-bottom:20px}.webix_scheduler_section_tpl .webix_scheduler_section_title{font-weight:500;color:#313131}.webix_scheduler_cal_color .webix_inp_static{padding-right:50px}.webix_scheduler_cal_color_suggest .webix_list_item,.webix_scheduler_cal_color_suggest .webix_list_item.webix_selected{position:relative;padding-right:32px}.webix_scheduler_cal_color_suggest .webix_scheduler_cal_marker{right:4px}.webix_scheduler_cal_marker{display:block;width:24px;height:24px;border-radius:2px;position:absolute;right:26px;top:50%;margin-top:-12px}.webix_scheduler_counter .webix_inp_counter_value{width:calc(100% - 60px)}.webix_scheduler_subform_popup{border-width:1px}.webix_scheduler_subform_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_cal_disabled{color:#94a1b3}.webix_scheduler_cal_disabled .webix_scheduler_calendar_marker{opacity:.6}.webix_scheduler_day_events{border-color:#edeff0;position:relative}.webix_scheduler_day_events .webix_list_item{padding:0;cursor:default;padding:0}.webix_scheduler_day_event{padding:8px 8px 16px;overflow:hidden;cursor:pointer;position:absolute;border-radius:2px;border-left:3px solid;box-sizing:border-box;transition:box-shadow .15s}.webix_scheduler_day_event:hover{z-index:1;box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_day_event:hover .webix_scheduler_resizer{visibility:visible}.webix_active_resize .webix_scheduler_day_events .webix_scheduler_day_event,.webix_active_resize .webix_scheduler_day_events .webix_list_item{cursor:ns-resize}.webix_drag_event,.webix_drag_event:hover{border-radius:2px;box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_active_resize .webix_scheduler_day_event:hover,.webix_noselect .webix_scheduler_day_event:hover{box-shadow:none}.webix_active_resize .webix_scheduler_day_event:hover .webix_scheduler_resizer,.webix_noselect .webix_scheduler_day_event:hover .webix_scheduler_resizer{visibility:hidden}.webix_active_resize .webix_scheduler_day_event.webix_resize_event:hover .webix_scheduler_resizer{visibility:visible}.webix_resize_event{border-radius:2px;box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_resize_event .webix_scheduler_resizer{visibility:visible}.webix_scheduler_resizer{position:absolute;bottom:0;left:0;width:100%;height:16px;font-size:16px;visibility:hidden;cursor:ns-resize}.webix_scheduler_resizer::before{content:"";transform:rotate(90deg);position:absolute;margin-left:-10px}.webix_scheduler_multilist{border-left-color:#edeff0;border-bottom-color:transparent}.webix_scheduler_multilist .webix_list_item{cursor:default;padding:0;line-height:normal;font-weight:500;position:relative;border-color:transparent}.webix_scheduler_multilist .webix_scheduler_multi_more .webix_scheduler_multiday_event{transition:background-color .3s;background-color:#f4f5f9;text-align:center;border:0}.webix_scheduler_multilist .webix_scheduler_multi_more .webix_scheduler_multiday_event:hover{background-color:#e7e9f2;box-shadow:none}.webix_scheduler_multilist .webix_scheduler_multiday_event{top:4px;left:1px}.webix_scheduler_multiday_event{cursor:pointer;position:absolute;border-radius:2px;border-left:3px solid;padding:0 8px;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:box-shadow .15s}.webix_scheduler_multiday_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_event_break_left.webix_scheduler_event_break_right:hover,.webix_scheduler_event_break_left.webix_scheduler_event_break_right.webix_scheduler_event_selected{box-shadow:3px 9px 5px -7px rgba(0,0,0,0.3),2px 8px 2px -7px rgba(0,0,0,0.2)}.webix_scheduler_event_name{display:inline-block;line-height:20px;font-weight:500;font-size:14px}.webix_scheduler_event_time{line-height:14px;margin-top:4px;font-size:12px}.webix_scheduler_scale .webix_list_item{cursor:default;padding:0;border-bottom-color:transparent;text-align:center}.webix_scheduler_inner_day{height:100%;overflow:hidden}.webix_scheduler_day_scroll{border-top-color:#edeff0;position:relative}.webix_scheduler_day_header .webix_template{font-weight:500;line-height:32px;text-align:center;padding:0 0 0 50px}.webix_scheduler_today_marker{z-index:2;position:absolute;background-color:#ea764f;width:100%;height:2px;margin-top:-1px;pointer-events:none}.webix_scheduler_today_marker:before{content:"";display:block;background:inherit;width:12px;height:12px;margin-top:-5px;border-radius:50%}.webix_scheduler_multilist .webix_drag_event.webix_list_item{box-shadow:none;background:transparent}.webix_scheduler_multilist .webix_drag_event.webix_list_item .webix_scheduler_multiday_event{box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_scheduler_day_header .webix_dataview_item{border-color:transparent;text-align:center;line-height:31px;padding:0;cursor:default}.webix_scheduler_day_header .webix_dataview_item .webix_scheduler_weekday{font-size:12px}.webix_scheduler_day_header .webix_dataview_item .webix_scheduler_monthday{font-size:16px;font-weight:500}.webix_scheduler_day_header .webix_dataview_item.webix_scheduler_list_today .webix_scheduler_monthday{width:22px;height:22px;line-height:22px}.webix_scheduler_week_days{border-top-color:#edeff0;position:relative}.webix_scheduler_week .webix_unit_header{color:#313131;border-color:transparent;font-weight:normal;line-height:28px}.webix_scheduler_week .webix_unit_header_inner{margin-right:8px}.webix_scheduler_week .webix_scheduler_monthday{font-size:16px;font-weight:500}.webix_scheduler_week .webix_scheduler_monthday.webix_scheduler_today{width:22px;height:22px;line-height:22px}.webix_scheduler_multidays{border-left-color:#edeff0;border-bottom-color:transparent}.webix_scheduler_multidays .webix_dataview_item{border-color:transparent;cursor:default}.webix_scheduler_multidays .webix_scheduler_multiday_event{font-weight:500}.webix_scheduler_multidays .webix_scheduler_multi_more{transition:background-color .3s;background-color:#f4f5f9;text-align:center;border:0}.webix_scheduler_multidays .webix_scheduler_multi_more:hover{background-color:#e7e9f2;box-shadow:none}.webix_drag_event .webix_scheduler_multiday_event:hover,.webix_noselect .webix_scheduler_multiday_event:hover{box-shadow:none}.webix_drag_event .webix_scheduler_multiday_event.webix_scheduler_multi_more,.webix_noselect .webix_scheduler_multiday_event.webix_scheduler_multi_more{background-color:#e7e9f2}.webix_scheduler_list_today .webix_scheduler_monthday,.webix_scheduler_monthday.webix_scheduler_today{display:inline-block;width:20px;height:20px;line-height:20px;border-radius:50%;border:1px solid #1ca1c1;text-align:center}.webix_cal_day_with_event .webix_cal_day_inner{position:relative}.webix_cal_day_with_event .webix_cal_day_inner::after{content:"";position:absolute;display:block;top:70%;left:50%;width:4px;height:4px;margin-left:-2px;border-radius:50%;background-color:#1ca1c1}.webix_cal_select.webix_cal_day_with_event .webix_cal_day_inner::after{background-color:#fff}.webix_cal_outside.webix_cal_day_with_event .webix_cal_day_inner::after{background-color:#94a1b3}.webix_scheduler_calendar .webix_cal_day{position:relative;padding:2px 0 0 2px;line-height:20px;font-size:14px;cursor:default}.webix_scheduler_calendar .webix_cal_day:nth-child(7n){border-right-color:transparent}.webix_scheduler_calendar .webix_cal_event{color:#1ca1c1;font-weight:normal}.webix_scheduler_calendar .webix_event_marker{width:16px;margin-right:2px}.webix_scheduler_calendar .webix_event_marker_inner{margin:0 3px;vertical-align:middle}.webix_scheduler_calendar .webix_cal_date{display:inline-block;line-height:24px;height:24px;width:24px;border:1px solid transparent;cursor:pointer;text-align:center;border-radius:50%}.webix_scheduler_calendar .webix_cal_date:hover{background-color:#f4f5f9;color:#1ca1c1;font-weight:500}.webix_scheduler_calendar .webix_cal_today .webix_cal_date{border-color:#1ca1c1}.webix_scheduler_calendar .webix_event_time{font-weight:500;margin-right:4px}.webix_drag_event .webix_scheduler_month_event:hover,.webix_noselect .webix_scheduler_month_event:hover{box-shadow:none}.webix_drag_event .webix_scheduler_month_event_single:hover,.webix_noselect .webix_scheduler_month_event_single:hover{background-color:transparent}.webix_drag_event.webix_scheduler_more_list .webix_scheduler_month_event,.webix_drag_event.webix_scheduler_more_list .webix_scheduler_month_event_single{width:100%}.webix_scheduler_calendar_header .webix_dataview_item{text-align:center;line-height:32px;border-color:transparent;cursor:default}.webix_scheduler_month_events{position:relative}.webix_scheduler_month_event,.webix_scheduler_month_event_single{z-index:1;position:absolute;box-sizing:border-box;border-radius:2px;padding:0 8px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;user-select:none;cursor:pointer}.webix_scheduler_month_event.webix_scheduler_past_event,.webix_scheduler_month_event_single.webix_scheduler_past_event{color:#8393a9}.webix_scheduler_month_event{border-left:3px solid;transition:box-shadow .15s}.webix_scheduler_month_event_single{transition:background .15s;padding:0 8px 0 4px}.webix_scheduler_month_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_month_event_single:hover{background-color:#f4f5f9}.webix_scheduler_more{display:inline-block;border-radius:20px;height:20px;width:auto;padding:0 8px;color:#475466;font-size:14px;font-weight:500;transition:background .15s;position:absolute;right:8px;top:5px}.webix_scheduler_more:hover{background-color:#f4f5f9}.webix_scheduler_more_list .webix_scheduler_month_event,.webix_scheduler_more_list .webix_scheduler_month_event_single{box-sizing:border-box;width:calc(100% - 8px);display:block;border-radius:2px;line-height:20px}.webix_scheduler_more_list .webix_scheduler_month_event{padding:4px 8px}.webix_scheduler_more_list .webix_scheduler_month_event .webix_event_text{width:100%;padding:0}.webix_scheduler_more_list .webix_scheduler_month_event_single{padding:4px 8px 4px 4px}.webix_scheduler_more_list .webix_scheduler_month_event_single .webix_event_text{width:calc(100% - 14px)}.webix_scheduler_more_list .webix_list_item{padding:4px;border:0}.webix_scheduler_more_list .webix_event_marker{float:left;height:40px;margin-right:4px}.webix_scheduler_more_list .webix_event_marker_inner{margin-top:4px}.webix_scheduler_more_list .webix_event_text{float:left;font-weight:500;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.webix_scheduler_more_list .webix_event_time{float:left;font-size:12px;line-height:16px;margin-top:4px}.webix_scheduler_month_event_single.webix_scheduler_event_selected{background-color:#f4f5f9;box-shadow:none}.webix_scheduler_event_break_left::before,.webix_scheduler_event_break_right::after{content:"";height:100%;display:block;position:absolute;top:0;box-sizing:border-box;border-top:12px solid transparent;border-bottom:12px solid transparent;border-right:8px solid}.webix_scheduler_event_break_left{border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0;padding-left:11px}.webix_scheduler_event_break_left::before{left:0;border-right-color:inherit;border-top-color:#fff;border-bottom-color:#fff}.webix_scheduler_event_break_right::after{right:0;border-right-color:#fff}.webix_scheduler_event_break_left:hover,.webix_scheduler_event_break_left.webix_scheduler_event_selected{box-shadow:6px 6px 5px -4px rgba(0,0,0,0.3),5px 5px 2px -4px rgba(0,0,0,0.2)}.webix_scheduler_event_break_right:hover,.webix_scheduler_event_break_right.webix_scheduler_event_selected{box-shadow:-1px 5px 5px -3px rgba(0,0,0,0.3),-2px 4px 2px -3px rgba(0,0,0,0.2)}.webix_drag_zone .webix_scheduler_event_break_left::before,.webix_drag_zone .webix_scheduler_event_break_right::after{visibility:hidden}.webix_drag_zone .webix_scheduler_event_break_left{border-radius:2px;border-left-width:3px;padding-left:8px}.webix_scheduler_dnd_1 .webix_scheduler_event_break_left::before{border-top-color:#f4f5f9;border-bottom-color:#f4f5f9}.webix_scheduler_dnd_n .webix_scheduler_event_break_right::after{border-right-color:#f4f5f9}.webix_scheduler_year{justify-content:space-evenly}.webix_scheduler_year .webix_cal_month,.webix_scheduler_year .webix_cal_month .webix_cal_month_name{cursor:pointer}.webix_scheduler_year .webix_cal_month:hover .webix_cal_month_name{color:#1ca1c1}.webix_scheduler_year .webix_cal_outside{visibility:hidden}.webix_scheduler_absbutton{border-radius:50%;z-index:91}.webix_scheduler_absbutton .webix_el_box{background-color:#1ca1c1}.webix_scheduler_absbutton .webix_el_box .webix_icon_button:hover:before{background-color:#1992af}.webix_scheduler_absbutton .webix_el_box .webix_icon{color:#fff}.webix_scheduler_navlist .webix_icon{color:#94a1b3}.webix_scheduler_navlist .webix_selected .webix_icon{color:#1ca1c1}.webix_scheduler_navlist .webix_list_item,.webix_scheduler_navlist .webix_list_item.webix_selected{border-bottom-color:transparent}.webix_scheduler_navlist .webix_list_item:hover,.webix_scheduler_navlist .webix_list_item.webix_selected:hover{background-color:#f4f5f9}.webix_scheduler_navlist .webix_list_item.webix_selected{color:#475466;background-color:#f4f5f9}.webix_scheduler_cal_list .webix_list_item{padding:2px 8px 2px 0}.webix_scheduler_cal_list .webix_list_item span{float:left}.webix_scheduler_cal_list .webix_list_item .webix_icon{line-height:inherit}.webix_scheduler_cal_list .webix_list_item:hover .webix_scheduler_cal_edit{color:#94a1b3}.webix_scheduler_cal_list .webix_list_item.webix_selected{box-shadow:none;padding:2px 8px 2px 0;background-color:transparent}.webix_scheduler_cal_list .webix_list_item.webix_selected .webix_scheduler_cal_edit{color:#1ca1c1}.webix_scheduler_cal_list .webix_list_item.webix_selected .webix_scheduler_cal_edit::before{content:""}.webix_scheduler_cal_list .webix_dt_editor input{padding-left:23px;border-color:transparent;border-bottom-color:#1ca1c1}.webix_scheduler_cal_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_active{margin-right:4px}.webix_scheduler_cal_title{overflow:hidden;width:calc(100% - 24px - 29px - 4px);white-space:nowrap;text-overflow:ellipsis}.webix_scheduler_cal_edit{color:transparent;font-size:18px;width:31px;line-height:31px;border-radius:50%}.webix_scheduler_cal_edit:hover{color:#1ca1c1;background-color:#f4f5f9}.webix_scheduler_cal_edit.webix_scheduler_cal_visible{color:#94a1b3}.webix_scheduler_settings .webix_template{padding:0;text-align:center;font-weight:500;line-height:38px}.webix_scheduler_settings .webix_template:hover{background-color:#f4f5f9}.webix_event_overall{padding:0 8px 0 20px;height:100%;line-height:49px;display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-align-items:center}.webix_event_overall.webix_scheduler_past_event{color:#8393a9}.webix_event_overall.webix_scheduler_past_event .webix_event_time .end{color:#8393a9}.webix_event_overall .webix_event_time{flex-basis:70px;flex-shrink:0;display:block;text-align:center}.webix_event_overall .webix_event_time .start,.webix_event_overall .webix_event_time .end{font-size:12px;line-height:16px}.webix_event_overall .webix_event_time .end{color:#94a1b3}.webix_list_item .webix_event_text{padding-left:10px;display:block;-webkit-box-flex:1;-webkit-flex:1;flex:1;white-space:nowrap;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis}.webix_event_marker{display:inline-block;width:10px}.webix_event_marker_inner{display:inline-block;border-radius:50%;width:10px;height:10px}.webix_scheduler_event_selected{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_multi_space{text-align:center}.webix_scheduler_multi_space .webix_template{padding:0}.webix_scheduler_multi_space .webix_scheduler_more_icon{cursor:pointer;color:#94a1b3;transition:color .3s;position:relative;top:calc(100% - 26px);height:26px;width:26px}.webix_scheduler_multi_space .webix_scheduler_more_icon:hover{color:#475466}.webix_scheduler_multi_space .webix_scheduler_more_icon:after{content:"";transition:background-color .3s;height:26px;width:26px;border-radius:50%;position:absolute;top:-4px;left:0;z-index:-1}.webix_scheduler_multi_space .webix_scheduler_more_icon:hover:after{background-color:rgba(148,161,179,0.1)}.webix_scheduler_agenda .webix_scroll_cont{padding-left:120px}.webix_scheduler_agenda .webix_list_item{border-color:transparent;padding:0;width:calc(100% - 120px) !important}.webix_scheduler_agenda .webix_event_overall{line-height:40px;height:40px}.webix_scheduler_agenda .webix_event_overall:hover{background-color:#f4f5f9}.webix_scheduler_agenda .webix_event_overall.webix_scheduler_past_event{color:#8393a9}.webix_scheduler_agenda .webix_event_first{padding-top:8px}.webix_scheduler_agenda .webix_event_last{padding-bottom:8px}.webix_scheduler_agenda .webix_event_last:not(:last-child){border-color:#edeff0}.webix_scheduler_agenda .webix_agenda_selected{background-color:#f4f5f9}.webix_scheduler_agenda .webix_unit_header{float:left;margin-left:-120px;width:120px !important;background-color:transparent;border-bottom-width:0;line-height:18px;padding:6px 8px;box-sizing:border-box}.webix_scheduler_agenda .webix_unit_header:not(:first-child){border-top:1px solid #edeff0;margin-top:-1px}.webix_scheduler_agenda .webix_unit_header .webix_scheduler_dayofweek{color:#94a1b3;font-weight:normal;font-size:12px}.webix_scheduler_timeline_scale .webix_template{padding:0}.webix_scheduler_timeline_scale_row{display:flex;box-sizing:border-box}.webix_scheduler_timeline_scale_row:not(:last-child){border-bottom:1px solid #dadee0}.webix_scheduler_timeline_scale_cell{display:flex;flex:0 0 auto;justify-content:center;align-items:center;border-right:1px solid #dadee0;box-sizing:border-box;background-color:#f4f5f9}.webix_scheduler_timeline_event{position:absolute;box-sizing:border-box;border-radius:2px;color:#fff;cursor:pointer;border-left:3px solid;transition:box-shadow .15s;overflow:hidden}.webix_scheduler_timeline_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_timeline_content{text-align:center;line-height:30px;position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;user-select:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 12px}.webix_scheduler_timeline_task .webix_scheduler_timeline_content{padding:0 32px}.webix_scheduler_timeline_bars .webix_list_item,.webix_scheduler_timeline_sections .webix_cell{border-color:#dadee0;text-overflow:ellipsis}.webix_scheduler_timeline_bars .webix_list_item{cursor:default}.webix_scheduler_timeline_sections .webix_c_scroll_y div{color:transparent;background-color:transparent}.webix_scheduler_timeline_space{background-color:#f4f5f9}.webix_scheduler_timeline_event.webix_scheduler_multi_more{transition:background-color .3s;background-color:#f4f5f9}.webix_scheduler_timeline_event.webix_scheduler_multi_more .webix_scheduler_timeline_content{text-align:left;color:#475466}.webix_scheduler_timeline_event.webix_scheduler_multi_more:hover{background-color:#e7e9f2;box-shadow:none}.webix_scheduler_timeline_event.webix_scheduler_event_break_left{border-left-width:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.webix_scheduler_timeline_event.webix_scheduler_event_break_left:hover{box-shadow:6px 6px 5px -4px rgba(0,0,0,0.2),5px 5px 2px -4px rgba(0,0,0,0.2)}.webix_scheduler_timeline_event.webix_scheduler_event_break_right:hover{box-shadow:-1px 5px 5px -3px rgba(0,0,0,0.3),-2px 4px 2px -3px rgba(0,0,0,0.2)}.webix_scheduler_copy.webix_scheduler_day_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_day_event,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_month_event,.webix_scheduler_copy.webix_scheduler_multiday_event,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_timeline_event{box-shadow:2px 2px 5px #1ca1c1,1px 1px 2px #1ca1c1}.webix_scheduler_copy.webix_scheduler_multiday_event.webix_scheduler_event_break_right,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_break_right,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_break_right{box-shadow:3px 9px 5px -7px #1ca1c1,-6px 9px 3px -7px #1ca1c1}.webix_scheduler_copy.webix_scheduler_multiday_event.webix_scheduler_event_break_left,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_break_left,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_break_left{box-shadow:3px 9px 5px -7px #1ca1c1,2px 8px 2px -7px #1ca1c1}.webix_scheduler_copy .webix_scheduler_multiday_event.webix_scheduler_event_break_right{box-shadow:3px 9px 5px -7px #1ca1c1,-6px 9px 3px -7px #1ca1c1}.webix_scheduler_copy .webix_scheduler_multiday_event.webix_scheduler_event_break_left{box-shadow:3px 9px 5px -7px #1ca1c1,2px 8px 2px -7px #1ca1c1}.webix_scheduler_cut{opacity:.5}.webix_scheduler_month_event_single.webix_scheduler_event_selected.webix_scheduler_copy,.webix_scheduler_month_event_single.webix_scheduler_copy{background-color:rgba(28,161,193,0.2)}.webix_scheduler_paste_target{box-shadow:inset 0 2px 0 0 #1ca1c1,inset 0 -2px 0 0 #1ca1c1}.webix_scheduler_clipboard_target.webix_scheduler_calendar .webix_cal_day,.webix_scheduler_clipboard_target.webix_scheduler_timeline_bars .webix_list_item,.webix_scheduler_clipboard_target.webix_scheduler_day_events .webix_list_item,.webix_scheduler_clipboard_target.webix_scheduler_multilist{cursor:pointer}.webix_scheduler .webix_progress_top{z-index:10000}.webix_scheduler_action_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_sidemenu{z-index:1 !important}.webix_toolbar.webix_scheduler_toolbar .webix_view,.webix_toolbar.webix_scheduler_toolbar .webix_control.webix_el_tabbar{background-color:transparent}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab{background:transparent;color:#fff}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab:hover{background-color:rgba(0,0,0,0.2)}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab.webix_selected,.webix_toolbar.webix_scheduler_toolbar .webix_item_tab.webix_selected:focus{color:#fff;box-shadow:inset 0 -2px #fff}.webix_scheduler_cal_title{width:calc(100% - 24px - 31px - 4px)}.webix_scheduler_danger .webix_button{color:#ff5c4c;background-color:#fff1ef}.webix_scheduler_danger .webix_button:hover,.webix_scheduler_danger .webix_button:focus{background-color:#ffe7e5}.webix_scheduler_danger .webix_button:active{background-color:#ffdedb}.webix_scheduler_checkbox_allday .webix_custom_checkbox::before{margin-left:-2px}',"",{version:3,sources:["webpack://./js/webix/components/scheduler/scheduler.min.css"],names:[],mappings:"AAAA,gBAAgB,CAAC,WAAW,+BAA+B,CAAC,2GAA2G,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,0CAA0C,+BAA+B,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,aAAa,CAAC,kCAAkC,CAAC,iCAAiC,CAAC,wBAAwB,CAAC,mBAAmB,WAAW,CAAC,gBAAgB,WAAW,CAAC,kBAAkB,WAAW,CAAC,iBAAiB,WAAW,CAAC,iBAAiB,WAAW,CAAC,iBAAiB,WAAW,CAAC,qBAAqB,WAAW,CAAC,kBAAkB,WAAW,CAAC,yBAAyB,WAAW,CAAC,iBAAiB,WAAW,CAAC,sCAAsC,aAAa,CAAC,iBAAiB,CAAC,mEAAmE,aAAa,CAAC,eAAe,CAAC,cAAc,CAAC,kBAAkB,CAAC,oJAAoJ,kBAAkB,CAAC,gBAAgB,CAAC,oJAAoJ,aAAa,CAAC,eAAe,CAAC,kBAAkB,CAAC,kEAAkE,gBAAgB,CAAC,mEAAmE,kBAAkB,CAAC,oGAAoG,oBAAoB,CAAC,gBAAgB,CAAC,6BAA6B,eAAe,CAAC,kBAAkB,CAAC,4DAA4D,eAAe,CAAC,aAAa,CAAC,6CAA6C,kBAAkB,CAAC,uHAAuH,iBAAiB,CAAC,kBAAkB,CAAC,+DAA+D,SAAS,CAAC,4BAA4B,aAAa,CAAC,UAAU,CAAC,WAAW,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,UAAU,CAAC,OAAO,CAAC,gBAAgB,CAAC,kDAAkD,uBAAuB,CAAC,+BAA+B,gBAAgB,CAAC,+CAA+C,+BAA+B,CAAC,8BAA8B,aAAa,CAAC,+DAA+D,UAAU,CAAC,4BAA4B,oBAAoB,CAAC,iBAAiB,CAAC,6CAA6C,SAAS,CAAC,cAAc,CAAC,SAAS,CAAC,2BAA2B,oBAAoB,CAAC,eAAe,CAAC,cAAc,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,qBAAqB,CAAC,0BAA0B,CAAC,iCAAiC,SAAS,CAAC,kEAAkE,CAAC,0DAA0D,kBAAkB,CAAC,8IAA8I,gBAAgB,CAAC,0CAA0C,iBAAiB,CAAC,kEAAkE,CAAC,uGAAuG,eAAe,CAAC,yJAAyJ,iBAAiB,CAAC,kGAAkG,kBAAkB,CAAC,oBAAoB,iBAAiB,CAAC,kEAAkE,CAAC,6CAA6C,kBAAkB,CAAC,yBAAyB,iBAAiB,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,cAAc,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,iCAAiC,WAAW,CAAC,uBAAuB,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,2BAA2B,yBAAyB,CAAC,+BAA+B,CAAC,4CAA4C,cAAc,CAAC,SAAS,CAAC,kBAAkB,CAAC,eAAe,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,uFAAuF,+BAA+B,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,6FAA6F,wBAAwB,CAAC,eAAe,CAAC,2DAA2D,OAAO,CAAC,QAAQ,CAAC,gCAAgC,cAAc,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,aAAa,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,eAAe,CAAC,sBAAsB,CAAC,0BAA0B,CAAC,sCAAsC,kEAAkE,CAAC,6KAA6K,4EAA4E,CAAC,4BAA4B,oBAAoB,CAAC,gBAAgB,CAAC,eAAe,CAAC,cAAc,CAAC,4BAA4B,gBAAgB,CAAC,cAAc,CAAC,cAAc,CAAC,wCAAwC,cAAc,CAAC,SAAS,CAAC,+BAA+B,CAAC,iBAAiB,CAAC,2BAA2B,WAAW,CAAC,eAAe,CAAC,4BAA4B,wBAAwB,CAAC,iBAAiB,CAAC,4CAA4C,eAAe,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,8BAA8B,SAAS,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,UAAU,CAAC,UAAU,CAAC,eAAe,CAAC,mBAAmB,CAAC,qCAAqC,UAAU,CAAC,aAAa,CAAC,kBAAkB,CAAC,UAAU,CAAC,WAAW,CAAC,eAAe,CAAC,iBAAiB,CAAC,6DAA6D,eAAe,CAAC,sBAAsB,CAAC,6FAA6F,kEAAkE,CAAC,iDAAiD,wBAAwB,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,SAAS,CAAC,cAAc,CAAC,0EAA0E,cAAc,CAAC,2EAA2E,cAAc,CAAC,eAAe,CAAC,sGAAsG,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,2BAA2B,wBAAwB,CAAC,iBAAiB,CAAC,yCAAyC,aAAa,CAAC,wBAAwB,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,+CAA+C,gBAAgB,CAAC,gDAAgD,cAAc,CAAC,eAAe,CAAC,sEAAsE,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,2BAA2B,yBAAyB,CAAC,+BAA+B,CAAC,gDAAgD,wBAAwB,CAAC,cAAc,CAAC,2DAA2D,eAAe,CAAC,uDAAuD,+BAA+B,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,6DAA6D,wBAAwB,CAAC,eAAe,CAAC,8GAA8G,eAAe,CAAC,wJAAwJ,wBAAwB,CAAC,sGAAsG,oBAAoB,CAAC,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,+CAA+C,iBAAiB,CAAC,sDAAsD,UAAU,CAAC,iBAAiB,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,uEAAuE,qBAAqB,CAAC,wEAAwE,wBAAwB,CAAC,yCAAyC,iBAAiB,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,cAAc,CAAC,cAAc,CAAC,uDAAuD,8BAA8B,CAAC,2CAA2C,aAAa,CAAC,kBAAkB,CAAC,8CAA8C,UAAU,CAAC,gBAAgB,CAAC,oDAAoD,YAAY,CAAC,qBAAqB,CAAC,0CAA0C,oBAAoB,CAAC,gBAAgB,CAAC,WAAW,CAAC,UAAU,CAAC,4BAA4B,CAAC,cAAc,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,gDAAgD,wBAAwB,CAAC,aAAa,CAAC,eAAe,CAAC,2DAA2D,oBAAoB,CAAC,4CAA4C,eAAe,CAAC,gBAAgB,CAAC,wGAAwG,eAAe,CAAC,sHAAsH,4BAA4B,CAAC,yJAAyJ,UAAU,CAAC,sDAAsD,iBAAiB,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,cAAc,CAAC,8BAA8B,iBAAiB,CAAC,iEAAiE,SAAS,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,aAAa,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,eAAe,CAAC,gBAAgB,CAAC,cAAc,CAAC,uHAAuH,aAAa,CAAC,6BAA6B,qBAAqB,CAAC,0BAA0B,CAAC,oCAAoC,0BAA0B,CAAC,mBAAmB,CAAC,mCAAmC,kEAAkE,CAAC,0CAA0C,wBAAwB,CAAC,sBAAsB,oBAAoB,CAAC,kBAAkB,CAAC,WAAW,CAAC,UAAU,CAAC,aAAa,CAAC,aAAa,CAAC,cAAc,CAAC,eAAe,CAAC,0BAA0B,CAAC,iBAAiB,CAAC,SAAS,CAAC,OAAO,CAAC,4BAA4B,wBAAwB,CAAC,uHAAuH,qBAAqB,CAAC,sBAAsB,CAAC,aAAa,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,wDAAwD,eAAe,CAAC,0EAA0E,UAAU,CAAC,SAAS,CAAC,+DAA+D,uBAAuB,CAAC,iFAAiF,uBAAuB,CAAC,4CAA4C,WAAW,CAAC,QAAQ,CAAC,+CAA+C,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,qDAAqD,cAAc,CAAC,6CAA6C,UAAU,CAAC,eAAe,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,eAAe,CAAC,6CAA6C,UAAU,CAAC,cAAc,CAAC,gBAAgB,CAAC,cAAc,CAAC,mEAAmE,wBAAwB,CAAC,eAAe,CAAC,oFAAoF,UAAU,CAAC,WAAW,CAAC,aAAa,CAAC,iBAAiB,CAAC,KAAK,CAAC,qBAAqB,CAAC,iCAAiC,CAAC,oCAAoC,CAAC,sBAAsB,CAAC,kCAAkC,wBAAwB,CAAC,2BAA2B,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,0CAA0C,MAAM,CAAC,0BAA0B,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,0CAA0C,OAAO,CAAC,uBAAuB,CAAC,yGAAyG,4EAA4E,CAAC,2GAA2G,8EAA8E,CAAC,sHAAsH,iBAAiB,CAAC,mDAAmD,iBAAiB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,iEAAiE,wBAAwB,CAAC,2BAA2B,CAAC,iEAAiE,0BAA0B,CAAC,sBAAsB,4BAA4B,CAAC,oGAAoG,cAAc,CAAC,mEAAmE,aAAa,CAAC,yCAAyC,iBAAiB,CAAC,2BAA2B,iBAAiB,CAAC,UAAU,CAAC,yCAAyC,wBAAwB,CAAC,yEAAyE,wBAAwB,CAAC,qDAAqD,UAAU,CAAC,qCAAqC,aAAa,CAAC,qDAAqD,aAAa,CAAC,mGAAmG,+BAA+B,CAAC,+GAA+G,wBAAwB,CAAC,yDAAyD,aAAa,CAAC,wBAAwB,CAAC,2CAA2C,qBAAqB,CAAC,gDAAgD,UAAU,CAAC,uDAAuD,mBAAmB,CAAC,2EAA2E,aAAa,CAAC,0DAA0D,eAAe,CAAC,qBAAqB,CAAC,4BAA4B,CAAC,oFAAoF,aAAa,CAAC,4FAA4F,WAAW,CAAC,iDAAiD,iBAAiB,CAAC,wBAAwB,CAAC,2BAA2B,CAAC,2CAA2C,+BAA+B,CAAC,wBAAwB,gBAAgB,CAAC,2BAA2B,eAAe,CAAC,oCAAoC,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,0BAA0B,iBAAiB,CAAC,cAAc,CAAC,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,gCAAgC,aAAa,CAAC,wBAAwB,CAAC,sDAAsD,aAAa,CAAC,0CAA0C,SAAS,CAAC,iBAAiB,CAAC,eAAe,CAAC,gBAAgB,CAAC,gDAAgD,wBAAwB,CAAC,qBAAqB,oBAAoB,CAAC,WAAW,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,oBAAoB,CAAC,YAAY,CAAC,0BAA0B,CAAC,gDAAgD,aAAa,CAAC,uEAAuE,aAAa,CAAC,uCAAuC,eAAe,CAAC,aAAa,CAAC,aAAa,CAAC,iBAAiB,CAAC,0FAA0F,cAAc,CAAC,gBAAgB,CAAC,4CAA4C,aAAa,CAAC,mCAAmC,iBAAiB,CAAC,aAAa,CAAC,kBAAkB,CAAC,cAAc,CAAC,MAAM,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,eAAe,CAAC,sBAAsB,CAAC,oBAAoB,oBAAoB,CAAC,UAAU,CAAC,0BAA0B,oBAAoB,CAAC,iBAAiB,CAAC,UAAU,CAAC,WAAW,CAAC,gCAAgC,kEAAkE,CAAC,6BAA6B,iBAAiB,CAAC,6CAA6C,SAAS,CAAC,wDAAwD,cAAc,CAAC,aAAa,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,WAAW,CAAC,UAAU,CAAC,8DAA8D,aAAa,CAAC,8DAA8D,UAAU,CAAC,+BAA+B,CAAC,WAAW,CAAC,UAAU,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,oEAAoE,sCAAsC,CAAC,2CAA2C,kBAAkB,CAAC,yCAAyC,wBAAwB,CAAC,SAAS,CAAC,mCAAmC,CAAC,6CAA6C,gBAAgB,CAAC,WAAW,CAAC,mDAAmD,wBAAwB,CAAC,wEAAwE,aAAa,CAAC,2CAA2C,eAAe,CAAC,0CAA0C,kBAAkB,CAAC,2DAA2D,oBAAoB,CAAC,+CAA+C,wBAAwB,CAAC,2CAA2C,UAAU,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,4BAA4B,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,eAAe,CAAC,qBAAqB,CAAC,6DAA6D,4BAA4B,CAAC,eAAe,CAAC,sEAAsE,aAAa,CAAC,kBAAkB,CAAC,cAAc,CAAC,gDAAgD,SAAS,CAAC,oCAAoC,YAAY,CAAC,qBAAqB,CAAC,qDAAqD,+BAA+B,CAAC,qCAAqC,YAAY,CAAC,aAAa,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,8BAA8B,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,gCAAgC,iBAAiB,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,UAAU,CAAC,cAAc,CAAC,qBAAqB,CAAC,0BAA0B,CAAC,eAAe,CAAC,sCAAsC,kEAAkE,CAAC,kCAAkC,iBAAiB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC,eAAe,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,cAAc,CAAC,iEAAiE,cAAc,CAAC,+FAA+F,oBAAoB,CAAC,sBAAsB,CAAC,gDAAgD,cAAc,CAAC,yDAAyD,iBAAiB,CAAC,4BAA4B,CAAC,gCAAgC,wBAAwB,CAAC,2DAA2D,+BAA+B,CAAC,wBAAwB,CAAC,6FAA6F,eAAe,CAAC,aAAa,CAAC,iEAAiE,wBAAwB,CAAC,eAAe,CAAC,iEAAiE,mBAAmB,CAAC,wBAAwB,CAAC,2BAA2B,CAAC,mBAAmB,CAAC,uEAAuE,4EAA4E,CAAC,wEAAwE,8EAA8E,CAAC,gcAAgc,kDAAkD,CAAC,kQAAkQ,6DAA6D,CAAC,+PAA+P,4DAA4D,CAAC,wFAAwF,6DAA6D,CAAC,uFAAuF,4DAA4D,CAAC,qBAAqB,UAAU,CAAC,iJAAiJ,qCAAqC,CAAC,8BAA8B,2DAA2D,CAAC,qSAAqS,cAAc,CAAC,qCAAqC,aAAa,CAAC,8CAA8C,+BAA+B,CAAC,0BAA0B,oBAAoB,CAAC,yHAAyH,4BAA4B,CAAC,uDAAuD,sBAAsB,CAAC,UAAU,CAAC,6DAA6D,gCAAgC,CAAC,kJAAkJ,UAAU,CAAC,4BAA4B,CAAC,2BAA2B,oCAAoC,CAAC,sCAAsC,aAAa,CAAC,wBAAwB,CAAC,wFAAwF,wBAAwB,CAAC,6CAA6C,wBAAwB,CAAC,gEAAgE,gBAAgB",sourcesContent:['@charset "UTF-8";@font-face{font-family:"scheduler-webfont";src:url("fonts/scheduler-webfont.woff2") format("woff2"),url("fonts/scheduler-webfont.woff") format("woff");font-weight:normal;font-style:normal}[class^=shi-]:before,[class*=shi-]:before{font-family:"scheduler-webfont";display:inline-block;font-style:normal;font-weight:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;transform:translate(0,0)}.shi-agenda:before{content:""}.shi-day:before{content:""}.shi-month:before{content:""}.shi-week:before{content:""}.shi-back:before{content:""}.shi-menu:before{content:""}.shi-timeline:before{content:""}.shi-units:before{content:""}.shi-content-copy:before{content:""}.shi-year:before{content:""}.webix_scheduler_info .webix_template{overflow:auto;padding:0 0 0 2px}.webix_scheduler_info .webix_template .webix_scheduler_event_title{color:#313131;font-weight:500;margin-top:7px;margin-bottom:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_from_to,.webix_scheduler_info .webix_template .webix_scheduler_event_recurring_pattern{margin-bottom:20px;line-height:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_details_title,.webix_scheduler_info .webix_template .webix_scheduler_event_units_title{color:#313131;font-weight:500;margin-bottom:10px}.webix_scheduler_info .webix_template .webix_scheduler_event_text{line-height:20px}.webix_scheduler_info .webix_template .webix_scheduler_event_units{margin-bottom:10px}.webix_scheduler_info .webix_template .webix_scheduler_event_units .webix_scheduler_event_unit_item{display:inline-block;margin-right:6px}.webix_scheduler_section_tpl{margin-top:20px;margin-bottom:20px}.webix_scheduler_section_tpl .webix_scheduler_section_title{font-weight:500;color:#313131}.webix_scheduler_cal_color .webix_inp_static{padding-right:50px}.webix_scheduler_cal_color_suggest .webix_list_item,.webix_scheduler_cal_color_suggest .webix_list_item.webix_selected{position:relative;padding-right:32px}.webix_scheduler_cal_color_suggest .webix_scheduler_cal_marker{right:4px}.webix_scheduler_cal_marker{display:block;width:24px;height:24px;border-radius:2px;position:absolute;right:26px;top:50%;margin-top:-12px}.webix_scheduler_counter .webix_inp_counter_value{width:calc(100% - 60px)}.webix_scheduler_subform_popup{border-width:1px}.webix_scheduler_subform_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_cal_disabled{color:#94a1b3}.webix_scheduler_cal_disabled .webix_scheduler_calendar_marker{opacity:.6}.webix_scheduler_day_events{border-color:#edeff0;position:relative}.webix_scheduler_day_events .webix_list_item{padding:0;cursor:default;padding:0}.webix_scheduler_day_event{padding:8px 8px 16px;overflow:hidden;cursor:pointer;position:absolute;border-radius:2px;border-left:3px solid;box-sizing:border-box;transition:box-shadow .15s}.webix_scheduler_day_event:hover{z-index:1;box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_day_event:hover .webix_scheduler_resizer{visibility:visible}.webix_active_resize .webix_scheduler_day_events .webix_scheduler_day_event,.webix_active_resize .webix_scheduler_day_events .webix_list_item{cursor:ns-resize}.webix_drag_event,.webix_drag_event:hover{border-radius:2px;box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_active_resize .webix_scheduler_day_event:hover,.webix_noselect .webix_scheduler_day_event:hover{box-shadow:none}.webix_active_resize .webix_scheduler_day_event:hover .webix_scheduler_resizer,.webix_noselect .webix_scheduler_day_event:hover .webix_scheduler_resizer{visibility:hidden}.webix_active_resize .webix_scheduler_day_event.webix_resize_event:hover .webix_scheduler_resizer{visibility:visible}.webix_resize_event{border-radius:2px;box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_resize_event .webix_scheduler_resizer{visibility:visible}.webix_scheduler_resizer{position:absolute;bottom:0;left:0;width:100%;height:16px;font-size:16px;visibility:hidden;cursor:ns-resize}.webix_scheduler_resizer::before{content:"";transform:rotate(90deg);position:absolute;margin-left:-10px}.webix_scheduler_multilist{border-left-color:#edeff0;border-bottom-color:transparent}.webix_scheduler_multilist .webix_list_item{cursor:default;padding:0;line-height:normal;font-weight:500;position:relative;border-color:transparent}.webix_scheduler_multilist .webix_scheduler_multi_more .webix_scheduler_multiday_event{transition:background-color .3s;background-color:#f4f5f9;text-align:center;border:0}.webix_scheduler_multilist .webix_scheduler_multi_more .webix_scheduler_multiday_event:hover{background-color:#e7e9f2;box-shadow:none}.webix_scheduler_multilist .webix_scheduler_multiday_event{top:4px;left:1px}.webix_scheduler_multiday_event{cursor:pointer;position:absolute;border-radius:2px;border-left:3px solid;padding:0 8px;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:box-shadow .15s}.webix_scheduler_multiday_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_event_break_left.webix_scheduler_event_break_right:hover,.webix_scheduler_event_break_left.webix_scheduler_event_break_right.webix_scheduler_event_selected{box-shadow:3px 9px 5px -7px rgba(0,0,0,0.3),2px 8px 2px -7px rgba(0,0,0,0.2)}.webix_scheduler_event_name{display:inline-block;line-height:20px;font-weight:500;font-size:14px}.webix_scheduler_event_time{line-height:14px;margin-top:4px;font-size:12px}.webix_scheduler_scale .webix_list_item{cursor:default;padding:0;border-bottom-color:transparent;text-align:center}.webix_scheduler_inner_day{height:100%;overflow:hidden}.webix_scheduler_day_scroll{border-top-color:#edeff0;position:relative}.webix_scheduler_day_header .webix_template{font-weight:500;line-height:32px;text-align:center;padding:0 0 0 50px}.webix_scheduler_today_marker{z-index:2;position:absolute;background-color:#ea764f;width:100%;height:2px;margin-top:-1px;pointer-events:none}.webix_scheduler_today_marker:before{content:"";display:block;background:inherit;width:12px;height:12px;margin-top:-5px;border-radius:50%}.webix_scheduler_multilist .webix_drag_event.webix_list_item{box-shadow:none;background:transparent}.webix_scheduler_multilist .webix_drag_event.webix_list_item .webix_scheduler_multiday_event{box-shadow:3px 3px 7px rgba(0,0,0,0.3),2px 2px 4px rgba(0,0,0,0.2)}.webix_scheduler_day_header .webix_dataview_item{border-color:transparent;text-align:center;line-height:31px;padding:0;cursor:default}.webix_scheduler_day_header .webix_dataview_item .webix_scheduler_weekday{font-size:12px}.webix_scheduler_day_header .webix_dataview_item .webix_scheduler_monthday{font-size:16px;font-weight:500}.webix_scheduler_day_header .webix_dataview_item.webix_scheduler_list_today .webix_scheduler_monthday{width:22px;height:22px;line-height:22px}.webix_scheduler_week_days{border-top-color:#edeff0;position:relative}.webix_scheduler_week .webix_unit_header{color:#313131;border-color:transparent;font-weight:normal;line-height:28px}.webix_scheduler_week .webix_unit_header_inner{margin-right:8px}.webix_scheduler_week .webix_scheduler_monthday{font-size:16px;font-weight:500}.webix_scheduler_week .webix_scheduler_monthday.webix_scheduler_today{width:22px;height:22px;line-height:22px}.webix_scheduler_multidays{border-left-color:#edeff0;border-bottom-color:transparent}.webix_scheduler_multidays .webix_dataview_item{border-color:transparent;cursor:default}.webix_scheduler_multidays .webix_scheduler_multiday_event{font-weight:500}.webix_scheduler_multidays .webix_scheduler_multi_more{transition:background-color .3s;background-color:#f4f5f9;text-align:center;border:0}.webix_scheduler_multidays .webix_scheduler_multi_more:hover{background-color:#e7e9f2;box-shadow:none}.webix_drag_event .webix_scheduler_multiday_event:hover,.webix_noselect .webix_scheduler_multiday_event:hover{box-shadow:none}.webix_drag_event .webix_scheduler_multiday_event.webix_scheduler_multi_more,.webix_noselect .webix_scheduler_multiday_event.webix_scheduler_multi_more{background-color:#e7e9f2}.webix_scheduler_list_today .webix_scheduler_monthday,.webix_scheduler_monthday.webix_scheduler_today{display:inline-block;width:20px;height:20px;line-height:20px;border-radius:50%;border:1px solid #1ca1c1;text-align:center}.webix_cal_day_with_event .webix_cal_day_inner{position:relative}.webix_cal_day_with_event .webix_cal_day_inner::after{content:"";position:absolute;display:block;top:70%;left:50%;width:4px;height:4px;margin-left:-2px;border-radius:50%;background-color:#1ca1c1}.webix_cal_select.webix_cal_day_with_event .webix_cal_day_inner::after{background-color:#fff}.webix_cal_outside.webix_cal_day_with_event .webix_cal_day_inner::after{background-color:#94a1b3}.webix_scheduler_calendar .webix_cal_day{position:relative;padding:2px 0 0 2px;line-height:20px;font-size:14px;cursor:default}.webix_scheduler_calendar .webix_cal_day:nth-child(7n){border-right-color:transparent}.webix_scheduler_calendar .webix_cal_event{color:#1ca1c1;font-weight:normal}.webix_scheduler_calendar .webix_event_marker{width:16px;margin-right:2px}.webix_scheduler_calendar .webix_event_marker_inner{margin:0 3px;vertical-align:middle}.webix_scheduler_calendar .webix_cal_date{display:inline-block;line-height:24px;height:24px;width:24px;border:1px solid transparent;cursor:pointer;text-align:center;border-radius:50%}.webix_scheduler_calendar .webix_cal_date:hover{background-color:#f4f5f9;color:#1ca1c1;font-weight:500}.webix_scheduler_calendar .webix_cal_today .webix_cal_date{border-color:#1ca1c1}.webix_scheduler_calendar .webix_event_time{font-weight:500;margin-right:4px}.webix_drag_event .webix_scheduler_month_event:hover,.webix_noselect .webix_scheduler_month_event:hover{box-shadow:none}.webix_drag_event .webix_scheduler_month_event_single:hover,.webix_noselect .webix_scheduler_month_event_single:hover{background-color:transparent}.webix_drag_event.webix_scheduler_more_list .webix_scheduler_month_event,.webix_drag_event.webix_scheduler_more_list .webix_scheduler_month_event_single{width:100%}.webix_scheduler_calendar_header .webix_dataview_item{text-align:center;line-height:32px;border-color:transparent;cursor:default}.webix_scheduler_month_events{position:relative}.webix_scheduler_month_event,.webix_scheduler_month_event_single{z-index:1;position:absolute;box-sizing:border-box;border-radius:2px;padding:0 8px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;user-select:none;cursor:pointer}.webix_scheduler_month_event.webix_scheduler_past_event,.webix_scheduler_month_event_single.webix_scheduler_past_event{color:#8393a9}.webix_scheduler_month_event{border-left:3px solid;transition:box-shadow .15s}.webix_scheduler_month_event_single{transition:background .15s;padding:0 8px 0 4px}.webix_scheduler_month_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_month_event_single:hover{background-color:#f4f5f9}.webix_scheduler_more{display:inline-block;border-radius:20px;height:20px;width:auto;padding:0 8px;color:#475466;font-size:14px;font-weight:500;transition:background .15s;position:absolute;right:8px;top:5px}.webix_scheduler_more:hover{background-color:#f4f5f9}.webix_scheduler_more_list .webix_scheduler_month_event,.webix_scheduler_more_list .webix_scheduler_month_event_single{box-sizing:border-box;width:calc(100% - 8px);display:block;border-radius:2px;line-height:20px}.webix_scheduler_more_list .webix_scheduler_month_event{padding:4px 8px}.webix_scheduler_more_list .webix_scheduler_month_event .webix_event_text{width:100%;padding:0}.webix_scheduler_more_list .webix_scheduler_month_event_single{padding:4px 8px 4px 4px}.webix_scheduler_more_list .webix_scheduler_month_event_single .webix_event_text{width:calc(100% - 14px)}.webix_scheduler_more_list .webix_list_item{padding:4px;border:0}.webix_scheduler_more_list .webix_event_marker{float:left;height:40px;margin-right:4px}.webix_scheduler_more_list .webix_event_marker_inner{margin-top:4px}.webix_scheduler_more_list .webix_event_text{float:left;font-weight:500;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.webix_scheduler_more_list .webix_event_time{float:left;font-size:12px;line-height:16px;margin-top:4px}.webix_scheduler_month_event_single.webix_scheduler_event_selected{background-color:#f4f5f9;box-shadow:none}.webix_scheduler_event_break_left::before,.webix_scheduler_event_break_right::after{content:"";height:100%;display:block;position:absolute;top:0;box-sizing:border-box;border-top:12px solid transparent;border-bottom:12px solid transparent;border-right:8px solid}.webix_scheduler_event_break_left{border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0;padding-left:11px}.webix_scheduler_event_break_left::before{left:0;border-right-color:inherit;border-top-color:#fff;border-bottom-color:#fff}.webix_scheduler_event_break_right::after{right:0;border-right-color:#fff}.webix_scheduler_event_break_left:hover,.webix_scheduler_event_break_left.webix_scheduler_event_selected{box-shadow:6px 6px 5px -4px rgba(0,0,0,0.3),5px 5px 2px -4px rgba(0,0,0,0.2)}.webix_scheduler_event_break_right:hover,.webix_scheduler_event_break_right.webix_scheduler_event_selected{box-shadow:-1px 5px 5px -3px rgba(0,0,0,0.3),-2px 4px 2px -3px rgba(0,0,0,0.2)}.webix_drag_zone .webix_scheduler_event_break_left::before,.webix_drag_zone .webix_scheduler_event_break_right::after{visibility:hidden}.webix_drag_zone .webix_scheduler_event_break_left{border-radius:2px;border-left-width:3px;padding-left:8px}.webix_scheduler_dnd_1 .webix_scheduler_event_break_left::before{border-top-color:#f4f5f9;border-bottom-color:#f4f5f9}.webix_scheduler_dnd_n .webix_scheduler_event_break_right::after{border-right-color:#f4f5f9}.webix_scheduler_year{justify-content:space-evenly}.webix_scheduler_year .webix_cal_month,.webix_scheduler_year .webix_cal_month .webix_cal_month_name{cursor:pointer}.webix_scheduler_year .webix_cal_month:hover .webix_cal_month_name{color:#1ca1c1}.webix_scheduler_year .webix_cal_outside{visibility:hidden}.webix_scheduler_absbutton{border-radius:50%;z-index:91}.webix_scheduler_absbutton .webix_el_box{background-color:#1ca1c1}.webix_scheduler_absbutton .webix_el_box .webix_icon_button:hover:before{background-color:#1992af}.webix_scheduler_absbutton .webix_el_box .webix_icon{color:#fff}.webix_scheduler_navlist .webix_icon{color:#94a1b3}.webix_scheduler_navlist .webix_selected .webix_icon{color:#1ca1c1}.webix_scheduler_navlist .webix_list_item,.webix_scheduler_navlist .webix_list_item.webix_selected{border-bottom-color:transparent}.webix_scheduler_navlist .webix_list_item:hover,.webix_scheduler_navlist .webix_list_item.webix_selected:hover{background-color:#f4f5f9}.webix_scheduler_navlist .webix_list_item.webix_selected{color:#475466;background-color:#f4f5f9}.webix_scheduler_cal_list .webix_list_item{padding:2px 8px 2px 0}.webix_scheduler_cal_list .webix_list_item span{float:left}.webix_scheduler_cal_list .webix_list_item .webix_icon{line-height:inherit}.webix_scheduler_cal_list .webix_list_item:hover .webix_scheduler_cal_edit{color:#94a1b3}.webix_scheduler_cal_list .webix_list_item.webix_selected{box-shadow:none;padding:2px 8px 2px 0;background-color:transparent}.webix_scheduler_cal_list .webix_list_item.webix_selected .webix_scheduler_cal_edit{color:#1ca1c1}.webix_scheduler_cal_list .webix_list_item.webix_selected .webix_scheduler_cal_edit::before{content:""}.webix_scheduler_cal_list .webix_dt_editor input{padding-left:23px;border-color:transparent;border-bottom-color:#1ca1c1}.webix_scheduler_cal_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_active{margin-right:4px}.webix_scheduler_cal_title{overflow:hidden;width:calc(100% - 24px - 29px - 4px);white-space:nowrap;text-overflow:ellipsis}.webix_scheduler_cal_edit{color:transparent;font-size:18px;width:31px;line-height:31px;border-radius:50%}.webix_scheduler_cal_edit:hover{color:#1ca1c1;background-color:#f4f5f9}.webix_scheduler_cal_edit.webix_scheduler_cal_visible{color:#94a1b3}.webix_scheduler_settings .webix_template{padding:0;text-align:center;font-weight:500;line-height:38px}.webix_scheduler_settings .webix_template:hover{background-color:#f4f5f9}.webix_event_overall{padding:0 8px 0 20px;height:100%;line-height:49px;display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-align-items:center}.webix_event_overall.webix_scheduler_past_event{color:#8393a9}.webix_event_overall.webix_scheduler_past_event .webix_event_time .end{color:#8393a9}.webix_event_overall .webix_event_time{flex-basis:70px;flex-shrink:0;display:block;text-align:center}.webix_event_overall .webix_event_time .start,.webix_event_overall .webix_event_time .end{font-size:12px;line-height:16px}.webix_event_overall .webix_event_time .end{color:#94a1b3}.webix_list_item .webix_event_text{padding-left:10px;display:block;-webkit-box-flex:1;-webkit-flex:1;flex:1;white-space:nowrap;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis}.webix_event_marker{display:inline-block;width:10px}.webix_event_marker_inner{display:inline-block;border-radius:50%;width:10px;height:10px}.webix_scheduler_event_selected{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_multi_space{text-align:center}.webix_scheduler_multi_space .webix_template{padding:0}.webix_scheduler_multi_space .webix_scheduler_more_icon{cursor:pointer;color:#94a1b3;transition:color .3s;position:relative;top:calc(100% - 26px);height:26px;width:26px}.webix_scheduler_multi_space .webix_scheduler_more_icon:hover{color:#475466}.webix_scheduler_multi_space .webix_scheduler_more_icon:after{content:"";transition:background-color .3s;height:26px;width:26px;border-radius:50%;position:absolute;top:-4px;left:0;z-index:-1}.webix_scheduler_multi_space .webix_scheduler_more_icon:hover:after{background-color:rgba(148,161,179,0.1)}.webix_scheduler_agenda .webix_scroll_cont{padding-left:120px}.webix_scheduler_agenda .webix_list_item{border-color:transparent;padding:0;width:calc(100% - 120px) !important}.webix_scheduler_agenda .webix_event_overall{line-height:40px;height:40px}.webix_scheduler_agenda .webix_event_overall:hover{background-color:#f4f5f9}.webix_scheduler_agenda .webix_event_overall.webix_scheduler_past_event{color:#8393a9}.webix_scheduler_agenda .webix_event_first{padding-top:8px}.webix_scheduler_agenda .webix_event_last{padding-bottom:8px}.webix_scheduler_agenda .webix_event_last:not(:last-child){border-color:#edeff0}.webix_scheduler_agenda .webix_agenda_selected{background-color:#f4f5f9}.webix_scheduler_agenda .webix_unit_header{float:left;margin-left:-120px;width:120px !important;background-color:transparent;border-bottom-width:0;line-height:18px;padding:6px 8px;box-sizing:border-box}.webix_scheduler_agenda .webix_unit_header:not(:first-child){border-top:1px solid #edeff0;margin-top:-1px}.webix_scheduler_agenda .webix_unit_header .webix_scheduler_dayofweek{color:#94a1b3;font-weight:normal;font-size:12px}.webix_scheduler_timeline_scale .webix_template{padding:0}.webix_scheduler_timeline_scale_row{display:flex;box-sizing:border-box}.webix_scheduler_timeline_scale_row:not(:last-child){border-bottom:1px solid #dadee0}.webix_scheduler_timeline_scale_cell{display:flex;flex:0 0 auto;justify-content:center;align-items:center;border-right:1px solid #dadee0;box-sizing:border-box;background-color:#f4f5f9}.webix_scheduler_timeline_event{position:absolute;box-sizing:border-box;border-radius:2px;color:#fff;cursor:pointer;border-left:3px solid;transition:box-shadow .15s;overflow:hidden}.webix_scheduler_timeline_event:hover{box-shadow:2px 2px 5px rgba(0,0,0,0.3),1px 1px 2px rgba(0,0,0,0.2)}.webix_scheduler_timeline_content{text-align:center;line-height:30px;position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;user-select:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 12px}.webix_scheduler_timeline_task .webix_scheduler_timeline_content{padding:0 32px}.webix_scheduler_timeline_bars .webix_list_item,.webix_scheduler_timeline_sections .webix_cell{border-color:#dadee0;text-overflow:ellipsis}.webix_scheduler_timeline_bars .webix_list_item{cursor:default}.webix_scheduler_timeline_sections .webix_c_scroll_y div{color:transparent;background-color:transparent}.webix_scheduler_timeline_space{background-color:#f4f5f9}.webix_scheduler_timeline_event.webix_scheduler_multi_more{transition:background-color .3s;background-color:#f4f5f9}.webix_scheduler_timeline_event.webix_scheduler_multi_more .webix_scheduler_timeline_content{text-align:left;color:#475466}.webix_scheduler_timeline_event.webix_scheduler_multi_more:hover{background-color:#e7e9f2;box-shadow:none}.webix_scheduler_timeline_event.webix_scheduler_event_break_left{border-left-width:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.webix_scheduler_timeline_event.webix_scheduler_event_break_left:hover{box-shadow:6px 6px 5px -4px rgba(0,0,0,0.2),5px 5px 2px -4px rgba(0,0,0,0.2)}.webix_scheduler_timeline_event.webix_scheduler_event_break_right:hover{box-shadow:-1px 5px 5px -3px rgba(0,0,0,0.3),-2px 4px 2px -3px rgba(0,0,0,0.2)}.webix_scheduler_copy.webix_scheduler_day_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_day_event,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_month_event,.webix_scheduler_copy.webix_scheduler_multiday_event,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_selected,.webix_scheduler_copy.webix_scheduler_timeline_event{box-shadow:2px 2px 5px #1ca1c1,1px 1px 2px #1ca1c1}.webix_scheduler_copy.webix_scheduler_multiday_event.webix_scheduler_event_break_right,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_break_right,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_break_right{box-shadow:3px 9px 5px -7px #1ca1c1,-6px 9px 3px -7px #1ca1c1}.webix_scheduler_copy.webix_scheduler_multiday_event.webix_scheduler_event_break_left,.webix_scheduler_copy.webix_scheduler_month_event.webix_scheduler_event_break_left,.webix_scheduler_copy.webix_scheduler_timeline_event.webix_scheduler_event_break_left{box-shadow:3px 9px 5px -7px #1ca1c1,2px 8px 2px -7px #1ca1c1}.webix_scheduler_copy .webix_scheduler_multiday_event.webix_scheduler_event_break_right{box-shadow:3px 9px 5px -7px #1ca1c1,-6px 9px 3px -7px #1ca1c1}.webix_scheduler_copy .webix_scheduler_multiday_event.webix_scheduler_event_break_left{box-shadow:3px 9px 5px -7px #1ca1c1,2px 8px 2px -7px #1ca1c1}.webix_scheduler_cut{opacity:.5}.webix_scheduler_month_event_single.webix_scheduler_event_selected.webix_scheduler_copy,.webix_scheduler_month_event_single.webix_scheduler_copy{background-color:rgba(28,161,193,0.2)}.webix_scheduler_paste_target{box-shadow:inset 0 2px 0 0 #1ca1c1,inset 0 -2px 0 0 #1ca1c1}.webix_scheduler_clipboard_target.webix_scheduler_calendar .webix_cal_day,.webix_scheduler_clipboard_target.webix_scheduler_timeline_bars .webix_list_item,.webix_scheduler_clipboard_target.webix_scheduler_day_events .webix_list_item,.webix_scheduler_clipboard_target.webix_scheduler_multilist{cursor:pointer}.webix_scheduler .webix_progress_top{z-index:10000}.webix_scheduler_action_popup .webix_win_head{border-bottom-color:transparent}.webix_scheduler_sidemenu{z-index:1 !important}.webix_toolbar.webix_scheduler_toolbar .webix_view,.webix_toolbar.webix_scheduler_toolbar .webix_control.webix_el_tabbar{background-color:transparent}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab{background:transparent;color:#fff}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab:hover{background-color:rgba(0,0,0,0.2)}.webix_toolbar.webix_scheduler_toolbar .webix_item_tab.webix_selected,.webix_toolbar.webix_scheduler_toolbar .webix_item_tab.webix_selected:focus{color:#fff;box-shadow:inset 0 -2px #fff}.webix_scheduler_cal_title{width:calc(100% - 24px - 31px - 4px)}.webix_scheduler_danger .webix_button{color:#ff5c4c;background-color:#fff1ef}.webix_scheduler_danger .webix_button:hover,.webix_scheduler_danger .webix_button:focus{background-color:#ffe7e5}.webix_scheduler_danger .webix_button:active{background-color:#ffdedb}.webix_scheduler_checkbox_allday .webix_custom_checkbox::before{margin-left:-2px}'],sourceRoot:""}]);const s=a},42116:function(e,t,i){!function(e){"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)};function n(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=function(){},a=function(){function e(e,t){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={},t&&t.params&&e.extend(this._data,t.params)}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null},e.prototype.setParam=function(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var n=this.getParentView();return n?n.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._segment.suburl()},e.prototype.getUrlString=function(){return this._segment.toString()},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView((function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope}),"self")}return e},e.prototype.on=function(e,t,i){var n=e.attachEvent(t,i);return this._events.push({obj:e,id:n}),n},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null},e.prototype._detachEvents=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)},e.prototype._destroySubs=function(){for(var e in this._subs){var t=this._subs[e].view;t&&t.destructor()}this._subs={}},e.prototype._init_url_data=function(){var e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)},e.prototype._getDefaultSub=function(){if(this._subs.default)return this._subs.default;for(var e in this._subs){var t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){var i=t.view._getDefaultSub();if(i)return i}}},e.prototype._routed_view=function(){var e=this.getParentView();if(!e)return!0;var t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()},e}();function s(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var r=t[n],o={},a=r.indexOf(":");if(-1===a&&(a=r.indexOf("?")),-1!==a)for(var s=0,l=r.substr(a+1).split(/[\:\?\&]/g);s<l.length;s++){var c=l[s].split("=");o[c[0]]=decodeURIComponent(c[1])}i[n]={page:a>-1?r.substr(0,a):r,params:o,isNew:!0}}return i}function l(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push("/"+r.page);var o=c(r.params);o&&t.push("?"+o)}return t.join("")}function c(e){var t=[];for(var i in e)"object"!=typeof e[i]&&(t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i])));return t.join("")}var u=function(){function e(e,t){this._next=1,this.route="string"==typeof e?{url:s(e),path:e}:e,this.index=t}return e.prototype.current=function(){return this.route.url[this.index]},e.prototype.next=function(){return this.route.url[this.index+this._next]},e.prototype.suburl=function(){return this.route.url.slice(this.index)},e.prototype.shift=function(t){var i=new e(this.route,this.index+this._next);return i.setParams(i.route.url,t,i.index),i},e.prototype.setParams=function(e,t,i){if(t){var n=e[i].params;for(var r in t)n[r]=t[r]}},e.prototype.refresh=function(){for(var e=this.route.url,t=this.index+1;t<e.length;t++)e[t].isNew=!0},e.prototype.toString=function(){var e=l(this.suburl());return e?e.substr(1):""},e.prototype._join=function(e,t){var i=this.route.url;if(null===e)return i;var n=this.route.url,r=!0;if(i=n.slice(0,this.index+(t?this._next:0)),e){i=i.concat(s(e));for(var o=0;o<i.length;o++)n[o]&&(i[o].view=n[o].view),r&&n[o]&&i[o].page===n[o].page?i[o].isNew=!1:i[o].isNew&&(r=!1)}return i},e.prototype.append=function(e){var t=this._join(e,!0);return this.route.path=l(t),this.route.url=t,this.route.path},e.prototype.show=function(e,t,i){var n=this,r=this._join(e.url,i);return this.setParams(r,e.params,this.index+(i?this._next:0)),new Promise((function(e,i){var a=l(r),s={url:r,redirect:a,confirm:Promise.resolve()},c=t?t.app:null;!c||c.callEvent("app:guard",[s.redirect,t,s])?s.confirm.catch((function(e){return i(e)})).then((function(){if(null!==s.redirect){if(s.redirect!==a)return c.show(s.redirect),void i(new o);n.route.path=a,n.route.url=r,e()}else i(new o)})):i(new o)}))},e.prototype.size=function(e){this._next=e},e.prototype.split=function(){var t={url:this.route.url.slice(this.index+1),path:""};return t.url.length&&(t.path=l(t.url)),new e(t,0)},e.prototype.update=function(e,t,i){var n=this.route.url[this.index+(i||0)];if(!n)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?n.page=t:n.params[e]=t,this.route.path=l(this.route.url)},e}(),h=function(e){function t(t,i){var n=e.call(this,t.webix)||this;return n.app=t,n._children=[],n}return n(t,e),t.prototype.ui=function(e,t){var i=(t=t||{}).container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,this._segment,this),"object"!=typeof e||e instanceof a?n:n.getRoot()},t.prototype.show=function(e,t){if(t=t||{},"object"==typeof e){for(var i in e)this.setParam(i,e[i]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e,t);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var n=this.getParentView();return n?n.show(e.substr(3),t):this.app.show("/"+e.substr(3))}var r=this.getSubViewInfo(t.target);if(r){if(r.parent!==this)return r.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,r.subview,{url:e,params:t.params})}else if(e)return this.app.show("/"+e,t)}return this._show(this._segment,{url:e,params:t.params},this)},t.prototype._show=function(e,t,i){var n=this;return e.show(t,i,!0).then((function(){return n._init_url_data(),n._urlChange()})).then((function(){e.route.linkRouter&&(n.app.getRouter().set(e.route.path,{silent:!0}),n.app.callEvent("app:route",[e.route.path]))}))},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this._root&&(this._root.destructor(),e.prototype.destructor.call(this))},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)},t.prototype.render=function(e,t,i){var n=this;"string"==typeof t&&(t=new u(t,0)),this._segment=t,this._parent=i,this._init_url_data();var r="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==r?(this._container=r,this._render(t)):this._urlChange().then((function(){return n.getRoot()}))},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then((function(i){return t._render_final(i,e)})):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i,n=this,r=null,o=null,a=!1;if(this._container.tagName?o=this._container:(r=this._container).popup?(o=document.body,a=!0):o=this.webix.$$(r.id),!this.app||!o)return Promise.reject(null);var s=this._segment.current(),l={ui:{}};this.app.copyConfig(e,l.ui,this._subs),this.app.callEvent("app:render",[this,t,l]),l.ui.$scope=this,!r&&s.isNew&&s.view&&s.view.destructor();try{if(r&&!a){var c=o,u=c.getParentView();u&&"multiview"===u.name&&!l.ui.id&&(l.ui.id=c.config.id)}this._root=this.app.webix.ui(l.ui,o);var h=this._root;a&&h.setPosition&&!h.isVisible()&&h.show(),r&&(r.view&&r.view!==this&&r.view!==this.app&&r.view.destructor(),r.id=this._root.config.id,this.getParentView()||!this.app.app?r.view=this:r.view=this.app),s.isNew&&(s.view=this,s.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((function(){return n._urlChange().then((function(){return n._initUrl=null,n.ready(n._root,t.suburl())}))}))}catch(e){i=Promise.reject(e)}return i.catch((function(e){return n._initError(n,e)}))},t.prototype._init=function(e,t){return this.init(e,t.suburl())},t.prototype._urlChange=function(){var e=this;this.app.callEvent("app:urlchange",[this,this._segment]);var t=[];for(var i in this._subs){var n=this._subs[i],r=this._renderFrameLock(i,n,null);r&&t.push(r)}return Promise.all(t).then((function(){return e.urlChange(e._root,e._segment.suburl())}))},t.prototype._renderFrameLock=function(e,t,i){if(!t.lock){var n=this._renderFrame(e,t,i);n&&(t.lock=n.then((function(){return t.lock=null}),(function(){return t.lock=null})))}return t.lock},t.prototype._renderFrame=function(e,t,i){var n=this;if("default"===e){if(this._segment.next()){var r=i?i.params:null;return t.params&&(r=this.webix.extend(r||{},t.params)),this._createSubView(t,this._segment.shift(r))}t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i.url,t.params&&(i.params=this.webix.extend(i.params||{},t.params))),t.route){if(null!==i)return t.route.show(i,t.view).then((function(){return n._createSubView(t,t.route)}));if(t.branch)return}var o=t.view;if(!o&&t.url){if("string"==typeof t.url)return t.route=new u(t.url,0),i&&t.route.setParams(t.route.route.url,i.params,0),t.params&&t.route.setParams(t.route.route.url,t.params,0),this._createSubView(t,t.route);"function"!=typeof t.url||o instanceof t.url||(o=new(this.app._override(t.url))(this.app,"")),o||(o=t.url)}if(o)return o.render(t,t.route||this._segment,this)},t.prototype._initError=function(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t.current()).then((function(n){return n.render(e,t,i)}))},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(a),p=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._ui=i.ui,n}return n(t,e),t.prototype.config=function(){return this._ui},t}(h),d=function(){function e(e,t,i){this.path="",this.app=i}return e.prototype.set=function(e,t){this.path=e;var i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})},e.prototype.get=function(){return this.path},e}(),_=!0,f=function(e){function t(t){var i=this,n=(t||{}).webix||window.webix;return t=n.extend({name:"App",version:"1.0",start:"/home"},t,!0),(i=e.call(this,n,t)||this).config=t,i.app=i.config.app,i.ready=Promise.resolve(),i._services={},i.webix.extend(i,i.webix.EventSystem),i}return n(t,e),t.prototype.getUrl=function(){return this._subSegment.suburl()},t.prototype.getUrlString=function(){return this._subSegment.toString()},t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.destructor=function(){this.getSubView().destructor(),e.prototype.destructor.call(this)},t.prototype.copyConfig=function(e,t,i){if((e instanceof a||"function"==typeof e&&e.prototype instanceof a)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);var n=e instanceof Array;for(var r in t=t||(n?[]:{}),e){var o=e[r];if("function"==typeof o&&o.prototype instanceof a&&(o={$subview:o}),!o||"object"!=typeof o||o instanceof this.webix.DataCollection||o instanceof RegExp||o instanceof Map)t[r]=o;else if(o instanceof Date)t[r]=new Date(o);else{var s=this.copyConfig(o,o instanceof Array?[]:{},i);null!==s&&(n?t.push(s):t[r]=s)}}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){var i=t.getAttribute("trigger");if(i)return this._forView(t,(function(e){return e.app.trigger(i)})),e.cancelBubble=!0,e.preventDefault();var n=t.getAttribute("route");if(n)return this._forView(t,(function(e){return e.show(n)})),e.cancelBubble=!0,e.preventDefault()}var r=t.parentNode;r&&this.clickHandler(e,r)},t.prototype.getRoot=function(){return this.getSubView().getRoot()},t.prototype.refresh=function(){var e=this;return this._subSegment?this.getSubView().refresh().then((function(t){return e.callEvent("app:route",[e.getUrl()]),t})):Promise.resolve(null)},t.prototype.loadView=function(e){var t=this,i=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(n="function"==typeof i?i(e):i[e])&&(e=n,n=null),n||("_hidden"===e?n={hidden:!0}:"_blank"===e?n={}:(e=e.replace(/\./g,"/"),n=this.require("jet-views",e)))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n.then((function(e){return e.__esModule?e.default:e})).catch((function(i){return t._loadError(e,i)}))},t.prototype._forView=function(e,t){var i=this.webix.$$(e);i&&t(i.$scope)},t.prototype._loadViewDynamic=function(e){return null},t.prototype.createFromURL=function(e){var t=this;return e.isNew||!e.view?this.loadView(e.page).then((function(i){return t.createView(i,name,e.params)})):Promise.resolve(e.view)},t.prototype._override=function(e){var t=this.config.override;if(t){for(var i=void 0;e;)i=e,e=t.get(e);return i}return e},t.prototype.createView=function(e,i,n){if("function"==typeof(e=this._override(e))){if(e.prototype instanceof t)return new e({app:this,name:i,params:n,router:d});if(e.prototype instanceof a)return new e(this,{name:i,params:n});e=e(this)}return e instanceof a?e:new p(this,{name:i,ui:e})},t.prototype.show=function(e,t){return e&&this.app&&0==e.indexOf("//")?this.app.show(e.substr(1),t):this.render(this._container,e||this.config.start,t)},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)}),this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var n=t[i].message;0===n.indexOf("Module build failed")?(n=n.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+n+"</pre>"):(n+="<br><br>Check console for more details",this.webix.message({type:"error",text:n,expire:-1}))}},t.prototype.render=function(e,t,i){var n=this;this._container="string"==typeof e?this.webix.toNode(e):e||document.body;var r=null;this.$router?r="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(_&&"tagName"in this._container&&(this.webix.event(document.body,"click",(function(e){return n.clickHandler(e)})),_=!1),"string"==typeof t&&(t=new u(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);var o=i?i.params:this.config.params||null,a=this.getSubView(),s=this._subSegment,l=s.show({url:r,params:o},a).then((function(){return n.createFromURL(s.current())})).then((function(t){return t.render(e,s)})).then((function(e){return n.$router.set(s.route.path,{silent:!0}),n.callEvent("app:route",[n.getUrl()]),e}));return this.ready=this.ready.then((function(){return l})),l},t.prototype.getSubView=function(){if(this._subSegment){var e=this._subSegment.current().view;if(e)return e}return new h(this,{})},t.prototype.require=function(e,t){return null},t.prototype._first_start=function(e){var t=this;if(this._segment=e,this.$router=new this.config.router((function(e){return setTimeout((function(){t.show(e).catch((function(e){if(!(e instanceof o))throw e}))}),1)}),this.config,this),this._container===document.body&&!1!==this.config.animation){var i=this._container;this.webix.html.addCss(i,"webixappstart"),setTimeout((function(){t.webix.html.removeCss(i,"webixappstart"),t.webix.html.addCss(i,"webixapp")}),10)}if(e){if(this.app){var n=e.current().view;e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new u(this.config.start,0),e.current().view=n}}else{var r=this.$router.get();r||(r=this.config.start,this.$router.set(r,{silent:!0})),e=new u(r,0)}return e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[r]={id:t.id,url:n,branch:e.branch,popup:e.popup,params:e.params}).popup?null:t},t}(a),b=function(){function e(e,t){var i=this;this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=function(){return i.cb(i.get())}}return e.prototype.set=function(e,t){var i=this;if(this.config.routes){var n=e.split("?",2);for(var r in this.config.routes)if(this.config.routes[r]===n[0]){e=r+(n.length>1?"?"+n[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){var e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e.prototype._detectPrefix=function(){var e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]},e.prototype._getRaw=function(){return document.location.href},e}(),g=!1;function w(e){if(!g&&e){g=!0;var t=window;t.Promise||(t.Promise=e.promise);var i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){var i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});var n=e.ui.baselayout.prototype.addView,r=e.ui.baselayout.prototype.removeView,o={addView:function(e,t){if(this.$scope&&this.$scope.webixJet&&!e.queryView){var i=this.$scope,r={};e=i.app.copyConfig(e,{},r),n.apply(this,[e,t]);var o=function(e){i._renderFrame(e,r[e],null).then((function(){i._subs[e]=r[e]}))};for(var a in r)o(a);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var i in t){var n=t[i];e.$$(n.id)||(n.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,o,!0),e.extend(e.ui.baselayout.prototype,o,!0),e.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var i=e.uid().toString();t.body={id:i},this.$ready.push((function(){this.callEvent("onInit",[this.$app]),this.$app.render({id:i})}))}},e.ui.proxy,e.EventSystem)}}var A=function(e){function t(t){var i;return t.router=t.router||b,w((i=e.call(this,t)||this).webix),i}return n(t,e),t.prototype.require=function(e,t){return i(69907)(e+"/"+t)},t}(f),x=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n(t,e),t.prototype._detectPrefix=function(){this.prefix="",this.sufix=this.config.routerPrefix||""},t.prototype._getRaw=function(){return document.location.pathname+(document.location.search||"")}}(b),function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){return this.path},e}());function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e,t,i){for(var n in e)v(e,n)&&t.call(i||e,e[n],n,e)}function y(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var C=String.prototype.replace,k=String.prototype.split,S=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},B={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:S,chinese:function(){return 0},croatian:S,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:S,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},$={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function D(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var E=/\$/g,T=/%\{(.*?)\}/g;function L(e,t,i,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,o=n||T,a="number"==typeof t?{smart_count:t}:t;if(null!=a.smart_count&&r){var s=k.call(r,"||||");r=(s[function(e,t){return B[function(e){var t,i=(t={},m($,(function(e,i){m(e,(function(e){t[e]=i}))})),t);return i[e]||i[k.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",a.smart_count)]||s[0]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return C.call(r,o,(function(e,t){return v(a,t)&&null!=a[t]?C.call(a[t],E,"$$"):e}))}function I(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?L:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||y,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if("||||"===t||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(D(t)+"(.*?)"+D(i),"g")}(t.interpolation)}I.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},I.prototype.extend=function(e,t){m(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.extend(e,n):this.phrases[n]=e}),this)},I.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:m(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.unset(e,n):delete this.phrases[n]}),this)},I.prototype.clear=function(){this.phrases={}},I.prototype.replace=function(e){this.clear(),this.extend(e)},I.prototype.t=function(e,t){var i,n,r=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof r._?i=r._:this.onMissingKey?n=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),n=e),"string"==typeof i&&(n=L(i,r,this.currentLocale,this.tokenRegex)),n},I.prototype.has=function(e){return v(this.phrases,e)},I.transformPhrase=function(e,t,i){return L(e,t,i)};var q=I,P=window.webix;P&&w(P);var R=function(e,t,i){var n=(i=i||{}).storage,r=n?n.get("lang")||"en":i.lang||"en";function o(t,o,a){o.__esModule&&(o=o.default);var l={phrases:o};i.polyglot&&e.webix.extend(l,i.polyglot);var c=s.polyglot=new q(l);if(c.locale(t),s._=e.webix.bind(c.t,c),r=t,n&&n.put("lang",r),i.webix){var u=i.webix[t];u&&e.webix.i18n.setLocale(u)}return a?Promise.resolve():e.refresh()}function a(t,n){if(!1!==i.path){var r=(i.path?i.path+"/":"")+t;o(t,e.require("jet-locales",r),n)}}var s={getLang:function(){return r},setLang:a,setLangData:o,_:null,polyglot:null};e.setService("locale",s),a(r,!0)},M=window;M.Promise||(M.Promise=M.webix.promise);var F=!1;function U(e,t,i){var n=t.$width,r=t.$height;e.config._fillApp?e.define({width:n,height:r}):e.define({left:(n-e.$width)/2,top:(r-e.$height)/2}),i||e.resize()}function O(e,t){var i=t.getRoot();e.attachEvent("onHide",(function(){i.$destructed||(webix.html.removeCss(i.$view,"webix_win_inside"),i.enable())}));var n=t.attachEvent("view:resize",(function(){U(e,i)}));e.attachEvent("onDestruct",(function(){t.detachEvent(n)}))}var V=1;function H(e,t,i){Object.defineProperty(t,i,{get:function(){return e[i]},set:function(t){return e[i]=t}})}function z(e,t){t=t||{};var i={},n={},r=function(e,t){var r=V++;return i[r]={mask:e,handler:t},t("*"===e?n:n[e],void 0,e),r},o=[],a=!1,s=function(e,t,n,r){if(a)o.push([e,t,n,r]);else for(var s=Object.keys(i),l=0;l<s.length;l++){var c=i[s[l]];c&&("*"!==c.mask&&c.mask!==e||c.handler(n,t,e,r))}};return Object.defineProperty(n,"$changes",{value:{attachEvent:r,detachEvent:function(e){delete i[e]}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$observe",{value:r,enumerable:!1,configurable:!1}),Object.defineProperty(n,"$batch",{value:function(e){if("function"!=typeof e){var t=e;e=function(){for(var e in t)n[e]=t[e]}}for(a=!0,e(n),a=!1;o.length;){var i=o.shift();s.apply(this,i)}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$extend",{value:function(e,i){for(var r in i=i||t,e)if(e.hasOwnProperty(r)){var o=e[r];i.nested&&"object"==typeof o&&o?n[r]=z(o,i):j(n,o,r,s)}},enumerable:!1,configurable:!1}),n.$extend(e,t),n}function j(e,t,i,n){Object.defineProperty(e,i,{get:function(){return t},set:function(e){if(null===t||null===e?t!==e:t.valueOf()!=e.valueOf()){var r=t;t=e,n(i,r,e,null)}},enumerable:!0,configurable:!1})}var N={start:function(e,t){e._auto_scroll_delay=webix.delay(N.autoScroll,e,[t,webix.html.pos(t)],250)},reset:function(e){e._auto_scroll_delay&&(e._auto_scroll_delay=window.clearTimeout(e._auto_scroll_delay))},autoScroll:function(e,t){var i=-1!==this.direction.indexOf("y"),n=-1!==this.direction.indexOf("x"),r=webix.html.offset(this.from.$view),o=!1;i&&N.autoYScroll.call(this,t,r,this.senseY)&&(o=!0),n&&N.autoXScroll.call(this,t,r,this.senseX)&&(o=!0),o&&(function(e,t){if(webix.DragControl.active){var i=webix.DragControl.getNode();t=webix.copy(t),webix.DragControl.$dragPos(t,e),i.style.top=t.y+webix.DragControl.top+"px",i.style.left=t.x+webix.DragControl.left+"px"}}(e,t),this._auto_scroll_delay=webix.delay(N.autoScroll,this,[e,t],100))},autoYScroll:function(e,t,i){var n=this.from.getScrollState();return e.y<t.y+i?N.autoScrollTo.call(this,n.x,n.y-i,"y"):e.y>t.y+t.height-i&&N.autoScrollTo.call(this,n.x,n.y+i,"y")},autoXScroll:function(e,t,i){var n=this.from.getScrollState();if(e.x<t.x+i)return N.autoScrollTo.call(this,n.x-i,n.y,"x");if(e.x>t.x+t.width-i){var r=this.snode?Math.min(n.x+i,this.snode.scrollWidth-t.width):n.x+i;return r!=n.x&&N.autoScrollTo.call(this,r,n.y,"x")}return!1},autoScrollTo:function(e,t,i){this.from.scrollTo(e,t),this.from.callEvent("onAfterAutoScroll",[]);var n=this.from.getScrollState();return Math.abs(("x"===i?e:t)-n[i])<1}};function W(e){var t=webix.copy(K);t.view=e,t.master=this,t.Local=this.app.getService("local"),webix.DragControl.addDrag(e.$view,t),webix.DragControl.addDrop(e.$view,t,!0)}function Y(e,t){var i=e.getBoundingClientRect(),n=(t-i.left)/i.width,r=webix.env.touch?400:200,o=.2/(i.width>r?i.width/r:1);return n<o?"start":n>1-o?"end":"move"}function G(e){var t=this.Local.getScales();return e.senseX=Math.round(t.cellWidth*(webix.env.touch?1:.5)),e.senseY=Math.round(t.cellHeight*(webix.env.touch?3:1)),e}var K={$longTouchLimit:!0,$dragCreate:function(e,t,i){if(this.master.State.readonly)return!1;var n=this.getContext();n.$touch="touch"===i;var r=this.locateEvent(t);if(r){var o=this.view.getItem(r);if(o.$group)return!1;var a=t.target;if(a.classList.contains("webix_gantt_link"))return n.mode="links",X[n.mode].$dragCreate.call(this,e,t,r);var s=this.view.getItemNode(r);if(!n.$touch&&function(e,t){for(;e!=t;){if(e.classList.contains("webix_gantt_progress_drag"))return!0;e=e.parentNode}return!1}(a,s))return n.mode="progress",X[n.mode].$dragCreate.call(this,e,t,r);var l=this.view.getScrollState(),c=this.getEventContext(t,n),u=Y(s,c.x);"task"==o.type||"start"!=u&&"end"!=u||(u="move");var h=this.Local.getScales(),p=h.cellWidth;if(h.precise){var d=this.master.app.getService("helpers").getSmallerCount(h.minUnit);p=Math.round(p/("number"==typeof d?d:d()))}if(webix.extend(n,{id:r,mode:u,node:s,step:p,dx:0,from:this.view,snode:e.querySelector(".webix_scroll_cont"),x:c.x,scroll:l,t:parseInt(s.style.top),l:parseInt(s.style.left),w:parseInt(s.style.width)},!0),!this.master.app.callEvent("bars:beforedrag",[o,n]))return!1;X[n.mode].dragScroll&&webix.extend(n,G.call(this,X[n.mode].dragScroll));var _=s.cloneNode(!0);return _.className+=" webix_drag_zone webix_gantt_mode_"+u,s.style.visibility="hidden",webix.html.addCss(e,"webix_gantt_in_action",!0),e.style.cursor="move"==u?"move":"ew-resize",e.appendChild(_),_}return!(!this.master.app.config.split||"resources"===this.master.State.display||t.target!=e)&&(n.mode="split",X[n.mode].$dragCreate.call(this,e,t))},$dragDestroy:function(e,t){var i=this,n=this.getContext();return X[n.mode].dragScroll&&N.reset(n),n.mode&&X[n.mode].$dragDestroy?X[n.mode].$dragDestroy.call(this,e,t):(n.$waitUpdate?n.$waitUpdate.catch((function(){i.master.Action({action:"update-task-time",id:n.id})})):n.$waitUpdate=this.master.Action({action:"update-task-time",id:n.id}),n.$waitUpdate.finally((function(){n.node.style.visibility="",webix.html.remove(t),i.master.app.config.split&&n.id&&i.master.Action({action:"split-resize",id:n.id})})),e.style.cursor="",webix.html.removeCss(e,"webix_gantt_in_action"),!1)},$dragIn:function(e,t,i){var n=this.getContext();return!!n.mode&&(X[n.mode].dragScroll&&(N.reset(n),N.start(n,i)),!X[n.mode].$dragIn||X[n.mode].$dragIn.call(this,e,t,i))},$dragPos:function(e){var t=this.getContext();return X[t.mode].$dragPos.call(this,e)},$dragOut:function(e,t,i,n){var r=this.getContext();return X[r.mode].$dragOut?X[r.mode].$dragOut.call(this,e,t,i,n):null},$drop:function(e,t,i){var n=this.getContext();if(!n.mode)return!1;if(X[n.mode].$drop)return X[n.mode].$drop.call(this,e,t,i);var r=n.id,o=n.mode,a=n.dx,s=n.step,l=Math.round(a/s);if(n.timeShift=l,!this.master.app.callEvent("bars:beforedrop",[this.view.getItem(n.id),n]))return!1;n.$waitUpdate=this.master.Action({action:"update-task-time",mode:o,time:l,id:r})},locateEvent:function(e,t){return t&&(e=document.elementFromPoint(t.x,t.y)),webix.html.locate(e,"webix_l_id")},getEventContext:function(e,t){if(t.$touch){if(e.changedTouches&&(!e.touches||!e.touches[0])){var i=e.changedTouches[0];return{x:i.pageX,y:i.pageY}}return e.time?e:webix.env.touch.context(e)}return{x:e.clientX,y:e.clientY}},getContext:function(){return webix.DragControl.getContext()},setDragOffset:function(e,t,i){var n=this.getContext(),r=webix.html.pos(i),o=webix.html.offset(e);n.width=o.width,n.height=o.height,n.x_offset=o.x-r.x,n.y_offset=o.y-r.y}},Q={$dragPos:function(e){var t=this.getContext(),i=this.view.getScrollState(),n=webix.DragControl.getNode(),r=t.mode,o=t.l,a=t.t,s=t.w,l=t.x,c=t.id,u=t.scroll,h=t.step,p=t.dx=e.x-l-u.x+i.x;"start"===r?(e.x=Math.min(o+p,o+s-h),n.style.width=Math.max(s-p,h)+"px"):"end"===r&&(e.x=o,n.style.width=Math.max(s+p,h)+"px"),e.y=a,this.master.Action({action:"drag-task",id:c,left:e.x,width:parseInt(n.style.width)}),this.master.app.config.split&&this.master.Action({action:"split-resize",id:c})}},X={links:{dragScroll:{direction:"xy"},$dragCreate:function(e,t,i){var n=this.getContext(),r=t.target,o=this.view.getItemNode(i),a=this.view.getScrollState(),s=webix.html.offset(r),l=r.classList;if(webix.extend(n,{id:i,from:this.view,node:o,link:r,fromStart:l.contains("webix_gantt_link_left"),start:{x:s.x+s.width/2+a.x,y:s.y+s.height/2+a.y}},!0),!this.master.app.callEvent("bars:beforedrag",[this.view.getItem(i),n]))return!1;X[n.mode].dragScroll&&webix.extend(n,G.call(this,X[n.mode].dragScroll)),r.style.opacity=1,webix.html.addCss(o,"webix_gantt_task_in_action",!0);var c=webix.html.create("div",{visibility:"hidden"});return document.body.appendChild(c),c},$dragDestroy:function(e,t){var i=this.getContext();if(this.master.Action({action:"temp-link"}),i.target){var n=this.view.getItemNode(i.target);webix.html.removeCss(n,"webix_gantt_link_visible")}return i.link.style.opacity="",webix.html.removeCss(i.node,"webix_gantt_task_in_action"),webix.html.remove(t),!1},$dragIn:function(e,t,i){var n=this.getContext(),r=this.getEventContext(i,n),o=this.locateEvent(i,n.$touch?r:null);if(!o)return!1;var a=this.view.getItemNode(o);return o!=n.target&&(webix.html.addCss(a,"webix_gantt_link_visible",!0),n.target=o),a},$dragPos:function(e){var t=this.getContext(),i=this.view.getScrollState();t.end={x:e.x+i.x,y:e.y+i.y},this.master.Action({action:"temp-link",start:t.start,end:t.end})},$dragOut:function(e,t,i,n){var r=this.getContext(),o=this.getEventContext(n,r),a=this.locateEvent(n,r.$touch?o:null);if(r.target&&a!=r.target){var s=this.view.getItemNode(r.target);webix.html.removeCss(s,"webix_gantt_link_visible"),r.target=null}return null},$drop:function(e,t,i){var n=this.getContext(),r=n.id,o=this.getEventContext(i,n),a=this.locateEvent(i,n.$touch?o:null);if(!a||r==a)return!1;var s=this.view.getItemNode(a).getBoundingClientRect(),l=o.x-s.left<s.width/2,c=n.linkType=(n.fromStart?1:0)+(l?0:2);n.targetId=a,this.master.app.callEvent("bars:beforedrop",[this.view.getItem(r),n])&&this.master.Action({action:"add-link",source:r,target:a,type:c})}},move:{dragScroll:{direction:"x"},$dragPos:function(e){var t=this.getContext(),i=t.node,n=t.l,r=t.t,o=t.x,a=t.id,s=t.scroll,l=this.view.getScrollState(),c=t.dx=e.x-o-s.x+l.x;e.x=n+c,e.y=r,this.master.Action({action:"drag-task",id:a,left:e.x,width:parseInt(i.style.width)}),this.master.app.config.split&&this.master.Action({action:"split-resize",id:a})}},progress:{$dragCreate:function(e,t,i){var n=this.getContext(),r=this.view.getItemNode(i),o=this.view.getItem(i).progress,a=r.querySelector(".webix_gantt_progress"),s=this.getEventContext(t,n),l=this.view.getScrollState();if(webix.extend(n,{id:i,node:r,prevProgress:o,progressNode:a,from:this.view,x:s.x,w:parseInt(r.style.width),scroll:l},!0),!this.master.app.callEvent("bars:beforedrag",[this.view.getItem(i),n]))return!1;e.style.cursor="ew-resize",webix.html.addCss(e,"webix_gantt_in_action",!0),webix.html.addCss(r,"webix_gantt_mode_progress",!0);var c=webix.html.create("div",{visibility:"hidden"});return document.body.appendChild(c),c},$dragPos:function(e){var t=this.getContext(),i=t.x,n=t.scroll,r=t.w,o=t.node,a=this.view.getScrollState(),s=e.x-i-n.x+a.x,l=Math.min(Math.max(t.prevProgress+Math.round(100*s/r),0),100);t.progress!=l&&(t.progress=l,X[t.mode].updateTaskTemplate.call(this,t,l)),o.style.zIndex="3",o.style.boxShadow={contrast:"#393939",dark:"#20262B"}[webix.skin.$name||"#ffffff"]+" -1px 0px 0px"},$drop:function(){var e=this.getContext(),t=e.id,i=e.progress,n=e.prevProgress;!webix.isUndefined(i)&&i!=n&&this.master.app.callEvent("bars:beforedrop",[this.view.getItem(t),e])&&(e.$waitUpdate=this.master.Action({action:"update-task-progress",progress:i,id:t}))},$dragDestroy:function(e,t){var i=this,n=this.getContext();return n.$waitUpdate?n.$waitUpdate.catch((function(){i.master.Action({action:"update-task-progress",id:n.id})})):n.$waitUpdate=this.master.Action({action:"update-task-progress",id:n.id}),e.style.cursor="",webix.html.removeCss(e,"webix_gantt_in_action"),webix.html.removeCss(n.node,"webix_gantt_mode_progress"),webix.html.remove(t),!1},updateTaskTemplate:function(e,t){var i=e.progressNode;i.style.width=t+"%",i.innerHTML=this.master.DragProgressTemplate(t)}},start:Q,end:Q,split:{$dragCreate:function(e,t){var i=webix.html.create("DIV",{class:"webix_gantt_split_selection"}),n=this.Local.getScales(),r=this.view.getScrollState(),o=t.target.getBoundingClientRect(),a=Math.floor((t.y-o.y+r.y)/n.cellHeight),s=t.x-o.x;i.style.top=a*n.cellHeight+6+"px",i.style.left=s+r.x+"px",i.style.height=n.cellHeight-14+"px",i.style.width="0px";var l=n.cellWidth;if(n.precise){var c=this.master.app.getService("helpers").getSmallerCount(n.minUnit);l=Math.round(l/("number"==typeof c?c:c()))}var u=this.getContext();webix.extend(u,{from:this.view,node:i,start:{offsetX:s,clientX:t.clientX},index:a,step:l,scroll:r},!0),e.appendChild(i);var h=webix.html.create("div",{visibility:"hidden"});return document.body.appendChild(h),h},$dragPos:function(e){var t=this.getContext(),i=t.dx=e.x-t.start.clientX;e.x<t.start.clientX?(t.node.style.left=t.start.offsetX+t.scroll.x+i+"px",t.node.style.width=-i+"px"):(t.node.style.left=t.start.offsetX+t.scroll.x+"px",t.node.style.width=e.x-t.start.clientX+"px")},$drop:function(){var e=this.getContext(),t=this.view.getIdByIndex(e.index),i=Math.round((e.start.offsetX+e.scroll.x)/e.step),n=Math.round(e.dx/e.step);n<0&&(i+=n,n*=-1),this.master.Action({action:"add-task",id:t,dates:{start:i,end:n}})},$dragDestroy:function(e,t){var i=this.getContext();return webix.html.remove(t),webix.html.remove(i.node),!1}}},J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;this.State=this.getParam("state",!0);var t=this.app.getService("locale")._;return{view:"abslayout",css:this.State.readonly||!this.app.config.links?"webix_gantt_readonly":"",borderless:!0,cells:[{view:"template",css:"webix_gantt_holidays",borderless:!0,relative:!0},{view:"template",css:"webix_gantt_links",borderless:!0,relative:!0},{view:"list",borderless:!0,type:this.BarsType(t),css:"webix_gantt"+(webix.env.touch?"_touch":"")+"_bars",on:{onItemClick:function(t){return e.ItemClickHandler(t)}},tooltip:function(i){return e.GetTooltip(i,t)},scroll:"xy",relative:!0}]}},t.prototype.init=function(e){var t=this,i=e.getChildViews(),n=i[0],r=i[1],o=i[2];this.Holidays=n,this.Links=r,this.Bars=o,this.Ops=this.app.getService("operations"),this.Helpers=this.app.getService("helpers");var a=this.Local=this.app.getService("local"),s=a.getScales(),l=a.links(),c=this.LinksData=l.data;this.Calendars=this.app.config.resourceCalendars,this.HandleScroll(),this.HandleDrag(s),this.HandleSelection(s),this.InitMarkers(),this.HandleHolidays(s),this.on(this.State.$changes,"display",(function(e,i){t.SyncData(!0),i&&(t.Local.refreshLinks(),t.RefreshLinks(),t.Calendars&&t.RenderResourceHolidays())})),this.DrawGrid(e,s),this.Calendars&&this.RenderResourceHolidays(s),this.on(this.app,"onScalesUpdate",(function(i){t.DrawGrid(e,i),t.Bars.refresh(),t.RefreshLinks()})),this.on(this.VisibleTasks.data,"onStoreUpdated",(function(e,i,n){t.RefreshLinks(),"update"!==n&&t.ApplySelection(),!n&&t.Calendars&&t.RenderResourceHolidays()})),this.on(c,"onStoreUpdated",(function(){t.RefreshLinks()})),this.on(this.State.$changes,"criticalPath",(function(e,i){webix.isUndefined(i)||(t.Local.showCriticalPath(!e),t.RefreshLinks())})),this.on(this.State.$changes,"compact",(function(){t.RefreshLinks()})),this.Calendars&&this.on(this.Local.assignments().data,"onStoreUpdated",(function(e,i,n){if(t.RenderResourceHolidays(),t.app.config.excludeHolidays&&n){var r=t.Local.tasks().getItem(i.task);r&&t.Ops.updateAssignedTaskDates(r)}})),this.on(this.State.$changes,"baseline",(function(e,i){webix.isUndefined(i)||t.Local.updateScaleMinMax(t.VisibleTasks)}))},t.prototype.ItemClickHandler=function(e){this.Bars.getItem(e).$group||this.State.$batch({parent:null,selected:e})},t.prototype.DrawGrid=function(e,t){e.$view.style.backgroundImage="url("+this.app.getService("helpers").drawGridInner(t.cellWidth,t.cellHeight,{contrast:"#808080",dark:"#384047"}[webix.skin.$name]||"#ccc")+")",e.$view.style.marginTop="0px";var i=this.app.getState();e.$view.style.backgroundPosition="-"+i.left+"px -"+i.top+"px",this.Resize(t.width)},t.prototype.SyncData=function(e){var t=this;this.Bars.clearAll(),this.VisibleTasks=this.Local.getVisibleTasksCollection(),this.Calendars?this.Local.taskCalendarMap().then((function(){t.Bars.sync(t.VisibleTasks)})):this.Bars.sync(this.VisibleTasks),this.ApplySelection(e)},t.prototype.BarsTemplate=function(e,t){var i=e.text||(e.$group?t("Unassigned"):t("(no title)"));return"milestone"==e.type?"<span>"+i+"</span>":i},t.prototype.BarsType=function(e){var t=this;return{template:function(i){if("tasks"===t.State.display&&"split"===i.type&&i.$data&&i.$data.length){var n=t.GetSplitBox(i),r=n.height,o=n.width,a=n.left,s=n.top,l='<div class="webix_gantt_split_container" webix_s_id="'+i.id+'" style="top:'+s+"px;left:"+a+"px;height:"+r+"px;width:"+o+'px;"></div>',c=t.VisibleTasks.data.order,u=c.length>1&&i.id==c[c.length-1];return i.$data.forEach((function(i){l+=t.TemplateStart(i,u,!0)+t.BarsTemplate(i,e)+t.TemplateEnd(i)})),l}return t.BarsTemplate(i,e)},templateStart:function(e){if("tasks"===t.State.display&&"split"===e.type&&e.$data&&e.$data.length)return"";var i=t.VisibleTasks.data.order,n=i.length>1&&e.id==i[i.length-1];return t.TemplateStart(e,n)},templateEnd:function(e){return"tasks"===t.State.display&&"split"===e.type&&e.$data&&e.$data.length?"":t.TemplateEnd()}}},t.prototype.GetSplitBox=function(e){var t=e.$data[0],i=e.$data[e.$data.length-1],n=i.$x+("milestone"==i.type?Math.floor(i.$w/2):0),r="milestone"==t.type?Math.floor(t.$w/2):t.$w;return{top:t.$y,left:n,height:t.$h,width:t.$x-n+r}},t.prototype.TemplateStart=function(e,t,i){var n=e.$w,r=e.$h,o=0,a="",s=this.BarCSS(e,t),l=this.ContentCss(e);if("milestone"==e.type)n=r=Math.ceil(Math.sqrt(Math.pow(e.$w,2)/2)),o=Math.ceil((e.$w-n)/2);else{var c="task"==e.type?this.DragProgressTemplate(e.progress):"";a='<div class="webix_gantt_progress" style="width:'+e.progress+'%;">'+c+"</div>"}var u="";return this.State.baseline&&"milestone"!==e.type&&e.planned_start&&!i&&(u=this.TemplateBaseline(e)),u+'<div webix_l_id="'+e.id+'" class="'+s+'" \n\t\t\tstyle="left:'+(e.$x+o)+"px;top:"+(e.$y+o-(u?1:0))+"px;width:"+n+"px;height:"+r+'px;" \n\t\t\tdata-id="'+e.id+'">\n\t\t\t\t<div class="webix_gantt_link webix_gantt_link_left"></div>\n\t\t\t\t'+a+'\n\t\t\t\t<div class="webix_gantt_content '+l+'">'},t.prototype.TemplateBaseline=function(e){return'<div  \n\t\t\tclass="webix_gantt_baseline_'+e.type+'" \n\t\t\tstyle="left:'+e.$x0+"px;top:"+(e.$y+e.$h-2)+"px;width:"+e.$w0+'px; " \n\t\t\tdata-baseid="'+e.id+'"></div>'},t.prototype.BarCSS=function(e,t){var i="webix_gantt_task_base webix_gantt_"+("split"===e.type?"task":e.type);return e.$critical&&(i+=" webix_gantt_critical"),e.$group&&(i+=" webix_gantt_group"),t&&(i+=" webix_gantt_last"),e.css&&"milestone"!=e.type&&(i+=" "+e.css),i},t.prototype.ContentCss=function(e){return e.css&&"milestone"==e.type?" "+e.css:""},t.prototype.TemplateEnd=function(){return'</div><div class="webix_gantt_link webix_gantt_link_right"></div></div>'},t.prototype.DragProgressTemplate=function(e){return'<div class="webix_gantt_progress_drag" style="left:'+e+'%">\n\t\t\t<span class="webix_gantt_progress_percent">'+e+"</span>\n\t\t</div>"},t.prototype.HandleDrag=function(){var e=this;W.call(this,this.Bars),this._mousemove_handler=webix.event(this.Bars.$view,"pointermove",(function(t){"mouse"==t.pointerType&&function(e,t){if(!webix.DragControl.active){var i=webix.html.locate(e,"webix_l_id");if(i&&"task"==t.getItem(i).type){var n=t.getItemNode(i),r=Y(n,e.clientX);n.style.cursor="move"==r?"pointer":"ew-resize"}}}(t,e.Bars)}))},t.prototype.destroy=function(){this._mousemove_handler=webix.eventRemove(this._mousemove_handler),this._scroll_handler=webix.eventRemove(this._scroll_handler);var e=this.app.config.markers;if(e)for(var t=0;t<e.length;t++){var i=e[t];i.$interval&&(i.$interval=clearInterval(i.$interval))}},t.prototype.GetLinks=function(e){return this.Links.$view.querySelector(".webix_gantt_"+(e?"temp_line":"lines"))},t.prototype.HandleScroll=function(){var e=this;this._scroll_handler=webix.event(this.Bars.$view,"scroll",(function(t){var i=t.target,n=Math.round(i.scrollTop),r=Math.round(i.scrollLeft);if(e.holidaysContainer.style.height="0px",e.containerForMarkers.style.height="0px",e.app.config.links){var o=e.GetLinks(),a=e.GetLinks(!0),s={viewBox:r+" "+n+" "+i.scrollWidth+" "+i.scrollHeight,width:i.scrollWidth,height:i.scrollHeight};for(var l in s)o.setAttribute(l,s[l]),a.setAttribute(l,s[l])}e.SetHolidaysScroll(i.scrollHeight,r,n),e.containerForMarkers.style.height=i.scrollHeight+"px",e.getRoot().$view.style.backgroundPosition="-"+r+"px -"+n+"px",e.State.$batch({top:n,left:r})})),this.on(this.State.$changes,"top",(function(t){e.Bars.scrollTo(e.State.left,t)})),this.app.config.resources&&(this.on(this.State.$changes,"left",(function(t){e.State.resourcesDiagram&&e.Bars.scrollTo(t,e.State.top)})),this.on(this.app,"rdiagram:resize",(function(){e.holidaysContainer.style.height=e.Bars.$view.scrollHeight+"px",e.containerForMarkers.style.height=e.Bars.$view.scrollHeight+"px"})))},t.prototype.SetHolidaysScroll=function(e,t,i){this.holidaysContainer.style.height=e+"px",this.holidaysContainer.style.left=-t+"px",this.holidaysContainer.style.top=-i+"px",this.Calendars&&(this.resHolidaysContainer.style.height=e+"px",this.resHolidaysContainer.style.left=-t+"px",this.resHolidaysContainer.style.top=-i+"px")},t.prototype.HandleSelection=function(e){var t=this;this.selLine=webix.html.create("DIV",{class:"webix_gantt_bar_selection",style:"height:"+e.cellHeight+"px;width:"+e.width+"px"}),this.Bars.$view.insertBefore(this.selLine,this.Bars.$view.firstChild),this.on(this.State.$changes,"selected",(function(){return t.ApplySelection()}))},t.prototype.ApplySelection=function(e){var t=this.State.selected,i=-100;if(t&&this.Bars.data.order.length){var n=i=this.Bars.getIndexById(t),r=this.Bars.getItem(t);n<0&&("tasks"==this.State.display&&r&&0!=r.parent&&"split"===this.Bars.getItem(r.parent).type?n=this.Bars.getIndexById(r.parent):e&&!this.Bars.exists(t)&&(this.State.selected=null)),i=n*this.Local.getScales().cellHeight,this.ScrollToTask(r)}this.selLine.style.top=i+"px"},t.prototype.ScrollToTask=function(e){if(e){var t=this.Bars;(e.$x>t.$width-this.Local.getScales().cellWidth||e.$x<t.$view.scrollLeft)&&(this.State.left=e.$x-30)}this.Bars.scrollTo(this.State.left,this.State.top)},t.prototype.InitMarkers=function(){var e=this;this.containerForMarkers=webix.html.create("DIV",{class:"webix_gantt_markers",style:"height:"+this.Bars.$view.scrollHeight+"px"}),this.Bars.$view.insertBefore(this.containerForMarkers,this.Bars.$view.firstChild),this.RenderMarkers(this.app.config.markers),this.on(this.app,"onScalesUpdate",(function(){return e.RenderMarkers(e.app.config.markers)}))},t.prototype.RenderMarkers=function(e){var t=this;if(e){for(var i=[],n=0;n<e.length;n++){var r=e[n];r.now&&(r.start_date=new Date,r.$interval||(r.$interval=setInterval((function(e){t.containerForMarkers.querySelector('[gantt_now="'+e.$interval+'"]').style.left=t.GetMarkerPosition(new Date)+"px"}),3e5,r))),i.push(this.MarkerTemplate(e[n]))}this.containerForMarkers.innerHTML=i.join("")}},t.prototype.MarkerTemplate=function(e){var t=e.text?'<span class="webix_gantt_marker_text">'+e.text+"</span>":"";return'<div\n\t\t\tgantt_now="'+e.$interval+'"\n\t\t\tclass="webix_gantt_marker '+(e.css||"")+'"\n\t\t\tstyle="left:'+this.GetMarkerPosition(e.start_date)+'px">'+t+"</div>"},t.prototype.GetMarkerPosition=function(e){var t=this.Local.getScales(),i=t.start,n=t.end,r=t.cellWidth,o=t.diff,a=t.minUnit,s=this.Helpers.getUnitStart(a,i);return e<i||e>n?-100:Math.round(o(e,s,webix.Date.startOnMonday,!0)*r)},t.prototype.LinksTemplate=function(e,t){var i=this.Bars.$view;return'<svg\n\t\t\tclass="'+t+'"\n\t\t\tviewBox="'+this.State.left+" "+this.State.top+" "+i.scrollWidth+" "+i.scrollHeight+'"\n\t\t\twidth="'+i.scrollWidth+'"\n\t\t\theight="'+i.scrollHeight+'"\n\t\t>'+e+"</svg>"},t.prototype.RefreshLinks=function(){var e=this,t=[];if(this.LinksData.count()&&this.VisibleTasks.count()){var i=this.LinksData;i.order.each((function(n){var r=i.getItem(n);if(r.$p){var o=e.State.criticalPath&&e.Local.isLinkCritical(r);t.push('<polyline data-id="'+n+'" '+(o?"class='webix_gantt_line_critical'":"")+' points="'+r.$p+'" />')}}))}var n=this.LinksTemplate(t.join(""),"webix_gantt_lines")+this.LinksTemplate('<polyline points="" />',"webix_gantt_temp_line");this.Links.setHTML(n)},t.prototype.RefreshTaskLinks=function(e){var t=this;this.LinksData.find((function(t){return t.source==e||t.target==e})).forEach((function(e){var i=t.Links.$view.querySelector('[data-id="'+e.id+'"]');if(i){var n=t.VisibleTasks.getItem(e.source),r=t.VisibleTasks.getItem(e.target);t.Helpers.updateLink(e,n,r),i.setAttribute("points",e.$p)}}))},t.prototype.Resize=function(e){var t=this.Bars.$view.querySelector(".webix_scroll_cont");t.style.width=e+"px",t.style.minHeight="1px",this.selLine&&(this.selLine.style.width=e+"px")},t.prototype.Action=function(e){var t=this.app.getService("operations"),i=null;if("update-task-time"===e.action)e.time?i=t.updateTaskTime(e.id,e.mode,e.time):(this.Local.refreshTasks(e.id),"resources"===this.State.display&&this.VisibleTasks.refresh(e.id),this.RefreshTaskLinks(e.id));else if("update-task-progress"===e.action)if(webix.isUndefined(e.progress)){var n=this.VisibleTasks.getItem(e.id);this.Bars.render(e.id,n,"paint")}else i=t.updateTask(e.id,{progress:e.progress});else if("drag-task"===e.action)(n=this.VisibleTasks.getItem(e.id)).$x=parseInt(e.left),n.$w=parseInt(e.width),this.RefreshTaskLinks(e.id);else if("add-link"===e.action){var r=e.source,o=e.target,a=e.type;i=t.addLink({source:r,target:o,type:a})}else if("temp-link"===e.action){var s=e.start,l=e.end,c=this.GetLinks(!0).firstChild;if(s){var u=this.app.getService("helpers").newLink(this.Links.$view.getBoundingClientRect(),s,l),h=u.left,p=u.top,d=u.p,_=[h,p],f=d.split(",").map((function(e,t){return 1*e+_[t%2]})).join(",");c.setAttribute("points",f)}else c.setAttribute("points","")}else if("add-task"===e.action){var b=this.Local.getScales(),g=b.precise?this.Helpers.getSmallerUnit(b.minUnit):b.minUnit;s=this.Helpers.addUnit(g,b.start,e.dates.start),l=this.Helpers.addUnit(g,s,e.dates.end),this.app.callEvent("task:add",[e.id,{start:s,end:l}])}else if("split-resize"===e.action&&"resources"!==this.State.display&&0!=(n=this.VisibleTasks.getItem(e.id)).parent){var w=this.VisibleTasks.getItem(n.parent);if("split"===w.type){var A=this.Bars.$view.querySelector('[webix_s_id="'+n.parent+'"]');w.$data.sort((function(e,t){return t.$x-e.$x}));var x=this.GetSplitBox(w),v=x.width;h=x.left,A.style.width=v+"px",A.style.left=h+"px"}}return i||webix.promise.resolve()},t.prototype.HandleHolidays=function(e){var t=this,i="<div class='webix_gantt_bar_holidays' style='height:"+this.Bars.$view.scrollHeight+"px'></div>";this.Calendars&&(i+="<div class='webix_gantt_bar_resource_holidays' style='height:"+this.Bars.$view.scrollHeight+"px'></div>"),this.Holidays.setHTML(i),this.holidaysContainer=this.Holidays.$view.querySelector(".webix_gantt_bar_holidays"),this.resHolidaysContainer=this.Holidays.$view.querySelector(".webix_gantt_bar_resource_holidays"),this.RenderHolidays(e),this.on(this.app,"onScalesUpdate",(function(e){return t.RenderHolidays(e)})),this.on(this.app.getRoot(),"onViewShow",(function(){t.refresh()}))},t.prototype.EachScaleDate=function(e,t){if("day"===e.minUnit||"hour"===e.minUnit){var i=webix.Date.copy(e.start),n=webix.Date.dayStart(e.end);e.end-n||(n=webix.Date.add(n,-1,"day",!0));for(var r=e.start.getHours();i<=n;)t.call(this,i,r),i=webix.Date.add(webix.Date.dayStart(i),1,"day",!0),r=webix.Date.equal(i,n)?24-Math.ceil(webix.Date.timePart(e.end)/60/60):0}},t.prototype.RenderHolidays=function(e){var t=this;if(this.holidaysContainer){var i="";this.EachScaleDate(e,(function(n,r){e.isHoliday(n)&&(i+=t.HolidayTemplate(e,n,r))})),this.holidaysContainer.innerHTML=i,this.Calendars&&this.RenderResourceHolidays(e)}},t.prototype.MarkResourceHolidays=function(e,t,i){var n=this,r=this.Bars.getIndexById(t);if(r<0)return"";var o="",a=0,s=null;return this.EachScaleDate(e,(function(t,l){var c=e.isHoliday(t);n.Helpers.isResourceHoliday(t,i)?c?a&&(o+=n.ResourceHolidayTemplate(e,s,l,r,a),a=0):(a||(s=t),a++):c&&(a&&(o+=n.ResourceHolidayTemplate(e,s,l,r,a),a=0),o+=n.ResourceWorkDayTemplate(e,t,l,r))})),o},t.prototype.RenderResourceHolidays=function(e){var t=this;this.resHolidaysContainer&&(e=e||this.Local.getScales(),this.Local.taskCalendarMap().then((function(i){var n="";if(i)for(var r in i)n+=t.MarkResourceHolidays(e,r,i[r]);t.resHolidaysContainer.innerHTML=n})))},t.prototype.GetDateBox=function(e,t,i,n){var r=this.Helpers.getUnitStart(e.minUnit,e.start),o={x:Math.round(e.diff(t,r)*e.cellWidth),w:("hour"===e.minUnit?24-i:1)*e.cellWidth};return(n||0===n)&&(o.y=e.cellHeight*n,o.h=e.cellHeight),o},t.prototype.HolidayTemplate=function(e,t,i){var n=this.GetDateBox(e,t,i);return"<div class='webix_gantt_holiday' style='left:"+n.x+"px;width:"+n.w+"px;'></div>"},t.prototype.ResourceHolidayTemplate=function(e,t,i,n,r){var o=this.GetDateBox(e,t,i,n),a=o.x,s=o.y;return"<div class='webix_gantt_holiday' style='left:"+a+"px;width:"+o.w*r+"px;top:"+s+"px;height:"+o.h+"px;'></div>"},t.prototype.ResourceWorkDayTemplate=function(e,t,i,n){var r=this.GetDateBox(e,t,i,n),o=r.x,a=r.y;return"<div class='webix_gantt_work_day' style='left:"+(o+.2)+"px;width:"+(r.w-1.2)+"px;top:"+a+"px;height:"+(r.h-1)+"px;'></div>"},t.prototype.GetTooltip=function(e,t){var i=webix.i18n.longDateFormatStr,n=(e.text||t("(no title)"))+"<br>\n\t\t\t<br>"+t("Start date")+": "+i(e.start_date);return"milestone"!=e.type&&(n+="<br>"+t("End date")+": "+i(e.end_date)+"\n\t\t\t<br>"+t("Lasts")+" "+e.duration+" "+(e.duration>1?t("days"):t("day"))),n},t}(h),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{view:"template",height:20,css:"webix_gantt_scale"}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Local=this.app.getService("local");var t=this.Local.getScales();this.RenderScales(t),this.on(this.app,"onScalesUpdate",(function(t){return e.RenderScales(t)}))},t.prototype.ready=function(){var e=this.getRoot();this.on(this.State.$changes,"left",(function(t){return e.scrollTo(t,null)}))},t.prototype.RenderScales=function(e){var t=this,i=this.getRoot(),n=e.rows.map((function(i){var n=("hour"===i.type||"day"===i.type)&&1===i.step;return'<div class="webix_gantt_scale_row" style=\'height:'+i.height+"px;width:"+e.width+"px'>"+i.cells.map((function(e){return t.CellTemplate(e,n)})).join("")+"</div>"})).join("");i.config.height=e.height,i.setHTML(n),i.resize()},t.prototype.CellTemplate=function(e,t){return'<div class="webix_gantt_scale_cell '+e.css+(t&&this.app.config.isHoliday(e.date)?"webix_gantt_holiday_scale":"")+'" style="width:'+e.width+'px;">'+this.FormatDate(e.date,e.format)+"</div>"},t.prototype.FormatDate=function(e,t){return"string"==typeof t&&(t=webix.Date.dateToStr(t)),t(e)},t}(h),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{rows:[Z,J]}},t.prototype.init=function(){var e=this;this.on(this.app,"bars:toggle",(function(t){t?e.getRoot().show():e.getRoot().hide()}))},t}(h),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return this.State=this.getParam("state",!0),{view:"abslayout",css:" webix_gantt_readonly",cells:[{view:"template",css:"webix_gantt_holidays",borderless:!0,relative:!0},{view:"tree",borderless:!0,type:this.WorkloadMarkersType(),css:"webix_gantt"+(webix.env.touch?"_touch":"")+"_bars webix_gantt_resdiagram_chart",scroll:"xy",relative:!0,filterMode:{showSubItems:!1,level:0}}]}},t.prototype.init=function(e){var t=this,i=e.getChildViews(),n=i[0],r=i[1];this.Holidays=n,this.Bars=r,this.LocalState=this.getParam("localState"),this.Unit="hours";var o=this.Local=this.app.getService("local"),a=this.Scales=o.getScales();this.RDCollection=this.app.getService("grouping").getRDCollection(),this.Helpers=this.app.getService("helpers"),this.on(this.Bars.data,"onSyncApply",(function(){t.Scales=t.Local.getScales(),t.RestoreTreeState(),t.Calendars&&t.RenderResourceHolidays()})),this.Bars.sync(this.RDCollection,(function(){this.filter((function(e){return e.$group}))})),this.Calendars=this.app.config.resourceCalendars,this.DrawGrid(e,a),this.HandleScroll(),this.HandleHolidays(a),this.on(this.app,"onScalesUpdate",(function(i){t.DrawGrid(e,i)})),this.on(this.app,"rdiagram:branch:toggle",(function(e,i){t.ToggleBranch(e,i)})),this.on(this.app,"rdiagram:resize",(function(){t.holidaysContainer.style.height=t.Bars.$view.scrollHeight+"px"})),this.on(this.app,"rdiagram:sort",(function(e,i,n){e?t.Bars.sort(e,i,n):t.Bars.sort(n,i)})),this.Calendars&&this.on(this.Local.assignments().data,"onStoreUpdated",(function(){t.RenderResourceHolidays()}))},t.prototype.ToggleBranch=function(e,t){var i=this;t?this.Bars.open(e):this.Bars.close(e);var n=this.Bars.data.getBranch("0"),r=this.Bars.getState().open.filter((function(e){return n.find((function(t){return t.id==e}))}));this._treeOpened=r.map((function(e){return i.Bars.getIndexById(e)})),this.holidaysContainer.style.height=this.Bars.$view.clientHeight+"px",this.Calendars&&(this.resHolidaysContainer.style.height=this.Bars.$view.clientHeight+"px",this.RenderResourceHolidays())},t.prototype.RestoreTreeState=function(){var e=this;if(this._treeOpened&&this._treeOpened.length){var t=this._treeOpened,i=this.Bars.data.getBranch("0");i.forEach((function(n){var r=i.indexOf(n);n.open=!t.indexOf(r),e.Bars.data.callEvent("onStoreUpdated",[n.id,0,"branch"])}))}else this.Bars.openAll()},t.prototype.HandleScroll=function(){var e=this;this._scroll_handler=webix.event(this.Bars.$view,"scroll",(function(t){var i=t.target,n=Math.round(i.scrollTop),r=Math.round(i.scrollLeft);e.getRoot().$view.style.backgroundPosition="-"+r+"px -"+n+"px",e.State.left=r,e.LocalState.top=n,e.SetHolidaysScroll(i.scrollHeight,r,n)})),this.on(this.LocalState.$changes,"top",(function(t){e.Bars.scrollTo(e.State.left,t)})),this.on(this.State.$changes,"left",(function(t){e.Bars.scrollTo(t,e.LocalState.top)})),this.on(this.app,"rdiagram:unit:change",(function(t){e.Unit=t,e.Bars.render()}))},t.prototype.WorkloadMarkersType=function(){var e=this;return{template:function(t){return e.MarkerTemplate(t)},templateStart:function(t,i){return e.MarkerStartTemplate(t,i)},templateEnd:function(){return"</div>"}}},t.prototype.MarkerStartTemplate=function(e,t){return'<div webix_tm_id="'+e.id+'" style="height:'+(this.Scales.cellHeight-8)+'px; padding: 4px;" class="'+t.classname(e,t)+' webix_gantt_diagram_line" '+t.aria(e)+">"},t.prototype.MarkerTemplate=function(e){if(2===e.$level){var t=this.GetMarkerData(e),i=[];for(var n in t)i.push(this.MarkerToHTML(t[n]));return i.join("")}return""},t.prototype.CheckResourceHoliday=function(e,t){if(this.Calendars){var i=this.Bars.getItem(t).resource_id;if(i){var n=this.Local.resources().getItem(i).calendar_id;if(n){var r=this.Local.calendars().getItem(n);return this.Helpers.isResourceHoliday(e,r)}}}return this.app.config.isHoliday(e)},t.prototype.GetMarkerData=function(e){for(var t={},i=0;i<e.duration.length;++i)for(var n=e.duration[i],r=e.units[i],o=e.$x[i]-Math.min.apply(Math,e.$x),a=this.Scales.cellHeight>40?28:20,s=this.Scales.cellWidth-a,l=Math.round(s/2),c=o?-2:l,u=webix.Date.copy(e.start_date[i]),h=0;h<n;++h,c+=s){if(this.app.config.excludeHolidays&&this.CheckResourceHoliday(u,e.id))++n;else{var p;p="hour"!==this.Scales.minUnit&&(h===n-1?r[1]:h?r[2]:r[0])||r[2];var d=e.$x[i]+h*this.Scales.cellWidth-2;t[d]?(t[d].hours+=p,t[d].count+=1):t[d]={hours:p,x:d+l,count:1},t[d].overloaded=this.CheckOverload(t[d],e)}webix.Date.add(u,1,this.Scales.minUnit)}return t},t.prototype.CheckOverload=function(e){return"hour"===this.Scales.minUnit?Math.round(24*e.hours)>this.Helpers.unitLoadNorm.day:e.hours>this.Helpers.unitLoadNorm[this.Scales.minUnit]},t.prototype.MarkerToHTML=function(e){var t=e.overloaded?"webix_gantt_overload":"",i="hours"===this.Unit?e.hours>=1?e.hours:" ":e.count;return'<div class="webix_gantt_diagram_marker '+t+'" style="left:'+e.x+'px;">'+i+"</div>"},t.prototype.RenderResourceHolidays=function(e){var t=this;e=e||this.Local.getScales();var i="";this.Bars.data.each((function(n){if(n.resource_id){var r=t.Local.resources().getItem(n.resource_id).calendar_id;r&&(i+=t.MarkResourceHolidays(e,n.id,t.Local.calendars().getItem(r)))}})),this.resHolidaysContainer.innerHTML=i},t}(J);function ie(e){return function(t,i){return t[e].localeCompare(i[e],void 0,{ignorePunctuation:!0,numeric:!0})}}function ne(e,t){return e&&e.length==t.length&&e.every((function(e){return t.includes(e)}))}var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;this.State=this.getParam("state",!0);var t=this.app.getService("local").getScales(),i=this._=this.app.getService("locale")._,n=this.Compact=this.getParam("compact",!0),r=[{id:"name",css:"webix_gantt_title",header:n?"<span class='webix_icon gti-menu'>":i("Name"),template:function(t,i){return e.TreeTemplate(t,i)},fillspace:!0,sort:n?"":ie("name"),minWidth:n?44:150},{id:"load",header:i("Hours"),hidden:n,batch:"hours",sort:"int",minWidth:50,resize:!1},{id:"count",header:i("Tasks"),batch:"tasks",sort:"int",minWidth:50,hidden:!0,resize:!1}],o=webix.skin.$name,a={view:"treetable",css:"webix_gantt_resdiagram_tree "+("material"==o||"mini"==o?"webix_header_border":""),prerender:!0,borderless:"contrast"===o,width:n?44:this.State.treeWidth,rowHeight:t.cellHeight,headerRowHeight:t.height,scroll:"xy",scrollAlignY:!1,sort:!0,resizeColumn:{headerOnly:!0,size:10},columns:r,tooltip:function(){return""},on:{onViewResize:function(){e.State.treeWidth=e.Tree.$width},onAfterOpen:function(t){return e.ToggleBranch(t,1)},onAfterClose:function(t){return e.ToggleBranch(t,0)},onAfterSort:function(t,i,n){return e.SortTasks(t,i,n)},onColumnResize:function(t,i,n,r){return e.NormalizeColumns(t,r)}},onClick:{"gti-menu":function(){return e.ToggleColumns()}},filterMode:{showSubItems:!1,level:0}},s=this.LocalState=this.getParam("localState");return a.on.onScrollY=a.on.onSyncScroll=a.on.onAfterScroll=function(){s.top=this.getScrollState().y},a},t.prototype.init=function(e){var t=this;this.Tree=e,this.Helpers=this.app.getService("helpers"),this.Local=this.app.getService("local"),this.RDCollection=this.app.getService("grouping").getRDCollection(),this._unit="hours",this._collapsed=!0,this.on(this.LocalState.$changes,"top",(function(e){t.Tree.scrollTo(null,e)})),this.on(this.Tree.data,"onSyncApply",(function(){return t.RestoreTreeState()})),e.sync(this.RDCollection,(function(){this.filter((function(e){return e.$group}))})),this.on(this.State.$changes,"treeWidth",(function(i){t.Compact||e.$width===i||(e.define({width:i}),e.resize())})),this.on(this.app,"rdiagram:unit:change",(function(e){return t.ShowInUnits(e)})),this.on(this.app,"onScalesUpdate",(function(e){var i=t.Tree.columnId(0);t.Tree.getColumnConfig(i).header[0].height=e.height,t.Tree.refreshColumns()}))},t.prototype.RestoreTreeState=function(){var e=this;if(this._treeOpened&&this._treeOpened.length){var t=this._treeOpened,i=this.Tree.data.getBranch("0");i.forEach((function(n){var r=i.indexOf(n);n.open=!t.indexOf(r),e.Tree.data.callEvent("onStoreUpdated",[n.id,0,"branch"])}))}else this.Tree.openAll()},t.prototype.TreeTemplate=function(e,t){var i=this.Compact&&this._collapsed;return 1==e.$level?i?t.icon(e):t.treetable(e,t)+e.category:i?this.Helpers.resourceAvatar(e):t.space(e)+this.Helpers.resourceAvatar(e)+e.name},t.prototype.ShowInUnits=function(e){this._unit=e;var t=this.Tree,i=t.config.columns,n=i[i.length-1].fillspace;this.Compact&&this._collapsed||t.showColumnBatch(e),this.SetColumns(0,n)},t.prototype.NormalizeColumns=function(e,t){t&&this.SetColumns(this.Tree.getColumnIndex(e),!0)},t.prototype.SetColumns=function(e,t){var i=this.Tree.config.columns,n=i.length-1;0===e?(i[n].fillspace=t,i[n].width=0,i[n].resize=!1):e===n&&(i[0].fillspace=!0,i[0].width=0),this.Tree.refreshColumns()},t.prototype.ToggleColumns=function(){var e=this.Tree,t=e.isColumnVisible("load"),i=e.isColumnVisible("count"),n=this._collapsed=t||i;n?(t&&e.hideColumn("load"),i&&e.hideColumn("count")):"hours"===this._unit?e.showColumn("load"):e.showColumn("count"),e.config.width=n?44:0,e.config.columns[0].minWidth=n?44:150,e.resize(),e.refreshColumns(),this.app.callEvent("rdiagram:tree:toggle",[n])},t.prototype.ToggleBranch=function(e,t){var i=this,n=this.Tree.data.getBranch("0"),r=this.Tree.getState().open.filter((function(e){return n.find((function(t){return t.id==e}))}));this._treeOpened=r.map((function(e){return i.Tree.getIndexById(e)})),this.app.callEvent("rdiagram:branch:toggle",[e,t])},t.prototype.SortTasks=function(e,t,i){this.app.callEvent("rdiagram:sort",[e,t,i])},t}(h),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=this.getParam("compact",!0),n="contrast"===webix.skin.$name,r=this.app.getService("local").getScales().minUnit;return{type:n?"clean":"line",rows:[{view:"toolbar",borderless:n,elements:[{},{view:"radio",width:330,value:"hours",localId:"radio",options:[{id:"hours",value:t("Hours per")+" "+t(r)},{id:"tasks",value:t("Tasks per")+" "+t(r)}],on:{onChange:function(t){e.app.callEvent("rdiagram:unit:change",[t])}}}]},{type:"clean",cols:[re,{view:i?"spacer":"resizer",css:"webix_gantt_resizer",width:i?1:4},{localId:"diagram",rows:[Z,te]}]}]}},t.prototype.init=function(){var e=this,t=z({top:0});this.setParam("localState",t),this.on(this.app,"rdiagram:tree:toggle",(function(t){t?e.$$("diagram").show():e.$$("diagram").hide()}));var i=this.app.getService("locale")._,n=this.$$("radio");this.on(this.app,"onScalesUpdate",(function(e,t){e.minUnit!==t.minUnit&&(n.config.options.map((function(t){var n=t.value.split(" ");n[n.length-1]=i(e.minUnit),t.value=n.join(" ")})),n.refresh())}))},t}(h),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._,i={css:"webix_gantt_datepicker",type:"calendar",body:{height:270,width:250,icons:!0,events:function(t){return e.app.config.isHoliday(t)&&"webix_cal_event"}}};return{view:"form",localId:"form",borderless:!0,autoheight:!0,elementsConfig:{labelPosition:"top"},padding:{left:3,right:3},visibleBatch:"added",elements:[{batch:"added",rows:[{view:"datepicker",name:"planned_start",label:t("Start date"),suggest:webix.copy(i)},{view:"datepicker",name:"planned_end",label:t("End date"),suggest:webix.copy(i)},{view:"counter",name:"planned_duration",css:"webix_gantt_form_counter",min:1,max:1e3,label:t("Duration")}]},{batch:"none",cols:[{view:"button",type:"icon",icon:"wxi-plus",autowidth:!0,label:t("Add dates"),click:function(){return e.AddBtnClickHandler()},css:"webix_transparent"},{}]},{batch:"added",cols:[{},{view:"button",type:"icon",icon:"wxi-trash",autowidth:!0,label:t("Remove dates"),click:function(){return e.RemoveBtnClickHandler()},css:"webix_transparent"},{}]}],on:{onChange:function(t,i,n){e.Compact?e.UpdateTaskTime():"user"==n&&e.UpdateTask()}}}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Ops=this.app.getService("operations"),this.Form=this.$$("form"),this.Tasks=this.app.getService("local").tasks(),this.on(this.State.$changes,"selected",(function(t){t&&e.FillData(t)})),this.on(this.Tasks.data,"onStoreUpdated",(function(t,i,n){"update"==n&&t==e.State.selected&&e.FillData(t)}))},t.prototype.FillData=function(e){this.Tasks.getItem(e).planned_start?this.$$("form").showBatch("added"):this.$$("form").showBatch("none"),this.Form.setValues(this.Tasks.getItem(e))},t.prototype.PrepareDates=function(e){var t=this._eventSource=this.Form.$eventSource.config.name,i=!0;return"planned_duration"==t||"planned_start"==t&&"project"==e.type?e.planned_end=null:"planned_end"==t||"planned_start"==t?e.planned_duration=null:i=!1,i},t.prototype.UpdateTaskTime=function(){var e=this.Form.getValues();if(this.PrepareDates(e)){var t=this._eventSource?this._eventSource.split("_")[1]:null;"duration"==t&&(t=null),this.Ops.updatePlannedTaskDuration(e,t),this.Form.blockEvent(),this.Form.setValues(e,!0),this.Form.unblockEvent()}},t.prototype.UpdateTask=function(){var e=this.State.selected,t=this.Form.getValues();this.Compact||this.PrepareDates(t);var i=this._eventSource?this._eventSource.split("_")[1]:null;"duration"==i&&(i=null),this.Ops.updateTask(e,t,i,!1,!0)},t.prototype.AddBtnClickHandler=function(){var e=this.State.selected,t=this.Form.getValues(),i={planned_start:t.start_date,planned_end:t.end_date,planned_duration:t.duration};this.Ops.updateTask(e,i,null,!1,!0)},t.prototype.RemoveBtnClickHandler=function(){var e=this,t=this.State.selected;webix.confirm(this._("Planned dates will be removed, are you sure?")).then((function(){e.Ops.updateTask(t,{planned_start:null,planned_end:null,planned_duration:null},null,!1,!0)}))},t}(h),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i={view:"treetable",css:"webix_gantt_tree webix_gantt_form_tree",header:!1,borderless:!0,localId:"links",autoheight:!0,editable:!0,scroll:!1,hover:"webix_gantt_link_table_hover",scheme:{$group:{by:"ttype"}},columns:[{id:"task",css:"webix_gantt_title",header:t("Task"),fillspace:!0,template:function(e){return e.$group?'<span class="webix_strong">'+t("source"==e.ttype?t("Successors"):t("Predecessors"))+"</span>":e.text||t("(no title)")}},{id:"type",css:"webix_gantt_type",header:t("Link"),width:140,template:function(e,t,i,n){return e.$group?"":n.collection.getItem(i).value+'<span class="webix_icon wxi-menu-down"></span>'},editor:"richselect",options:[{id:"0",value:t("End to start")},{id:"1",value:t("Start to start")},{id:"2",value:t("End to end")},{id:"3",value:t("Start to end")}]},{width:30,css:"webix_gantt_action",template:function(e){return e.$group?"":"<span class='webix_icon wxi-trash'></span>"}}],on:{onBeforeEditStart:function(e){return!this.getItem(e).$group},onBeforeEditStop:function(t,i){if(t.value!=t.old)return e.UpdateLink(i.row,{type:1*t.value}),!1},onAfterLoad:function(){this.openAll()}},onClick:{"wxi-trash":function(i,n){webix.confirm({container:e.app.getRoot().$view,title:t("Delete link"),text:t("The link will be deleted permanently, are you sure?")}).then((function(){return e.DeleteLink(n)}))}}};return{padding:{top:webix.skin.$active.layoutMargin.form,bottom:5},rows:[i]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Ops=this.app.getService("operations"),this.Links=this.$$("links"),this.on(this.State.$changes,"selected",(function(t){t&&e.FillData(t)}));var t=this.app.getService("local").links();this.on(t.data,"onStoreUpdated",(function(t,i){if(i){var n=e.State.selected;i.target!==n&&i.source!==n||e.FillData(n)}}))},t.prototype.FillData=function(e){var t=this.app.getService("local"),i=t.getLinks(e,"target").concat(t.getLinks(e,"source"));this.Links.clearAll(),i.length?(this.Links.parse(i),this.getRoot().show()):this.getRoot().hide()},t.prototype.UpdateLink=function(e,t){var i=this;this.Ops.updateLink(e,t).then((function(){i.Links.blockEvent(),i.Links.editCancel(),i.Links.unblockEvent(),t.type+="",i.Links.updateItem(e,t)}))},t.prototype.DeleteLink=function(e){var t=this;this.Ops.removeLink(e).then((function(){t.FillData(t.State.selected)}))},t}(h);webix.editors.gantt_numeditor=webix.extend({render:function(){var e=webix.editors.text.render.call(this),t=e.querySelector("input");return t.type="number",t.min=0,e}},webix.editors.text);var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;this.Local=this.app.getService("local"),this.Helpers=this.app.getService("helpers");var i=this.app.config,n=this.IsSingle="single"==i.resources||i.resourceCalendars,r={cols:[{view:"button",type:"icon",icon:"wxi-plus",autowidth:!0,localId:"addBtn",label:t("Add assignment"),click:function(){return e.AddBtnClickHandler()},css:"webix_transparent"},{}]},o={view:"treetable",css:"webix_gantt_resource_table webix_gantt_tree webix_gantt_form_tree",header:!1,borderless:!0,localId:"resources",autoheight:!0,editable:!0,editaction:"custom",scroll:!1,hover:"webix_gantt_table_hover",rowHeight:Math.max(webix.skin.$active.rowHeight,32),columns:[{id:"resource",css:"webix_gantt_title",fillspace:!0,template:function(t){return e.ResourceTemplate(t)},editor:"richselect",suggest:{width:250,css:"webix_gantt_select_editor_popup",padding:0,point:0,body:{width:250,type:{height:Math.max(webix.skin.$active.listItemHeight,32)},template:function(t){return n?e.OptionTemplate(t):e.EditorOptionTemplate(t)}}}},{id:"value",width:85,css:"webix_gantt_value",template:function(t){return e.ValueTemplate(t)},editFormat:function(e){return parseFloat(e)},editParse:function(e){return e=parseFloat(e),isNaN(e)?0:e},editor:"gantt_numeditor"},{id:"remove",width:30,css:"webix_gantt_action",template:function(t){return e.DeleteIconTemplate(t)}}],on:{onItemClick:function(t){e.Table.getItem(t).$group||"remove"==t.column||(e.Table.editRow(t),"value"==t.column&&e.Table.getEditor(t.row,"resource").getPopup().hide(),e.Table.getEditor(t.row,t.column).focus())},onBeforeEditStart:function(t){var i=e.Table.getItem(t.row);if(i.$group)return!1;if("resource"==t.column){e.Table.addCellCss(t.row,t.column,"webix_gantt_select_editor");var r=t&&!n?i.resource:null;e.FilterOptions(r)}return!0},onAfterEditStart:function(t){if("value"==t.column){var i=e.Table.getItem(t.row),n=e.Table.getEditor(t.row,"value").getInputNode(),r=e.GetRange(i);r&&e.ApplyEditorLimits(n,r);var o=e.GetValueStep(i);o&&e.ApplyEditorStep(n,o)}},onBeforeEditStop:function(t,i){if(e.Table.removeCellCss(i.row,"resource","webix_gantt_select_editor"),t.value!=t.old){var n={};if(n[i.column]=t.value,"value"==i.column){var r=e.Table.getItem(i.row),o=e.GetRange(r);o?e.ApplyValueRange(n,o):n.value<0&&(n.value=0),i.getInputNode().value=n.value}e.UpdateAssignment(i.row,n)}return!0},onAfterLoad:function(){this.openAll()}},onClick:{webix_gantt_remove_icon:function(i,n){webix.confirm({container:e.app.getRoot().$view,title:t("Delete assignment"),text:t("Are you sure to delete this assignment?")}).then((function(){return e.RemoveAssignment(n.row)}))}}};return n||(o.scheme={$group:{by:"category"}}),{margin:webix.skin.$active.layoutMargin.form,padding:{top:webix.skin.$active.layoutMargin.form,bottom:5},rows:[o,r]}},t.prototype.init=function(){var e=this;if(this.State=this.getParam("state",!0),this.Ops=this.app.getService("operations"),this.Helpers=this.app.getService("helpers"),this.Table=this.$$("resources"),this.Local=this.app.getService("local"),this.Resources=this.Local.resources(),!this.app.config.resources)return!1;this.on(this.State.$changes,"selected",(function(t){t&&e.FillData(t)}))},t.prototype.FillData=function(e){var t=this;if("task"!=this.Local.tasks().getItem(e).type)return!1;this.Local.getAssignments(e).then((function(e){if(!t.getRoot())return!1;t.Table.clearAll(),t.Table.getColumnConfig("resource").collection=t.Resources,e.length?(t.Table.show(),t.Table.parse(t.GetData(e)),t.IsSingle&&t.$$("addBtn").disable()):(t.IsSingle&&t.$$("addBtn").enable(),t.Table.hide())}))},t.prototype.GetData=function(e){return e.sort(this.app.getService("operations").sortResources),e},t.prototype.FilterOptions=function(e){var t=[],i=e?this.Resources.getItem(e).category_id:null;this.Table.data.each((function(e){t.push(e.resource)})),this.Resources.filter((function(n){return(!i||n.category_id==i)&&(t.indexOf(n.id)<0||e&&n.id==e)}))},t.prototype.UpdateAssignment=function(e,t){var i=this,n=this.Table.$view.querySelector(".webix_gantt_select_editor");if(n){var r=1*n.getAttribute("aria-rowindex");this.Table.removeCellCss(this.Table.data.getIdByIndex(r-1),"resource","webix_gantt_select_editor")}this.Ops.updateAssignment(e,t).then((function(){i.CloseEditor(e,t)}))},t.prototype.GetRange=function(e){var t=this.Resources.getItem(e.resource);return this.Helpers.getResourceValueRange(t)},t.prototype.ApplyValueRange=function(e,t){e.value<t[0]?e.value=t[0]:e.value>t[1]&&(e.value=t[1])},t.prototype.ApplyEditorLimits=function(e,t){e.min=t[0],e.max=t[1]},t.prototype.GetValueStep=function(e){var t=this.Resources.getItem(e.resource);return this.Helpers.getResourceValueStep(t)},t.prototype.ApplyEditorStep=function(e,t){e.step=t},t.prototype.CloseEditor=function(e,t){this.Table.blockEvent(),this.Table.editCancel(),this.Table.unblockEvent(),this.Table.updateItem(e,t)},t.prototype.RemoveAssignment=function(e){var t=this;this.Ops.removeAssignment(e).then((function(){t.FillData(t.State.selected)}))},t.prototype.AddBtnClickHandler=function(){var e=this;this.FilterOptions(),webix.delay((function(){e.ShowPopup()}))},t.prototype.AddAssignment=function(e){var t=this;this.IsSingle&&this.$$("addBtn").disable(),this.Ops.addAssignment({resource:e.id,value:this.Helpers.getDefaultResourceValue(e),task:this.State.selected}).then((function(){t.FillData(t.State.selected)}))},t.prototype.ResourceTemplate=function(e){if(e.$group)return'<span class="webix_strong">'+e.category+"</span>";if(e.resource){var t=this.Resources.getItem(e.resource);return this.EditorTemplate(t)}return""},t.prototype.ValueTemplate=function(e){if(e.$group)return"";var t=e.value;return(isNaN(t)?this.Helpers.getDefaultResourceValue(e):t)+this.GetUnitName(e)},t.prototype.GetUnitName=function(e){return this._(this.Helpers.getResourceUnit(e))},t.prototype.DeleteIconTemplate=function(e){return e.$group?"":"<span class='webix_icon wxi-trash webix_gantt_remove_icon'></span>"},t.prototype.GetPopupConfig=function(){var e=this;return{view:"suggest",localId:"popup",width:320,padding:0,point:0,fitMaster:!1,borderless:!0,css:"webix_gantt_select_editor_popup",body:{view:"list",minHeight:28,type:{height:Math.max(webix.skin.$active.listItemHeight,32)},data:this.Resources,template:function(t){return e.OptionTemplate(t)},on:{onItemClick:function(t){e.AddAssignment(e.Resources.getItem(t)),e.Popup.hide()}}}}},t.prototype.ShowPopup=function(){this.Popup&&this.Popup.$view||(this.Popup=this.ui(this.GetPopupConfig()),this.SetPopupPlaceholder()),this.Popup.show(this.$$("addBtn").$view,{x:1})},t.prototype.SetPopupPlaceholder=function(e){this.Popup.getBody().$view.firstChild.setAttribute("placeholder",e||this._("No resources to add"))},t.prototype.OptionTemplate=function(e){return"<div class='webix_gantt_avatar_option_box'><div class=\"webix_gantt_avatar_box_inline\">"+this.Helpers.resourceAvatar(e)+"<div class='webix_gantt_editor_avatar_name'>"+e.name+"</div></div><span class='webix_gantt_resource_section'>"+e.category+"</span></div>"},t.prototype.EditorTemplate=function(e){return'<div class="webix_gantt_avatar_box">'+this.Helpers.resourceAvatar(e)+" <div class='webix_gantt_editor_avatar_name'>"+e.name+"</div><span class='webix_icon wxi-menu-down'></span></div>"},t.prototype.EditorOptionTemplate=function(e){return'<div class="webix_gantt_avatar_box">'+this.Helpers.resourceAvatar(e)+" <div class='webix_gantt_editor_avatar_name'>"+e.name+"</div></div>"},t}(h),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;this.Compact=this.getParam("compact",!0);var t=this.app.getService("locale")._;this.isResources=this.app.config.resources,this.State=this.getParam("state",!0);var i=webix.skin.$active,n={view:"toolbar",css:"webix_subbar",borderless:!0,padding:{left:i.layoutPadding.form-(i.inputHeight-20)/2,right:i.layoutPadding.form},elements:[{view:"icon",icon:"wxi-close",click:function(){return e.Close()}},{},{view:"button",width:130,css:"webix_primary",value:t("Done"),click:function(){return e.Done()}}]},r={css:"webix_gantt_datepicker",type:"calendar",body:{height:270,width:250,icons:!0,events:function(t){return e.app.config.isHoliday(t)&&"webix_cal_event"}}},o=[{id:"task",value:t("Task")},{id:"milestone",value:t("Milestone")}];this.app.config.projects||o.splice(1,0,{id:"project",value:t("Project")});var a=[];this.app.config.links&&a.push({header:t("Related tasks"),body:se,collapsed:!0}),this.isResources&&a.push({localId:"resourcesItem",header:"single"==this.isResources||this.app.config.resourceCalendars?t("Assignment"):t("Assignments"),body:{$subview:le,name:"resources"},collapsed:!0,hidden:!0}),this.State.baseline&&a.push({localId:"baselineItem",header:t("Planned dates"),body:{$subview:ae,name:"baseline"},collapsed:!0,hidden:!0});var s={multi:!0,view:"accordion",borderless:!0,type:"clean",margin:10,css:"webix_gantt_accordion",rows:a};return{view:"proxy",body:{margin:0,padding:{bottom:14},rows:[n,{view:"form",localId:"form",borderless:!0,autoheight:!1,scroll:!0,elementsConfig:{labelPosition:"top"},elements:[{view:"text",name:"text",label:t("Title")},{view:"richselect",localId:"types",name:"type",label:t("Type"),options:o,on:{onChange:function(t){return e.ToggleControls(t)}}},{view:"datepicker",name:"start_date",label:t("Start date"),suggest:webix.copy(r)},{view:"datepicker",name:"end_date",label:t("End date"),suggest:webix.copy(r)},{view:"counter",name:"duration",css:"webix_gantt_form_counter",min:1,max:1e3,label:t("Duration")},{view:"slider",name:"progress",title:webix.template("#value#%"),label:t("Progress")},s,{view:"textarea",name:"details",label:t("Notes"),height:150}],on:{onChange:function(t,i,n){e.Compact?e.UpdateTaskTime():"user"==n&&e.UpdateTask().then((function(){"type"!==e._eventSource||"user"!==n||"split"!==t&&"split"!==i||e.Tasks.data.callEvent("onStoreUpdated",[])}))}}}]}}},t.prototype.init=function(){var e=this;this.Ops=this.app.getService("operations"),this.Local=this.app.getService("local"),this.Tasks=this.Local.tasks(),this.Form=this.$$("form"),this.on(this.State.$changes,"selected",(function(t){t&&e.FillData(t)})),this.on(this.Tasks.data,"onStoreUpdated",(function(t,i,n){"update"==n&&t==e.State.selected&&e.FillData(e.State.selected)})),this.on(this.State.$changes,"display",(function(t){var i=e.$$("form").elements.type;"tasks"==t?i.enable():"resources"==t&&i.disable()})),this.app.config.resourceCalendars&&this.on(this.Local.assignments().data,"onStoreUpdated",(function(){return e.SetResourceHolidays()})),this.on(this.State.$changes,"baseline",(function(t,i){webix.isUndefined(i)||e.SetBaselineVisibility(e.Tasks.getItem(e.State.selected))}))},t.prototype.FillData=function(e){var t=this.Tasks.getItem(e),i=this.$$("types").getList();this.app.config.split&&t.$count?i.exists("split")||i.add({id:"split",value:this.app.getService("locale")._("Split task")}):i.exists("split")&&i.remove("split"),this.app.config.projects&&this.LimitTypeOptions(t),this.app.config.resourceCalendars&&this.SetResourceHolidays(),this.isResources&&this.SetResourcesVisibility(t),this.State.baseline&&this.SetBaselineVisibility(t),this.Form.setValues(t),this.Form.focus()},t.prototype.SetResourcesVisibility=function(e){var t=this.$$("resourcesItem");if("task"==e.type){if(!t.isVisible()){var i=this.getSubView("resources");i&&i.FillData(e.id),t.show()}}else t.isVisible()&&t.hide()},t.prototype.SetBaselineVisibility=function(e){var t=this.$$("baselineItem");if(!this.State.baseline||"task"!=e.type&&"project"!=e.type)t.isVisible()&&t.hide();else if(!t.isVisible()){var i=this.getSubView("baseline");i&&i.FillData(e.id),t.show()}},t.prototype.LimitTypeOptions=function(e){var t=this.Form.elements.type;"project"===e.type?t.hide():t.show()},t.prototype.PrepareDates=function(e){var t=this._eventSource=this.Form.$eventSource.config.name,i=!0;return"duration"==t||"start_date"==t&&"project"==e.type?e.end_date=null:"end_date"==t||"start_date"==t?e.duration=null:i=!1,i},t.prototype.UpdateTaskTime=function(){var e=this.Form.getValues(),t=this.PrepareDates(e);if("type"===this._eventSource&&"split"!==e.type&&(e.open=e.opened=1),this.RemoveTagsFromText(e)&&(this.Form.blockEvent(),this.Form.setValues(e,!0),this.Form.unblockEvent()),t){var i=this._eventSource?this._eventSource.split("_")[0]:null;this.Ops.updateTaskDuration(e,i),this.Form.blockEvent(),this.Form.setValues(e,!0),this.Form.unblockEvent()}},t.prototype.RemoveTagsFromText=function(e){return("text"===this._eventSource||"details"===this._eventSource)&&(e[this._eventSource]=(e[this._eventSource]||"").replace(/(<[^>]+>|^\s+|\s+$)/gi,""),!0)},t.prototype.UpdateTask=function(){var e=this,t=this.State.selected,i=this.Form.getValues();this.Compact||(this.PrepareDates(i),this.RemoveTagsFromText(i));var n=this._eventSource?this._eventSource.split("_")[0]:null;return"type"===this._eventSource&&"split"!==i.type&&(i.open=i.opened=1),this._inProgress=this.Ops.updateTask(t,i,n),this._inProgress.finally((function(){return e._inProgress=null})),this._inProgress},t.prototype.ToggleControls=function(e){if(this.Form.elements.end_date.show(),this.Form.elements.duration.show(),this.Form.elements.progress.show(),this.Form.elements.end_date.enable(),this.Form.elements.duration.enable(),this.Form.elements.progress.enable(),"project"==e||"milestone"==e){var t="project"==e?"disable":"hide";this.Form.elements.end_date[t](),this.Form.elements.duration[t](),this.Form.elements.progress[t]()}},t.prototype.Close=function(){var e=this;if(this.Compact&&this.Form.isDirty()){var t=this.app.getService("locale")._;webix.confirm({container:this.app.getRoot().$view,text:t("Save changes?")}).then((function(){return e.Done(!0)}),(function(){return e.Back(!0)}))}else this.Back(!0)},t.prototype.Back=function(e){e?this.State.$batch({edit:null,selected:null}):this.State.edit=null},t.prototype.Done=function(e){var t=this;this.Compact&&this.Form.isDirty()?this._inProgress?this._inProgress.then((function(){t.Back(e)})):this.UpdateTask().then((function(){return t.Back(e)})):this.Back(e)},t.prototype.SetResourceHolidays=function(){var e=this,t=[],i=this.Form.elements,n=this.app.getService("helpers");t.push(i.start_date,i.end_date);var r=this.Local.getTaskCalendar(this.State.selected);t.forEach((function(t){var i=t.getPopup().getBody();i.config.events=function(t){return(r?n.isResourceHoliday(t,r):e.app.config.isHoliday(t))&&"webix_cal_event"},i.refresh()}))},t}(h),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._,i=this.State=this.getParam("state",!0),n={view:"button",width:130,label:t("Edit"),css:"webix_primary",click:function(){return e.EditTask()}},r=webix.skin.$active,o={view:"toolbar",css:"webix_subbar",borderless:!0,padding:{left:r.layoutPadding.form-(r.inputHeight-20)/2,right:r.layoutPadding.form},elements:[{view:"icon",icon:"wxi-close",click:function(){return e.Close()}},{},i.readonly?{}:n]},a={localId:"text",view:"template",css:"webix_gantt_task_info",template:function(t){return e.InfoTemplate(t)},borderless:!0},s={view:"button",label:t("Delete task"),css:"webix_danger webix_gantt_danger",align:"center",inputWidth:330,click:function(){webix.confirm({container:e.app.getRoot().$view,title:t("Delete task"),text:t("The task will be deleted permanently, are you sure?")}).then((function(){return e.DeleteTask()}))}};return{view:"proxy",body:{margin:0,rows:[o,{type:"form",borderless:!0,rows:[a,i.readonly?{}:s]}]}}},t.prototype.init=function(){var e=this;this.Local=this.app.getService("local"),this.Tasks=this.Local.tasks(),this.Text=this.$$("text"),this.isResources=this.app.config.resources,this.on(this.State.$changes,"selected",(function(t){t&&e.FillTemplate(t)})),this.on(this.Tasks.data,"onStoreUpdated",(function(t,i,n){"update"==n&&t==e.State.selected&&e.FillTemplate(e.State.selected)}));var t=this.Local.links();this.on(t.data,"onStoreUpdated",(function(t,i){if(i){var n=e.State.selected;i.target!==n&&i.source!==n||e.FillTemplate(n)}})),this.isResources&&this.on(this.Local.assignments().data,"onStoreUpdated",(function(t,i){i&&i.task==e.State.selected&&e.FillTemplate(i.task)})),this.on(this.State.$changes,"baseline",(function(t,i){webix.isUndefined(i)||e.FillTemplate(e.State.selected)}))},t.prototype.FillTemplate=function(e){var t=this,i=webix.copy(this.Tasks.getItem(e));i.sources=this.Local.getLinks(e,"source"),i.targets=this.Local.getLinks(e,"target"),this.isResources&&"task"==i.type?this.Local.getAssignments(e).then((function(e){if(!t.getRoot())return!1;i.resources=e.sort(t.app.getService("operations").sortResources),t.Text.setValues(i)})):this.Text.setValues(i)},t.prototype.EditTask=function(){this.State.edit=!0},t.prototype.DeleteTask=function(){this.app.getService("operations").removeTask(this.State.selected),this.Close()},t.prototype.Close=function(){this.State.$batch({edit:null,selected:null})},t.prototype.InfoTemplate=function(e){if(!e.start_date)return"";var t=this._,i='<span class="webix_gantt_task_title">'+(e.text||t("(no title)"))+"</span><br><br>";return i+=this.BaseTemplate(e),i+=this.LinkTemplate(e),this.State.baseline&&e.planned_start&&(i+=this.BaselineTemplateChunk(e,t("Planned dates"))),e.details&&(i+='<br><br><div class="webix_gantt_task_title">'+t("Notes")+'</div>\n\t\t\t\t<br><div class="webix_gantt_task_text">'+e.details.replace(/(?:\r\n|\r|\n)/g,"<br>")+"</div>"),i},t.prototype.BaseTemplate=function(e){var t=this._,i='<span class="webix_strong">'+t("Start date")+"</span>: "+this.DateFormat(e.start_date)+"<br>";return"milestone"!==e.type&&(i+='<span class="webix_strong">'+t("End date")+"</span>: "+this.DateFormat(e.end_date)+'<br>\n\t\t\t<span class="webix_strong">'+t("Duration")+"</span>: "+e.duration+'<br>\n\t\t\t<span class="webix_strong">'+t("Progress")+"</span>: "+e.progress+"%\n\t\t<br>"),i},t.prototype.LinkTemplate=function(e){var t="",i=this._;if(e.targets.length&&(t+=this.InfoTemplateChunk(e.targets,i("Predecessors"))),e.sources.length&&(t+=this.InfoTemplateChunk(e.sources,i("Successors"))),e.resources){var n="single"==this.isResources||this.app.config.resourceCalendars;t+=this.ResourcesTemplateChunk(e.resources,i(n?"Assignment":"Assignments"))}return t},t.prototype.ResourcesTemplateChunk=function(e,t){var i=this;if(!e||!e.length)return"";var n=130;return e.forEach((function(e){var t=webix.html.getTextSize(e.name,"webix_gantt_info_list_text"),i=webix.html.getTextSize(e.category,"webix_gantt_info_list_text webix_gantt_resource_section");n=Math.max(n,t.width,i.width)})),n=Math.min(200,n),'<br><span class="webix_strong">'+t+'</span>:<br><ul class="webix_gantt_info_list_resources">'+e.map((function(e){var t=i.app.getService("helpers"),r="<div>"+t.resourceAvatar(e,"webix_gantt_person_avatar_big")+"</div>",o="<div class=' webix_gantt_info_list_text webix_gantt_resource_section' style='min-width:"+n+"px'>"+e.category+"</div>",a="<div class='webix_gantt_resource_section'>"+e.value+i._(t.getResourceUnit(e))+"</div>";return"<div class='webix_gantt_info_resource'>"+r+"<div  ><div class='webix_gantt_info_list_text_row'><div class='webix_gantt_info_list_text' style='min-width:"+n+"px'>"+e.name+"</div>"+a+"</div>"+o+"</div></div>"})).join("")+"</ul>"},t.prototype.InfoTemplateChunk=function(e,t){var i=this;return'<br><span class="webix_strong">'+t+"</span>:<br><ul>"+e.map((function(e){return"<li>"+(e.text||i._("(no title)"))+"</li>"})).join("")+"</ul>"},t.prototype.DateFormat=function(e){return webix.i18n.longDateFormatStr(e)},t.prototype.BaselineTemplateChunk=function(e,t){var i=this.app.getService("locale")._;return'<br><span class="webix_strong">'+t+'</span><br><div class="webix_gantt_info_list_planned">'+i("Start date")+": "+this.DateFormat(e.planned_start)+"<br>"+i("End date")+": "+this.DateFormat(e.planned_end)+"<br>"+i("Duration")+": "+e.planned_duration+"<br></div>"},t}(h),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return this.app.getService("jet-win").updateConfig({view:"window",borderless:!0,fullscreen:!0,head:!1,body:{$subview:!0}})},t}(h),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.State=this.getParam("state",!0);this.Local=this.app.getService("local"),this.Helpers=this.app.getService("helpers");var i=this.Local.getScales(),n=this._=this.app.getService("locale")._,r=this.Compact=this.getParam("compact",!0);this.isResources=this.app.config.resources,this.maxAvatarNumber=3;var o={id:"action",css:"webix_gantt_action",header:{text:'<span webix_tooltip="'+n("Add task")+'" class="webix_icon wxi-plus-circle"></span>',css:"webix_gantt_action"},template:function(){return'<span webix_tooltip="'+n("Add task")+'" class="webix_icon wxi-plus"></span>'},width:44,minWidth:44},a=[{id:"text",css:"webix_gantt_title",header:n("Title"),template:function(t,i){return i.treetable(t,i)+e.TitleTemplate(t)},fillspace:!0,hidden:r,batch:"full",sort:ie("text"),minWidth:150},{id:"start_date",header:n("Start date"),format:webix.i18n.dateFormatStr,hidden:r,batch:"full",sort:"date",minWidth:100}];this.isResources&&a.push({id:"resources",css:"webix_gantt_tree_column_resources",header:n("Assigned"),template:function(t){return e.ResourcesTemplate(t)},minWidth:100}),r?(o.header.text="<span class='webix_icon gti-menu'>",t.readonly&&(o.template=""),a.unshift(o)):t.readonly||a.push(o),a[a.length-1].resize=!1;var s=webix.skin.$name,l={view:"treetable",css:"webix_gantt_tree "+("material"==s||"mini"==s?"webix_header_border":""),prerender:!0,width:r?44:t.treeWidth,rowHeight:i.cellHeight,headerRowHeight:i.height,scroll:"xy",scrollAlignY:!1,select:"row",sort:"multi",resizeColumn:{headerOnly:!0,size:10},drag:!t.readonly&&"order",columns:a,tooltip:function(){return""},onClick:{"wxi-plus":function(t,i){return e.AddTask(i.row)},"wxi-plus-circle":function(){return e.AddTask("0")},"gti-menu":function(){return e.ToggleColumns()}},on:{onBeforeOpen:function(t){return e.HandleToggle(t)},onAfterOpen:function(t){e.ToggleBranch(t,1),e.ApplySelection()},onAfterClose:function(t){return e.ToggleBranch(t,0)},onBeforeSelect:function(t){return e.BeforeSelectHandler(t)},onItemClick:function(t){return e.ItemClickHandler(t)},onAfterSort:function(t,i,n){return e.SortTasks(t,i,n)},onColumnResize:function(t,i,n,r){return e.NormalizeColumns(t,r)},onBeforeDrag:function(t,i){return e.BeforeDragHandler(t,i)},onBeforeDrop:function(t){return e.BeforeDropHandler(t)},onViewResize:function(){e.State.treeWidth=e.Tree.$width}}};return l.on.onScrollY=l.on.onSyncScroll=l.on.onAfterScroll=function(){t.top=this.getScrollState().y},l},t.prototype.init=function(e){var t=this;this.Tree=e,this.State=this.getParam("state",!0),this.Ops=this.app.getService("operations"),this.Helpers=this.app.getService("helpers"),this.Tasks=this.Local.tasks(),this.on(this.State.$changes,"display",(function(e){t.Mode=e,t.State.top=0,t.SyncData()})),this.isResources&&(this.on(this.Assignments.data,"onStoreUpdated",(function(){t.Tree.refresh()})),this.on(this.Tree.data,"onStoreUpdated",(function(e){"resources"!=t.Mode||e||t.ApplySelection()}))),this.on(this.State.$changes,"top",(function(e){return t.Tree.scrollTo(null,e)})),this.on(this.State.$changes,"selected",(function(e){e?t.ApplySelection():t.Tree.unselect()})),this.on(this.app,"onScalesUpdate",(function(e){var i=t.Tree.columnId(0);t.Tree.getColumnConfig(i).header[0].height=e.height,t.Tree.refreshColumns()})),this.on(this.app,"task:add",(function(e,i){return t.AddTask(e||"0",i)})),this.on(this.State.$changes,"treeWidth",(function(i){t.Compact||e.$width===i||(e.define({width:i}),e.resize())}))},t.prototype.HandleToggle=function(e){var t=this.Tree.getItem(e);if("split"===t.type&&t.$data.length)return!1},t.prototype.ItemClickHandler=function(e){this.Tree.getItem(e).$group?this.app.callEvent("edit:stop"):this.State.$batch({parent:null,selected:e.row})},t.prototype.BeforeSelectHandler=function(e){return!this.Tree.getItem(e).$group},t.prototype.BeforeDragHandler=function(e,t){if("tasks"==this.Mode){var i=this.Tree.getItem(e.start);if("split"===i.type&&i.$data.length){var n=this.Tree.$dragHTML(this.Tree.getItem(e.start),t,e);e.html=n.replace("webix_dd_drag","webix_dd_drag webix_gantt_tree_no_icon")}return!0}return!1},t.prototype.BeforeDropHandler=function(e){return this.Ops.moveTask(e.start,e.parent,e.index),!1},t.prototype.SyncData=function(){var e=this;this.Tree.clearAll(),this.VisibleTasks=this.Local.getVisibleTasksCollection(),this.resDisplayed="resources"===this.State.display,this.resDisplayed&&!this.clearEvID&&(this.clearEvID=this.on(this.VisibleTasks.data,"onClearAll",(function(){e.resDisplayed&&e.RefreshData()}))),this.RefreshData()},t.prototype.GetLoaders=function(){var e=[this.VisibleTasks.waitData];return this.isResources&&(this.Resources=this.Local.resources(),this.Assignments=this.Local.assignments(),e.push(this.Resources.waitData,this.Assignments.waitData)),e},t.prototype.RefreshData=function(){var e=this,t=this.GetLoaders();webix.promise.all(t).then((function(){e.Tree.sync(e.VisibleTasks),e.ApplySelection(),e.ApplySorting()}))},t.prototype.ApplySelection=function(){var e=this.State.selected;if(e&&this.Tree.exists(e)&&this.Tree.getSelectedId()!=e){var t=void 0,i=this.Tree.getItem(e);if("tasks"===this.State.display){var n=i.parent,r=0!=n?this.Tree.getItem(n):null;r&&"split"===r.type?t=n:this.Local._isTaskVisible(i)&&(t=e)}else this.Local._isTaskVisible(i)&&(t=e);t&&(this.Tree.select(t),this.Tree.showItem(t))}},t.prototype.ApplySorting=function(){this.State.sort&&(this.Tree.data.blockEvent(),this.Tree.setState({sort:this.State.sort}),this.Tree.data.unblockEvent())},t.prototype.AddTask=function(e,t){var i=this;this.State.selected=null;var n,r=this.Tree.getItem(e),o=r?0:-1,a=this.GetNewTask(r,t);if("resources"==this.Mode&&r)n=this.AddTaskWithAssignment(a,e);else if(r&&t){var s=void 0;this.app.config.resources&&(s=this.Assignments.find((function(e){return e.task==r.id}))),n=s&&s.length?this.SplitTaskWithAssignment(a,o,e,r,s):this.Ops.splitTaskWithDnd(a,o,e,r)}else n=this.Ops.addTask(a,o,r?e:0);return this.app.callEvent("backend:operation",[n]),n.then((function(t){r&&"tasks"==i.Mode&&"split"!==r.type&&i.Tree.open(e),i.State.$batch({edit:!0,selected:t.id}),i.Tree.showItem(t.id)})),!1},t.prototype.GetNewTask=function(e,t){var i=this.GetDates(e,t),n=i.start,r=i.end;return{start_date:new Date(n),end_date:r||webix.Date.add(n,1,"day",!0),progress:0,text:""}},t.prototype.GetDates=function(e,t){if(t)return t;var i;if(e&&"split"===e.type){var n=e.$data&&e.$data.length?e.$data[0].end_date:e.end_date;i=this.Helpers.addUnit("day",n,1)}else if(e)i=e.start_date;else{var r=this.Local.getScales();i=webix.Date.add(r.start,1,r.minUnit)}return{start:i,end:void 0}},t.prototype.AddTaskWithAssignment=function(e,t){var i=this;this.Tasks.data.blockEvent(),this.Assignments.data.blockEvent();var n="0";t&&(n=this.Tree.getItem(t).$group?"0":t);var r=0;return this.Tasks.data.branch[n]&&(r=this.Tasks.data.branch[n].length),this.Ops.addTask(e,r,n).then((function(n){e.id=n.id;for(var r=[],o=null;"0"!=t&&!o;)(o=i.Tree.getItem(t).resources)||(t=i.Tree.getParentId(t));return o&&o.length&&o.forEach((function(t){var n=i.Local.resources().getItem(t);r.push(i.Ops.addAssignment({resource:t,value:i.Helpers.getDefaultResourceValue(n),task:e.id}))})),r.length?webix.promise.all(r).then((function(){return n})):webix.promise.resolve(n)})).finally((function(){i.Tasks.data.unblockEvent(),i.Assignments.data.unblockEvent(),i.Tasks.data.callEvent("onStoreUpdated",[e.id,e,"add"])}))},t.prototype.SplitTaskWithAssignment=function(e,t,i,n,r){var o=this;return this.Ops.splitTaskWithDnd(e,t,i,n).then((function(e){if(e.sibling){for(var t=[],i=0;i<r.length;++i)t.push(o.Ops.updateAssignment(r[i].id,{task:e.sibling}).then((function(){return e})));return webix.promise.all(t).then((function(){return e}))}return e}))},t.prototype.RefreshTasks=function(){this.Tasks.data.callEvent("onStoreUpdated",[])},t.prototype.SortTasks=function(e,t,i){var n=webix.isArray(e)?e:{by:e,dir:t,as:i},r=this.Tree.getState().sort;this.VisibleTasks.sort(n),this.State.sort=r},t.prototype.ToggleColumns=function(){var e=this.Tree.isColumnVisible("text");this.Tree.showColumnBatch("full",!e),this.Tree.config.width=e?44:0,this.Tree.resize(),this.app.callEvent("bars:toggle",[e])},t.prototype.NormalizeColumns=function(e,t){if(t){var i=this.Tree,n=i.config.columns,r=i.getColumnIndex(e),o=n.length-1;"action"===n[o].id&&(o-=1),0===r?(n[o].fillspace=!0,n[o].width=0):r===o&&(n[0].fillspace=!0,n[0].width=0),i.refreshColumns()}},t.prototype.ToggleBranch=function(e,t){if("resources"!=this.State.display)this.RefreshTasks(),this.State.readonly||this.Ops.updateTask(e,{opened:t});else{var i=this.VisibleTasks;i.getItem(e).open=!!t,i.data.callEvent("onStoreUpdated",[e,0,"branch"])}},t.prototype.TitleTemplate=function(e){return e.text||(e.$group?this._("Unassigned"):this._("(no title)"))},t.prototype.ResourcesTemplate=function(e){var t=this;if(this.Assignments.count()&&this.Resources.count()){var i=[];return this.Assignments.data.each((function(n){n.task==e.id&&i.push(t.Resources.getItem(n.resource))})),i.sort(this.Ops.sortResources),this.GetAssignmentsHTML(i)}return""},t.prototype.GetAssignmentsHTML=function(e){var t=this,i="";if(e.length>this.maxAvatarNumber){var n=e.length-this.maxAvatarNumber+1,r=(e=e.splice(0,this.maxAvatarNumber)).pop(),o=this.Helpers.resourceAvatar(r),a="<div class='webix_gantt_cell_remain_num'>+"+n+"</div>";i=e.map((function(e){return""+t.Helpers.resourceAvatar(e,null,!0)})).join(""),i+="<div class='webix_gantt_cell_assigned_last'>"+o+a+"</div>"}else i=e.map((function(e){return""+t.Helpers.resourceAvatar(e,null,!0)})).join(""),1==e.length&&(i+="<span class='webix_gantt_cell_assigned_text'>"+e[0].name.split(" ")[0]+"</span>");return"<div class='webix_gantt_avatar_box'>"+i+"</div>"},t}(h),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;F||(F=!0,webix.protoUI({name:"r-layout",sizeTrigger:function(e,t,i){this._compactValue=i,this._compactHandler=t,this._app=e;var n=e.config;this._forceCompact=void 0!==n.params.forceCompact,this._compactWidth=n.compactWidth,this._forceCompact||this._checkTrigger(this.$view.width,i)},_checkTrigger:function(e,t){return!this._compactWidth||!(e<=this._compactWidth&&!t||e>this._compactWidth&&t)||(this._compactWidth=null,this._compactHandler(!t),!1)},$setSize:function(e,t){(this._forceCompact||this._checkTrigger(e,this._compactValue))&&webix.ui.layout.prototype.$setSize.call(this,e,t),this._app&&this._app.callEvent("view:resize",[])}},webix.ui.layout)),this.fCompact=this.getParam("forceCompact"),webix.isUndefined(this.fCompact)||this.setParam("compact",this.fCompact),this.Compact=this.getParam("compact"),this.State=this.getParam("state",!0);var t=this.Compact?{$subview:!0,name:"edit",popup:!0}:{view:"proxy",css:"webix_shadow_medium",borderless:!0,width:400,hidden:!0,localId:"edit",body:{$subview:!0,name:"edit"}},i=[pe,{view:this.Compact?"spacer":"resizer",css:"webix_gantt_resizer",width:this.Compact?1:4},ee];return this.app.config.resources?i=[{type:"clean",rows:[{type:"clean",cols:i,on:{onViewResize:function(){e.app.callEvent("rdiagram:resize",[])}}},{view:"resizer",css:"webix_gantt_resizer",localId:"rdResizer"},{view:"proxy",localId:"rdiagram",height:this.Compact?0:400,body:{$subview:!0,name:"rdiagram"}}]},t]:i.push(t),{view:"abslayout",css:"webix_gantt",cells:[{view:"r-layout",localId:"main",borderless:!0,relative:!0,type:"clean",cols:i},{css:"webix_gantt_absbutton",view:"icon",icon:"wxi-plus",localId:"add",hidden:!this.Compact||this.State.readonly,width:50,height:50,right:20,bottom:20,click:function(){e.app.callEvent("task:add",[])}}]}},t.prototype.init=function(e){var t=this;this.$$("main").sizeTrigger(this.app,(function(e){return t.SetCompactMode(e)}),!!this.Compact),this.on(this.State.$changes,"selected",(function(e,i){e?t.ShowTask(t.State.edit?"form":"info"):i&&t.HideTask()})),this.on(this.State.$changes,"edit",(function(e){t.State.selected&&t.ShowTask(e?"form":"info")})),webix.extend(e,webix.ProgressBar),this.on(this.app,"backend:operation",(function(t){e.showProgress({type:"top",delay:2e3}),t.finally((function(){e.hideProgress()}))})),this.app.config.resources&&this.on(this.State.$changes,"resourcesDiagram",(function(e){e?(t.$$("rdiagram").show(),t.$$("rdResizer").show(),t.show("rdiagram",{target:"rdiagram"})):(t.$$("rdiagram").hide(),t.$$("rdResizer").hide(),t.show("_blank",{target:"rdiagram"}).then((function(){t.app.callEvent("rdiagram:resize",[])})))}))},t.prototype.ShowTask=function(e){e="task."+e,this.Compact?this.show("task.popup/"+e,{target:"edit"}):(this.$$("edit").show(),this.show(e,{target:"edit"}))},t.prototype.HideTask=function(){this.show("_blank",{target:"edit"}),this.Compact||this.$$("edit").hide()},t.prototype.SetCompactMode=function(e){var t=this;webix.delay((function(){t.State.$batch({top:0,left:0}),t.setParam("compact",e),t.refresh()}))},t}(h),_e={JetView:h};_e["chart/bars"]=J,_e.chart=ee,_e["chart/scale"]=Z,_e["rdiagram/diagram"]=te,_e.rdiagram=oe,_e["rdiagram/tree"]=re,_e["task/baseline"]=ae,_e["task/form"]=ce,_e["task/info"]=ue,_e["task/links"]=se,_e["task/popup"]=he,_e["task/resources"]=le,_e.top=de,_e.tree=pe;var fe=function(){function e(e,t){this.app=e,this.state=e.getState(),this.Helpers=this.app.getService("helpers"),this.resetScales(t),this.dateToLocalStr=webix.Date.dateToStr(webix.i18n.parseFormat)}return e.prototype.setScales=function(e,t,i,n,r,o){var a=this._scales;n?(this._scaleBase={width:n,height:r,scales:o},t=webix.Date.add(t,1,"day")):(n=this._scaleBase.width,r=this._scaleBase.height,o=this._scaleBase.scales),this._scales=this.app.getService("helpers").setScales(e,t,i,n,r,o),this._taskHeight=this._scales.cellHeight-12;var s=this.getVisibleTasksCollection();s&&s.data.order.length&&("resources"===this.state.display?this.app.getService("grouping").refreshResourceTasks():this.refreshTasks(),this.refreshLinks()),this.app.callEvent("onScalesUpdate",[this._scales,a])},e.prototype.getScales=function(){return this._scales},e.prototype.resetScales=function(e){e=e||this.app.config;var t=webix.skin.$active,i=e.scaleStart||webix.Date.dayStart(new Date),n=e.scaleEnd||webix.Date.add(i,1,"month",!0);this.setScales(i,n,e.preciseTimeUnit,e.scaleCellWidth||80,t.barHeight-2*t.borderWidth,e.scales||[{unit:"day",step:1,format:"%d"}])},e.prototype.getTaskHeight=function(){return this._taskHeight},e.prototype.adjustScale=function(e){var t=e.start_date,i=e.end_date;this.state.baseline&&e.planned_start&&e.planned_end&&(t>e.planned_start&&(t=e.planned_start),i<e.planned_end&&(i=e.planned_end));var n=this.getScales();t=this.Helpers.addUnit(n.minUnit,t,-1),i=this.Helpers.addUnit(n.minUnit,i,1),(n&&n.start>t||n.end<i)&&this.setScales(n.start>t?t:n.start,n.end<i?i:n.end,n.precise)},e.prototype.tasks=function(e){var t=this;if(this._tasks&&!e)return this._tasks;this._tasks?this._tasks.clearAll():this._tasks=this.createTasks();var i=[this.app.getService("backend").tasks()];return this.app.config.resourceCalendars&&i.push(this.taskCalendarMap(!1,e)),this._tasks.parse(webix.promise.all(i).then((function(e){return t.app.getService("grouping").getTreeData(e[0],0)}))),this._tasks},e.prototype.createTasks=function(){var e=this,t=this.app.getService("operations"),i=new webix.TreeCollection({on:{"data->onStoreLoad":function(){e.app.config.scaleStart||e.updateScaleMinMax(i),i.data.each((function(t){e.app.config.projects&&t.$count&&(t.type="project")}))},"data->onStoreUpdated":function(t,i,n){t="update"==n?t:null,e.refreshTasks(t),e.refreshLinks(),!n&&e.state.criticalPath&&(e.app.config.links?e._links.waitData.then((function(){return e.showCriticalPath()})):e.showCriticalPath())}},scheme:{$change:function(i){i.start_date=webix.i18n.parseFormatDate(i.start_date),i.end_date=webix.i18n.parseFormatDate(i.end_date),i.type=i.type||"task",e.app.config.split||"split"!==i.type||(i.type="task"),t.updateTaskDuration(i),i.planned_start&&(i.planned_start=webix.i18n.parseFormatDate(i.planned_start),i.planned_end=webix.i18n.parseFormatDate(i.planned_end),t.updatePlannedTaskDuration(i)),"split"===i.type?(i.open=i.opened=0,i.$css="webix_gantt_split_task"):(delete i.$css,i.open=1*(i.open||i.opened)||0)},$sort:{by:"position",dir:"asc",as:"int"},$serialize:function(t){return e.taskOut(t)},$export:function(t){return e.taskOut(t)}}});return i},e.prototype.refreshTasks=function(e,t){var i=this;if(e){var n=this._tasks.getItem(e);(t=webix.isUndefined(t)?this._tasks.getIndexById(e):t)<0&&(t=this._tasks.getIndexById(n.parent)),"split"===n.type&&(n.$data=this._tasks.find((function(e){return e.parent==n.id})).sort((function(e,t){return t.start_date-e.start_date||t.end_date-e.end_date}))),this.Helpers.updateTask(n,t),this.state.baseline&&n.planned_start&&this.refreshBaseline(n,t)}else this._tasks.data.order.forEach((function(e,t){i.refreshTasks(e,t)}))},e.prototype.refreshBaseline=function(e,t){var i=r({},e);i.start_date=e.planned_start,i.duration=e.planned_duration,i.end_date=e.planned_end,this.Helpers.updateTask(i,t,this._scales,this._taskHeight),e.$x0=i.$x,e.$w0=i.$w},e.prototype.links=function(e){return this._links&&!e||(this._links?this._links.clearAll():this._links=this.createLinks(),this.app.config.links&&this._links.parse(this.app.getService("backend").links())),this._links},e.prototype.createLinks=function(){var e=this;return new webix.DataCollection({on:{"data->onStoreUpdated":function(t,i,n){n&&e.refreshLinks(t)}},scheme:{$init:function(e){e.type=1*e.type}}})},e.prototype.refreshLinks=function(e){var t=this,i=this.getVisibleTasksCollection();this._links&&i&&(this._links.data.each((function(e){var n=i.getItem(e.source),r=i.getItem(e.target);n&&r&&t._isTaskVisible(n)&&t._isTaskVisible(r)?t.Helpers.updateLink(e,n,r):e.$p=""})),this.state.criticalPath&&e&&this.showCriticalPath())},e.prototype.getLinks=function(e,t){for(var i=this._links.find((function(i){return i[t]==e})),n=[],r=0;r<i.length;r++){var o=i[r],a=this._tasks.getItem(o["source"==t?"target":"source"]);a&&n.push({id:o.id,type:o.type.toString(),text:a.text,ttype:t})}return n},e.prototype.taskOut=function(e){e=webix.copy(e);var t=this.dateToLocalStr;for(var i in e.start_date&&(e.start_date=t(e.start_date)),e.end_date&&(e.end_date=t(e.end_date)),e)0===i.indexOf("$")&&delete e[i];return e},e.prototype._isTaskVisible=function(e,t){var i=this.getVisibleTasksCollection(t),n=e.$parent,r="split"===e.type&&!e.open;if(r&&!n)return!1;for(;e.$parent;)if(!(n==(e=i.getItem(e.$parent)).id&&"split"==e.type||e.open)||e.open&&r)return!1;return!0},e.prototype.categories=function(e){return this._categories&&!e||(this._categories?this._categories.clearAll():this._categories=new webix.DataCollection({}),this._categories.parse(this.app.getService("backend").categories())),this._categories},e.prototype.resources=function(e){var t=this;if(this._resources&&!e)return this._resources;this._resources?this._resources.clearAll():this._resources=new webix.DataCollection({});var i=[this.app.getService("backend").resources(),this.categories(e).waitData];return this.app.config.resourceCalendars&&i.push(this.calendars(e).waitData),this._resources.parse(webix.promise.all(i).then((function(e){var i=e[0];return i.forEach((function(e){if(e.category_id){var i=t.categories().getItem(e.category_id);e.category=i.name,!e.unit&&i.unit&&(e.unit=i.unit)}})),i.sort(t.app.getService("operations").sortResources),i}))),this._resources},e.prototype.assignments=function(e){return this._assignments&&!e||(this._assignments?this._assignments.clearAll():this._assignments=new webix.DataCollection({}),this._assignments.parse(this.app.getService("backend").assignments())),this._assignments},e.prototype.getAssignments=function(e){var t=this;return webix.promise.all([this.resources().waitData,this.assignments().waitData]).then((function(){var i=t.resources();return t.assignments().data.find((function(t){return t.task==e})).map((function(e){var t=Object.assign({},e),n=Object.assign({},i.getItem(e.resource));return delete n.id,Object.assign(t,n)}))}))},e.prototype.calendars=function(e){return this._calendars&&!e||(this._calendars?this._calendars.clearAll():this._calendars=this.createCalendars(),this._calendars.parse(this.app.getService("backend").calendars())),this._calendars},e.prototype.createCalendars=function(){return new webix.DataCollection({scheme:{$change:function(e){"string"==typeof e.weekDays&&(e.weekDays=e.weekDays.split(",").map((function(e){return 1*e}))),e.holidays&&("string"==typeof e.holidays&&(e.holidays=e.holidays.split(",")),e.holidays=e.holidays.map((function(e){return webix.Date.datePart(new Date(e))})))}}})},e.prototype.showCriticalPath=function(e){var t=this;if(e)this._tasks.data.order.forEach((function(e){delete t._tasks.getItem(e).$critical}));else{var i=this._tasks.data.getRange().sort((function(e,t){return t.end_date-e.end_date||(e.parent==t.id?1:t.parent==e.id?-1:0)||t.start_date-e.start_date})),n=webix.Date.copy(i[0].end_date);i.forEach((function(e){e.$critical=t.isTaskCritical(e,n)}))}this._tasks.data.callEvent("onStoreUpdated",[null,null,"paint"])},e.prototype.isTaskCritical=function(e,t){if(t&&webix.Date.equal(t,e.end_date))return!0;for(var i=this._links.find((function(t){return t.source==e.id&&0==t.type})),n=0;n<i.length;++n){var r=this._tasks.getItem(i[n].target);if(r.$critical&&this.isNoSlack(r.start_date,e.end_date,e.id))return!0}if(0!=e.parent){var o=this._tasks.getItem(e.parent);return o.$critical&&e.end_date>=o.end_date}return!1},e.prototype.isNoSlack=function(e,t,i){if(this.app.config.excludeHolidays){if(t>=e)return!0;for(var n=webix.Date.copy(t);n<e;){if(!this.isHoliday(n,i))return!1;webix.Date.add(n,1,"day")}return!0}return t>=e},e.prototype.isLinkCritical=function(e){var t=!1;if(0==e.type){var i=this.tasks(),n=i.getItem(e.source),r=i.getItem(e.target);t=n&&r&&n.$critical&&r.$critical}return t},e.prototype.getVisibleTasksCollection=function(e){if(!e&&"resources"==this.state.display){var t=this.app.getService("grouping");return t?t.getResourceTree():null}return this._tasks},e.prototype.taskCalendarMap=function(e,t){var i=this;if(e)return this._calendarMap||null;this._calendarMap||(this.assignments().data.attachEvent("onStoreUpdated",(function(){i.refreshCalendarMap()})),this.resources().data.attachEvent("onStoreUpdated",(function(){i.refreshCalendarMap()})),this.calendars().data.attachEvent("onStoreUpdated",(function(){i.refreshCalendarMap()})));var n=[this.assignments(t).waitData,this.resources(t).waitData];return t||n.push(this.calendars().waitData),webix.promise.all(n).then((function(){return i._calendarMap||i.refreshCalendarMap(),i._calendarMap}))},e.prototype.refreshCalendarMap=function(){var e=this.resources(),t=this.calendars(),i={};return this.assignments().data.each((function(n){var r=e.getItem(n.resource);if(r){var o=r.calendar_id,a=o?t.getItem(o):null;a&&!i[n.task]&&(i[n.task]=a)}})),this._calendarMap=i},e.prototype.getTaskCalendar=function(e){var t=this.taskCalendarMap(!0);return t?t[e]:null},e.prototype.isHoliday=function(e,t){if(t&&this._calendarMap){var i=this._calendarMap[t];if(i)return this.Helpers.isResourceHoliday(e,i)}return this.app.config.isHoliday(e)},e.prototype.clearAll=function(){var e=this,t=this.app.getService("grouping");this.state.$batch({edit:null,selected:null,sort:null,top:0,left:0}),this.app.config.resourcesDiagram&&t.getRDCollection().clearAll(),this.app.config.resources&&t.getResourceTree().clearAll(),["tasks","links","resources","categories","assignments","calendars"].forEach((function(t){var i="_"+t;e[i]&&e[i].clearAll()})),this.resetScales()},e.prototype.reload=function(){var e=this;this.clearAll();var t=this.app.getService("grouping"),i=["tasks","links"],n=[];this.app.config.resources&&!this.app.config.resourceCalendars&&i.push("resources","assignments"),i.forEach((function(t){var i=e[t](!0);n.push(i.waitData)})),this.app.config.resourcesDiagram&&t.getRDCollection(!0),webix.promise.all(n).then((function(){e.app.refresh()}))},e.prototype.updateScaleMinMax=function(e){var t=this,i=1/0,n=-1/0;if(e.data.each((function(e){e.start_date<i&&(i=e.start_date),e.end_date>n&&(n=e.end_date),t.state.baseline&&e.planned_start&&e.planned_end&&(e.planned_start<i&&(i=e.planned_start),e.planned_end>n&&(n=e.planned_end))})),"object"==typeof i){var r=this.getScales();this.setScales(this.Helpers.addUnit(r.minUnit,i,-1),this.Helpers.addUnit(r.minUnit,n,1),r.precise)}},e}(),be=function(){function e(e,t){this.app=e,this._url=t}return e.prototype.url=function(e){return this._url+e},e.prototype.tasks=function(){return webix.ajax(this.url("tasks")).then((function(e){return e.json()}))},e.prototype.links=function(){return webix.ajax(this.url("links")).then((function(e){return e.json()}))},e.prototype.resources=function(){return webix.ajax(this.url("resources")).then((function(e){return e.json()}))},e.prototype.categories=function(){return webix.ajax(this.url("categories")).then((function(e){return e.json()}))},e.prototype.assignments=function(){return webix.ajax(this.url("assignments")).then((function(e){return e.json()}))},e.prototype.calendars=function(){return webix.ajax(this.url("calendars")).then((function(e){return e.json()}))},e.prototype.addTask=function(e,t,i){var n=webix.ajax().post(this.url("tasks"),r(r({},e),{mode:t,parent:i})).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[n]),n},e.prototype.removeTask=function(e){var t=webix.ajax().del(this.url("tasks/"+e)).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[t]),t},e.prototype.updateTask=function(e,t,i){var n=webix.ajax().put(this.url("tasks/"+e+(i?"/split":"")),t).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[n]),n},e.prototype.reorderTask=function(e,t){var i=webix.ajax().put(this.url("tasks/"+e+"/position"),t).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[i]),i},e.prototype.addLink=function(e){var t=webix.ajax().post(this.url("links"),e).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[t]),t},e.prototype.updateLink=function(e,t){var i=webix.ajax().put(this.url("links/"+e),t).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[i]),i},e.prototype.removeLink=function(e){var t=webix.ajax().del(this.url("links/"+e)).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[t]),t},e.prototype.addAssignment=function(e){var t=webix.ajax().post(this.url("assignments"),e).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[t]),t},e.prototype.updateAssignment=function(e,t){var i=webix.ajax().put(this.url("assignments/"+e),t).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[i]),i},e.prototype.removeAssignment=function(e){var t=webix.ajax().del(this.url("assignments/"+e)).then((function(e){return e.json()}));return this.app.callEvent("backend:operation",[t]),t},e}(),ge=function(){function e(e){this.app=e,this._local=this.app.getService("local"),this._helpers=this.app.getService("helpers"),this._back=this.app.getService("backend"),this._state=this.app.getState()}return e.prototype.addTask=function(e,t,i,n){var o=this;this.updateTaskDuration(e,n),e.planned_start&&this.updatePlannedTaskDuration(e,n);var a=0==t?"first":"last";return this._back.addTask(this.cleanData(e),a,i).then((function(n){return o._local.adjustScale(e),o._local.tasks().add(r(r({},e),{id:n.id,parent:i}),t,i),o.completeAdd(i,n)}))},e.prototype.splitTaskWithDnd=function(e,t,i,n){var o=this;return this.updateTaskDuration(e),this._back.updateTask(i,r(r({},e),{position:t,parent:i}),!0).then((function(a){o._local.adjustScale(e);var s=o._local.tasks();return s.updateItem(i,{type:"split",duration:n.duration||1,progress:n.progress||0}),(a.sibling&&0!=a.sibling||!s.find((function(e){return e.parent==i}),!0))&&(s.add(r(r({},n),{type:"task",parent:i,id:a.sibling,duration:n.duration||1,progress:n.progress||0}),0,i),++t),s.add(r(r({},e),{id:a.id,parent:i,position:t}),t,i),o.completeAdd(i,a,a.sibling)}))},e.prototype.completeAdd=function(e,t,i){var n=this;return e?this.syncProject(e).then((function(){return n._state.criticalPath&&n._local.showCriticalPath(),i&&(t.sibling=i),t})):webix.promise.resolve(t)},e.prototype.updateTask=function(e,t,i,n){var o=this,a=this._local.tasks(),s=webix.copy(a.getItem(e)),l=r(r({},s),t),c=!(webix.Date.equal(s.start_date,l.start_date)&&webix.Date.equal(s.end_date,l.end_date));c&&this.updateTaskDuration(l,i);var u=l.planned_start&&!(webix.Date.equal(s.planned_start,l.planned_start)&&webix.Date.equal(s.planned_end,l.planned_end));return u&&this.updatePlannedTaskDuration(l,i),n||"project"!=l.type||"project"==s.type?this._back.updateTask(e,this.cleanData(l)).then((function(){var t=o._local.getScales(),i=t.start,r=t.end;return(i>l.start_date||r<l.end_date||u&&(i>l.planned_start||r<l.planned_end))&&o._local.adjustScale(l),a.updateItem(e,l),"task"!=l.type&&"task"==s.type&&o.removeAssignments(l),n||!c&&s.progress==l.progress&&s.parent==l.parent||(s.$count&&"project"==s.type?o.syncTasks(e,s.start_date,l.start_date).then((function(){return o.syncProject(s.parent)})):s.parent!=l.parent?webix.promise.all([o.syncProject(l.parent),o.syncProject(s.parent)]):o.syncProject(l.parent)).then((function(){o._state.criticalPath&&(a.updateItem(e,{$critical:!1}),o._local.showCriticalPath())})),l})):this.syncProject(e,l)},e.prototype.updateTaskDuration=function(e,t){var i=this;if(this.app.config.excludeHolidays){var n=void 0;if(t){var r=(t="move"==t?"start":t)+("start"===t||"end"===t?"_date":"");n=this._local.tasks().getItem(e.id)[r]>e[r]?-1:1,"start"!=t&&(t="end")}var o=webix.copy(this._local.getScales());o.isHoliday=function(t){return i._local.isHoliday(t,e.id)},this._helpers.updateTaskDuration(e,o,t,n)}else this._helpers.updateTaskDuration(e)},e.prototype.updatePlannedTaskDuration=function(e,t){var i=this;if(this.app.config.excludeHolidays){var n=void 0;if(t){var r="planned_"+t;n=this._local.tasks().getItem(e.id)[r]>e[r]?-1:1}var o=webix.copy(this._local.getScales());o.isHoliday=function(t){return i._local.isHoliday(t,e.id)},this._updatePlannedTaskDuration(e,o,t,n)}else this._updatePlannedTaskDuration(e)},e.prototype._updatePlannedTaskDuration=function(e,t,i,n){var o=r({},e);o.start_date=e.planned_start,o.duration=e.planned_duration,o.end_date=e.planned_end,this._helpers.updateTaskDuration(o,t,i,n),e.planned_start=o.start_date,e.planned_end=o.end_date,e.planned_duration=o.duration},e.prototype.syncTasks=function(e,t,i){var n=this,o=i-t;if(this.app.config.excludeHolidays&&(o=this.getWorkDateDiff(o,t,e)),o){var a=[];return this._local.tasks().data.eachSubItem(e,(function(e){var t=e.start_date.valueOf()+o;if(n.app.config.excludeHolidays){var i=o-n.getWorkDateDiff(o,e.start_date,e.id);i&&(t+=i)}var s=r(r({},e),{start_date:new Date(t),end_date:null});a.push(n.updateTask(e.id,s,"move",!0))})),webix.promise.all(a)}return webix.promise.resolve()},e.prototype.getWorkDateDiff=function(e,t,i){for(var n=Math.sign(e),r=n*Math.floor(e/864e5),o=0,a=t;o<r;++o)webix.Date.add(a,n,"day"),this._local.isHoliday(a,i)&&(e-=864e5*n);return e},e.prototype.syncProject=function(e,t){var i=this,n=this._local.tasks();if(!t)if(t=n.getItem(e),this.app.config.projects&&t&&"split"!=t.type)t.type=t.$count?"project":"task",this.removeAssignments(t);else for(;t&&"project"!=t.type;)e=n.getParentId(e),t=n.getItem(e);return t&&t.$count&&(t=this.setProjectData(t)),t?this.updateTask(e,t,"start",!0).then((function(){return i.syncProject(t.parent),t})):webix.promise.resolve()},e.prototype.setProjectData=function(e,t,i){i||(e=webix.copy(e));var n=1/0,r=0,o=0,a=0,s=function(e){n=e.start_date<n?e.start_date:n,r=e.end_date>r?e.end_date:r,!e.duration||"project"==e.type&&e.$count||(o+=e.duration*e.progress,a+=1*e.duration)};return i?i.forEach(s):(t||this._local.tasks()).data.eachSubItem(e.id,s),webix.Date.equal(e.start_date,n)||(e.start_date=n,e.duration=null),webix.Date.equal(e.end_date,r)||(e.end_date=r,e.duration=null),e.progress=o?Math.round(o/a):o,e},e.prototype.updateTaskTime=function(e,t,i){var n=this._local.tasks().getItem(e),r={},o=this._local.getScales(),a=o.precise?this._helpers.getSmallerUnit(o.minUnit):o.minUnit;if("start"===t||"move"===t){var s=o.precise?n.start_date:this._helpers.getUnitStart(a,n.start_date);r.start_date=this._helpers.addUnit(a,s,i),"start"===t&&r.start_date>n.end_date&&(r.start_date=this._helpers.addUnit(a,n.end_date,-1))}else if("end"===t){var l=this._helpers.getUnitStart(a,n.end_date);s=o.precise||webix.Date.equal(l,n.end_date)?n.end_date:this._helpers.addUnit(a,l,1),r.end_date=this._helpers.addUnit(a,s,i),r.end_date<n.start_date&&(r.end_date=this._helpers.addUnit(a,n.start_date,1))}return"move"===t?r.end_date=null:r.duration=0,this.updateTask(e,r,t)},e.prototype.removeTask=function(e){var t=this,i=this._local.tasks(),n=this._local.links();return n.find((function(t){return t.source==e||t.target==e})).forEach((function(e){return n.remove(e.id)})),this._back.removeTask(e).then((function(n){var r=i.getItem(e).parent;return i.remove(e),t.app.config.split&&0!=r&&"split"===i.getItem(r).type&&!i.find((function(e){return e.parent==r}),!0)?t.updateTask(r,{type:"task"}).then((function(){return t.completeRemoval(n,r)})):t.completeRemoval(n,r)}))},e.prototype.completeRemoval=function(e,t){var i=this;return this.syncProject(t).then((function(){return i._state.criticalPath&&i._local.showCriticalPath(),e}))},e.prototype.addLink=function(e){var t=this;return this.linkExists(e)?webix.promise.reject():this._back.addLink(e).then((function(i){return e.id=i.id,t._local.links().add(e),e}))},e.prototype.linkExists=function(e){return this._local.links().find((function(t){return t.target==e.target&&t.source==e.source&&t.type==e.type}),!0)},e.prototype.updateLink=function(e,t){var i=this;return this._back.updateLink(e,t).then((function(n){var o=i._local.links(),a=i.linkExists(r(r({},o.getItem(e)),t));return o.updateItem(e,t),a?i.removeLink(a.id).then((function(){return n})):n}))},e.prototype.removeLink=function(e){var t=this;return this._back.removeLink(e).then((function(i){return t._local.links().remove(e),i}))},e.prototype.moveTask=function(e,t,i){var n=this;t=t||0;var r=this._local.tasks(),o=r.data.branch[t],a=r.getItem(e).parent,s=r.data.getBranchIndex(e);return t==a&&(i===s||-1===i&&e===o[o.length-1])?webix.promise.reject():(r.move(e,i,null,{parent:t}),this._back.reorderTask(e,{parent:t,mode:0===i?"first":-1===i?"last":"after",target:r.data.branch[t][i-1]}).then((function(i){return t!==a?(r.updateItem(e,{parent:t}),webix.promise.all([n.syncProject(t),n.syncProject(a)]).then((function(){return n._state.criticalPath&&n._local.showCriticalPath(),i}))):i})))},e.prototype.updateAssignment=function(e,t){var i=this;return this._back.updateAssignment(e,t).then((function(n){return i._local.assignments().updateItem(e,t),n}))},e.prototype.addAssignment=function(e){var t=this;return this._back.addAssignment(e).then((function(i){return e.id=i.id,t._local.assignments().add(e),e}))},e.prototype.removeAssignment=function(e){var t=this;return this._back.removeAssignment(e).then((function(i){return t._local.assignments().remove(e),i}))},e.prototype.sortResources=function(e,t){return e.category==t.category?e.name>t.name?1:-1:e.category>t.category?1:-1},e.prototype.removeAssignments=function(e){var t=this;if(this.app.config.resources){var i=this._local.assignments(),n=[];return i.waitData.then((function(){return i.data.each((function(i){i.task==e.id&&n.push(t.removeAssignment(i.id))})),n.length?webix.promise.all(n):webix.promise.resolve(!1)}))}return webix.promise.resolve(!1)},e.prototype.cleanData=function(e){var t={};for(var i in e)0!==i.indexOf("$")&&(t[i]=e[i]);return t},e.prototype.updateAssignedTaskDates=function(e){var t=webix.copy(e);this.updateTaskDuration(t),(!webix.Date.equal(e.start_date,t.start_date)||!webix.Date.equal(e.end_date,t.end_date))&&this.updateTask(e.id,t,null,!0)},e}();function we(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Ae(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function xe(e){Ae(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function ve(e,t){Ae(2,arguments);var i=xe(e),n=we(t);return isNaN(n)?new Date(NaN):n?(i.setDate(i.getDate()+n),i):i}function me(e,t){Ae(2,arguments);var i=xe(e),n=we(t);if(isNaN(n))return new Date(NaN);if(!n)return i;var r=i.getDate(),o=new Date(i.getTime());return o.setMonth(i.getMonth()+n+1,0),r>=o.getDate()?o:(i.setFullYear(o.getFullYear(),o.getMonth(),r),i)}function ye(e,t){Ae(2,arguments);var i=xe(e).getTime(),n=we(t);return new Date(i+n)}function Ce(e,t){Ae(1,arguments);var i=t||{},n=i.locale,r=n&&n.options&&n.options.weekStartsOn,o=null==r?0:we(r),a=null==i.weekStartsOn?o:we(i.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=xe(e),l=s.getDay(),c=(l<a?7:0)+l-a;return s.setDate(s.getDate()-c),s.setHours(0,0,0,0),s}function ke(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Se(e){Ae(1,arguments);var t=xe(e);return t.setHours(0,0,0,0),t}function Be(e,t){Ae(2,arguments);var i=xe(e),n=xe(t),r=i.getTime()-n.getTime();return r<0?-1:r>0?1:r}function $e(e,t){Ae(2,arguments);var i=xe(e),n=xe(t);return 12*(i.getFullYear()-n.getFullYear())+(i.getMonth()-n.getMonth())}function De(e,t){Ae(2,arguments);var i=xe(e),n=xe(t);return i.getFullYear()-n.getFullYear()}function Ee(e,t){return Ae(2,arguments),xe(e).getTime()-xe(t).getTime()}var Te={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}};function Le(e){return e?Te[e]:Te.trunc}function Ie(e){Ae(1,arguments);var t=xe(e);return t.setHours(23,59,59,999),t}function qe(e){Ae(1,arguments);var t=xe(e),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function Pe(e){Ae(1,arguments);var t=xe(e);return Ie(t).getTime()===qe(t).getTime()}function Re(e,t){Ae(2,arguments);var i,n=xe(e),r=xe(t),o=Be(n,r),a=Math.abs($e(n,r));if(a<1)i=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*a);var s=Be(n,r)===-o;Pe(xe(e))&&1===a&&1===Be(e,r)&&(s=!1),i=o*(a-Number(s))}return 0===i?0:i}function Me(e,t){var i=e.getDay();return t&&(0===i?i=6:i--),i}var Fe={year:function(e,t){Ae(2,arguments);var i=xe(e),n=xe(t),r=Be(i,n),o=Math.abs(De(i,n));i.setFullYear(1584),n.setFullYear(1584);var a=Be(i,n)===-r,s=r*(o-Number(a));return 0===s?0:s},quarter:function(e,t,i){Ae(2,arguments);var n=Re(e,t)/3;return Le(null==i?void 0:i.roundingMethod)(n)},month:Re,week:function(e,t,i){return function(e,t,i){Ae(2,arguments);var n=Ce(e,i),r=Ce(t,i),o=n.getTime()-ke(n),a=r.getTime()-ke(r);return Math.round((o-a)/6048e5)}(e,t,{weekStartsOn:i?1:0})},day:function(e,t){Ae(2,arguments);var i=Se(e),n=Se(t),r=i.getTime()-ke(i),o=n.getTime()-ke(n);return Math.round((r-o)/864e5)},hour:function(e,t,i){Ae(2,arguments);var n=Ee(e,t)/36e5;return Le(null==i?void 0:i.roundingMethod)(n)},minute:function(e,t,i){Ae(2,arguments);var n=Ee(e,t)/6e4;return Le(null==i?void 0:i.roundingMethod)(n)}},Ue={year:["quarter",4],quarter:["month",3],month:["day",function(e){if(!e)return 30;var t=e.getMonth();if(1===t){var i=e.getFullYear();return i%4?28:i%100?29:i%400?28:29}return t%2&&t<7||!(t%2)&&t>7?30:31}],week:["day",7],day:["hour",24],hour:["minute",60],minute:["minute",1]},Oe={year:function(e,t){return Ae(2,arguments),me(e,12*we(t))},quarter:function(e,t){return Ae(2,arguments),me(e,3*we(t))},month:me,week:function(e,t){return Ae(2,arguments),ve(e,7*we(t))},day:ve,hour:function(e,t){return Ae(2,arguments),ye(e,36e5*we(t))},minute:function(e,t){return Ae(2,arguments),ye(e,6e4*we(t))}};function Ve(e,t,i,n,r,o){var a=e;if(r){var s=Ue[e][0];"number"!=typeof s&&"function"!=typeof s&&(a=s)}var l=i,c=t;if(o&&(l=Ne(a,l,n),(c=Ne(a,c,n))<t&&(c=je(a)(c,1))),r){var u=Fe[a](c,l),h=Ue[e][1],p=0;return"function"==typeof h?p=h(i):"number"==typeof h&&(p=h),u/p}return Fe[a](c,l,n)}function He(e){return function(t,i,n,r,o){return"month"===e&&r?function(e,t,i){if(ze(t,e))return Ve("month",e,t,null,!0,i);var n=0;if(t.getDate()>1){var r=new Date(t.getFullYear(),t.getMonth()+1,1);n=Ve("month",r,t,null,!0),t=r}var o=0;return ze(t,e)||(o=Ve("month",Ne("month",e),t),t=je("month")(t,o)),n+o+Ve("month",e,t,null,!0)}(t,i,o):Ve(e,t,i,n,r,o)}}function ze(e,t){return Ne("month",e).valueOf()===Ne("month",t).valueOf()}function je(e){return Oe[e]}function Ne(e,t,i){var n;switch(e){case"year":return new Date(t.getFullYear(),0,1);case"quarter":return new Date(t.getFullYear(),3*Math.floor(t.getMonth()/3),1);case"month":return new Date(t.getFullYear(),t.getMonth(),1);case"week":return(n=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setDate(t.getDate()-Me(t,i)),n;case"day":return(n=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setHours(0,0,0,0),n;case"hour":return(n=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setHours(t.getHours(),0,0,0),n;default:return new Date(t)}}function We(e,t,i,n,r){var o=i.start,a=i.end,s=i.cellWidth,l=i.cellHeight,c=i.diff,u=i.minUnit,h=i.precise,p=e.start_date<o?o:e.start_date,d=e.end_date>a?a:e.end_date,_=Ne(u,o,i.startOnMonday),f="milestone"==e.type;e.$h=n,e.$x=Math.round(c(p,_,i.startOnMonday,h)*s)-(f?e.$h/2:0),e.$w=f?e.$h:Math.round(c(d,p,i.startOnMonday,h,!0)*s),e.$y=void 0===r?l*t+(l-n)/2:r}function Ye(e){e.duration=0,e.end_date=e.start_date}function Ge(e){return e.duration<1?je("hour")(e.start_date,Math.floor(24*e.duration)):je("day")(e.start_date,e.duration)}function Ke(e,t){if(e.duration<1)return Ge(e);for(var i=function(e,t){var i=new Date(e.valueOf());return i.setHours(0),i.getDate()!=e.getDate()?e.setHours(1):e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}(e.start_date),n=0,r=0;n<e.duration;)t.isHoliday(i)?30==++r&&Je():(++n,r=0),i=je("day")(i,1);return i}function Qe(e,t){var i=He("day")(e.end_date,e.start_date,!0);if(i<1)return parseFloat(i.toFixed(2));if(!t)return Math.floor(i);for(var n=e.start_date,r=0;n<e.end_date;)t.isHoliday(n)||++r,n=je("day")(n,1);return r}function Xe(e,t){for(var i,n=e,r=e,o=0;o<30&&(i=t.isHoliday(r))&&t.isHoliday(n);)n=je("day")(n,-1),r=je("day")(r,1),o++;return 30===o&&Je(),i?n:r}function Je(){throw alert("No work days found within 30 days, check your isHoliday function!"),"Wrong isHoliday function"}function Ze(e,t,i,n){for(var r=0;r<30&&i.isHoliday(et(e,t));)e=je("day")(e,n),r++;return 30===r&&Je(),e}function et(e,t){return t&&!function(e,t){return(e.valueOf()/1e3-60*e.getTimezoneOffset())%86400}(e)?je("day")(e,-1):e}var tt=function(){function e(e){this.app=e,this.defaultResourceUnit="hour",this.defaultResourceValues={hour:8},this.resourceValueRanges={hour:[.5,24]},this.resourceValueSteps={hour:.5},this.unitLoadNorm={day:8,week:40,month:170,quarter:510,year:2040}}return e.prototype.initials=function(e){var t=e.match(/\b\w/g)||[];return 1==t.length?e.charAt(0).toUpperCase()+e.charAt(1):((t.shift()||"")+(t.pop()||"")).toUpperCase()},e.prototype.avatarCss=function(e){return" webix_gantt_person_avatar_"+(e.charCodeAt(1)+e.length%10)%10},e.prototype.resourceAvatar=function(e,t,i){var n="webix_gantt_person_avatar";if("string"==typeof t&&(n+=" "+t),e.avatar)return'<img class="'+n+'" src="'+e.avatar+'" webix_tooltip="'+(i?e.name:"")+'"/>';var r=e.name;return"<div class='"+n+" "+(r?this.avatarCss(r):"")+"' webix_tooltip=\""+(i?e.name:"")+'">'+(r?this.initials(r):"")+"</div>"},e.prototype.getDefaultResourceValue=function(e){var t=this.getResourceUnit(e);return this.defaultResourceValues[t]},e.prototype.getResourceUnit=function(e){return e.unit||this.defaultResourceUnit},e.prototype.getResourceValueRange=function(e){var t=this.getResourceUnit(e);return this.resourceValueRanges[t]||[1,100]},e.prototype.getResourceValueStep=function(e){var t=this.getResourceUnit(e);return this.resourceValueSteps[t]||null},e.prototype.isResourceHoliday=function(e,t){var i=!1;return t.holidays&&(i=t.holidays.find((function(t){return t.getTime()==e.getTime()}))),t.weekDays&&(i=i||-1==t.weekDays.indexOf(e.getDay())),i},e.prototype.addUnit=function(e,t,i){return je(e)(t,i)},e.prototype.getDifference=function(e,t,i){return He(e)(t,i,webix.Date.startOnMonday)},e.prototype.getUnitStart=function(e,t){return Ne(e,t,webix.Date.startOnMonday)},e.prototype.updateTask=function(e,t){var i=this.app.getService("local");return function(e,t,i,n,r){return"split"===e.type&&e.$data&&e.$data.length?e.$data.forEach((function(e){return We(e,t,i,n)})):We(e,t,i,n,void 0),e}(e,t,i.getScales(),i.getTaskHeight())},e.prototype.setScales=function(e,t,i,n,r,o){return function(e,t,i,n,r,o,a,s){var l=function(e){var t=new Date;return e.map((function(e){return{item:e,len:je(e.unit)(t,1)}})).sort((function(e,t){return e.len<t.len?-1:1}))[0].item.unit}(o),c=He(l),u=Ne(l,t,s);e=Ne(l,e,s),t=u<t?je(l)(u,1):u;var h=c(t,e,s)*n,p=r*o.length;return{rows:o.map((function(i){for(var o=[],a=je(i.unit),u=i.step||1,h="week"===l&&"week"!==i.unit,p=Ne(i.unit,e,s);p<t;){var d=a(p,u);p<e&&(p=e),d>t&&(d=t);var _=p,f=d;h&&(Me(p,s)>3&&(_=je("week")(p,1)),Me(d,s)>3&&(f=je("week")(d,1)));var b=(c(f,_,s)||1)*n,g="";i.css&&(g+="function"==typeof i.css?i.css(p):i.css),o.push({width:b,css:g,date:p,format:i.format}),p=d}return{cells:o,add:a,height:r,type:i.unit,step:i.step||1}})),width:h,height:p,cellWidth:n,cellHeight:r,diff:c,start:e,end:t,minUnit:l,precise:i=!!("day"===l?i:0!=i),isHoliday:a,startOnMonday:s}}(e,t,i,n,r,o,this.app.config.isHoliday,webix.Date.startOnMonday)},e.prototype.updateLink=function(e,t,i){return function(e,t,i,n){var r=Math.round(n/2);if(!t||!i)return e.$p="",e;var o=!1,a=!1;switch(e.type){case 0:a=!0;break;case 1:o=!0,a=!0;break;case 3:o=!0}var s,l,c=o?t.$x:t.$x+t.$w,u=t.$y,h=a?i.$x:i.$x+i.$w,p=i.$y;if(function(e,t,i,n,r){return"milestone"===e.type||"milestone"===t.type?Math.abs(i-n)>r/2:i!==n}(t,i,c,h,n)||u!==p){var d=function(e,t,i,n,r,o,a){var s=e+20*(r?-1:1),l=i+20*(o?-1:1),c=[e,t,s,t,0,0,0,0,l,n,i,n],u=l-s,h=n-t,p=o===r;return!p&&(l<=e+20-2&&o||l>e&&!o)&&(h-=19),p&&o&&s>l||p&&!o&&s<l?(c[4]=c[2]+u,c[5]=c[3],c[6]=c[4],c[7]=c[5]+h):(c[4]=c[2],c[5]=c[3]+h,c[6]=c[4]+u,c[7]=c[5]),c.join(",")}(c,u+r,h,p+r,o,a),_=(s=h,l=p+r,a?s-5+","+(l-3)+","+(s-5)+","+(l+3)+","+s+","+l:s+5+","+(l+3)+","+(s+5)+","+(l-3)+","+s+","+l);e.$p=d+","+_}else e.$p="";return e}(e,t,i,this.app.getService("local").getTaskHeight())},e.prototype.updateTaskDuration=function(e,t,i,n){return function(e,t,i,n){e.start_date&&e.end_date&&e.start_date.valueOf()>=e.end_date.valueOf()&&(e.end_date=null,e.duration=1,i&&(i="move")),t?function(e,t,i,n){if("milestone"==e.type)return e.start_date=i?Ze(e.start_date,!1,t,n):Xe(e.start_date,t),Ye(e);i?"start"==i||"move"==i?(e.start_date=Ze(e.start_date,!1,t,n),e.duration||(e.duration=Qe(e,t)),e.end_date||(e.end_date=Ke(e,t))):(e.end_date||(e.end_date=Ke(e,t)),e.duration||(e.end_date=Ze(e.end_date,!0,t,n),e.duration=Qe(e,t))):(e.start_date=Xe(e.start_date,t),e.end_date=Ke(e,t),e.duration=Qe(e,t))}(e,t,i,n):"milestone"==e.type?Ye(e):(e.duration||(e.duration=Qe(e)),e.end_date||(e.end_date=Ge(e)))}(e,t,i,n)},e.prototype.getSmallerUnit=function(e){return Ue[e][0]},e.prototype.getSmallerCount=function(e){return Ue[e][1]},e.prototype.newLink=function(e,t,i){return function(e,t,i){if(t&&i){var n=i.x-t.x,r=i.y-t.y,o=(n>0?t.x:i.x)-e.left,a=(r>0?t.y:i.y)-e.top,s=(n>0?0:-n)+","+(r>0?0:-r)+","+(n>0?n:0)+","+(r>0?r:0);return{width:Math.abs(n),height:Math.abs(r),left:o,top:a,p:s}}return null}(e,t,i)},e.prototype.drawGridInner=function(e,t,i){return function(e,t,i){var n=document.createElement("canvas");n.setAttribute("width",e+""),n.setAttribute("height",t+"");var r=n.getContext("2d");return r.strokeStyle=i,r.moveTo(0,t),r.lineTo(e,t),r.lineTo(e,0),r.stroke(),n.toDataURL()}(e,t,i)},e}(),it=function(){function e(e){this.app=e,this.local=e.getService("local"),this.helpers=e.getService("helpers"),this.closedResources=null}return e.prototype.getTreeData=function(e,t){var i=this,n=e.filter((function(e){return e.parent==t}));return n.forEach((function(t){var n=i.getTreeData(e,t.id);n&&(t.data=n)})),n},e.prototype.getRDCollection=function(e){var t=this;if(this._rdCollection&&!e)return this._rdCollection;var i=this.local.tasks(),n=this.local.assignments(),r=this.local.resources();return this._rdCollection?this._rdCollection.clearAll():(this._rdCollection=new webix.TreeCollection({}),webix.extend(this._rdCollection,webix.Group),this.syncRDWithData()),webix.promise.all([i.waitData,n.waitData,r.waitData]).then((function(){var e=[],i=t.local.getScales();n.data.each((function(n){var r=t.getDiagramItemData(n,i);r&&e.push(r)})),t._rdCollection.parse(e),t.groupResourceDiagram()})),this._rdCollection},e.prototype.syncRDWithData=function(){var e=this;this.app.on("onScalesUpdate",(function(t,i){e._rdCollection&&e._rdCollection.data.order.length&&(e.refreshTaskDiagram(),t.minUnit!==i.minUnit&&(e.updateUnitDurations(),e.groupResourceDiagram()))})),this.local.tasks().data.attachEvent("onStoreUpdated",(function(t,i,n){n&&i&&("update"==n||"delete"==n||e.local.assignments().find((function(e){return e.task===i.id}),!0))&&(e.updateTaskDiagram(i,n),e.groupResourceDiagram())})),this.local.assignments().data.attachEvent("onStoreUpdated",(function(t,i,n){t&&(e.refreshResourceDiagram(t,i,n),e.groupResourceDiagram())}))},e.prototype.updateUnitDurations=function(){var e=this,t=this.local.tasks(),i=this.local.assignments(),n=this.local.getScales();this._rdCollection.data.each((function(o){if(o.task){var a=t.getItem(o.task),s=i.getItem(o.id);a&&s&&(o.duration=e.calculateUnitDuration(a,n),o.value=e.calculateLoad(r(r({},a),s),n.minUnit))}}))},e.prototype.calculateUnitDuration=function(e,t){return"day"===t.minUnit?e.duration:t.diff(e.end_date,e.start_date,webix.Date.startOnMonday,!1,!0)},e.prototype.getDiagramItemData=function(e,t){var i=this.local.tasks().getItem(e.task);if(i){this.local._isTaskVisible(i,!0)||this.helpers.updateTask(i,0);var n=this.local.resources().getItem(e.resource),o=r(r(r({},i),n),e);return o.duration=this.calculateUnitDuration(i,t),o.value=this.calculateLoad(o,t.minUnit),o.$x=this.truncateX(o.$x,t),o}return null},e.prototype.calculateLoad=function(e,t){var i=this.getUnitLoad(e);if("hour"===t)return[0,0,i/24];if("day"===t)return[0,0,i];var n,r=[],o=webix.Date.copy(e.start_date),a=this.helpers.getUnitStart(t,o),s=webix.Date.copy(e.end_date),l=this.helpers.getUnitStart(t,s);if(webix.Date.datePart(o,!0)>a)if(s>(n=this.helpers.addUnit(t,a,1))){var c=this.findUnitDuration(o,n,e);r.push(c),o=n}else r.push(0);else r.push(0);if(!webix.Date.equal(a,l)&&webix.Date.datePart(s,!0)>=l){var u=this.findUnitDuration(l,s,e);r.push(u),s=l}else r.push(0);var h=this.helpers.addUnit(t,o,1),p=this.findUnitDuration(o,new Date(Math.min(h,s)),e);return r.push(p),r.map((function(e){return e*i}))},e.prototype.findUnitDuration=function(e,t,i){var n=this.helpers.getDifference("day",t,e);if(this.app.config.excludeHolidays){var r=void 0,o=webix.Date.copy(e),a=n;for(r=0;r<a;r++)this.checkHoliday(o,i)&&n--,webix.Date.add(o,1,"day")}return n},e.prototype.checkHoliday=function(e,t){if(this.app.config.resourceCalendars){var i=this.local.resources().getItem(t.resource).calendar_id;if(i){var n=this.local.calendars().getItem(i);return this.helpers.isResourceHoliday(e,n)}}return this.app.config.isHoliday(e)},e.prototype.getUnitLoad=function(e){return e.value},e.prototype.truncateX=function(e,t){return!1!==t.precise?Math.floor(e/t.cellWidth)*t.cellWidth:e},e.prototype.refreshResourceDiagram=function(e,t,i){var n=this._rdCollection,o=this.local.getScales();switch(i){case"update":if(n.exists(e)){var a=this.local.tasks().getItem(t.task),s=r({},this.local.resources().getItem(t.resource));delete s.id;var l=this.calculateLoad(r(r({},a),t),o.minUnit);n.updateItem(e,r(r(r({},t),s),{value:l}))}break;case"add":n.add(this.getDiagramItemData(t,o));break;case"delete":n.exists(e)&&n.remove(e)}},e.prototype.updateTaskDiagram=function(e,t){var i=this,n=this._rdCollection,o=this.local.getScales();if("delete"===t)this.pruneDiagram();else if("add"===t){var a=this.local.assignments().find((function(t){return t.task===e.id}),!0);n.add(this.getDiagramItemData(a,o))}else"update"===t&&n.find((function(t){return t.task===e.id})).forEach((function(t){var a=i.local.assignments().getItem(t.id);n.updateItem(t.id,{start_date:e.start_date,id:t.id,duration:i.calculateUnitDuration(e,o),$x:i.truncateX(e.$x,o),value:i.calculateLoad(r(r({},e),a),o.minUnit)})}))},e.prototype.pruneDiagram=function(){var e=this.local.tasks(),t=[];this._rdCollection.data.eachLeaf(0,(function(i){e.exists(i.task)||t.push(i.id)})),t.length&&this._rdCollection.remove(t)},e.prototype.refreshTaskDiagram=function(){var e=this,t=this.local.getScales();this._rdCollection.data.each((function(i){var n=e.local.tasks().getItem(i.task);n&&(i.$x=e.truncateX(n.$x,t))}))},e.prototype.groupResourceDiagram=function(){var e=this._rdCollection;e.group({by:function(e){return e.name+"-"+e.category},map:{resource_id:["resource"],value:["name"],name:["name"],category:["category"],avatar:["avatar"],load:["value",rt],duration:["duration",nt],units:["value",nt],$x:["$x",nt],count:["value","count"],start_date:["start_date",nt]}}),e.group({by:"category",map:{value:["category"],name:["category"],duration:["duration","sum"],load:["load","sum"],count:["count","sum"]}},0)},e.prototype.getResourceTree=function(){var e=this;return this._resourcesTree||(this._resourcesTree=new webix.TreeCollection({on:{"data->onStoreUpdated":function(t,i,n){t="update"==n||"paint"==n?t:null,e.refreshResourceTasks(t),e.local.refreshLinks()}},scheme:{$sort:{by:"start_date",dir:"asc",as:"int"}}}),this._resourcesTree.parse(this.resourceTaskLoader().finally((function(){e.syncResourceTree()})))),this._resourcesTree},e.prototype.tasksWithResources=function(){var e=this;return webix.promise.all([this.local.tasks().waitData,this.local.assignments().waitData]).then((function(){var t=[];return e.local.tasks().data.each((function(i){if("task"==i.type||!i.type){var n=Object.assign({},i),r=e.local.assignments().data.find((function(e){return e.task==n.id}));n.resources=r.length?r.map((function(e){return e.resource})):null,t.push(n)}}),"",!0),t}))},e.prototype.resourceTaskLoader=function(){var e=this,t=this.app.getService("operations");return webix.promise.all([this.tasksWithResources(),this.local.resources().waitData]).then((function(i){var n=e.getResourceTaskData(i[0]);return n.forEach((function(e){t.setProjectData(e,null,e.data)})),n}))},e.prototype.refreshResourceTree=function(){var e=this;this._resourcesTree.count()?(this.closedResources=[],this._resourcesTree.data.eachChild("0",(function(t){t.open||e.closedResources.push(t.resources)}))):this.closedResources=null,this.resourceTaskLoader().then((function(t){return e._resourcesTree.clearAll(),e._resourcesTree.parse(t),t}))},e.prototype.syncResourceTree=function(){var e=this,t=this._resourcesTree;this.local.tasks().data.attachEvent("onStoreUpdated",(function(i,n,r){if("update"==r){var o=t.exists(i)&&"task"==t.getItem(i).type,a="task"==n.type;if(o&&a){t.updateItem(i,{text:n.text,details:n.details,start_date:n.start_date,end_date:n.end_date,duration:n.duration,progress:n.progress});var s=t.getParentId(i),l=t.getItem(s);return l&&(l=e.app.getService("operations").setProjectData(l,t),t.updateItem(s,l)),!0}o^a&&e.refreshResourceTree()}else e.refreshResourceTree()})),this.local.assignments().data.attachEvent("onStoreUpdated",(function(){e.refreshResourceTree()}))},e.prototype.getResourceTaskData=function(e){var t=this,i=[],n=null,r=this.app.getService("operations");return e.forEach((function(e){var o,a=e.resources;(o=a?i.find((function(e){return ne(e.resources,a)})):n||null)||((o={id:a?webix.uid():"unassigned",type:"project",text:"",data:[],$group:!0,open:t.checkResourceOpen(a)}).resources=a,a&&(o.text=a.map((function(e){return t.local.resources().getItem(e)})).sort(r.sortResources).map((function(e){return e.name})).join(", ")),a?i.push(o):(o.id="unassigned",n=o)),o.data.push(webix.copy(e))})),n&&i.push(n),i},e.prototype.refreshResourceTasks=function(e,t){var i=this,n=this._resourcesTree;if(e){var r=n.getItem(e);t=webix.isUndefined(t)?n.getIndexById(e):t,this.helpers.updateTask(r,t)}else n.data.order.forEach((function(e,t){i.refreshResourceTasks(e,t)}))},e.prototype.checkResourceOpen=function(e){return!this.closedResources||(e?!this.closedResources.find((function(t){return ne(t,e)})):-1==this.closedResources.indexOf(null))},e}();function nt(e,t){for(var i=[],n=0;n<t.length;n++)i.push(e(t[n]));return i}function rt(e,t){for(var i=0,n=0;n<t.length;n++)for(var r=e(t[n]),o=parseInt(t[n].duration),a=r.length-1,s=0;s<r.length;++s){var l=r[s];l&&(i+=(s===a?o:1)*l,o--)}return i}var ot=function(e){function t(t){var i,n,o,a=this,s=z({top:0,left:0,selected:null,edit:null,readonly:t.readonly||!1,sort:null,display:t.resources&&"resources"==t.display?"resources":"tasks",criticalPath:t.criticalPath||!1,resourcesDiagram:!(!t.resources||!t.resourcesDiagram),treeWidth:t.treeWidth||(t.resources?400:500),baseline:t.baseline||!1}),l=t.isHoliday||function(e){var t=e.getDay();return 0===t||6===t},c={router:x,version:"10.1.0",debug:!0,start:"/top",compactWidth:650,markers:[{css:"webix_gantt_today_marker",now:!0}],params:{state:s,forceCompact:t.compact},links:!0,isHoliday:l},u=function(e){return a.config.override&&a.config.override.get(e)||e};return(a=e.call(this,r(r({},c),t))||this).setService("helpers",new(u(tt))(a,t)),a.setService("local",new(u(fe))(a,t)),a.setService("backend",new(u(be))(a,t.url)),a.setService("operations",new(u(ge))(a)),a.setService("grouping",new(u(it))(a)),o={updateConfig:function(e){var t=i.getRoot(),r=t.$view;n?n&&!r.id&&(r.id=n):(r.id?n=r.id:r.id=n="webix_"+webix.uid(),webix.html.addStyle(".webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }"),webix.html.addStyle("#"+n+"{ position: relative; }"),webix.html.addStyle("#"+n+" .webix_window{ z-index:2 !important; }"),webix.html.addStyle("#"+n+" .webix_disabled{ z-index:1 !important; }")),e.container=n,e.fullscreen&&(e._fillApp=!0,delete e.fullscreen),e.on||(e.on={});var o=!0,a=e.on.onShow;return e.on.onShow=function(){var e=this;a&&a.apply(this,arguments),o&&(this.$setSize=function(i,n){U(e,t,!0),webix.ui.window.prototype.$setSize.apply(e,[i,n])},O(this,i),o=null),webix.callEvent("onClick",[]),webix.html.addCss(r,"webix_win_inside"),t.disable(),U(this,t)},e}},(i=a).setService("jet-win",o),a.use(R,a.config.locale||{lang:"en",webix:{en:"en-US"}}),a}return n(t,e),t.prototype.require=function(e,t){return"jet-views"===e?_e[t]:"jet-locales"===e?st[t]:null},t.prototype.getState=function(){return this.config.params.state},t}(A);webix.protoUI({name:"gantt",app:ot,getState:function(){return this.$app.getState()},getService:function(e){return this.$app.getService(e)},$init:function(){var e=this,t=this.$app.getState();for(var i in t)H(t,this.config,i);this.$app.attachEvent("bars:beforedrag",(function(t,i){return e.callEvent("onBeforeDrag",[t,i])})),this.$app.attachEvent("bars:beforedrop",(function(t,i){return e.callEvent("onBeforeDrop",[t,i])}))},$exportView:function(e){return"png"===e.export_mode||"pdf"===e.export_mode&&"image"===e.display?this.$app.getRoot():this.$app.getService("local").tasks()},clearAll:function(){this.$app.getService("local").clearAll()},reload:function(){this.$app.getService("local").reload()}},webix.ui.jetapp);var at={Local:fe,Backend:be,Operations:ge,Helpers:tt,Grouping:it},st={en:{Edit:"Edit",Done:"Done","Delete task":"Delete task","Delete link":"Delete link","The task will be deleted permanently, are you sure?":"The task will be deleted permanently, are you sure?","The link will be deleted permanently, are you sure?":"The link will be deleted permanently, are you sure?",Predecessors:"Predecessors",Successors:"Successors",Title:"Title","Start date":"Start date","End date":"End date",Duration:"Duration",Progress:"Progress",Notes:"Notes",Type:"Type",Project:"Project",Milestone:"Milestone","Add task":"Add task","Add project":"Add project","(no title)":"(no title)","Save changes?":"Save changes?","Related tasks":"Related tasks",Task:"Task",Link:"Link","End to start":"End to start","Start to start":"Start to start","End to end":"End to end","Start to end":"Start to end",Lasts:"Lasts",day:"day",days:"days","Add assignment":"Add assignment",Assignment:"Assignment",Assignments:"Assignments",Assigned:"Assigned","Delete assignment":"Delete assignment","Are you sure to delete this assignment?":"Are you sure to delete this assignment?","No resources to add":"No resources to add",Unassigned:"Unassigned",hour:"h","Hours per":"Hours per","Tasks per":"Tasks per",Name:"Name",Hours:"Hours",Tasks:"Tasks",month:"month",week:"week",quarter:"quarter",year:"year","Split task":"Split task","Planned dates":"Planned dates","Planned dates will be removed, are you sure?":"Planned dates will be removed, are you sure?","Add dates":"Add dates","Remove dates":"Remove dates"}};e.App=ot,e.locales=st,e.services=at,e.views=_e,Object.defineProperty(e,"__esModule",{value:!0})}(t)},36645:()=>{!function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}webix.protoUI({name:"kanbanheader",$kanban:!0,$skin:function(){this.defaults.height=webix.skin.$active.barHeight,this._template_types.sub.height=webix.skin.$active.barHeight-12},$init:function(e){var t=this._template_types[e.type];t&&webix.extend(e,t)},defaults:{css:"webix_kanban_header",borderless:!0,template:function(){var e=this.icon||(this.link?"webix_kanban_icon kbi-plus-circle":"");return(e?"<span class='webix_icon "+(this.link?"webix_kanban_add_icon ":"")+e+"'></span>":"")+"<span class='webix_strong' style='line-height:"+this.height+"px'>"+(this.label||"")+"</span>"}},_template_types:{sub:{css:"webix_kanban_sub_header"}},on_click:{webix_kanban_add_icon:function(){var e={text:""},t=this.getKanban(),i=t.queryView({id:this.config.link});i&&this.callEvent("onBeforeCardAdd",[e,i])&&(t.setListStatus(e,i),t.add(e))}},getKanban:function(){return webix.$$(this.config.master)}},webix.MouseEvents,webix.ui.template);var t={jpg:!0,jpeg:!0,png:!0,gif:!0},i={ppt:"-powerpoint",pptx:"-powerpoint",pptm:"-powerpoint",pps:"-powerpoint",ppsx:"-powerpoint",ppsm:"-powerpoint",doc:"-word",docx:"-word",docm:"-word",xls:"-excel",xlsx:"-excel",xlsm:"-excel",xlsb:"-excel",pdf:"-pdf",wav:"-audio",aif:"-audio",mp3:"-audio",mid:"-audio",mpg:"-video",mov:"-video",wmv:"-video",avi:"-video",mp4:"-video",zip:"-archive",jar:"-archive",rar:"-archive",gz:"-archive",jpg:"-image",jpeg:"-image",png:"-image",gif:"-image"};function n(e){return t[e.toString().toLowerCase()]}var r={height:"auto",icons:[{id:"attachments",icon:"webix_kanban_icon kbi-file",show:function(e){return!!e.attachments&&e.attachments.length},template:"#attachments.length#"},{id:"comments",icon:"webix_kanban_icon kbi-comment",show:function(e,t){return!!t.config.comments},template:function(e){return e.comments&&e.comments.length||""}},{id:"editor",icon:"webix_kanban_icon kbi-pencil",show:function(e,t){return t.config.editor&&!t.config.cardActions}},{id:"menu",icon:"webix_kanban_icon kbi-cogs",show:function(e,t){return!!t.config.cardActions}}],templateTags:function(e,t,i){var n=[];if(e.tags)for(var r=i._tags,o=0;o<e.tags.length;o++){var a=e.tags[o];r.exists(a)&&(a=r.getItem(a).value),n.push("<span class='webix_kanban_tag'>"+a+"</span>")}return"<div  class='webix_kanban_tags'>"+(n.length?n.join(""):"&nbsp;")+"</div>"},templateIcons:function(e,t,i){for(var n=[],r=null,o="",a=0;a<t.icons.length;a++)(r=t.icons[a]).show&&!r.show(e,i)||(o="<span webix_icon_id='"+(r.id||r.icon||r)+"' class='webix_kanban_footer_icon' title='"+(r.tooltip||"")+"'>",o+="<span class='"+(r.icon||r)+" webix_icon'></span>",r.template&&(o+="<span class='webix_kanban_icon_text'>"+webix.template(r.template)(e)+"</span>"),o+="</span>",n.push(o));return"<div  class='webix_kanban_footer_icons'>"+n.join(" ")+"</div>"},templateAvatar:function(e,t,i){var n=i._users,r=e.user_id&&n.exists(e.user_id)?n.getItem(e.user_id):{};return r.image?"<img class='webix_kanban_avatar' src='"+r.image+"' title='"+(r.value||"")+"'>":"<span class='webix_icon webix_kanban_icon kbi-account' title='"+(r.value||"")+"'></span>"},templateBody:function(e){return e.text},templateAttachments:function(e){if(e.attachments)for(var t in e.attachments){var i=e.attachments[t];if(n(i.link.split(".").pop()))return"<img class='webix_kanban_attachment' src='"+i.link+"'/>"}return""},templateFooter:function(e,t,i){return(t.templateTags(e,t,i)||"&nbsp;")+t.templateIcons(e,t,i)},templateStart:webix.template("<div webix_l_id='#id#' class='{common.classname()} webix_kanban_list_item' style='width:{common.width}px; height:{common.height}px;'>"),template:function(e,t){var i=webix.$$(t.master),n=i._colors.exists(e.color)?i._colors.getItem(e.color).color:e.color,r="<div class='webix_kanban_user_avatar' webix_icon_id='$avatar'>"+t.templateAvatar(e,t,i)+"</div>",o="<div class='webix_kanban_body'>"+t.templateBody(e,t,i)+r+"</div>";return"<div class='webix_kanban_list_content'"+(n?" style='border-left-color:"+n+"'":"")+">"+(i.config.attachments?t.templateAttachments(e,t,i):"")+o+"<div class='webix_kanban_footer'>"+t.templateFooter(e,t,i)+"</div></div>"}};webix.KanbanView={$kanban:!0,on_context:{},$skin:function(){},getKanban:function(){return webix.$$(this.config.master)},_kanban_event:function(e,t,i){this.attachEvent(e,(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(n[i]=this).getKanban().callEvent(t,n)}))},_fixOrder:function(){this.data.each((function(e,t){return e.$index=t+1}))},move:function(e,t,i,n){if(i=i||this,n=n||{},webix.isArray(e))return webix.DataMove.move.call(this,e,t,i,n);var r=i!==this,o=this.getKanban(),a=o.getItem(e),s=webix.dp.$$(o.config.id);if(r){if(!o.callEvent("onBeforeStatusChange",[e,i.config.status,i]))return;o.setListStatus(a,i),s?s.ignore((function(){return o.updateItem(e)})):o.updateItem(e)}if(webix.DataMove.move.call(i,e,t),this._fixOrder(),this!==i&&i._fixOrder(),s){var l=webix.copy(a);l.webix_move_index=t,l.webix_move_id=i.data.order[t+1],l.webix_move_parent=i.config.serverStatus||i.config.status,s.save(e,"update",l)}return r&&o.callEvent("onAfterStatusChange",[e,i.config.status,i]),e},_setHandlers:function(){this.attachEvent("onAfterSelect",(function(){this.eachOtherList((function(e){e.unselect()}))})),this._kanban_event("onBeforeSelect","onListBeforeSelect",2),this._kanban_event("onAfterSelect","onListAfterSelect",1),this._kanban_event("onBeforeContextMenu","onListBeforeContextMenu",3),this._kanban_event("onAfterContextMenu","onListAfterContextMenu",3),this._kanban_event("onItemClick","onListItemClick",3),this._kanban_event("onItemDblClick","onListItemDblClick",3),this._kanban_event("onBeforeDrag","onListBeforeDrag",2),this._kanban_event("onBeforeDrop","onListBeforeDrop",2),this._kanban_event("onAfterDrop","onListAfterDrop",2),this._kanban_event("onBeforeDragIn","onListBeforeDragIn",2),this._kanban_event("onDragOut","onListDragOut",2),this.on_click.webix_kanban_user_avatar=this._handle_icons,this.on_click.webix_kanban_footer_icon=this._handle_icons},_handle_icons:function(t,i,n){var r=n.getAttribute("webix_icon_id"),o=this.type.icons;if(o)for(var a=0;a<o.length;a++)"object"===e(o[a])&&(o[a].id||o[a].icon)===r&&o[a].click&&o[a].click.call(this,i,t,n,this);"$avatar"===r?this.getKanban().callEvent("onAvatarClick",[i,t,n,this]):this.getKanban().callEvent("onListIconClick",[r,i,t,n,this])},$dragCreate:function(e,t){var i=webix.DragControl.$drag(e,t);if(!i)return!1;webix.callEvent("onClick",[]);var n=document.createElement("DIV");return n.innerHTML=i,n.className="webix_drag_zone webix_kanban_drag_zone",document.body.appendChild(n),n},$dropHTML:function(){return"<div class='webix_kanban_drop_inner'></div>"},eachOtherList:function(e){var t=this.config.id;this.getKanban().eachList((function(i){i.config.id!=t&&e.call(webix.$$(t),i)}))},defaults:{drag:"move",select:!0}},webix.protoUI({name:"kanbanlist",$init:function(){this.$view.className+=" webix_kanban_list",this.$ready.push(webix.bind(this._setHandlers,this))},defaults:{scroll:"auto"},type:r},webix.ui.list,webix.KanbanView);var o=webix.copy(r);function a(t,i){var n=i.config.status;if("object"===e(n))for(var r in n)t[r]=n[r];else"function"==typeof n?n.call(i,t,!0):t.status=n}function s(t){var i=t.config.status;return"object"===e(i)?function(e){for(var t in i)if(e[t]!=i[t])return!1;return!0}:"function"==typeof i?function(e){return i.call(t,e)}:function(e){return e.status===i}}o.width=200,webix.protoUI({name:"kanbandataview",$init:function(){this.$view.className+=" webix_kanban_list",this.$ready.push(webix.bind(this._setHandlers,this))},defaults:{prerender:!0},type:o},webix.ui.dataview,webix.KanbanView),webix.protoUI({name:"kanbanuploader",$init:function(){var e=this;this.files.data.scheme({$init:function(t){"string"==typeof t.link&&t.link&&(t.name=t.name||t.link.split("/").pop(),t.type=t.type||t.name.split(".").pop(),t.status=t.status||"server"),t.sizetext=t.sizetext||e._format_size(t.size)}}),this.files.data.attachEvent("onStoreUpdated",(function(){var t=webix.$$(e.config.link),i="<span class='webix_strong'>"+(webix.i18n.kanban.dnd||"")+"</span>";e.files.data.count()?t.hideOverlay():t.showOverlay(i)}))},defaults:{icon:"webix_kanban_icon kbi-upload"},getValue:function(){var e=[];return this.files.data.each((function(t){"server"===t.status&&e.push({id:t.id,link:t.link,size:t.size})})),e},_format_size:function(e){for(var t=0;1024<e;)t++,e/=1024;return Math.round(100*e)/100+" "+webix.i18n.fileSize[t]}},webix.ui.uploader),webix.type(webix.ui.dataview,{name:"uploader",height:91,width:161,template:function(e,t){return"<a".concat("server"===e.status?' href="'.concat(e.link,'" download="').concat(e.name,'"'):"","></a>\n\t\t\t\t").concat(t.body(e),"\n\t\t\t\t").concat(t.title(e,t),"\n\t\t\t\t").concat(t.removeIcon(e))},body:function(e){return"server"===e.status&&n(e.type)?'<div class="webix_kanban_uploader_body"><img src="'.concat(e.link,'"></div>'):"<div class='webix_kanban_uploader_body'>\n\t\t\t\t\t<span class='webix_icon webix_kanban_icon kbi-file".concat(function(e){return i[e.toString().toLowerCase()]||""}(e.type),"'></span>\n\t\t\t\t</div>")},title:function(e,t){return'<div class="webix_kanban_uploader_title" title="'.concat(e.name,'">\n\t\t\t\t\t').concat(t.progress(e),'\n\t\t\t\t\t<div class="webix_kanban_uploader_label">').concat(e.name,"</div>\n\t\t\t\t</div>")},progress:function(e){switch(e.status){case"client":return"<span class='webix_kanban_uploader_progress'>"+e.sizetext+"</span>";case"transfer":return"<span class='webix_kanban_uploader_progress'>"+e.percent+"%</span>";case"server":return"<span class='webix_kanban_uploader_progress_server'>"+e.sizetext+"</span>";default:return"<span class='webix_kanban_uploader_progress_error'>ERROR</span>"}},removeIcon:function(){return"<div class='webix_kanban_remove_upload'><span class='webix_icon wxi-close'></span></div>"},on_click:{webix_kanban_remove_upload:function(e,t){return webix.$$(this.config.uploader).files.remove(t),webix.html.preventEvent(e)}}}),webix.i18n.kanban={copy:"Copy",dnd:"Drop Files Here",remove:"Remove",save:"Save",confirm:"The card will be deleted permanently, are you sure?",editor:{add:"Add card",assign:"Assign to",attachments:"Attachments",color:"Color",edit:"Edit card",status:"Status",tags:"Tags",text:"Text",upload:"Upload"},menu:{copy:"Copy",edit:"Edit",remove:"Remove"}},webix.protoUI({name:"kanbaneditor",defaults:{width:534,position:"center",css:"webix_kanban_editor",modal:!0,move:!0},$init:function(t){var i=this,n=webix.$$(t.master);t.head={view:"toolbar",paddingX:17,paddingY:8,elements:[{view:"label",label:webix.i18n.kanban.editor.add,localId:"$kanban_header"},{view:"icon",icon:"wxi-close",click:function(){return i._close()}}]};var r=n.config.editor,o={view:"form",borderless:!0,padding:0,elementsConfig:{labelPosition:"top"}},a=[{view:"textarea",label:webix.i18n.kanban.editor.text,name:"text",height:90},{view:"multicombo",label:webix.i18n.kanban.editor.tags,name:"tags",options:n._tags,$hide:!0},{margin:8,cols:[{view:"combo",label:webix.i18n.kanban.editor.assign,name:"user_id",$hide:!0,options:{body:{data:n._users,yCount:5}}},{view:"richselect",label:webix.i18n.kanban.editor.color,name:"color",$hide:!0,options:{body:{yCount:5,data:n._colors,css:"webix_kanban_colorpicker",template:"<span class='webix_kanban_color_item' style='background-color: #color#'></span>#value#"}}},{view:"richselect",label:webix.i18n.kanban.editor.status,name:"$list",options:{body:{data:n._statuses,yCount:5}}}]}];webix.isArray(r)?o.elements=r:"object"===e(r)?((o=webix.extend(o,r,!0)).view="form",o.elements=o.elements||o.rows||(o.cols?[{cols:o.cols}]:a),delete o.rows,delete o.cols):o.elements=a,n.config.attachments&&o.elements.push({margin:0,rows:[{cols:[{view:"label",label:webix.i18n.kanban.editor.attachments},{view:"kanbanuploader",label:webix.i18n.kanban.editor.upload,upload:n.config.attachments,name:"attachments",autowidth:!0,css:"webix_transparent webix_kanban_uploader",type:"icon"}]},{view:"dataview",localId:"$kanban_dataview_uploader",yCount:1,borderless:!0,type:"uploader",css:"webix_kanban_dataview_uploader",on:{onItemDblClick:function(e,t,i){i.getElementsByTagName("a")[0].click()}}}]}),t.body={paddingX:17,paddingY:0,margin:16,rows:[o,{cols:[{view:"button",label:webix.i18n.kanban.remove,type:"danger",autowidth:!0,hidden:!0,localId:"$kanban_remove",click:function(){var e=i.getValues({hidden:!1}),t=i.getKanban();t.callEvent("onBeforeEditorAction",["remove",i,e])&&t._removeCard(e.id).then((function(){return i._close()}))}},{},{view:"button",label:webix.i18n.kanban.save,type:"form",autowidth:!0,click:function(){var e=i.getValues({hidden:!1}),t=i.getKanban();t.callEvent("onBeforeEditorAction",["save",i,e])&&(i._fixStatus(e,t),t.exists(e.id)?(e.$list=t.getItem(e.id).$list,t.updateItem(e.id,e)):t.add(e),i._close())}}]},{height:1}]},this.$ready.push(this._afterInit)},_afterInit:function(){this._form=this.queryView({view:"form"}),this._removeBtn=this.queryView({localId:"$kanban_remove"}),this._header=this.queryView({localId:"$kanban_header"});var e=this.queryView({view:"kanbanuploader"});if(e){var t=this.queryView({localId:"$kanban_dataview_uploader"});e.define("link",t.config.id),e.addDropZone(t.$view),webix.extend(t,webix.OverlayBox)}var i=this.queryView({$hide:!0},"all");i.length&&this.attachEvent("onShow",(function(){for(var e=0;e<i.length;e++)i[e].getList().count()?i[e].show():i[e].hide()}))},_fixStatus:function(e,t){e.$list=Number(e.$list)||0,t._sublists[e.$list]&&t.setListStatus(e,t._sublists[e.$list])},getForm:function(){return this._form},getKanban:function(){return webix.$$(this.config.master)},setValues:function(t){"object"===e(t)&&t||(t={});var i=this.getKanban(),n=i._assignList(t);t.$list=t.$list||(-1!==n?n:0),this._prepareEditor(i,t.id),this._form.setValues(t)},getValues:function(e){return this._form.getValues(e)},_prepareEditor:function(e,t){t&&e.exists(t)?(this._removeBtn.show(),this._header.define("label",webix.i18n.kanban.editor.edit)):(this._removeBtn.hide(),this._header.define("label",webix.i18n.kanban.editor.add)),this._header.refresh()},_close:function(){this.hide(),this._form.clear(),this._prepareEditor()}},webix.ui.window),webix.protoUI({name:"kanbanuserlist",defaults:{width:300,layout:"y",scroll:!0,yCount:4,autoheight:!1,select:!0,template:function(e){return e.image?"<img class='webix_kanban_list_avatar' src='"+e.image+"'>"+e.value:"<span class='webix_icon webix_kanban_icon kbi-account webix_kanban_list_avatar'></span>"+e.value}},$init:function(){this.$ready.push((function(){var e=this;this.attachEvent("onShow",(function(){var t=e.getContext().user_id;t&&e.exists(t)?(e.select(t),e.showItem(t)):e.unselectAll()})),this.attachEvent("onMenuItemClick",(function(t){var i=e.getKanban(),n=e.getContext().id;i.updateItem(n,{user_id:t})})),this.type.master=this.config.masterId}))},getKanban:function(){return webix.$$(this.config.masterId)}},webix.ui.contextmenu),webix.protoUI({name:"kanbanmenu",$init:function(){this.$ready.push((function(){this.attachEvent("onItemClick",(function(e){var t=this.getContext().id,i=this.getKanban();if(i.callEvent("onBeforeCardAction",[e,t]))switch(e){case"edit":i.showEditor(webix.copy(i.getItem(t)));break;case"copy":i.copy(t);break;case"remove":i._removeCard(t)}}))}))},getKanban:function(){return webix.$$(this.config.masterId)}},webix.ui.contextmenu),webix.protoUI({name:"kanbanchat",$init:function(e){e.padding=0,this.$ready.push((function(){var e=this;this.attachEvent("onHide",this._hide_chat),this.queryView({view:"list"}).data.attachEvent("onStoreUpdated",(function(t,i,n){n&&"paint"!==n&&e._save()}))}))},_save:function(){var e=this.getContext(),t=this.getBody(),i=this.getKanban();e&&i.exists(e.id)&&i.updateItem(e.id,{comments:t.serialize()})},_hide_chat:function(){var e=this.getBody();e.queryView({view:"form"}).clear(),e.queryView({view:"list"}).clearAll()},getKanban:function(){return webix.$$(this.config.masterId)}},webix.ui.context),webix.protoUI({name:"kanban",defaults:{delimiter:","},$skin:function(){this.defaults.type="space"},$init:function(e){var t=this;this.$view.className+=" webix_kanban",this.data.provideApi(this,!0),this.data.scheme({$change:function(e){"string"==typeof e.tags&&(e.tags=t._strToArr(e.tags))}}),this._destroy_with_me=[],this._statuses=new webix.DataCollection,this._destroy_with_me.push(this._statuses),this._tags=this._data_unification(e.tags),this._users=this._data_unification(e.users),this._colors=this._data_unification(e.colors),this.$ready.push((function(){var e=this;this.reconstruct(),this._initEditor(),this._initUserList(),this._initMenu(),this._initComments(),this.data.attachEvent("onStoreUpdated",(function(t,i,n){return e._applyOrder(t,i,n)})),this.data.attachEvent("onIdChange",(function(t,i){e.getOwnerList(t).data.changeId(t,i)})),this.attachEvent("onDestruct",(function(){for(var t=0;t<e._destroy_with_me.length;t++)e._destroy_with_me[t].destructor()}))})),this.serialize=this._serialize},_strToArr:function(e){return e?e.split(this.config.delimiter):[]},getTags:function(){return this._tags},getUsers:function(){return this._users},getColors:function(){return this._colors},getStatuses:function(){return this._statuses.serialize()},cardActions_setter:function(e){if(!0===e&&(e=["edit","copy","remove"]),webix.isArray(e))return e.map((function(e){return{id:e,value:webix.i18n.kanban.menu[e]||e}}))},showEditor:function(e){var t=this.getEditor();this.callEvent("onBeforeEditorShow",[t,e])&&t&&(t.setValues(e),t.show(),this.callEvent("onAfterEditorShow",[t,e]))},copy:function(e){if(this.callEvent("onBeforeCopy",[e])){var t=webix.copy(this.getItem(e));delete t.id,t.text=webix.i18n.kanban.copy+" "+(t.text||"");var i=this.add(t),n=this.getOwnerList(i);n.move(i,n.getIndexById(e)+1,n),this.callEvent("onAfterCopy",[e])}},_removeCard:function(e){var t=this,i=webix.promise.defer();return webix.i18n.kanban.confirm?webix.confirm({text:webix.i18n.kanban.confirm,callback:function(n){n&&(t.remove(e),i.resolve())}}):(this.remove(e),i.resolve()),i},_data_unification:function(e){if(e&&e.getItem)return e;var t=new webix.DataCollection;return this._destroy_with_me.push(t),e&&"string"==typeof e?t.load(e):t.parse(e||[]),t},getEditor:function(){return webix.$$(this._editor)},getUserList:function(){return webix.$$(this._userList)},getMenu:function(){return webix.$$(this._menu)},getComments:function(){return webix.$$(this._comments)},_initEditor:function(){var e=this;if(this.config.editor){var t=webix.ui({view:"kanbaneditor",master:this.config.id});this._editor=t.config.id,this._destroy_with_me.push(t),this.attachEvent("onListIconClick",(function(t,i){"editor"===t&&e.showEditor(webix.copy(e.getItem(i)))})),this.attachEvent("onListItemDblClick",(function(t){return e.showEditor(webix.copy(e.getItem(t)))}))}},_initUserList:function(){var t=this;if(this.config.userList){var i="object"===e(this.config.userList)?this.config.userList:{};webix.extend(i,{view:"kanbanuserlist",masterId:this.config.id,data:this._users},!0),i=webix.ui(i),this._userList=i.config.id,this._destroy_with_me.push(i),this.attachEvent("onAvatarClick",(function(e,i,n){var r=t.getUserList();r.setContext({id:e,user_id:t.getItem(e).user_id}),r.show(n)}))}},_initMenu:function(){var e=this;if(this.config.cardActions){var t=webix.ui({view:"kanbanmenu",data:this.config.cardActions,masterId:this.config.id});this._menu=t.config.id,this._destroy_with_me.push(t),this.attachEvent("onListIconClick",(function(t,i,n,r){if("menu"===t){var o=e.getMenu();o.setContext({id:i}),o.show(r)}}))}},_initComments:function(){var t=this;if(this.config.comments){var i="object"===e(this.config.comments)?this.config.comments:{};i=webix.extend({width:400,height:400},i,!0),webix.extend(i,{view:"comments",users:this._users},!0);var n=webix.ui({view:"kanbanchat",body:i,masterId:this.config.id});this._comments=n.config.id,this._destroy_with_me.push(n),this.attachEvent("onListIconClick",(function(e,i,n,r){if("comments"===e&&t.callEvent("onBeforeCommentsShow",[i,n,r])){var o=t.getComments(),a=webix.html.offset(r);a.y+=a.height,o.hide();var s=o.getBody(),l=t.getItem(i).comments||[];s.parse(webix.copy(l)),o.setContext({id:i}),o.show(a)}}))}},_serialize:function(){var e=[];return this.eachList((function(t){e=e.concat(t.serialize())})),e},_applyOrder:function(e,t,i){if(!e)return this._syncData();switch(i){case"add":0<=this._assignList(t)&&(this.getOwnerList(e).add(t),t.$index=this._sublists[t.$list].count());break;case"delete":var n=this._sublists[t.$list];n&&n.exists(e)&&n.remove(e);break;case"paint":case"update":if(-1===this.getIndexById(e))break;var r=t.$list,o=this._assignList(t);r===o?0<=o&&this.getOwnerList(e).updateItem(e,t):(this._sublists[r]&&this._sublists[r].remove(e),0<=o&&this.getOwnerList(e).add(t))}},setListStatus:function(e,t){for(var i=0;i<this._sublists.length;i++)if(this._sublists[i]===t)return void a(e,t)},reconstruct:function(){this._prepareLists(),this._syncData()},_prepareLists:function(){this._sublists=[],this._subfilters=[];for(var e=[],t=this.queryView((function(e){return e.$kanban}),"all"),i=0;i<t.length;i++){var n=t[i];"kanbanheader"!==n.config.view?this._sublists.push(n):n.config.master=this.config.id}for(var r=0;r<this._sublists.length;r++){var o=this._sublists[r];this._subfilters[r]=s(o),this.config.icons&&(o.type.icons=o.type.icons||this.config.icons);var a=o.config.name||("string"==typeof o.config.status&&o.config.status?o.config.status[0].toUpperCase()+o.config.status.slice(1):o.config.id);e.push({id:r.toString(),value:a}),o.config.master=this.config.id,o.type.master=this.config.id}this._statuses.clearAll(),this._statuses.parse(e)},_syncData:function(){for(var e=[],t=0;t<this._sublists.length;t++)e[t]=[];this.data.each((function(t){var i=this._assignList(t);0<=i&&e[i].push(t)}),this);for(var i=0;i<this._sublists.length;i++){var n=e[i];1<n.length&&n[0].$index&&n.sort((function(e,t){return e.$index>t.$index?1:-1})),this._sublists[i].clearAll(),this._sublists[i].data.importData(n),this._sublists[i]._fixOrder()}},_assignList:function(e){for(var t=0;t<this._sublists.length;t++)if(this._subfilters[t](e))return e.$list=t;return-1},getSelectedId:function(){var e=null;return this.eachList((function(t){e=t.getSelectedId()||e})),e},select:function(e){this.getOwnerList(e).select(e)},getOwnerList:function(e){var t=this.getItem(e);return t?this._sublists[t.$list]:null},eachList:function(e){for(var t=0;t<this._sublists.length;t++)e.call(this,this._sublists[t],this._sublists[t].config.status)}},webix.DataLoader,webix.EventSystem,webix.ui.headerlayout)}()},9391:function(e,t,i){!function(e){"use strict";class t{}class n{constructor(e,t){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={},t&&t.params&&e.extend(this._data,t.params)}getRoot(){return this._root}destructor(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null}setParam(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)}getParam(e,t){const i=this._data[e];if(void 0!==i||!t)return i;const n=this.getParentView();return n?n.getParam(e,t):void 0}getUrl(){return this._segment.suburl()}getUrlString(){return this._segment.toString()}getParentView(){return this._parent}$$(e){if("string"==typeof e){const t=this.getRoot();return t.queryView((i=>(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope),"self")}return e}on(e,t,i){const n=e.attachEvent(t,i);return this._events.push({obj:e,id:n}),n}contains(e){for(const t in this._subs){const i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1}getSubView(e){const t=this.getSubViewInfo(e);if(t)return t.subview.view}getSubViewInfo(e){const t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null}_detachEvents(){const e=this._events;for(let t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)}_destroySubs(){for(const e in this._subs){const t=this._subs[e].view;t&&t.destructor()}this._subs={}}_init_url_data(){const e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)}_getDefaultSub(){if(this._subs.default)return this._subs.default;for(const e in this._subs){const t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){const e=t.view._getDefaultSub();if(e)return e}}}_routed_view(){const e=this.getParentView();if(!e)return!0;const t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()}}function r(e){"/"===e[0]&&(e=e.substr(1));const t=e.split("/"),i=[];for(let e=0;e<t.length;e++){const n=t[e],r={};let o=n.indexOf(":");if(-1===o&&(o=n.indexOf("?")),-1!==o){const e=n.substr(o+1).split(/[\:\?\&]/g);for(const t of e){const e=t.split("=");r[e[0]]=decodeURIComponent(e[1])}}i[e]={page:o>-1?n.substr(0,o):n,params:r,isNew:!0}}return i}function o(e){const t=[];for(const i of e){t.push("/"+i.page);const e=a(i.params);e&&t.push("?"+e)}return t.join("")}function a(e){const t=[];for(const i in e)"object"!=typeof e[i]&&(t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i])));return t.join("")}class s{constructor(e,t){this._next=1,this.route="string"==typeof e?{url:r(e),path:e}:e,this.index=t}current(){return this.route.url[this.index]}next(){return this.route.url[this.index+this._next]}suburl(){return this.route.url.slice(this.index)}shift(e){const t=new s(this.route,this.index+this._next);return t.setParams(t.route.url,e,t.index),t}setParams(e,t,i){if(t){const r=e[i].params;for(var n in t)r[n]=t[n]}}refresh(){const e=this.route.url;for(let t=this.index+1;t<e.length;t++)e[t].isNew=!0}toString(){const e=o(this.suburl());return e?e.substr(1):""}_join(e,t){let i=this.route.url;if(null===e)return i;const n=this.route.url;let o=!0;if(i=n.slice(0,this.index+(t?this._next:0)),e){i=i.concat(r(e));for(let e=0;e<i.length;e++)n[e]&&(i[e].view=n[e].view),o&&n[e]&&i[e].page===n[e].page?i[e].isNew=!1:i[e].isNew&&(o=!1)}return i}append(e){const t=this._join(e,!0);return this.route.path=o(t),this.route.url=t,this.route.path}show(e,i,n){const r=this._join(e.url,n);return this.setParams(r,e.params,this.index+(n?this._next:0)),new Promise(((e,n)=>{const a=o(r),s={url:r,redirect:a,confirm:Promise.resolve()},l=i?i.app:null;!l||l.callEvent("app:guard",[s.redirect,i,s])?s.confirm.catch((e=>n(e))).then((()=>{if(null!==s.redirect){if(s.redirect!==a)return l.show(s.redirect),void n(new t);this.route.path=a,this.route.url=r,e()}else n(new t)})):n(new t)}))}size(e){this._next=e}split(){const e={url:this.route.url.slice(this.index+1),path:""};return e.url.length&&(e.path=o(e.url)),new s(e,0)}update(e,t,i){const n=this.route.url[this.index+(i||0)];if(!n)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?n.page=t:n.params[e]=t,this.route.path=o(this.route.url)}}class l extends n{constructor(e,t){super(e.webix),this.app=e,this._children=[]}ui(e,t){const i=(t=t||{}).container||e.container,r=this.app.createView(e);return this._children.push(r),r.render(i,this._segment,this),"object"!=typeof e||e instanceof n?r:r.getRoot()}show(e,t){if(t=t||{},"object"==typeof e){for(const t in e)this.setParam(t,e[t]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e,t);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){const i=this.getParentView();return i?i.show(e.substr(3),t):this.app.show("/"+e.substr(3))}const i=this.getSubViewInfo(t.target);if(i){if(i.parent!==this)return i.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,i.subview,{url:e,params:t.params})}else if(e)return this.app.show("/"+e,t)}return this._show(this._segment,{url:e,params:t.params},this)}_show(e,t,i){return e.show(t,i,!0).then((()=>(this._init_url_data(),this._urlChange()))).then((()=>{e.route.linkRouter&&(this.app.getRouter().set(e.route.path,{silent:!0}),this.app.callEvent("app:route",[e.route.path]))}))}init(e,t){}ready(e,t){}config(){this.app.webix.message("View:Config is not implemented")}urlChange(e,t){}destroy(){}destructor(){this.destroy(),this._destroyKids(),this._root&&(this._root.destructor(),super.destructor())}use(e,t){e(this.app,this,t)}refresh(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)}render(e,t,i){"string"==typeof t&&(t=new s(t,0)),this._segment=t,this._parent=i,this._init_url_data();const n="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==n?(this._container=n,this._render(t)):this._urlChange().then((()=>this.getRoot()))}_render(e){const t=this.config();return t.then?t.then((t=>this._render_final(t,e))):this._render_final(t,e)}_render_final(e,t){let i,n=null,r=null,o=!1;if(this._container.tagName?r=this._container:(n=this._container,n.popup?(r=document.body,o=!0):r=this.webix.$$(n.id)),!this.app||!r)return Promise.reject(null);const a=this._segment.current(),s={ui:{}};this.app.copyConfig(e,s.ui,this._subs),this.app.callEvent("app:render",[this,t,s]),s.ui.$scope=this,!n&&a.isNew&&a.view&&a.view.destructor();try{if(n&&!o){const e=r,t=e.getParentView();t&&"multiview"===t.name&&!s.ui.id&&(s.ui.id=e.config.id)}this._root=this.app.webix.ui(s.ui,r);const e=this._root;o&&e.setPosition&&!e.isVisible()&&e.show(),n&&(n.view&&n.view!==this&&n.view!==this.app&&n.view.destructor(),n.id=this._root.config.id,this.getParentView()||!this.app.app?n.view=this:n.view=this.app),a.isNew&&(a.view=this,a.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((()=>this._urlChange().then((()=>(this._initUrl=null,this.ready(this._root,t.suburl()))))))}catch(e){i=Promise.reject(e)}return i.catch((e=>this._initError(this,e)))}_init(e,t){return this.init(e,t.suburl())}_urlChange(){this.app.callEvent("app:urlchange",[this,this._segment]);const e=[];for(const t in this._subs){const i=this._subs[t],n=this._renderFrameLock(t,i,null);n&&e.push(n)}return Promise.all(e).then((()=>this.urlChange(this._root,this._segment.suburl())))}_renderFrameLock(e,t,i){if(!t.lock){const n=this._renderFrame(e,t,i);n&&(t.lock=n.then((()=>t.lock=null),(()=>t.lock=null)))}return t.lock}_renderFrame(e,t,i){if("default"===e){if(this._segment.next()){let e=i?i.params:null;return t.params&&(e=this.webix.extend(e||{},t.params)),this._createSubView(t,this._segment.shift(e))}t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i.url,t.params&&(i.params=this.webix.extend(i.params||{},t.params))),t.route){if(null!==i)return t.route.show(i,t.view).then((()=>this._createSubView(t,t.route)));if(t.branch)return}let n=t.view;if(!n&&t.url){if("string"==typeof t.url)return t.route=new s(t.url,0),i&&t.route.setParams(t.route.route.url,i.params,0),t.params&&t.route.setParams(t.route.route.url,t.params,0),this._createSubView(t,t.route);"function"!=typeof t.url||n instanceof t.url||(n=new(this.app._override(t.url))(this.app,"")),n||(n=t.url)}if(n)return n.render(t,t.route||this._segment,this)}_initError(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0}_createSubView(e,t){return this.app.createFromURL(t.current()).then((i=>i.render(e,t,this)))}_destroyKids(){const e=this._children;for(let t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]}}class c extends l{constructor(e,t){super(e,t),this._ui=t.ui}config(){return this._ui}}class u{constructor(e,t,i){this.path="",this.app=i}set(e,t){this.path=e;const i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})}get(){return this.path}}let h=!0;class p extends n{constructor(e){const t=(e||{}).webix||window.webix;e=t.extend({name:"App",version:"1.0",start:"/home"},e,!0),super(t,e),this.config=e,this.app=this.config.app,this.ready=Promise.resolve(),this._services={},this.webix.extend(this,this.webix.EventSystem)}getUrl(){return this._subSegment.suburl()}getUrlString(){return this._subSegment.toString()}getService(e){let t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t}setService(e,t){this._services[e]=t}destructor(){this.getSubView().destructor(),super.destructor()}copyConfig(e,t,i){if((e instanceof n||"function"==typeof e&&e.prototype instanceof n)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);const r=e instanceof Array;t=t||(r?[]:{});for(const o in e){let a=e[o];if("function"==typeof a&&a.prototype instanceof n&&(a={$subview:a}),!a||"object"!=typeof a||a instanceof this.webix.DataCollection||a instanceof RegExp||a instanceof Map)t[o]=a;else if(a instanceof Date)t[o]=new Date(a);else{const e=this.copyConfig(a,a instanceof Array?[]:{},i);null!==e&&(r?t.push(e):t[o]=e)}}return t}getRouter(){return this.$router}clickHandler(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){const i=t.getAttribute("trigger");if(i)return this._forView(t,(e=>e.app.trigger(i))),e.cancelBubble=!0,e.preventDefault();const n=t.getAttribute("route");if(n)return this._forView(t,(e=>e.show(n))),e.cancelBubble=!0,e.preventDefault()}const i=t.parentNode;i&&this.clickHandler(e,i)}getRoot(){return this.getSubView().getRoot()}refresh(){return this._subSegment?this.getSubView().refresh().then((e=>(this.callEvent("app:route",[this.getUrl()]),e))):Promise.resolve(null)}loadView(e){const t=this.config.views;let i=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{t&&(i="function"==typeof t?t(e):t[e],"string"==typeof i&&(e=i,i=null)),i||("_hidden"===e?i={hidden:!0}:"_blank"===e?i={}:(e=e.replace(/\./g,"/"),i=this.require("jet-views",e)))}catch(t){i=this._loadError(e,t)}return i.then||(i=Promise.resolve(i)),i=i.then((e=>e.__esModule?e.default:e)).catch((t=>this._loadError(e,t))),i}_forView(e,t){const i=this.webix.$$(e);i&&t(i.$scope)}_loadViewDynamic(e){return null}createFromURL(e){let t;return t=e.isNew||!e.view?this.loadView(e.page).then((t=>this.createView(t,name,e.params))):Promise.resolve(e.view),t}_override(e){const t=this.config.override;if(t){let i;for(;e;)i=e,e=t.get(e);return i}return e}createView(e,t,i){let r;if("function"==typeof(e=this._override(e))){if(e.prototype instanceof p)return new e({app:this,name:t,params:i,router:u});if(e.prototype instanceof n)return new e(this,{name:t,params:i});e=e(this)}return r=e instanceof n?e:new c(this,{name:t,ui:e}),r}show(e,t){return e&&this.app&&0==e.indexOf("//")?this.app.show(e.substr(1),t):this.render(this._container,e||this.config.start,t)}trigger(e,...t){this.apply(e,t)}apply(e,t){this.callEvent(e,t)}action(e){return this.webix.bind((function(...t){this.apply(e,t)}),this)}on(e,t){this.attachEvent(e,t)}use(e,t){e(this,null,t)}error(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){let e=t[i].message;0===e.indexOf("Module build failed")?(e=e.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML=`<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${e}</pre>`):(e+="<br><br>Check console for more details",this.webix.message({type:"error",text:e,expire:-1}))}}render(e,t,i){this._container="string"==typeof e?this.webix.toNode(e):e||document.body;let n=null;this.$router?n="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(h&&"tagName"in this._container&&(this.webix.event(document.body,"click",(e=>this.clickHandler(e))),h=!1),"string"==typeof t&&(t=new s(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);const r=i?i.params:this.config.params||null,o=this.getSubView(),a=this._subSegment,l=a.show({url:n,params:r},o).then((()=>this.createFromURL(a.current()))).then((t=>t.render(e,a))).then((e=>(this.$router.set(a.route.path,{silent:!0}),this.callEvent("app:route",[this.getUrl()]),e)));return this.ready=this.ready.then((()=>l)),l}getSubView(){if(this._subSegment){const e=this._subSegment.current().view;if(e)return e}return new l(this,{})}require(e,t){return null}_first_start(e){if(this._segment=e,this.$router=new this.config.router((e=>setTimeout((()=>{this.show(e).catch((e=>{if(!(e instanceof t))throw e}))}),1)),this.config,this),this._container===document.body&&!1!==this.config.animation){const e=this._container;this.webix.html.addCss(e,"webixappstart"),setTimeout((()=>{this.webix.html.removeCss(e,"webixappstart"),this.webix.html.addCss(e,"webixapp")}),10)}if(e){if(this.app){const t=e.current().view;e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new s(this.config.start,0),e.current().view=t}}else{let t=this.$router.get();t||(t=this.config.start,this.$router.set(t,{silent:!0})),e=new s(t,0)}return e}_loadError(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}}addSubView(e,t,i){const n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[r]={id:t.id,url:n,branch:e.branch,popup:e.popup,params:e.params}).popup?null:t}}class d{constructor(e,t){this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=()=>this.cb(this.get())}set(e,t){if(this.config.routes){const t=e.split("?",2);for(const i in this.config.routes)if(this.config.routes[i]===t[0]){e=i+(t.length>1?"?"+t[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((()=>this.cb(e)),1)}get(){let e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){const t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e}_detectPrefix(){const e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]}_getRaw(){return document.location.href}}let _=!1;function f(e){if(_||!e)return;_=!0;const t=window;t.Promise||(t.Promise=e.promise);const i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){const i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});const n=e.ui.baselayout.prototype.addView,r=e.ui.baselayout.prototype.removeView,o={addView(e,t){if(this.$scope&&this.$scope.webixJet&&!e.queryView){const i=this.$scope,r={};e=i.app.copyConfig(e,{},r),n.apply(this,[e,t]);for(const e in r)i._renderFrame(e,r[e],null).then((()=>{i._subs[e]=r[e]}));return e.id}return n.apply(this,arguments)},removeView(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){const t=this.$scope._subs;for(const i in t){const n=t[i];e.$$(n.id)||(n.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,o,!0),e.extend(e.ui.baselayout.prototype,o,!0),e.protoUI({name:"jetapp",$init(t){this.$app=new this.app(t);const i=e.uid().toString();t.body={id:i},this.$ready.push((function(){this.callEvent("onInit",[this.$app]),this.$app.render({id:i})}))}},e.ui.proxy,e.EventSystem)}class b extends p{constructor(e){e.router=e.router||d,super(e),f(this.webix)}require(e,t){return i(24327)(e+"/"+t)}}class g{constructor(e,t){this.path="",this.cb=e}set(e,t){this.path=e,t&&t.silent||setTimeout((()=>this.cb(e)),1)}get(){return this.path}}function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function A(e,t,i){for(var n in e)w(e,n)&&t.call(i||e,e[n],n,e)}function x(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var v=String.prototype.replace,m=String.prototype.split,y=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},C={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:y,chinese:function(){return 0},croatian:y,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:y,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},k={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function S(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var B=/\$/g,$=/%\{(.*?)\}/g;function D(e,t,i,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,o=n||$,a="number"==typeof t?{smart_count:t}:t;if(null!=a.smart_count&&r){var s=m.call(r,"||||");r=(s[function(e,t){return C[function(e){var t,i=(t={},A(k,(function(e,i){A(e,(function(e){t[e]=i}))})),t);return i[e]||i[m.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",a.smart_count)]||s[0]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return v.call(r,o,(function(e,t){return w(a,t)&&null!=a[t]?v.call(a[t],B,"$$"):e}))}function E(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?D:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||x,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if("||||"===t||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(S(t)+"(.*?)"+S(i),"g")}(t.interpolation)}E.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},E.prototype.extend=function(e,t){A(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.extend(e,n):this.phrases[n]=e}),this)},E.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:A(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.unset(e,n):delete this.phrases[n]}),this)},E.prototype.clear=function(){this.phrases={}},E.prototype.replace=function(e){this.clear(),this.extend(e)},E.prototype.t=function(e,t){var i,n,r=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof r._?i=r._:this.onMissingKey?n=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),n=e),"string"==typeof i&&(n=D(i,r,this.currentLocale,this.tokenRegex)),n},E.prototype.has=function(e){return w(this.phrases,e)},E.transformPhrase=function(e,t,i){return D(e,t,i)};var T=E;let L=window.webix;L&&f(L);const I=function(e,t,i){const n=(i=i||{}).storage;let r=n?n.get("lang")||"en":i.lang||"en";function o(t,o,a){o.__esModule&&(o=o.default);const l={phrases:o};i.polyglot&&e.webix.extend(l,i.polyglot);const c=s.polyglot=new T(l);if(c.locale(t),s._=e.webix.bind(c.t,c),r=t,n&&n.put("lang",r),i.webix){const n=i.webix[t];n&&e.webix.i18n.setLocale(n)}return a?Promise.resolve():e.refresh()}function a(t,n){if(!1===i.path)return;const r=(i.path?i.path+"/":"")+t;o(t,e.require("jet-locales",r),n)}const s={getLang:function(){return r},setLang:a,setLangData:o,_:null,polyglot:null};e.setService("locale",s),a(r,!0)},q=window;q.Promise||(q.Promise=q.webix.promise);let P=!1;function R(e,t,i){const n=t.$width,r=t.$height;e.config._fillApp?e.define({width:n,height:r}):e.define({left:(n-e.$width)/2,top:(r-e.$height)/2}),i||e.resize()}function M(e,t){const i=t.getRoot();e.attachEvent("onHide",(()=>{i.$destructed||(webix.html.removeCss(i.$view,"webix_win_inside"),i.enable())}));const n=t.attachEvent("view:resize",(()=>{R(e,i)}));e.attachEvent("onDestruct",(()=>{t.detachEvent(n)}))}var F=1;function U(e,t,i){Object.defineProperty(t,i,{get:()=>e[i],set:t=>e[i]=t})}function O(e,t){t=t||{};const i={},n={},r=function(e,t){const r=F++;return i[r]={mask:e,handler:t},t("*"===e?n:n[e],void 0,e),r},o=[];let a=!1;const s=function(e,t,n,r){if(a)return void o.push([e,t,n,r]);const s=Object.keys(i);for(let o=0;o<s.length;o++){const a=i[s[o]];a&&("*"!==a.mask&&a.mask!==e||a.handler(n,t,e,r))}};return Object.defineProperty(n,"$changes",{value:{attachEvent:r,detachEvent:function(e){delete i[e]}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$observe",{value:r,enumerable:!1,configurable:!1}),Object.defineProperty(n,"$batch",{value:function(e){if("function"!=typeof e){const t=e;e=()=>{for(const e in t)n[e]=t[e]}}for(a=!0,e(n),a=!1;o.length;){const e=o.shift();s.apply(this,e)}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$extend",{value:function(e,i){i=i||t;for(const t in e)if(e.hasOwnProperty(t)){const r=e[t];i.nested&&"object"==typeof r&&r?n[t]=O(r,i):V(n,r,t,s)}},enumerable:!1,configurable:!1}),n.$extend(e,t),n}function V(e,t,i,n){Object.defineProperty(e,i,{get:function(){return t},set:function(e){if(null===t||null===e?t!==e:t.valueOf()!=e.valueOf()){var r=t;t=e,n(i,r,e,null)}},enumerable:!0,configurable:!1})}webix.protoUI({name:"pivot-portlet",$reorderOnly:!0,$drag:function(e){webix.html.addCss(this.$view,"portlet_in_drag");const t=webix.DragControl.getContext();t.source=t.from=e,webix.callEvent("onClick",[]);const i=this.$scope.app.getService("local"),n=this.getChildViews()[0].getValues();let r="";"complex"==n.operation?r=i.fixMath(n.math):(r=n.name?i.getField(n.name).value:"",n.name2?r+=(r?", ":"")+i.getField(n.name2).value:r?n.operation&&(r+=` (${n.operation})`):r=(0,this.$scope.app.getService("locale")._)("Field not defined"));const o=webix.skin.$active;return`<div class="webix_pivot_portlet_drag" style="width:${this.$width-o.inputHeight}px;height:${this.$height}px;">\n\t\t\t\t<span class="webix_icon ${this.config.icon}"></span>${r}\n\t\t\t</div>`}},webix.ui.portlet);class H extends l{constructor(e,t,i){super(e,t),i||(i={}),this.plusLabel=i.plusLabel,this.field=i.field}config(){const e=webix.skin.$active;return{borderless:!0,type:"clean",paddingY:8,rows:[{localId:"forms",type:"clean",rows:[]},{template:`<div class="webix_pivot_handle_add_value">\n\t\t\t\t\t\t<span class="webix_icon wxi-plus-circle"></span><span>${this.plusLabel}</span>\n\t\t\t\t\t</div>`,css:"webix_pivot_add_value",height:e.inputHeight-2*e.inputPadding,localId:"addValue",onClick:{webix_pivot_handle_add_value:()=>{const e=this.$$("forms").getChildViews();this.Add(null,e.length);const t=e[e.length-1].queryView({name:"name"});t&&(t.focus(),webix.html.triggerEvent(t.getInputNode(),"MouseEvent","click")),"values"!=this.field&&e.length==this.app.getState().fields.length&&this.$$("addValue").hide()}}}]}}init(){this.on(webix,"onAfterPortletMove",(e=>{e==this.$$("forms")&&this.app.callEvent("property:change",[this.field,this.GetValue()])})),this.on(webix,"onPortletDrag",(function(e,t){if(e.$reorderOnly)return e.getParentView()===t.getParentView()}))}ListTemplate(e){const t=this._activeInput,i="values"==this.field&&t&&!t.$destructed&&"wavg"==t.getFormView().elements.operation.getValue(),n=this.getParentView().GetCorrections()[this.field],r=e.value;if(!i&&n){let t="webix_pivot_list_marker";return this.CheckCorrections(n,e.id)&&(t+=" webix_pivot_list_marker_fill"),`<div class="${t}"> ${r}</div>`}return r}CheckCorrections(e,t){if(this._activeInput&&t==this._activeInput.getValue())return!0;const i=this.app.getStructure();for(let n=0;n<e.length;n++){const r=i[e[n]];if(r)if("string"==typeof r){if(r==t)return!0}else for(let e=0;e<r.length;e++){let i=r[e];if(i.name&&(i=i.name),i==t)return!0}}return!1}GetValue(){const e=this.$$("forms").getChildViews();let t=[];return e.forEach((e=>{const i=e.getChildViews()[0].getValues().name;i&&t.push(i)})),t}SetValue(e){const t=this.$$("forms"),i=t.getChildViews();for(let e=i.length-1;e>=0;e--)t.removeView(i[e]);for(let t=0;t<e.length;t++)e[t].external||this.Add(e[t],t)}Add(e,t){this.$$("forms").addView({view:"pivot-portlet",mode:"replace",borderless:!0,body:{view:"form",paddingY:0,paddingX:2,elements:[{margin:2,cols:this.ItemConfig(e,t)}],on:{onChange:(e,t,i)=>{"user"==i&&this.app.callEvent("property:change",[this.field,this.GetValue()])}}}})}ItemConfig(e){return[{width:webix.skin.$active.inputHeight},{view:"richselect",name:"name",value:this.PrepareValue(e),hidden:e&&"complex"==e.operation,options:{css:"webix_pivot_suggest",data:this.app.getState().fields,on:{onBeforeShow:function(){const e=webix.$$(this.config.master),t=e.$scope,i=t.GetValue();t._activeInput=e,this.getList().filter((n=>t.FilterSuggest(i,e.getValue(),n)))}},body:{template:e=>this.ListTemplate(e)}}},{view:"icon",icon:"wxi-close",css:"webix_pivot_close_icon",pivotPropertyRemove:!0,click:function(){const e=this.$scope;e.$$("addValue").show(),e.$$("forms").removeView(this.queryView("pivot-portlet","parent")),e.app.callEvent("property:change",[e.field,e.GetValue()])}}]}PrepareValue(e){return e?("object"==typeof e&&(e=e.name),webix.isArray(e)&&(e=e[0])):e="",e}FilterSuggest(e,t,i){return(i=i.id)==t||!e.find((e=>(e.name&&(e=e.name),i==e)))}}function z(e){const t=e.charCodeAt(0);return t<=122?t>=48&&t<=57||t>=65:t>191}function j(e,t){if(t){for(let t=0;t<e.length;t++)if(!z(e[t]))return t;return e.length}for(let t=e.length-1;t>=0;t--)if(!z(e[t]))return t+1;return 0}function N(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())}webix.protoUI({name:"suggest-math",$enterKey(){const e=this.getList();this.isVisible()&&!e.getSelectedId()&&e.count()&&(e.select(e.data.order[1]),this._addFirst=1),webix.ui.suggest.prototype.$enterKey.apply(this,arguments),webix.delay((()=>{delete this._addFirst}))},defaults:{filter(e,t){const i=webix.$$(this.config.master),n=i.getInputNode().selectionStart,r=t.substring(0,n),o=r.substring(j(r)),a=t.charAt(n);if(!o||n!==t.length&&z(a)||(t=o),e.disabled){const n=i.$scope.app;if("$fields"==e.id)return!!n.getState().fields.find((e=>N(e.value,t)));if("$methods"==e.id){const e=n.getService("locale")._;return!!n.getService("local").operations.find((i=>N(e(i.id),t)))}}return N(e.value,t)}}},webix.ui.suggest),webix.protoUI({name:"math-editor",$init(){this.$view.className+=" webix_el_text"},$onBlur(){const e=webix.$$(this.config.suggest).$view.contains(document.activeElement);webix.delay((()=>{const t=webix.UIManager.getFocus();t&&t.config.pivotPropertyRemove||e||this.callEvent("onChange",[this.getValue(),null,"user"])}))},setValue(){const e=webix.$$(this.config.suggest);e.isVisible()||e._addFirst||webix.ui.text.prototype.setValue.apply(this,arguments)},$setValueHere(e){this.setValueHere(e)},setValueHere(e){const t=this.getValue(),i=this.getInputNode().selectionStart;let n=t.substring(0,i),r=t.substring(i);const o=j(r,!0);n+=r.substring(0,o),r=r.substring(o),"("==n[n.length-1]&&(n=n.substring(0,n.length-1)),n=n.substring(0,j(n))+e,this.$scope.app.getService("local").operations.find((t=>t.value==e))&&(n+="("==r[0]?"":"("),this.$setValue(n+r),this.getInputNode().setSelectionRange(n.length,n.length)}},webix.ui.text);class W extends H{constructor(e,t,i){super(e,t,i),this.Local=this.app.getService("local"),this._=this.app.getService("locale")._,this.typeName="operation",this.plusLabel=this._("Add value"),this.field="values",this.operations=this.Local.operations,this.operations.map((e=>(e.value=this._(e.id),e)))}init(){super.init(),this.State=this.app.getState(),this.on(this.State.$changes,"mode",(()=>{this.ToggleColors()}))}GetValue(){const e=this.$$("forms").getChildViews(),t=[];return e.forEach((e=>{const i=e.getChildViews()[0].getValues({hidden:!1});webix.isUndefined(i.name2)||(i.name&&i.name2?(i.name=[i.name,i.name2],delete i.name2):i.name=""),""!=i.name&&""!=i.math&&(i.math&&(i.math=this.OutComplexMath(i.math)),t.push(i))})),t}ItemConfig(e,t){const i=super.ItemConfig(e);let n;if(e)n=e.operation;else{const e=this.app.config.defaultOperation,t=Math.max(this.operations.findIndex((t=>t.id==e)),0);n=this.operations[t].id}i.splice(2,0,{view:"richselect",name:"operation",width:110,value:n,options:{css:"webix_pivot_suggest",data:this.operations.filter((e=>e.fields<=2||"complex"==e.id))},on:{onChange:function(e){this.$scope.SetOperation(e,this)}}}),i.splice(2,0,{view:"richselect",hidden:2!=this.Local.getOperation(n).fields,value:e&&webix.isArray(e.name)?e.name[1]:"",name:"name2",options:{css:"webix_pivot_suggest",data:this.app.getState().fields}}),i.splice(1,0,{view:"math-editor",name:"math",hidden:!e||"complex"!=e.operation,value:e&&e.math?this.Local.fixMath(e.math):"",suggest:{view:"suggest-math",data:this.SuggestData()}});const r="mini"==webix.skin.$name||"compact"==webix.skin.$name,o=this.Local.getPalette(),a=e&&e.color||this.Local.getValueColor(t);return i.splice(1,0,{view:"colorpicker",hidden:"chart"!=this.State.mode,name:"color",css:"webix_pivot_value_color",value:a,width:r?30:38,suggest:{type:"colorboard",body:{width:150,height:150,view:"colorboard",palette:o}}}),i}ToggleColors(){const e=this.State.mode,t=this.$$("forms").getChildViews();for(let i=0;i<t.length;i++){const n=t[i].getChildViews()[0].elements.color;"chart"==e?n.show():n.hide()}}FilterSuggest(){return!0}SetOperation(e,t){const i=t.getFormView().elements;"complex"==e?(i.name.hide(),i.name2.hide(),i.math.show(),i.name.setValue(),i.name2.setValue()):2==this.Local.getOperation(e).fields?(i.name.show(),i.name2.show(),i.math.hide()):(i.name.show(),i.name2.hide(),i.math.hide())}SuggestData(){return[{value:this._("Fields"),id:"$fields",disabled:!0,$css:"webix_pivot_values_section"},...this.app.getState().fields,{value:this._("Methods"),id:"$methods",disabled:!0,$css:"webix_pivot_values_section"},...this.operations.filter((e=>"complex"!=e.id))]}OutComplexMath(e){const t=this.app.getState().fields,i=new RegExp("(\\(|\\s|,|^)("+t.map((e=>e.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))).join("|")+")(\\)|\\s|,|$)","g"),n=Array.from(e.matchAll(i));for(let i=n.length-1;i>=0;i--){const r=n[i];e=e.substring(0,r.index+r[1].length)+t.find((e=>e.value==r[2])).id+e.substring(r.index+r[0].length-r[3].length,e.length)}const r=this.operations,o=new RegExp("(\\(|,|\\+|-|\\/|\\*|\\s|^)("+r.map((e=>e.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))).join("|")+")\\(","g"),a=Array.from(e.matchAll(o));for(let t=a.length-1;t>=0;t--){const i=a[t];e=e.substring(0,i.index+i[1].length)+this.operations.find((e=>e.value==i[2])).id+e.substring(i.index+i[0].length-1,e.length)}return e}}class Y extends H{constructor(e,t){super(e,t),this.field="groupBy"}config(){return{padding:10,rows:[{view:"richselect",localId:"group",options:{css:"webix_pivot_suggest",data:this.app.getState().fields,body:{template:e=>this.ListTemplate(e)},on:{onBeforeShow:()=>{this._activeInput=this.$$("group")}}},on:{onChange:(e,t,i)=>{"user"==i&&this.app.callEvent("property:change",[this.field,e])}}}]}}init(){this.State=this.getParam("state",!0)}GetValue(){return this.$$("group").getValue()}SetValue(e){this.$$("group").setValue(e)}}class G extends l{config(){const e=this.app.getService("locale")._;return{view:"form",complexData:!0,padding:10,elementsConfig:{labelWidth:120},elements:[{name:"type",view:"richselect",value:"bar",options:{css:"webix_pivot_suggest",data:[{id:"bar",value:e("Bar")},{id:"line",value:e("Line")},{id:"radar",value:e("Radar")},{id:"area",value:e("Area")},{id:"spline",value:e("Spline")},{id:"splineArea",value:e("Spline Area")},{id:"pie",value:e("Pie")},{id:"donut",value:e("Donut")}]}},{name:"xAxis.title",view:"text",label:e("X axis title"),batch:"axis"},{name:"yAxis.title",view:"text",label:e("Y axis title"),batch:"axis"},{name:"scaleColor",batch:"scale",view:"colorpicker",editable:!0,label:e("Scale color"),suggest:{type:"colorboard",body:{width:150,height:150,view:"colorboard",palette:this.app.getService("local").getPalette()}}},{name:"3D",view:"checkbox",batch:"pie",labelWidth:0,labelRight:e("3D")},{name:"pieInnerText",view:"checkbox",batch:"pie",labelWidth:0,labelRight:e("Show values inside")},{name:"stacked",view:"checkbox",batch:"stacked",labelWidth:0,labelRight:e("Stacked")},{name:"horizontal",view:"checkbox",batch:"bar",labelWidth:0,labelRight:e("Horizontal")},{name:"scale",batch:"scale",view:"checkbox",checkValue:"logarithmic",uncheckValue:"linear",labelWidth:0,labelRight:e("Logarithmic scale")},{name:"yAxis.lineShape",view:"checkbox",batch:"radar",checkValue:"arc",labelWidth:0,labelRight:e("Circled lines")},{name:"lines",batch:"scale",view:"checkbox",labelWidth:0,labelRight:e("Lines")}],on:{onChange:(e,t,i)=>{if("user"==i){const e=this.OutValues(this.getRoot().getValues());this.innerChange=!0,this.State.chart=Object.assign({},e),this.HandleVisibility(),delete this.innerChange}}}}}init(){this.State=this.getParam("state",!0),this.on(this.State.$changes,"chart",(e=>{this.innerChange||(this.getRoot().setValues(this.InValues(e)),this.HandleVisibility())}))}HandleVisibility(){const e=this.getRoot(),t=e.getValues().type;if("pie"==t||"donut"==t)e.showBatch("pie");else if(e.showBatch("scale"),"radar"==t)e.showBatch("radar",!0);else{e.showBatch("axis",!0);const i="bar"==t;(i||"area"==t)&&(i&&e.showBatch("bar",!0),e.showBatch("stacked",!0))}}InValues(e){const t=(e=webix.copy(e)).type.toLowerCase(),i="stackedarea"==t;return(-1!=t.indexOf("bar")||i)&&(-1!=t.indexOf("stacked")&&(e.stacked=1),-1!=t.indexOf("h")&&(e.horizontal=1),e.type=i?"area":"bar"),e}OutValues(e){const t="bar"==e.type;return(t||"area"==e.type)&&(t&&e.horizontal&&(e.type+="H",delete e.horizontal),e.stacked&&(e.type="stacked"+e.type[0].toUpperCase()+e.type.slice(1),delete e.stacked)),e}}class K extends l{config(){const e=this.app.getService("locale")._;return{view:"form",padding:10,elements:[{name:"cleanRows",localId:"cleanRows",view:"checkbox",labelWidth:0,labelRight:e("Clean rows")},{view:"label",height:20,label:e("Highlight")},{cols:[{name:"minX",view:"checkbox",labelWidth:0,labelRight:e("Min X")},{name:"maxX",view:"checkbox",labelWidth:0,labelRight:e("Max X")},{name:"minY",view:"checkbox",labelWidth:0,labelRight:e("Min Y")},{name:"maxY",view:"checkbox",labelWidth:0,labelRight:e("Max Y")}]},{view:"label",height:20,label:e("Footer")},{view:"radio",name:"footer",options:[{id:1,value:e("Off")},{id:2,value:e("On")},{id:3,value:e("Sum Only")}],value:1},{view:"label",height:20,label:e("Total Column")},{view:"radio",name:"totalColumn",options:[{id:1,value:e("Off")},{id:2,value:e("On")},{id:3,value:e("Sum Only")}],value:1}],on:{onChange:(e,t,i)=>{if("user"==i){const e=this.OutValues(this.getRoot().getValues());this.innerChange=!0,this.State.datatable=Object.assign({},e),delete this.innerChange}}}}}init(){this.State=this.getParam("state",!0),this.on(this.State.$changes,"datatable",(e=>{this.innerChange||this.getRoot().setValues(this.InValues(e))})),this.on(this.State.$changes,"mode",(e=>{"table"==e?this.$$("cleanRows").show():this.$$("cleanRows").hide()}))}InValues(e){return(e=webix.copy(e)).footer?e.footer="sumOnly"==e.footer?3:2:e.footer=1,e.totalColumn?e.totalColumn="sumOnly"==e.totalColumn?3:2:e.totalColumn=1,e}OutValues(e){switch(e.footer){case"1":delete e.footer;break;case"2":e.footer=!0;break;case"3":e.footer="sumOnly"}switch(e.totalColumn){case"1":delete e.totalColumn;break;case"2":e.totalColumn=!0;break;case"3":e.totalColumn="sumOnly"}return e}}class Q extends l{config(){return this.Local=this.app.getService("local"),{view:"popup",css:"webix_pivot_filter_popup",template:e=>e.label,body:{view:"filter",field:"value",on:{onChange:e=>{if("user"==e){const e=this.app.getState(),t=webix.copy(e.structure);let i;t.filters=t.filters.filter((e=>{const t=e.name==this.field,n=t&&!e.external;return n&&(i=e.value=this.filter.getValue()),!t||n})),e.structure=t,this.app.callEvent("filter:change",[this.field,i])}}}}}}Show(e,t){const i=this.getRoot(),n=this.filter=i.getBody();this.field=t.name;const r=n.getChildViews()[2],o=this.Local.getField(this.field);this.Local.collectFieldValues(this.field).then((a=>{r.clearAll(),r.parse(webix.copy(a)),n.define({mode:o.type}),n.config.value="",n.setValue(webix.copy(t.value||{})),i.show(e)}))}}class X extends l{config(){const e=this.app.getService("locale")._;this.Compact=this.getParam("compact");const t=webix.skin.$active,i="mini"==webix.skin.$name||"compact"==webix.skin.$name,n={height:t.toolbarHeight,cols:[{view:"segmented",localId:"modes",align:"middle",inputHeight:t.inputHeight-t.inputPadding*(i?0:2),optionWidth:80,width:244,options:[{id:"table",value:e("Table")},{id:"tree",value:e("Tree")},{id:"chart",value:e("Chart")}],on:{onChange:(e,t,i)=>{"user"==i&&this.SetMode(e)}}},{width:t.dataPadding}]};return this.Compact&&(n.css="webix_pivot_footer",n.cols[1].width=0,n.cols.unshift({})),n}init(){this.State=this.getParam("state"),this.on(this.State.$changes,"mode",(e=>{this.$$("modes").setValue(e)}))}SetMode(e){this.State.mode=e}}class J extends l{config(){const e=this.app.getService("locale")._;let t;if(this.Compact=this.getParam("compact"),this.State=this.getParam("state"),this.Compact)t={view:"icon",icon:"pt-settings",inputHeight:webix.skin.$active.buttonHeight,on:{onItemClick:()=>this.ToggleConfig()}};else{const i=e("Configure Pivot"),n="webix_template webix_pivot_measure_size";t={view:"template",borderless:!0,width:28+webix.html.getTextSize(i,n).width,template:()=>`\n\t\t\t\t\t\t<span>${i}</span>\n\t\t\t\t\t\t<span class="pt-settings webix_pivot_toolbar_icon"></span>`,onClick:{webix_pivot_settings:()=>this.ToggleConfig()}}}t.localId="config",t.css="webix_pivot_settings",t.tooltip=e("Click to configure");const i=webix.env.$customScroll?0:this._GetScrollWidth(),n=webix.skin.$active.toolbarHeight+i;let r="webix_pivot_toolbar";i&&(webix.html.addStyle(`.webix_pivot_bar_with_scroll .webix_pivot_settings>.webix_template{ line-height: ${n}px; }`),r+=" webix_pivot_bar_with_scroll");const o={css:r,margin:this.Compact?12:0,padding:{left:this.Compact?webix.skin.$active.inputPadding:0},height:n,cols:[t,this.GetFilters()]};return this.Compact||o.cols.push(X),o}init(){this.filterPopup=this.ui(Q),this.on(this.State.$changes,"fields",(e=>{if(e.length){const e=this.$$("filters").getParentView();webix.ui(this.GetFilters(),e)}})),this.on(this.State.$changes,"structure",((e,t)=>{if(t&&this.FiltersChanged(e,t)){const e=this.$$("filters").getParentView();webix.ui(this.GetFilters(),e)}})),this.on(this.State.$changes,"readonly",(e=>{this.ToggleReadonly(e)}))}FiltersChanged(e,t){if(e.filters.length!=t.filters.length)return!0;for(let i=0;i<e.filters.length;i++){const n=e.filters[i],r=t.filters[i];if(n.name!=r.name||n.external!=r.external)return!0;if(JSON.stringify(n.value)!=JSON.stringify(r.value))return!0}return!1}ToggleConfig(){this.State.config=!this.State.config}ToggleReadonly(e){e?this.$$("config").hide():this.$$("config").show()}GetFilters(){const e=this.State.structure,t=[];this.State.fields.length&&e.filters.forEach((e=>{e.external||t.push(this.FilterConfig(e))}));const i=webix.skin.$active,n=(i.toolbarHeight-i.buttonHeight)/2;return{view:"scrollview",borderless:!0,scroll:"x",body:{margin:8,padding:{left:this.Compact?0:8,top:n+i.inputPadding,bottom:n+i.inputPadding},localId:"filters",cols:t}}}FilterConfig(e){const t=this.app.getService("local").getField(e.name).value;return{view:"template",borderless:!0,width:(this.Compact?0:28)+webix.html.getTextSize(t,"webix_template webix_pivot_measure_size").width,css:"webix_pivot_filter",template:()=>{const i=e.value,n=i&&(i.includes||i.condition.filter)?"webix_pivot_active_filter":"",r=this.Compact?"":"<span class='pt-filter webix_pivot_toolbar_icon'></span>";return`<div class="webix_pivot_filter_inner ${n}">\n\t\t\t\t\t<span>${t}</span>\n\t\t\t\t\t${r}\n\t\t\t\t</div>`},onClick:{webix_pivot_filter:function(){this.$scope.filterPopup.Show(this.$view,e)}}}}_GetScrollWidth(){const e=webix.html.create("DIV",{style:"visibility:hidden;overflow:scroll;"}),t=webix.html.create("DIV");document.body.appendChild(e),e.appendChild(t);const i=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),i}}const Z={JetView:l};Z.chart=class extends l{config(){const e=this.State=this.getParam("state",!0),t={view:"chart",$mainView:!0,borderless:!0,localId:"data",xAxis:{},yAxis:{}};webix.extend(t,webix.copy(e.chart),!0);const i=t.type;"barH"==i||"stackedBarH"==i?t.yAxis.template||(t.yAxis.template=e=>e[e.length-1]):t.xAxis.template||(t.xAxis.template=e=>e[e.length-1]);const n={lines:t.lines};return t.scaleColor&&(n.color=n.lineColor=t.scaleColor),webix.extend(t.xAxis,n,!0),webix.extend(t.yAxis,n,!0),this.IsPieBased()&&webix.extend(t,{multilevel:!0,tooltip:this.ValueFormat,color:"#color#",type:i+(t["3D"]?"3D":""),pieInnerText:t.pieInnerText?this.ValueFormat:""},!0),t}init(){this.Local=this.app.getService("local"),this.LoadData(),this.on(this.State.$changes,"structure",((e,t)=>{t&&this.LoadData()})),this.on(this.State.$changes,"chart",((e,t)=>{t&&this.refresh()}))}LoadData(){return this.Local.getData().then((e=>{this.UpdateChart(e)}))}UpdateChart(e){this.$$("data").clearAll(),this.IsPieBased()||(this.$$("data").removeAllSeries(),this.SetSeries(e.values)),this.SetLegend(e.values),this.$$("data").parse(e.data)}IsPieBased(e){return e||(e=this.State.chart.type),"pie"==e||"donut"==e}SetSeries(e){for(let t=0;t<e.length;t++)this.$$("data").addSeries(this.GetSeriesConfig(e[t],t))}GetSeriesConfig(e,t,i){return{type:i=i||this.State.chart.type,value:e=>e[t],alpha:"area"==i||"splineArea"==i?.7:1,color:e.color,tooltip:e=>this.ValueFormat({value:e[t]}),item:{color:e.color,borderColor:e.color},line:{color:e.color}}}SetLegend(e){const t=this.app.getService("locale")._;e=e.map((e=>{const i=e.operation;let n=e.text;return"complex"==i?n=this.Local.fixMath(n):i&&(n=n.split(",").map((e=>this.Local.getField(e).value)).join(", "),n=`${n} (${t(i)})`),{color:e.color,text:n}}));const i=webix.extend({values:e,valign:"middle",align:"right",layout:"y"},this.State.chart.legend||{},!0);this.$$("data").define({legend:i})}ValueFormat(e){return e.text||parseFloat(e.value||0).toFixed(3)}},Z.config=class extends l{config(){const e=this.app.getService("locale")._;return this.State=this.app.getState(),this.Compact=this.getParam("compact",!0),{margin:0,rows:[{type:"form",borderless:!0,padding:{left:16,right:14,top:8,bottom:4},cols:[{},{view:"button",label:e("Done"),hotkey:"esc",autowidth:!0,css:"webix_primary",click:()=>this.ToggleForm()}]},{borderless:!0,view:"scrollview",scroll:"y",body:{view:"accordion",css:"webix_pivot_configuration",localId:"settings",multi:!0,type:"space",padding:{left:16,right:16,top:4,bottom:16},margin:20,rows:[this.GroupConfig(e("Rows"),"pt-rows",{name:"rows",$subview:new H(this.app,"",{field:"rows",plusLabel:e("Add row")})},"table"),this.GroupConfig(e("Columns"),"pt-columns",{name:"columns",$subview:new H(this.app,"",{field:"columns",plusLabel:e("Add column")})},"table"),this.GroupConfig(e("Values"),"pt-values",{name:"values",$subview:W}),this.GroupConfig(e("Group By"),"pt-group",{name:"groupBy",$subview:Y},"chart"),this.GroupConfig(e("Filters"),"pt-filter",{name:"filters",$subview:new H(this.app,"",{field:"filters",plusLabel:e("Add filter")})}),this.GroupConfig(e("Chart"),"pt-chart",{$subview:G},"chart"),this.GroupConfig(e("Table"),"wxi-columns",{$subview:K},"table"),{}]}}]}}init(){this.on(this.State.$changes,"readonly",((e,t)=>{webix.isUndefined(t)||this.ToggleForm()}))}ready(){this.on(this.app,"property:change",((e,t)=>{this.HandleFieldChange(e,t)})),this.on(this.State.$changes,"structure",(()=>{this.innerChange||this.SetValues()})),this.on(this.State.$changes,"mode",((e,t)=>{const i="chart"==e;this.$$("settings").showBatch(i?"chart":"table"),t&&(i||"chart"==t)&&this.SetValues()}))}ToggleForm(){this.State.config=!this.State.config}SetValues(){const e=this.State.structure;["rows","columns","values","filters","groupBy"].forEach((t=>{const i=e[t]||this.State[t];this.getSubView(t).SetValue(i)}))}HandleFieldChange(e,t){const i=webix.copy(this.State.structure);"filters"==e?t=this.CorrectFilters(i,t):this.CorrectInputs(i,e,t),i[e]=t,this.innerChange=!0,this.app.setStructure(i),delete this.innerChange}GroupConfig(e,t,i,n){return{batch:n,header:`\n\t\t\t\t<span class="webix_icon webix_pivot_config_icon ${t}"></span>\n\t\t\t\t<span class="webix_pivot_config_label">${e}</span>\n\t\t\t`,body:i,borderless:!0}}GetCorrections(){return{rows:["columns","values","groupBy"],columns:["rows","values"],values:["rows","columns","groupBy"],groupBy:["rows","values"]}}CorrectFilters(e,t){for(let i=0;i<t.length;i++){const n=e.filters.find((e=>{if(e.name==t[i])return!0}));t[i]={name:t[i]},n&&!n.external&&(t[i].value=n.value)}const i=e.filters.filter((e=>e.external));return t=t.concat(i)}CorrectInputs(e,t,i){const n=this.GetCorrections()[t];n&&("string"==typeof i&&(i=[i]),i=i.map((e=>e.name?e.name:e)),n.forEach((t=>{const n=this.getSubView(t);let r=n.GetValue();"string"==typeof r?i.find((e=>e==r))&&(r=""):r=r.filter((e=>(e.name&&(e=e.name),-1==i.indexOf(e)))),e[t]=r,n.SetValue(r)})))}},Z["config/popup"]=class extends l{config(){return this.app.getService("jet-win").updateConfig({view:"window",borderless:!0,fullscreen:!0,head:!1,body:{$subview:!0}})}},Z["config/properties/chart"]=G,Z["config/properties/group"]=Y,Z["config/properties"]=H,Z["config/properties/table"]=K,Z["config/properties/values"]=W,Z.filter=Q,Z.main=class extends l{config(){P||(P=!0,webix.protoUI({name:"r-layout",sizeTrigger(e,t,i){this._compactValue=i,this._compactHandler=t,this._app=e;const n=e.config;this._forceCompact=void 0!==n.params.forceCompact,this._compactWidth=n.compactWidth,this._forceCompact||this._checkTrigger(this.$view.width,i)},_checkTrigger(e,t){return!this._compactWidth||!(e<=this._compactWidth&&!t||e>this._compactWidth&&t)||(this._compactWidth=null,this._compactHandler(!t),!1)},$setSize(e,t){(this._forceCompact||this._checkTrigger(e,this._compactValue))&&webix.ui.layout.prototype.$setSize.call(this,e,t),this._app&&this._app.callEvent("view:resize",[])}},webix.ui.layout));const e=this.getParam("forceCompact");webix.isUndefined(e)||this.setParam("compact",e),this.Compact=this.getParam("compact");const t=[J,{view:"r-layout",localId:"main",cols:[{$subview:!0}]}];return this.Compact?t.push(X,{$subview:!0,name:"edit",popup:!0}):t[1].cols.push({view:"proxy",maxWidth:450,localId:"edit",css:"webix_pivot_config_container webix_shadow_medium",borderless:!0,hidden:!0,body:{$subview:!0,name:"edit"}}),{margin:0,rows:t,view:webix.isUndefined(e)?"r-layout":"layout"}}init(){const e=this.getParam("state");this.$$("main").sizeTrigger(this.app,(e=>this.SetCompactMode(e)),!!this.Compact),this.on(e.$changes,"mode",(e=>{this.show("./"+("chart"==e?"chart":"table"))})),this.on(e.$changes,"config",(e=>{e?this.ShowConfig():this.HideConfig()}))}ShowConfig(){this.Compact?this.show("config.popup/config",{target:"edit"}):(this.$$("edit").show(),this.show("config",{target:"edit"}))}HideConfig(){this.show("_blank",{target:"edit"}),this.Compact||this.$$("edit").hide()}SetCompactMode(e){webix.delay((()=>{this.setParam("compact",e),e||webix.fullscreen.exit(),this.refresh()}))}},Z.mode=X,Z.table=class extends l{config(){this.Local=this.app.getService("local");const e=this.State=this.getParam("state",!0),t=e.structure.rows.length,i={view:"treetable",$mainView:!0,localId:"data",css:"webix_data_border webix_header_border",select:!0,leftSplit:"table"==e.mode?t:t?1:0,resizeColumn:!0,borderless:!0,columns:[],footer:e.datatable.footer};return webix.extend(i,e.datatable,!0),i}init(){this.LoadData(),this.on(this.State.$changes,"structure",((e,t)=>{t&&this.LoadData()})),this.on(this.State.$changes,"datatable",((e,t)=>{t&&this.refresh()})),this.on(this.State.$changes,"mode",((e,t)=>{t&&"chart"!=t&&"chart"!=e&&this.refresh()}))}LoadData(){return this.Local.getData().then((e=>{this.UpdateTable(e)}))}UpdateTable(e){const t=this.State,i=t.structure,n=this.CheckFreeze();let r=0;const o=t.datatable.totalColumn;let a;if(o){const e=i.values;a="sumOnly"==o?e.filter((e=>"sum"==e.operation)):e,n&&(r=a.length)}let s=0;if(n){const e=i.rows.length;s="table"==t.mode?e:e?1:0}if(!e.$ready){const t=e.totalColumn;let i;if(t){i=e.header[e.header.length-1].id;for(let t=0;t<a.length;t++){let n=a[t].name;webix.isArray(n)&&(n=n.join()),e.header.push({header:[{name:"total",colspan:r},{text:n||a[t].operation,operation:a[t].operation}],id:i+t+1})}}const n={i:0};e=this.Local._store={data:e.data.map((e=>this._prepareData(e,t,n,i))),columns:this.SetColumns(e.header,e.footer,e.marks),$ready:1}}const l=this.$$("data");l.clearAll(),l.define({leftSplit:s,rightSplit:r},!0),l.refreshColumns(e.columns),l.parse(e.data)}_prepareData(e,t,i,n){const r="table"==this.State.mode;let o;(r||t&&!e.data)&&(o=i.i++);const a=new Proxy(e,{get:(e,i)=>{if("data"==i)return e.vals;if(r&&"id"==i)return o+1;const a=1*i;if(!isNaN(a)){const i="object"==typeof e.values?e.values:e;return t&&a>n&&(o||0===o)?t[o][a-n-1]:i[a-1]}return e[i]}});return e.data&&(a.open=!0,a.vals=e.data.map((e=>this._prepareData(e,t,i,n)))),a}CheckFreeze(){const e=this.app.config.freezeColumns,t=this.getParam("compact",!0);return webix.isUndefined(e)?!t:e}SetColumns(e,t,i){e=webix.copy(e);const n=this.app.getService("locale")._,r=this.State.structure.rows.length,o="table"==this.State.mode?r:r?1:0;for(let r=0;r<e.length;r++)if(r<o)this.SetFirstColumn(e[r],!r&&this.State.datatable.footer,n);else{e[r].sort="int",e[r].format||(e[r].format=this.CellFormat),i.length&&(e[r].cssFormat=(e,t,n,r)=>{const o=i[n-1],a=o?o[r-1]:null;return a?a.join(" "):""});const o=e[r].header;for(let e=0;e<o.length;e++){let t=o[e];t&&(e||"total"!=t.name?e==o.length-1&&(t.text=this.HeaderTemplate(t,n)):t.text=n("Total"))}t.length&&(e[r].footer=this.CellFormat(t[r]))}return e}SetFirstColumn(e,t,i){"tree"==this.State.mode?(e.header={text:this.State.structure.rows.map((e=>this.Local.getField(e).value)).join("<span class='webix_icon wxi-angle-right'></span>"),css:"webix_pivot_tree_header"},e.width=300,e.template=(e,t)=>t.treetable(e,t)+e[1]):(e.header=this.Local.getField(e.header[0].text).value,e.width=200),t&&(e.footer=i("Total"))}HeaderTemplate(e,t){if(e.operation&&"complex"!=e.operation){let i=e.text.split(",");return i=i.map((e=>this.Local.getField(e).value)).join(", "),`${i} <span class="webix_pivot_operation">${t(e.operation)}</span>`}return this.Local.fixMath(e.text)}CellFormat(e){return e||(e=0===e?"0":""),e?parseFloat(e).toFixed(3):e}},Z.toolbar=J;const ee=(e,t)=>e.key>t.key?1:-1,te=(e,t)=>e.key<t.key?1:-1;class ie{constructor(e,t,i,n,r){"desc"===r?this._sort=te:"asc"===r?this._sort=ee:r&&(this._sort=(e,t)=>r(e.key,t.key)),this._label=i,this._meta=n||null,this._table=e,this._getter=t,this._prepared=0}getIndexes(){return this._indexes}getValue(e){return this._values[e].key}getSize(){return this._values.length}getLabel(){return this._label}getOptions(){return this._prepareOptions(),this._values.map((e=>e.key))}getMeta(){return this._meta}reset(){this._prepared=0}prepare(){if(1&this._prepared)return;this._prepared=1|this._prepared,this._prepareOptions();const{_table:e,_getter:t,_keys:i}=this,n=e.count();this._values.forEach(((e,t)=>e.index=t));const r=this._indexes=new Array(n);for(let e=0;e<n;e++){const n=t(e);r[e]=i.get(n).index}}_prepareOptions(){if(2&this._prepared)return;this._prepared=2|this._prepared;const{_table:e,_getter:t}=this,i=e.count(),n=this._keys=new Map,r=this._values=[];for(let e=0;e<i;e++){const i=t(e);void 0===n.get(i)&&n.set(i,r[r.length]={key:i,index:0})}this._sort&&r.sort(this._sort)}}class ne{constructor(e){this._pivot=e}toArray({cleanRows:e,filters:t,ops:i}){const n=[],r=this._pivot.getLimit().rows||0;this._pivot.filter(t),this._pivot.operations(i),this._pivot.resetCursor();let o=0;const a=new Set,s=new Map,l=[];for(;;){const e={},t=this._pivot.next(a,n.length,s,e);if(!t)break;if(n.push(t),l.push(e),o++,r===o)break}const[c,u]=this._pivot.getWidth();e&&this._cleanRows(n,c);const h={data:n,columns:Array.from(a).sort(((e,t)=>e>t?1:-1)),width:u+c,scaleWidth:c,rowData:l};return h.columnData=this._pivot.aggregateColumns(h,s),h.marks=this._pivot.mark(h,s),h}toNested({filters:e,ops:t}){this._pivot.filter(e),this._pivot.operations(t),this._pivot.resetCursor();const i=new Map,n=this._pivot.nested(i);return n.columnData=this._pivot.aggregateColumns(n,i),n.marks=this._pivot.mark(n,i),n}toXHeader(e,t){return this._pivot.getXHeader(e,t)}_cleanRows(e,t){const i=e.length,n=new Array(t);for(let r=0;r<i;r++){const i=e[r];for(let e=0;e<t;e++){if(n[e]!==i[e]){for(let r=e;r<t;r++)n[r]=i[r];break}i[e]=""}}}}function re(e,t){return new Function(t.propertyName,t.methodName,t.contextName,"return "+function(e,t){let i="";const n=e.length;let r=0,o=!1,a=!1,s=0;for(;r<n;){const n=e[r];if(r++,'"'===n)o?i+=e.substr(s,r-s):s=r-1,o=!o;else{if(o)continue;const l=","===n||"/"===n||"*"===n||"+"===n||"-"===n||"("===n||")"===n,c=" "===n||"\t"===n||" \n"===n||"\r"===n;if(a){if(!l&&!c)continue;{const o=e.substr(s,r-s-1);i+="("===n?t.method(o):t.property(o),a=!1}}if(c)continue;l||"0"===n||"1"===n||"2"===n||"3"===n||"4"===n||"5"===n||"6"===n||"7"===n||"8"===n||"9"===n?i+=n:(a=!0,s=r-1)}}return a&&(i+=t.property(e.substr(s,r-s))),i}(e,t))}function oe(e,t,i,n){const r=ue(e,i),o={table:e,order:t,from:0,to:0,array:(e,t)=>{const i=t.to-t.from,n=new Array(i),r=ce[e];for(let e=0;e<i;e++)n[e]=r(t.order[e+t.from]);return n}};return function(e,t){return o.from=e,o.to=t,r(0,n,o)}}function ae(e,t,i,n){const r=ue(e,i),o={table:e,order:t,range:[],array:(e,t)=>{const i=o.range.length,n=[],r=ce[e];for(let e=0;e<i;e+=2){const i=o.range[e],a=o.range[e+1];for(let e=i;e<a;e++)n.push(r(t.order[e]))}return n}};return function(e){return o.range=e,r(0,n,o)}}function se(e,t){const i=re(e,{propertyName:"d",methodName:"m",contextName:"c",property:()=>"d",method:e=>"m."+e.toLowerCase()});return function(e){return i(e,t,null)}}let le=0;const ce=[];function ue(e,t){return re(t,{propertyName:"d",methodName:"m",contextName:"c",property:t=>{const i=le;return ce[i]=e.getColumn(t).getter,le+=1,`c.array("${i}", c)`},method:e=>"m."+e.toLowerCase()})}const he=(e,t)=>i=>e(i)&&t(i);function pe(e,t,i,n){const r=n.getter(e,t);if("object"!=typeof i){const e=n.compare.eq(i);return t=>e(r(t))}{const e=Object.keys(i);let t=null;for(let o=0;o<e.length;o++){const a=n.compare[e[o].toLowerCase()](i[e[o]]),s=e=>a(r(e));t=t?he(t,s):s}return t}}class de{constructor(e,t,i,n,r){this._rows=t,this._cols=i,this._dims=t.concat(i),this._table=e,this._context=r,this._cursor=-1,this._order=this._base_order=this._sort(),this._data=this._dims.map((e=>e.getIndexes())),this.filter(n,!0)}resetCursor(){this._cursor=0,this._group=this._dims.map((()=>null)),this._order.length&&(this._rows.length&&this._nextRow(),this._cols.length&&this._nextColumn())}next(e,t,i,n){const{_cursor:r,_cols:o,_order:a,_group:s,_ops:l,_rows:c}=this;if(this._cursor>=a.length)return null;const u=c.length,h=new Array(u+l.length*o.length);for(let e=0;e<u;e++)h[e]=c[e].getValue(s[e]);const p=this._rows.length?this._nextRow(o.length>0):a.length;return this._fillRow(h,t,r,p,u,e,i,n),this._cursor=p,h}nested(e){const{_cols:t,_order:i,_rows:n}=this,r=new Set,o=n.length,a=o>0?1:0,s=[{data:[],values:[]}],l=[];let c=[],u=[],h=this._cursor,p=0;const{_groupOps:d}=this,_=[{}].concat(n.map((()=>({})))),f=[],b=this._context.limit.rows,g=Math.min(this._context.limit.columns,(t.length?this._sizes[0]*t[0].getSize():0)+a),w=function(t){if(s[t])for(;t<o;t++)for(const[i,n]of e){const e=_[t][i]||0;if(0===e||n.length>e)for(let r=0;r<d.length;r++){const o=d[r];o&&(s[t].values[a+i+r]=o(n.slice(e+1)),_[t][i]=n.length-1)}}};for(;this._cursor<i.length;){const _=new Array(g);c=u,u=[].concat(this._group);const A=this._rows.length?this._nextRow(t.length>0):i.length;if(null!==d)for(let e=0;e<o;e++)if(u[e]!=c[e]){w(e+1);break}const x={};if(this._fillRow(_,l.length,h,A,a,r,e,x),f.push(x),o>0){for(let e=0;e<o;e++)if(u[e]!=c[e]){for(let t=e;t<o;t++){const e=t+1,i=e===o,r=s[e]={id:i?l.length+1:0,data:i?null:[],values:i?_:[n[t].getValue(u[t])]};s[t].data.push(r)}break}_[0]=n[o-1].getValue(u[o-1]),s[o].values=_}else s[0].data.push({data:null,values:_});if(l.push(_),p++,p>=b)break;this._cursor=h=A}null!==d&&w(1);const A=Array.from(r).sort(((e,t)=>e>t?1:-1)),x={tree:s[0].data,data:l,width:g,scaleWidth:a,columns:A,rowData:f};return this._fillGroupRow(s[0],x,e,n.length-1),x}getLimit(){return this._context.limit}getWidth(){return[this._rows.length,this._cols.length&&this._ops.length?this._cols[0].getSize()*this._sizes[0]:0,this._ops.length]}getXHeader(e,t){const{_cols:i,_rows:n,_ops:r,_opInfo:o}=this,{nonEmpty:a,meta:s}=t||{},l=e.tree,c=[],u=e.tree?Math.min(n.length,1):n.length,h=r.length,p=i.map((e=>e.getSize())),d=p.reduce(((e,t)=>e*t),h),_=e.columns,f=u+Math.min(a?_.length*h:d,this._context.limit.columns);let b=d;const g=p.map((e=>b/=e)),w=[];if(this._cols.forEach((()=>w.push(new Array(f)))),a){for(let e=0;e<u;e++)c.push(e);for(let e=0;e<_.length;e++){const t=u+_[e];for(let e=0;e<h;e++)c.push(t+e)}for(let e=0;e<i.length;e++){const t=g[e];let n,r=-1,o=0,a=0;for(let s=u;s<c.length;s+=h){const l=c[s];if(l<o)a+=h;else{0!==a&&(w[e][r]={colspan:a,text:n});const c=Math.floor((l-u)/t);r=s,o=(c+1)*t+u,a=h,n=i[e].getValue(c%p[e])}}0!==a&&(w[e][r]={colspan:a,text:n})}}else for(let e=0;e<i.length;e++){const t=p[e],n=g[e];let r=0;for(let o=u;o<f;o+=n)w[e][o]=1===n?i[e].getValue(r++):{text:i[e].getValue(r++),colspan:n},r>=t&&(r=0)}if(this._ops){const e=new Array(f),t=r.length;for(let i=u;i<f;i+=t)for(let n=0;n<t;n++)e[i+n]=o[n].label;w.push(e)}for(let e=0;e<u;e++){const t=i.length+(this._ops?1:0);if(l){w[0][0]={text:"",rowspan:t};break}const r=n[e].getLabel();w[0][e]=t>1?{text:r,rowspan:t}:r}const A={data:w};if(a&&(A.nonEmpty=c),s){const e=new Array(f);for(let t=0;t<u;t++)e[t]=n[t].getMeta();const t=r.length;for(let i=u;i<f;i+=t)for(let n=0;n<t;n++)e[i+n]=o[n].meta;A.meta=e}return A}filter(e,t){if(!e||0===Object.keys(e).length){if(t||!this._masterRules)return void(this._order=this._base_order);e=Object.assign(Object.assign({},this._masterRules),e)}t&&(this._masterRules=e),this._order=function(e,t,i,n){const r=function(e,t,i){const n=Object.keys(t);let r=null;for(let o=0;o<n.length;o++){const a=n[o],s=pe(e,a,t[a],i);r=r?he(r,s):s}return r}(t,i,n);return e.filter((e=>r(e)))}(this._base_order,this._table,e,this._context)}operations(e){const{_table:t,_order:i,_context:n}=this;e=e||[],this._ops=e.map((e=>oe(t,i,"string"==typeof e?e:e.math,n.math))),this._groupResultOps=e.map((e=>"result"===e.branchMode?se("string"==typeof e?e:e.branchMath||e.math,n.math):null)),this._groupResultOps.find((e=>null!==e))||(this._groupResultOps=null),this._groupOps=e.map((e=>"raw"===e.branchMode?ae(t,i,"string"==typeof e?e:e.branchMath||e.math,n.math):null)),this._groupOps.find((e=>null!==e))||(this._groupOps=null),this._opInfo=e.map((e=>"string"==typeof e?{label:e,math:e}:Object.assign(Object.assign({},e),{label:e.label||e.math}))),this._rowResultOps=_e(e,"row","result",((e,t)=>({name:t,op:se(e,n.math)}))),this._rowOps=_e(e,"row","raw",((e,r)=>({name:r,op:oe(t,i,e,n.math)}))),this._colResultOps=_e(e,"column","result",((e,t)=>({name:t,op:se(e,n.math)}))),this._colOps=_e(e,"column","raw",((e,r)=>({name:r,op:ae(t,i,e,n.math)}))),this._marks=e.map((e=>e.marks||null)),this._marks.find((e=>null!==e))||(this._marks=null),this._setSizes()}aggregateColumns(e,t){const{_colOps:i,_colResultOps:n}=this,{columns:r,data:o,scaleWidth:a}=e;if(!i&&!n)return[];const s=this._ops.length,l=[];for(let e=0;e<r.length;e++){const c=r[e],u=t.get(c);if(!u)continue;const h=Array.from(u[0].keys());for(let e=0;e<s;e++){const t={};if(n){const i=n[e];if(i){const n=h.map((t=>o[t][c+e+a]));i.forEach((e=>t[e.name]=e.op(n)))}}if(i){const n=i[e];n&&n.forEach((e=>t[e.name]=e.op(u.slice(1))))}l[a+c+e]=t}}return l}_optimizeGroup(e){const t={};let i=!0;for(const n in e){const r=e[n];t[n]=se(r,this._context.math),i=!1}return i?null:t}mark(e,t){const i=[],{_marks:n,_ops:r}=this;if(!n)return i;const o=r.length,{scaleWidth:a,data:s,columnData:l,rowData:c}=e;for(const[e,n]of t){const t=n[0];for(let n=0;n<o;n++){const r=this._marks[n];if(null!==r)for(const o of t){const t=e+n+a,u=o,h=[];for(let e=0;e<r.length;e++)r[e].check(s[u][t],l[t]||{},c[u]||{})&&h.push(r[e].name);if(h.length){let e=i[u];void 0===e&&(e=i[u]=[]),e[t]=h}}}}return i}__getHeaderStub(){return{}}_fillGroupRow(e,t,i,n){const{_groupResultOps:r}=this,{columns:o,scaleWidth:a}=t;if(r)for(let t=0;t<o.length;t++){const i=o[t];for(let t=0;t<r.length;t++){const o=r[t];o&&n>0&&this._fillGroupRowInner(e,o,i+t+a,n)}}}_fillGroupRowInner(e,t,i,n){const r=[];if(n>0)e.data.forEach((e=>{const o=this._fillGroupRowInner(e,t,i,n-1);null!==o&&r.push(o)}));else for(let t=0;t<e.data.length;t++){const n=e.data[t].values[i];void 0!==n&&r.push(n)}return r.length?e.values[i]=t(r):null}_fillRow(e,t,i,n,r,o,a,s){const{_cols:l,_group:c,_ops:u,_sizes:h,_rows:p,_rowResultOps:d,_rowOps:_}=this,f=p.length,b=null!==this._colResultOps||null!==this._colOps||null!==this._marks;let g=[];if(null!==d&&(g=d.map((()=>[]))),u.length)if(l.length){let s=i;for(;s<n;){let i=0;for(let e=0;e<l.length;e++)i+=h[e]*c[f+e];const n=this._nextColumn();for(let t=0;t<u.length;t++){const o=e[i+r+t]=u[t](s,n);null!==d&&g[t].push(o)}if(b){let e=a.get(i);e?e.push(s,n):a.set(i,e=[new Set,s,n]),e[0].add(t)}o.add(i),this._cursor=s=n}}else{for(let t=0;t<u.length;t++)e[t+r]=u[t](i,n);if(b){let e=a.get(0);e?e.push(i,n):a.set(0,e=[new Set,i,n]),e[0].add(t)}o.add(0)}null!==d&&d.forEach(((e,t)=>{const i=g[t];e&&i.length&&e.forEach((e=>{s[e.name]=e.op(g[t])}))})),null!==_&&_.forEach((e=>{null==e||e.forEach((e=>{s[e.name]=e.op(i,n)}))}))}_sort(){const{_table:e,_dims:t}=this,i=Math.min(e.count(),this._context.limit.raws),n=new Array(i);for(let e=0;e<i;e++)n[e]=e;const r=t.length,o=t.map((e=>e.getIndexes()));return n.sort(((e,t)=>{for(let i=0;i<r;i++){const n=o[i][e],r=o[i][t];if(n>r)return 1;if(n<r)return-1}return 0})),n}_nextRow(e){const{_data:t,_order:i,_group:n,_rows:r}=this,o=r.length;let a=!0,s=this._cursor;for(;;){const r=i[s];for(let i=0;i<o;i++)t[i][r]!=n[i]&&(e||(n[i]=t[i][r]),a=!1);if(!a)break;s++}return s}_nextColumn(){const{_data:e,_order:t,_group:i,_rows:n,_cols:r}=this,o=r.length+n.length;let a=!0,s=this._cursor;for(;;){const n=t[s];for(let t=0;t<o;t++)e[t][n]!=i[t]&&(i[t]=e[t][n],a=!1);if(!a)break;s++}return s}_setSizes(){const e=this._cols.map((e=>e.getSize()));let t=this._ops.length||1;for(let i=e.length-1;i>=0;i--){const n=t;t*=e[i],e[i]=n}this._sizes=e}}function _e(e,t,i,n){const r=e.map((e=>{const r=e[t];if(!r)return null;const o=r.map((e=>(e.source||"raw")===i?"string"==typeof e?n(e,fe(e)):n(e.math,e.as||fe(e.math)):null)).filter((e=>null!==e));return o.length?o:null}));return r.find((e=>!!e))?r:null}function fe(e){const t=e.indexOf("(");return-1===t?e.trim():e.substring(0,t).trim()}class be{constructor(e){this._columns=e.fields,this.parse(e.data)}parse(e){this._raw=e,this._parse_inner()}prepare(){if(this._prepared)return;this._prepared=!0;const e=this._raw,t=this._columns.filter((e=>3===e.type));if(!e||!t.length)return;const i=e.length,n=t.length;for(let e=0;e<i;e++)for(let i=0;i<n;i++){const n=t[i],r=n.getter(e);"string"==typeof r&&n.setter(e,new Date(r))}}_parse_inner(){this._columns.forEach((e=>{const t=e.id;e.getter=e=>this._raw[e][t],e.setter=(e,i)=>this._raw[e][t]=i}))}getColumn(e){return this._columns.find((t=>t.id===e))}count(){return this._raw.length}}class ge extends be{parse(e){this._parse_init(e.length);const t=e.length,i=this._columns.length;for(let n=0;n<t;n++){const t=e[n];for(let e=0;e<i;e++){const i=this._columns[e];i.data[n]=t[i.id]}}}_parse_init(e){this._columns.forEach((t=>{const i=t.data=new Array(e);t.getter=e=>i[e],t.setter=(e,t)=>i[e]=t}))}count(){return this._columns[0].data.length}}const we={round:e=>Math.round(e),sum:e=>e.reduce(((e,t)=>e+t),0),min:e=>e.reduce(((e,t)=>t<e?t:e),e.length?e[0]:0),max:e=>e.reduce(((e,t)=>t>e?t:e),e.length?e[0]:0),avg:e=>e.length?e.reduce(((e,t)=>e+t),0)/e.length:0,wavg:(e,t)=>{if(!e.length)return 0;let i=0,n=0;for(let r=e.length-1;r>=0;r--)i+=t[r],n+=e[r]*t[r];return n/i},count:e=>e.length,any:e=>e.length?e[0]:null},Ae={eq:e=>t=>t==e,neq:e=>t=>t!=e,gt:e=>t=>t>e,gte:e=>t=>t>=e,lt:e=>t=>t<e,lte:e=>t=>t<=e,in:e=>t=>e[t],hasPrefix:e=>t=>0===t.indexOf(e),contains:e=>t=>-1!==t.indexOf(e)},xe={year:e=>e.getFullYear(),month:e=>e.getMonth(),day:e=>e.getDate(),hour:e=>e.getHours(),minute:e=>e.getMinutes()};class ve{constructor(e){this._tables={},this._dimensions={},this._preds=Object.assign({},xe),this._maths=Object.assign({},we),this._comps=Object.assign({},Ae),e&&e.tables&&e.tables.forEach((e=>this.addTable(e))),e&&e.dimensions&&e.dimensions.forEach((e=>this.addDimension(e)))}addPredicate(e,t){this._preds[e.toLowerCase()]=t}addMath(e,t){this._maths[e.toLowerCase()]=t}addComparator(e,t){this._comps[e.toLowerCase()]=t}getDimension(e){return this._dimensions[e]}addDimension(e){if(this._dimensions[e.id])return;const t=this._tables[e.table],i=this._predicateGetter(t,e.rule.by);this._dimensions[e.id]=new ie(t,i,e.label||e.id,e.meta||e,e.sort)}resetDimensions(e,t){const i=this._dimensions;this._dimensions={},e&&e.forEach((e=>{const n=i[e.id];t&&n?this._dimensions[e.id]=n:this.addDimension(e)}))}addTable(e){const t="raw"===(e.driver||"raw")?be:ge,i=this._tables[e.id]=new t(e);e.prepare&&i.prepare()}getTable(e){return this._tables[e]}compact(e,t){const{rows:i,cols:n,filters:r,limit:o}=t,a=this._tables[e],s=i?i.map((e=>this._dimensions[e])):[],l=n?n.map((e=>this._dimensions[e])):[];[...s,...l].forEach((e=>e.prepare()));const c=new de(a,s,l,r,{getter:this._predicateGetter.bind(this),math:this._maths,compare:this._comps,limit:Object.assign({rows:1e4,columns:5e3,raws:1/0},o||{})});return new ne(c)}_predicateGetter(e,t){const i=t.indexOf("(");if(-1!==i){const n=this._preds[t.substr(0,i).toLowerCase()];t=t.substr(i+1,t.length-i-2);const r=e.getColumn(t).getter;return e=>n(r(e))}return e.getColumn(t).getter}}class me{constructor(e){this._app=e,this._store={},this._filtersHash={},this._state=e.getState(),e.config.externalProcessing?this._setOperations():(this._data=[],this._initRengine())}_setOperations(){this.operations=[{id:"sum",fields:1,branchMode:"result"},{id:"min",fields:1,branchMode:"result"},{id:"max",fields:1,branchMode:"result"},{id:"avg",fields:1,branchMode:"raw"},{id:"wavg",fields:2,branchMode:"raw"},{id:"count",fields:1,branchMode:"raw"},{id:"any",fields:1,branchMode:"result"},{id:"complex"}];const e=this._app.config,t=this._app.config.operations;if(t)if(e.externalProcessing)this.operations=this.operations.concat(t);else for(let e in t){let i,n,r,o=t[e];"object"==typeof o?(i=o.fields||o.handler.length,n=o.branchMode,r=o.hidden,o=o.handler):i=o.length,this._reng.addMath(e,o),r||this.operations.push({id:e,fields:i,branchMode:n})}}_setTotalOperations(){this.totalOperations={};const e=this._app.config.totalOperations;if(e)for(let t in e){const i=e[t],n="string"==typeof e[t];["footer","group","column"].forEach((e=>{(n||i[e])&&(this.totalOperations[e]||(this.totalOperations[e]={}),this.totalOperations[e][t]=n?i:i[e])}))}}_setFilters(){for(let e in webix.filters)this._reng.addComparator(e,(t=>i=>("date"==e&&(i=i.valueOf()),!t||(t.includes?-1!=t.includes.indexOf(i):!t.condition.filter||webix.filters[e][t.condition.type](i,t.condition.filter)))))}_setPredicates(){const e=this._app.config.predicates;if(e)for(let t in e)this._reng.addPredicate(t,e[t])}getFields(e){let t=this._app.config.fields;if(!t){t=[];for(let i in e){let n;const r=typeof e[i];switch(r){case"string":n="text";break;case"number":n=r;break;default:n="date"}t.push({id:i,value:i,type:n})}}return t}getData(e){if(!e&&this.useOldData())return this._dataLoad||webix.promise.resolve(this._store);const t=this._app.config.externalProcessing;return t||!Object.keys(this._store).length||e?this._dataLoad=this._app.getService("backend").data().then((e=>(t?this._store=this._rengineToWebix(e.result,e.header):(this._table=this.getTable(e),this._reng.addTable(this._table),this._store=this.getPivotData()),this._filtersHash={},this._store))).catch((e=>this.loadError(e))).finally((()=>delete this._dataLoad)):(this._store=this.getPivotData(),webix.promise.resolve(this._store))}useOldData(){const e=this._state;let t=`${e.mode}|${JSON.stringify(e.structure)}`;if("chart"==e.mode){const i=e.chart.type;t+="|"+("pie"==i||"donut"==i)}else t+="|"+JSON.stringify(e.datatable);const i=this._old==t;return this._old=t,i}_initRengine(){this._reng=new ve,this._setFilters(),this._setOperations(),this._setTotalOperations(),this._setPredicates()}getPivotData(){if(!this._table)return{data:[],header:[],total:[],marks:[]};const e=this._state.structure,t=this._state.mode,i=this._state.datatable;this.setDimensions();const n={};for(let t=0;t<e.filters.length;t++){const i=e.filters[t],r=this._state.fields.find((e=>e.id==i.name));n[i.name]={[r.type]:i.value}}const r=this._reng.compact(this._table.id,{rows:this.getRows(),cols:this.getColumns(),limit:this.getLimits()}),o=this.getOps();try{let e,a;return e="table"==t?r.toArray({filters:n,ops:o,cleanRows:i.cleanRows}):r.toNested({filters:n,ops:o}),"chart"!=t&&(a={meta:!0,nonEmpty:!0}),this._rengineToWebix(e,r.toXHeader(e,a))}catch(e){return this.loadError()}}_updateTotalMath(e,t,i){for(let n=i.length-1;n>=0;n--){const r=i[n];t=t.substring(0,r.index+r[1].length)+(this.totalOperations[e][r[2]]||r[2])+t.substring(r.index+r[0].length-1,t.length)}return t}getOps(){const e=this._state,t=e.datatable,i=e.mode,n=e.structure.values,r=[];for(let e=0;e<n.length;e++){const o=n[e].format,a=n[e].operation,s=n[e].color,l="complex"==a;let c=l?n[e].math:n[e].name;c=webix.isArray(c)?c.join(","):c;const u=l?c:`${a}(${c})`;let h;l||(h=this.getOperation(a).branchMode);const p={math:u,branchMode:h||"raw",label:c,meta:{operation:a,format:o,color:s},column:[],row:[],marks:[]},d=this.totalOperations;let _;if(Object.keys(d).length){const e=new RegExp("(\\(|,|\\+|-|\\/|\\*|\\s|^)("+this.operations.map((e=>e.id)).join("|")+")\\(","g");_=Array.from(u.matchAll(e))}d.group&&(p.branchMath=this._updateTotalMath("group",u,_)),"chart"!=i&&(t.footer&&("sumOnly"==t.footer&&"sum"==a||"sumOnly"!=t.footer)&&p.column.push({math:d.footer?this._updateTotalMath("footer",u,_):u,as:"value"}),t.totalColumn&&("sumOnly"==t.totalColumn&&"sum"==a||"sumOnly"!=t.totalColumn)&&p.row.push({math:d.column?this._updateTotalMath("column",u,_):u,as:""+e}),t.minY&&(p.column.push({as:"minY",math:"min(group)",source:"result"}),p.marks.push({name:"webix_min_y",check:(e,t)=>e==t.minY})),t.maxY&&(p.column.push({as:"maxY",math:"max(group)",source:"result"}),p.marks.push({name:"webix_max_y",check:(e,t)=>e==t.maxY})),t.minX&&(p.row.push({as:"minX"+u,math:"min(group)",source:"result"}),p.marks.push({name:"webix_min_x",check:(e,t,i)=>e==i["minX"+u]})),t.maxX&&(p.row.push({as:"maxX"+u,math:"max(group)",source:"result"}),p.marks.push({name:"webix_max_x",check:(e,t,i)=>e==i["maxX"+u]}))),r.push(p)}return r}_rengineToWebix(e,t){const i=this._state;if("chart"==i.mode)return this.getChartData(e,t);const n=t.nonEmpty.map((t=>e.columnData[t]?e.columnData[t].value:""));let r;return t=this.getHeader(t),i.datatable.totalColumn&&(r=e.rowData.map((e=>{const t=[];for(let i in e)-1==i.indexOf("minX")&&-1==i.indexOf("maxX")&&(t[i]=e[i]);return t.filter((e=>e||0===e))}))),{data:e.tree||e.data,header:t,marks:e.marks,footer:n,totalColumn:r}}loadError(){return webix.message({text:this._app.getService("locale")._("Incorrect formula in values"),type:"error"}),{data:[],values:[],header:[],marks:[],footer:[],totalColumn:[]}}_toTree(e){let t=e.values;if(!webix.isArray(t)){let e=[];for(let i in t)e[i]=t[i];t=e}return t.unshift(""),e.data?(t.open=!0,t.data=e.data.map((e=>this._toTree(e)))):t.id=e.id,t}getTable(e){const t=this.getFields(e[0]);return this._state.fields=t,this._data=e=this.prepareData(e,t),{id:"webixpivot",prepare:!0,driver:"raw",fields:webix.copy(t),data:e}}prepareData(e,t){return(t=t.filter((e=>e.prepare||"date"==e.type))).length&&(e=e.map((e=>(t.forEach((t=>{e[t.id]=t.prepare?t.prepare(e[t.id]):new Date(e[t.id])})),e)))),e}collectFieldValues(e){if(this._filtersHash[e])return webix.promise.resolve(this._filtersHash[e]);const t=this._app;if(t.config.externalProcessing)return this._filtersHash[e]=t.getService("backend").collectFieldValues(e);const i=this.getField(e),n={},r=[];for(let o=0;o<this._data.length;o++){let a=this._data[o][e];if(a||0===a){let e=a;"date"==i.type&&(a=a.valueOf()),n[a]||(n[a]=!0,i.predicate&&(e=t.config.predicates[i.predicate](e)),r.push({value:a,id:a,label:e}))}}return this._filtersHash[e]=r,webix.promise.resolve(r)}fixMath(e){const t=this._app.getService("locale")._,i=this._state.fields,n=new RegExp(i.map((e=>"\\b"+e.id+"\\b(?!\\()")).join("|"),"g"),r=this.operations,o=new RegExp(r.map((e=>"\\b"+e.id+"\\b\\(")).join("|"),"g");return e.replaceAll(n,(e=>i.find((t=>t.id==e)).value)).replaceAll(o,(e=>t(e.substring(0,e.length-1))+"("))}getField(e){return this._state.fields.find((t=>t.id==e))}getOperation(e){return this.operations.find((t=>t.id==e))}getColumns(){const e=this._state.structure;return"chart"==this._state.mode&&e.groupBy?[e.groupBy]:e.columns}getRows(){return"chart"==this._state.mode?[]:this._state.structure.rows}getLimits(){return{}}getHeader(e){const t=e.data,i=[];return e.nonEmpty.forEach(((n,r)=>{i.push({id:n+1,header:t.map((t=>{t=t[r]&&!webix.isUndefined(t[r].text)?t[r]:{text:t[r]||""};const i=e.meta[r]&&e.meta[r].operation;return i&&(t.operation=i),t})),format:e.meta[r]&&e.meta[r].format})})),i}setDimensions(){this._reng.resetDimensions();const e=this.getColumns().concat(this.getRows()||[]);for(let t=0;t<e.length;t++){const i=this.getField(e[t]);this._reng.addDimension({id:e[t],table:this._table.id,label:e[t],rule:{by:i.predicate?`${i.predicate}(${e[t]})`:e[t]}})}}getChartData(e,t){const i=this._state,n=i.structure.values;let r=[],o=[];if(e.data.length){const o=i.chart.type,a=i.structure.groupBy,s=webix.copy(e.data[0]),l=a?t.data[0]:s.map((()=>""));let c=0;for(;s.length;){let e=s.splice(0,n.length);if(!e.length)break;{let t=l[c].text;if(0===t&&(t="0"),"pie"==o||"donut"==o){for(let t=0;t<e.length;t++)e[t]={value:e[t],color:n[t].color};a?r.push({text:t||l[c],color:this.getValueColor(c/n.length,!0),data:e}):r=e}else e.push(t||l[c]),r.push(e);c+=n.length}}}for(let e=0;e<n.length;e++){const t=n[e];let i="complex"==t.operation?t.math:t.name;i=Array.isArray(i)?i.join(","):i,o.push({text:i||t.operation,operation:t.operation,color:t.color})}return{data:r,values:o}}getPalette(){return[["#e33fc7","#a244ea","#476cee","#36abee","#58dccd","#a7ee70"],["#d3ee36","#eed236","#ee9336","#ee4339","#595959","#b85981"],["#c670b8","#9984ce","#b9b9e2","#b0cdfa","#a0e4eb","#7faf1b"],["#b4d9a4","#f2f79a","#ffaa7d","#d6806f","#939393","#d9b0d1"],["#780e3b","#684da9","#242464","#205793","#5199a4","#065c27"],["#54b15a","#ecf125","#c65000","#990001","#363636","#800f3e"]]}getValueColor(e,t){const i=this.getPalette(t);let n=e/i[0].length;n=n==i.length?0:parseInt(n,10);const r=e%i[0].length;return i[n][r]}clearAll(){this._app.config.fields=null,this._state.fields=[],this._app.setStructure({}),delete this._table,this._store=this.getPivotData(),this._data=[],this._filtersHash={}}}class ye{constructor(e,t){this.app=e,this._url=t}url(e){return this._url+(e||"")}data(){let e,t=this.url();if(this.app.config.externalProcessing){t+="/data";const i=this.app.getState(),n=i.mode;e={structure:i.structure,mode:n},"chart"!=n&&(e.table=i.datatable)}return webix.ajax(t,e).then((e=>e.json()))}collectFieldValues(e){return webix.ajax(this.url("/fields/"+e)).then((e=>e.json()))}}class Ce extends b{constructor(e){const t=e.mode||"tree";let i=e.structure||{};const n=e.chart||{};webix.extend(n,{type:"bar",scale:"linear",lines:!0}),delete n.id;const r=e.datatable||{};delete r.id;const o=O({mode:t,structure:i,readonly:e.readonly||!1,fields:e.fields||[],datatable:r,chart:n,config:!1}),a={router:g,version:"10.1.0",debug:!0,compactWidth:720,start:"main/"+("chart"==t?"chart":"table"),params:{state:o,forceCompact:e.compact}};super(Object.assign(Object.assign({},a),e)),this.setService("backend",new(this.dynamic(ye))(this,this.config.url)),this.setService("local",new(this.dynamic(me))(this,e)),function(e){let t;const i={updateConfig(i){const n=e.getRoot(),r=n.$view;t?t&&!r.id&&(r.id=t):(r.id?t=r.id:r.id=t="webix_"+webix.uid(),webix.html.addStyle(".webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }"),webix.html.addStyle(`#${t}{ position: relative; }`),webix.html.addStyle(`#${t} .webix_window{ z-index:2 !important; }`),webix.html.addStyle(`#${t} .webix_disabled{ z-index:1 !important; }`)),i.container=t,i.fullscreen&&(i._fillApp=!0,delete i.fullscreen),i.on||(i.on={});let o=!0;const a=i.on.onShow;return i.on.onShow=function(){a&&a.apply(this,arguments),o&&(this.$setSize=(e,t)=>{R(this,n,!0),webix.ui.window.prototype.$setSize.apply(this,[e,t])},M(this,e),o=null),webix.callEvent("onClick",[]),webix.html.addCss(r,"webix_win_inside"),n.disable(),R(this,n)},i}};e.setService("jet-win",i)}(this),i=this.prepareStructure(i,!0),this.use(I,this.config.locale||{lang:"en",webix:{en:"en-US"}})}dynamic(e){return this.config.override&&this.config.override.get(e)||e}require(e,t){return"jet-views"===e?Z[t]:"jet-locales"===e?Se[t]:null}getState(){return this.config.params.state}setStructure(e){this.getState().structure=this.prepareStructure(e)}getStructure(){return this.getState().structure}prepareStructure(e,t){const i=this.getState().mode;webix.extend(e,{rows:[],columns:[],values:[],filters:[]}),t?"chart"==i&&e.groupBy||!e.columns.length?e.groupBy&&(e.columns=[e.groupBy]):e.groupBy=e.columns[0]:"chart"!=i?e.groupBy=e.columns[0]:e.groupBy?e.columns[0]!==e.groupBy&&(e.columns=[e.groupBy]):e.columns=[];const n=[];for(let t=0;t<e.values.length;t++){const i=e.values[t];if(webix.isArray(i.operation)){i.color=(webix.isArray(i.color)?i.color:[i.color])||[];for(let e=0;e<i.operation.length;e++){const t=Object.assign({},i);t.operation=i.operation[e],t.color=i.color&&i.color[e],n.push(t)}}else n.push(i)}for(let e=0;e<n.length;e++){const t=this.getService("local");if(n[e].color||(n[e].color=t.getValueColor(e)),n[e].name||n[e].math){if(t.getOperation(n[e].operation).fields>2){const t=n[e].name;n[e].math=`${n[e].operation}(${webix.isArray(t)?t.join():t})`,n[e].operation="complex"}}else n[e].math=n[e].operation,n[e].operation="complex"}return e.values=n,e}}webix.protoUI({name:"pivot",app:Ce,defaults:{borderless:!1},$init:function(){this.name="pivot",this.$view.className+=" webix_pivot";const e=this.$app.getState();for(let t in e)U(e,this.config,t);this.$app.attachEvent("filter:change",((e,t)=>this.callEvent("onFilterChange",[e,t])))},$exportView:function(e){const t=this.$app.getRoot().queryView({$mainView:!0});return t.$exportView?t.$exportView(e):t},getState(){return this.$app.getState()},getService(e){return this.$app.getService(e)},setStructure:function(e){this.$app.setStructure(e)},getStructure:function(){return this.$app.getStructure()},clearAll:function(){this.$app.getService("local").clearAll()}},webix.ui.jetapp);const ke={Backend:ye,LocalData:me},Se={en:{Done:"Done",Table:"Table",Tree:"Tree",Chart:"Chart","Click to configure":"Click to configure","Configure Pivot":"Configure Pivot",Total:"Total",Fields:"Fields",Methods:"Methods",Columns:"Columns","Add column":"Add column",Rows:"Rows","Add row":"Add row","Clean rows":"Clean rows",Filters:"Filters","Add filter":"Add filter","Group By":"Group By","Chart type":"Chart type","Logarithmic scale":"Logarithmic scale","X axis title":"X axis title","Y axis title":"Y axis title","Scale color":"Scale color","Circled lines":"Circled lines",Horizontal:"Horizontal",Stacked:"Stacked",Lines:"Lines",Line:"Line",Radar:"Radar",Bar:"Bar",Area:"Area",Spline:"Spline","Spline Area":"Spline Area",Pie:"Pie",Donut:"Donut",Values:"Values","Add value":"Add value","Field not defined":"Field not defined",Highlight:"Highlight","Min X":"Min X","Max X":"Max X","Min Y":"Min Y","Max Y":"Max Y",Footer:"Footer","Total Column":"Total Column",Off:"Off",On:"On","Sum Only":"Sum Only","3D":"3D","Show values inside":"Show values inside",count:"count",max:"max",min:"min",avg:"avg",wavg:"wavg",any:"any",sum:"sum",complex:"complex","Incorrect formula in values":"Incorrect formula in values"}};e.App=Ce,e.locales=Se,e.services=ke,e.views=Z,Object.defineProperty(e,"__esModule",{value:!0})}(t)},97136:function(e,t,i){var n,r,o;!function(a){"use strict";var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function l(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var c=function(){return(c=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function u(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)n[r]=o[a];return n}var h=function(){},p=function(){function e(e,t){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={},t&&t.params&&e.extend(this._data,t.params)}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null},e.prototype.setParam=function(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var n=this.getParentView();return n?n.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._segment.suburl()},e.prototype.getUrlString=function(){return this._segment.toString()},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView((function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope}),"self")}return e},e.prototype.on=function(e,t,i){var n=e.attachEvent(t,i);return this._events.push({obj:e,id:n}),n},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null},e.prototype._detachEvents=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)},e.prototype._destroySubs=function(){for(var e in this._subs){var t=this._subs[e].view;t&&t.destructor()}this._subs={}},e.prototype._init_url_data=function(){var e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)},e.prototype._getDefaultSub=function(){if(this._subs.default)return this._subs.default;for(var e in this._subs){var t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){var i=t.view._getDefaultSub();if(i)return i}}},e.prototype._routed_view=function(){var e=this.getParentView();if(!e)return!0;var t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()},e}();function d(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var r=t[n],o={},a=r.indexOf(":");if(-1===a&&(a=r.indexOf("?")),-1!==a)for(var s=0,l=r.substr(a+1).split(/[\:\?\&]/g);s<l.length;s++){var c=l[s].split("=");o[c[0]]=decodeURIComponent(c[1])}i[n]={page:a>-1?r.substr(0,a):r,params:o,isNew:!0}}return i}function _(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push("/"+r.page);var o=f(r.params);o&&t.push("?"+o)}return t.join("")}function f(e){var t=[];for(var i in e)"object"!=typeof e[i]&&(t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i])));return t.join("")}var b=function(){function e(e,t){this._next=1,this.route="string"==typeof e?{url:d(e),path:e}:e,this.index=t}return e.prototype.current=function(){return this.route.url[this.index]},e.prototype.next=function(){return this.route.url[this.index+this._next]},e.prototype.suburl=function(){return this.route.url.slice(this.index)},e.prototype.shift=function(t){var i=new e(this.route,this.index+this._next);return i.setParams(i.route.url,t,i.index),i},e.prototype.setParams=function(e,t,i){if(t){var n=e[i].params;for(var r in t)n[r]=t[r]}},e.prototype.refresh=function(){for(var e=this.route.url,t=this.index+1;t<e.length;t++)e[t].isNew=!0},e.prototype.toString=function(){var e=_(this.suburl());return e?e.substr(1):""},e.prototype._join=function(e,t){var i=this.route.url;if(null===e)return i;var n=this.route.url,r=!0;if(i=n.slice(0,this.index+(t?this._next:0)),e){i=i.concat(d(e));for(var o=0;o<i.length;o++)n[o]&&(i[o].view=n[o].view),r&&n[o]&&i[o].page===n[o].page?i[o].isNew=!1:i[o].isNew&&(r=!1)}return i},e.prototype.append=function(e){var t=this._join(e,!0);return this.route.path=_(t),this.route.url=t,this.route.path},e.prototype.show=function(e,t,i){var n=this,r=this._join(e.url,i);return this.setParams(r,e.params,this.index+(i?this._next:0)),new Promise((function(e,i){var o=_(r),a={url:r,redirect:o,confirm:Promise.resolve()},s=t?t.app:null;!s||s.callEvent("app:guard",[a.redirect,t,a])?a.confirm.catch((function(e){return i(e)})).then((function(){if(null!==a.redirect){if(a.redirect!==o)return s.show(a.redirect),void i(new h);n.route.path=o,n.route.url=r,e()}else i(new h)})):i(new h)}))},e.prototype.size=function(e){this._next=e},e.prototype.split=function(){var t={url:this.route.url.slice(this.index+1),path:""};return t.url.length&&(t.path=_(t.url)),new e(t,0)},e.prototype.update=function(e,t,i){var n=this.route.url[this.index+(i||0)];if(!n)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?n.page=t:n.params[e]=t,this.route.path=_(this.route.url)},e}(),g=function(e){function t(t,i){var n=e.call(this,t.webix)||this;return n.app=t,n._children=[],n}return l(t,e),t.prototype.ui=function(e,t){var i=(t=t||{}).container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,this._segment,this),"object"!=typeof e||e instanceof p?n:n.getRoot()},t.prototype.show=function(e,t){if(t=t||{},"object"==typeof e){for(var i in e)this.setParam(i,e[i]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e,t);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var n=this.getParentView();return n?n.show(e.substr(3),t):this.app.show("/"+e.substr(3))}var r=this.getSubViewInfo(t.target);if(r){if(r.parent!==this)return r.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,r.subview,{url:e,params:t.params})}else if(e)return this.app.show("/"+e,t)}return this._show(this._segment,{url:e,params:t.params},this)},t.prototype._show=function(e,t,i){var n=this;return e.show(t,i,!0).then((function(){return n._init_url_data(),n._urlChange()})).then((function(){e.route.linkRouter&&(n.app.getRouter().set(e.route.path,{silent:!0}),n.app.callEvent("app:route",[e.route.path]))}))},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this._root&&(this._root.destructor(),e.prototype.destructor.call(this))},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)},t.prototype.render=function(e,t,i){var n=this;"string"==typeof t&&(t=new b(t,0)),this._segment=t,this._parent=i,this._init_url_data();var r="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==r?(this._container=r,this._render(t)):this._urlChange().then((function(){return n.getRoot()}))},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then((function(i){return t._render_final(i,e)})):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i,n=this,r=null,o=null,a=!1;if(this._container.tagName?o=this._container:(r=this._container).popup?(o=document.body,a=!0):o=this.webix.$$(r.id),!this.app||!o)return Promise.reject(null);var s=this._segment.current(),l={ui:{}};this.app.copyConfig(e,l.ui,this._subs),this.app.callEvent("app:render",[this,t,l]),l.ui.$scope=this,!r&&s.isNew&&s.view&&s.view.destructor();try{if(r&&!a){var c=o,u=c.getParentView();u&&"multiview"===u.name&&!l.ui.id&&(l.ui.id=c.config.id)}this._root=this.app.webix.ui(l.ui,o);var h=this._root;a&&h.setPosition&&!h.isVisible()&&h.show(),r&&(r.view&&r.view!==this&&r.view!==this.app&&r.view.destructor(),r.id=this._root.config.id,this.getParentView()||!this.app.app?r.view=this:r.view=this.app),s.isNew&&(s.view=this,s.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((function(){return n._urlChange().then((function(){return n._initUrl=null,n.ready(n._root,t.suburl())}))}))}catch(e){i=Promise.reject(e)}return i.catch((function(e){return n._initError(n,e)}))},t.prototype._init=function(e,t){return this.init(e,t.suburl())},t.prototype._urlChange=function(){var e=this;this.app.callEvent("app:urlchange",[this,this._segment]);var t=[];for(var i in this._subs){var n=this._subs[i],r=this._renderFrameLock(i,n,null);r&&t.push(r)}return Promise.all(t).then((function(){return e.urlChange(e._root,e._segment.suburl())}))},t.prototype._renderFrameLock=function(e,t,i){if(!t.lock){var n=this._renderFrame(e,t,i);n&&(t.lock=n.then((function(){return t.lock=null}),(function(){return t.lock=null})))}return t.lock},t.prototype._renderFrame=function(e,t,i){var n=this;if("default"===e){if(this._segment.next()){var r=i?i.params:null;return t.params&&(r=this.webix.extend(r||{},t.params)),this._createSubView(t,this._segment.shift(r))}t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i.url,t.params&&(i.params=this.webix.extend(i.params||{},t.params))),t.route){if(null!==i)return t.route.show(i,t.view).then((function(){return n._createSubView(t,t.route)}));if(t.branch)return}var o=t.view;if(!o&&t.url){if("string"==typeof t.url)return t.route=new b(t.url,0),i&&t.route.setParams(t.route.route.url,i.params,0),t.params&&t.route.setParams(t.route.route.url,t.params,0),this._createSubView(t,t.route);"function"!=typeof t.url||o instanceof t.url||(o=new(this.app._override(t.url))(this.app,"")),o||(o=t.url)}if(o)return o.render(t,t.route||this._segment,this)},t.prototype._initError=function(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t.current()).then((function(n){return n.render(e,t,i)}))},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(p),w=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._ui=i.ui,n}return l(t,e),t.prototype.config=function(){return this._ui},t}(g),A=function(){function e(e,t,i){this.path="",this.app=i}return e.prototype.set=function(e,t){this.path=e;var i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})},e.prototype.get=function(){return this.path},e}(),x=!0,v=function(e){function t(t){var i=this,n=(t||{}).webix||window.webix;return t=n.extend({name:"App",version:"1.0",start:"/home"},t,!0),(i=e.call(this,n,t)||this).config=t,i.app=i.config.app,i.ready=Promise.resolve(),i._services={},i.webix.extend(i,i.webix.EventSystem),i}return l(t,e),t.prototype.getUrl=function(){return this._subSegment.suburl()},t.prototype.getUrlString=function(){return this._subSegment.toString()},t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.destructor=function(){this.getSubView().destructor(),e.prototype.destructor.call(this)},t.prototype.copyConfig=function(e,t,i){if((e instanceof p||"function"==typeof e&&e.prototype instanceof p)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);var n=e instanceof Array;for(var r in t=t||(n?[]:{}),e){var o=e[r];if("function"==typeof o&&o.prototype instanceof p&&(o={$subview:o}),!o||"object"!=typeof o||o instanceof this.webix.DataCollection||o instanceof RegExp||o instanceof Map)t[r]=o;else if(o instanceof Date)t[r]=new Date(o);else{var a=this.copyConfig(o,o instanceof Array?[]:{},i);null!==a&&(n?t.push(a):t[r]=a)}}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){var i=t.getAttribute("trigger");if(i)return this._forView(t,(function(e){return e.app.trigger(i)})),e.cancelBubble=!0,e.preventDefault();var n=t.getAttribute("route");if(n)return this._forView(t,(function(e){return e.show(n)})),e.cancelBubble=!0,e.preventDefault()}var r=t.parentNode;r&&this.clickHandler(e,r)},t.prototype.getRoot=function(){return this.getSubView().getRoot()},t.prototype.refresh=function(){var e=this;return this._subSegment?this.getSubView().refresh().then((function(t){return e.callEvent("app:route",[e.getUrl()]),t})):Promise.resolve(null)},t.prototype.loadView=function(e){var t=this,i=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(n="function"==typeof i?i(e):i[e])&&(e=n,n=null),n||("_hidden"===e?n={hidden:!0}:"_blank"===e?n={}:(e=e.replace(/\./g,"/"),n=this.require("jet-views",e)))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n.then((function(e){return e.__esModule?e.default:e})).catch((function(i){return t._loadError(e,i)}))},t.prototype._forView=function(e,t){var i=this.webix.$$(e);i&&t(i.$scope)},t.prototype._loadViewDynamic=function(e){return null},t.prototype.createFromURL=function(e){var t=this;return e.isNew||!e.view?this.loadView(e.page).then((function(i){return t.createView(i,name,e.params)})):Promise.resolve(e.view)},t.prototype._override=function(e){var t=this.config.override;if(t){for(var i=void 0;e;)i=e,e=t.get(e);return i}return e},t.prototype.createView=function(e,i,n){if("function"==typeof(e=this._override(e))){if(e.prototype instanceof t)return new e({app:this,name:i,params:n,router:A});if(e.prototype instanceof p)return new e(this,{name:i,params:n});e=e(this)}return e instanceof p?e:new w(this,{name:i,ui:e})},t.prototype.show=function(e,t){return e&&this.app&&0==e.indexOf("//")?this.app.show(e.substr(1),t):this.render(this._container,e||this.config.start,t)},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)}),this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var n=t[i].message;0===n.indexOf("Module build failed")?(n=n.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+n+"</pre>"):(n+="<br><br>Check console for more details",this.webix.message({type:"error",text:n,expire:-1}))}},t.prototype.render=function(e,t,i){var n=this;this._container="string"==typeof e?this.webix.toNode(e):e||document.body;var r=null;this.$router?r="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(x&&"tagName"in this._container&&(this.webix.event(document.body,"click",(function(e){return n.clickHandler(e)})),x=!1),"string"==typeof t&&(t=new b(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);var o=i?i.params:this.config.params||null,a=this.getSubView(),s=this._subSegment,l=s.show({url:r,params:o},a).then((function(){return n.createFromURL(s.current())})).then((function(t){return t.render(e,s)})).then((function(e){return n.$router.set(s.route.path,{silent:!0}),n.callEvent("app:route",[n.getUrl()]),e}));return this.ready=this.ready.then((function(){return l})),l},t.prototype.getSubView=function(){if(this._subSegment){var e=this._subSegment.current().view;if(e)return e}return new g(this,{})},t.prototype.require=function(e,t){return null},t.prototype._first_start=function(e){var t=this;if(this._segment=e,this.$router=new this.config.router((function(e){return setTimeout((function(){t.show(e).catch((function(e){if(!(e instanceof h))throw e}))}),1)}),this.config,this),this._container===document.body&&!1!==this.config.animation){var i=this._container;this.webix.html.addCss(i,"webixappstart"),setTimeout((function(){t.webix.html.removeCss(i,"webixappstart"),t.webix.html.addCss(i,"webixapp")}),10)}if(e){if(this.app){var n=e.current().view;e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new b(this.config.start,0),e.current().view=n}}else{var r=this.$router.get();r||(r=this.config.start,this.$router.set(r,{silent:!0})),e=new b(r,0)}return e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[r]={id:t.id,url:n,branch:e.branch,popup:e.popup,params:e.params}).popup?null:t},t}(p),m=function(){function e(e,t){var i=this;this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=function(){return i.cb(i.get())}}return e.prototype.set=function(e,t){var i=this;if(this.config.routes){var n=e.split("?",2);for(var r in this.config.routes)if(this.config.routes[r]===n[0]){e=r+(n.length>1?"?"+n[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){var e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e.prototype._detectPrefix=function(){var e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]},e.prototype._getRaw=function(){return document.location.href},e}(),y=!1;function C(e){if(!y&&e){y=!0;var t=window;t.Promise||(t.Promise=e.promise);var i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){var i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});var n=e.ui.baselayout.prototype.addView,r=e.ui.baselayout.prototype.removeView,o={addView:function(e,t){if(this.$scope&&this.$scope.webixJet&&!e.queryView){var i=this.$scope,r={};e=i.app.copyConfig(e,{},r),n.apply(this,[e,t]);var o=function(e){i._renderFrame(e,r[e],null).then((function(){i._subs[e]=r[e]}))};for(var a in r)o(a);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var i in t){var n=t[i];e.$$(n.id)||(n.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,o,!0),e.extend(e.ui.baselayout.prototype,o,!0),e.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var i=e.uid().toString();t.body={id:i},this.$ready.push((function(){this.callEvent("onInit",[this.$app]),this.$app.render({id:i})}))}},e.ui.proxy,e.EventSystem)}}var k=function(e){function t(t){var i;return t.router=t.router||m,C((i=e.call(this,t)||this).webix),i}return l(t,e),t.prototype.require=function(e,t){return i(31163)(e+"/"+t)},t}(v),S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}l(t,e),t.prototype._detectPrefix=function(){this.prefix="",this.sufix=this.config.routerPrefix||""},t.prototype._getRaw=function(){return document.location.pathname+(document.location.search||"")}}(m),function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){return this.path},e}());function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $(e,t,i){for(var n in e)B(e,n)&&t.call(i||e,e[n],n,e)}function D(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var E=String.prototype.replace,T=String.prototype.split,L=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},I={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:L,chinese:function(){return 0},croatian:L,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:L,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},q={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function P(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var R=/\$/g,M=/%\{(.*?)\}/g;function F(e,t,i,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,o=n||M,a="number"==typeof t?{smart_count:t}:t;if(null!=a.smart_count&&r){var s=T.call(r,"||||");r=(s[function(e,t){return I[function(e){var t,i=(t={},$(q,(function(e,i){$(e,(function(e){t[e]=i}))})),t);return i[e]||i[T.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",a.smart_count)]||s[0]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return E.call(r,o,(function(e,t){return B(a,t)&&null!=a[t]?E.call(a[t],R,"$$"):e}))}function U(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?F:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||D,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if("||||"===t||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(P(t)+"(.*?)"+P(i),"g")}(t.interpolation)}U.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},U.prototype.extend=function(e,t){$(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.extend(e,n):this.phrases[n]=e}),this)},U.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:$(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.unset(e,n):delete this.phrases[n]}),this)},U.prototype.clear=function(){this.phrases={}},U.prototype.replace=function(e){this.clear(),this.extend(e)},U.prototype.t=function(e,t){var i,n,r=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof r._?i=r._:this.onMissingKey?n=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),n=e),"string"==typeof i&&(n=F(i,r,this.currentLocale,this.tokenRegex)),n},U.prototype.has=function(e){return B(this.phrases,e)},U.transformPhrase=function(e,t,i){return F(e,t,i)};var O=U,V=window.webix;V&&C(V);var H=function(e,t,i){var n=(i=i||{}).storage,r=n?n.get("lang")||"en":i.lang||"en";function o(t,o,a){o.__esModule&&(o=o.default);var l={phrases:o};i.polyglot&&e.webix.extend(l,i.polyglot);var c=s.polyglot=new O(l);if(c.locale(t),s._=e.webix.bind(c.t,c),r=t,n&&n.put("lang",r),i.webix){var u=i.webix[t];u&&e.webix.i18n.setLocale(u)}return a?Promise.resolve():e.refresh()}function a(t,n){if(!1!==i.path){var r=(i.path?i.path+"/":"")+t;o(t,e.require("jet-locales",r),n)}}var s={getLang:function(){return r},setLang:a,setLangData:o,_:null,polyglot:null};e.setService("locale",s),a(r,!0)},z=window;z.Promise||(z.Promise=z.webix.promise);var j=1;function N(e){var t=!1;return function(){if(t)return e.apply(this,arguments);t=!0}}var W=null;function Y(e,t){W=e,t(),W=null}function G(e,t,i){Object.defineProperty(t,i,{get:function(){return e[i]},set:function(t){return e[i]=t}})}function K(e,t){t=t||{};var i={},n={},r=function(e,t){var r=j++;return i[r]={mask:e,handler:t},t("*"===e?n:n[e],void 0,e),r},o=[],a=!1,s=function(e,t,n,r){if(a)o.push([e,t,n,r]);else for(var s=Object.keys(i),l=0;l<s.length;l++){var c=i[s[l]];c&&("*"!==c.mask&&c.mask!==e||c.handler(n,t,e,r))}};return Object.defineProperty(n,"$changes",{value:{attachEvent:r,detachEvent:function(e){delete i[e]}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$observe",{value:r,enumerable:!1,configurable:!1}),Object.defineProperty(n,"$batch",{value:function(e){if("function"!=typeof e){var t=e;e=function(){for(var e in t)n[e]=t[e]}}for(a=!0,e(n),a=!1;o.length;){var i=o.shift();s.apply(this,i)}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$extend",{value:function(e,i){for(var r in i=i||t,e)if(e.hasOwnProperty(r)){var o=e[r];i.nested&&"object"==typeof o&&o?n[r]=K(o,i):Q(n,o,r,s)}},enumerable:!1,configurable:!1}),n.$extend(e,t),n}function Q(e,t,i,n){Object.defineProperty(e,i,{get:function(){return t},set:function(e){if(null===t||null===e?t!==e:t.valueOf()!=e.valueOf()){var r=t;t=e,n(i,r,e,W)}},enumerable:!0,configurable:!1})}var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this;return{view:"popup",padding:0,point:!1,body:{view:"menu",subMenuPos:"right",layout:"y",borderless:!0,type:{subsign:!0},css:"webix_rpt_popup_menu",template:function(t){return e.GetTemplate(t)},width:160,submenuConfig:{point:!1,width:190,padding:0,template:function(t){return e.GetTemplate(t)}},autowidth:!0,autoheight:!0,data:this.GetData(),on:{onMenuItemClick:function(t,i){return e.PopupAction(t,i)}}}}},t.prototype.GetData=function(){var e=this.app.getService("locale")._;return[{value:e("To PNG"),id:"png"},{value:e("To PDF"),id:"pdf"}]},t.prototype.PopupAction=function(e){this.app.callEvent("exportModule",[e]),this.getRoot().hide()},t.prototype.GetTemplate=function(e){return"<span class='webix_icon "+e.icon+"'></span>"+e.value},t.prototype.Show=function(e){var t=this;this.getRoot().isVisible()||this.webix.delay((function(){return t.getRoot().show(e)}))},t}(g),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"form",localId:"toolbar",height:webix.skin.$active.barHeight+6,hidden:!0,padding:{left:10,right:10,top:6,bottom:6},margin:10,cols:[{view:"button",type:"icon",width:140,label:t("Export"),icon:"rpi-export",click:function(t){return e.ShowExportPopup(t)}},{}]}},t.prototype.ShowExportPopup=function(e){this.ExportMenu&&this.ExportMenu.$view||(this.ExportMenu=this.ui(X));var t=webix.$$(e);this.ExportMenu.Show(t.$view)},t}(g),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){return{rows:[J,{type:"wide",margin:5,cols:[{}]}]}},t.prototype.init=function(){this.State=this.getParam("state",!0),this.Local=this.app.getService("local"),this.Charts=this.app.getService("charts")},t.prototype.ready=function(){var e=this,t=this.getRoot().getChildViews();this.Bar=t[0],this.Host=t[1],this.on(this.State.$changes,"module",(function(t){return e.Show(t)})),this.on(this.app,"exportModule",(function(t){return e.Export(t)}))},t.prototype.Show=function(e){var t=this,i=this.Host;if(e&&"chart"===e.type&&this.CheckColumns(e.columns)){var n=this.GetChartConfig(e);if(!n.view)return;this.Bar.show(),this.GetChartData(e).then((function(r){var o=r[0],a=r[1];o=webix.copy(o),"rows"==e.meta.chart.seriesFrom&&(o=t.ConvertDataBySeries(o)),n.data=t.FormatLabels(o.slice(0,t.Charts.numLimit),a),webix.ui([n],i),t.Chart=i.getChildViews()[0]}))}else webix.ui([{template:" "}],i),this.Bar.hide(),this.Chart=null},t.prototype.FormatLabels=function(e,t){var i=this.State.module.meta.chart.labelColumn,n=i&&t.length?t.find((function(e){return e.field==i})):null;if(n)e.forEach((function(e){var t=n.data.find((function(t){return t.id==e[i]}));e[i]=t?t.value:e[i]}));else{var r=(this.State.module.fields||this.State.module.columns).find((function(e){return e.id==i}));r&&"date"==r.type&&e.forEach((function(e){e[i]=webix.i18n.dateFormatStr(new Date(e[i]))}))}return e},t.prototype.CheckColumns=function(e){return e.length&&-1==e.indexOf(webix.undefined)},t.prototype.GetChartConfig=function(e){var t=this,i=e.columns,n=e.meta;if(!i||!n.chart)return{};var r=n.chart,o=r.chartType,a=r.labelColumn,s=r.legendPosition,l=r.series,u=r.axises;if(!l)return{};var h=[];l.forEach((function(e){if(!1!==e.show){var i=e.chartType||o;h.push(c(c({},t.ApplyTypeConfig(e,i)),{value:function(t){return t[e.id]}}))}}));var p={view:"chart",type:o,localId:"chart",series:h,padding:{left:80,right:40,top:50,bottom:80},on:{onAfterRender:function(){return t.CorrectLabels()}},legend:this.GetLegendConfig(l,o,s)};return u&&(p.xAxis=c({template:function(e){return"<div class='webix_rpt_chart_label'>"+(e[a]||"")+"</div>"}},u.x),p.yAxis=c({},u.y),u.y.logarithmic&&(p.scale="logarithmic"),u.x.verticalLabels&&(p.css="webix_rpt_vertical_chart_labels")),"right"==p.legendPosition?p.padding.right=p.legend.width+10:p.padding.bottom=90,p},t.prototype.GetLegendConfig=function(e,t,i){if("none"==i)return null;var n=[],r=[],o=this.Charts.itemSupport;e.forEach((function(i){!1!==i.show&&(n.push({text:i.meta.name,color:i.meta.color,markerType:-1!=o.indexOf(e.chartType||t)?"item":"square"}),r.push(i.name))}));var a={values:n,margin:8};return"right"==i?(a.width=webix.html.getTextSize(r).width+30,a.valign="middle",a.align="right"):(a.layout="x",a.valign="bottom",a.align="center"),a},t.prototype.GetChartData=function(e){return Promise.all([this.Local.getData(this.Local.getDataConfig(e),"edit"==this.State.mode),this.Local.getOptions(e.columns)])},t.prototype.ApplyTypeConfig=function(e,t){var i=e.meta;return-1!=this.Charts.itemSupport.indexOf(t)?{fill:i.area?i.color:null,alpha:i.area?.2:1,item:{type:i.markerType,radius:"no"==i.markerType?0:3,borderColor:i.color,color:i.fillMarker?i.color:"#ffffff"},line:{color:i.color,width:i.area?1:2},disableItems:!!i.area}:"area"==t||"splineArea"==t?{border:!0,alpha:.3,color:i.color}:{color:i.color}},t.prototype.ConvertDataBySeries=function(e){var t=this.State.module.meta.chart,i=t.labelColumn,n=t.baseColumn,r=t.dataColumn;if(!(i&&n&&r))return[];var o=[];return e.forEach((function(e){var t=o.find((function(t){return t[i]==e[i]}));t||((t={})[i]=e[i]),t[e[n]]||(t[e[n]]=e[r]),o.push(t)})),o},t.prototype.CorrectLabels=function(){var e=this.$$("chart");if(e&&!e.config.offset){var t=e.$view.querySelector(".webix_axis_item_x");t&&(t.className+=" webix_rpt_chart_label0")}},t.prototype.Export=function(e){this.Chart&&("png"==e?webix.toPNG(this.Chart):"pdf"==e&&webix.toPDF(this.Chart,{autowidth:!0,display:"image"}))},t}(g);function ee(e,t,i,n){return function e(t,i,n){if("*"!==i)n.getList||n.attachEvent("onTimedKeyPress",(function(){var e=this.getValue();this.config.value!==e&&(this.config.value=e,this.callEvent("onChange",[e]))})),n.attachEvent("onChange",(function(){var e=this;Y(this,(function(){var n;(n=e.getValue())!==t[i]&&(t[i]=n)}))}));else{var r=n.elements;for(var o in r)void 0!==t[o]&&e(t,o,r[o])}}(e,t,i),function(e,t,i,n){var r=function(e,n,r,o){if("*"===r){var a=i.elements;for(var s in a)void 0!==e[s]&&a[s].setValue(e[s])}else if("*"===t){var l=i.elements[r];l&&l!=o&&l.setValue(e)}else o!=i&&i.setValue(e)};return n?n.on(e.$changes,t,r):e.$changes.attachEvent(t,r)}(e,t,i,n)}webix.protoUI({name:"input-list",getValue:function(){return this._value||[]},setValue:function(e){this._value=e,this.clearAll(),this.parse([].concat(e))}},webix.ui.list);var te,ie={table:"<span class='rpi-table'></span>",chart:"<span class='rpi-poll'></span>",heatmap:"<span class='rpi-chart-tree'></span>"},ne={main:"<svg  xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320'><path class='webix_rpt_cls1' d='M369.51,182.77c-23.18-52.39,32-103.23,13.74-148.28s-77.61-39.42-162.07-20S78.47-6.35,34.66,14.46c-29.39,14-27.27,58.82-5,107,38.95,84.29-51.86,117.32-24.38,166s118.91-.95,183.37,4.22c37.62.59,62.88,6.26,109.52,21.27C387.63,341.7,412.41,279.75,369.51,182.77Z'/><rect class='webix_rpt_cls2' x='111.53' y='226.04' width='212.47' height='0.91'/><rect class='webix_rpt_cls3' x='97' y='89.51' width='212' height='151.96'/><rect class='webix_rpt_cls4' x='67' y='159.96' width='136.33' height='81.98' rx='2'/><polygon class='webix_rpt_cls5' points='199.32 235.55 72.61 235.55 72.61 165.28 71.01 165.28 71.01 235.55 71.01 237.68 71.01 237.68 72.61 237.68 72.61 237.68 199.32 237.68 199.32 235.55'/><rect class='webix_rpt_cls6' x='84.64' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='97.47' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='110.3' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='123.14' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='135.97' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='148.8' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='161.63' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='174.46' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls6' x='187.29' y='165.28' width='0.8' height='68.14'/><rect class='webix_rpt_cls7' x='111.53' y='94.41' width='212.47' height='132.54'/><rect class='webix_rpt_cls8' x='111.53' y='109.85' width='212.47' height='0.91'/><path class='webix_rpt_cls9' d='M111.53,94.41H324v15.44H111.53Z'/><path class='webix_rpt_cls7' d='M111.53,79H324V94.41H111.53Z'/><path class='webix_rpt_cls2' d='M324,125.28v-.91H287.68V109.84h-.91v14.53H250.45V109.84h-.91v14.53H213.22V109.84h-.9v14.53H176V109.85h-.91v14.52H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56v13.61H111.53v.91h63.56v13.62H111.53v.91h63.56V197H111.53v.91h63.56v13.62H111.53v.9h63.56V227H176V212.42h36.32V227h.9V212.42h36.32V227h.91V212.42h36.32V227h.91V212.42H324v-.9H287.68V197.9H324V197H287.68V183.38H324v-.91H287.68V168.85H324v-.91H287.68V154.33H324v-.91H287.68V139.8H324v-.91H287.68V125.28Zm-74.46,0v13.61H213.22V125.28Zm-36.32,57.19V168.85h36.32v13.62Zm36.32.91V197H213.22V183.38Zm-36.32-15.44V154.33h36.32v13.61Zm0-14.52V139.8h36.32v13.62ZM176,125.28h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32v13.61H176Zm0,14.52h36.32v13.62H176Zm0,14.53h36.32V197H176Zm0,28.14V197.9h36.32v13.62Zm37.22,0V197.9h36.32v13.62Zm73.55,0H250.45V197.9h36.32Zm0-14.53H250.45V183.38h36.32Zm0-14.52H250.45V168.85h36.32Zm0-14.53H250.45V154.33h36.32Zm0-14.52H250.45V139.8h36.32Zm0-14.53H250.45V125.28h36.32Z'/><rect class='webix_rpt_cls2' x='175.09' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='212.32' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='249.54' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls2' x='286.77' y='94.41' width='0.91' height='15.43'/><rect class='webix_rpt_cls9' x='118.79' y='84.43' width='21.79' height='5.45'/><rect class='webix_rpt_cls9' x='250.45' y='84.43' width='66.28' height='5.45'/></svg>",alt:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 390 320' fill='none'><g clip-path='url(#clip0_4706_8889)'><path d='M369.502 182.763C346.322 130.373 401.502 79.5332 383.242 34.4832C364.982 -10.5668 305.632 -4.93676 221.172 14.4832C136.712 33.9032 78.4622 -6.35676 34.6522 14.4532C5.26223 28.4532 7.38222 73.2732 29.6522 121.453C68.6022 205.743 -22.2078 238.773 5.27222 287.453C32.7522 336.133 124.182 286.503 188.642 291.673C226.262 292.263 251.522 297.933 298.162 312.943C387.622 341.693 412.402 279.743 369.502 182.763Z' class='webix_rpt_cls1'/><path d='M112.545 76.0479C112.545 74.9421 113.475 74.0457 114.622 74.0457H215.368L256.913 114.09V251.238C256.913 252.344 255.983 253.241 254.836 253.241H114.622C113.475 253.241 112.545 252.344 112.545 251.238V76.0479Z' class='webix_rpt_cls6'/><path d='M128.322 60.5902C128.322 59.4844 129.252 58.588 130.399 58.588H231.145L272.69 98.6313V235.781C272.69 236.887 271.76 237.783 270.612 237.783H130.399C129.252 237.783 128.322 236.887 128.322 235.781V60.5902Z' class='webix_rpt_cls4'/><path fill-rule='evenodd' clip-rule='evenodd' d='M130.399 59.588C129.769 59.588 129.322 60.0708 129.322 60.5902V235.781C129.322 236.3 129.769 236.783 130.399 236.783H270.612C271.243 236.783 271.69 236.299 271.69 235.781V99.0563L230.742 59.588H130.399ZM231.145 58.588H130.399C129.252 58.588 128.322 59.4844 128.322 60.5902V235.781C128.322 236.887 129.252 237.783 130.399 237.783H270.612C271.76 237.783 272.69 236.887 272.69 235.781V98.6313L231.145 58.588Z' class='webix_rpt_cls3'/><path d='M231.146 96.6297V58.588L272.69 98.6313H233.222C232.075 98.6313 231.146 97.7353 231.146 96.6297Z' class='webix_rpt_cls3'/><path d='M184.729 74.0457H143.184C142.323 74.0457 141.626 74.718 141.626 75.5473V75.5473C141.626 76.3766 142.323 77.0489 143.184 77.0489H184.729C185.589 77.0489 186.287 76.3766 186.287 75.5473C186.287 74.718 185.589 74.0457 184.729 74.0457Z' class='webix_rpt_cls2'/><path d='M184.729 87.0457H143.184C142.323 87.0457 141.626 87.718 141.626 88.5473V88.5473C141.626 89.3766 142.323 90.0489 143.184 90.0489H184.729C185.589 90.0489 186.287 89.3766 186.287 88.5473C186.287 87.718 185.589 87.0457 184.729 87.0457Z' class='webix_rpt_cls2'/><path d='M222.443 101H143.557C142.697 101 142 101.672 142 102.5C142 103.328 142.697 104 143.557 104H222.443C223.303 104 224 103.328 224 102.5C224 101.672 223.303 101 222.443 101Z' class='webix_rpt_cls2'/><path d='M222.443 115H143.557C142.697 115 142 115.672 142 116.5V116.5C142 117.328 142.697 118 143.557 118H222.443C223.303 118 224 117.328 224 116.5C224 115.672 223.303 115 222.443 115Z' class='webix_rpt_cls2'/><path fill-rule='evenodd' clip-rule='evenodd' d='M218 223C240.644 223 259 204.644 259 182C259 159.356 240.644 141 218 141C195.356 141 177 159.356 177 182C177 204.644 195.356 223 218 223ZM218 227C242.853 227 263 206.853 263 182C263 157.147 242.853 137 218 137C193.147 137 173 157.147 173 182C173 206.853 193.147 227 218 227Z' class='webix_rpt_cls4'/><path d='M219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134ZM219.686 148.057C202.114 148.057 188.057 162.114 188.057 179.686C188.057 197.257 202.114 211.314 219.686 211.314C237.257 211.314 251.314 197.257 251.314 179.686C251.314 162.114 237.257 148.057 219.686 148.057Z' class='webix_rpt_cls5'/><path fill-rule='evenodd' clip-rule='evenodd' d='M253.047 209.471L253.645 208.769C260.316 200.928 264.371 190.754 264.371 179.686C264.371 167.834 259.663 156.468 251.283 148.088C242.903 139.708 231.537 135 219.686 135C207.834 135 196.468 139.708 188.088 148.088C179.708 156.468 175 167.834 175 179.686C175 191.537 179.708 202.903 188.088 211.283C196.468 219.663 207.834 224.371 219.686 224.371C230.754 224.371 240.928 220.316 248.769 213.645L249.471 213.047L252.314 215.89V221.443L286.457 255.586L295.586 246.457L261.443 212.314H255.89L253.047 209.471ZM261.857 211.314L297 246.457L286.457 257L251.314 221.857V216.305L249.417 214.407C241.404 221.225 231.002 225.371 219.686 225.371C207.569 225.371 195.949 220.558 187.381 211.99C178.813 203.423 174 191.802 174 179.686C174 167.569 178.813 155.949 187.381 147.381C195.949 138.813 207.569 134 219.686 134C231.802 134 243.423 138.813 251.99 147.381C260.558 155.949 265.371 167.569 265.371 179.686C265.371 191.002 261.225 201.404 254.407 209.417L256.305 211.314H261.857ZM187.057 179.686C187.057 161.562 201.562 147.057 219.686 147.057C237.809 147.057 252.314 161.562 252.314 179.686C252.314 197.809 237.809 212.314 219.686 212.314C201.562 212.314 187.057 197.809 187.057 179.686ZM188.057 179.686C188.057 162.114 202.114 148.057 219.686 148.057C237.257 148.057 251.314 162.114 251.314 179.686C251.314 197.257 237.257 211.314 219.686 211.314C202.114 211.314 188.057 197.257 188.057 179.686Z' class='webix_rpt_cls3'/><path d='M236.083 167.231L232.852 164L220.042 176.81L207.231 164L204 167.231L216.81 180.042L204 192.852L207.231 196.083L220.042 183.273L232.852 196.083L236.083 192.852L223.273 180.042L236.083 167.231Z' class='webix_rpt_cls3'/></g><defs><clipPath id='clip0_4706_8889'><rect width='390' height='320' class='webix_rpt_cls4'/></clipPath></defs></svg>"},re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;return{view:"form",scroll:"auto",elementsConfig:{labelWidth:130,labelPosition:"top"},elements:[{rows:[{view:"label",label:t("Report name")},{view:"text",name:"name",localId:"name"}]},{rows:[{view:"label",label:t("Description")},{view:"textarea",labelPosition:"top",height:150,name:"desc"}]},{rows:[{view:"label",label:t("Data source")},{view:"combo",name:"data",options:[]}]},{view:"input-list",name:"joins",template:this.JoinListTemplate.bind(this),data:[],autoheight:!0,borderless:!0,onClick:{webix_rpt_action_remove:function(t,i){return e.RemoveJoin(i)}}},{view:"button",localId:"add",label:t("Join data"),click:function(){return e.ShowJoins()}},{},{view:"button",label:t("Delete report"),localId:"delete",inputWidth:170,align:"left",css:"webix_rpt_delete",click:function(){return e.app.callEvent("onMenuAction",[null,"delete"])}}]}},t.prototype.init=function(){var e=this,t=this.getRoot().elements;this.State=this.getParam("state",!0),this.AppState=this.app.getParam("state"),this.Local=this.app.getService("local"),this.Models=this.Local.getModels(!0);var i=Object.keys(this.Models);t.data.getList().parse(i.map((function(t){var i=e.Models[t];return{id:i.id,value:i.name}}))),ee(this.State,"*",this.getRoot(),this),this.on(this.State.$changes,"id",(function(t){return e.ShowDeleteButton(t)})),this.on(this.AppState.$changes,"toolbar",(function(t){return e.ShowDeleteButton(t)})),this.SourcesList=this.ui({view:"popup",body:{view:"list",autoheight:!0,type:{template:this.JoinTemplate.bind(this)},click:function(t){var i=e.SourcesList.getBody().getItem(t);e.AddJoin(i),e.SourcesList.hide()}}})},t.prototype.AddJoin=function(e){var t=this.Local.addJoin(e.tid,this.State);t.joins=u(this.State.joins,[e]),this.State.$batch(t)},t.prototype.RemoveJoin=function(e){var t=this.Local.cleanLinkedModels(e,this.State);t.block?(t.block.filter&&webix.alert({container:this.app.getRoot().$view,text:this._("Please delete the related query filter first")}),t.block.group&&webix.alert({container:this.app.getRoot().$view,text:this._("Please delete the related group rule first")})):this.State.$batch(t)},t.prototype.JoinTemplate=function(e){var t=this.Models[e.sid],i=this.Models[e.tid],n=e.sf||e.tf,r=(e.sf?t:i).data.find((function(e){return e.id===n})).name;return i.name+" <span class='webix_rpt_sources_path'>"+t.name+(e.sf?" ("+r+")":"")+" -> "+i.name+(e.tf?" ("+r+")":"")+"</span>"},t.prototype.JoinListTemplate=function(e){return"<span style='float:right' class='webix_icon webix_rpt_action_remove rpi-delete'></span>"+this.JoinTemplate(e)},t.prototype.ShowJoins=function(){var e=this.Local.getLinkedModels([this.State.data].concat(this.State.joins.map((function(e){return e.tid}))),!0);if(e.length){var t=this.SourcesList.getBody();t.clearAll(),t.parse(e),this.SourcesList.show(this.$$("add").$view)}},t.prototype.ShowDeleteButton=function(){this.State.id&&this.AppState.toolbar?this.$$("delete").show():this.$$("delete").hide()},t}(g);function oe(e,t){var i=new webix.promise.defer;return webix.ui(t.getService("jet-win").updateConfig({view:"window",head:{view:"toolbar",padding:{left:12,right:4},borderless:!0,elements:[{view:"label",label:e.text},{view:"icon",icon:"wxi-close",hotkey:"esc",click:function(){i.reject("prompt cancelled"),this.getTopParentView().close()}}]},body:{view:"form",padding:{top:5,left:20,right:20,bottom:20},rows:[{margin:10,cols:[{view:"text",name:"name",value:e.value,width:230,css:"fm-prompt-input"},{view:"button",value:e.button,width:100,hotkey:"enter",click:function(){var e=this.getTopParentView(),t=e.getBody().getValues().name;i.resolve(t),e.close()}}]}]},on:{onShow:function(){var t=this.getBody().elements.name.getInputNode();t.focus(),e.selectMask?e.selectMask(t):t.select()}}})).show(),i}webix.protoUI({name:"query-select",$cssName:"richselect",$init:function(){webix.extend(this.on_click,{webix_rpt_qselect_icon:function(){return this.callEvent("onClearClick",[]),!1}})}},webix.ui.richselect),te=function(e){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)};function n(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=function(){},a=function(){function e(e,t){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={},t&&t.params&&e.extend(this._data,t.params)}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null},e.prototype.setParam=function(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var n=this.getParentView();return n?n.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._segment.suburl()},e.prototype.getUrlString=function(){return this._segment.toString()},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView((function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope}),"self")}return e},e.prototype.on=function(e,t,i){var n=e.attachEvent(t,i);return this._events.push({obj:e,id:n}),n},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null},e.prototype._detachEvents=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)},e.prototype._destroySubs=function(){for(var e in this._subs){var t=this._subs[e].view;t&&t.destructor()}this._subs={}},e.prototype._init_url_data=function(){var e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)},e.prototype._getDefaultSub=function(){if(this._subs.default)return this._subs.default;for(var e in this._subs){var t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){var i=t.view._getDefaultSub();if(i)return i}}},e.prototype._routed_view=function(){var e=this.getParentView();if(!e)return!0;var t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()},e}();function s(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var r=t[n],o={},a=r.indexOf(":");if(-1===a&&(a=r.indexOf("?")),-1!==a)for(var s=0,l=r.substr(a+1).split(/[\:\?\&]/g);s<l.length;s++){var c=l[s].split("=");o[c[0]]=decodeURIComponent(c[1])}i[n]={page:a>-1?r.substr(0,a):r,params:o,isNew:!0}}return i}function l(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push("/"+r.page);var o=c(r.params);o&&t.push("?"+o)}return t.join("")}function c(e){var t=[];for(var i in e)"object"!=typeof e[i]&&(t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i])));return t.join("")}var u=function(){function e(e,t){this._next=1,this.route="string"==typeof e?{url:s(e),path:e}:e,this.index=t}return e.prototype.current=function(){return this.route.url[this.index]},e.prototype.next=function(){return this.route.url[this.index+this._next]},e.prototype.suburl=function(){return this.route.url.slice(this.index)},e.prototype.shift=function(t){var i=new e(this.route,this.index+this._next);return i.setParams(i.route.url,t,i.index),i},e.prototype.setParams=function(e,t,i){if(t){var n=e[i].params;for(var r in t)n[r]=t[r]}},e.prototype.refresh=function(){for(var e=this.route.url,t=this.index+1;t<e.length;t++)e[t].isNew=!0},e.prototype.toString=function(){var e=l(this.suburl());return e?e.substr(1):""},e.prototype._join=function(e,t){var i=this.route.url;if(null===e)return i;var n=this.route.url,r=!0;if(i=n.slice(0,this.index+(t?this._next:0)),e){i=i.concat(s(e));for(var o=0;o<i.length;o++)n[o]&&(i[o].view=n[o].view),r&&n[o]&&i[o].page===n[o].page?i[o].isNew=!1:i[o].isNew&&(r=!1)}return i},e.prototype.append=function(e){var t=this._join(e,!0);return this.route.path=l(t),this.route.url=t,this.route.path},e.prototype.show=function(e,t,i){var n=this,r=this._join(e.url,i);return this.setParams(r,e.params,this.index+(i?this._next:0)),new Promise((function(e,i){var a=l(r),s={url:r,redirect:a,confirm:Promise.resolve()},c=t?t.app:null;!c||c.callEvent("app:guard",[s.redirect,t,s])?s.confirm.catch((function(e){return i(e)})).then((function(){if(null!==s.redirect){if(s.redirect!==a)return c.show(s.redirect),void i(new o);n.route.path=a,n.route.url=r,e()}else i(new o)})):i(new o)}))},e.prototype.size=function(e){this._next=e},e.prototype.split=function(){var t={url:this.route.url.slice(this.index+1),path:""};return t.url.length&&(t.path=l(t.url)),new e(t,0)},e.prototype.update=function(e,t,i){var n=this.route.url[this.index+(i||0)];if(!n)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?n.page=t:n.params[e]=t,this.route.path=l(this.route.url)},e}(),h=function(e){function t(t,i){var n=e.call(this,t.webix)||this;return n.app=t,n._children=[],n}return n(t,e),t.prototype.ui=function(e,t){var i=(t=t||{}).container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,this._segment,this),"object"!=typeof e||e instanceof a?n:n.getRoot()},t.prototype.show=function(e,t){if(t=t||{},"object"==typeof e){for(var i in e)this.setParam(i,e[i]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e,t);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var n=this.getParentView();return n?n.show(e.substr(3),t):this.app.show("/"+e.substr(3))}var r=this.getSubViewInfo(t.target);if(r){if(r.parent!==this)return r.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,r.subview,{url:e,params:t.params})}else if(e)return this.app.show("/"+e,t)}return this._show(this._segment,{url:e,params:t.params},this)},t.prototype._show=function(e,t,i){var n=this;return e.show(t,i,!0).then((function(){return n._init_url_data(),n._urlChange()})).then((function(){e.route.linkRouter&&(n.app.getRouter().set(e.route.path,{silent:!0}),n.app.callEvent("app:route",[e.route.path]))}))},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this._root&&(this._root.destructor(),e.prototype.destructor.call(this))},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)},t.prototype.render=function(e,t,i){var n=this;"string"==typeof t&&(t=new u(t,0)),this._segment=t,this._parent=i,this._init_url_data();var r="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==r?(this._container=r,this._render(t)):this._urlChange().then((function(){return n.getRoot()}))},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then((function(i){return t._render_final(i,e)})):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i,n=this,r=null,o=null,a=!1;if(this._container.tagName?o=this._container:(r=this._container).popup?(o=document.body,a=!0):o=this.webix.$$(r.id),!this.app||!o)return Promise.reject(null);var s=this._segment.current(),l={ui:{}};this.app.copyConfig(e,l.ui,this._subs),this.app.callEvent("app:render",[this,t,l]),l.ui.$scope=this,!r&&s.isNew&&s.view&&s.view.destructor();try{if(r&&!a){var c=o,u=c.getParentView();u&&"multiview"===u.name&&!l.ui.id&&(l.ui.id=c.config.id)}this._root=this.app.webix.ui(l.ui,o);var h=this._root;a&&h.setPosition&&!h.isVisible()&&h.show(),r&&(r.view&&r.view!==this&&r.view!==this.app&&r.view.destructor(),r.id=this._root.config.id,this.getParentView()||!this.app.app?r.view=this:r.view=this.app),s.isNew&&(s.view=this,s.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((function(){return n._urlChange().then((function(){return n._initUrl=null,n.ready(n._root,t.suburl())}))}))}catch(e){i=Promise.reject(e)}return i.catch((function(e){return n._initError(n,e)}))},t.prototype._init=function(e,t){return this.init(e,t.suburl())},t.prototype._urlChange=function(){var e=this;this.app.callEvent("app:urlchange",[this,this._segment]);var t=[];for(var i in this._subs){var n=this._subs[i],r=this._renderFrameLock(i,n,null);r&&t.push(r)}return Promise.all(t).then((function(){return e.urlChange(e._root,e._segment.suburl())}))},t.prototype._renderFrameLock=function(e,t,i){if(!t.lock){var n=this._renderFrame(e,t,i);n&&(t.lock=n.then((function(){return t.lock=null}),(function(){return t.lock=null})))}return t.lock},t.prototype._renderFrame=function(e,t,i){var n=this;if("default"===e){if(this._segment.next()){var r=i?i.params:null;return t.params&&(r=this.webix.extend(r||{},t.params)),this._createSubView(t,this._segment.shift(r))}t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i.url,t.params&&(i.params=this.webix.extend(i.params||{},t.params))),t.route){if(null!==i)return t.route.show(i,t.view).then((function(){return n._createSubView(t,t.route)}));if(t.branch)return}var o=t.view;if(!o&&t.url){if("string"==typeof t.url)return t.route=new u(t.url,0),i&&t.route.setParams(t.route.route.url,i.params,0),t.params&&t.route.setParams(t.route.route.url,t.params,0),this._createSubView(t,t.route);"function"!=typeof t.url||o instanceof t.url||(o=new(this.app._override(t.url))(this.app,"")),o||(o=t.url)}if(o)return o.render(t,t.route||this._segment,this)},t.prototype._initError=function(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t.current()).then((function(n){return n.render(e,t,i)}))},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(a),p=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._ui=i.ui,n}return n(t,e),t.prototype.config=function(){return this._ui},t}(h),d=function(){function e(e,t,i){this.path="",this.app=i}return e.prototype.set=function(e,t){this.path=e;var i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})},e.prototype.get=function(){return this.path},e}(),_=!0,f=function(e){function t(t){var i=this,n=(t||{}).webix||window.webix;return t=n.extend({name:"App",version:"1.0",start:"/home"},t,!0),(i=e.call(this,n,t)||this).config=t,i.app=i.config.app,i.ready=Promise.resolve(),i._services={},i.webix.extend(i,i.webix.EventSystem),i}return n(t,e),t.prototype.getUrl=function(){return this._subSegment.suburl()},t.prototype.getUrlString=function(){return this._subSegment.toString()},t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.destructor=function(){this.getSubView().destructor(),e.prototype.destructor.call(this)},t.prototype.copyConfig=function(e,t,i){if((e instanceof a||"function"==typeof e&&e.prototype instanceof a)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);var n=e instanceof Array;for(var r in t=t||(n?[]:{}),e){var o=e[r];if("function"==typeof o&&o.prototype instanceof a&&(o={$subview:o}),!o||"object"!=typeof o||o instanceof this.webix.DataCollection||o instanceof RegExp||o instanceof Map)t[r]=o;else if(o instanceof Date)t[r]=new Date(o);else{var s=this.copyConfig(o,o instanceof Array?[]:{},i);null!==s&&(n?t.push(s):t[r]=s)}}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){var i=t.getAttribute("trigger");if(i)return this._forView(t,(function(e){return e.app.trigger(i)})),e.cancelBubble=!0,e.preventDefault();var n=t.getAttribute("route");if(n)return this._forView(t,(function(e){return e.show(n)})),e.cancelBubble=!0,e.preventDefault()}var r=t.parentNode;r&&this.clickHandler(e,r)},t.prototype.getRoot=function(){return this.getSubView().getRoot()},t.prototype.refresh=function(){var e=this;return this._subSegment?this.getSubView().refresh().then((function(t){return e.callEvent("app:route",[e.getUrl()]),t})):Promise.resolve(null)},t.prototype.loadView=function(e){var t=this,i=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(n="function"==typeof i?i(e):i[e])&&(e=n,n=null),n||("_hidden"===e?n={hidden:!0}:"_blank"===e?n={}:(e=e.replace(/\./g,"/"),n=this.require("jet-views",e)))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n.then((function(e){return e.__esModule?e.default:e})).catch((function(i){return t._loadError(e,i)}))},t.prototype._forView=function(e,t){var i=this.webix.$$(e);i&&t(i.$scope)},t.prototype._loadViewDynamic=function(e){return null},t.prototype.createFromURL=function(e){var t=this;return e.isNew||!e.view?this.loadView(e.page).then((function(i){return t.createView(i,name,e.params)})):Promise.resolve(e.view)},t.prototype._override=function(e){var t=this.config.override;if(t){for(var i=void 0;e;)i=e,e=t.get(e);return i}return e},t.prototype.createView=function(e,i,n){if("function"==typeof(e=this._override(e))){if(e.prototype instanceof t)return new e({app:this,name:i,params:n,router:d});if(e.prototype instanceof a)return new e(this,{name:i,params:n});e=e(this)}return e instanceof a?e:new p(this,{name:i,ui:e})},t.prototype.show=function(e,t){return e&&this.app&&0==e.indexOf("//")?this.app.show(e.substr(1),t):this.render(this._container,e||this.config.start,t)},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)}),this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var n=t[i].message;0===n.indexOf("Module build failed")?(n=n.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+n+"</pre>"):(n+="<br><br>Check console for more details",this.webix.message({type:"error",text:n,expire:-1}))}},t.prototype.render=function(e,t,i){var n=this;this._container="string"==typeof e?this.webix.toNode(e):e||document.body;var r=null;this.$router?r="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(_&&"tagName"in this._container&&(this.webix.event(document.body,"click",(function(e){return n.clickHandler(e)})),_=!1),"string"==typeof t&&(t=new u(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);var o=i?i.params:this.config.params||null,a=this.getSubView(),s=this._subSegment,l=s.show({url:r,params:o},a).then((function(){return n.createFromURL(s.current())})).then((function(t){return t.render(e,s)})).then((function(e){return n.$router.set(s.route.path,{silent:!0}),n.callEvent("app:route",[n.getUrl()]),e}));return this.ready=this.ready.then((function(){return l})),l},t.prototype.getSubView=function(){if(this._subSegment){var e=this._subSegment.current().view;if(e)return e}return new h(this,{})},t.prototype.require=function(e,t){return null},t.prototype._first_start=function(e){var t=this;if(this._segment=e,this.$router=new this.config.router((function(e){return setTimeout((function(){t.show(e).catch((function(e){if(!(e instanceof o))throw e}))}),1)}),this.config,this),this._container===document.body&&!1!==this.config.animation){var i=this._container;this.webix.html.addCss(i,"webixappstart"),setTimeout((function(){t.webix.html.removeCss(i,"webixappstart"),t.webix.html.addCss(i,"webixapp")}),10)}if(e){if(this.app){var n=e.current().view;e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new u(this.config.start,0),e.current().view=n}}else{var r=this.$router.get();r||(r=this.config.start,this.$router.set(r,{silent:!0})),e=new u(r,0)}return e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[r]={id:t.id,url:n,branch:e.branch,popup:e.popup,params:e.params}).popup?null:t},t}(a),b=function(){function e(e,t){var i=this;this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=function(){return i.cb(i.get())}}return e.prototype.set=function(e,t){var i=this;if(this.config.routes){var n=e.split("?",2);for(var r in this.config.routes)if(this.config.routes[r]===n[0]){e=r+(n.length>1?"?"+n[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){var e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e.prototype._detectPrefix=function(){var e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]},e.prototype._getRaw=function(){return document.location.href},e}(),g=!1;function w(e){if(!g&&e){g=!0;var t=window;t.Promise||(t.Promise=e.promise);var i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){var i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});var n=e.ui.baselayout.prototype.addView,r=e.ui.baselayout.prototype.removeView,o={addView:function(e,t){if(this.$scope&&this.$scope.webixJet&&!e.queryView){var i=this.$scope,r={};e=i.app.copyConfig(e,{},r),n.apply(this,[e,t]);var o=function(e){i._renderFrame(e,r[e],null).then((function(){i._subs[e]=r[e]}))};for(var a in r)o(a);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var i in t){var n=t[i];e.$$(n.id)||(n.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,o,!0),e.extend(e.ui.baselayout.prototype,o,!0),e.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var i=e.uid().toString();t.body={id:i},this.$ready.push((function(){this.callEvent("onInit",[this.$app]),this.$app.render({id:i})}))}},e.ui.proxy,e.EventSystem)}}var A=function(e){function t(t){var i;return t.router=t.router||b,w((i=e.call(this,t)||this).webix),i}return n(t,e),t.prototype.require=function(e,t){return i(31163)(e+"/"+t)},t}(f),x=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n(t,e),t.prototype._detectPrefix=function(){this.prefix="",this.sufix=this.config.routerPrefix||""},t.prototype._getRaw=function(){return document.location.pathname+(document.location.search||"")}}(b),function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){return this.path},e}());function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e,t,i){for(var n in e)v(e,n)&&t.call(i||e,e[n],n,e)}function y(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var C=String.prototype.replace,k=String.prototype.split,S=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},B={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:S,chinese:function(){return 0},croatian:S,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:S,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},$={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function D(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var E=/\$/g,T=/%\{(.*?)\}/g;function L(e,t,i,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,o=n||T,a="number"==typeof t?{smart_count:t}:t;if(null!=a.smart_count&&r){var s=k.call(r,"||||");r=(s[function(e,t){return B[function(e){var t,i=(t={},m($,(function(e,i){m(e,(function(e){t[e]=i}))})),t);return i[e]||i[k.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",a.smart_count)]||s[0]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return C.call(r,o,(function(e,t){return v(a,t)&&null!=a[t]?C.call(a[t],E,"$$"):e}))}function I(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?L:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||y,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if("||||"===t||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(D(t)+"(.*?)"+D(i),"g")}(t.interpolation)}I.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},I.prototype.extend=function(e,t){m(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.extend(e,n):this.phrases[n]=e}),this)},I.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:m(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.unset(e,n):delete this.phrases[n]}),this)},I.prototype.clear=function(){this.phrases={}},I.prototype.replace=function(e){this.clear(),this.extend(e)},I.prototype.t=function(e,t){var i,n,r=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof r._?i=r._:this.onMissingKey?n=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),n=e),"string"==typeof i&&(n=L(i,r,this.currentLocale,this.tokenRegex)),n},I.prototype.has=function(e){return v(this.phrases,e)},I.transformPhrase=function(e,t,i){return L(e,t,i)};var q=I,P=window.webix;P&&w(P);var R=function(e,t,i){var n=(i=i||{}).storage,r=n?n.get("lang")||"en":i.lang||"en";function o(t,o,a){o.__esModule&&(o=o.default);var l={phrases:o};i.polyglot&&e.webix.extend(l,i.polyglot);var c=s.polyglot=new q(l);if(c.locale(t),s._=e.webix.bind(c.t,c),r=t,n&&n.put("lang",r),i.webix){var u=i.webix[t];u&&e.webix.i18n.setLocale(u)}return a?Promise.resolve():e.refresh()}function a(t,n){if(!1!==i.path){var r=(i.path?i.path+"/":"")+t;o(t,e.require("jet-locales",r),n)}}var s={getLang:function(){return r},setLang:a,setLangData:o,_:null,polyglot:null};e.setService("locale",s),a(r,!0)},M=window;M.Promise||(M.Promise=M.webix.promise);var F=1;function U(e,t,i){Object.defineProperty(t,i,{get:function(){return e[i]},set:function(t){return e[i]=t}})}function O(e,t){t=t||{};var i={},n={},r=function(e,t){var r=F++;return i[r]={mask:e,handler:t},t("*"===e?n:n[e],void 0,e),r},o=[],a=!1,s=function(e,t,n,r){if(a)o.push([e,t,n,r]);else for(var s=Object.keys(i),l=0;l<s.length;l++){var c=i[s[l]];c&&("*"!==c.mask&&c.mask!==e||c.handler(n,t,e,r))}};for(var l in e)if(e.hasOwnProperty(l)){var c=e[l];t.nested&&"object"==typeof c&&c?n[l]=O(c,t):V(n,c,l,s)}return Object.defineProperty(n,"$changes",{value:{attachEvent:r,detachEvent:function(e){delete i[e]}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$observe",{value:r,enumerable:!1,configurable:!1}),Object.defineProperty(n,"$batch",{value:function(e){if("function"!=typeof e){var t=e;e=function(){for(var e in t)n[e]=t[e]}}for(a=!0,e(n),a=!1;o.length;){var i=o.shift();s.apply(this,i)}},enumerable:!1,configurable:!1}),n}function V(e,t,i,n){Object.defineProperty(e,i,{get:function(){return t},set:function(e){if(null===t||null===e?t!==e:t.valueOf()!=e.valueOf()){var r=t;t=e,n(i,r,e,null)}},enumerable:!0,configurable:!1})}var H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"popup",point:!1,body:{view:"list",yCount:4,width:120,borderless:!0,data:[{id:"edit",value:t("Edit")},{id:"add-filter",value:t("Add Filter")},{id:"add-group",value:t("Add Group")},{id:"delete",value:t("Delete")}],click:function(t){e.app.callEvent("action",[t,e.Item]),e.Hide()}}}},t.prototype.Hide=function(){this.getRoot().hide()},t.prototype.Show=function(e,t){this.Item=t;var i=webix.html.offset(e);this.getRoot().show({x:i.x+i.width+webix.skin.$active.dataPadding,y:i.y-10})},t}(h),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.GetButton=function(){var e=this;return{view:"button",value:(0,this.app.getService("locale")._)("Add filter"),localId:"button",css:"webix_primary",click:function(){return e.Add(null,null)}}},t.prototype.GetList=function(){var e=this,t=this.app.getService("locale")._,i=this.getParam("simple")?"<span style='float:right' class='webix_icon action-close wxi-close'></span>":"<span style='float:right' class='webix_icon action-menu wxi-dots'></span>",n=t("and"),r=t("or"),o=function(e){return"and"==e.glue?n:r};return{view:"tree",borderless:!0,localId:"list",glue:"and",css:"wbq-query_list",scheme:{$serialize:function(e){if(e.group)return{group:e.group,glue:e.glue};var t={glue:e.glue,field:e.field,condition:e.condition};return e.includes&&e.includes.length&&(t.includes=e.includes),t},$init:function(e){e.group&&(e.$css="group",e.open=!0)}},type:{template:function(n){if(n.group){var r=e.DisableSwitch?"wbq-filter_join_disabled":"";return"<div class='wbq-filter_join wbq-filter_join_"+n.glue+" "+r+"'>"+o(n)+"</div>"}return e.Template(n,e.app.config.fields,i,t)+"<div class='wbq-filter_join wbq-filter_join_"+n.glue+"'>"+o(n)+"</div>"}},onClick:{"action-menu":function(e,t){this.$scope.Actions.Show(e.target,t)},"action-close":function(t,i){e.Delete(i)},"wbq-filter_join":function(t,i){e.SwitchGlue(i)}},on:{onItemDblClick:function(t){e.EditStart(t)}}}},t.prototype.init=function(){var e=this;this.Actions=this.ui(H),this.on(this.app,"applyFilter",(function(t){return e.EditStop(t)})),this.on(this.app,"action",(function(t,i){"delete"===t?e.Delete(i):"add-filter"===t?e.Add(null,i):"add-group"===t?e.AddGroup(null,i):"edit"===t&&webix.delay((function(){return e.EditStart(i)}))})),this.State=this.getParam("state"),this.on(this.State.$changes,"value",(function(t){e.LastValue=JSON.stringify(t),e.EditStop(),e.$$("list").clearAll(),t&&e.$$("list").parse(e.ConvertTo(t))}))},t.prototype.ConvertTo=function(e,t){var i=this;if(e.rules){var n=e.rules.map((function(t){return i.ConvertTo(t,e.glue)}));return t?{group:!0,glue:t,data:n}:n}return r(r({},e),{glue:t})},t.prototype.ConvertFrom=function(e,t){var i=this,n=t.getBranch(e),r=n.map((function(e){var n=e.id,r=e.field,o=e.type,a=e.condition,s=e.includes;return r?{field:r,type:o,condition:a,includes:s}:i.ConvertFrom(n,t)}));return r.length?{glue:n[0].glue,rules:r}:null},t.prototype.Add=function(e,t){this.EditStop(),e=e||{field:""};var i=this.$$("list"),n=t?i.getParentId(t):0,r=t?i.getBranchIndex(t)+1:-1;!t&&i.count()&&(t=i.getFirstId());var o=t?i.getItem(t).glue:i.config.glue;e.glue=o;var a=i.add(e,r,n);this.EditStart(a),this.CreateMode=!0},t.prototype.SwitchGlue=function(e){this.EditStop();for(var t=this.$$("list"),i=t.data.getBranch(t.getParentId(e)),n=0;n<i.length;n++)t.updateItem(i[n].id,{glue:"and"==i[n].glue?"or":"and"});this.Save()},t.prototype.AddGroup=function(e,t){this.EditStop(),e=e||{};var i=this.$$("list"),n=t?i.getParentId(t):0,r=t?i.getBranchIndex(t)+1:-1,o={id:webix.uid(),group:!0},a=t?i.getItem(t).glue:i.config.glue;o.glue=a,e.glue="and"==o.glue?"or":"and",this.DisableSwitch=!0,i.add(o,r,n);var s=i.add(e,null,o.id);this.EditStart(s),this.DisableSwitch=!1,this.CreateMode=!0},t.prototype.Delete=function(e){this.EditStop(),this.DeleteSilent(e),this.Save()},t.prototype.DeleteSilent=function(e){var t=this.$$("list");if(!t.exists(e))return null;var i=t.getParentId(e);t.remove(e);var n=t.data.branch[i];if(i&&!n)this.DeleteSilent(i);else if(1==n.length&&t.getItem(n[0]).group){var r=n[0];if(i){var o=t.getParentId(i),a=t.getBranchIndex(i,o);t.move(r,a,t,{parent:o}),this.DeleteSilent(i)}else{a=t.getBranchIndex(r,0);var s=[].concat(t.data.branch[r]);t.move(s,a,t,{parent:0}),this.DeleteSilent(r)}}},t.prototype.EditStop=function(e){if(this.Active){var t=this.$$("list");e?((e=e||this.Active.GetValue()).includes=e.includes||[],t.updateItem(this.ActiveId,r({},e))):this.CreateMode?this.DeleteSilent(this.ActiveId):t.refresh(this.ActiveId);var i=this.Active;this.Active=null,this.ActiveId=null,i.destructor(),this.Save()}},t.prototype.Save=function(){var e=this.ConvertFrom(0,this.$$("list").data),t=JSON.stringify(e);this.LastValue!==t&&(this.State.value=e)},t.prototype.Template=function(e,t,i,n){var r="&nbsp;",o=t.find((function(t){return t.id===e.field}))||{value:""};if(e.includes&&e.includes.length){r=n("in")+" ";for(var a=0;a<e.includes.length;a++)r+=(a>0?", ":"")+"<span class='wbq-field-value'>"+e.includes[a]+"</span>"}else e.condition&&e.condition.type&&(r=n(e.condition.type)+" <span class='wbq-field-value'>"+this.Format(e.condition.filter,o.format,o.type)+"</span>");return"<span class='wbq-field-box'><span class='wbq-field-name'>"+o.value+"</span> "+r+" </span>"+i},t.prototype.Format=function(e,t,i){if(!e)return"";if(e.start)e=this.Format(e.start,t,i)+(e.end?" - "+this.Format(e.end,t,i):"");else{var n=t||("date"==i?webix.i18n.dateFormatStr:null);n&&(e=n(e))}return e},t}(h),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{padding:10,margin:6,css:"webix_shadow_small",rows:[{view:"richselect",options:[],localId:"field",on:{onChange:function(){return e.AdjustToField()}}},{localId:"filter"},{type:"clean",cols:[{view:"button",value:t("Cancel"),width:100,click:function(){return e.Hide()}},{},{view:"button",value:t("Apply"),width:100,css:"webix_primary",click:function(){return e.ApplyFilter()}}]}]}},t.prototype.GetField=function(){var e=this.$$("field");return e.getList().getItem(e.getValue())},t.prototype.AdjustToField=function(){var e=this.GetField();this.CreateFilter(e.id,e.type,e.format,e.conditions,this.$$("filter"))},t.prototype.CreateFilter=function(e,t,i,n,r){var o={view:"filter",localId:"filter",conditions:n,field:e,mode:t,template:function(n){var r=n[e],o=i||("date"==t?webix.i18n.dateFormatStr:null);return o&&(r=o(r)),r},margin:6},a=webix.ui(o,r),s=this.app.getService("backend").data(e);return a.parse(s),a},t.prototype.ApplyFilter=function(){this.app.callEvent("applyFilter",[this.GetValue()])},t.prototype.GetValue=function(){var e=this.GetField(),t=r(r({},this.$$("filter").getValue()),{field:e.id,type:e.type});return""!=t.condition.filter||t.includes&&t.includes.length||(t=null),t},t.prototype.Hide=function(){this.app.callEvent("applyFilter",[null])},t.prototype.Show=function(e,t){var i=this.$$("field");i.getList().parse(t),e.field?i.setValue(e.field):i.setValue(t[0].id),this.$$("filter").setValue(webix.copy(e))},t}(h),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{view:"popup",point:!1,body:{$subview:j,name:"body"}}},t.prototype.Show=function(e,t,i){var n=this;setTimeout((function(){n.getRoot().show(i),n.getSubView("body").Show(e,t)}),100)},t}(h),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this.GetButton();e.width=100;var t=this.GetList();t.scroll=!1!==this.app.config.scroll?"x":"",t.borderless=!0,t.css="wbq-query_bar";var i=8,n=58;return("mini"==webix.skin.$name||"compact"==webix.skin.$name)&&(i=4,n=50),t.scroll&&(n+=webix.env.scrollSize),{view:"toolbar",paddingX:2*i,paddingY:i,height:n,borderless:!0,cols:[t,e]}},t.prototype.EditStart=function(e){var t=this;this.EditStop();var i=this.$$("list");this.ActiveId=e,this.Active=this.ui(N),this.Active.getRoot().attachEvent("onHide",(function(){t.Active&&t.EditStop()}));var n=webix.html.offset(i.getItemNode(e));this.Active.Show(i.getItem(e),this.app.config.fields,n),this.CreateMode=!1},t}(z),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{paddingX:16,paddingY:8,margin:0,rows:[this.GetButton(),this.GetList()]}},t.prototype.EditStart=function(e){var t=this;if(!this.ActiveId||this.ActiveId!=e){this.EditStop();var i=this.$$("list"),n=i.getItemNode(e);n.classList.add("active-editor"),n.innerHTML="",this.ActiveId=e,this.Active=this.ui(j,{container:n}),this.$$("list").attachEvent("onAfterRender",(function(){return t.EditStop()})),this.Active.Show(i.getItem(e),this.app.config.fields),this.CreateMode=!1}},t}(z),G={JetView:h};G.actions=H,G.bar=W,G.base=z,G.filter=j,G.list=Y,G.popup=N;var K=function(){function e(e){this._app=e}return e.prototype.data=function(e){var t=this._app.config.data;return"function"==typeof t?Promise.resolve(t(e)).then((function(t){return t.map((function(t){var i;return(i={})[e]=t,i}))})):Promise.resolve(t)},e.prototype.save=function(e){console.log(e)},e}();function Q(e,t,i){if(!e||!e.rules.length)return function(){return!0};var n=e.rules.map((function(e){return function(e,t,i){return e.rules?Q(e,t,i):function(n){var r=n[e.field];if(e.includes&&e.includes.length)return-1!==e.includes.findIndex((function(e){return e===r}));if(!webix.isUndefined(r)){var o=e.condition.type;return(t[o]||t[i[e.field]][o])(r,e.condition.filter)}return!1}}(e,t,i)}));return("or"===e.glue?J:X)(n)}function X(e){return function(t){for(var i=0;i<e.length;i++)if(!e[i](t))return!1;return!0}}function J(e){return function(t){for(var i=0;i<e.length;i++)if(e[i](t))return!0;return!1}}var Z=function(e){function t(t){var i=this,n=O({value:t.value||null}),o={router:x,version:"10.0.9",debug:!0};return(i=e.call(this,r(r({},o),t))||this).config.start="bar"===t.type?"/bar":"/list",i.config.params={state:n,simple:!0===t.simple},i.setService("backend",new(i.dynamic(K))(i)),i.use(R,i.config.locale||{lang:"en",webix:{en:"en-US"}}),i}return n(t,e),t.prototype.dynamic=function(e){return this.config.override&&this.config.override.get(e)||e},t.prototype.require=function(e,t){return"jet-views"===e?G[t]:"jet-locales"===e?te[t]:null},t.prototype.getState=function(){return this.config.params.state},t.prototype.GetFilter=function(){return function(e,t){var i=webix.filters,n={};return t.forEach((function(e){e.conditions&&e.conditions.forEach((function(e){"object"==typeof e&&(i[e.id]=e.handler)})),e.type&&(n[e.id]=e.type)})),Q(e,i,n)}(this.config.params.state.value,this.config.fields)},t}(A);webix.protoUI({name:"query",app:Z,getState:function(){return this.$app.getState()},getService:function(e){return this.$app.getService(e)},$init:function(){var e,t,i=this,n=this.getState();for(var r in n)U(n,this.config,r);n.$changes.attachEvent("value",(e=function(e,t){return i.callEvent("onChange",e,t)},t=!1,function(){if(t)return e.apply(this,arguments);t=!0}))},getFilterFunction:function(){return this.$app.GetFilter()}},webix.ui.jetapp);var ee={Backend:K},te={en:{"Add filter":"Add filter",in:"=",equal:"=",notEqual:"<>",less:"<",greater:">",greaterOrEqual:">=",lessOrEqual:"<=",contains:"contains",notContains:"not contains",beginsWith:"begins",notBeginsWith:"not begings",endsWith:"ends",notEndsWith:"not ends",between:"between",notBetween:"not between",and:"and",or:"or",Edit:"Edit","Add Filter":"Add Filter","Add Group":"Add Group",Delete:"Delete",Apply:"Apply",Cancel:"Cancel"}};e.App=Z,e.locales=te,e.services=ee,e.views=G,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof a?te(a):(r=[t],void 0===(o="function"==typeof(n=te)?n.apply(t,r):n)||(e.exports=o));var ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this;this.State=this.getParam("state",!0);var t=this.app.getService("local");return{view:"query",localId:"query",css:"webix_rpt_query",locale:{lang:this.app.getService("locale").getLang()},data:function(i){var n=e.State.fields.find((function(e){return e.id===i}));return"boolean"===n.type?[0,1]:t.getFieldData(i,n.type)},fields:this.State.fields.filter((function(e){return"reference"!==e.type&&"picklist"!==e.type})).map((function(e){var t={id:e.id,value:e.name+" "+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":""),type:e.type};return"boolean"===t.type&&(t.conditions=["equal"],t.type="number"),t}))}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0);var t=this.getRoot();this.on(this.State.$changes,"query",(function(e){t.$app.callEvent("applyFilter",[null]),t.config.value=e?se(JSON.parse(e)):null})),t.getState().$observe("value",(function(t){e.State.query=t?JSON.stringify(t):""}))},t}(g);function se(e){if(e.rules)e.rules.forEach(se);else if("date"===e.type){var t=e.condition;t.filter&&"string"==typeof e.condition.filter&&(t.filter=new Date(t.filter)),t.filter.start&&"string"==typeof t.filter.start&&(t.filter.start=new Date(t.filter.start)),t.filter.end&&"string"==typeof t.filter.end&&(t.filter.end=new Date(t.filter.end))}return e}var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;return{localId:"qblock",type:"clean",rows:[{type:"form",margin:5,padding:{bottom:5},rows:[{localId:"queryBar",visibleBatch:"def",cols:[{view:"label",label:t("Filtering query"),width:120},{},{batch:"query",view:"icon",localId:"delete",icon:"rpi-delete",tooltip:t("Delete"),click:function(){return e.DeleteQuery()}},{batch:"query",view:"icon",localId:"copy",icon:"rpi-content-copy",tooltip:t("Create copy"),click:function(){return e.CopyQuery()}},{batch:"query",view:"icon",localId:"rename",icon:"rpi-pencil",tooltip:t("Rename"),click:function(){return e.RenameQuery()}},{view:"button",disabled:!0,css:"webix_primary",localId:"save",label:t("Save"),tooltip:t("Save query"),width:150,click:function(){return e.SaveQuery(null)}}]},{view:"query-select",options:[],name:"id",css:"webix_rpt_qselect",localId:"qselect",suggest:{css:"webix_rpt_qselect_suggest",template:function(t){return e.QSelectTemplate(t)},body:{minHeight:25},on:{onShow:function(){this.getBody().$view.firstChild.getAttribute("placeholder")||this.getBody().$view.firstChild.setAttribute("placeholder",t("No saved queries"))}}},on:{onClearClick:function(){return e.NewQuery()}}},{autoheight:!0,borderless:!0,template:t("Save filter to use it in other reports"),css:"webix_rpt_description"}]},ae]}},t.prototype.init=function(){var e=this;this.Local=this.app.getService("local"),this.Operations=this.app.getService("operations");var t=this.State=this.getParam("state",!0),i=this.Queries=this.Local.getQueries();this.LocalState=K({id:"",saved:!0}),i.waitData.then((function(){var n,r=e.State.query,o=e.$$("qselect"),a=o.getList(),s=((n={})[e.State.data]=1,n);e.State.joins.forEach((function(e){return s[e.tid]=1})),i.filter((function(e){var t=!0;return e.models.forEach((function(e){s[e]||(t=!1)})),t})),a.sync(i),i.data.each((function(e){e.text==r&&o.setValue(e.id)})),e.on(t.$changes,"query",(function(t){var n=e.LocalState.id,r=!n&&t||n&&i.getItem(n).text!=t;e.LocalState.saved=!r}))})),ee(this.LocalState,"id",this.$$("qselect"),this);var n=this.$$("save");this.on(this.LocalState.$changes,"saved",(function(e){e?n.disable():n.enable()})),this.on(this.LocalState.$changes,"id",(function(t){if(t){var n=i.getItem(t);e.State.query=n.text,e.$$("queryBar").showBatch("query")}else e.$$("queryBar").showBatch("def")}))},t.prototype.NewQuery=function(){this.LocalState.id=null,this.LocalState.saved=!0,this.State.query=null},t.prototype.SaveQuery=function(e){var t=this,i=this.LocalState.id,n=this.State.query;if(i)return null===e&&(e=this.Queries.getItem(i).name),void this.Operations.updateQuery(i,{name:e,text:n}).then((function(){t.$$("qselect").setValue(i),t.LocalState.saved=!0}));oe({text:this._("Enter query name"),button:this._("Save"),value:""},this.app).then((function(e){e&&t.Operations.addQuery({name:e,text:n}).then((function(e){t.LocalState.saved=!0,t.LocalState.id=e}))}))},t.prototype.RenameQuery=function(){var e=this,t=this.LocalState.id,i=this.Queries.getItem(t).name;oe({text:this._("Enter query name"),value:i,button:this._("Save")},this.app).then((function(t){t&&e.SaveQuery(t)}))},t.prototype.CopyQuery=function(){var e=this,t=this.app.getService("locale")._,i=this.Queries.getItem(this.LocalState.id),n=i.name,r=i.text;n=t("Copy of")+" "+n,this.Operations.addQuery({name:n,text:r}).then((function(t){e.LocalState.id=t}))},t.prototype.DeleteQuery=function(){var e=this,t=this.app.getService("locale")._;webix.confirm({container:this.app.getRoot().$view,title:t("Delete"),ok:t("Delete"),cancel:t("Cancel"),text:t("Are you sure to delete this query?")}).then((function(){var t=e.LocalState.id;e.Operations.deleteQuery(t).then((function(){e.LocalState.$batch({saved:!0,id:null}),e.State.query=null}))}))},t.prototype.GetMenuOptions=function(){return[{id:"copy",value:"Copy",icon:"rpi-content-copy"},{id:"rename",value:"Rename",icon:"rpi-pencil"},{id:"delete",value:"Delete",icon:"rpi-delete"}]},t.prototype.GetMenuTemplate=function(e){return"<span class='webix_icon "+e.icon+"'></span>"+e.value},t.prototype.ApplyQueryAction=function(e){switch(this.QueryMenu.hide(),e){case"rename":this.RenameQuery();break;case"copy":this.CopyQuery();break;case"delete":this.DeleteQuery()}},t.prototype.QSelectTemplate=function(e){return e.value+" <span class='webix_icon wxi-close webix_rpt_qselect_icon'></span>"},t}(g),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i={optionWidth:102,tabMinWidth:102,view:"tabbar",localId:"tabbar",css:"webix_rpt_editor_tabbar",borderless:!0,options:[{id:"common",value:t("Common")},{id:"data",value:t("Query")},{id:"other",value:t("Data")},{id:"structure",value:t("View")}],on:{onChange:function(t){return e.ShowView(t)}}},n=webix.skin.$name;"flat"!=n&&"compact"!=n&&"contrast"!=n||(i.type="bottom");var r={width:490,hidden:!1,localId:"settings",rows:[{view:"toolbar",padding:{left:13,top:0,bottom:0},height:webix.skin.$active.barHeight+6,scroll:!1,cols:[i,{view:"icon",width:40,localId:"closeBtn",icon:"rpi-close",click:function(){return e.Hide()}}]},{$subview:!0}]};return this.Operations=this.app.getService("operations"),this.Local=this.app.getService("local"),this.Local.ready(r)},t.prototype.init=function(){var e=this;this.AppState=this.app.getParam("state");var t=this.Local.newModule();t.id=-1;var i=this.State=K(t);this.setParam("state",this.State),this.on(this.AppState.$changes,"moduleId",(function(t){return e.ChangeModule(t)})),this.on(this.State.$changes,"data",(function(t,i,n,r){!t||r&&r.load||e.ChangeModel(t)})),this.on(this.AppState.$changes,"toolbar",(function(t){return e.ShowHideButton(t)})),this.on(this.State.$changes,"*",function(e,t){t=t||200;var i=null,n=null;return function(){var r=this;n=arguments,i||(i=setTimeout((function(){clearTimeout(i),i=null,e.apply(r,n)}),t))}}((function(){-1!==e.State.id&&(e.TrackChanges(),e.AppState.module=Object.assign({},e.State))}))),this.on(i.$changes,"group",(function(t,n,r,o){if(!t&&n){var a=i.oldColumns||e.Local.getFields(i.data,i.joins,!0),s=webix.copy(a).filter((function(e){return"number"==e.type&&!e.key})),l=e.UpdateMeta(s,a);i.$batch({publicFields:null,columns:a,meta:l})}else if(t){var h=[];if(o&&o.load)h=u(e.State.columns);else if(n){if(JSON.stringify(t)==JSON.stringify(n))return;h=u(e.State.columns)}else i.oldColumns=i.columns;a=t.columns.map((function(e){return{id:e.op+"."+e.id,name:e.name,type:"number",meta:{},model:""}}));var p=webix.copy(a);t.by&&(a=a.concat(t.by.map((function(t){var i=e.State.fields.find((function(e){return e.id==t.id})),n=t.mod?t.mod+"."+t.id:t.id,r=c(c({},i),{id:n});return t.mod&&(r.type="text"),r}))));var d={};(i.publicFields||i.columns).forEach((function(e){return d[e.id]=1}));var _={};a.forEach((function(e){if(_[e.id]=1,d[e.id]){var t=h.find((function(t){return t.id==e.id}));t&&t.name!=e.name&&(t.name=e.name)}else h.push(e)})),h=h.filter((function(e){return _[e.id]})),(l=e.UpdateMeta(p,a)).freeze&&l.freeze>=h.length&&delete l.freeze,i.$batch({publicFields:a,columns:h,meta:l})}})),this.on(this.app,"saveModule",(function(){return e.Save()})),this.on(this.app,"resetModule",(function(){return e.Reset()})),this.on(this.app,"onColumnResize",(function(t,i){var n=u(e.State.columns);n.find((function(e){return e.id==t})).width=i,e.State.columns=n})),this.on(this.AppState.$changes,"readonly",(function(t){t&&e.Reset()})),this.show("./editor.common")},t.prototype.Save=function(){var e=this,t=this.Operations.getModuleSaveData(this.State),i={name:this.State.name,text:JSON.stringify(t)};this.AppState.moduleId?this.Operations.updateModule(this.AppState.moduleId,i).then((function(t){return e.SaveCallback(t)})):this.Operations.addModule(i).then((function(t){return e.SaveCallback(t)}))},t.prototype.SaveCallback=function(e){this.AppState.$batch({moduleId:e,mode:"view",module:Object.assign({},this.AppState.module),saved:!0})},t.prototype.ShowView=function(e){this.$$("tabbar").setValue(e),this.show("editor."+e)},t.prototype.Hide=function(){this.Reset()},t.prototype.Reset=function(){var e=this,t=this.AppState.moduleId;t?this.Local.getModule(t).then((function(t){e.AppState.$batch({mode:"view",module:Object.assign({},JSON.parse(t.text)),saved:!0})})):this.AppState.$batch({mode:"list",module:null,saved:!0})},t.prototype.ChangeModel=function(e){e&&this.State.$batch(this.Local.setDataSource(e))},t.prototype.ChangeModule=function(e){var t=this;this.InitStateValue="",e?this.Local.getModule(e).then((function(e){var i=JSON.parse(e.text);t.InitStateValue=e.text,t.InitName=i.name=e.name,i.id=e.id,i.saved=!0,i.fields=t.Local.getFields(i.data,i.joins),Y({load:!0},(function(){return t.State.$batch(i)})),t.AppState.saved=!0})):(this.InitStateValue=null,this.State.$batch(this.Local.newModule()),this.State.fields=this.Local.getFields(this.State.data,this.State.joins),this.AppState.saved=!1)},t.prototype.TrackChanges=function(){this.AppState.saved=JSON.stringify(this.Operations.getModuleSaveData(this.State))==this.InitStateValue&&this.State.name==this.InitName},t.prototype.ShowHideButton=function(e){e?this.$$("closeBtn").show():this.$$("closeBtn").hide()},t.prototype.UpdateMeta=function(e,t){var i=this.State.meta,n=this.State;return e.length&&("chart"==n.type?(e=e.map((function(e){var t=c(c({},e),{value:e.name});return delete t.name,t})),i.chart.series=this.app.getService("charts").getSeries(e,n.chartType)):"heatmap"==n.type&&(i.value=e[0].id,i.label=n.publicFields?t[t.length-1].id:t[0].id,i.color&&!e.find((function(e){return e.id==i.color}))&&(i.color=e[0].id))),i},t}(g),ue=function(e){function t(t,i){var n=e.call(this,t)||this;return n.Name=i,n}return l(t,e),t.prototype.config=function(){var e=this;return{view:"popup",body:{view:"list",css:"webix_rpt_popup_menu",width:160,autoheight:!0,template:function(t){return e.GetTemplate(t)},click:function(t){e.ClickHandler(t),e.getRoot().close()},data:this.GetOptions()}}},t.prototype.ClickHandler=function(e){this.getParentView().ApplyAction(e)},t.prototype.Show=function(e,t,i){this.SetActionStates(t,i),this.getRoot().show(e)},t.prototype.GetOptions=function(){return[{id:"delete",value:(0,this.app.getService("locale")._)("Delete"),icon:"rpi-delete"}]},t.prototype.SetActionStates=function(e){var t=this.getRoot().getBody();t.data.each((function(i){1==e.length?t.disableItem(i.id):t.enableItem(i.id)}))},t.prototype.GetTemplate=function(e){return"<span class='webix_icon "+e.icon+"'></span> "+e.value},t}(g),he=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r.State=i,r.ParentState=n,r}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;this.ValueSeparator=",";var i={margin:webix.skin.$active.layoutMargin.form,padding:{top:0,bottom:0,left:0,right:0},localId:"forms",view:"form",type:"clean",elements:[]},n={localId:"other",view:"form",type:"clean",borderless:!0,margin:webix.skin.$active.layoutMargin.form,cols:[{view:"text",name:"name",width:150,placeholder:t("Bucket name"),value:t("Other"),on:{onChange:function(t){return e.Changed("other","name",t)}}},{view:"label",css:"webix_rpt_subtitle",label:t("Other values")}],rules:{name:webix.rules.isNotEmpty}},r=webix.skin.$active.layoutPadding.form;return{borderless:!0,type:"clean",padding:{top:r,bottom:r,left:0,right:0},css:"webix_rpt_subview",rows:[i,{height:webix.skin.$active.layoutMargin.form},n,{height:webix.skin.$active.layoutMargin.form},{view:"button",icon:"wxi-plus",type:"icon",label:t("Add bucket"),inputWidth:210,align:"left",click:function(){return e.AddNewBucket()}}]}},t.prototype.init=function(){var e=this;this.Local=this.app.getService("local"),this.Forms=this.$$("forms"),this.GetRowKeys(this.State.id).then((function(t){e.Data=t.sort((function(t,i){return e.Sort(t,i)})),e.CreateForm()})),this.on(this.app,"onAction",(function(t,i,n){"bucket"==t&&"focus"==i&&n==e.State.id&&e.Focus(0)}))},t.prototype.GetRowKeys=function(e){if(e&&this.ParentState.columns.length){var t=[];return this.GetColumnData(e).then((function(i){var n=i[0],r=i[1];return n.forEach((function(i){var n=i[e];-1==t.indexOf(n)&&t.push(n)})),r?t.map((function(e){var t=r.data.find((function(t){return t.id==e}))||null;return{id:e,value:t?t.value:e}})):t.map((function(e){return{id:e,value:e}}))}))}return Promise.resolve([])},t.prototype.GetColumnData=function(e){var t=this.app.getParam("state"),i=this.Local.getDataConfig(t.module);i.columns=[e],delete i.buckets,delete i.group;var n=[this.Local.getData(i),this.Local.getOptionsList(e)];return Promise.all(n)},t.prototype.CreateForm=function(){var e=this,t=this.State.options;t&&t.length?this.LoadBuckets(t):this.AddNewBucket(),webix.delay((function(){e.app.callEvent("onAction",["bucket","resize",e.State.id]),e.Focus(0)}))},t.prototype.AddNewBucket=function(){this.AddBucket(),this.Changed(),this.Focus()},t.prototype.LoadBuckets=function(e){var t=this;e.forEach((function(e){e.values?t.AddBucket(e):t.LoadOther(e)})),this.Changed()},t.prototype.LoadOther=function(e){this.$$("other").setValues({name:e.id})},t.prototype.AddBucket=function(e){e=e||{},this.Forms.addView(this.GetRowForm(webix.uid(),e))},t.prototype.GetRowForm=function(e,t){var i=this,n=[{rows:[{width:150,view:"text",name:"name",value:t.id||null,placeholder:this._("Bucket name"),on:{onChange:function(t){return i.Changed(e,"name",t)}}}]},{view:"multicombo",name:"values",placeholder:this._("Bucket values"),css:"webix_multilist webix_rpt_multicombo",separator:this.ValueSeparator,suggest:{body:{css:"webix_multilist webix_rpt_bucket_values",data:this.Data,template:function(t){return i.OptionTemplate(e,t)}},on:{onBeforeShow:function(){this.getList().refresh()}}},value:t.values||null,on:{onChange:function(t){return i.Changed(e,"values",t)}}},{rows:[{view:"icon",icon:"wxi-dots",click:function(e,t){return i.ShowPopup(e,t)}}]}];return{view:"form",localId:e,type:"clean",borderless:!0,margin:webix.skin.$active.layoutMargin.form,rules:{name:webix.rules.isNotEmpty,values:webix.rules.isNotEmpty},cols:n}},t.prototype.ShowPopup=function(e,t){this.Popup&&this.Popup.$view||(this.Popup=this.ui(new ue(this.app,"bucket")));var i=webix.$$(e).getParentView().getParentView();this.ActiveForm=i,this.Popup.Show(t.target,this.GetValues(),i.getParentView().index(i))},t.prototype.GetValidBuckets=function(){var e=this,t=this.$$("other"),i=t.elements.name.getValue();t.validate();var n={};i&&(n[i]=[t]);var r=[];return this.ForEachFormRow((function(t){t.validate();var i=t.getValues(),o=i.name;o&&(n[o]?(e.$$(n[o]).forEach((function(e){return e.markInvalid("name",!0)})),t.markInvalid("name",!0)):i.values.length&&r.push({id:o,values:i.values.split(",")}),n[o]||(n[o]=[]),n[o].push(t))})),r.length&&i&&r.push({id:i}),r},t.prototype.Changed=function(e,t,i){"values"==t&&this.CorrectValues(e,i);var n=this.GetValidBuckets();this.State.options=n},t.prototype.OptionTemplate=function(e,t){var i=!t.$checked&&this.GetValues().find((function(i){return i.id!=e&&i.values.indexOf(t.value)>-1}));return"<div class='webix_rpt_bucket_value"+(i?" webix_rpt_bucket_value_selected":"")+"'>"+t.value+"</div>"+(i?"<span class='webix_rpt_bucket_icon webix_icon rpi-pail-outline'></span>":"")},t.prototype.GetValues=function(){var e=[];return this.ForEachFormRow((function(t){var i=t.getValues();i.id=t.config.localId,e.push(i)})),e},t.prototype.ForEachFormRow=function(e){this.Forms.getChildViews().forEach((function(t){t&&t.elements&&e(t)}))},t.prototype.CorrectValues=function(e,t){this.ForEachFormRow((function(i){if(i.config.localId!=e){var n=i.getValues().values.split(",");n=n.filter((function(e){return-1==t.indexOf(e)})),i.elements.values.setValue(n)}}))},t.prototype.ApplyAction=function(e){"delete"==e&&this.DeleteBucket(this.ActiveForm)},t.prototype.DeleteBucket=function(e){this.Forms.removeView(e),this.Changed()},t.prototype.Sort=function(e,t){var i=this,n=this.ParentState.fields.find((function(e){return e.id==i.State.id})).type;if(e=e.value,t=t.value,"number"==n){if(e*=1,t*=1,isNaN(t))return 1;if(isNaN(e))return-1}else{if(!t)return 1;if(!e)return-1;e=e.toString().toLowerCase(),t=t.toString().toLowerCase()}return e>t?1:e<t?-1:0},t.prototype.Focus=function(e){var t=this;webix.delay((function(){var i=t.Forms.getChildViews();void 0===e&&(e=i.length-1);var n=i[e];n&&n.elements.name.focus()}),null,null,100)},t}(g),pe=function(e){function t(t,i){var n=e.call(this,t)||this;return n.Master=i,n}return l(t,e),t.prototype.config=function(){var e=this;return{view:"popup",autoheight:!0,fitMaster:!0,body:{rows:[{padding:{top:5,bottom:5,left:10,right:10},cols:[{view:"text",localId:"search",placeholder:(0,this.app.getService("locale")._)("Search")}]},{view:"list",scroll:!0,yCount:5,autoheight:!0,select:!0,type:{template:function(t){return e.GetTemplate(t)}},on:{onItemClick:function(t){var i=e.List.getItem(t);e.AddColumn(i),e.View.hide()},onEnter:function(){var t=e.List.getSelectedItem();t&&(e.AddColumn(t),webix.delay((function(){return e.View.hide()})))}}}]}}},t.prototype.init=function(){var e=this;this.View=this.getRoot();var t=this.View.getBody().getChildViews();this.State=this.getParam("state",!0),this.BucketState=this.getParam("buckets",!0),this.Text=t[0].getChildViews()[0],this.List=t[1],this.Text.attachEvent("onTimedKeyPress",(function(){e.Find(e.Text.getValue())}))},t.prototype.AddColumn=function(e){var t=u(this.BucketState.buckets);t.push({column:e.id,options:[]}),this.BucketState.buckets=t},t.prototype.Show=function(e){e=e.firstChild.firstChild,this.View.config.width=e.offsetWidth-2,this.View.adjust(),this.View.show(e),this.Text.focus(),this.List.clearAll(),this.List.parse(this.GetColumns())},t.prototype.GetColumns=function(){var e=this,t=this.State.fields;return this.State.publicFields&&(t=t.filter((function(t){return e.State.publicFields.find((function(e){return e.id==t.id}))}))),t.map((function(t){return{id:t.id,value:t.name,type:t.type,model:t.model,disabled:e.BucketState.buckets&&e.BucketState.buckets.find((function(e){return e.column==t.id}))}}))},t.prototype.GetTemplate=function(e){return e.value+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")},t.prototype.Find=function(e){(e=e.toLowerCase())?this.List.filter((function(t){return t.value.toLowerCase().indexOf(e)>-1})):this.List.filter("")},t}(g);webix.protoUI({name:"groupselect",$cssName:"text webix_rpt_groupselect",defaults:{selectIcon:!0,modifiers:{}},renderModifier:function(e){var t=this._modifiers[e];if(t){var i=this.config.modifiers.find((function(e){return e.id===t}));return"<div class='webix_rpt_date_selector'>"+(i?i.value:"")+(this.config.selectIcon?"<span class='webix_icon wxi-angle-down'></span>":"")+"</div> <span class='webix_rpt_groupselect_sep'> | </span> "}return""},$renderTag:function(e,t,i,n){var r=this.renderModifier(n);return r+="<span>"+e+"</span><span class='webix_multicombo_delete webix_rpt_groupselect_delete' role='button' aria-label='"+webix.i18n.aria.removeItem+"'></span>","<li class='webix_multicombo_value' style='line-height:"+i+"px;' optvalue='"+webix.template.escape(n)+"'>"+r+"</li>"},$init:function(){this._modifiers={},webix.extend(this.on_click,{webix_rpt_date_selector:function(e,t,i){var n=webix.html.locate(e,"optvalue");return this.callEvent("onModifierClick",[n,e,i]),!1}})},setValue:function(e){var t=this;return e?("string"!=typeof e&&"string"!=typeof e[0]&&(this._modifiers={},e=e.map((function(e){return t._modifiers[e.id]=e.mod||null,e.id}))),webix.ui.multicombo.prototype.setValue.call(this,e)):this._modifiers={},webix.ui.multicombo.prototype.setValue.call(this,e)},getModifier:function(e){return this._modifiers[e]},setModifier:function(e,t,i){this._modifiers[e]=t,i||this.callEvent("onChange",[]),this.refresh()},$setSize:function(e,t){var i=this.config,n=this._custom_last_size||[0,0],r=n[0],o=n[1];if((e!=r||t!=o)&&(this._custom_last_size=[e,t],webix.ui.view.prototype.$setSize.call(this,e,t))){if(!e||!t)return;"top"==i.labelPosition&&(i.labelWidth=0),this.render()}}},webix.ui.multicombo);var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;this.Views={};var i={margin:5,rows:[{autoheight:!0,borderless:!0,template:t("Specify columns and their data buckets"),css:"webix_rpt_description"},{view:"button",icon:"wxi-plus",localId:"addColumn",label:t("Add column"),click:function(){return e.ShowColumns()}}]},n={view:"datatable",css:"webix_rpt_columns_list webix_rpt_bcols",localId:"table",borderless:!0,autoheight:!0,header:!1,select:!1,subview:function(t,i){var n=K({id:t.id,options:t.options});e.on(n.$changes,"*",N((function(){e.Update(t.id,n)})));var r=e.Views[t.id]=new he(e.app,n,e.State);return e.ui(r,{container:i}),r.getRoot()},columns:[{fillspace:!0,template:function(t,i){return e.RowTemplate(t,i)}}],on:{onItemClick:function(t){return e.ToggleSub(t)},onAfterRender:function(){if(e._hasFocus){var t=e._hasFocus;e._hasFocus=null,t&&document.contains(t)&&t!==document.activeElement&&t.focus()}},onSubViewOpen:function(t){return e.HideAllEditors(t)},onSubViewClose:function(){return e.ResetEditor()}},onClick:{webix_rpt_bucket_delete:function(i,n){return webix.confirm({title:t("Delete"),ok:t("Delete"),cancel:t("Cancel"),text:t("Are you sure to delete?")}).then((function(){return e.RemoveColumn(n)})),!1}}};return{view:"form",borderless:!0,padding:0,elements:[{margin:webix.skin.$active.layoutMargin.form,rows:[i,n]}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Table=this.$$("table");var t=this.State.buckets||[];this.BucketState=K({buckets:t,newColumn:null}),this.LoadBuckets(),this.setParam("buckets",this.BucketState),this.on(this.BucketState.$changes,"*",N((function(t,i){return e.Changed(t,i)}))),this.on(this.app,"onAction",(function(t,i,n){e.getRoot()&&"bucket"==t&&"resize"==i&&e.Table.refresh(n)}))},t.prototype.ShowColumns=function(){this.ColumnList&&this.ColumnList.$view||(this.ColumnList=this.ui(pe,this.State)),this.ColumnList.Show(this.$$("addColumn").$view)},t.prototype.LoadBuckets=function(){var e=this,t=this.BucketState.buckets?this.BucketState.buckets.map((function(t){var i=e.State.fields.find((function(e){return e.id==t.column}));return{id:t.column,name:i.name,model:i.model||null,options:t.options}})):[];this.Table.clearAll(),this.Table.parse(t),t.length||this.Table.hide()},t.prototype.AddColumn=function(e){this.Table.config.hidden&&this.Table.show();var t=this.State.fields.find((function(t){return t.id==e}));this.Table.add({id:e,name:t.name,model:t.model||null,options:[]})},t.prototype.RemoveColumn=function(e){this.Table.remove(e);var t=u(this.BucketState.buckets),i=t.findIndex((function(t){return t.column==e}));t.splice(i,1),this.BucketState.buckets=t,t.length||this.Table.hide(),this._ActiveEditor&&String(e)==String(this._ActiveEditor)&&this.ResetEditor(),this.Views[e].destructor()},t.prototype.ListTemplate=function(e){return e.value+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")},t.prototype.Changed=function(e,t){if(e.length>t.length){var i=e[e.length-1].column;this.AddColumn(i),this.Table.openSub(i)}var n=this.BucketState.buckets.filter((function(e){return e.options.length}));this.State.buckets=n},t.prototype.RowTemplate=function(e,t){return"<div class='webix_rpt_config_row'>\n\t\t\t<span class='webix_rpt_buckets_num'>\n\t\t\t\t<span class='webix_rpt_bucket_sublabel'>"+this._("buckets")+": </span>\n\t\t\t\t\t"+e.options.length+"\n\t\t\t\t</span>\n\t\t\t\t<div class='webix_rpt_config_row_name'>\n\t\t\t\t\t<span class='webix_rpt_bucket_sublabel'>"+this._("column")+": </span>\n\t\t\t\t\t"+e.name+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")+"\n\t\t\t\t</div>\n\t\t\t\t<span class='webix_icon rpi-delete webix_rpt_bucket_delete'></span>\n\t\t\t\t"+t.subrow(e,t)+"\n\t\t\n\t\t</div>"},t.prototype.HideAllEditors=function(e){var t=this._ActiveEditor;t&&this.Table.getItem(t)&&this.Table.closeSub(t),this._ActiveEditor=e,e&&this.FocusEditor()},t.prototype.FocusEditor=function(){this.app.callEvent("onAction",["bucket","focus",this._ActiveEditor])},t.prototype.ResetEditor=function(){this._ActiveEditor=null},t.prototype.ToggleSub=function(e){this.Table.getItem(e).$subopen?this.Table.closeSub(e):this.Table.openSub(e)},t.prototype.Update=function(e,t){this._hasFocus=document.activeElement;var i=u(this.BucketState.buckets),n=this.BucketState.buckets.find((function(t){return t.column==e}));n.options=t.options,this.BucketState.buckets=i,this.Table.updateItem(e,{options:n.options})},t}(g),_e=function(e){function t(t,i){var n=e.call(this,t)||this;return n.Master=i,n}return l(t,e),t.prototype.config=function(){var e=this;return{view:"popup",body:{view:"list",width:160,autoheight:!0,css:"webix_rpt_grouppopup",template:function(t){return e.GetPopupTemplate(t)},data:this.Master.config.modifiers,click:function(t){e.Master.setModifier(e.ActiveGroup,t),e.getRoot().hide()}}}},t.prototype.$init=function(){this.ActiveGroup=null},t.prototype.GetPopupTemplate=function(e){var t=e.id==this.Master.getModifier(this.ActiveGroup);return e.value+" <span class='webix_icon wxi-radiobox-"+(t?"marked":"blank")+"'></span>"},t.prototype.Show=function(e,t){this.ActiveGroup=t,this.getRoot().show(e,{x:-10}),this.getRoot().getBody().refresh()},t}(g),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i={margin:webix.skin.$active.layoutMargin.form,cols:[{view:"label",label:t("Function"),width:100,css:"webix_rpt_subtitle"},{view:"label",label:t("Column"),css:"webix_rpt_subtitle"},{view:"label",label:t("New column name"),css:"webix_rpt_subtitle"},{width:38}]},n={margin:webix.skin.$active.layoutMargin.form,localId:"summaries",view:"form",type:"clean",css:"webix_rpt_summary_form",elements:[]};return{borderless:!0,type:"clean",rows:[{cols:[{view:"label",label:t("Group summaries")}]},i,n,{height:webix.skin.$active.layoutMargin.form},{view:"button",icon:"wxi-plus",type:"icon",label:t("Add column"),width:210,align:"left",click:function(){return e.AddNewAggregation()}}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.GroupState=this.getParam("group",!0),this.SummaryColumns=this.State.fields.filter((function(e){return("number"==e.type||"date"==e.type)&&!e.key})).sort((function(e,t){return e.type<t.type?1:-1})).map((function(e){return{id:e.id,value:e.name,type:e.type}})),this.CreateForm(),this.on(this.GroupState.$changes,"by",(function(){return e.ValidateFormData()}))},t.prototype.CreateForm=function(){var e=this.GroupState.columns;e&&e.length?this.LoadAggregations(e):this.AddNewAggregation(),this.SummaryColumns.length||this.ApplyOneRowMode()},t.prototype.ApplyOneRowMode=function(){var e=this.getRoot().getChildViews();e[3].hide(),e[4].hide()},t.prototype.AddNewAggregation=function(){this.AddAggregation(),this.Changed()},t.prototype.LoadAggregations=function(e){var t=this;e.forEach((function(e){t.AddAggregation(e)})),this.Changed()},t.prototype.AddAggregation=function(e){if(!(e=e||this.GetDefaultFormData()))return!1;var t=e.id||"form"+webix.uid();this.$$("summaries").addView(this.GetRowForm(t,e))},t.prototype.GetRowForm=function(e,t){var i=this,n=[{width:100,view:"richselect",name:"op",value:t.op||null,options:this.GetOperations(),on:{onChange:function(t){return i.Changed(e,"op",t)}}},{view:"richselect",name:"id",disabled:"count"==t.op,value:t.id||null,options:this.SummaryColumns,on:{onChange:function(t){return i.Changed(e,"id",t)}}},{view:"text",value:t.name||null,name:"name",on:{onTimedKeypress:function(t){return i.Changed(e,"name",t)}}}];return n.push({view:"icon",icon:"wxi-dots",click:function(e,t){return i.ShowPopup(e,t)}}),{view:"form",localId:e,type:"clean",borderless:!0,margin:webix.skin.$active.layoutMargin.form,rules:{id:function(e){var t=i.GroupState.by;return!t||t.indexOf(e)<0}},cols:n}},t.prototype.GetDefaultFormData=function(){var e=this.GetData(),t=this.SummaryColumns,i=this.GetOperations();if(!t.length){var n=e.length?null:i.find((function(e){return"count"==e.id}));return n?{op:"count",id:"",name:this.NewColumnTemplate(n),type:"number"}:null}for(var r=0;r<i.length;r++)for(var o=function(n){var o=i[r];if(!e.find((function(e){return e.op==o.id&&("count"==o.id||e.id==t[n].id)})))return{value:{op:o.id,id:"count"!=o.id?t[n].id:null,name:a.NewColumnTemplate(o,t[n]),type:t[n].type}}},a=this,s=0;s<t.length;s++){var l=o(s);if("object"==typeof l)return l.value}return null},t.prototype.NewColumnTemplate=function(e,t){return"count"==e.id?e.value:e.value+" "+t.value},t.prototype.ShowPopup=function(e,t){this.Popup&&this.Popup.$view||(this.Popup=this.ui(new ue(this.app,"summary")));var i=webix.$$(e).getParentView();this.ActiveForm=i,this.Popup.Show(t.target,this.GetData(),i.getParentView().index(i))},t.prototype.ApplyAction=function(e){"delete"==e&&this.DeleteAggregation()},t.prototype.DeleteAggregation=function(e){var t=(e=e||this.ActiveForm).getParentView();t.getChildViews().length>1?t.removeView(e):e.setValues({}),this.Changed()},t.prototype.GetOperations=function(){var e=this.app.getService("locale")._;return[{id:"sum",value:e("Sum")},{id:"count",value:e("Count")},{id:"avg",value:e("Average")},{id:"max",value:e("Max")},{id:"min",value:e("Min")}]},t.prototype.GetData=function(){var e=[];return this.ForEachFormRow((function(t){e.push(t.getValues())})),e},t.prototype.ForEachFormRow=function(e){this.$$("summaries").getChildViews().forEach((function(t){t&&t.elements&&e(t)}))},t.prototype.ValidateFormData=function(){var e=!0;return this.ForEachFormRow((function(t){return e=t.validate()&&e})),e},t.prototype.ChangeNewColumnName=function(e){var t=this.$$(e).elements,i=t.op.getValue(),n=t.id.getValue(),r=this.GetOperations();i&&("count"==i?t.name.setValue(this.NewColumnTemplate(r.find((function(e){return e.id==i})))):n&&t.name.setValue(this.NewColumnTemplate(r.find((function(e){return e.id==i})),this.SummaryColumns.find((function(e){return e.id==n})))))},t.prototype.Changed=function(e,t,i){var n=this;"op"!=t&&"id"!=t||this.ChangeNewColumnName(e),"op"==t&&"count"==i?(this.$$(e).elements.id.setValue(null),this.$$(e).elements.id.disable()):e&&t&&this.$$(e).elements.id.enable(),this.ValidateFormData();var r=this.GetData();r.forEach((function(e){return e.type=(n.SummaryColumns.find((function(t){return t.id==e.id}))||{type:"number"}).type})),this.GroupState.columns=r},t}(g),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t={margin:5,rows:[{autoheight:!0,borderless:!0,template:(0,this.app.getService("locale")._)("Specify columns to group by and output(s)"),css:"webix_rpt_description"},{view:"groupselect",localId:"groupBy",modifiers:this.GetDateOptions(),options:[],on:{onChange:function(){return e.ChangeGroupBy()},onModifierClick:function(t,i,n){return e.ShowModifierPopup(t,i,n)}}}]};return{view:"form",borderless:!0,padding:0,elements:[{localId:"groupByLayout",margin:webix.skin.$active.layoutMargin.form,rows:[t,fe]}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0);var t=this.State.group||{};this.GroupState=K({by:t.by||null,columns:t.columns||null}),this.LoadColumns(),this.setParam("group",this.GroupState),this.on(this.GroupState.$changes,"*",N((function(){return e.Apply()})))},t.prototype.ChangeGroupBy=function(){var e=this.$$("groupBy"),t=e.getPopup().getList(),i=e.getValue();i=i?"string"==typeof i?i.split(","):i:[],this.GroupState.by=i.map((function(i){var n=e.getModifier(i);"date"!==t.getItem(i).type||n||(n="year",e.setModifier(i,n,!0));var r={id:i};return n&&(r.mod=n),r}))},t.prototype.FilterGroupByColumns=function(e){return"id"!=e.id},t.prototype.LoadColumns=function(){var e=this,t=this.State.fields.map((function(e){return{id:e.id,value:e.name,type:e.type,model:e.model}})),i=this.$$("groupBy").getPopup().getList();i.type.template=function(t){return e.ListTemplate(t)},i.parse(t),this.$$("groupBy").setValue(this.GroupState.by)},t.prototype.ListTemplate=function(e){return e.value+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")},t.prototype.ShowModifierPopup=function(e,t,i){var n=this;this.DatePopup||(this.DatePopup=this.ui(new _e(this.app,this.$$("groupBy")))),webix.delay((function(){return n.DatePopup.Show(i,e)}))},t.prototype.GetDateOptions=function(){var e=this.app.getService("locale")._;return[{id:"day",value:e("Day")},{id:"month",value:e("Month")},{id:"year",value:e("Year")},{id:"yearmonth",value:e("Year")+"/"+e("Month")},{id:"yearmonthday",value:e("Year")+"/"+e("Month")+"/"+e("Day")}]},t.prototype.Apply=function(){var e=this.GroupState;this.State.group={by:e.by||null,columns:e.columns||[]}},t}(g),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"scrollview",body:{type:"form",rows:[{cols:[{view:"switch",localId:"groupBySwitch",css:"webix_rpt_title",width:65,on:{onChange:function(t){return e.ToggleGroupBy(t)}}},{view:"label",label:t("Group")}]},{$subview:"_hidden",name:"group"},{cols:[{view:"switch",localId:"bucketsSwitch",css:"webix_rpt_title",width:65,on:{onChange:function(t){return e.ToggleBuckets(t)}}},{view:"label",label:t("Data buckets")}]},{$subview:"_hidden",name:"buckets"},{cols:[{view:"switch",localId:"sortBySwitch",css:"webix_rpt_title",width:65,on:{onChange:function(t){return e.ToggleSortBy(t)}}},{view:"label",label:t("Sort")}]},{$subview:"_hidden",name:"sort"},{gravity:1e-6}]}}},t.prototype.init=function(){this.State=this.getParam("state",!0),this.$$("groupBySwitch").setValue(!!this.State.group),this.$$("sortBySwitch").setValue(!!this.State.sort),this.$$("bucketsSwitch").setValue(!!this.State.buckets)},t.prototype.ToggleGroupBy=function(e){e?this.show("./editor.other.groups",{target:"group"}):(this.State.group=null,this.show("_hidden",{target:"group"}))},t.prototype.ToggleSortBy=function(e){e?this.show("./editor.other.sorts",{target:"sort"}):(this.State.sort=null,this.show("_hidden",{target:"sort"}))},t.prototype.ToggleBuckets=function(e){e?this.show("./editor.other.buckets",{target:"buckets"}):(this.State.buckets=null,this.show("_hidden",{target:"buckets"}))},t}(g),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this;return{rows:[{view:"label",label:(0,this.app.getService("locale")._)("Specify columns to sort by"),css:"webix_rpt_subtitle"},{view:"groupselect",localId:"sortBy",selectIcon:!1,css:"webix_rpt_sort_selector",modifiers:[{id:"asc",value:"<span class='webix_icon rpi-sort-alphabetical-ascending'></span>"},{id:"desc",value:"<span class='webix_icon rpi-sort-alphabetical-descending'></span>"}],options:[],on:{onChange:function(){return e.ChangeSortBy()},onModifierClick:function(t){return e.ChangeDirection(t)}}}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.on(this.State.$changes,"publicFields",(function(t){t&&e.LoadColumns()})),this.on(this.State.$changes,"fields",(function(){e.State.publicFields||e.LoadColumns()}))},t.prototype.LoadColumns=function(){var e=this,t=(this.State.publicFields||this.State.fields).map((function(e){return{id:e.id,value:e.name,type:e.type,model:e.model}})),i=this.$$("sortBy"),n=i.getPopup().getList();n.type.template=function(t){return e.ListTemplate(t)},n.clearAll(),n.parse(t);var r=this.State.sort;r&&(r=r.filter((function(e){return!!t.find((function(t){return t.id==e.id}))}))),i.setValue(r)},t.prototype.ListTemplate=function(e){return e.value+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")},t.prototype.ChangeSortBy=function(){var e=this.$$("sortBy"),t=e.getValue(),i=(t=t?"string"==typeof t?t.split(","):t:[]).map((function(t){var i=e.getModifier(t);i||(i="asc",e.setModifier(t,i,!0));var n={id:t};return i&&(n.mod=i),n}));this.State.sort=i.length?i:null},t.prototype.ChangeDirection=function(e){var t=this.$$("sortBy");t.setModifier(e,"asc"===t.getModifier(e)?"desc":"asc")},t}(g),Ae=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r.Axis=i,r.ChartState=n,r}return l(t,e),t.prototype.config=function(){var e=this.app.getService("locale")._;return this.Charts=this.app.getService("charts"),{view:"form",borderless:!0,elementsConfig:{labelAlign:"right",labelWidth:190},visibleBatch:"default",rows:[{label:e("Logarithmic scale"),view:"checkbox",name:"logarithmic",hidden:!0},{label:e("Title"),view:"text",name:"title"},{label:e("Color"),view:"colorpicker",name:"color",css:"webix_rpt_colorpicker",suggest:{padding:0,type:"colorselect",body:{button:!0}}},{cols:[{labelWidth:190,label:e("Gridlines"),view:"checkbox",name:"lines"},{view:"colorpicker",name:"lineColor",width:150,css:"webix_rpt_colorpicker",suggest:{padding:0,type:"colorselect",body:{button:!0}}}]},{label:e("Vertical labels"),view:"checkbox",name:"verticalLabels",hidden:!0}]}},t.prototype.init=function(){var e=this;this.on(this.Axis.$changes,"id",(function(t){"y"==t?e.ApplyYAxis():e.ApplyXAxis()})),this.on(this.Axis.$changes,"lines",(function(t){var i=e.getRoot().elements.lineColor;t?i.show():i.hide()})),ee(this.Axis,"*",this.getRoot())},t.prototype.ApplyYAxis=function(){this.getRoot().elements.logarithmic.show()},t.prototype.ApplyXAxis=function(){this.getRoot().elements.verticalLabels.show()},t}(g),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.HideField=function(e){this.$$("fields").updateItem(e,{show:!1}),this.SaveOrder()},t.prototype.ShowField=function(e){this.$$("fields").updateItem(e,{show:!0}),this.SaveOrder()},t.prototype.HideAllEditors=function(e,t){var i=this;t||(t="fields"),this._ActiveEditor[t]&&this.$$(t).closeSub(this._ActiveEditor[t]),this._ActiveEditor[t]=e,e&&webix.delay((function(){var n=i.$$(t).getSubView(e);n&&n.focus()}),null,null,100)},t.prototype.ResetEditor=function(e){this._ActiveEditor[e||"fields"]=null},t.prototype.ToggleSub=function(e,t){var i=this.$$(t||"fields");i.getItem(e).$subopen?i.closeSub(e):i.openSub(e)},t.prototype.SaveOrder=function(){},t}(g),ve=function(e){function t(t,i){var n=e.call(this,t)||this;return n.State=i,n.Id=null,n}return l(t,e),t.prototype.config=function(){var e=this;return{view:"popup",body:{view:"colorselect",button:!0,on:{onColorSelect:function(t){var i=e.GetSeries(e.Id);i&&(i.meta.color=t),e.State.updatedSeries=e.Id,e.getRoot().close()}}}}},t.prototype.Show=function(e,t){var i=this.getRoot();this.Id=t,i.show(e),i.getBody().setValue(this.GetSeries(t).meta.color)},t.prototype.GetSeries=function(e){return this.State.series.find((function(t){return t.id==e}))},t}(g);webix.protoUI({name:"text-search",$cssName:"search",defaults:{closeIcon:"wxi-close",template:function(e,t){var i=t.$renderInput(e);return(e.badge||0===e.badge)&&(i=i.replace(new RegExp("</div>$"),"<span class='webix_badge'>"+e.badge+"</span></div>")),i}},on_click:{webix_input_icon:function(e){var t=e.target.className;this.getInputNode().focus(),t.indexOf(this.config.closeIcon)>-1?(this.setValue(""),this.callEvent("onCloseIconClick",[e]),this.hideCloseIcon()):this.callEvent("onSearchIconClick",[e])}},$init:function(){var e=this;this.attachEvent("onTimedKeyPress",(function(){return e._onSearch()})),this.attachEvent("onChange",(function(){return e._onSearch()}))},_onSearch:function(){var e=this.getValue();e?this.showCloseIcon():this.hideCloseIcon(),this.callEvent("onSearchChange",[e])},setIcon:function(e){var t=this.$view.getElementsByClassName("webix_input_icon");t.length&&(t[0].className="webix_input_icon "+e)},showCloseIcon:function(){this.setIcon(this.config.closeIcon)},hideCloseIcon:function(){this.setIcon(this.config.icon)},setBadge:function(e){var t=this.$view.querySelector(".webix_badge");e||0===e?t?t.innerHTML=""+e:(t=webix.html.create("SPAN",{class:"webix_badge"},""+e),this.$view.querySelector(".webix_el_box").appendChild(t)):t&&webix.html.remove(t),this.config.badge=e}},webix.ui.search);var me=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r.Series=i,r.ChartState=n,r}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return this.Charts=this.app.getService("charts"),{view:"form",borderless:!0,elementsConfig:{labelWidth:170},visibleBatch:"default",rows:[{labelAlign:"right",label:t("Title"),view:"text",name:"name"},{labelAlign:"right",label:t("Color"),view:"colorpicker",name:"color",css:"webix_rpt_colorpicker",suggest:{padding:0,type:"colorselect",body:{button:!0}}},{labelAlign:"right",label:t("Marker type"),view:"richselect",css:"webix_rpt_markerselect",name:"markerType",options:{padding:0,body:{css:"webix_rpt_markerselect_list",template:function(t){return e.ItemListTemplate(t)},data:this.Charts.getItemTypes()}},batch:"marker"},{labelAlign:"right",label:t("Fill marker"),view:"checkbox",name:"fillMarker",batch:"marker"}]}},t.prototype.init=function(){var e=this;ee(this.Series,"*",this.getRoot()),this.Charts.itemSupport.indexOf(this.ChartState.chartType)>-1&&this.getRoot().showBatch("marker"),this.on(this.Series.$changes,"color",(function(){var t=e.getRoot().elements.markerType;t.refresh(),t.getList().refresh()}))},t.prototype.ItemListTemplate=function(e){return'<div class="webix_rpt_config_row">'+e.value+" <span class='webix_icon "+e.icon+"' style='color:"+this.Series.color+"'></span></div>"},t}(g),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;this.Charts=this.app.getService("charts"),this.Local=this.app.getService("local"),this._ActiveEditor={};var i={rows:[{view:"label",label:this._("Chart type")},{view:"richselect",localId:"type",options:this.Charts.getTypes(),on:{onChange:function(t){return e.ChartState.chartType=t}}}]},n={rows:[{view:"label",label:t("X axis column")},{view:"richselect",localId:"labelColumn",options:[],on:{onChange:function(t){return e.ChangeLabelField(t)}}}]},r={view:"datatable",css:"webix_rpt_columns_list",localId:"fields",borderless:!0,autoheight:!0,header:!1,select:!1,editable:!0,subview:function(t,i){e.SubState||(e.SubState={});var n=e.SubState[t.id]=K({name:t.meta.name,color:t.meta.color,type:t.meta.type||null,markerType:t.meta.markerType||null,fillMarker:t.meta.fillMarker||null});e.on(n.$changes,"*",N((function(){e.UpdateSeries(t.id,n)})));var r=new me(e.app,n,e.ChartState);return e.ui(r,{container:i}),r.getRoot()},columns:[{fillspace:!0,template:function(t,i){return e.RowTemplate(t,i)}}],drag:"order",on:{onItemDblClick:function(e){this.openSub(e)},onAfterRender:function(){if(e._hasFocus){var t=e._hasFocus;e._hasFocus=null,t&&document.contains(t)&&t!==document.activeElement&&t.focus()}},onAfterDrop:function(){return e.SaveOrder()},onSubViewOpen:function(t){return e.HideAllEditors(t)},"data->onClearAll":function(){return e.ResetEditor()},onSubViewClose:function(){return e.ResetEditor()}},onClick:{webix_rpt_chart_color:function(t,i){return e.ShowColorPopup(t,i)},"action-visible":function(t,i){return e.HideField(i)},"action-hidden":function(t,i){return e.ShowField(i)},webix_rpt_config_row_name:function(t,i){return e.ToggleSub(i)}}},o={rows:[{view:"label",label:t("Axes")},{view:"datatable",css:"webix_rpt_columns_list",localId:"axisFields",borderless:!0,autoheight:!0,header:!1,select:!1,subview:function(t,i){var n=K(c({id:t.id},t.meta));e.on(n.$changes,"*",N((function(){e.UpdateAxis(t.id,n)})));var r=new Ae(e.app,n,e.ChartState);return e.ui(r,{container:i}),r.getRoot()},columns:[{fillspace:!0,template:function(t,i){return e.AxisRowTemplate(t,i)}}],on:{onItemClick:function(t){return e.ToggleSub(t,"axisFields")},onAfterRender:function(){if(e._hasFocus){var t=e._hasFocus;e._hasFocus=null,t&&document.contains(t)&&t!==document.activeElement&&t.focus()}},onSubViewOpen:function(t){return e.HideAllEditors(t,"axisFields")},onSubViewClose:function(){return e.ResetEditor("axisFields")}}}]},a={rows:[{view:"label",label:t("Legend")},{view:"radio",localId:"legendPosition",options:[{id:"bottom",value:t("Bottom")},{id:"right",value:t("Right")},{id:"none",value:t("None")}],on:{onChange:function(t){return e.ChangeLegend(t)}}}]};return{view:"form",scroll:"auto",css:"webix_rpt_chart_config",padding:{top:webix.skin.$active.layoutPadding.toolbar},rows:[i,n,{localId:"dataInputs",rows:this.GetDataInputs()},r,o,a,{}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Types=this.Charts.getTypes();var t=[];(this.State.publicFields||this.State.fields).forEach((function(e){t.push(c({},e))})),this.Fields=t.filter((function(e){return!e.key})).sort((function(e,t){return e.type<t.type?1:-1})).map((function(e){return{id:e.id,value:e.name,type:e.type}})),this.ValueFields=t.filter((function(e){return"number"==e.type&&!e.key})).map((function(e){return{id:e.id,value:e.name,type:e.type,model:e.model}})),this.ChartState=K(this.GetInitState()),this.on(this.ChartState.$changes,"*",(function(){e.UpdateModuleState()})),this.on(this.ChartState.$changes,"chartType",(function(t,i){e.ApplyChartType(t,i)})),this.on(this.ChartState.$changes,"seriesFrom",(function(t,i){e.ApplySeriesFrom(t,i)})),this.on(this.ChartState.$changes,"baseColumn",N((function(){e.GenerateSeries()}))),this.on(this.ChartState.$changes,"dataColumn",N((function(){e.GenerateSeries()}))),this.on(this.ChartState.$changes,"updatedSeries",(function(t){t&&(e.$$("fields").refresh(t),e.SubState&&e.SubState[t]&&(e.SubState[t].color=e.ChartState.series.find((function(e){return e.id==t})).meta.color),e.ChartState.updatedSeries=null)})),this.$$("type").setValue(this.ChartState.chartType),this.$$("labelColumn").getList().parse(this.Fields),this.$$("labelColumn").setValue(this.ChartState.labelColumn),this.$$("seriesFrom").setValue(this.ChartState.seriesFrom),this.$$("baseColumn").getList().parse(this.Fields),this.$$("baseColumn").setValue(this.ChartState.baseColumn),this.$$("dataColumn").getList().parse(this.ValueFields),this.$$("dataColumn").setValue(this.ChartState.dataColumn),this.$$("legendPosition").setValue(this.ChartState.legendPosition)},t.prototype.ChangeLabelField=function(e){this.ChartState.labelColumn=e},t.prototype.ChangeLegend=function(e){this.ChartState.legendPosition=e},t.prototype.GetInitState=function(){var e=this.State.meta.chart||{};return{chartType:e.chartType||this.Charts.type,labelColumn:e.labelColumn||null,updatedSeries:null,seriesFrom:e.seriesFrom||"columns",baseColumn:e.baseColumn||null,dataColumn:e.dataColumn||null,series:e.series||null,legend:e.legend||{layout:"x"},axises:e.axises||null,legendPosition:e.legendPosition||"bottom"}},t.prototype.ApplyChartType=function(e,t){this.ShowAxisInputs(e),this.RenderSeries(t)},t.prototype.RenderSeries=function(e){var t=this.ChartState.series;t&&void 0===e?this.LoadSeries(t):this.GenerateSeries()},t.prototype.ShowAxisInputs=function(e){this.Charts.noAxisSupport.indexOf(e)?(this.ChartState.axises||(this.ChartState.axises={x:{title:"",color:"#edeff0",lineColor:"#edeff0",lines:!0,verticalLabels:!0},y:{title:"",color:"#edeff0",lineColor:"#edeff0",lines:!0,logarithmic:!1}}),this.$$("axisFields").data.count()||this.$$("axisFields").parse([{id:"x",meta:c({},this.ChartState.axises.x)},{id:"y",meta:c({},this.ChartState.axises.y)}])):(this.ChartState.axises=null,this.$$("axisFields").clearAll())},t.prototype.GetDataInputs=function(){var e=this;return[{rows:[{view:"label",label:this._("Data series")},{cols:[{rows:[{view:"label",label:this._("Extract series from"),css:"webix_rpt_subtitle"},{view:"radio",width:200,localId:"seriesFrom",options:[{id:"columns",value:this._("columns")},{id:"rows",value:this._("rows")}],on:{onChange:function(t){return e.ChartState.seriesFrom=t}}}]},{hidden:!0,localId:"baseColumnLayout",margin:webix.skin.$active.layoutMargin.form,cols:[{rows:[{view:"label",label:this._("Keys column"),css:"webix_rpt_subtitle"},{view:"richselect",css:"webix_rpt_subtitle",localId:"baseColumn",options:[],labelPosition:"top",on:{onChange:function(t){return e.ChartState.baseColumn=t}}}]},{rows:[{view:"label",label:this._("Values column"),css:"webix_rpt_subtitle"},{view:"richselect",css:"webix_rpdataColumnt_subtitle",localId:"dataColumn",options:[],on:{onChange:function(t){return e.ChartState.dataColumn=t}}}]}]}]}]}]},t.prototype.ApplySeriesKeys=function(e){var t=this.Charts.getSeries(e,this.ChartState.type);this.ChartState.series=t,this.LoadSeries(t)},t.prototype.LoadSeries=function(e){e.length?this.$$("fields").show():this.$$("fields").hide(),this.$$("fields").clearAll(),this.$$("fields").parse(e)},t.prototype.GetRowKeys=function(e){if(e&&this.State.columns.length){var t=[];return this.GetData(e).then((function(i){var n=i[0],r=i[1];return n.forEach((function(i){var n=i[e];-1==t.indexOf(n)&&t.push(n)})),r?t.map((function(e){var t=r.data.find((function(t){return t.id==e}))||null;return{id:e,value:t?t.value:e}})):t.map((function(e){return{id:e,value:e}}))}))}return Promise.resolve([])},t.prototype.GenerateSeries=function(){var e=this;if("columns"==this.ChartState.seriesFrom)this.ApplySeriesKeys(u(this.ValueFields),null);else{this.ChartState.dataColumn=this.$$("dataColumn").getValue();var t=this.ChartState.baseColumn=this.$$("baseColumn").getValue();this.GetRowKeys(t).then((function(i){return e.ApplySeriesKeys(i,t)}))}},t.prototype.ApplySeriesFrom=function(e,t){this.$$("baseColumnLayout")&&("columns"==e?(this.$$("baseColumnLayout").hide(),this.$$("baseColumn").setValue(null)):this.$$("baseColumnLayout").show(),t&&this.GenerateSeries())},t.prototype.UpdateSeries=function(e,t){this._hasFocus=document.activeElement;var i=u(this.ChartState.series),n=i.findIndex((function(t){return t.id==e}));Object.assign(i[n].meta,t),this.ChartState.series=i,this.$$("fields").refresh(e)},t.prototype.UpdateAxis=function(e,t){this._hasFocus=document.activeElement;var i=c({},this.ChartState.axises);Object.assign(i[e],t),this.ChartState.axises=i},t.prototype.RowTemplate=function(e,t){var i="<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>";return i+="<span class='webix_icon "+(e.show?"action-visible rpi-eye":"action-hidden rpi-eye-off-outline")+"'></span>",i+="<div class='webix_rpt_chart_color' style='background:"+e.meta.color+"'> </div>",i+="<div class='webix_rpt_config_row_name'>"+e.name+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")+"</div>",(i+=t.subrow(e,t))+"</div>"},t.prototype.GetData=function(e){var t=this.app.getParam("state"),i=this.Local.getDataConfig(t.module);i.columns=this.State.columns.map((function(e){return e.id}));var n=[this.Local.getData(i)];return e&&n.push(this.Local.getOptionsList(e)),Promise.all(n)},t.prototype.ShowColorPopup=function(e,t){this.ColorPopup&&this.ColorPopup.$view||(this.ColorPopup=this.ui(new ve(this.app,this.ChartState))),this.ActiveSeries=t,this.ColorPopup.Show(e.target,t)},t.prototype.SaveOrder=function(){var e=this,t=this.$$("fields"),i=[];t.data.each((function(t){t.show&&i.push((e.State.publicFields||e.State.fields).find((function(e){return e.id===t.id})))})),this.ChartState.series=t.serialize()},t.prototype.UpdateModuleState=function(){var e=this,t=this.ChartState,i=[];t.labelColumn&&this.AddColumn(i,t.labelColumn),"columns"==t.seriesFrom?t.series&&t.series.forEach((function(t){t.show&&e.AddColumn(i,t.id)})):(t.baseColumn&&this.AddColumn(i,t.baseColumn),t.dataColumn&&this.AddColumn(i,t.dataColumn)),this.State.$batch({columns:i,meta:c(c({},this.State.meta),{chart:this.ChartState})})},t.prototype.AddColumn=function(e,t){var i=(this.State.publicFields||this.State.fields).find((function(e){return e.id===t}));i&&e.push(i)},t.prototype.AxisRowTemplate=function(e,t){var i="<div class='webix_rpt_config_row'>"+this._("x"==e.id?"X Axis":"Y Axis");return(i+=t.subrow(e,t))+"</div>"},t}(xe),Ce=function(e){function t(t,i){var n=e.call(this,t)||this;return n.Column=i,n}return l(t,e),t.prototype.config=function(){var e=this.app.getService("locale")._;return{view:"form",borderless:!0,elementsConfig:{labelWidth:120},rows:[{labelAlign:"right",label:e("Title"),view:"text",name:"name"},{labelAlign:"right",label:e("Filter"),view:"richselect",name:"header",options:[{id:"none",value:e("No filter")},{id:"text",value:e("Text")},{id:"select",value:e("Select")}]}]}},t.prototype.init=function(){ee(this.Column,"*",this.getRoot())},t}(g),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this._=this.app.getService("locale")._,t={rows:[{view:"label",label:e("Labels column")},{view:"richselect",name:"label",options:[]}]},i={rows:[{view:"label",label:e("Values column")},{view:"richselect",name:"value",options:[]}]},n={rows:[{view:"label",label:e("Color column")},{view:"richselect",name:"color",options:[]}]};return{view:"form",scroll:!1,padding:{top:webix.skin.$active.layoutPadding.toolbar},rows:[i,t,n,{}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Local=this.app.getService("local");var t=this.Fields=(this.State.publicFields||this.State.fields).map((function(e){return c({},e)})),i=t.filter((function(e){return"number"==e.type&&!e.key}));i.length||(i=t.filter((function(e){return"number"==e.type})));var n=this.getRoot().elements,r=n.label;r.getList().parse(t),r.getList().type.template=function(t){return e.ListTemplate(t)},r.setValue(this.State.meta.label||t[0].id);var o=n.value;o.getList().parse(i),o.getList().type.template=function(t){return e.ListTemplate(t)},o.setValue(this.State.meta.value||i[0].id);var a=n.color;a.getList().parse(i),a.getList().type.template=function(t){return e.ListTemplate(t)},a.setValue(this.State.meta.color||i[0].id),this.getRoot().attachEvent("onChange",(function(){return e.OnChange()})),this.State.meta.value||this.OnChange()},t.prototype.OnChange=function(){this.Apply(c(c({},this.State.meta),this.getRoot().getValues()))},t.prototype.Apply=function(e){var t=[e.value,e.label,e.color],i=this.Fields.filter((function(e){return-1!==t.indexOf(e.id)}));this.State.$batch({meta:e,columns:i})},t.prototype.ListTemplate=function(e){return e.name+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")},t}(xe),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i={view:"richselect",localId:"select",borderless:!0,align:"left",inputWidth:170,options:[{id:"table",value:ie.table+" "+t("Table")},{id:"chart",value:ie.chart+" "+t("Chart")},{id:"heatmap",value:ie.heatmap+" "+t("Heatmap")}],on:{onChange:function(t){return e.ChangeReportType(t)}}},n={width:480,hidden:!1,localId:"settings",type:"clean",rows:[{view:"form",padding:{left:webix.skin.$active.layoutPadding.form,top:5,bottom:0},scroll:!1,cols:[i]},{$subview:!0}]};return this.Local=this.app.getService("local"),n},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.on(this.State.$changes,"type",(function(t){e.show("editor.structure."+t)})),this.$$("select").setValue(this.State.type)},t.prototype.ChangeReportType=function(e){this.State.type!=e&&this.State.$batch({type:e,meta:{}})},t}(g),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;this._ActiveEditor={};var i={padding:{top:webix.skin.$active.layoutPadding.toolbar},rows:[{view:"label",label:t("Columns")},{view:"text-search",localId:"search",on:{onSearchChange:function(){return e.FilterFields()}}}]},n={view:"datatable",css:"webix_rpt_columns_list",localId:"fields",borderless:!0,autoheight:!0,header:!1,select:!1,subview:function(t,i){var n=K({name:t.meta.name||t.name,header:t.meta.header||"none"});e.on(n.$changes,"*",N((function(){e.Update(t.id,n)})));var r=new Ce(e.app,n);return e.ui(r,{container:i}),r.getRoot()},columns:[{fillspace:!0,template:function(t,i){return e.RowTemplate(t,i)}}],drag:"order",on:{onItemDblClick:function(e){"$freeze"!==e.row&&this.openSub(e)},onBeforeDrag:function(t){e.HideAllEditors();var i=e.$$("fields");if(webix.html.addCss(i.$view,"webix_rpt_drag"),"$freeze"===t.start)t.html='<div class="webix_drag_zone"><div class="webix_dd_drag wbx-mark_frozen" style="width:'+i.$width+'px;"><div>'+e.FrozenTemplate()+"</div></div></div>";else if(!i.getItem(t.start).show)return!1},onAfterRender:function(){if(e._hasFocus){var t=e._hasFocus;e._hasFocus=null,t&&document.contains(t)&&t!==document.activeElement&&t.focus()}},onAfterDrop:function(){webix.html.removeCss(e.$$("fields").$view,"webix_rpt_drag"),e.SaveOrder()},onSubViewOpen:function(t){return e.HideAllEditors(t)},onSubViewClose:function(){return e.ResetEditor()}},onClick:{"action-visible":function(t,i){return e.HideField(i)},"action-hidden":function(t,i){return e.ShowField(i)},webix_rpt_config_row_name:function(t,i){return e.ToggleSub(i)}}};return{view:"form",scroll:"auto",padding:{top:webix.skin.$active.layoutPadding.toolbar},rows:[i,n]}},t.prototype.init=function(){this.State=this.getParam("state",!0);var e=this.$$("fields"),t={},i=this.State.columns.map((function(e){return t[e.id]=1,c(c({},e),{show:!0})}));(this.State.publicFields||this.State.fields).forEach((function(e){t[e.id]||i.push(c(c({},e),{show:!1}))})),i.splice(this.State.meta.freeze||0,0,{id:"$freeze",$css:"wbx-mark_frozen",name:this.FrozenTemplate()}),e.parse(i)},t.prototype.FilterFields=function(){var e=this.$$("search").getValue().toLowerCase();this.$$("fields").filter((function(t){return-1!==t.name.toLowerCase().indexOf(e)}))},t.prototype.Update=function(e,t){this._hasFocus=document.activeElement;var i=u(this.State.columns),n=i.findIndex((function(t){return t.id==e}));Object.assign(i[n].meta,t),this.State.$batch({columns:i,meta:c(c({},this.State.meta),{freeze:this.GetFreeze()})})},t.prototype.GetFreeze=function(){for(var e=this.$$("fields"),t=e.data.order,i=0,n=0;n<t.length&&"$freeze"!==t[n];n++)i+=e.getItem(t[n]).show?1:0;return i},t.prototype.SaveOrder=function(){var e=this,t=this.$$("fields"),i=[];t.data.each((function(t){t.show&&i.push((e.State.publicFields||e.State.fields).find((function(e){return e.id===t.id})))})),this.State.$batch({columns:i,meta:c(c({},this.State.meta),{freeze:this.GetFreeze()})})},t.prototype.FrozenTemplate=function(){return"<span class='webix_rpt_frozen webix_icon rpi-arrow-horizontal-lock'></span><span>"+this._("Frozen columns above")+"</span>"},t.prototype.RowTemplate=function(e,t){var i="<div class='webix_rpt_config_row'><div class='webix_icon rpi-drag-vertical'></div>";return i+="$freeze"!==e.id?"<span class='webix_icon "+(e.show?"action-visible rpi-eye":"action-hidden rpi-eye-off-outline")+"'></span>":"",i+="<div class='webix_rpt_config_row_name'>"+e.name+(e.model?"<span class='webix_rpt_sources_path'>"+e.model+"</span>":"")+"</div>",(i+="$freeze"!==e.id?t.subrow(e,t):"")+"</div>"},t}(xe),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this;return{css:"webix_rpt_empty",view:"template",borderless:!0,template:function(t){return e.GetTemplate(t)}}},t.prototype.init=function(){var e=this,t=this.app.getService("local").getModules();t.waitData.then((function(){var i=e.GetText(t.data.count());e.getRoot().setValues({text:i})}))},t.prototype.GetText=function(e){return(0,this.app.getService("locale")._)(e?"Select any report from the list":"Click 'New' button to add a new report")},t.prototype.GetSVG=function(){var e=webix.skin.$name;return ne["willow"==e||"dark"==e?"alt":"main"]},t.prototype.GetTemplate=function(e){return"<div class='webix_rpt_empty_placeholder'>"+(e.text||"")+"</div>"+this.GetSVG()},t}(g),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){return{rows:[J,{type:"wide",margin:5,cols:[{}]}]}},t.prototype.init=function(){this.State=this.getParam("state",!0),this.Local=this.app.getService("local")},t.prototype.ready=function(){var e=this,t=this.getRoot().getChildViews();this.Bar=t[0],this.Host=t[1],this.on(this.State.$changes,"module",(function(t){return e.Show(t)})),this.on(this.app,"exportModule",(function(t){return e.Export(t)}))},t.prototype.Show=function(e){var t=this,i=this.Host;if(e&&e.meta.value&&"heatmap"===e.type){var n=this.GetChartConfig(e);if(!n.view)return;this.Bar.show(),this.GetChartData(e).then((function(r){var o=r[0],a=r[1];n.data=t.FormatLabels(webix.copy(o),a),o.length&&e.meta.color&&(n.type.cssClass=t.CssFactory(o,e.meta.color)),webix.ui([n],i),t.Chart=i.getChildViews()[0]}))}else webix.ui([{template:" "}],i),this.Bar.hide(),this.Chart=null},t.prototype.GetChartConfig=function(e){var t=e.meta,i=e.columns,n={view:"treemap",css:"webix_rpt",value:function(e){return e[t.value]},tooltip:this.TooltipFactory(t,i),type:{}};return t.label&&(n.type.template=function(e){return e[t.label]}),n},t.prototype.GetChartData=function(e){return Promise.all([this.Local.getData(this.Local.getDataConfig(e),"edit"==this.State.mode),this.Local.getOptions(e.columns)])},t.prototype.CssFactory=function(e,t){for(var i=1/0,n=-1/0,r=0;r<e.length;r++){var o=e[r][t];o>n&&(n=1*o),o<i&&(i=1*o)}var a=(n-i)/4,s=[n-a,n-2*a,n-3*a,i];return function(e){for(var i=e[t],n=0;n<s.length;n++)if(i>=s[n])return"l"+n}},t.prototype.TooltipFactory=function(e,t){var i=t.find((function(t){return t.id===e.value})),n=t.find((function(t){return t.id===e.color}));if(!i||!n)return"";var r=[e.value,i.name];return e.color&&e.color!=e.value&&r.push(e.color,n.name),function(e){for(var t="",i=0;i<r.length;i+=2)t+=(i?", ":"")+r[i+1]+": "+e[r[i]];return t}},t.prototype.Export=function(e){this.Chart&&("png"==e?webix.toPNG(this.Chart):"pdf"==e&&webix.toPDF(this.Chart,{autowidth:!0,display:"image"}))},t.prototype.FormatLabels=function(e,t){var i=this.State.module.meta.label,n=i&&t.length?t.find((function(e){return e.field==i})):null;if(n)e.forEach((function(e){var t=n.data.find((function(t){return t.id==e[i]}));e[i]=t?t.value:e[i]}));else{var r=this.State.module.fields.find((function(e){return e.id==i}));r&&"date"==r.type&&e.forEach((function(e){e[i]=webix.i18n.dateFormatStr(new Date(e[i]))}))}return e},t}(g),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"popup",padding:0,point:!1,body:{view:"list",borderless:!0,css:"webix_rpt_popup_menu",template:function(e){return"<span class='webix_icon "+e.icon+"'></span>"+e.value},width:160,autoheight:!0,data:[{value:t("Edit"),id:"edit",icon:"rpi-square-edit-outline"},{value:t("Create copy"),id:"copy",icon:"rpi-content-copy"},{value:t("Delete"),id:"delete",icon:"rpi-delete"}],on:{onItemClick:function(t){e.app.callEvent("onMenuAction",[e.ID,t]),e.getRoot().hide()}}}}},t.prototype.init=function(){},t.prototype.Show=function(e,t){var i=this;this.ID=t,webix.delay((function(){i.getRoot()&&i.getRoot().show(e)}))},t}(g),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this._=this.app.getService("locale")._;return{width:320,type:"clean",rows:[{view:"form",height:webix.skin.$active.barHeight+6,padding:{left:10,right:10,top:5,bottom:5},margin:0,localId:"bar",cols:[{view:"label",label:t("Reports")},{},{view:"icon",localId:"nameSorting",icon:"rpi-sort-alphabetical-ascending",css:"webix_rpt_sort_icon webix_rpt_btn_active",icons:{asc:"rpi-sort-alphabetical-ascending",desc:"rpi-sort-alphabetical-descending"},click:function(){return e.Sort("name")}},{width:4},{view:"icon",localId:"updatedSorting",css:"webix_rpt_sort_icon",icon:"rpi-sort-calendar-descending",icons:{asc:"rpi-sort-calendar-ascending",desc:"rpi-sort-calendar-descending"},click:function(){return e.Sort("updated")}}]},{type:"clean",rows:[{view:"form",padding:{left:10,right:10,top:2,bottom:4},cols:[{view:"text-search",localId:"search",placeholder:t("Type to search")}]},{view:"list",localId:"list",scroll:!0,select:!0,css:"webix_rpt_list",type:{height:webix.skin.$active.rowHeight+24,template:function(t){return e.GetListTemplate(t)}},scheme:{$change:function(e){e.date&&"string"==typeof e.date&&(e.date=new Date(e.date))}},onClick:{webix_rpt_action_menu:function(t,i){return e.Menu.Show(t,i),!1}},onDblClick:{},on:{onAfterSelect:function(t){return e.LoadModule(t,null)},onItemDblClick:function(t){return e.LoadModule(t,"edit")}}}]}]}},t.prototype.init=function(){var e=this;this.State=this.getParam("state",!0),this.Menu=this.ui(Ee);var t=this.$$("list");t.$view.firstChild.setAttribute("placeholder",this._("No reports"));var i=this.app.getService("local").getModules();t.sync(i),i.waitData.then((function(){e.State.moduleId&&t.select(e.State.moduleId)})),this.on(this.State.$changes,"readonly",(function(){return e.$$("list").refresh()})),this.$$("search").attachEvent("onSearchChange",(function(t){return e.Find(t)})),this.Sorting={by:"name",dir:"asc"}},t.prototype.LoadModule=function(e,t){this.app.callEvent("loadModule",[e,t])},t.prototype.Hide=function(){this.app.callEvent("hideModuleList")},t.prototype.Find=function(){var e=this,t=this.$$("search").getValue(),i=this.$$("list");t?(t=t.toLowerCase(),i.filter((function(i){return e.SearchCompare(t,i)}))):i.filter()},t.prototype.SearchCompare=function(e,t){return t.name.toLowerCase().indexOf(e)>-1},t.prototype.GetListTemplate=function(e){var t=this.app.getService("locale")._,i="<div class='webix_rpt_list_block'>";return i+="<div class='webix_rpt_list_report_name'>"+ie[e.parsed.type]+" "+e.name+"</div>",i+="<div class='webix_rpt_list_report_date'>"+t("Last modified")+": "+webix.i18n.longDateFormatStr(e.updated||new Date)+"</div>",this.State.readonly||(i+="<span class='webix_icon webix_rpt_action_menu rpi-dots-vertical'></span>"),i+"</div>"},t.prototype.Sort=function(e){var t=this.Sorting,i=webix.copy(t);t.by==e?t.dir="desc"==t.dir?"asc":"desc":(t.by=e,t.dir="desc"),t.as="updated"==e?"date":"string",this.ChangeSortButtons(t,i),this.$$("list").sort(t)},t.prototype.ChangeSortButtons=function(e,t){var i=this.$$(e.by+"Sorting");if(this.webix.html.addCss(i.$view,"webix_rpt_btn_active"),i.config.icon=i.config.icons[e.dir],i.refresh(),e.by!=t.by){var n=this.$$(t.by+"Sorting");this.webix.html.removeCss(n.$view,"webix_rpt_btn_active")}},t}(g),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.GetData=function(){var e=this.app.getService("locale")._;return[{value:e("To Excel"),id:"excel"},{value:e("To CSV"),id:"csv"}]},t}(X),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"form",localId:"toolbar",height:webix.skin.$active.barHeight+6,hidden:!0,padding:{left:10,right:10,top:6,bottom:6},margin:10,cols:[{view:"button",type:"icon",width:140,label:t("Export"),icon:"rpi-export",click:function(t){return e.ShowExportPopup(t)}},{},{view:"text-search",localId:"search",placeholder:t("Type to search"),maxWidth:600,minWidth:200}]}},t.prototype.ready=function(){var e=this;this.State=this.getParam("state",!0),this.$$("search").attachEvent("onSearchChange",(function(t){return e.State.search=t})),this.on(this.app,"onRecordsSearch",(function(t,i){t?e.$$("search").setBadge(i.length):e.$$("search").setBadge(null)}))},t.prototype.ShowExportPopup=function(e){this.ExportMenu&&this.ExportMenu.$view||(this.ExportMenu=this.ui(Le));var t=webix.$$(e);this.ExportMenu.Show(t.$view)},t}(g),qe={number:"int",date:"date",text:"string",boolean:"number",picklist:"text",reference:"text"},Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){return{rows:[Ie,{type:"wide",margin:5,cols:[{}]}]}},t.prototype.init=function(){this.State=this.getParam("state",!0),this.LocalState=K({search:""}),this.setParam("state",this.LocalState),this.Local=this.app.getService("local")},t.prototype.ready=function(){var e=this,t=this.getRoot().getChildViews();this.Bar=t[0],this.Host=t[1],this.on(this.State.$changes,"module",(function(t){return e.Show(t)})),this.on(this.app,"exportModule",(function(t){return e.Export(t)})),this.on(this.LocalState.$changes,"search",(function(t){return e.Find(t)}))},t.prototype.Export=function(e){var t={ignore:{$selection:!0},plainOutput:!0,filterHTML:!0};this.Table&&("excel"==e?webix.toExcel(this.Table,t):"csv"==e&&webix.toCSV(this.Table,t))},t.prototype.Show=function(e){var t=this,i=this.Host;if(e&&e.columns.length&&"table"===e.type){var n=this.GetTableConfig(e);if(!n)return;this.Bar.show(),webix.ui([n],i);var r=this.Table=i.getChildViews()[0];this.GetTableData(e).then((function(e){var i=e[0],n=e[1];r.$destructed||(n.forEach((function(e){var i=e.field,n=e.data;t.IsBucketColumn(i)||r.getColumnConfig(i).collection.parse(n)})),r.parse(i))}))}else webix.ui([{}],i),this.Table=null,this.Bar.hide()},t.prototype.IsBucketColumn=function(e,t){return(t=t||this.State.module).buckets&&t.buckets.find((function(t){return t.column==e}))},t.prototype.GetTableConfig=function(e){var t=this,i=e.groups,n=e.columns,r=e.meta;if(!n)return null;var o=[],a=n.map((function(e){return"date"==e.type&&o.push(e.id),t.GetColumnConfig(e)})),s="edit"===this.State.mode,l={view:i?"treetable":"datatable",columns:a,resizeColumn:!!s&&{headerOnly:!0},leftSplit:r.freeze?r.freeze:0,css:s?"webix_header_border":"",on:{onColumnResize:function(e,i,n,r){return t.SetColWidth(e,i,n,r)}}};return o.length&&(l.scheme={$change:function(e){return o.forEach((function(t){return e[t]=new Date(e[t])}))}}),l},t.prototype.GetColumnConfig=function(e){var t={id:e.id,header:e.meta.header&&"none"!==e.meta.header?[e.meta.name||e.name,{content:"text"===e.meta.header?"textFilter":"richSelectFilter"}]:e.meta.name||e.name,type:e.type,sort:qe[e.type],width:e.width||200};if("date"===e.type&&(t.format=webix.i18n.dateFormatStr),"boolean"===e.type){var i=this.app.getService("locale")._;t.template=function(t){return 1==t[e.id]?i("True"):i("False")}}return"reference"!==e.type&&"picklist"!==e.type||this.IsBucketColumn(e.id)||(t.options=[]),t},t.prototype.SetColWidth=function(e,t,i,n){if(n){if("$selection"===e||"$subrow"===e){var r=this.Tbl;return r.blockEvent(),r.setColumnWidth(e,i),void r.unblockEvent()}this.app.callEvent("onColumnResize",[e,t])}},t.prototype.GetTableData=function(e){return Promise.all([this.Local.getData(this.Local.getDataConfig(e),"edit"==this.State.mode),this.Local.getOptions(e.columns)])},t.prototype.Find=function(e){var t=this.app.getService("helpers"),i=this.Table,n=[];if(i){if(i.clearCss("webix_rpt_found_record",!0),e){for(var r=t.hasNonDigits(e),o=new RegExp(t.wildToRegexp(e),"gi"),a=i.config.columns.filter((function(e){return!("$selection"===e.id||"$subrow"===e.id||r&&("number"===e.type||"date"===e.type))})),s=[],l=function(n){var r=a[n].type||"text",l=a[n].id;if("text"===r||"number"===r)s.push((function(e){return o.test(e[l])}));else if("reference"===r||"picklist"===r){var c=i.getColumnConfig(l).collection,u=t.findOptions(c,o);s.push(t.matchPerColumn(l,(function(e){return u[e]})))}else if("bool"===r)switch(e){case"true":s.push((function(e){return e[l]}));break;case"false":s.push((function(e){return!e[l]}))}else if("date"===r){var h=i.getColumnConfig(l).format;s.push((function(e){return o.test(h(e[l]))}))}},c=0;c<a.length;++c)l(c);var u=!1;n=i.find((function(e){for(var t=0;t<s.length;++t)if(s[t](e))return u||(u=!0,i.showItem(e.id)),i.addCss(e.id,"webix_rpt_found_record",!0),!0;return!1}))}i.refresh(),this.app.callEvent("onRecordsSearch",[e,n])}},t}(g);function Re(e){return{attachEvent:function(t,i){return webix.UIManager.addHotKey(t,i,e),{key:t,handler:i}},detachEvent:function(t){var i=t.key,n=t.handler;return webix.UIManager.removeHotKey(i,n,e)}}}var Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){var e=this,t=this.app,i=this.app.getService("locale")._;return{view:"toolbar",localId:"bar",padding:{left:10,right:10,top:6,bottom:6},margin:10,visibleBatch:"default",height:webix.skin.$active.barHeight+6,elements:[{localId:"defaultButtons",margin:10,width:300,cols:[{view:"toggle",type:"icon",label:i("All reports"),localId:"list",width:150,offIcon:"rpi-menu",onIcon:"rpi-menu-open",on:{onChange:function(){t.callEvent("showModules",[this.getValue()])}}},{view:"button",type:"icon",localId:"newBtn",icon:"rpi-plus",label:i("New"),click:function(){e.$$("bar").showBatch("edit"),t.callEvent("loadModule",[null,"edit"])}}]},{width:300,batch:"edit"},{view:"label",localId:"name",align:"center",label:""},{width:330,batch:"default"},{batch:"report",width:290,cols:[{},{view:"button",type:"icon",align:"right",css:"webix_primary",icon:"wxi-pencil",label:i("Edit"),width:140,click:function(){return t.callEvent("onMenuAction",[null,"edit"])}}]},{width:290,batch:"edit",margin:10,cols:[{view:"button",type:"icon",icon:"rpi-close",label:i("Cancel"),localId:"reset",click:function(){return t.callEvent("resetModule",[])}},{view:"button",css:"webix_primary",type:"icon",icon:"wxi-check",localId:"save",width:140,label:i("Save"),disabled:!0,click:function(){return t.callEvent("saveModule",[])}}]},{popup:!0,$subview:!0,name:"popup"}]}},t.prototype.init=function(){var e=this;this.State=this.app.getParam("state",!0),this.on(this.State.$changes,"module",(function(t){t?void 0!==t.name?e.$$("name").setValue(t.name):e.State.moduleId&&e.app.getService("local").getModule(e.State.moduleId).then((function(t){e.$$("name").setValue(t.name)})):e.$$("name").setValue("")})),this.on(this.State.$changes,"saved",(function(t){var i=e.$$("name").$view;t?(e.$$("save").disable(),i.classList.remove("webix_rpt_not_saved")):(e.$$("save").enable(),i.classList.add("webix_rpt_not_saved"))})),this.on(this.State.$changes,"mode",(function(){return e.SetVisibleButtons()})),this.on(this.State.$changes,"moduleId",(function(){return e.SetVisibleButtons()})),this.on(this.State.$changes,"readonly",(function(){return e.SetVisibleButtons()})),this.on(Re(),"ctrl+e",(function(){return e.app.callEvent("onMenuAction",[null,"edit"]),!1})),this.on(Re(),"ctrl+s",(function(){return e.app.callEvent("saveModule",[]),!1})),this.on(Re(),"ctrl+l",(function(){return e.app.callEvent("showModules",[!0]),!1}))},t.prototype.SetVisibleButtons=function(){var e=this.State.mode;"list"==e?this.$$("list").setValue(!0):this.$$("list").setValue(!1),"edit"==e?(this.$$("defaultButtons").hide(),this.$$("bar").showBatch("edit")):(this.$$("defaultButtons").show(),this.State.moduleId&&!this.State.readonly?this.$$("bar").showBatch("report"):this.$$("bar").showBatch("default"));var t=this.$$("newBtn");t&&(this.State.readonly?t.isVisible()&&t.hide():t.isVisible()||t.show())},t.prototype.TitleTemplate=function(e){return'<div class="rep_title">'+e.name+"</div>"},t}(g),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.config=function(){return{type:"wide",margin:5,css:"webix_reports",rows:[{$subview:!0,name:"top"},{type:"wide",margin:5,cols:[{$subview:!0,name:"left"},{$subview:!0,name:"right",css:"webix_rpt_right"}]}]}},t.prototype.init=function(){var e=this;this.State=this.app.getParam("state");var t=this.app.getService("locale")._;this.on(this.State.$changes,"toolbar",(function(t){e.show(t?"toolbar":"_hidden",{target:"top"})})),this.on(this.State.$changes,"mode",(function(t){"edit"===t?e.show("./editor",{target:"left"}):"list"===t?e.show("./modules",{target:"left"}):e.show("_hidden",{target:"left"})})),this.on(this.State.$changes,"moduleId",(function(t){t?e.app.getService("local").getModule(t).then((function(t){e.State.module=JSON.parse(t.text)})):e.State.module=null})),this.on(this.State.$changes,"module",(function(t){var i=(t?t.type:"empty")||"table";e.show("./"+i,{target:"right"})})),this.on(this.app,"loadModule",(function(t,i){return e.LoadModule(t,i)})),this.on(this.app,"onMenuAction",(function(i,n){!i&&e.State.moduleId&&(i=e.State.moduleId),i&&("edit"===n?e.LoadModule(i,"edit"):"delete"===n?webix.confirm({container:e.app.getRoot().$view,title:t("Delete report"),ok:t("Delete"),cancel:t("Cancel"),text:t("Are you sure to delete this report?")}).then((function(){e.app.getService("operations").deleteModule(i).then((function(){i==e.State.moduleId&&e.State.$batch({moduleId:null,mode:"list"})}))})):"copy"===n&&e.app.getService("operations").copyModule(i).then((function(t){e.State.$batch({moduleId:t,mode:"edit"})})))})),this.on(this.app,"showModules",(function(t){t?e.State.mode="list":"list"==e.State.mode&&(e.State.mode="view")}))},t.prototype.LoadModule=function(e,t){this.State.moduleId=e,t&&(this.State.mode=t)},t}(g),Ue={JetView:g};function Oe(e,t,i){var n=t.$width,r=t.$height;e.config._fillApp?e.define({width:n,height:r}):e.define({left:(n-e.$width)/2,top:(r-e.$height)/2}),i||e.resize()}function Ve(e,t){var i=t.getRoot();e.attachEvent("onHide",(function(){i.$destructed||(webix.html.removeCss(i.$view,"webix_win_inside"),i.enable())}));var n=t.attachEvent("view:resize",(function(){Oe(e,i)}));e.attachEvent("onDestruct",(function(){t.detachEvent(n)}))}Ue.chart=Z,Ue["common/export"]=X,Ue["common/toolbar"]=J,Ue["editor/common"]=re,Ue["editor/data"]=le,Ue.editor=ce,Ue["editor/other/bucket"]=he,Ue["editor/other/bucketpopup"]=pe,Ue["editor/other/buckets"]=de,Ue["editor/other/datepopup"]=_e,Ue["editor/other/groups"]=be,Ue["editor/other"]=ge,Ue["editor/other/sorts"]=we,Ue["editor/other/summary"]=fe,Ue["editor/other/summarypopup"]=ue,Ue["editor/query"]=ae,Ue["editor/structure/axis"]=Ae,Ue["editor/structure/baseview"]=xe,Ue["editor/structure/chart"]=ye,Ue["editor/structure/chartseries"]=me,Ue["editor/structure/colorpopup"]=ve,Ue["editor/structure/column"]=Ce,Ue["editor/structure/heatmap"]=ke,Ue["editor/structure"]=Se,Ue["editor/structure/table"]=Be,Ue.empty=$e,Ue.heatmap=De,Ue.menu=Ee,Ue.modules=Te,Ue["table/export"]=Le,Ue.table=Pe,Ue["table/toolbar"]=Ie,Ue.toolbar=Me,Ue.top=Fe;var He=function(){function e(e){this._app=e,this._fieldData=new Map,this._optionsData=new Map,this._data=new Map}return e.prototype.ready=function(e){return this.getModels().then((function(){return e}))},e.prototype.getModules=function(){if(!this._modules){this._modules=new webix.DataCollection({scheme:{$change:function(e){e.value=e.name,e.parsed=JSON.parse(e.text),"string"==typeof e.updated&&(e.updated=new Date(e.updated))},$sort:{by:"name",dir:"asc",as:"string"}}});var e=this._app.getService("backend").getModules().then((function(e){return e.filter((function(e){return e.text}))}));this._modules.parse(e)}return this._modules},e.prototype.getModule=function(e){var t=this;return this.getModules().waitData.then((function(){return t._modules.getItem(e)}))},e.prototype.getModels=function(e){var t=this;return e?this._models||{}:(this._models_async||(this._models_async=this._app.getService("backend").getModels().then((function(e){var i={};return Object.keys(e).forEach((function(t){e[t].data.forEach((function(e){if("reference"==e.type){i[t]||(i[t]=[]),i[e.ref]||(i[e.ref]=[]);var n=t+"/"+e.id+"//"+e.ref;i[t].push({sid:t,tid:e.ref,sf:e.id,id:n}),i[e.ref].push({sid:e.ref,tid:t,tf:e.id,id:n})}}))})),t._refs=i,t._models=e,e}))),this._models_async)},e.prototype.getRefs=function(){return this._refs},e.prototype.getModel=function(e){return this._models[e]},e.prototype.getFieldData=function(e,t){var i=e,n=this._fieldData.get(i);return n||(n=this._app.getService("backend").getFieldData(e).then((function(e){return"date"===t&&(e=e.map((function(e){return new Date(e)}))),e})),this._fieldData.set(i,n),n)},e.prototype.getFields=function(e,t,i){var n=this,r=this._models,o=[];return r[e].data.forEach((function(t){return o.push(n.newField(r[e],t))})),t.forEach((function(e){return r[e.tid].data.forEach((function(t){i&&!t.show||o.push(n.newField(r[e.tid],t))}))})),o},e.prototype.setDataSource=function(e){var t=this.getFields(e,[]);return{query:"",sort:null,fields:t,columns:u(t),oldColumns:null,group:null,joins:[],buckets:null}},e.prototype.newField=function(e,t){var i={id:e.id+"."+t.id,name:t.name,type:t.type,ref:t.ref,mid:e.id,model:e.name,meta:{}};return t.key&&(i.key=!0),i},e.prototype.newModule=function(e){var t=this._app.getService("locale")._;return{id:0,name:t("New report"),desc:t("Created on")+" "+webix.i18n.dateFormatStr(new Date),joins:[],query:"",sort:null,columns:[],fields:[],publicFields:null,group:null,buckets:null,meta:{},data:Object.keys(this._models)[0],type:e||"table"}},e.prototype.addJoin=function(e,t){var i=this,n=this._models[e],r=t.fields,o=t.columns,a=t.group;return n.data.forEach((function(e){r.push(i.newField(n,e)),e.show&&!a&&o.push(i.newField(n,e))})),{fields:r,columns:o}},e.prototype.getData=function(e,t){var i=JSON.stringify(e),n=this._data.get(i);return n||(t&&(e.limit=30,i=JSON.stringify(e),n=this._data.get(i))||(n=this._app.getService("backend").getData(e),this._data.set(i,n)),n)},e.prototype.getDataConfig=function(e){return{data:e.data,query:e.query,columns:e.columns.map((function(e){return e.id})).sort(),joins:e.joins,sort:e.sort,group:e.group&&e.group.by?e.group.by.map((function(e){return(e.mod?e.mod+".":"")+e.id})):"",buckets:e.buckets}},e.prototype.getOptions=function(e){var t=this,i=e.filter((function(e){return"picklist"===e.type||"reference"===e.type})).map((function(e){return t.getOptionsList(e.id)}));return Promise.all(i)},e.prototype.getOptionsList=function(e){var t=this._optionsData.get(e);return t||(t=this._app.getService("backend").getOptions(e),this._optionsData.set(e,t)),t.then((function(t){return{field:e,data:t}}))},e.prototype.getLinkedModels=function(e,t){for(var i=[],n=this.getRefs(),r=0;r<e.length;r++){var o=e[r];n[o]&&n[o].forEach((function(n){t&&-1!=e.indexOf(n.tid)||i.push(c({},n))}))}return i},e.prototype.cleanLinkedModels=function(e,t){var i,n,r=t.data,o=t.joins,a=t.fields,s=t.columns,l=t.query,c=t.group,u=t.publicFields,h=((i={})[r]=1,i),p=o,d=[];o=n=o.filter((function(t){return t.id!=e}));do{o=n,n=[];for(var _=0;_<o.length;_++)h[o[_].sid]?h[o[_].tid]=1:n.push(o[_])}while(n.length&&n.length!==o.length);var f=l?ze(JSON.parse(l)):[],b=function(e){var t=p[e];if(h[t.tid])d.push(t);else{if(-1!==f.indexOf(t.tid))return{value:{block:{filter:1}}};if(c){var i="."+t.tid+".";if(u.find((function(e){return-1!=e.id.indexOf(i)})))return{value:{block:{group:1}}}}s=s.filter((function(e){return e.mid!=t.tid})),a=a.filter((function(e){return e.mid!=t.tid}))}};for(_=0;_<p.length;_++){var g=b(_);if("object"==typeof g)return g.value}return{joins:d,columns:s,fields:a}},e.prototype.getQueries=function(){return this._queries?this._queries:this._queries=new webix.DataCollection({scheme:{$change:function(e){e.value=e.name,e.models=e.text?ze(JSON.parse(e.text)):[]}},data:this._app.getService("backend").getQueries()})},e}();function ze(e,t){return t=t||[],e.rules&&e.rules.forEach((function(e){if(e.rules)ze(e,t);else{var i=e.field.split(".");t.push(i[0])}})),t}var je=function(){function e(e){this.app=e,this._url=e.config.url}return e.prototype.getQueries=function(){return webix.ajax(this._url+"api/queries").then((function(e){return e.json()}))},e.prototype.addQuery=function(e){return webix.ajax().post(this._url+"api/queries",e).then((function(e){return e.json()}))},e.prototype.updateQuery=function(e,t){return webix.ajax().put(this._url+"api/queries/"+e,t).then((function(e){return e.json()}))},e.prototype.deleteQuery=function(e){return webix.ajax().del(this._url+"api/queries/"+e).then((function(e){return e.json()}))},e.prototype.getModules=function(){return webix.ajax(this._url+"api/modules").then((function(e){return e.json()}))},e.prototype.addModule=function(e){return webix.ajax().post(this._url+"api/modules",e).then((function(e){return e.json()}))},e.prototype.updateModule=function(e,t){return webix.ajax().put(this._url+"api/modules/"+e,t).then((function(e){return e.json()}))},e.prototype.deleteModule=function(e){return webix.ajax().del(this._url+"api/modules/"+e).then((function(e){return e.json()}))},e.prototype.getModels=function(){return webix.ajax(this._url+"api/objects").then((function(e){return e.json()}))},e.prototype.getData=function(e){var t=e.query,i=e.columns,n=e.joins,r=e.limit,o=e.group,a=e.sort,s=e.buckets;return webix.ajax().post(this._url+"api/objects/"+e.data+"/data",{query:t,columns:i,joins:n,limit:r,sort:a,group:o,buckets:s}).then((function(e){return e.json()}))},e.prototype.getOptions=function(e){return webix.ajax(this._url+"api/fields/"+e+"/options").then((function(e){return e.json()}))},e.prototype.getFieldData=function(e){return webix.ajax(this._url+"api/fields/"+e+"/suggest").then((function(e){return e.json()}))},e}(),Ne=function(){function e(e){this._app=e,this._local=e.getService("local"),this._back=e.getService("backend")}return e.prototype.deleteModule=function(e){var t=this;return this._back.deleteModule(e).then((function(){t._local.getModules().remove(e)}))},e.prototype.copyModule=function(e){var t=this._local.getModules().getItem(e),i=this._app.getService("locale")._;return this.addModule({name:i("Copy of")+" "+t.name,text:t.text})},e.prototype.addModule=function(e){var t=this;return this._back.addModule(e).then((function(i){return t._local.getModules().add(c({id:i.id},e)),i.id}))},e.prototype.updateModule=function(e,t){var i=this;return this._back.updateModule(e,t).then((function(n){return i._local.getModules().updateItem(e,t),n.id}))},e.prototype.getModuleSaveData=function(e){return{desc:e.desc,data:e.data,joins:e.joins,query:e.query,columns:e.columns,group:e.group,buckets:e.buckets,meta:e.meta,sort:e.sort,type:e.type}},e.prototype.addQuery=function(e){var t=this;return this._back.addQuery(e).then((function(i){return t._local.getQueries().add(c({id:i.id},e)),i.id}))},e.prototype.updateQuery=function(e,t){var i=this;return this._back.updateQuery(e,t).then((function(n){return i._local.getQueries().updateItem(e,t),n.id}))},e.prototype.deleteQuery=function(e){var t=this;return this._back.deleteQuery(e).then((function(){t._local.getQueries().remove(e)}))},e}(),We=function(){function e(){this.replacements=[{from:/(^ +)/g,to:""},{from:/(\w+)/g,to:"($&)"},{from:/^(\?)/g,to:"^\\S{1}"},{from:/(\?)/g,to:"\\S{1}"},{from:/(\*)/g,to:"\\S*"},{from:/( +)$/g,to:"$"}]}return e.prototype.wildToRegexp=function(e){for(var t=0;t<this.replacements.length;++t)e=e.replace(this.replacements[t].from,this.replacements[t].to);return e},e.prototype.matchPerColumn=function(e,t){return function(i){return t(i[e])}},e.prototype.findOptions=function(e,t){var i={};return e.find((function(e){return t.test(e.value)})).forEach((function(e){return i[e.id]=1})),i},e.prototype.hasNonDigits=function(e){return/\D/gi.test(e.replace(/[?*/. ]/g,""))},e}(),Ye=function(){function e(e){this._app=e,this.type="line",this.type="line",this.colors=["#FF9700","#4CB050","#00BCD4","#3F51B5","#9C28B1","#F34336","#FFEA3B","#009788","#2196F3","#673BB7","#EA1E63"],this.itemSupport=["line","spline","radar"],this.noAxisSupport=["pie","donut"],this.lineTypes=["line","spline"],this.multiTypeSupport=["bar","stackedBar","area","stackedArea","splineArea"],this.numLimit=30}return e.prototype.getTypes=function(){var e=this._app.getService("locale")._;return this.types||(this.types=[{id:"line",value:e("Line"),icon:"rpi-chart-line"},{id:"spline",value:e("Spline"),icon:"rpi-chart-bell-curve-cumulative"},{id:"area",value:e("Area"),icon:"rpi-chart-areaspline"},{id:"stackedArea",value:e("Stacked area"),icon:"rpi-chart-line-stacked"},{id:"splineArea",value:e("Spline area"),icon:"rpi-chart-areaspline-variant"},{id:"bar",value:e("Bar"),icon:"rpi-chart-bar"},{id:"stackedBar",value:e("Stacked bar"),icon:"rpi-chart-bar-stacked"},{id:"radar",value:e("Radar"),icon:"rpi-vector-triangle"}]),this.types},e.prototype.getItemTypes=function(){var e=this._app.getService("locale")._;return this.itemTypes||(this.itemTypes=[{id:"r",value:e("circle"),icon:"rpi-circle-outline"},{id:"s",value:e("square"),icon:"rpi-square-outline"},{id:"t",value:e("triangle"),icon:"rpi-triangle-outline"},{id:"d",value:e("diamond"),icon:"rpi-rhombus-outline"},{id:"no",value:e("no markers")}]),this.itemTypes},e.prototype.getSeries=function(e,t){var i=this,n=[],r=0;return e.forEach((function(e){var o={id:e.id,name:e.value,model:e.model||null,show:!0,meta:{name:e.value,color:i.colors[r]||i.colors[0]}};r++,-1!=i.itemSupport.indexOf(t)&&(o.meta.markerType="r",o.meta.fillMarker=!1),n.push(o)})),n},e}(),Ge=function(e){function t(t){var i=this,n=K({moduleId:t.moduleId||null,module:null,mode:t.mode||"list",toolbar:!1!==t.toolbar,saved:!0,readonly:t.readonly||!1}),r={router:S,debug:!0,start:"/top/empty",params:{state:n}};(i=e.call(this,c(c({},r),t))||this).config.debug&&(webix.Promise=window.Promise);var o,a,s,l=function(e){return i.config.override&&i.config.override.get(e)||e};return i.setService("local",new(l(He))(i)),i.setService("backend",new(l(je))(i)),i.setService("helpers",new(l(We))(i)),i.setService("charts",new(l(Ye))(i)),i.setService("operations",new(l(Ne))(i)),s={updateConfig:function(e){var t=o.getRoot(),i=t.$view;a?a&&!i.id&&(i.id=a):(i.id?a=i.id:i.id=a="webix_"+webix.uid(),webix.html.addStyle(".webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }"),webix.html.addStyle("#"+a+"{ position: relative; }"),webix.html.addStyle("#"+a+" .webix_window{ z-index:2 !important; }"),webix.html.addStyle("#"+a+" .webix_disabled{ z-index:1 !important; }")),e.container=a,e.fullscreen&&(e._fillApp=!0,delete e.fullscreen),e.on||(e.on={});var n=!0,r=e.on.onShow;return e.on.onShow=function(){var e=this;r&&r.apply(this,arguments),n&&(this.$setSize=function(i,n){Oe(e,t,!0),webix.ui.window.prototype.$setSize.apply(e,[i,n])},Ve(this,o),n=null),webix.callEvent("onClick",[]),webix.html.addCss(i,"webix_win_inside"),t.disable(),Oe(this,t)},e}},(o=i).setService("jet-win",s),i.use(H,i.config.locale||{lang:"en",webix:{en:"en-US"}}),i}return l(t,e),t.prototype.require=function(e,t){return"jet-views"===e?Ue[t]:"jet-locales"===e?Qe[t]:null},t.prototype.getState=function(){return this.config.params.state},t}(k);webix.protoUI({name:"reports",app:Ge,getState:function(){return this.$app.getState()},getService:function(e){return this.$app.getService(e)},$init:function(){var e=this.$app.getState();for(var t in e)G(e,this.config,t)}},webix.ui.jetapp);var Ke={Local:He,Backend:je,Helpers:We,Charts:Ye},Qe={en:{"Add column":"Add column","All reports":"All reports","Are you sure to delete this report?":"Are you sure to delete this report?","Are you sure to delete this query?":"Are you sure to delete this query?",Average:"Average",Cancel:"Cancel",Chart:"Chart",Column:"Column",Columns:"Columns",column:"column","Color column":"Color column",Common:"Common","Copy of":"Copy of",Count:"Count","Created on":"Created on",Data:"Data","Data source":"Data source",Day:"Day",Delete:"Delete","Delete report":"Delete report",Description:"Description",Query:"Query",Edit:"Edit","Enter query name":"Enter query name",Export:"Export","To Excel":"To Excel","To CSV":"To CSV","To PNG":"To PNG","To PDF":"To PDF",Filter:"Filter","Filtering query":"Filtering query","Frozen columns above":"Frozen columns above",Function:"Function",Group:"Group","Group summaries":"Group summaries","Join data":"Join data",Heatmap:"Heatmap","Labels column":"Labels column",Max:"Max",Min:"Min",Month:"Month",New:"New","Click 'New' button to add a new report":"Click 'New' button to add a new report","Select any report from the list":"Select any report from the list","No reports":"No reports","No saved queries":"No saved queries","Last modified":"Last modified","New column name":"New column name","New report":"New report","Please delete the related query filter first":"Please delete the related query filter first","Please delete the related group rule first":"Please delete the related group rule first",Rename:"Rename","Report name":"Report name",Reports:"Reports",Save:"Save","Save query":"Save query",Sort:"Sort","Specify columns to group by and output(s)":"Specify columns to group by and output(s)","Specify columns to sort by":"Specify columns to sort by",Sum:"Sum",Table:"Table",Title:"Title","Type to search":"Type to search",View:"View",Year:"Year",Axes:"Axes","X Axis":"X Axis","Y Axis":"Y Axis",columns:"columns",rows:"rows","Data series":"Data series","Chart type":"Chart type","Keys column":"Keys column","X axis column":"X axis column","Values column":"Values column",Color:"Color","Marker type":"Marker type","Fill marker":"Fill marker",Legend:"Legend","Logarithmic scale":"Logarithmic scale",Gridlines:"Gridlines",Bottom:"Bottom",None:"None",Right:"Right",Line:"Line",Spline:"Spline",Area:"Area","Stacked area":"Stacked area","Spline area":"Spline area",Bar:"Bar","Stacked bar":"Stacked bar",Radar:"Radar","Create copy":"Create copy",circle:"circle",square:"square",triangle:"triangle",diamond:"diamond","no markers":"no markers","Vertical labels":"Vertical labels","Extract series from":"Extract series from",True:"True",False:"False","Save filter to use it in other reports":"Save filter to use it in other reports","No filter":"No filter",Text:"Text",Select:"Select",buckets:"buckets","Data buckets":"Data buckets","Bucket name":"Bucket name","Bucket values":"Bucket values","Add bucket":"Add bucket","Specify columns and their data buckets":"Specify columns and their data buckets",Search:"Search",Other:"Other","Other values":"Other values","Are you sure to delete?":"Are you sure to delete?"}};a.App=Ge,a.locales=Qe,a.services=Ke,a.views=Ue,Object.defineProperty(a,"__esModule",{value:!0})}(t)},9934:function(e,t,i){!function(e){"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)};function n(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)n[r]=o[a];return n}var a=function(){},s=function(){function e(e,t){this.webixJet=!0,this.webix=e,this._events=[],this._subs={},this._data={},t&&t.params&&e.extend(this._data,t.params)}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){this._detachEvents(),this._destroySubs(),this._events=this._container=this.app=this._parent=this._root=null},e.prototype.setParam=function(e,t,i){if(this._data[e]!==t&&(this._data[e]=t,this._segment.update(e,t,0),i))return this.show(null)},e.prototype.getParam=function(e,t){var i=this._data[e];if(void 0!==i||!t)return i;var n=this.getParentView();return n?n.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._segment.suburl()},e.prototype.getUrlString=function(){return this._segment.toString()},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView((function(i){return(i.config.id===e||i.config.localId===e)&&i.$scope===t.$scope}),"self")}return e},e.prototype.on=function(e,t,i){var n=e.attachEvent(t,i);return this._events.push({obj:e,id:n}),n},e.prototype.contains=function(e){for(var t in this._subs){var i=this._subs[t].view;if(i===e||i.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:"_top"===e?(this._subs[e]={url:"",id:null,popup:!0},this.getSubViewInfo(e)):this._parent?this._parent.getSubViewInfo(e):null},e.prototype._detachEvents=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id)},e.prototype._destroySubs=function(){for(var e in this._subs){var t=this._subs[e].view;t&&t.destructor()}this._subs={}},e.prototype._init_url_data=function(){var e=this._segment.current();this._data={},this.webix.extend(this._data,e.params,!0)},e.prototype._getDefaultSub=function(){if(this._subs.default)return this._subs.default;for(var e in this._subs){var t=this._subs[e];if(!t.branch&&t.view&&"_top"!==e){var i=t.view._getDefaultSub();if(i)return i}}},e.prototype._routed_view=function(){var e=this.getParentView();if(!e)return!0;var t=e._getDefaultSub();return!(!t&&t!==this)&&e._routed_view()},e}();function l(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var r=t[n],o={},a=r.indexOf(":");if(-1===a&&(a=r.indexOf("?")),-1!==a)for(var s=0,l=r.substr(a+1).split(/[\:\?\&]/g);s<l.length;s++){var c=l[s].split("=");o[c[0]]=decodeURIComponent(c[1])}i[n]={page:a>-1?r.substr(0,a):r,params:o,isNew:!0}}return i}function c(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push("/"+r.page);var o=u(r.params);o&&t.push("?"+o)}return t.join("")}function u(e){var t=[];for(var i in e)"object"!=typeof e[i]&&(t.length&&t.push("&"),t.push(i+"="+encodeURIComponent(e[i])));return t.join("")}var h=function(){function e(e,t){this._next=1,this.route="string"==typeof e?{url:l(e),path:e}:e,this.index=t}return e.prototype.current=function(){return this.route.url[this.index]},e.prototype.next=function(){return this.route.url[this.index+this._next]},e.prototype.suburl=function(){return this.route.url.slice(this.index)},e.prototype.shift=function(t){var i=new e(this.route,this.index+this._next);return i.setParams(i.route.url,t,i.index),i},e.prototype.setParams=function(e,t,i){if(t){var n=e[i].params;for(var r in t)n[r]=t[r]}},e.prototype.refresh=function(){for(var e=this.route.url,t=this.index+1;t<e.length;t++)e[t].isNew=!0},e.prototype.toString=function(){var e=c(this.suburl());return e?e.substr(1):""},e.prototype._join=function(e,t){var i=this.route.url;if(null===e)return i;var n=this.route.url,r=!0;if(i=n.slice(0,this.index+(t?this._next:0)),e){i=i.concat(l(e));for(var o=0;o<i.length;o++)n[o]&&(i[o].view=n[o].view),r&&n[o]&&i[o].page===n[o].page?i[o].isNew=!1:i[o].isNew&&(r=!1)}return i},e.prototype.append=function(e){var t=this._join(e,!0);return this.route.path=c(t),this.route.url=t,this.route.path},e.prototype.show=function(e,t,i){var n=this,r=this._join(e.url,i);return this.setParams(r,e.params,this.index+(i?this._next:0)),new Promise((function(e,i){var o=c(r),s={url:r,redirect:o,confirm:Promise.resolve()},l=t?t.app:null;!l||l.callEvent("app:guard",[s.redirect,t,s])?s.confirm.catch((function(e){return i(e)})).then((function(){if(null!==s.redirect){if(s.redirect!==o)return l.show(s.redirect),void i(new a);n.route.path=o,n.route.url=r,e()}else i(new a)})):i(new a)}))},e.prototype.size=function(e){this._next=e},e.prototype.split=function(){var t={url:this.route.url.slice(this.index+1),path:""};return t.url.length&&(t.path=c(t.url)),new e(t,0)},e.prototype.update=function(e,t,i){var n=this.route.url[this.index+(i||0)];if(!n)return this.route.url.push({page:"",params:{}}),this.update(e,t,i);""===e?n.page=t:n.params[e]=t,this.route.path=c(this.route.url)},e}(),p=function(e){function t(t,i){var n=e.call(this,t.webix)||this;return n.app=t,n._children=[],n}return n(t,e),t.prototype.ui=function(e,t){var i=(t=t||{}).container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(i,this._segment,this),"object"!=typeof e||e instanceof s?n:n.getRoot()},t.prototype.show=function(e,t){if(t=t||{},"object"==typeof e){for(var i in e)this.setParam(i,e[i]);e=null}else{if("/"===e.substr(0,1))return this.app.show(e,t);if(0===e.indexOf("./")&&(e=e.substr(2)),0===e.indexOf("../")){var n=this.getParentView();return n?n.show(e.substr(3),t):this.app.show("/"+e.substr(3))}var r=this.getSubViewInfo(t.target);if(r){if(r.parent!==this)return r.parent.show(e,t);if(t.target&&"default"!==t.target)return this._renderFrameLock(t.target,r.subview,{url:e,params:t.params})}else if(e)return this.app.show("/"+e,t)}return this._show(this._segment,{url:e,params:t.params},this)},t.prototype._show=function(e,t,i){var n=this;return e.show(t,i,!0).then((function(){return n._init_url_data(),n._urlChange()})).then((function(){e.route.linkRouter&&(n.app.getRouter().set(e.route.path,{silent:!0}),n.app.callEvent("app:route",[e.route.path]))}))},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this._root&&(this._root.destructor(),e.prototype.destructor.call(this))},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){return this.getUrl(),this.destroy(),this._destroyKids(),this._destroySubs(),this._detachEvents(),this._container.tagName&&this._root.destructor(),this._segment.refresh(),this._render(this._segment)},t.prototype.render=function(e,t,i){var n=this;"string"==typeof t&&(t=new h(t,0)),this._segment=t,this._parent=i,this._init_url_data();var r="string"==typeof(e=e||document.body)?this.webix.toNode(e):e;return this._container!==r?(this._container=r,this._render(t)):this._urlChange().then((function(){return n.getRoot()}))},t.prototype._render=function(e){var t=this,i=this.config();return i.then?i.then((function(i){return t._render_final(i,e)})):this._render_final(i,e)},t.prototype._render_final=function(e,t){var i,n=this,r=null,o=null,a=!1;if(this._container.tagName?o=this._container:(r=this._container).popup?(o=document.body,a=!0):o=this.webix.$$(r.id),!this.app||!o)return Promise.reject(null);var s=this._segment.current(),l={ui:{}};this.app.copyConfig(e,l.ui,this._subs),this.app.callEvent("app:render",[this,t,l]),l.ui.$scope=this,!r&&s.isNew&&s.view&&s.view.destructor();try{if(r&&!a){var c=o,u=c.getParentView();u&&"multiview"===u.name&&!l.ui.id&&(l.ui.id=c.config.id)}this._root=this.app.webix.ui(l.ui,o);var h=this._root;a&&h.setPosition&&!h.isVisible()&&h.show(),r&&(r.view&&r.view!==this&&r.view!==this.app&&r.view.destructor(),r.id=this._root.config.id,this.getParentView()||!this.app.app?r.view=this:r.view=this.app),s.isNew&&(s.view=this,s.isNew=!1),i=Promise.resolve(this._init(this._root,t)).then((function(){return n._urlChange().then((function(){return n._initUrl=null,n.ready(n._root,t.suburl())}))}))}catch(e){i=Promise.reject(e)}return i.catch((function(e){return n._initError(n,e)}))},t.prototype._init=function(e,t){return this.init(e,t.suburl())},t.prototype._urlChange=function(){var e=this;this.app.callEvent("app:urlchange",[this,this._segment]);var t=[];for(var i in this._subs){var n=this._subs[i],r=this._renderFrameLock(i,n,null);r&&t.push(r)}return Promise.all(t).then((function(){return e.urlChange(e._root,e._segment.suburl())}))},t.prototype._renderFrameLock=function(e,t,i){if(!t.lock){var n=this._renderFrame(e,t,i);n&&(t.lock=n.then((function(){return t.lock=null}),(function(){return t.lock=null})))}return t.lock},t.prototype._renderFrame=function(e,t,i){var n=this;if("default"===e){if(this._segment.next()){var r=i?i.params:null;return t.params&&(r=this.webix.extend(r||{},t.params)),this._createSubView(t,this._segment.shift(r))}t.view&&t.popup&&(t.view.destructor(),t.view=null)}if(null!==i&&(t.url=i.url,t.params&&(i.params=this.webix.extend(i.params||{},t.params))),t.route){if(null!==i)return t.route.show(i,t.view).then((function(){return n._createSubView(t,t.route)}));if(t.branch)return}var o=t.view;if(!o&&t.url){if("string"==typeof t.url)return t.route=new h(t.url,0),i&&t.route.setParams(t.route.route.url,i.params,0),t.params&&t.route.setParams(t.route.route.url,t.params,0),this._createSubView(t,t.route);"function"!=typeof t.url||o instanceof t.url||(o=new(this.app._override(t.url))(this.app,"")),o||(o=t.url)}if(o)return o.render(t,t.route||this._segment,this)},t.prototype._initError=function(e,t){return this.app&&this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var i=this;return this.app.createFromURL(t.current()).then((function(n){return n.render(e,t,i)}))},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(s),d=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._ui=i.ui,n}return n(t,e),t.prototype.config=function(){return this._ui},t}(p),_=function(){function e(e,t,i){this.path="",this.app=i}return e.prototype.set=function(e,t){this.path=e;var i=this.app;i.app.getRouter().set(i._segment.append(this.path),{silent:!0})},e.prototype.get=function(){return this.path},e}(),f=!0,b=function(e){function t(t){var i=this,n=(t||{}).webix||window.webix;return t=n.extend({name:"App",version:"1.0",start:"/home"},t,!0),(i=e.call(this,n,t)||this).config=t,i.app=i.config.app,i.ready=Promise.resolve(),i._services={},i.webix.extend(i,i.webix.EventSystem),i}return n(t,e),t.prototype.getUrl=function(){return this._subSegment.suburl()},t.prototype.getUrlString=function(){return this._subSegment.toString()},t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.destructor=function(){this.getSubView().destructor(),e.prototype.destructor.call(this)},t.prototype.copyConfig=function(e,t,i){if((e instanceof s||"function"==typeof e&&e.prototype instanceof s)&&(e={$subview:e}),void 0!==e.$subview)return this.addSubView(e,t,i);var n=e instanceof Array;for(var r in t=t||(n?[]:{}),e){var o=e[r];if("function"==typeof o&&o.prototype instanceof s&&(o={$subview:o}),!o||"object"!=typeof o||o instanceof this.webix.DataCollection||o instanceof RegExp||o instanceof Map)t[r]=o;else if(o instanceof Date)t[r]=new Date(o);else{var a=this.copyConfig(o,o instanceof Array?[]:{},i);null!==a&&(n?t.push(a):t[r]=a)}}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e,t){if(e&&(t=t||e.target||e.srcElement)&&t.getAttribute){var i=t.getAttribute("trigger");if(i)return this._forView(t,(function(e){return e.app.trigger(i)})),e.cancelBubble=!0,e.preventDefault();var n=t.getAttribute("route");if(n)return this._forView(t,(function(e){return e.show(n)})),e.cancelBubble=!0,e.preventDefault()}var r=t.parentNode;r&&this.clickHandler(e,r)},t.prototype.getRoot=function(){return this.getSubView().getRoot()},t.prototype.refresh=function(){var e=this;return this._subSegment?this.getSubView().refresh().then((function(t){return e.callEvent("app:route",[e.getUrl()]),t})):Promise.resolve(null)},t.prototype.loadView=function(e){var t=this,i=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(n="function"==typeof i?i(e):i[e])&&(e=n,n=null),n||("_hidden"===e?n={hidden:!0}:"_blank"===e?n={}:(e=e.replace(/\./g,"/"),n=this.require("jet-views",e)))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n.then((function(e){return e.__esModule?e.default:e})).catch((function(i){return t._loadError(e,i)}))},t.prototype._forView=function(e,t){var i=this.webix.$$(e);i&&t(i.$scope)},t.prototype._loadViewDynamic=function(e){return null},t.prototype.createFromURL=function(e){var t=this;return e.isNew||!e.view?this.loadView(e.page).then((function(i){return t.createView(i,name,e.params)})):Promise.resolve(e.view)},t.prototype._override=function(e){var t=this.config.override;if(t){for(var i=void 0;e;)i=e,e=t.get(e);return i}return e},t.prototype.createView=function(e,i,n){if("function"==typeof(e=this._override(e))){if(e.prototype instanceof t)return new e({app:this,name:i,params:n,router:_});if(e.prototype instanceof s)return new e(this,{name:i,params:n});e=e(this)}return e instanceof s?e:new d(this,{name:i,ui:e})},t.prototype.show=function(e,t){return e&&this.app&&0==e.indexOf("//")?this.app.show(e.substr(1),t):this.render(this._container,e||this.config.start,t)},t.prototype.trigger=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.apply(e,t)}),this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var i=0;i<t.length;i++)if(console.error(t[i]),t[i]instanceof Error){var n=t[i].message;0===n.indexOf("Module build failed")?(n=n.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+n+"</pre>"):(n+="<br><br>Check console for more details",this.webix.message({type:"error",text:n,expire:-1}))}},t.prototype.render=function(e,t,i){var n=this;this._container="string"==typeof e?this.webix.toNode(e):e||document.body;var r=null;this.$router?r="string"==typeof t?t:this.app?t.split().route.path||this.config.start:t.toString():(f&&"tagName"in this._container&&(this.webix.event(document.body,"click",(function(e){return n.clickHandler(e)})),f=!1),"string"==typeof t&&(t=new h(t,0)),this._subSegment=this._first_start(t),this._subSegment.route.linkRouter=!0);var o=i?i.params:this.config.params||null,a=this.getSubView(),s=this._subSegment,l=s.show({url:r,params:o},a).then((function(){return n.createFromURL(s.current())})).then((function(t){return t.render(e,s)})).then((function(e){return n.$router.set(s.route.path,{silent:!0}),n.callEvent("app:route",[n.getUrl()]),e}));return this.ready=this.ready.then((function(){return l})),l},t.prototype.getSubView=function(){if(this._subSegment){var e=this._subSegment.current().view;if(e)return e}return new p(this,{})},t.prototype.require=function(e,t){return null},t.prototype._first_start=function(e){var t=this;if(this._segment=e,this.$router=new this.config.router((function(e){return setTimeout((function(){t.show(e).catch((function(e){if(!(e instanceof a))throw e}))}),1)}),this.config,this),this._container===document.body&&!1!==this.config.animation){var i=this._container;this.webix.html.addCss(i,"webixappstart"),setTimeout((function(){t.webix.html.removeCss(i,"webixappstart"),t.webix.html.addCss(i,"webixapp")}),10)}if(e){if(this.app){var n=e.current().view;e.current().view=this,e.next()?(e.refresh(),e=e.split()):e=new h(this.config.start,0),e.current().view=n}}else{var r=this.$router.get();r||(r=this.config.start,this.$router.set(r,{silent:!0})),e=new h(r,0)}return e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,i){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");return t.id=e.id||"s"+this.webix.uid(),(i[r]={id:t.id,url:n,branch:e.branch,popup:e.popup,params:e.params}).popup?null:t},t}(s),g=function(){function e(e,t){var i=this;this.config=t||{},this._detectPrefix(),this.cb=e,window.onpopstate=function(){return i.cb(i.get())}}return e.prototype.set=function(e,t){var i=this;if(this.config.routes){var n=e.split("?",2);for(var r in this.config.routes)if(this.config.routes[r]===n[0]){e=r+(n.length>1?"?"+n[1]:"");break}}this.get()!==e&&window.history.pushState(null,null,this.prefix+this.sufix+e),t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){var e=this._getRaw().replace(this.prefix,"").replace(this.sufix,"");if(e="/"!==e&&"#"!==e?e:"",this.config.routes){var t=e.split("?",2),i=this.config.routes[t[0]];i&&(e=i+(t.length>1?"?"+t[1]:""))}return e},e.prototype._detectPrefix=function(){var e=this.config.routerPrefix;this.sufix="#"+(void 0===e?"!":e),this.prefix=document.location.href.split("#",2)[0]},e.prototype._getRaw=function(){return document.location.href},e}(),w=!1;function A(e){if(!w&&e){w=!0;var t=window;t.Promise||(t.Promise=e.promise);var i=e.version.split(".");10*i[0]+1*i[1]<53&&(e.ui.freeze=function(t){var i=t();return i&&i.then?i.then((function(t){return e.ui.$freeze=!1,e.ui.resize(),t})):(e.ui.$freeze=!1,e.ui.resize()),i});var n=e.ui.baselayout.prototype.addView,r=e.ui.baselayout.prototype.removeView,o={addView:function(e,t){if(this.$scope&&this.$scope.webixJet&&!e.queryView){var i=this.$scope,r={};e=i.app.copyConfig(e,{},r),n.apply(this,[e,t]);var o=function(e){i._renderFrame(e,r[e],null).then((function(){i._subs[e]=r[e]}))};for(var a in r)o(a);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var t=this.$scope._subs;for(var i in t){var n=t[i];e.$$(n.id)||(n.view.destructor(),delete t[i])}}}};e.extend(e.ui.layout.prototype,o,!0),e.extend(e.ui.baselayout.prototype,o,!0),e.protoUI({name:"jetapp",$init:function(t){this.$app=new this.app(t);var i=e.uid().toString();t.body={id:i},this.$ready.push((function(){this.callEvent("onInit",[this.$app]),this.$app.render({id:i})}))}},e.ui.proxy,e.EventSystem)}}var x=function(e){function t(t){var i;return t.router=t.router||g,A((i=e.call(this,t)||this).webix),i}return n(t,e),t.prototype.require=function(e,t){return i(38509)(e+"/"+t)},t}(b),v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n(t,e),t.prototype._detectPrefix=function(){this.prefix="",this.sufix=this.config.routerPrefix||""},t.prototype._getRaw=function(){return document.location.pathname+(document.location.search||"")}}(g),function(){function e(e,t){this.path="",this.cb=e}return e.prototype.set=function(e,t){var i=this;this.path=e,t&&t.silent||setTimeout((function(){return i.cb(e)}),1)},e.prototype.get=function(){return this.path},e}());function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function y(e,t,i){for(var n in e)m(e,n)&&t.call(i||e,e[n],n,e)}function C(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}var k=String.prototype.replace,S=String.prototype.split,B=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},$={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:B,chinese:function(){return 0},croatian:B,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:B,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},D={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]};function E(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var T=/\$/g,L=/%\{(.*?)\}/g;function I(e,t,i,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var r=e,o=n||L,a="number"==typeof t?{smart_count:t}:t;if(null!=a.smart_count&&r){var s=S.call(r,"||||");r=(s[function(e,t){return $[function(e){var t,i=(t={},y(D,(function(e,i){y(e,(function(e){t[e]=i}))})),t);return i[e]||i[S.call(e,/-/,1)[0]]||i.en}(e)](t)}(i||"en",a.smart_count)]||s[0]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return k.call(r,o,(function(e,t){return m(a,t)&&null!=a[t]?k.call(a[t],T,"$$"):e}))}function q(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var i=t.allowMissing?I:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:i,this.warn=t.warn||C,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",i=e&&e.suffix||"}";if("||||"===t||"||||"===i)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(E(t)+"(.*?)"+E(i),"g")}(t.interpolation)}q.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},q.prototype.extend=function(e,t){y(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.extend(e,n):this.phrases[n]=e}),this)},q.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:y(e,(function(e,i){var n=t?t+"."+i:i;"object"==typeof e?this.unset(e,n):delete this.phrases[n]}),this)},q.prototype.clear=function(){this.phrases={}},q.prototype.replace=function(e){this.clear(),this.extend(e)},q.prototype.t=function(e,t){var i,n,r=null==t?{}:t;return"string"==typeof this.phrases[e]?i=this.phrases[e]:"string"==typeof r._?i=r._:this.onMissingKey?n=(0,this.onMissingKey)(e,r,this.currentLocale,this.tokenRegex):(this.warn('Missing translation for key: "'+e+'"'),n=e),"string"==typeof i&&(n=I(i,r,this.currentLocale,this.tokenRegex)),n},q.prototype.has=function(e){return m(this.phrases,e)},q.transformPhrase=function(e,t,i){return I(e,t,i)};var P=q,R=window.webix;R&&A(R);var M=function(e,t,i){var n=(i=i||{}).storage,r=n?n.get("lang")||"en":i.lang||"en";function o(t,o,a){o.__esModule&&(o=o.default);var l={phrases:o};i.polyglot&&e.webix.extend(l,i.polyglot);var c=s.polyglot=new P(l);if(c.locale(t),s._=e.webix.bind(c.t,c),r=t,n&&n.put("lang",r),i.webix){var u=i.webix[t];u&&e.webix.i18n.setLocale(u)}return a?Promise.resolve():e.refresh()}function a(t,n){if(!1!==i.path){var r=(i.path?i.path+"/":"")+t;o(t,e.require("jet-locales",r),n)}}var s={getLang:function(){return r},setLang:a,setLangData:o,_:null,polyglot:null};e.setService("locale",s),a(r,!0)},F=window;F.Promise||(F.Promise=F.webix.promise);var U=1;function O(e,t,i){Object.defineProperty(t,i,{get:function(){return e[i]},set:function(t){return e[i]=t}})}function V(e,t){t=t||{};var i={},n={},r=function(e,t){var r=U++;return i[r]={mask:e,handler:t},t("*"===e?n:n[e],void 0,e),r},o=[],a=!1,s=function(e,t,n,r){if(a)o.push([e,t,n,r]);else for(var s=Object.keys(i),l=0;l<s.length;l++){var c=i[s[l]];c&&("*"!==c.mask&&c.mask!==e||c.handler(n,t,e,r))}};return Object.defineProperty(n,"$changes",{value:{attachEvent:r,detachEvent:function(e){delete i[e]}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$observe",{value:r,enumerable:!1,configurable:!1}),Object.defineProperty(n,"$batch",{value:function(e){if("function"!=typeof e){var t=e;e=function(){for(var e in t)n[e]=t[e]}}for(a=!0,e(n),a=!1;o.length;){var i=o.shift();s.apply(this,i)}},enumerable:!1,configurable:!1}),Object.defineProperty(n,"$extend",{value:function(e,i){for(var r in i=i||t,e)if(e.hasOwnProperty(r)){var o=e[r];i.nested&&"object"==typeof o&&o?n[r]=V(o,i):H(n,o,r,s)}},enumerable:!1,configurable:!1}),n.$extend(e,t),n}function H(e,t,i,n){Object.defineProperty(e,i,{get:function(){return t},set:function(e){if(null===t||null===e?t!==e:t.valueOf()!=e.valueOf()){var r=t;t=e,n(i,r,e,null)}},enumerable:!0,configurable:!1})}var z=!1;function j(e,t,i){var n=t.$width,r=t.$height;e.config._fillApp?e.define({width:n,height:r}):e.define({left:(n-e.$width)/2,top:(r-e.$height)/2}),i||e.resize()}function N(e,t){var i=t.getRoot();e.attachEvent("onHide",(function(){i.$destructed||(webix.html.removeCss(i.$view,"webix_win_inside"),i.enable())}));var n=t.attachEvent("view:resize",(function(){j(e,i)}));e.attachEvent("onDestruct",(function(){t.detachEvent(n)}))}function W(e){var t=webix.promise.defer(),i=setInterval((function(){var n=e.$destructed;(n||e.isVisible())&&(n?t.reject():t.resolve(),clearInterval(i))}),300);return t}var Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=this.getParam("compact",!0),n=this.app.config.calendars;return{view:"align",body:{view:i?"icon":"button",type:"icon",icon:"wxi-plus",css:"webix_primary",label:t("Create"),width:i?50:n?185:100,height:i?50:webix.skin.$active.inputHeight,on:{onItemClick:function(){return e.AddEvent()}}},align:"middle"}},t.prototype.AddEvent=function(){this.app.getState().selected={id:"0"}},t}(p),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{cols:[{view:"icon",icon:"wxi-angle-left",tooltip:function(){return e.NavLabel(-1)},align:"left",on:{onItemClick:function(){return e.ChangeDate(-1)}}},{view:"label",localId:"title",align:"center",width:160},{view:"icon",icon:"wxi-angle-right",tooltip:function(){return e.NavLabel(1)},align:"right",on:{onItemClick:function(){return e.ChangeDate(1)}}}]}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.on(this.State.$changes,"date",(function(){return e.DateLabel()})),this.on(this.State.$changes,"mode",(function(){return e.DateLabel()})),this.app.config.timeline&&this.on(this.State.$changes,"timelineMode",(function(){return e.DateLabel()}))},t.prototype.ChangeDate=function(e){var t=this.State,i=this.GetStep(t.mode),n=webix.Date.add(t.date,e,i,!0);if("month"===t.mode){var r=Math.abs(t.date.getMonth()-n.getMonth());1!=r&&r<6&&n.setDate(0)}t.$batch({date:n,selected:null})},t.prototype.GetStep=function(e){switch(e){case"agenda":return"month";case"units":return"day";case"timeline":return this.State.timelineMode;default:return e}},t.prototype.DateLabel=function(){var e=this.State.date,t=this.State.mode,i=webix.Date.dateToStr("%F %Y");"year"===t?i=webix.Date.dateToStr("%Y"):("day"==t||"units"==t||"timeline"==t&&"day"==this.State.timelineMode)&&(i=webix.i18n.longDateFormatStr),this.$$("title").setHTML(i(e))},t.prototype.NavLabel=function(e){var t=this.app.getService("locale")._,i=this.State.mode;return t((e=e>0?"Next":"Previous")+(i=-1!==["month","week","day"].indexOf(i)?" "+i:""))},t}(p),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=this.getParam("compact",!0),n=!!this.app.config.units,r={hidden:i,view:"tabbar",bottomOffset:0,localId:"buttons",borderless:!0,width:320,optionWidth:80,options:[{id:"day",value:t("Day")},{id:"week",value:t("Week")},{id:"month",value:t("Month")},{id:"agenda",value:t("Agenda")},{id:"year",value:t("Year")}]};return this.app.config.timeline&&(r.width+=80,r.options.push({id:"timeline",value:t("Timeline")})),i||(r.on={onChange:function(t){return e.SetMode(t)}}),n&&(r.width+=80,r.options.push({id:"units",value:t("Units")})),r},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.on(this.State.$changes,"mode",(function(t){e.$$("buttons").setValue(t)}))},t.prototype.SetMode=function(e){this.State.$batch({mode:e,selected:null})},t}(p),Q=[["#61AEE6","#01C2A5","#E88DD9","#D2FB9E","#6BA8CB","#61BBA5","#CF89D5"],["#EF9C80","#8289EE","#74B1A7","#DD89AF","#E48882","#997CEB","#ADD579"],["#F68896","#FFE999","#6D4BCE","#99CA58","#D352BE","#F7CC34","#DA5C53"]],X=[["#5890DC","#3AA3E3","#045AA3","#014593","#01C2A5","#61A649","#157B7A"],["#04864F","#AD44AB","#CB61C8","#AC3C6E","#BA282E","#BD4E1B","#B87728"],["#B65F06","#7A67EB","#4536AD","#282A8A","#36337E","#585B85","#2A2F50"]],J={material:Q,mini:Q,flat:Q,compact:Q,contrast:Q,willow:X,dark:X};function Z(){var e=webix.skin.$active;return{view:"colorboard",css:"webix_scheduler_palette",height:3*e.optionHeight+4,width:7*e.optionHeight+4,palette:J[webix.skin.$name]}}var ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.getParam("compact",!0),i=this.app.getService("locale")._,n={view:"button",value:i("Save"),align:"right",inputWidth:100,css:"webix_primary",click:function(){return e.Save()}},r=webix.skin.$active,o={view:"toolbar",padding:{left:r.layoutPadding.form-(r.inputHeight-20)/2,right:r.layoutPadding.form},elements:[{view:"icon",icon:"wxi-close",click:function(){return e.getRoot().hide()}},{},n]},a=[{view:"button",localId:"removeBtn",value:i("Delete"),css:"webix_danger webix_scheduler_danger",hidden:!0,align:t?"center":"left",inputWidth:t?330:100,click:function(){return e.Delete()}}];t||a.push(n);var s=this.app.getService("jet-win").updateConfig({view:"window",width:400,close:!0,borderless:t,fullscreen:t,css:"webix_scheduler_cal_popup",head:t?o:i("Edit calendar"),body:{view:"form",localId:"calendars:form",elements:[{view:"text",label:i("Title"),name:"text"},{view:"colorpicker",label:i("Color"),name:"color",suggest:{type:"colorboard",padding:3,body:Z()}},{view:"checkbox",label:i("Active"),name:"active"},{cols:a}]},on:{onHide:function(){e.Form.clear(),e.$$("removeBtn").hide()}}});return t&&s.body.elements.splice(3,0,{}),s},t.prototype.init=function(){this.Cals=this.app.getService("local").calendars(!0),this.Ops=this.app.getService("operations"),this.Form=this.$$("calendars:form")},t.prototype.Show=function(e){if(e){var t=this.Cals.getItem(e);this.Form.setValues(t),this.$$("removeBtn").show()}else this.Form.setValues({color:"#997CEB",active:1});this.getRoot().show(),this.Form.focus()},t.prototype.Save=function(){var e=this.Form.getValues();e.id?this.Ops.updateCalendar(e.id,e):this.Ops.addCalendar(e),this.getRoot().hide()},t.prototype.Delete=function(){var e=this,t=this.Form.getValues(),i=this.app.getService("locale")._;webix.confirm({text:i("Do you really want to remove this calendar?"),container:this.app.getRoot().$view}).then((function(){e.Ops.removeCalendar(t.id),e.getRoot().hide()}))},t}(p),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"popup",relative:"right",body:{rows:[webix.extend(Z(),{localId:"colors",on:{onItemClick:function(t){return e.UpdateColor(t)}}}),{css:"webix_scheduler_settings",template:t("Settings"),height:webix.skin.$active.inputHeight,onClick:{webix_template:function(){return e.ShowEditor()}}}]},on:{onHide:function(){return e.app.callEvent("side:popup:hide",[])}}}},t.prototype.init=function(){var e=this;W(this.getRoot()).then((function(){e.Editor=e.ui(ee)}))},t.prototype.Show=function(e,t,i){this.Cid=e,this.getRoot().show(t),this.$$("colors").setValue(i)},t.prototype.ShowEditor=function(){this.Editor.Show(this.Cid),this.getRoot().hide()},t.prototype.UpdateColor=function(e){this.app.getService("operations").updateCalendar(this.Cid,{color:e}),this.getRoot().hide()},t.prototype.Hide=function(){this.getRoot().hide()},t}(p),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;this.Compact=this.getParam("compact",!0);var t=this.app.getService("locale")._,i=this.app.getState(),n={view:"calendar",localId:"calendar",height:276,monthSelect:!1,on:{onAfterDateSelect:function(e){i.date=webix.Date.dayStart(e)}}},r={view:"list",localId:"calendars",type:this.ListType(t,i),borderless:!0,autoheight:!0,yCount:5,editable:!0,editValue:"text",editaction:"custom",editor:"text",css:"webix_scheduler_cal_list",tooltip:function(){return""},onClick:{webix_scheduler_cal_edit:function(t,i){return e.ShowPopup(t,i)},webix_scheduler_cal_title:function(t,i){return e.ToggleCalendar(i)},webix_scheduler_active:function(t,i){return e.ToggleCalendar(i)}},on:{onBeforeEditStop:function(t,i){return e.SetTitle(i.id,t.value)}}},o={type:"form",padding:{top:8},rows:[{maxHeight:100},r,{view:"button",localId:"add",value:t("Add calendar"),hidden:!i.readonly,inputWidth:190,align:"center",click:function(){return e.AddCalendar()}},{}]};return this.Compact||(r.on.onAfterScroll=function(){return e.Popup.Hide()},o={view:"scrollview",body:{type:"clean",rows:[n,o]}}),o},t.prototype.init=function(){var e=this;this.Cals=this.$$("calendars"),this.Data=this.app.getService("local"),this.Ops=this.app.getService("operations"),this.Popup=this.Compact?this.ui(ee):this.ui(te),webix.extend(this.Cals,webix.EditAbility),this.Data.calendars().then((function(t){return e.Cals.parse(t)}));var t=this.app.getState();this.Compact||(this.on(t.$changes,"date",(function(t){e.$$("calendar").setValue(t)})),this.on(this.app,"side:popup:hide",(function(){e.Cals.unselectAll()}))),this.on(t.$changes,"readonly",(function(t){return e.ToggleState(t)}))},t.prototype.ListType=function(e,t){return{checkbox:function(e){var t=1*e.active?"wxi-checkbox-marked":"wxi-checkbox-blank";return'<span style="color:'+e.color+';" \n\t\t\t\t\trole="checkbox" tabindex="-1" \n\t\t\t\t\taria-checked="'+(e.active?"true":"false")+'" \n\t\t\t\t\tclass="webix_icon webix_scheduler_active '+t+'">\n\t\t\t\t</span>'},template:function(i,n){var r='\n\t\t\t\t\t<span\n\t\t\t\t\t\twebix_tooltip="'+e("Edit calendar")+'" \n\t\t\t\t\t\tclass="webix_icon wxi-dots webix_scheduler_cal_edit \n\t\t\t\t\t\t\t'+(webix.env.touch?" webix_scheduler_cal_visible":"")+'\n\t\t\t\t\t\t">\n\t\t\t\t\t</span>\n\t\t\t\t';return"\n\t\t\t\t\t"+n.checkbox(i)+'\n\t\t\t\t\t<span class="webix_scheduler_cal_title">'+(i.text||e("(no title)"))+"</span>\n\t\t\t\t\t"+(t.readonly?"":r)+"\n\t\t\t\t"}}},t.prototype.AddCalendar=function(){var e=this,t=this.app.getService("locale")._;this.Ops.addCalendar().then((function(i){e.Cals.edit(i),e.Cals.getEditor().getInputNode().setAttribute("placeholder",t("(no title)"))}))},t.prototype.ShowPopup=function(e,t){if(this.Compact)this.Popup.Show(t);else{this.Cals.select(t);var i=this.Cals.getItem(t).color;this.Popup.Show(t,this.Cals.getItemNode(t),i)}},t.prototype.ToggleCalendar=function(e){var t=this.Cals.getItem(e);this.Ops.updateCalendar(e,{active:1^t.active})},t.prototype.ToggleState=function(e){var t=this.$$("add");e?t.hide():t.show(),this.Cals.refresh()},t.prototype.SetTitle=function(e,t){var i=this;return this.Ops.updateCalendar(e,{text:t}).then((function(){return i.EditStopSilent()}),(function(){return i.EditStopSilent(!0)})),!1},t.prototype.EditStopSilent=function(e){this.Cals.blockEvent(),e?this.Cals.editCancel():this.Cals.editStop(),this.Cals.unblockEvent()},t}(p),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=!!this.app.config.units,n={view:"list",css:"webix_scheduler_navlist",localId:"modes",autoheight:!0,data:[{id:"day",value:t("Day"),icon:"shi-day"},{id:"week",value:t("Week"),icon:"shi-week"},{id:"month",value:t("Month"),icon:"shi-month"},{id:"agenda",value:t("Agenda"),icon:"shi-agenda"},{id:"year",value:t("Year"),icon:"shi-year"}],on:{onItemClick:function(t){return e.SetMode(t)}}};i&&n.data.push({id:"units",value:t("Units"),icon:"shi-units"}),this.app.config.timeline&&n.data.push({id:"timeline",value:t("Timeline"),icon:"shi-timeline"});var r={view:"sidemenu",animate:!1,borderless:!0,css:"webix_scheduler_sidemenu",width:300,state:function(t){var i=webix.skin.$active.tabbarHeight+10;t.left=e.Parent.left,t.top=e.Parent.top+i+2,t.height=e.Parent.height-i-2},body:n};return this.app.config.calendars&&(r.body={view:"scrollview",body:{type:"clean",rows:[n,ie]}}),r},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.on(this.app,"view:resize",(function(){e.getRoot().isVisible()&&e.Show(!0)}))},t.prototype.Show=function(e){!e&&this.getRoot().isVisible()||(this.Parent=this.app.getRoot().$view.getBoundingClientRect(),this.$$("modes").select(this.State.mode),this.getRoot().show())},t.prototype.SetMode=function(e){var t=this;this.getRoot().hide(),setTimeout((function(){return t.State.$batch({mode:e,selected:null})}),500)},t}(p),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;this.Compact=this.getParam("compact",!0);var i={view:"icon",icon:"wxi-calendar",batch:"compact",tooltip:t("Today"),click:function(){return e.SetToday()}},n={view:"align",align:"middle",batch:"full",body:{width:80,view:"button",css:"webix_transparent",value:t("Today"),click:function(){return e.SetToday()}}};return{view:"toolbar",css:"webix_scheduler_toolbar webix_dark",responsive:!0,paddingY:0,paddingX:4,height:webix.skin.$active.tabbarHeight+10,visibleBatch:this.Compact?"compact":"full",cols:[{view:"icon",icon:"shi-menu",click:function(){return e.ShowNav()},hidden:!this.Compact&&!this.app.config.calendars,responsiveCell:!1},{view:"proxy",localId:"add",borderless:!0,body:Y,batch:"full",responsiveCell:!1},{},{view:"proxy",borderless:!0,body:G,responsiveCell:!1},{},n,{width:12},K,i]}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.Compact&&(this.NavPopup=this.ui(ne)),this.on(this.State.$changes,"readonly",(function(t){e.ToggleAdd(t)}))},t.prototype.SetToday=function(){this.State.date=webix.Date.dayStart(new Date)},t.prototype.ShowNav=function(){this.Compact?this.NavPopup.Show():this.app.callEvent("show:panel")},t.prototype.ToggleAdd=function(e){var t=this.$$("add");e?t.hide():this.Compact||t.show()},t}(p),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"popup",body:{view:"menu",layout:"y",width:220,autoheight:!0,data:[{id:"this",value:t("This event")},{id:"next",value:t("This event and the following")},{id:"all",value:t("All events")}],on:{onMenuItemClick:function(t){e.Result&&e.Result.resolve(t),e.Result=null,e.Root.hide()}}},on:{onHide:function(){e.Result&&e.Result.reject(),e.Result=null}}}},t.prototype.init=function(e){this.Root=e},t.prototype.Show=function(e){return this.Result=webix.promise.defer(),this.Root.show(e),this.Result},t}(p);function ae(e,t){return function(i){var n=i.start_date<=e,r=i.end_date>=t;if(n||r){var o=webix.copy(i);return n&&(o.start_date=e),r&&(o.end_date=t),o}return i}}function se(e){return webix.Date.equal(webix.Date.datePart(e),webix.Date.datePart(new Date))}function le(e){return e.all_day||e.start_date.getDate()!=e.end_date.getDate()&&e.end_date-e.start_date>=864e5}function ce(e,t){return Math.round((webix.Date.dayStart(t)-webix.Date.dayStart(e))/864e5)}function ue(e,t){return webix.Date.equal(webix.Date.dayStart(e),webix.Date.dayStart(t))}var he=webix.Date.dateToStr("%Y%m%dT000000Z");function pe(e){for(var t=e.split(";"),i={},n=0;n<t.length;n++){var r=t[n].split("="),o=r[0],a=r[1];i[o]=a}return i.UNTIL&&(i.UNTIL=de(i.UNTIL)),i.EXDATE&&(i.EXDATE=i.EXDATE.split(",").map((function(e){return de(e)}))),i}function de(e){return new Date(1*e.substr(0,4),1*e.substr(4,2)-1,1*e.substr(6,2))}function _e(e){var t=[];for(var i in e){var n=e[i];"UNTIL"===i&&(n=he(n)),"EXDATE"===i&&(n=(n=n.map((function(e){return he(e)}))).join(",")),n&&t.push(i+"="+n)}return t.join(";")}var fe=["SU","MO","TU","WE","TH","FR","SA"],be={DAILY:"day",WEEKLY:"week",MONTHLY:"month",YEARLY:"year"};function ge(e,t){if(!e)return!1;for(var i=0;i<e.length;++i)if(webix.Date.equal(webix.Date.dayStart(t),e[i]))return!0;return!1}function we(e,t){if(e.BYDAY)for(var i=t.wdays=[0,0,0,0,0,0,0],n=e.BYDAY.split(",").map((function(e){return fe.indexOf(e)})).sort(),r=0;r<n.length;r++)for(var o=n[r],a=n[r+1]||n[0]+7,s=o;s<a;s++)i[s%7]=a-s}function Ae(e,t,i){var n,r,o=1*(t.INTERVAL||1);switch(t.FREQ){case"DAILY":e.setDate(e.getDate()+o);break;case"WEEKLY":n=e.getDay(),(r=i.wdays?i.wdays[n]:7)+n>6&&o>1&&(r+=7*(o-1)),e.setDate(e.getDate()+r);break;case"YEARLY":if(t.BYYEARDAY){e.setFullYear(e.getFullYear()+o),e.setMonth(0),e.setDate(1),e.setDate(t.BYYEARDAY);break}o*=12;case"MONTHLY":if(n=e.getMonth(),e.setDate(1),e.setMonth(n+o),t.BYMONTHDAY)e.setDate(t.BYMONTHDAY),(n+o)%12!=e.getMonth()&&e.setDate(0);else if(t.BYSETPOS){e.setDate(0);for(var a=0;a<t.BYSETPOS;a++)r=i.wdays[e.getDay()],e.setDate(e.getDate()+r)}}return e}function xe(e,t){var i=new Date(e),n=t.BYDAY.split(","),r=fe[i.getDay()];return{result:-1!==n.indexOf(r),start:i,days:n,oldDay:r}}function ve(e,t){var i=xe(e,t),n=i.result,r=i.days,o=i.oldDay;return n?t.BYDAY:("WEEKLY"===t.FREQ?r.splice(fe.indexOf(r[0]),0,o):r=[o],r.join(","))}function me(e){return{id:e.$id||e.id,date:e.$recurring?e.id:null}}function ye(e){return webix.Date.dayStart(e.getDate?e:new Date(1*e.split("_")[0]))}function Ce(e,t,i){var n=ye(e);return(!i||!t.$recurring.UNTIL||t.$recurring.UNTIL>n)&&(t.$recurring.UNTIL=n),t.$recurring.COUNT&&delete t.$recurring.COUNT,t.$recurring.EXDATE&&(t.$recurring.EXDATE=t.$recurring.EXDATE.filter((function(e){return e<n}))),_e(t.$recurring)}function ke(e,t){var i=ye(e);return t.$recurring.EXDATE||(t.$recurring.EXDATE=[]),t.$recurring.EXDATE.push(i),_e(t.$recurring)}function Se(e,t){var i="string"==typeof t?new Date(1*t.split("_")[0]):new Date(t),n=(e.end_date-e.start_date)/1e3/60;return{start_date:i,end_date:webix.Date.add(i,n,"minute",!0)}}function Be(e,t){return!!e&&(e.getDate?e:new Date(1*e.split("_")[0]))<=t}function $e(e,t){return e.origin_id&&e.recurring?this.app.getService("local").isLastPart(e)&&(t=""):t="all",t}function De(e,t,i){var n=(webix.Date.dayStart(t.start_date)-webix.Date.dayStart(i.start_date))/864e5;if(n){if(e.UNTIL){var r=webix.Date.add(e.UNTIL,n,"day",!0);r>t.end_date?e.UNTIL=r:e.UNTIL=webix.Date.dayStart(webix.Date.add(t.end_date,1,"day",!0))}if(e.BYDAY&&((n%=7)<0&&(n+=7),e.BYDAY=e.BYDAY.split(",").map((function(e){return fe[(fe.indexOf(e)+n)%7]})).join(",")),e.BYMONTHDAY){var o=t.start_date.getDate();o!=e.BYMONTHDAY&&(e.BYMONTHDAY=o)}}if(e.BYSETPOS){var a=Ee(t.start_date);e.BYSETPOS!=a&&(e.BYSETPOS=a)}if(e.BYMONTH){var s=t.start_date.getMonth()+1;s!=e.BYMONTH&&(e.BYMONTH=s)}return e}function Ee(e){var t=e.getDate();return Math.floor(t/7)+(t%7?1:0)}function Te(e){var t=e.$recurring||pe(e.recurring);"WEEKLY"!==t.FREQ||t.BYDAY?"MONTHLY"!==t.FREQ&&"YEARLY"!==t.FREQ||t.BYSETPOS||t.BYMONTHDAY||t.BYYEARDAY?"YEARLY"!==t.FREQ||t.BYMONTH||t.BYYEARDAY?(t.BYDAY&&(t.BYDAY=ve(e.start_date,t)),t.BYMONTHDAY&&(t.BYMONTHDAY=e.start_date.getDate()),t.BYMONTH&&(t.BYMONTH=e.start_date.getMonth()+1),t.BYSETPOS&&(t.BYSETPOS=Ee(e.start_date)),e.recurring=_e(t)):t.BYMONTH=e.start_date.getMonth():t.BYMONTHDAY=e.start_date.getDate():t.BYDAY=fe[e.start_date.getDay()]}var Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=this.getParam("compact",!0),n=webix.skin.$active,r={view:"form",localId:"recurringForm",hidden:!0,elementsConfig:{labelPosition:"left"},padding:{top:n.layoutPadding.form,bottom:0,left:i?n.layoutPadding.form:0,right:i?14:0},borderless:!0,rows:[this.CreateIntervalControls(t),{localId:"customRecControls",hidden:!0,rows:[this.CreateCheckboxes(t),this.CreateSelect(t)]},this.CreateRadio(t)]};return i||(r.on={onChange:function(t,i,n){return e.UpdateEvent(n)}}),r},t.prototype.init=function(){this.State=this.app.getState(),this.Form=this.$$("recurringForm"),this.Events=this.app.getService("local").events(!0),this.CheckBoxContainer=this.$$("weekly"),this.Checkboxes=this.CheckBoxContainer.getChildViews().slice(1),this.Checkboxes.pop(),this.PatternSelect=this.$$("patternSelect"),this.UntilDateContainer=this.$$("untilDate"),this.UntilDateCalendar=this.Form.elements.untilDate.getPopup().getBody(),this.UntilNumContainer=this.$$("untilCount"),this.UntilNum=this.UntilNumContainer.getBody(),this.CustomRecControls=this.$$("customRecControls")},t.prototype.CreateIntervalControls=function(e){var t=this;return{margin:8,cols:[{view:"counter",label:e("Every"),labelWidth:50,min:1,name:"INTERVAL",css:"webix_scheduler_counter"},{view:"richselect",name:"FREQ",options:[{id:"DAILY",value:e("day")},{id:"WEEKLY",value:e("week")},{id:"MONTHLY",value:e("month")},{id:"YEARLY",value:e("year")}],on:{onChange:function(e){return t.ChangeControls(e)}}}]}},t.prototype.ChangeControls=function(e){this._freq=e,"DAILY"===e?this.CustomRecControls.hide():(this.CustomRecControls.show(),"WEEKLY"===e?(this.CheckBoxContainer.show(),this.PatternSelect.hide()):(this.CheckBoxContainer.hide(),"MONTHLY"===e&&3==this.PatternSelect.getValue()&&this.PatternSelect.setValue(1),this.PatternSelect.show(),this.PatternSelect.getList().refresh(),this.PatternSelect.refresh()))},t.prototype.CreateCheckboxes=function(e){for(var t=[],i=0;i<7;++i)t.push({view:"checkbox",label:webix.i18n.calendar.dayShort[i],labelPosition:"top",labelAlign:"center",css:"webix_scheduler_day_checkbox",inputWidth:26,width:45,align:"center",name:fe[i],on:{onChange:function(e,t){this.$scope.CheckboxGuard(this.config.name,e,t)}}});return{localId:"weekly",cols:o([{view:"label",label:e("on"),width:45}],t,[{gravity:1e-5}])}},t.prototype.CheckboxGuard=function(e,t,i){var n;webix.isUndefined(i)||t||this.GetBYDAY()||this.Form.setValues(((n={})[e]=1,n),!0)},t.prototype.SetBYDAY=function(e){var t=e.BYDAY.split(",");this.Checkboxes.forEach((function(i){e[i.config.name]=!!t.find((function(e){return e==i.config.name}))}))},t.prototype.GetBYDAY=function(){var e=[];return this.Checkboxes.forEach((function(t){t.getValue()&&e.push(t.config.name)})),e.join(",")},t.prototype.CreateSelect=function(e){var t=this;return{view:"richselect",localId:"patternSelect",name:"rec_pattern",suggest:{data:[],body:{template:function(i){if("YEARLY"===t._freq&&i.BYYEARDAY)return e("Every")+" "+i.BYYEARDAY+" "+e("day of year");var n=[];i.BYDAY&&i.BYDAY.forEach((function(e){return n.push(webix.i18n.calendar.dayFull[e])}));var r=e("Every")+" "+(i.BYMONTHDAY||i.BYSETPOS)+" "+(i.BYDAY?n.join(", "):"");return"YEARLY"===t._freq&&(r+=" "+e("of")+" "+webix.i18n.calendar.monthFull[i.BYMONTH-1]),r}},on:{onShow:function(){var e=this;this.getList().filter((function(t){return"YEARLY"===e.$scope._freq||3!=t.id}))}}}}},t.prototype.SetPatternOptions=function(e,t){this.PatternSelect.getList().parse([{id:1,BYMONTH:e.BYMONTH||t.month+1,BYMONTHDAY:e.BYMONTHDAY||t.day},{id:2,BYSETPOS:e.BYSETPOS||t.weekNum,BYDAY:[t.weekday],BYMONTH:e.BYMONTH||t.month+1},{id:3,BYYEARDAY:e.BYYEARDAY||t.yearday}]),this.PatternSelect.refresh(),this._freq=e.FREQ,e.rec_pattern=e.BYSETPOS?2:e.BYYEARDAY?3:1},t.prototype.GetRecPattern=function(e){var t=webix.copy(this.PatternSelect.getList().getItem(e.rec_pattern));return"MONTHLY"===this._freq&&delete t.BYMONTH,t.BYDAY&&(t.BYDAY=t.BYDAY.map((function(e){return fe[e]})).join(",")),delete t.id,t},t.prototype.CreateRadio=function(e){var t=this;return{rows:[{view:"label",label:e("End repeat")},{cols:[{view:"radio",name:"until",localId:"until",vertical:!0,options:[{id:1,value:e("never")},{id:2,value:e("date")},{id:3,value:e("after several occurrences")}],on:{onChange:function(e){return t.ChangeSelectors(e)}}},{width:130,rows:[{localId:"untilDate",align:"middle",view:"align",body:{view:"datepicker",name:"untilDate",icons:!1}},{localId:"untilCount",view:"align",align:"bottom",body:{name:"untilCount",view:"counter",css:"webix_scheduler_counter",min:1}}]}]}]}},t.prototype.ChangeSelectors=function(e){this.UntilDateContainer["2"===e?"show":"hide"](),this.UntilNumContainer["3"===e?"show":"hide"]()},t.prototype.SetUNTIL=function(e){var t=this._StartDate;e.until=e.COUNT?3:e.UNTIL?2:1,e.untilDate=e.UNTIL||webix.Date.add(t,1,"year",!0),e.untilCount=e.COUNT||this.CountNum(e),this.UntilDateCalendar.define({minDate:t})},t.prototype.CountNum=function(e){var t=0;if(e.UNTIL){var i={};we(e,i);for(var n=webix.Date.copy(this._StartDate);n<=e.UNTIL;)n=Ae(n,e,i),t++}else t=3;return t},t.prototype.SetValues=function(e,t,i){if(!t)return this.Form.setValues(e,!0);this._StartDate=e.start_date;var n=e.$recurring;n||(n={FREQ:"DAILY"}),n.INTERVAL||(n.INTERVAL=1),n.BYDAY||(n.BYDAY=fe[t.weekday]),n.EXDATE||(n.EXDATE=[]),this.SetUNTIL(n),this.SetBYDAY(n),this.SetPatternOptions(n,t),this.Form.setValues(n,!0),i&&this.Form.setDirty()},t.prototype.GetValues=function(){var e=this.Form.getValues(),t={FREQ:e.FREQ,INTERVAL:e.INTERVAL,UNTIL:2==e.until?e.untilDate:this.GetUntil(e),COUNT:3==e.until?e.untilCount:null,EXDATE:e.EXDATE||[]};return"WEEKLY"===e.FREQ?t.BYDAY=this.GetBYDAY(e):"MONTHLY"!==e.FREQ&&"YEARLY"!==e.FREQ||(t=webix.extend(t,this.GetRecPattern(e))),this.Form.setDirty(),t},t.prototype.GetUntil=function(e){if(3==e.until){var t={};we(e,t);for(var i=webix.Date.copy(this._StartDate),n=1;n<e.untilCount;++n)i=Ae(i,e,t);return i=webix.Date.add(i,1,"day",!0),this.Form.setValues({untilDate:i},!0),i}return null},t.prototype.UpdateEvent=function(e){if("user"===e){var t=this.GetValues();this.app.callEvent("form:update:recurring",[{$recurring:t}]),this.Form.setDirty()}},t.prototype.IsDirty=function(){return this.Form.isDirty()},t.prototype.Show=function(){this.getRoot().show()},t.prototype.Hide=function(){this.getRoot().hide()},t}(p);function Ie(e,t,i,n){return e&&"next"===e&&Be(n,i)&&(e=$e.call(this,t,e)),e}function qe(e,t,i,n){for(var r=e.origin_id||e.$id||e.id,o=n.find((function(e){return r==e.origin_id&&i<e.start_date})).sort((function(e,t){return e.start_date>t.start_date?-1:e.start_date<t.start_date?1:0})),a=webix.copy(e.$recurring),s=0,l=void 0;s<o.length;++s)if((l=o[s]).$recurring){if(!l.$recurring.COUNT){a.UNTIL=l.$recurring.UNTIL;break}if(!a.COUNT||e.$id==l.id){a.UNTIL=Re(l);break}a.COUNT=1*a.COUNT+1*l.$recurring.COUNT}return"next"!==t||o.length||(a.COUNT?a.COUNT=function(e,t){var i=ye(t),n={};we(e.$recurring,n);for(var r=webix.Date.dayStart(e.start_date),o=0;r<i;)o++,r=Ae(r,e.$recurring,n);return e.$recurring.COUNT-o}(e,i):a.UNTIL&&e.start_date>=a.UNTIL&&(a.UNTIL=webix.Date.add(webix.Date.dayStart(e.start_date),1,be[a.FREQ],!0))),a}function Pe(e){if(!e.recurring)return!0;if(!e.$recurring.UNTIL)return!1;var t=webix.Date.dayStart(webix.Date.add(e.end_date,1,"day",!0));return webix.Date.equal(t,e.$recurring.UNTIL)}function Re(e){var t=e.$recurring,i=1*t.COUNT;return"WEEKLY"===t.FREQ&&(i=Math.floor(t.BYDAY.split(",").length/7*t.COUNT)),webix.Date.add(e.start_date,i,be[t.FREQ],!0)}function Me(e){e.ChangeMode=Ie,e.CorrectCountUntil=qe,e.HasOneOccurrence=Pe}var Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;this.Compact=this.getParam("compact",!0);var i=webix.skin.$active,n={view:"toolbar",borderless:!0,padding:{left:i.layoutPadding.form-(i.inputHeight-20)/2,right:14},elements:[{view:"icon",icon:"wxi-close",tooltip:t("Close"),hotkey:"esc",click:function(){return e.Close()}},{view:"label",label:t("Edit event")},{view:"button",width:130,css:"webix_primary",value:t("Done"),hotkey:"Ctrl+Enter",click:function(){return e.Done()}}]},r={view:"form",localId:"form",scroll:!0,borderless:!0,padding:{right:14},elementsConfig:{labelPosition:"top"},elements:[{view:"text",label:t("Event"),name:"text"},{margin:8,rows:[this.GetDateTime("start",t,i),this.GetDateTime("end",t,i)]},{view:"checkbox",name:"all_day",labelPosition:"left",labelWidth:0,labelRight:t("All Day"),on:{onChange:function(t){return e.ToggleTimeControls(t)}}},this.CreateCalendarColor(t),{view:"textarea",label:t("Notes"),name:"details",height:150},{}],on:{onChange:function(t,i,n){var r=e.Form.getDirtyValues();Object.keys(r).length&&e.PrepareChange(r),e.Compact||"user"!==n||e.Wait((function(){return e.UpdateEvent(r)}))}}};if(this.app.config.recurring&&r.elements.splice(3,0,this.CreateRepeat(t,i)),this.app.config.units){var o=this.app.config.recurring?5:4;r.elements.splice(o,0,this.CreateUnitSelector(t))}return this.app.config.timeline&&(o=this.app.config.recurring?5:4,this.app.config.units&&o++,r.elements.splice(o,0,this.CreateSectionSelector(t))),{view:"proxy",body:{margin:0,rows:[n,r]}}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.Form=this.$$("form"),this.Local=this.app.getService("local").events(!0),this.Ops=this.app.getService("operations"),Me(this),this.RecurringOptions=this.$$("recOption"),this.StartTime=this.$$("startTime"),this.EndTime=this.$$("endTime"),this.on(this.State.$changes,"readonly",(function(t,i){webix.isUndefined(i)||e.Close()})),this.on(this.app,"form:update:recurring",(function(t){Object.keys(t).length&&e.PrepareChange(t),e.UpdateEvent(t)}));var t=this.app.getService("local");if(this.app.config.calendars&&(this.Calendars=t.calendars(!0),this.$$("calendar").getList().parse(this.Calendars)),this.app.config.units){var i=t.units(),n=this.Form.elements.units;i.then((function(e){n.getList().parse(e),n.refresh()}))}this.app.config.timeline&&(this.Sections=t.sections(!0),this.$$("sections").getList().parse(this.Sections))},t.prototype.ready=function(){var e=this;this.SubForm=this.getSubView("recurringForm"),this.on(this.State.$changes,"selected",(function(t){t&&(e.ClearTempEvent(),e.Wait((function(){return e.FillForm(t)})))}))},t.prototype.destroy=function(){this.ClearTempEvent()},t.prototype.CreateRepeat=function(e,t){var i=this,n=[{view:"label",label:e("Repeat"),height:t.labelTopHeight},{margin:4,cols:[{view:"richselect",localId:"recOption",name:"rec_option",suggest:{data:[{id:"none",value:e("never")},{id:"daily",value:e("daily")},{id:"weekly"},{id:"monthly"},{id:"yearly"},{id:"work",value:e("every working day")},{id:"custom",value:e("custom")}]},on:{onChange:function(e,t){return i.ToggleSubform(e,t)}}}]}];return this.Compact&&n[1].cols.push({localId:"editCustomRec",view:"icon",icon:"wxi-pencil",tooltip:e("Change recurring pattern"),hidden:!0,click:function(){return i.ShowSubForm()}}),n.push({$subview:Le,name:"recurringForm"}),{localId:"repeatControls",rows:n}},t.prototype.ToggleTimeControls=function(e){1==e?(this.StartTime.hide(),this.EndTime.hide()):(this.StartTime.show(),this.EndTime.show())},t.prototype.ToggleSubform=function(e,t){"custom"===e?this.Compact?(this.$$("editCustomRec").show(),t&&this.ShowSubForm()):this.SubForm.Show():(this.SubForm.Hide(),this.Compact&&this.$$("editCustomRec").hide())},t.prototype.CreateCalendarColor=function(e){var t={margin:8,cols:[{view:"colorpicker",label:e("Color"),name:"color",value:"#1abc9c",suggest:{type:"colorboard",padding:3,body:Z()}}]};return this.app.config.calendars&&t.cols.unshift({view:"richselect",localId:"calendar",label:e("Calendar"),name:"calendar",css:"webix_scheduler_cal_color",options:{css:"webix_scheduler_cal_color_suggest",data:[],body:{tooltip:function(){return""},template:function(t){var i=1*t.active,n=i?"":"class='webix_scheduler_cal_disabled'";return'<div style="overflow: hidden;" '+(i?"":'webix_tooltip="'+e("Inactive calendar")+'"')+" "+n+">"+(t.text||e("(no title)"))+'\n\t\t\t\t\t\t\t\t<span class="webix_scheduler_cal_marker" style="background-color:'+t.color+';">\n\t\t\t\t\t\t\t</span></div>'}}}}),t},t.prototype.CreateUnitSelector=function(e){return{view:"multicombo",name:"units",label:e("Units"),options:[]}},t.prototype.GetDateTime=function(e,t,i){return{rows:[{view:"label",height:i.labelTopHeight,label:t("start"===e?"Start":"End")},{margin:8,cols:[{view:"datepicker",name:e+"_date",suggest:{type:"calendar",icons:!1}},{view:"datepicker",localId:e+"Time",name:e+"_time",type:"time",format:"%H:%i"}]}]}},t.prototype.CreateSectionSelector=function(e){return{localId:"sections",view:"richselect",label:e("Section"),name:"section",options:{data:[],body:{template:"#text#"}}}},t.prototype.FillForm=function(e){var t,i=this;if(this.Id=e.id,this.Form.focus(),this.Date=e.date,"string"==typeof this.Date&&(this.Date=new Date(1*this.Date.slice(0,this.Date.indexOf("_")))),"0"==e.id){if(this.State.clipboard&&this.State.clipboard.selected?(t=this.State.clipboard.selected,this.$$("repeatControls").hide()):t=this.NewEvent(e),t.then)return t.then((function(t){i.Local.add(r({id:e.id},webix.copy(t))),i.FillFormContinue(t)}));this.Local.add(r({id:e.id},webix.copy(t)))}else{t=webix.copy(this.Local.getItem(e.id));var n=this.getParam("mode",!0);n&&(t=this.AdaptObjToMode(n,t))}this.FillFormContinue(t)},t.prototype.AdaptObjToMode=function(e,t){return e=this.ChangeMode(e,t,t.recurring?t.start_date:this.Local.getItem(t.origin_id).start_date,t.recurring?this.State.selected.date:t.start_date),this.setParam("mode",e,!0),"all"!==e&&"next"!==e||("all"===e&&t.origin_id&&(t=webix.copy(this.Local.getItem(t.origin_id))),t.$recurring||(t.$recurring=webix.copy(this.Local.getItem(t.origin_id).$recurring)),(t.$recurring.COUNT||t.$recurring.UNTIL)&&(t.$recurring=this.CorrectCountUntil(t,e,t.start_date,this.Local))),"this"!==e&&"next"!==e||(this.State.selected.date&&(t=r(r({},t),Se(t,this.State.selected.date))),"this"===e&&(t.$recurring=null,t.recurring="",this.$$("repeatControls").hide())),t},t.prototype.FillFormContinue=function(e){e.start_time=webix.Date.copy(e.start_date),e.end_time=webix.Date.copy(e.end_date),e.start_date=webix.Date.datePart(e.start_date),e.end_date=webix.Date.datePart(e.end_date),this.app.config.recurring&&this.SetRecurring(e),this.Form.setValues(e)},t.prototype.GetFromStartDate=function(e){var t,i={weekday:e.getDay(),day:e.getDate(),month:e.getMonth(),yearday:(t=e,(t-webix.Date.yearStart(t))/1e3/60/60/24+1)};return i.weekNum=Math.floor(i.day/7)+(i.day%7?1:0),i},t.prototype.SetRecurring=function(e){var t=this.GetFromStartDate(e.start_date),i=this.ResetRecurringOptions(t);this.RecurringOptions.getList().parse(i),this.SubForm.SetValues(webix.copy(e),t,!0),e.$recurring?"MO,TU,WE,TH,FR"===e.$recurring.BYDAY?e.rec_option="work":e.$recurring.UNTIL||e.$recurring.COUNT||e.$recurring.INTERVAL&&1!=e.$recurring.INTERVAL||!("DAILY"===e.$recurring.FREQ||"WEEKLY"===e.$recurring.FREQ&&e.$recurring.BYDAY==fe[t.weekday]||"MONTHLY"===e.$recurring.FREQ&&e.$recurring.BYSETPOS&&e.$recurring.BYSETPOS==t.weekNum&&e.$recurring.BYDAY==fe[t.weekday]||"YEARLY"===e.$recurring.FREQ&&e.$recurring.BYMONTH==t.month+1&&e.$recurring.BYMONTHDAY==t.day)?e.rec_option="custom":e.rec_option=e.$recurring.FREQ.toLowerCase():e.rec_option="none"},t.prototype.ResetRecurringOptions=function(e){var t=this.app.getService("locale")._;return[{id:"weekly",value:t("weekly, every")+" "+webix.i18n.calendar.dayFull[e.weekday]},{id:"monthly",value:t("monthly, every")+" "+e.weekNum+" "+t("week on")+" "+webix.i18n.calendar.dayFull[e.weekday]},{id:"yearly",value:t("yearly, every")+" "+webix.i18n.calendar.monthFull[e.month]+" "+e.day}]},t.prototype.Join=function(e,t){return webix.Date.add(e,webix.Date.timePart(t)/60,"minute",!0)},t.prototype.NewEvent=function(e){var t=this,i=this.GetStartDate(),n={start_date:i,end_date:this.State.selected.end_date||webix.Date.add(i,1,"hour",!0),text:"",details:""};if(this.app.config.recurring&&(n.recurring=""),this.app.config.timeline&&(n.section=e.section||this.Sections.getFirstId()),this.app.config.calendars){var r=this.State.active[0];if(!r){var o=this.Calendars.getFirstId();return(o?this.Ops.updateCalendar(o,{active:1}):this.Ops.addCalendar()).then((function(){return n.calendar=t.State.active[0],n.$color=t.Calendars.getItem(n.calendar).color,n}))}n.calendar=r,n.$color=this.Calendars.getItem(n.calendar).color}else n.$color="#01C2A5";return this.app.config.calendars&&e.unit&&(n.units=e.unit),n},t.prototype.GetStartDate=function(){if(this.Date)return webix.Date.copy(this.Date);var e=new Date,t=30*Math.ceil(e.getMinutes()/30),i=webix.Date.copy(this.State.date);return i.setHours(e.getHours(),t),i},t.prototype.UpdateEvent=function(e){var t=this;if(this.Form.setDirty(),"0"===this.Id){var i=this.PrepareOut(e);this._inProgress=this.Ops.addEvent(i,!0,this.Id)}else Object.keys(e).length&&(this._inProgress=this.UpdateExisting(this.Id,e));return this._inProgress&&(this.app.callEvent("backend:operation",[this._inProgress]),this._inProgress.then((function(i){i&&t.UpdateSelection(i),t.ChangeDate(e,t.Form.getValues()),t.setParam("mode","",!0)})).finally((function(){t._inProgress=null}))),this._inProgress||webix.promise.resolve()},t.prototype.UpdateExisting=function(e,t){var i=this,n=this.getParam("mode",!0),r=this.Local.getItem(e);if("this"===n&&!this.HasOneOccurrence(r)||"next"===n){t.origin_id=r.origin_id||r.id;var o=this.PrepareOut(t),a="";if("this"===n)a=ke(this.State.selected.date,r);else{var s=void 0;r.recurring?s=[this.State.selected.date,r]:(e=r.origin_id,s=[o.start_date,this.Local.getItem(e)]),a=Ce.apply(void 0,s)}return this.Ops.updateEvent(e,{recurring:a},n,webix.Date.dayStart(o.start_date),!0).then((function(){return"none"===t.rec_option&&(i.State.selected.date=null),i.Ops.addEvent(o,!0)}))}if("all"===n){var l=this.Form.getValues().$recurring;l&&webix.isUndefined(t.recurring)&&(delete l.EXDATE,t.recurring=_e(l),this.Form.setValues({$recurring:l,recurring:t.recurring},!0),this.SubForm.SetValues({EXDATE:null})),r.origin_id&&(this.Id=this.State.selected.id=r.origin_id)}return this.Ops.updateEvent(this.Id,t,n,void 0,!0).then((function(){"none"===t.rec_option&&(i.State.selected.date=null)}))},t.prototype.UpdateSelection=function(e){this.State.selected.id=this.Id=e;var t=this.State.selected.date;if(t instanceof Date)this.State.selected.date=null;else if(t){var i=this.Form.getValues();this.State.selected.date=this.Join(i.start_date,i.start_time).valueOf()+"_"+e}},t.prototype.PrepareChange=function(e){e.rec_option?this.ProcessRecurringOption(e):webix.isUndefined(e.$recurring)||this.ProcessRecurringPattern(e),this.ProcessDates(e),this.app.config.recurring&&e.start_date&&this.ApplyDatechangeToRecurring(e),this.ProcessText(e,"text"),this.ProcessText(e,"details"),this._changedValues=e},t.prototype.ProcessRecurringOption=function(e){var t=this.Form.getValues();"none"===e.rec_option?(e.recurring="",e.series_end_date=""):"custom"===e.rec_option?(t.$recurring&&this.SubForm.SetValues(r(r({},t),e),this.GetFromStartDate(t.start_date)),e.$recurring=this.SubForm.GetValues(),this.ProcessRecurringPattern(e),t.$recurring||this.Form.setValues({$recurring:e.$recurring},!0)):(this.GetRecurring(e.rec_option,e,t.start_date),e.series_end_date=""),delete e.rec_option,delete e.$recurring},t.prototype.ProcessRecurringPattern=function(e){var t,i=this.Form.getValues(),n=_e(e.$recurring),r=this.Local.getItem(this.State.selected.id);r&&n===r.recurring||(e.recurring=n,e.series_end_date=e.$recurring.UNTIL,e.$recurring.BYDAY&&(t=function(e,t,i){var n=xe(e,i),r=n.result,o=n.start,a=n.days;if(r)return[e,t];var s=fe.indexOf(a[0])-o.getDay();o.setDate(o.getDate()+s);var l=new Date(t);return l.setDate(l.getDate()+s),[o,l]}(i.start_date,i.end_date,e.$recurring),e.start_date=t[0],e.end_date=t[1]),this.Form.setValues(e,!0)),delete e.$recurring},t.prototype.ProcessDates=function(e){var t=this.Form.getValues();webix.isUndefined(e.all_day)?((e.start_date||e.start_time)&&0==t.all_day&&(e.start_date=this.Join(t.start_date,t.start_time)),(e.end_date||e.end_time)&&0==t.all_day&&(e.end_date=this.Join(t.end_date,t.end_time))):1==e.all_day?(e.start_date=t.start_date,e.end_date=t.end_date):0==e.all_day&&(e.start_date=this.Join(t.start_date,t.start_time),e.end_date=this.Join(t.end_date,t.end_time)),(e.start_date||e.end_date)&&this.CorrectDateTime(e)},t.prototype.CorrectDateTime=function(e){var t=this.Form.getValues(),i=this.Local.getItem(this.State.selected.id),n=(i.end_date-i.start_date)/1e3/60,r=e.start_date?"start":"end",o="start"===r?"end":"start",a=e.start_date||i.start_date,s=e.end_date||i.end_date;(a>=s&&!t.all_day||a>s)&&(e[o+"_date"]=webix.Date.add(e[r+"_date"],("start"===r?1:-1)*(n||60),"minute",!0),this.Form.setValues({start_date:webix.Date.datePart(e.start_date,!0),end_date:webix.Date.datePart(e.end_date,!0),start_time:e.start_time||webix.Date.copy(e.start_date),end_time:e.end_time||webix.Date.copy(e.end_date)},!0)),delete e.start_time,delete e.end_time},t.prototype.ProcessText=function(e,t){if(!this.webix.isUndefined(e[t])){e[t]=e[t].replace(/(<[^>]+>|^\s+|\s+$)/gi,"");var i=this.Local.getItem(this.State.selected.id)[t]||"";e[t]===i.trim()&&delete e[t]}},t.prototype.ApplyDatechangeToRecurring=function(e){var t=this.GetFromStartDate(e.start_date),i=this.Form.getValues();if(!e.recurring&&i.$recurring)if("custom"===i.rec_option){var n=i.$recurring;if(n.BYYEARDAY&&(n.BYYEARDAY=t.yearday),n.BYMONTH&&(n.BYMONTH=t.month+1),n.BYMONTHDAY&&(n.BYMONTHDAY=t.day),n.BYSETPOS&&(n.BYSETPOS=t.weekNum),n.BYDAY&&(n.BYDAY=ve(e.start_date,i.$recurring)),n.UNTIL&&n.UNTIL<e.start_date){var o=this.Local.getItem(this.State.selected.id).start_date,a=(i.$recurring.UNTIL-o)/1e3/60;n.UNTIL=webix.Date.add(e.start_date,a,"minute",!0)}e.recurring=_e(n),this.SubForm.SetValues(r(r({},i),e),t)}else this.GetRecurring(i.rec_option,e,i.start_date),delete e.$recurring;this.RecurringOptions.getList().parse(this.ResetRecurringOptions(t)),this.RecurringOptions.refresh()},t.prototype.GetRecurring=function(e,t,i){var n=this.GetRecurringPreset(e,i);if("work"===e&&t.start_date){var r=ve(t.start_date,n);n.BYDAY!==r&&(n.BYDAY=r,e="custom")}var o=_e(n),a=this.Local.getItem(this.State.selected.id);a&&o===a.recurring||(t.$recurring=n,t.recurring=o,this.Form.setValues({$recurring:t.$recurring,recurring:o,rec_option:e},!0))},t.prototype.GetRecurringPreset=function(e,t){var i=this.GetFromStartDate(t);switch(e){case"daily":default:return{FREQ:"DAILY",INTERVAL:1};case"weekly":return{FREQ:"WEEKLY",INTERVAL:1,BYDAY:fe[i.weekday]};case"work":return{FREQ:"WEEKLY",INTERVAL:1,BYDAY:"MO,TU,WE,TH,FR"};case"monthly":return{FREQ:"MONTHLY",INTERVAL:1,BYSETPOS:i.weekNum,BYDAY:fe[i.weekday]};case"yearly":return{FREQ:"YEARLY",INTERVAL:1,BYMONTH:i.month+1,BYMONTHDAY:i.day}}},t.prototype.ChangeDate=function(e,t){if(e)if(e.start_date&&!t.recurring||""===e.recurring)this.State.selected.date=null,this.UpdateStateDate(e.start_date||t.start_date);else if(e.start_date||e.recurring){var i=this.GetClosestOccurrenceDate(e,t);this.State.selected.date=i.valueOf()+"_"+this.State.selected.id,this.UpdateStateDate(i)}},t.prototype.GetClosestOccurrenceDate=function(e,t){var i=e.start_date?webix.Date.copy(e.start_date):this.Join(t.start_date,t.start_time),n=webix.Date.dayStart(this.State.selected.date?new Date(1*this.State.selected.date.split("_")[0]):i);t.series_end_date&&(n=new Date(Math.min(webix.Date.add(t.series_end_date,-1,"day",!0),n)));var r={};we(t.$recurring,r);for(var o=webix.Date.copy(i);webix.Date.dayStart(o)<n;)o=Ae(o,t.$recurring,r),Math.abs(n-o)<Math.abs(n-i)&&(i=webix.Date.copy(o));return i},t.prototype.UpdateStateDate=function(e){e=webix.Date.dayStart(e);var t=this.State;if("day"===t.mode||"units"===t.mode||"timeline"===t.mode&&"day"===t.timelineMode){var i=webix.Date.dayStart(t.date);webix.Date.equal(e,i)||(t.date=webix.Date.dayStart(e))}else{var n=this.GetModeBounds(),r=n.start,o=n.end;(e<r||e>=o)&&(t.date=webix.Date.dayStart(e))}},t.prototype.GetModeBounds=function(){var e=this.State,t=e.mode;"timeline"===t?t=e.timelineMode:"agenda"===t&&(t="month");var i=webix.Date[t+"Start"](e.date),n=webix.Date.add(i,1,t,!0);if("month"===e.mode){i=webix.Date.weekStart(i);var r=Math.ceil((n-i)/864e5/7);n=webix.Date.add(i,r,"week",!0)}return{start:i,end:n}},t.prototype.PrepareOut=function(e){var t=this.Form.getValues();return t.all_day||(t.start_date=this.Join(t.start_date,t.start_time),t.end_date=this.Join(t.end_date,t.end_time)),t=webix.extend(t,e||{},!0),e&&e.recurring||!t.$recurring||(t.$recurring.EXDATE=[],t.recurring=_e(t.$recurring)),t.origin_id||(t.origin_id=0),this.app.config.timeline&&!t.section&&(t.section=0),t},t.prototype.ClearTempEvent=function(){var e=this.Id;"0"===e&&this.Local.exists(e)&&this.Local.remove(e)},t.prototype.Back=function(e){if(this.Form.clear(),e||"0"===this.State.selected.id)this.State.selected=null;else{var t=this.Compact?"event.formpopup/":"../";this.show(t+"event.info",{target:"edit"})}},t.prototype.Close=function(){var e=this;if(this._inProgress)this._inProgress.then((function(){e.Back(!0)}));else{var t=this.Form.isDirty()||this.Subform&&this.SubForm.IsDirty();if(this.Compact&&t){var i=this.app.getService("locale")._;webix.confirm({text:i("Save changes?"),container:this.app.getRoot().$view}).then((function(){return e.Done(!0)})).catch((function(){return e.Back(!0)}))}else this.Back(!0)}},t.prototype.Done=function(e){var t=this;if(this._inProgress)this._inProgress.then((function(){t.Back()}));else if("0"===this.State.selected.id||this.Compact){var i={};this.Compact&&(this._changedValues&&(i=this._changedValues),this.SubForm.IsDirty()&&(i.$recurring=this.SubForm.GetValues(),i.series_end_date=i.$recurring.UNTIL,delete i.rec_option)),this.UpdateEvent(i).then((function(){return t.Back(e)}))}else this.Back()},t.prototype.Wait=function(e){this._inProgress?this._inProgress.then(e):e.call()},t.prototype.ShowSubForm=function(){var e=this;this.SubForm.Show();var t=this.app.getService("locale")._,i=this.SubForm.getRoot(),n=webix.skin.$active;webix.fullscreen.set(i,{head:{view:"toolbar",padding:{left:n.layoutPadding.form-(n.inputHeight-20)/2,right:14},elements:[{view:"icon",icon:"shi-back",click:function(){return e.HideSubPop()}},{view:"label",label:t("Change recurring pattern")},{view:"button",value:t("Done"),width:130,css:"webix_primary",click:function(){return e.HideSubPop()}}]}}),i.getTopParentView().define({css:"webix_scheduler_subform_popup"})},t.prototype.HideSubPop=function(){this.SubForm.Hide(),webix.fullscreen.exit()},t}(p),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return this.app.getService("jet-win").updateConfig({view:"window",fullscreen:!0,head:!1,body:{$subview:!0}})},t}(p);function Oe(e){return{attachEvent:function(t,i){return webix.UIManager.addHotKey(t,i,e),{key:t,handler:i}},detachEvent:function(t){var i=t.key,n=t.handler;return webix.UIManager.removeHotKey(i,n,e)}}}function Ve(e){(e.recurring||e.$id||e.origin_id)&&(e.recurring="",delete e.$recurring,e.origin_id||(e.origin_id=e.$id||e.id),delete e.$id),delete e.id;var t=this.app.getService("locale")._;e.text&&(e.text=t("Copy of")+" "+e.text.replace(t("Copy of")+" ",""))}function He(e){var t=this;this.clipboardModes=["copy","cut"],this.Ops=this.app.getService("operations");var i=webix.env.isMac?"COMMAND":"CTRL";this.on(Oe(e),i+"+C",(function(e){return t.AddToClipboard(e,"copy")})),this.on(Oe(e),i+"+X",(function(e){return t.AddToClipboard(e,"cut")})),this.on(Oe(e),i+"+V",(function(e,i){return t.PasteFromClipboard(i)})),this.on(Oe(e),"Esc",(function(e,i){return t.PurgeClipboard(e,i)})),this.on(this.State.$changes,"mode",(function(){webix.UIManager.setFocus(e)})),this.on(this.State.$changes,"clipboard",(function(t,i){t?webix.html.addCss(e.$view,"webix_scheduler_clipboard_target"):i&&webix.html.removeCss(e.$view,"webix_scheduler_clipboard_target")})),this.on(this.app,"events:rendered",(function(){t.RestoreClipboardSource(e)})),this.$multi?this._globalClickHandler=webix.event(this.List.$view,"click",(function(){t.State.clipboard&&t.State.clipboard.source&&t.ChangePasteTarget(t.List.$view)})):this.on(e,"onItemClick",(function(i,n,r){t.State.clipboard&&t.State.clipboard.source&&("timeline"===t.State.mode&&(r=t.CreatePasteTarget(e,n)),t.ChangePasteTarget(r))}))}function ze(){this._globalClickHandler&&(webix.eventRemove(this._globalClickHandler),this._globalClickHandler=null)}function je(e,t){var i=e.getScrollState(),n=t.clientX-e.$view.offsetLeft+i.x,r=t.clientY-e.$view.offsetTop+i.y;this.mousePosUnit=Math.floor(n/this.Scales.cellWidth);var o=webix.html.create("div"),a=this.GetSectionHeight();o.style.top=r-r%a+"px",o.style.left=n-n%this.Scales.cellWidth+"px",o.style.width=this.Scales.cellWidth+"px",o.style.height=a+"px",o.style.position="absolute";var s=e.$view.firstChild;return s.insertBefore(o,s.childNodes[0]),o}function Ne(e){webix.html.addCss(e,"webix_scheduler_paste_target"),this.State.clipboard.target=e}function We(){var e=this.State.clipboard;if(e&&e.target){if(webix.html.removeCss(this.State.clipboard.target,"webix_scheduler_paste_target"),"timeline"===this.State.mode&&e.target.parentNode){var t=e.target;t.parentNode.removeChild(t)}this.State.clipboard.target=null}}function Ye(e){this.State.clipboard.target!==e&&(this.ClearPasteTargetStyle(),this.SetPasteTargetStyle(e))}function Ge(e,t,i){return t&&e.contains(t)?t:e.querySelectorAll('[webix_e_id="'+i+'"]')[0]||e.querySelectorAll('[webix_l_id="'+i+'"]')[0]}function Ke(e,t){var i=this.State.selected;if(i&&"0"!==i.id){this.ClearPasteTargetStyle();var n=Ge(e.$view,i.node,i.date||i.id);n&&this.SetClipboardSourceStyle(t,n);var r=this.GetEvent(i.date||i.id);this.State.clipboard={mode:t,selected:webix.copy(r),source:n}}}function Qe(e,t){var i="webix_scheduler_"+e;-1===t.className.indexOf(i)&&webix.html.addCss(t,i);var n="webix_scheduler_"+this.clipboardModes[1^this.clipboardModes.indexOf(e)];webix.html.removeCss(t,n);var r=this.State.clipboard;r&&r.source&&t!=r.source&&(webix.html.removeCss(this.State.clipboard.source,i),webix.html.removeCss(this.State.clipboard.source,n))}function Xe(e){var t=this.State.clipboard;if(t){var i=Ge(e.$view,t.source,t.selected.id);i&&(i!==t.source&&(this.State.clipboard.source=i),this.SetClipboardSourceStyle(t.mode,i))}}function Je(e){var t=this.State.clipboard;if(t&&t.source){var i=this.GetEventData(t,e);"copy"===t.mode?this.CopyEvent(i):"cut"===t.mode&&this.MoveEvent(i),this.PurgeClipboard()}}function Ze(e,t){var i=e.selected,n=Math.floor(i.end_date-i.start_date)/6e4;if(i.start_date=this.GetTargetDate(t.target.getAttribute("webix_l_id")),i.end_date=webix.Date.add(i.start_date,n,"minute",!0),"units"===this.State.mode)i.units=this.Unit.id;else if("timeline"===this.State.mode){var r=t.target.getAttribute("webix_l_id");r&&(i.section=r)}return i}function et(e){var t=this;Ve.call(this,e),this.Ops.addEvent(e,!0).then((function(i){return t.UpdateSelection(i,e)}))}function tt(e){var t=this;if(e.recurring){var i=ke(e.id,e),n=e.$id;Ve.call(this,e),this.Ops.updateEvent(n,{recurring:i},"this",e.start_date,!0).then((function(){return t.Ops.addEvent(e,!0).then((function(i){return t.UpdateSelection(i,e)}))}))}else{var r={start_date:e.start_date,end_date:e.end_date};e.units&&(r.units=e.units),e.section&&(r.section=e.section),this.Ops.updateEvent(e.id,r,null,null,!0).then((function(){t.UpdateSelection(e.id,e)}))}}function it(){var e=this.State.clipboard;if(e){var t=e.mode,i=e.source;return webix.html.removeCss(i,"webix_scheduler_"+t),this.ClearPasteTargetStyle(),this.State.clipboard=null,!1}}function nt(e,t,i){e.AddToClipboard=Ke,e.SetClipboardSourceStyle=Qe,e.RestoreClipboardSource=Xe,e.PasteFromClipboard=Je,e.GetEventData=Ze,e.CopyEvent=et,e.MoveEvent=tt,e.ClearPasteTargetStyle=We,e.SetPasteTargetStyle=Ne,e.ChangePasteTarget=Ye,e.CreatePasteTarget=je,e.PurgeClipboard=it,i&&i.multi&&(e.$multi=!0,e.destroy=ze),He.call(e,t)}var rt,ot,at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i=webix.skin.$active,n={view:"toolbar",borderless:!0,padding:{left:i.layoutPadding.form-(i.inputHeight-20)/2,right:14},elements:[{view:"icon",icon:"wxi-close",hotkey:"esc",click:function(){return e.Back()}},{},{width:130,view:"button",localId:"edit",label:t("Edit"),css:"webix_primary",click:function(){this.$scope.StartAction("Edit",this.$view)}}]};return this.app.config.copypaste&&n.elements.splice(-1,0,{view:"icon",icon:"shi-content-copy",tooltip:t("Copy event"),click:function(){return e.CopyEvent()}}),{view:"proxy",body:{margin:0,rows:[n,{type:"form",padding:{right:16},borderless:!0,rows:[{localId:"text",view:"template",css:"webix_scheduler_info",template:function(t){return t.start_date?e.InfoTemplate(t):""},borderless:!0},{view:"button",localId:"remove",label:t("Delete event"),css:"webix_danger webix_scheduler_danger",align:"center",inputWidth:330,click:function(){this.$scope.StartAction("Delete",this.$view)}}]}]}}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.UnitsLocal=this.app.getService("local").units(!0),this.on(this.State.$changes,"readonly",(function(t){var i=t?"hide":"show";e.$$("edit")[i](),e.$$("remove")[i]()}));var t=this.$$("text");this.on(this.State.$changes,"selected",(function(i){i&&(e.EventObj=e.app.getService("local").events(!0).getItem(i.id),t.setValues(e.EventObj))})),this.Menu=this.ui(oe),this.app.config.units&&this.app.getService("local").units().then((function(){t.refresh()})),this.app.config.timeline&&this.app.getService("local").sections().then((function(i){e.Sections=i,t.refresh()}))},t.prototype.StartAction=function(e,t){var i=this;this.app.config.recurring&&("string"==typeof this.State.selected.date||this.EventObj.origin_id)?this.Menu.Show(t).then((function(t){"Delete"===e?i.DeleteEvent(t):i.EditEvent(t)})):"Delete"===e?this.DeleteEvent():this.EditEvent()},t.prototype.EditEvent=function(e){var t=this.getParam("compact",!0)?"event.formpopup/":"../";this.show(t+"event.form",{target:"edit",params:{mode:e}})},t.prototype.DeleteEvent=function(e){var t=this,i=this.app.getService("locale")._;webix.confirm({title:i("Delete event"),text:i("The event will be deleted permanently, are you sure?"),container:this.app.getRoot().$view}).then((function(){var i=t.EventObj,n="";e&&"all"!==e&&(t.State.selected?n=t.State.selected.date:i.$id&&(n=i.id)),t.app.getService("operations").removeEvent(t.EventObj,e,n),t.Back(!0)}))},t.prototype.CopyEvent=function(){var e=webix.copy(this.EventObj);Ve.call(this,e),this.State.$batch({selected:{id:"0"},clipboard:{mode:"copy",selected:e}})},t.prototype.Back=function(e){if(e){var t=this.State.clipboard;t&&(t.selected.id===this.EventObj.id||t.selected.id.indexOf("_"+this.EventObj.id)>-1)&&(this.State.clipboard=null)}this.State.selected=null},t.prototype.InfoTemplate=function(e){var t=this,i=this.app.getService("locale")._;this.app.config.recurring&&this.State.selected.date&&(e=r(r({},e),Se(e,this.State.selected.date)));var n=[e.start_date,e.end_date],o=n[0],a=n[1],s=webix.Date.equal(webix.Date.datePart(o,!0),webix.Date.datePart(a,!0)),l=webix.Date.equal(webix.Date.datePart(o,!0),o)&&webix.Date.equal(webix.Date.datePart(a,!0),a)&&e.all_day,c=webix.i18n.timeFormatStr,u=webix.i18n.longDateFormatStr,h='<div class="webix_scheduler_event_title">'+(e.text||i("(No title)"))+"</div>",p=u(o),d=u(a),_=c(o),f=c(a),b="";s?(b='<div class="webix_scheduler_event_text">'+p+"</div>",l||(b+='<div class="webix_scheduler_event_text">'+i("from")+" "+_+" "+i("to")+" "+f+"</div>")):b='<div class="webix_scheduler_event_text">'+i("from")+" "+(l?"":_)+" "+p+'</div><div class="webix_scheduler_event_text">'+i("to")+" "+(l?"":f)+" "+d+"</div>";var g=this.app.config.recurring&&e.recurring?this.GetRecurringText(e,i):"",w="";if(this.app.config.units){if(w+='<div class="webix_scheduler_event_units_title">'+i("Assigned to units")+':</div><div class="webix_scheduler_event_units">',e.units){var A=e.units.split(",");A.forEach((function(e,n){var r=n===A.length-1,o=t.UnitsLocal.getItem(e),a=o&&o.value?o.value:i("Unknown unit");w+='<div class="webix_scheduler_event_unit_item">'+a+(r?"":",")+"</div>"}))}else w+=i("No units");w+="</div>"}var x=this.app.config.timeline&&this.Sections?this.GetSection(e,i):"",v="";return e.details&&(v='<div class="webix_scheduler_event_details_title">'+i("Notes")+'</div>\n\t\t\t\t<div class="webix_scheduler_event_text">'+e.details.replace(/(?:\r\n|\r|\n)/g,"<br>")+"</div>"),h+"\n\t\t\t<div class='webix_scheduler_event_from_to'>"+b+"</div>\n\t\t\t<div class='webix_scheduler_event_recurring_pattern'>"+g+"</div>"+w+x+v},t.prototype.GetRecurringText=function(e,t){var i=e.$recurring,n=i.INTERVAL&&i.INTERVAL>1?i.INTERVAL:"",r="";return i.BYDAY?r=" "+t("on")+" "+(i.BYSETPOS||"")+" "+i.BYDAY.split(",").map((function(e){return webix.i18n.calendar.dayFull[fe.indexOf(e)]})).join(", ")+" "+(i.BYMONTH?t("of")+" "+webix.i18n.calendar.monthFull[i.BYMONTH-1]:""):i.BYMONTHDAY?r=(i.BYMONTHDAY?" "+t("on")+" ":"")+(i.BYMONTH?(i.BYSETPOS?t("of"):"")+" "+webix.i18n.calendar.monthFull[i.BYMONTH-1]:"")+(i.BYMONTHDAY?" "+i.BYMONTHDAY:""):i.BYYEARDAY&&(r=t("day")+" "+i.BYYEARDAY),t("Repeats each")+" "+n+" "+t(be[i.FREQ]+(n?"s":""))+" "+r+(i.COUNT?", "+i.COUNT+" "+t("times"):i.UNTIL?" "+t("till")+" "+webix.i18n.longDateFormatStr(i.UNTIL):"")},t.prototype.GetSection=function(e,t){var i=this.Sections.getItem(e.section);return i?'<div class="webix_scheduler_section_tpl"><span class="webix_scheduler_section_title">'+t("Section")+":</span> "+i.text+"</div>":""},t}(p),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._,i={margin:webix.skin.$active.layoutMargin.form,cols:[{view:"button",value:t("Cancel"),hotkey:"esc",click:function(){return e.Cancel()}},{view:"button",value:t("Apply"),css:"webix_primary",hotkey:"enter",click:function(){return e.Done()}}]};return this.app.getService("jet-win").updateConfig({view:"window",head:t("Edit recurring event"),autoheight:!0,css:"webix_scheduler_action_popup",body:{type:"form",padding:{top:0},width:340,rows:[{view:"radio",localId:"option",vertical:!0,options:[{id:"this",value:t("This event")},{id:"next",value:t("This event and the following")},{id:"all",value:t("All events")}]},i]},on:{onHide:function(){return e.Result=null}}})},t.prototype.init=function(e){this.Root=e},t.prototype.Show=function(e){this.Result=e,this.$$("option").setValue("this"),this.Root.show()},t.prototype.Done=function(){var e=this.$$("option").getValue();this.Result&&this.Result.resolve(e),this.Root.hide()},t.prototype.Cancel=function(){this.Result&&this.Result.reject(),this.Root.hide()},t}(p),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){z||(z=!0,webix.protoUI({name:"r-layout",sizeTrigger:function(e,t,i){this._compactValue=i,this._compactHandler=t,this._app=e;var n=e.config;this._forceCompact=void 0!==n.params.forceCompact,this._compactWidth=n.compactWidth,this._forceCompact||this._checkTrigger(this.$view.width,i)},_checkTrigger:function(e,t){return!this._compactWidth||!(e<=this._compactWidth&&!t||e>this._compactWidth&&t)||(this._compactWidth=null,this._compactHandler(!t),!1)},$setSize:function(e,t){(this._forceCompact||this._checkTrigger(e,this._compactValue))&&webix.ui.layout.prototype.$setSize.call(this,e,t),this._app&&this._app.callEvent("view:resize",[])}},webix.ui.layout));var e=this.getParam("forceCompact");webix.isUndefined(e)||this.setParam("compact",e),this.Compact=this.getParam("compact"),this.Calendars=!this.Compact&&this.app.config.calendars;var t=[re,{view:"r-layout",localId:"main",cols:[{$subview:!0}]}];return this.Compact?t.push({$subview:!0,name:"edit",popup:!0}):t[1].cols.push({view:"proxy",width:400,localId:"edit",css:"webix_shadow_medium",borderless:!0,hidden:!0,body:{$subview:!0,name:"edit"}}),this.Calendars&&t[1].cols.unshift({view:"proxy",localId:"side",borderless:!0,body:ie,hidden:!0}),{css:"webix_scheduler",view:"abslayout",cells:[{relative:!0,margin:0,rows:t},{view:"proxy",css:"webix_scheduler_absbutton",body:Y,localId:"add",borderless:!0,right:20,bottom:20,hidden:!this.Compact}]}},t.prototype.init=function(e){var t=this;this.$$("main").sizeTrigger(this.app,(function(e){return t.SetCompactMode(e)}),!!this.Compact),webix.extend(e,webix.ProgressBar),this.on(this.app,"backend:operation",(function(t){e.showProgress({type:"top",delay:2e3}),t.finally((function(){e.hideProgress()}))})),this.Calendars&&this.$$("side").show();var i=this.app.getState();this.on(i.$changes,"mode",(function(e){t.show("./modes."+e)})),this.on(i.$changes,"readonly",(function(e){t.ToggleAdd(e)})),this.on(i.$changes,"selected",(function(e,i){return t.ToggleEvent(e,i)})),this.on(this.app,"show:panel",(function(){return t.ToggleSidePanel()})),W(this.getRoot()).then((function(){return t.app._dndActionPopup=t.ui(st)}))},t.prototype.ToggleEvent=function(e,t){e?this.ShowEvent(e,t):t&&this.HideEvent()},t.prototype.ShowEvent=function(e,t){var i=t&&t.id==e.id,n=this.getSubView("edit"),r=n&&i?n.getUrl()[0].page:"event."+("0"===e.id?"form":"info");this.Compact?this.show("event.formpopup/"+r,{target:"edit"}):(this.ToggleSidePanel("hide"),this.$$("edit").show(),this.show(r,{target:"edit"}))},t.prototype.HideEvent=function(){this.show("_blank",{target:"edit"}),this.Compact||(this.$$("edit").hide(),this.ToggleSidePanel("show"))},t.prototype.SetCompactMode=function(e){var t=this;webix.delay((function(){t.setParam("compact",e),e||webix.fullscreen.exit(),t.refresh()}))},t.prototype.ToggleSidePanel=function(e){var t=this.$$("side");t&&("show"!==e&&t.isVisible()?(this._sidePanel="hide"===e,t.hide()):(!e||this._sidePanel&&"hide"!==e)&&(t.show(),this._sidePanel=!1))},t.prototype.ToggleAdd=function(e){var t=this.$$("add");e?t.hide():this.Compact&&t.show()},t}(p);function ct(e){var t=function(e){var t=webix.color.toRgb(e),i=t[0],n=t[1],r=t[2];return webix.color.rgbToHsv(i,n,r)}(e),i=t[0],n=t[1];return i*=.95,n*=.4,"rgb("+webix.color.hsvToRgb(i,n,rt)+")"}function ut(e){var t=e.color||e.$color;return'<div class="webix_event_marker"><div class="webix_event_marker_inner" style="background-color:'+(e.$past?ct(t):t)+';"></div></div>'}function ht(e){return function(t,i){return'<div class="webix_event_overall '+(t.$past?"webix_scheduler_past_event":"")+'"><div class="webix_event_time">'+i.timeStart(t)+"</div>"+ut(t)+'<div class="webix_event_text">'+(t.text||e("(No title)"))+"</div></div>"}}function pt(e){var t=e.color||e.$color;return"border-color:"+(e.$past?ct(e.$color):e.$color)+"; background-color:"+(e.$past?ct(t):t)+"; color:"+(e.$past?ot:e.$textColor)+";"}function dt(e,t){return'<div class="start">'+webix.i18n.timeFormatStr(e)+'</div><div class="end">'+webix.i18n.timeFormatStr(t)+"</div>"}function _t(e,t,i){var n=t.master;return n["$"+i]-(n.config["width"==i?"xCount":"yCount"]-1)*t[i]}function ft(e,t,i){var n=t.width,r=t.height;return e.right&&(n=_t(0,t,"width")),e.bottom&&(r=_t(0,t,"height")),'<div webix_l_id="'+e.id+'" class="'+t.classname(e,t,i)+'" '+t.aria(e,t,i)+' style="width:'+n+"px; height:"+r+'px; float:left; overflow:hidden;">'}webix.ready((function(){var e="contrast"===webix.skin.$name||"dark"===webix.skin.$name;rt=e?.35:.75,ot=e?"#9f9d9d":"#ffffff"}));var bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{view:"unitlist",localId:"list",uniteBy:function(){return"custom"},type:{template:ht(this.app.getService("locale")._),templateHeader:function(t){return e.TemplateHeader(t)},timeStart:function(t){return e.TimeStart(t)},height:50},on:{onUnits:function(){return e.SetUnits()},onItemClick:function(t,i){return e.ShowEvent(t,i)}}}},t.prototype.init=function(){this.State=this.app.getState(),this.List=this.$$("list"),webix.extend(this.List,webix.OverlayBox)},t.prototype.ShowEvent=function(e,t){var i=me(this.List.getItem(e));i.node=t,this.State.selected=i},t.prototype.ToggleOverlay=function(){if(this.List.count())this.List.hideOverlay();else{var e=this.app.getService("locale")._;this.List.showOverlay(e("No Events"))}},t.prototype.SetUnits=function(){var e=this.List.units,t=this.data.all;if(Object.keys(e).length){this.List.units={};for(var i=this.data.start,n=this.data.end,r=function(){var e=webix.Date.add(i,1,"day",!0),n=t.filter((function(t){return t.start_date<e&&(t.end_date>i||t.end_date>=i&&t.all_day)})).map((function(e){return e.id}));n.length&&(o.List.units[i.valueOf()]=n),i=webix.Date.add(i,1,"day",!0)},o=this;i<n;)r()}},t.prototype.TimeStart=function(e){var t=this.app.getService("locale")._;return le(e)?t("All Day"):dt(e.start_date,e.end_date)},t}(p),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=this,i=this.getParam("compact",!0),n=e.prototype.config.call(this);return n.css="webix_scheduler_agenda",webix.extend(n.type,{height:"auto",headerHeight:50,classname:function(e){return t.TemplateCss(e)}},!0),webix.extend(n.on,{onItemRender:function(e){e.$unit&&(t.CurrentUnit=e.$unit)},onItemClick:function(e,n,r){r=r.firstChild,t.ShowEvent(e,r),i||t.SelectEvent(r)}},!0),n},t.prototype.init=function(){var t=this;e.prototype.init.call(this),this.Data=this.app.getService("local");var i=this.Data.events(!0);this.on(this.State.$changes,"date",(function(){return t.RefreshData()})),this.on(this.State.$changes,"active",(function(){return t.RefreshData()})),this.on(this.State.$changes,"selected",(function(e){e||t.SelectEvent()})),this.on(this.app,"events:refresh",(function(){return t.RefreshData()})),this.on(i.data,"onStoreUpdated",(function(e,i,n){return n&&t.RefreshData()}))},t.prototype.RefreshData=function(){var e=this,t=webix.Date.monthStart(this.State.date),i=webix.Date.add(t,1,"month",!0);this.Data.getEvents(t,i).then((function(n){e.data={all:n,start:t,end:i},e.app&&(e.List.clearAll(),e.List.parse(n.map(ae(t,i))),e.ToggleOverlay())}))},t.prototype.SelectEvent=function(e){if(e!=this._selected){var t="webix_agenda_selected";this._selected&&webix.html.removeCss(this._selected,t),e&&webix.html.addCss(e,t),this._selected=e}},t.prototype.TemplateHeader=function(e){var t=new Date(1*e),i="%F <span class='webix_scheduler_monthday"+(se(t)?" webix_scheduler_today":"")+"'>%j</span><br><span class='webix_scheduler_dayofweek'>%l</span>";return webix.Date.dateToStr(i)(t)},t.prototype.TemplateCss=function(e){var t=this.List.getUnitList(this.CurrentUnit),i="webix_list_item";return e.id==t[t.length-1]&&(i+=" webix_event_last"),e.id==t[0]&&(i+=" webix_event_first"),i},t}(bt),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{view:"list",borderless:!0,localId:"scale",css:"webix_scheduler_scale",type:{height:42,heightSize:function(t,i){var n=e.List.getIndexById(t.id);return i.height-(0===n?17:0)+"px"}},scroll:!1,autoheight:!0,width:51,template:function(t){return e.HourScaleItem(t)}}},t.prototype.init=function(){this.List=this.$$("scale"),this.ParseHours()},t.prototype.ParseHours=function(){for(var e=[],t=0;t<24;t++)e.push({id:t+""});this.List.parse(e)},t.prototype.HourScaleItem=function(e){return 0===this.List.getIndexById(e.id)?"":(e.id<10?"0":"")+e.id+":00"},t}(p),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{cols:[{view:"template",localId:"more",width:50,css:"webix_scheduler_multi_space",tooltip:function(){return""},onClick:{"wxi-angle-down":function(){return e.ExpandData()},"wxi-angle-up":function(){return e.WrapData()}}},{}]}},t.prototype.init=function(){this.List=this.$$("multiDayList"),this.MoreIcon=this.$$("more"),this._expandState="down",this.maxVisibleLines=3},t.prototype.SetMoreIcon=function(e){if(e){var t="up"===e?"Collapse":"Expand",i=this.app.getService("locale")._;this.MoreIcon.setHTML('<div class="webix_scheduler_more_icon webix_icon wxi-angle-'+e+'" webix_tooltip="'+i(t+" all-day events")+'"><div>')}else this.MoreIcon.setHTML("")},t.prototype.Animate=function(e,t,i){var n=this;this.List.$view.style.transition="height 150ms",t&&(this.List.$view.style.height=t+"px"),setTimeout((function(){i&&i(),n.List.$view.style.transition="",n._inAnimation=!1,n.SetMoreIcon(e)}),150)},t}(p);function xt(e,t){var i=this.LocateSelected(e);if(i)for(var n=0;n<i.length;n++)t(i[n],"webix_scheduler_event_selected")}function vt(e){return xt.call(this,e,webix.html.addCss)}function mt(e){return xt.call(this,e,webix.html.removeCss)}function yt(){var e=this,t=this._SelectionMode;if(this.State=this.app.getState(),this.on(this.State.$changes,"selected",(function(i,n){if(n&&e.Unselect(n.date&&"string"==typeof n.date?n.date:n.id),i){var r="0"!==i.id&&i.date?i.date:i.id;setTimeout((function(){return e.Select(r)}),"multi"!==t&&"0"===r?150:0)}})),"multi"!==t){var i=this.app.getService("local").events(!0);this.on(i.data,"onStoreUpdated",(function(t,i,n){"add"===n&&"0"!=t&&e.State.selected&&"0"===e.State.selected.id&&(e.State.selected.id=t)}))}}function Ct(e,t,i){e._SelectionMode=t,e.Select=vt,e.Unselect=mt,e.HandleSelection=yt,e.LocateSelected=function(e){return function(t){return this._DataObj?Array.prototype.map.call(this._DataObj.querySelectorAll("[webix_"+(e?"l":"e")+'_id="'+t+'"]'),(function(t){return e?t.firstElementChild:t})):null}}(i),e.HandleSelection()}var kt,St={$dragIn:function(){return this.getContext().from.mode===this.mode},$dragPos:function(e){var t=this.getContext(),i=webix.html.offset(t.target),n=e.y-i.y;n<t.y_diff?n=t.y_diff:n>i.height&&(n=i.height);var r=n-t.y_diff;St.updateNodeHeight.call(this,r),t.duration!==r&&(t.duration=r,this.updateText(t)),e.x=t.x_diff,e.y=t.y_diff},updateNodeHeight:function(e){webix.DragControl.getNode().style.height=Math.max(this.master.minEventHeight,e)+"px"},getActualDate:function(e,t){var i=this.getContext(),n=webix.Date.copy(i.event.start_date),r=5*(Math.round(60*i.duration/e.List.type.height/5)||1);return webix.Date.add(n,r,"minute"),!t&&webix.Date.equal(n,i.event.end_date)?null:{start_date:webix.Date.copy(i.event.start_date),end_date:n}}},Bt=function(e,t){return function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=webix.Date;function n(e,t){return i.add(e,1*t,"day",!0)}function r(e,t){return(e=new Date(e)).setHours(0,0,0,0),(t=new Date(t)).setHours(0,0,0,0),Math.round((e.getTime()-t.getTime())/864e5)}function o(e,t){return 24*r(e,t)+(e.getHours()-t.getHours())}var a={};function s(e,t){return l(t)(e)}function l(e){var t=a[e];return t||(t=a[e]=i.dateToStr(e)),t}function c(e){var t=e.getDay();return i.startOnMonday&&(0===t?t=6:t--),t}var u={year:function(e,t){return e.getFullYear()-t.getFullYear()},quarter:function(e,t){return 4*(e.getFullYear()-t.getFullYear())+(Math.floor(e.getMonth()/3)+1)-(Math.floor(t.getMonth()/3)+1)},month:function(e,t){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())},week:function(e,t){var i=r(e,t)/7,n=c(e),o=c(t);return Math.ceil(Math.abs(i)-(n<=o?0:1))*Math.sign(i)},day:r,hour:o,minute:function(e,t){return 60*o(e,t)+(e.getMinutes()-t.getMinutes())}},h={year:["quarter",4],quarter:["month",3],month:["day",function(e){if(!e)return 30;var t=e.getMonth();if(1===t){var i=e.getFullYear();return i%4?28:i%100?29:i%400?28:29}return t%2&&t<7||!(t%2)&&t>7?30:31}],week:["day",7],day:["hour",24],hour:["minute",60]},p={year:function(e,t){return i.add(e,1*t,"year",!0)},quarter:function(e,t){return i.add(e,3*t,"month",!0)},month:function(e,t){return i.add(e,1*t,"month",!0)},week:function(e,t){return i.add(e,1*t,"week",!0)},day:n,hour:function(e,t){return i.add(e,1*t,"hour",!0)},minute:function(e,t){return i.add(e,1*t,"minute",!0)}};function d(e,t,i,n,r){var o=n?h[e][0]:e,a=i,s=t;if(r&&(a=g(o,i),(s=g(o,t))<t&&(s=b(o)(s,1))),n){var l=u[o](s,a),c=h[e][1];return l/("number"==typeof c?c:c(i))}return u[o](s,a)}function _(e){return function(t,i,n,r){return"month"===e&&n?function(e,t,i){if(f(t,e))return d("month",e,t,!0,i);var n=0;if(t.getDate()>1){var r=new Date(t.getFullYear(),t.getMonth()+1,1);n=d("month",r,t,!0),t=r}var o=0;return f(t,e)||(o=d("month",webix.Date.monthStart(e),t),t=webix.Date.add(t,o,"month",!0)),n+o+d("month",e,t,!0)}(t,i,r):d(e,t,i,n,r)}}function f(e,t){return webix.Date.equal(webix.Date.monthStart(e),webix.Date.monthStart(t))}function b(e){return p[e]}function g(e,t){var i;switch(e){case"year":return new Date(t.getFullYear(),0,1);case"quarter":return new Date(t.getFullYear(),3*Math.floor(t.getMonth()/3),1);case"month":return new Date(t.getFullYear(),t.getMonth(),1);case"week":return(i=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setDate(t.getDate()-c(t)),i;case"day":return(i=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setHours(0,0,0,0),i;case"hour":return(i=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setHours(t.getHours(),0,0,0),i;default:return new Date(t)}}function w(e,t,i,n,r){var o=i.start,a=i.end,s=i.cellWidth,l=i.cellHeight,c=i.diff,u=i.minUnit,h=i.precise,p=e.start_date<o?o:e.start_date,d=e.end_date>a?a:e.end_date,_=g(u,o),f="milestone"==e.type;e.$h=n,e.$x=Math.round(c(p,_,h)*s)-(f?e.$h/2:0),e.$w=f?e.$h:Math.round(c(d,p,h,!0)*s),e.$y=webix.isUndefined(r)?l*t+(l-n)/2:r}function A(e){e.duration=0,e.end_date=e.start_date}function x(e){return e.duration<1?b("hour")(e.start_date,Math.floor(24*e.duration)):b("day")(e.start_date,e.duration)}function v(e,t){if(e.duration<1)return x(e);for(var r=function(e){return i.datePart(e,!0)}(e.start_date),o=0,a=0;o<e.duration;)t.isHoliday(r)?30==++a&&C():(++o,a=0),r=n(r,1);return r}function m(e,t){var i=_("day")(e.end_date,e.start_date,!0);if(i<1)return parseFloat(i.toFixed(2));if(!t)return Math.floor(i);for(var r=e.start_date,o=0;r<e.end_date;)t.isHoliday(r)||++o,r=n(r,1);return o}function y(e,t){for(var i,r=e,o=e,a=0;a<30&&(i=t.isHoliday(o))&&t.isHoliday(r);)r=n(r,-1),o=n(o,1),a++;return 30===a&&C(),i?r:o}function C(){throw alert("No work days found within 30 days, check your isHoliday function!","error"),"Wrong isHoliday function"}function k(e,t,i,r){for(var o=0;o<30&&i.isHoliday(S(e,t));)e=n(e,r),o++;return 30===o&&C(),e}function S(e,t){return t&&!function(e){return i.timePart(e)}(e)?n(e,-1):e}t.addUnit=b,t.getDiff=_,t.getUnitStart=g,t.grid=function(e,t,i){var n=document.createElement("canvas");n.setAttribute("width",e),n.setAttribute("height",t);var r=n.getContext("2d");return r.strokeStyle=i,r.moveTo(0,t),r.lineTo(e,t),r.lineTo(e,0),r.stroke(),n.toDataURL()},t.newLink=function(e,t,i){if(t&&i){var n=i.x-t.x,r=i.y-t.y,o=(n>0?t.x:i.x)-e.left,a=(r>0?t.y:i.y)-e.top,s=(n>0?0:-n)+","+(r>0?0:-r)+","+(n>0?n:0)+","+(r>0?r:0);return{width:Math.abs(n),height:Math.abs(r),left:o,top:a,p:s}}return null},t.resetScales=function(e,t,i,n,r,o,a){var u=function(e){var t=new Date;return e.map((function(e){return{item:e,len:b(e.unit)(t,1)}})).sort((function(e,t){return e.len<t.len?-1:1}))[0].item.unit}(o),h=_(u),p=g(u,t);e=g(u,e),t=p<t?b(u)(p,1):p;var d=h(t,e)*n,f=r*o.length;return{rows:o.map((function(i){for(var o=[],a=b(i.unit),p=i.step||1,d="week"===u&&"week"!==i.unit,_=g(i.unit,e);_<t;){var f=a(_,p);_<e&&(_=e),f>t&&(f=t);var w=_,A=f;d&&(c(_)>3&&(w=webix.Date.add(_,1,"week",!0)),c(f)>3&&(A=webix.Date.add(f,1,"week",!0)));var x=(h(A,w)||1)*n,v="function"==typeof i.format?i.format(_,f):s(_,i.format),m="";i.css&&(m+="function"==typeof i.css?i.css(_):i.css),o.push({width:x,value:v,css:m,date:_,format:l(i.format)}),_=f}return{cells:o,add:a,height:r,type:i.unit,step:i.step||1}})),width:d,height:f,cellWidth:n,cellHeight:r,diff:h,start:e,end:t,minUnit:u,precise:i=!!("day"===u?i:0!=i),isHoliday:a}},t.smallerCount=h,t.updateLink=function(e,t,i,n){var r,o,a,s,l=Math.round(n/2);if(!t||!i)return e.$p="",e;var c,u,h=!1,p=!1;switch(e.type){case 0:p=!0;break;case 1:h=!0,p=!0;break;case 3:h=!0}if(r=h?t.$x:t.$x+t.$w,o=t.$y,a=p?i.$x:i.$x+i.$w,s=i.$y,function(e,t,i,n,r){return"milestone"===e.type||"milestone"===t.type?Math.abs(i-n)>r/2:i!==n}(t,i,r,a,n)||o!==s){var d=function(e,t,i,n,r,o,a){var s=e+20*(r?-1:1),l=i+20*(o?-1:1),c=[e,t,s,t,0,0,0,0,l,n,i,n],u=l-s,h=n-t,p=o===r;return!p&&(l<=e&&o||l>e&&!o)&&(h-=19),p&&o&&s>l||p&&!o&&s<l?(c[4]=c[2]+u,c[5]=c[3],c[6]=c[4],c[7]=c[5]+h):(c[4]=c[2],c[5]=c[3]+h,c[6]=c[4]+u,c[7]=c[5]),c.join(",")}(r,o+l,a,s+l,h,p),_=(c=a,u=s+l,p?c-5+","+(u-3)+","+(c-5)+","+(u+3)+","+c+","+u:c+5+","+(u+3)+","+(c+5)+","+(u-3)+","+c+","+u);e.$p=d+","+_}else e.$p="";return e},t.updateTask=function(e,t,i,n,r){return"split"===e.type&&e.$data&&e.$data.length?e.$data.forEach((function(e){return w(e,t,i,n)})):w(e,t,i,n,r),e},t.updateTaskDuration=function(e,t,i,n){e.start_date&&e.end_date&&e.start_date.valueOf()>=e.end_date.valueOf()&&(e.end_date=null,e.duration=1,i&&(i="move")),t?function(e,t,i,n){if("milestone"==e.type)return e.start_date=i?k(e.start_date,!1,t,n):y(e.start_date,t),A(e);i?"start"==i||"move"==i?(e.start_date=k(e.start_date,!1,t,n),e.duration||(e.duration=m(e,t)),e.end_date||(e.end_date=v(e,t))):(e.end_date||(e.end_date=v(e,t)),e.duration||(e.end_date=k(e.end_date,!0,t,n),e.duration=m(e,t))):(e.start_date=y(e.start_date,t),e.end_date=v(e,t),e.duration=m(e,t))}(e,t,i,n):"milestone"==e.type?A(e):(e.duration||(e.duration=m(e)),e.end_date||(e.end_date=x(e)))}}(t={exports:{}},t.exports),t.exports}();(kt=Bt)&&kt.__esModule&&Object.prototype.hasOwnProperty.call(kt,"default")&&kt.default;var $t=Bt.addUnit,Dt=(Bt.getDiff,Bt.getUnitStart),Et=Bt.grid,Tt=(Bt.newLink,Bt.resetScales),Lt=Bt.smallerCount,It=(Bt.updateLink,Bt.updateTask);Bt.updateTaskDuration;var qt={start:function(e,t){e._auto_scroll_delay=webix.delay(qt.autoScroll,e,[t,webix.html.pos(t)],250)},reset:function(e){e._auto_scroll_delay&&(e._auto_scroll_delay=window.clearTimeout(e._auto_scroll_delay))},autoScroll:function(e,t){var i=-1!==this.direction.indexOf("y"),n=-1!==this.direction.indexOf("x"),r=webix.html.offset(this.from.view.$view),o=!1;i&&qt.autoYScroll.call(this,t,r,this.senseY)&&(o=!0),n&&qt.autoXScroll.call(this,t,r,this.senseX)&&(o=!0),o&&(function(e,t){if(webix.DragControl.active){var i=webix.DragControl.getNode();t=webix.copy(t),webix.DragControl.$dragPos(t,e),i.style.top=t.y+webix.DragControl.top+"px",i.style.left=t.x+webix.DragControl.left+"px"}}(e,t),this._auto_scroll_delay=webix.delay(qt.autoScroll,this,[e,t],100))},autoYScroll:function(e,t,i){var n=this.from.view.getScrollState();return e.y<t.y+i?qt.autoScrollTo.call(this,n.x,n.y-i,"y"):e.y>t.y+t.height-i&&qt.autoScrollTo.call(this,n.x,n.y+i,"y")},autoXScroll:function(e,t,i){var n=this.from.view.getScrollState();if(e.x<t.x+i)return qt.autoScrollTo.call(this,n.x-i,n.y,"x");if(e.x>t.x+t.width-i){var r=this.snode?Math.min(n.x+i,this.snode.scrollWidth-t.width):n.x+i;return r!=n.x&&qt.autoScrollTo.call(this,r,n.y,"x")}return!1},autoScrollTo:function(e,t,i){this.from.view.scrollTo(e,t),this.from.view.callEvent("onAfterAutoScroll",[]);var n=this.from.view.getScrollState();return Math.abs(("x"===i?e:t)-n[i])<1}};function Pt(e,t,i){var n=webix.copy(Zt[t]);n.view=e,n.master=this,n.State=this.app.getState();var r=this.app.getService("local");n.Local=r.events(!0),n.Calendars=r.calendars(!0),n.Ops=this.app.getService("operations"),webix.DragControl.addDrag(e.$view,n),i||webix.DragControl.addDrop(e.$view,n,!0)}function Rt(e,t,i){var n,r,o=e.target;do{r=(n=o.getAttribute?o.getAttribute(i||"webix_e_id"):null)?o:null,o=o.parentNode}while(!n&&o&&o!==t);return{id:n,node:r}}function Mt(e,t){if(this.State.selected){var i=me(e);e.$recurring&&(i.date=t.start_date.valueOf()+"_"+e.$id),this.State.selected=i}}function Ft(e,t,i){var n=this,o=t.$id||t.id,a=this.Local.getItem(o);if("this"===e&&this.master.HasOneOccurrence(r(r({},t),{start_date:a.start_date,end_date:a.end_date})))return this.Ops.updateEvent(o,i,void 0,void 0,!0);if(!(e=this.master.ChangeMode(e,t,this.Local.getItem(t.recurring?o:t.origin_id).start_date,t.recurring?t.id:t.start_date)))return t.$recurring=De(t.$recurring,i,t),i.recurring=_e(t.$recurring),this.Ops.updateEvent(o,i,void 0,void 0,!0);if("this"===e||"next"===e){var s,l="";"this"===e?l=ke(t.id,t):t.recurring?l=Ce(t.id,webix.copy(t)):(o=t.origin_id,s=webix.copy(this.Local.getItem(o)),l=Ce(i.start_date,webix.copy(s),!0));var c=Vt.call(this,o,e,t,i,s);return this.Ops.updateEvent(o,{recurring:l},e,webix.Date.dayStart(c.start_date),!0).then((function(){return n.Ops.addEvent(c,!0)}))}if("all"===e){var u=t.origin_id||t.$id,h=webix.copy(this.Local.getItem(u)),p=h.$recurring;return(p.COUNT||p.UNTIL)&&(p=this.master.CorrectCountUntil(h,e,i.start_date,this.Local)),!i.start_date||ue(t.start_date,i.start_date)?(i.start_date&&(i.start_date=Ot(h.start_date,i.start_date)),i.end_date&&(ue(t.end_date,i.end_date)?i.end_date=Ot(h.end_date,i.end_date):i.end_date=Ut(h.end_date,t.end_date,i.end_date))):(i.end_date||(i.start_date=Ut(h.start_date,t.start_date,i.start_date)),p=De(p,i,h)),i.start_date&&(p.EXDATE&&delete p.EXDATE,i.recurring=_e(p)),this.Ops.updateEvent(t.origin_id||o,i,e,void 0,!0)}}function Ut(e,t,i){return new Date(1*e+(i-t))}function Ot(e,t){var i=1e3*webix.Date.timePart(t);return new Date(1*webix.Date.dayStart(e)+i)}function Vt(e,t,i,n,o){var a=r(r(r({},i),n),{recurring:""});if(a.origin_id||(a.origin_id=e),"next"===t){var s=webix.copy(i.recurring?i.$recurring:o.$recurring);(s.COUNT||s.UNTIL)&&(s=this.master.CorrectCountUntil(r(r({},this.Local.getItem(e)),{$recurring:s}),t,a.start_date,this.Local)),(s=De(s,a,i)).EXDATE=[],a.recurring=_e(s)}return delete a.$id,a}var Ht={mode:"common",$longTouchLimit:!0,$dragDestroy:function(e,t){var i=this.getContext();return!i.$waitUpdate&&i.node&&(i.node.style.visibility="visible"),i.$resize&&webix.html.removeCss(document.body,"webix_active_resize"),webix.html.remove(t),"move"!==i.moveMode||i.more||qt.reset(i),!1},getContext:function(){return webix.DragControl.getContext()},setDragOffset:function(e,t,i){var n=this.getContext(),r=webix.html.pos(i),o=webix.html.offset(e);n.width=o.width,n.height=o.height,n.x_offset=o.x-r.x,n.y_offset=o.y-r.y},updateEvent:function(e,t){var i=this;if(e.$id||e.origin_id)this.master._waitPopup=webix.promise.defer(),this.master._waitPopup.then((function(n){var r=Ft.call(i,n,e,t);r.then((function(){return Mt.call(i,e,t)})),i.master.app.callEvent("backend:operation",[r])})).finally((function(){return i.master._waitPopup=null})),this.master.app._dndActionPopup.Show(this.master._waitPopup);else{var n=this.Ops.updateEvent(e.$id||e.id,t,void 0,void 0,!0);this.finishOperation(n,e,t)}},addEvent:function(e,t){var i={text:e.text,start_date:t.start_date,end_date:t.end_date,details:""};this.master.app.config.calendars&&(i.calendar=e.calendar),this.master.app.config.timeline&&(i.section=t.section||e.section),this.master.app.config.units&&e.units&&(i.units=t.units||e.units);var n=this.Ops.addEvent(i,!0);this.finishOperation(n,i,t)},copyEvent:function(e,t){var i=r(r({},e),t);Ve.call(this.master,i);var n=this.Ops.addEvent(i,!0);this.finishOperation(n,i,t)},finishOperation:function(e,t,i){var n=this,o=this.getContext();e.then((function(e){return Mt.call(n,e?r(r({},t),{id:e}):t,i)})),this.master.app.callEvent("backend:operation",[e]),o.$waitUpdate=!0}},zt=webix.extend({mode:"day",$dragIn:function(e,t){var i=this.getContext();if(i.$resize)return St.$dragIn.apply(this,arguments);if(i.from.mode!==this.mode)return!1;if(i.target!=t){var n=webix.DragControl.getNode();t.firstChild.appendChild(n),i.target=t}return!0},$drop:function(e,t,i){var n=this.getContext();webix.extend(n,{to:this});var r=this.master.app;if(n.from.mode!==this.mode||!r.callEvent("app:beforedrop",[n,i]))return!1;var o=this.getActualDate(this.master);o&&("0"==n.event.id?n.$creation?this.State.selected={id:"0",date:n.event.start_date,end_date:o.end_date}:this.addEvent(n.event,o):n.$copy&&!n.$resize?this.copyEvent(n.event,o):this.updateEvent(n.event,o))},$dragPos:function(e){var t=this.getContext();if(t.$resize)return St.$dragPos.apply(this,arguments);var i=webix.html.offset(t.target),n=i.height-t.height;e.x=t.x_diff,e.y+=t.y_offset-i.y,e.y<0?e.y=0:e.y>n&&(e.y=n),webix.extend(t,e,!0),t.$last_y!==e.y&&(this.updateText(t),t.$last_y=e.y)},$dragCreate:function(e,t){if(this.State.readonly)return!1;var i=this.getContext(),n=Rt(t,e);if(n.id){webix.extend(i,n,!0),webix.extend(i,{from:this,target:e},!0),i.event=this.master.GetEvent(n.id),this.setDragOffset(n.node,e,t),t.target.getAttribute("webix_resizer")&&(i.$resize=!0);var r=this.master.app;return!!r.callEvent("app:beforedrag",[i,t])&&(i.$resize&&webix.html.addCss(document.body,"webix_active_resize",!0),(u=n.node.cloneNode(!0)).className+=" webix_drag_zone webix_"+(i.$resize?"resize":"drag")+"_event",e.firstChild.appendChild(u),i.$copy=(t.ctrlKey||t.metaKey)&&r.config.copypaste,i.$copy&&"0"!==n.id&&!i.$resize||(n.node.style.visibility="hidden"),u)}if(this.master.app.config.dragCreate&&!this.State.clipboard){var o=this.view.getScrollState().y,a=webix.html.offset(e).y;i.y=webix.html.pos(t).y-a+o;var s=this.getActualDate(this.master,!0),l=s.start_date,c=s.end_date;i.event={id:"0",text:"",start_date:l,end_date:c,$color:"#997CEB",$textColor:"#fff",$top:i.y,$left:0,$height:this.master.minEventHeight,$width:this.master.List.$width-8};var u,h=this.Calendars.getFirstId();h&&(i.event.$color=this.Calendars.getItem(h).color),webix.extend(i,{from:this,target:e},!0),(u=webix.html.create("div")).innerHTML=this.master.ToHTML(i.event),u.firstChild.className+=" webix_drag_zone webix_resize_event",webix.html.addCss(document.body,"webix_active_resize",!0);var p=e.firstChild.appendChild(u.firstChild);return this.setDragOffset(p,e,t),i.$resize=!0,i.$creation=!0,p}return!1},getActualDate:function(e,t){var i=this.getContext();if(i.$resize)return St.getActualDate.apply(this,arguments);var n=webix.Date.copy(e.Day),r=e.List.getFirstId()*e.List.type.height,o=5*Math.round(60*(i.y+r)/e.List.type.height/5);if(webix.Date.add(n,o,"minute"),!t&&webix.Date.equal(n,i.event.start_date))return null;var a=i.event?i.event.end_date-i.event.start_date:36e5;return{start_date:n,end_date:new Date(n.valueOf()+a)}},updateText:function(e){var t=webix.DragControl.getNode(),i=webix.DragControl.getMaster(e.target),n=this.getActualDate(i.master,!0);n.text=e.event.text,t.innerHTML="",t.innerHTML=i.master.EventTemplate(n)},setDragOffset:function(e,t,i){var n=this.getContext(),r=webix.html.pos(i),o=webix.html.offset(e);n.height=o.height,n.x_offset=o.x-r.x,n.y_offset=o.y-r.y;var a=webix.html.offset(t);n.x_diff=o.x-a.x-1,n.y_diff=o.y-a.y}},Ht),jt=webix.extend({mode:"month",$dragIn:function(e,t,i){var n=this.getContext();if(n.from.mode!==this.mode)return!1;n.offset=n.offset||webix.html.offset(t);var r=this.locate(i),o=this.view.getIdByIndex(r),a=this.view.getItemNode(o);return n.$marked!==o&&this.markDropArea(o),a},$dragOut:function(e,t,i){return t!==i&&this.markDropArea(),null},$drop:function(e,t,i){var n=this.getContext();webix.extend(n,{to:this});var r=this.master.app;if(n.from.mode!==this.mode||!r.callEvent("app:beforedrop",[n,i]))return!1;this.markDropArea();var o=n.$copy,a=this.getActualDate(i,o);a&&("0"==n.event.id?this.addEvent(n.event,a):o?this.copyEvent(n.event,a):this.updateEvent(n.event,a))},$dragPos:function(e){var t=this.getContext();e.x+=t.x_offset,e.y+=t.y_offset},$dragCreate:function(e,t){if(this.State.readonly)return!1;var i=Rt(t,e);if(i.id&&"$wsh_multi_more"!=i.id){var n=this.getContext();webix.extend(n,i,!0),webix.extend(n,{from:this,offset:webix.html.offset(e)},!0),n.event=this.master.Events.getItem(i.id),n.start=this.view.getIdByIndex(this.locate(t)),this.setDragOffset(i.node,e,t);var r=this.master.app;if(!r.callEvent("app:beforedrag",[n,t]))return!1;var o=document.createElement("DIV"),a=i.node.cloneNode(!0);return a.style.position="static",o.appendChild(a),o.className=e.className+" webix_drag_zone webix_drag_event",document.body.appendChild(o),n.$copy=(t.ctrlKey||t.metaKey)&&r.config.copypaste,n.$copy&&"0"!==n.event.id||(i.node.style.visibility="hidden"),webix.callEvent("onClick",[t]),o}return!1},getActualDate:function(e,t){var i=this.getContext(),n=this.locate(e)-this.view.getIndexById(i.start);return n||t?{start_date:webix.Date.add(i.event.start_date,n,"day",!0),end_date:webix.Date.add(i.event.end_date,n,"day",!0)}:null},markDropArea:function(e){var t=this.getContext();if(t.$marked&&t.$marked!=e&&(this.view.removeCss(t.$marked,"webix_drag_over"),t.$marked=null,t.$extra&&(webix.html.removeCss(this.view.$view,t.$extra),t.$extra=null)),!t.$marked&&e){this.view.addCss(e,"webix_drag_over"),t.$marked=e;var i=void 0;this.view.getFirstId()==e?i="webix_scheduler_dnd_1":this.view.getLastId()==e&&(i="webix_scheduler_dnd_n"),i&&(webix.html.addCss(this.view.$view,i,!0),t.$extra=i)}},locate:function(e){var t=this.getContext(),i=webix.html.pos(e);return i.x-=t.offset.x,i.y-=t.offset.y,Math.min(Math.floor(i.y/this.view.type.height),this.view.config.yCount-1)*this.view.config.xCount+Math.min(Math.floor(i.x/this.view.type.width),this.view.config.xCount-1)}},Ht),Nt=webix.extend({mode:"multiday"},jt),Wt=webix.extend({$dragCreate:function(e,t){if(this.State.readonly)return!1;var i=this.view.locate(t);if(i){var n=this.getContext(),r=this.view.getItemNode(i).children[0];if(webix.extend(n,{from:this,id:i},!0),n.event=this.master.Events.getItem(i),n.start=this.master.ID,this.setDragOffset(r,e,t),!this.master.app.callEvent("app:beforedrag",[n,t]))return!1;var o=document.createElement("DIV");return o.style.width=n.width+"px",o.style.height=n.height+"px",o.appendChild(r.cloneNode(!0)),o.className=e.className+" webix_drag_zone webix_drag_event",document.body.appendChild(o),this.master.HideWindow(),o}return!1},$dragDestroy:function(e,t){return webix.html.remove(t),!1}},jt),Yt=webix.extend({mode:"units",$drop:function(e,t,i){var n=this.getContext();webix.extend(n,{to:this});var r=this.master.app;if(n.from.mode!==this.mode||!r.callEvent("app:beforedrop",[n,i]))return!1;var o=n.$copy,a=this.getActualDate(this.master,o),s=this.getEventUnits(n);if(a||s){var l=webix.extend(a||{},s||{});"0"==n.event.id?n.$creation?this.State.selected={id:"0",date:n.event.start_date,end_date:l.end_date,unit:l.units}:this.addEvent(n.event,l):o&&!n.$resize?this.copyEvent(n.event,l):this.updateEvent(n.event,l)}},getEventUnits:function(e){var t=e.from.master.Unit.id+"";if(e.event.units){var i=e.event.units.split(","),n=this.master.Unit.id+"";if(n==t||e.$resize)return;var r=i.filter((function(e){return e!=t}));return-1===i.indexOf(n)&&r.push(n),{units:r.join(",")}}return{units:t}}},zt),Gt=webix.extend({mode:"multidayUnits",$dragCreate:function(e,t){if(this.State.readonly)return!1;var i=Rt(t,e,"webix_l_id");if(i.id&&"$wsh_multi_more"!=i.id){var n=this.getContext();webix.extend(n,i,!0),webix.extend(n,{from:this,target:e},!0),n.event=this.master.GetEvent(i.id),this.setDragOffset(i.node,e,t);var r=this.master.app;if(!r.callEvent("app:beforedrag",[n,t]))return!1;var o=i.node.cloneNode(!0);return o.className+=" webix_drag_zone webix_drag_event",o.style.width="100%",e.firstChild.appendChild(o),n.$copy=(t.ctrlKey||t.metaKey)&&r.config.copypaste,n.$copy||(i.node.style.visibility="hidden"),o}return!1},$dragPos:function(e){var t=this.getContext(),i=webix.html.offset(t.target),n=i.height-t.height;e.x=t.x_diff,e.y+=t.y_offset-i.y,e.y<0?e.y=0:e.y>n&&(e.y=n),webix.extend(t,e,!0)},getActualDate:function(e,t){var i=e.State.date,n=this.getContext();if(!t&&webix.Date.equal(i,n.event.start_date))return null;var r=n.event.end_date-n.event.start_date;return{start_date:i,end_date:new Date(i.valueOf()+r)}}},Yt),Kt=webix.extend({mode:"timeline",dragScroll:{direction:"xy"},locate:function(e){var t=this.getContext(),i=this.view.getScrollState(),n=this.view.$scope.Sections.count(),r=this.getEventContext(e,t).y-t.offset.y+i.y;return Math.min(Math.floor(r/this.view.type.height),n-1)},$dragCreate:function(e,t,i){var n=this.getContext();n.$touch="touch"===i;var o=this.master.app;if(this.State.readonly)return!1;var a=Rt(t,e);if(a.id&&"$wsh_multi_more"!=a.id){var s=a.node,l=this.getEventContext(t,n),c=Xt(s,l.x),u=this.view.getScrollState();if(webix.extend(n,r(r({},a),{from:this,offset:webix.html.offset(e),moveMode:c,step:this.getStep(),dx:0,scroll:u,x:l.x,t:parseInt(s.style.top),l:parseInt(s.style.left),w:parseInt(s.style.width)}),!0),n.event=this.master.Events.getItem(a.id),n.start=this.view.getIdByIndex(this.locate(t)),this.setDragOffset(s,e,t),!o.callEvent("app:beforedrag",[n,t]))return!1;"move"===n.moveMode&&webix.extend(n,Jt.call(this,this.dragScroll,this.view.$scope.Scales));var h=document.createElement("DIV"),p=s.cloneNode(!0);return p.style.position="static",h.appendChild(p),h.className=e.className+" webix_drag_zone webix_drag_event",s.parentNode.appendChild(h),n.$copy=(t.ctrlKey||t.metaKey)&&o.config.copypaste,n.$copy&&"0"!==n.event.id&&"move"===n.moveMode||(s.style.visibility="hidden"),webix.callEvent("onClick",[t]),h}return!1},getEventContext:function(e,t){if(t.$touch){if(e.changedTouches&&(!e.touches||!e.touches[0])){var i=e.changedTouches[0];return{x:i.pageX,y:i.pageY}}return e.time?e:webix.env.touch.context(e)}return{x:e.clientX,y:e.clientY}},$dragIn:function(e,t,i){var n=this.getContext();return n.from.mode===this.mode&&(n.offset=n.offset||webix.html.offset(t),"move"!==n.moveMode||n.more||(qt.reset(n),qt.start(n,i)),!0)},$dragPos:function(e){var t=this.getContext(),i=t.x,n=t.t,r=t.l,o=t.w,a=t.scroll,s=t.step,l=t.moveMode,c=this.view.getScrollState();t.dx=e.x-i-(a?a.x:0)+c.x;var u=webix.DragControl.getNode();if("move"===l){var h=t.more?{x:0,y:0}:t.offset;e.x+=t.x_offset-h.x+c.x,e.y+=t.y_offset-h.y+c.y}else"start"===l?(e.x=Math.min(r+t.dx,r+o-s),e.y=n,u.childNodes[0].style.width=u.style.width=Math.max(s,o-t.dx)+"px"):"end"===l&&(e.x=r,e.y=n,u.childNodes[0].style.width=u.style.width=Math.max(o+t.dx,s)+"px")},$drop:function(e,t,i){var n=this.getContext();webix.extend(n,{to:this});var r=this.master.app;if(n.from.mode!==this.mode||!r.callEvent("app:beforedrop",[n,i]))return!1;var o=this.getData(i);o&&("0"==n.event.id?this.addEvent(n.event,o):n.$copy&&"move"===n.moveMode?this.copyEvent(n.event,o):this.updateEvent(n.event,o))},getData:function(e){var t=this.getContext(),i={},n=this.view.getIdByIndex(this.locate(e)),r=t.moveMode,o=t.dx,a=t.step,s=Math.round(o/(a||this.getStep()));if(n!=t.start||t.$copy&&"0"!==t.event.id||s){"move"===r&&(i.section=n);var l=this.view.$scope.Scales;return webix.extend(i,function(e,t,i,n){var r={},o=t.precise?Lt[t.minUnit][0]:t.minUnit;if("start"===i||"move"===i){var a=t.precise?e.start_date:Dt(o,e.start_date);r.start_date=$t(o)(a,n),"start"===i&&Qt(r.start_date,e.end_date,r.all_day)&&(r.start_date=$t(o)(e.end_date,-1)),webix.Date.equal(r.start_date,e.start_date)&&delete r.start_date}if("end"===i||"move"===i){var s=Dt(o,e.end_date);a=t.precise||webix.Date.equal(s,e.end_date)?e.end_date:$t(o)(s,1),r.end_date=$t(o)(a,n),Qt(r.start_date||e.start_date,r.end_date,r.all_day)&&(r.end_date=$t(o)(e.start_date,1)),webix.Date.equal(r.end_date,e.end_date)&&delete r.end_date}return r}(t.event,l,r,s)),i}return null},getStep:function(){var e=this.view.$scope.Scales,t=e.cellWidth;if(e.precise){var i=Lt[e.minUnit][1];t=Math.round(t/("number"==typeof i?i:i()))}return t}},Ht);function Qt(e,t,i){return i?t<e:t<=e}function Xt(e,t){var i=e.getBoundingClientRect(),n=(t-i.left)/i.width,r=webix.env.touch?400:200,o=.2/(i.width>r?i.width/r:1);return n<o&&-1==e.className.indexOf("webix_scheduler_event_break_left")?"start":n>1-o&&-1==e.className.indexOf("webix_scheduler_event_break_right")?"end":"move"}function Jt(e,t){return e.senseX=Math.round(t.cellWidth*(webix.env.touch?1:.5)),e.senseY=Math.round(t.cellHeight*(webix.env.touch?3:1)),e}var Zt={day:zt,month:jt,more:Wt,multiday:Nt,units:Yt,multidayUnits:Gt,timeline:Kt,timelineMore:webix.extend({mode:"timeline",dragScroll:null,$dragCreate:function(e,t,i){var n=this.getContext();if(n.$touch="touch"===i,this.State.readonly)return!1;var r=this.view.locate(t);if(r){var o=this.view.getItemNode(r).children[0];if(webix.extend(n,{from:this,id:r,moveMode:"move",more:!0},!0),n.event=this.master.Events.getItem(r),n.x=n.event.$x+parseInt(e.offsetParent.style.left),n.start=this.master.ID,this.setDragOffset(o,e,t),!this.master.app.callEvent("app:beforedrag",[n,t]))return!1;var a=document.createElement("DIV");return a.style.width=n.width+"px",a.style.height=n.height+"px",a.appendChild(o.cloneNode(!0)),a.className=e.className+" webix_drag_zone webix_drag_event",document.body.appendChild(a),this.master.HideWindow(),a}return!1},$dragDestroy:function(e,t){return webix.html.remove(t),!1}},Kt)},ei=function(e){function t(t,i){var n=e.call(this,t)||this;return i&&(n.WeekDayNum=i.day),n}return n(t,e),t.prototype.config=function(){var e=this;return{view:"list",localId:"dayList",css:"webix_scheduler_day_events",scroll:!1,autoheight:!0,template:"",type:{height:42,css:"webix_scheduler_day_scale_item"},onClick:{webix_scheduler_day_event:function(t){return e.ShowEvent(t)}},onDblClick:{webix_scheduler_day_scale_item:function(t,i){return e.ShowNew(i)}}}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.List=this.$$("dayList"),Ct(this,"scale"),Me(this),this.List.$setSize=function(e,t){webix.ui.view.prototype.$setSize.call(this,e,t)&&this.render()},this.minEventHeight=62,this.ParseHours(),this.on(this.State.$changes,"readonly",(function(){return e.List.render()})),this.List.attachEvent("onAfterRender",(function(){return e.RenderEvents()})),Pt.call(this,this.List,"day");var t=this.getParam("compact",!0);!this.app.config.copypaste||webix.env.mobile||t||nt(this,this.List)},t.prototype.urlChange=function(){var e=this;if(this.data=this.getParam("data"),this.data){if(this.Day=webix.Date.datePart(this.State.date,!0),this.WeekDayNum>-1){var t=this.data.start;this.Day=webix.Date.add(t,this.WeekDayNum,"day",!0)}var i=webix.Date.add(this.Day,1,"day",!0);this.Events=this.FilterToday(this.Day,i),this._marker_update_interval&&(this._marker_update_interval=clearInterval(this._marker_update_interval)),se(this.Day)&&(this._marker_update_interval=setInterval((function(){se(e.Day)?e.UpdateMarkerPosition():(webix.html.remove(e._Marker),e._Marker=e._marker_update_interval=clearInterval(e._marker_update_interval))}),3e5)),this.List.render()}},t.prototype.GetEvent=function(e){for(var t=0;t<this.Events.length;t++)if(this.Events[t].id==e)return this.Events[t];return null},t.prototype.FilterToday=function(e,t){return this.WeekDayNum>-1?this.data.single.filter((function(i){return i.start_date<t&&i.end_date>e})):this.data.single},t.prototype.MarkToday=function(){if(this.Day&&se(this.Day)){var e=webix.html.create("div",{class:"webix_scheduler_today_marker"});this._Marker=this.List.$view.firstChild.appendChild(e),this.UpdateMarkerPosition()}else this._Marker=null},t.prototype.UpdateMarkerPosition=function(){if(this._Marker){var e=new Date,t=60*e.getHours()+e.getMinutes();this._Marker.style.top=Math.round(t*this.List.type.height/60)+"px"}},t.prototype.RenderEvents=function(){var e=this,t=this.Events;if(t&&t.length){this.PrepareEvents();var i=webix.html.create("div",{role:"presentation"});i.innerHTML=t.map((function(t){return e.ToHTML(t)})).join(""),this._DataObj=this.List.$view.firstChild.appendChild(i),this.app.callEvent("events:rendered",[])}this.MarkToday()},t.prototype.PrepareEvents=function(){for(var e=this.Events,t=[],i=0;i<e.length;i++){var n=e[i];n.$inner=!1;var r=this.PruneStack(n,t);t.length&&(t[t.length-1].$inner=!0),r||(t.length?(n.$sorder=t[t.length-1].$sorder+1,n.$inner=!1):n.$sorder=0),t.splice(n.$sorder,0,n),t.length>(t.max_count||0)&&(t.max_count=t.length)}this.SetPosition(t,e)},t.prototype.PruneStack=function(e,t){for(;t.length&&this.GetEventEndDate(t[t.length-1])<=e.start_date;)t.splice(t.length-1,1);for(var i=0;i<t.length;i++)if(this.GetEventEndDate(t[i])<=e.start_date)return e.$sorder=t[i].$sorder,t.splice(i,1),e.$inner=!0,!0;return!1},t.prototype.SetPosition=function(e,t){for(var i=this.List.getFirstId()*this.List.type.height,n=0;n<t.length;n++){var r=t[n];r.$count=e.max_count;var o=Math.floor(this.List.$width/r.$count);r.$left=r.$sorder*o,r.$inner||(o*=r.$count-r.$sorder),r.$width=o-8;var a=ae(this.Day,webix.Date.add(this.Day,1,"day",!0))(r),s=60*a.start_date.getHours()+a.start_date.getMinutes(),l=60*a.end_date.getHours()+a.end_date.getMinutes()||1440;r.$top=Math.round(s*this.List.type.height/60)-i,r.$height=Math.max(this.minEventHeight,(l-s)*this.List.type.height/60)}},t.prototype.ToHTML=function(e){var t=this.EventTemplate(e);return this.EventTemplateStart(e)+t+"</div>"},t.prototype.GetEventEndDate=function(e){var t=e.end_date;return(e.end_date-e.start_date)/6e4*this.List.type.height/60<this.minEventHeight&&(t=webix.Date.add(e.start_date,Math.ceil(this.minEventHeight/this.List.type.height*60),"minute",!0)),t},t.prototype.EventTemplateStart=function(e){var t='class="webix_scheduler_day_event '+(!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":"webix_scheduler_event_selected")+" "+(e.$past?"webix_scheduler_past_event":"")+'"';return"<div webix_e_id='"+e.id+"' "+t+" style='left:"+e.$left+"px; top:"+e.$top+"px; width:"+e.$width+"px; height:"+e.$height+"px; "+pt(e)+"'>"},t.prototype.EventTemplate=function(e){var t=this.app.getService("locale")._,i=this.State.readonly?"":"<div class='webix_icon webix_scheduler_resizer' webix_resizer='true'></div>";return'<div class="webix_scheduler_inner_day"><span class="webix_scheduler_event_name">'+(e.text||t("(No title)"))+'</span><div class="webix_scheduler_event_time">'+webix.i18n.timeFormatStr(e.start_date)+" - "+webix.i18n.timeFormatStr(e.end_date)+"</div></div>"+i},t.prototype.ShowEvent=function(e){var t=Rt(e,this.List.$view);if(t.id&&"0"!=t.id){var i=this.GetEvent(t.id),n=webix.extend(t,me(i),!0);this.State.selected=n}return!1},t.prototype.GetTargetDate=function(e){var t=webix.Date.copy(this.Day||this.State.date);return e&&t.setHours(e),t},t.prototype.ShowNew=function(e){var t=this.State;t.readonly||t.clipboard||(t.selected={id:"0",date:this.GetTargetDate(e)})},t.prototype.UpdateSelection=function(e,t){this.State.selected&&(t.id=e,this.State.selected=me(t))},t}(wt),ti=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=this,i=e.prototype.config.call(this);return i.cols[1]={view:"list",localId:"multiDayList",autoheight:!0,scroll:!1,css:"webix_scheduler_multilist",type:{height:36,template:function(e,i){return t.EventTemplate(e,i)}},onClick:{webix_scheduler_multiday_event:function(e,i,n){return t.ShowEvent(i,n)}}},i},t.prototype.init=function(){var t=this;this.State=this.app.getState(),e.prototype.init.call(this),this._DataObj=this.List.$view.firstChild,Ct(this,"multi",!0),this.MoreIcon=this.$$("more"),this._moreBtn={id:"$wsh_multi_more",$css:"webix_scheduler_multi_more"},this.on(this.$$("multiDayList"),"onAfterRender",(function(){t.app.callEvent("events:rendered",[])})),this.app.config.copypaste&&!webix.env.mobile&&(Me(this),nt(this,this.List,{multi:!0}))},t.prototype.urlChange=function(){var e=this.getParam("data");e&&(this.LimitData(e.multi),this.List.clearAll(),this.List.parse(e.multi))},t.prototype.EventTemplate=function(e,t){var i=t.height-8,n="height:"+i+"px; line-height:"+i+"px; width:calc(100% - 5px);",r="$wsh_multi_more"!==e.id?pt(e):"",o=this.GetStyle(e),a=this.app.getService("locale")._;return'\n\t\t\t<div\n\t\t\t\tclass="'+o+'"\n\t\t\t\tstyle="'+n+" "+r+'">\n\t\t\t\t\t'+(e.text||a("(No title)"))+"\n\t\t\t</div>\n\t\t"},t.prototype.GetStyle=function(e){var t="webix_scheduler_multiday_event";if("$wsh_multi_more"==e.id)return t;var i=this.State.date,n=e.all_day||webix.Date.timePart(e.end_date)?e.end_date:webix.Date.add(e.end_date,-1,"day",!0);return t+=!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":" webix_scheduler_event_selected",t+=e.$past?" webix_scheduler_past_event":"",e.start_date<i&&(t+=" webix_scheduler_event_break_left"),n>=webix.Date.add(i,1,"day",!0)&&(t+=" webix_scheduler_event_break_right"),t},t.prototype.LimitData=function(e){if(e.length>this.maxVisibleLines){var t=e.length-2,i=this.app.getService("locale")._;this._moreBtn.text=t+" "+i("more"),"down"===this._expandState?this._reserve=e.splice(2,t,this._moreBtn):this._reserve=e.slice(2),this.SetMoreIcon(this._expandState),this._reserveIds=this._reserve.map((function(e){return e.id}))}else this.SetMoreIcon()},t.prototype.WrapData=function(){var e=this;if(!this._inAnimation){this._inAnimation=!0,this._expandState="down";var t=this.List.$height-(this._reserveIds.length-1)*this.List.type.height;this.Animate("down",t,(function(){e.List.add(e._moreBtn),e.List.remove(e._reserveIds)}))}},t.prototype.ExpandData=function(){this._inAnimation||(this._inAnimation=!0,this._expandState="up",this.Animate("up"),this.List.remove("$wsh_multi_more"),this.List.parse(this._reserve))},t.prototype.Animate=function(e,t,i){var n=this;this.List.$view.style.transition="height 150ms",t&&(this.List.$view.style.height=t+"px"),setTimeout((function(){i&&i(),n.List.$view.style.transition="",n._inAnimation=!1,n.SetMoreIcon(e)}),150)},t.prototype.SetMoreIcon=function(e){if(e){this._expandState=e;var t="up"===e?"Collapse":"Expand",i=this.app.getService("locale")._;this.MoreIcon.setHTML('<div class="webix_scheduler_more_icon webix_icon wxi-angle-'+e+'" webix_tooltip="'+i(t+" all-day events")+'"><div>')}else this.MoreIcon.setHTML("")},t.prototype.ShowEvent=function(e,t){if("$wsh_multi_more"===e)this.ExpandData();else{var i=me(this.List.getItem(e));i.node=t,this.State.selected=i}return!1},t.prototype.GetEvent=function(e){return this.List.getItem(e)},t.prototype.GetTargetDate=function(){return this.State.date},t}(At),ii=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{css:"webix_scheduler_day",rows:[{view:"template",localId:"header",css:"webix_scheduler_day_header",height:32,template:function(e){return e.date?webix.Date.dateToStr("%l")(e.date):""}},{localId:"multi",hidden:!0,cols:[ti]},{localId:"scroll",view:"scrollview",css:"webix_scheduler_day_scroll",body:{cols:[wt,ei]}}]}},t.prototype.init=function(){var e=this,t=this.app.getState();this.on(t.$changes,"date",(function(t){return e.RefreshData(t)})),this.on(t.$changes,"active",(function(){return e.RefreshData(t.date)})),this.on(this.app,"events:refresh",(function(){return e.RefreshData(t.date)}));var i=this.app.getService("local").events(!0);this.on(i.data,"onStoreUpdated",(function(i,n,r){return r&&e.RefreshData(t.date)})),this.on(t.$changes,"selected",(function(i){i&&!t.clipboard&&e.ScrollScale(i)}))},t.prototype.RefreshData=function(e){var t=this;this.$$("header").setValues({date:e}),this.GetDay(e).then((function(e){t.app&&t.setParam("data",e,!0),e.multi.length?t.$$("multi").show():t.$$("multi").hide()}))},t.prototype.GetDay=function(e){var t=webix.Date.add(e,1,"day",!0);return this.app.getService("local").getEvents(e,t).then((function(e){var t=[],i=[];return e.forEach((function(e){le(e)?t.push(e):i.push(e)})),{multi:t,single:i}}))},t.prototype.ScrollScale=function(e){var t=this;"0"!==e.id||e.date||setTimeout((function(){var e=40*((new Date).getHours()+2);t.$$("scroll").scrollTo(0,e)}),100)},t}(p),ni=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return this.Events={},{view:"calendar",localId:"calendar",events:function(t,i){return e.MarkEvent(t,i)},icons:!1,navigation:!1,monthHeader:!1,skipEmptyWeeks:!0,width:0,height:410}},t.prototype.init=function(){var e=this;this.Calendar=this.getRoot(),this.Calendar.attachEvent("onAfterDateSelect",(function(t){e.app.getState().date=webix.Date.dayStart(t)}))},t.prototype.urlChange=function(){this.data=this.getParam("data"),this.data&&this.RefreshData()},t.prototype.RefreshData=function(){var e=this.data,t=e.start,i=e.weeks,n=e.data,r=webix.Date.add(t,i,"week",!0);for(this.Events={};t<r;){for(var o=webix.Date.add(t,1,"day",!0),a=0;a<n.length;a++)(n[a].all_day?n[a].end_date>=t:n[a].end_date>t)&&n[a].start_date<o&&(this.Events[t.valueOf()]=!0);t=o}this.Calendar.setValue(this.app.getState().date)},t.prototype.MarkEvent=function(e,t){var i="";return t||(i+=webix.Date.isHoliday(e)||""),this.Events[e.valueOf()]&&(i+=" webix_cal_day_with_event"),i},t}(p),ri=function(e){function t(t,i){var n=e.call(this,t)||this;return n.Events=i.events,n.drag=!!webix.isUndefined(i.drag)||i.drag,n}return n(t,e),t.prototype.config=function(){var e=this,t=this.app.getService("locale")._;return{view:"popup",width:266,padding:8,minHeight:70,relative:"right",body:{view:"list",css:"webix_scheduler_more_list",borderless:!0,autoheight:!0,yCount:3,tooltip:{template:""},onClick:{webix_scheduler_month_event:function(t,i){return e.ShowEvent(i)},webix_scheduler_month_event_single:function(t,i){return e.ShowEvent(i)}},type:{height:56,template:function(i,n){return e.MoreTemplate(i,n,t)}}}}},t.prototype.init=function(e){this.Win=e,Me(this),this.drag&&Pt.call(this,e.getBody(),"more",!0)},t.prototype.MoreTemplate=function(e,t,i){var n=webix.i18n,r=!ce(e.start_date,e.all_day?webix.Date.add(e.end_date,1,"day",!0):e.end_date),o=r?"":pt(e),a=!r&&this.webix.Date.equal(e.start_date,e.end_date),s="webix_scheduler_month_event"+(r?"_single":"");return e.$past&&(s+=" webix_scheduler_past_event"),'\n\t\t\t<div\n\t\t\t\tclass="'+s+'"\n\t\t\t\tstyle="'+o+'"\n\t\t\t>\n\t\t\t\t'+(r?ut(e):"")+'\n\t\t\t\t<div webix_tooltip="'+e.text+'" class="webix_event_text">'+(e.text||i("(No title)"))+'</div>\n\t\t\t\t<div class="webix_event_time">\n\t\t\t\t\t'+this.DayFormatStr(e.start_date)+"\n\t\t\t\t\t"+(a?"":n.timeFormatStr(e.start_date)+" -\n\t\t\t\t\t\t"+(r?"":" "+this.DayFormatStr(e.end_date))+"\n\t\t\t\t\t\t"+n.timeFormatStr(e.end_date))+"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"},t.prototype.DayFormatStr=function(e){return webix.Date.dateToStr("%F %j")(e)},t.prototype.ShowEvent=function(e){var t=this.Events.getItem(e);this.app.getState().selected=me(t),this.HideWindow()},t.prototype.ShowWindow=function(e,t,i){var n=this;if(this.ID===e&&this.Win.isVisible())return this.Win.hide();this.ID=e,i=i.map((function(e){return n.Events.getItem(e)}));var r=this.Win.getBody();r.clearAll(),r.parse(i),this.Win.show(t)},t.prototype.HideWindow=function(){this.Win.hide()},t}(p),oi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{view:"dataview",css:"webix_scheduler_calendar",prerender:!0,xCount:7,yCount:5,width:0,height:0,scroll:!1,tooltip:{template:""},onClick:{webix_cal_date:function(t,i){return e.ShowDay(i)},webix_scheduler_month_event:function(t){return e.ShowEvent(t)},webix_scheduler_month_event_single:function(t){return e.ShowEvent(t)},webix_scheduler_more:function(t,i){return e.ShowMore(i)}},onDblClick:{webix_cal_day:function(t,i){return e.ShowNew(i)}},type:{height:"auto",width:"auto",template:function(t,i){return e.CalendarTemplate(t,i)},templateStart:ft,headerHeight:32,eventHeight:28,padding:8}}},t.prototype.init=function(e){var t=this;this.State=this.app.getState(),this.Calendar=e,e.type.master=this.Calendar,Ct(this,"month"),Me(this),this.Events=new webix.DataCollection({}),this.MoreWindow=this.ui(new(this.app.dynamic(ri))(this.app,{events:this.Events})),e.attachEvent("onAfterRender",(function(){return t.RenderEvents()})),Pt.call(this,this.Calendar,"month"),this.app.config.copypaste&&!webix.env.mobile&&nt(this,e)},t.prototype.urlChange=function(){this.data=this.getParam("data",!0),this.data&&this.RefreshData()},t.prototype.CalendarTemplate=function(e){var t=this.app.getService("locale")._,i='<span class="webix_cal_date">'+e.date.getDate()+"</span>";return e.$more&&e.$more.length&&(i+='<div class="webix_scheduler_more">'+e.$more.length+" "+t("more")+"</div>"),i},t.prototype.GetDayCss=function(e,t){var i="webix_cal_day";return se(e)&&(i+=" webix_cal_today"),e.getMonth()!=t?i+=" webix_cal_outside":i+=" "+(webix.Date.isHoliday(e)||""),i},t.prototype.GetMonthData=function(){for(var e=[],t=this.data,i=t.start,n=t.weeks,r=webix.Date.add(i,1,"week",!0).getMonth(),o=webix.Date.copy(i),a=0;a<7*n;a++){var s={date:webix.Date.copy(o),$css:this.GetDayCss(o,r)};(a+1)%7==0&&(s.right=!0),a>=7*(n-1)&&(s.bottom=!0),e.push(s),webix.Date.add(o,1,"day")}return e},t.prototype.RenderEvents=function(){if(this.Events.count()&&this.Calendar.count()){var e=webix.html.create("div",{role:"presentation",class:"webix_scheduler_month_events"}),t=this.data.start,i=this.Calendar.type,n=Math.floor((i.height-i.headerHeight+i.padding-2)/(i.eventHeight+i.padding)),r=webix.Date.copy(t),o=webix.Date.add(r,1,"week",!0),a="",s={},l=this.GetTargetDate(this.Calendar.getLastId()),c=this.GetTargetDate(this.Calendar.getFirstId());this.Calendar.data.each((function(e,t){e.date>=o&&(s={},r=o,o=webix.Date.add(r,1,"week",!0));var i=[],u=[];this.Events.data.each((function(a){var h=a.id;if(!(a.start_date>=o||a.end_date<r||!a.all_day&&webix.Date.equal(a.end_date,r)))if(webix.isUndefined(s[h])){if(a.start_date<webix.Date.add(e.date,1,"day",!0)&&a.end_date>=e.date){for(var p=0;!webix.isUndefined(u[p]);)p++;if(s[h]=p,p>=n)return i.push(h);var d={ms:c,me:l};d.single=this.IsSingleDay(a),d.length=1,d.single||(d.es=a.start_date,d.ee=a.all_day||webix.Date.timePart(a.end_date)?a.end_date:webix.Date.add(a.end_date,-1,"day",!0),d.length+=ce(d.ls=new Date(Math.max(r,d.es)),d.le=new Date(Math.min(o-1,d.ee)))),d.index=t,u[p]=this.ToHTML(a,p,d)}}else e.date<=a.end_date&&a.all_day||e.date<a.end_date?s[h]>=n?i.push(h):u[s[h]]="":delete s[h]}),this);var h=e.$more&&e.$more.length;e.$more=i,h!=i.length&&this.Calendar.render(e.id,e,"paint"),a+=u.join("")}),this),e.innerHTML=a,this._DataObj=this.Calendar.$view.firstChild.appendChild(e),this.app.callEvent("events:rendered",[])}},t.prototype.IsSingleDay=function(e){if(e.all_day)return!ce(e.start_date,webix.Date.add(e.end_date,1,"day",!0));var t=ce(e.start_date,e.end_date);return 1===t&&webix.Date.timePart(e.start_date)&&!webix.Date.timePart(e.end_date)&&(t=0),!t},t.prototype.ToHTML=function(e,t,i){var n=this.Calendar.type,r=i.single?"":pt(e),o=i.length*n.width-n.padding,a=n.eventHeight,s=this.GetPosition(n,t,i.index),l="";i.single&&(l=ut(e)+'<span class="webix_event_time">'+webix.i18n.timeFormatStr(e.start_date)+"</span>");var c=this.GetStyle(e,i),u=this.app.getService("locale")._;return'\n\t\t\t<div\n\t\t\t\twebix_tooltip="'+e.text+'"\n\t\t\t\twebix_e_id="'+e.id+'"\n\t\t\t\tclass="'+c+'"\n\t\t\t\tstyle="height:'+a+"px;line-height:"+a+"px; width:"+o+"px; "+(s+r)+'">\n\t\t\t\t\t'+(l+(e.text||u("(No title)")))+"\n\t\t\t</div>\n\t\t"},t.prototype.GetStyle=function(e,t){var i="webix_scheduler_month_event"+(t.single?"_single":"");return i+=!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":" webix_scheduler_event_selected",i+=e.$past?" webix_scheduler_past_event":"",t.single||(t.es<t.ms&&webix.Date.equal(t.ms,webix.Date.dayStart(t.ls))?i+=" webix_scheduler_event_break_left":t.ee>=webix.Date.add(t.me,1,"day",!0)&&webix.Date.equal(t.me,webix.Date.dayStart(t.le))&&(i+=" webix_scheduler_event_break_right")),i},t.prototype.GetPosition=function(e,t,i){var n=Math.floor(i/this.Calendar.config.xCount),r=i%this.Calendar.config.xCount;return"\n\t\t\ttop:"+(n*e.height+e.headerHeight+t*(e.eventHeight+e.padding))+"px;\n\t\t\tleft:"+r*e.width+"px;\n\t\t"},t.prototype.RefreshData=function(){var e=this.data,t=e.data,i=e.weeks;this.Events.clearAll(),this.Events.parse(t),this.Events.sort((function(e,t){var i=webix.Date.dayStart(e.start_date),n=webix.Date.dayStart(t.start_date);if(webix.Date.equal(i,n)){var r=ce(e.start_date,e.end_date);return ce(t.start_date,t.end_date)-r||e.start_date-t.start_date}return i-n}));var n=this.GetMonthData();this.Calendar.clearAll(),this.Calendar.config.yCount!=i&&(this.Calendar.define("yCount",i),this.Calendar.resize()),this.Calendar.parse(n)},t.prototype.ShowMore=function(e){return this.MoreWindow.ShowWindow(e,this.Calendar.getItemNode(e),this.Calendar.getItem(e).$more||[]),!1},t.prototype.ShowEvent=function(e){var t=Rt(e,this.Calendar.$view);if(t.id&&"0"!=t.id){var i=this.Events.getItem(t.id),n=webix.extend(t,me(i),!0);this.State.selected=n}return!1},t.prototype.ShowNew=function(e){var t=this.State;if(!t.readonly&&!t.clipboard){var i=this.GetTargetDate(e);t.selected={id:"0",date:i}}},t.prototype.ShowDay=function(e){return this.app.getState().$batch({date:this.GetTargetDate(e),mode:"day"}),!1},t.prototype.GetTargetDate=function(e){return e?this.Calendar.getItem(e).date:this.State.date},t.prototype.GetEvent=function(e){return this.Events.getItem(e)},t.prototype.UpdateSelection=function(e,t){this.State.selected&&(t.id=e,this.State.selected=me(t))},t}(p),ai=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{view:"dataview",css:"webix_scheduler_calendar_header",xCount:7,yCount:1,width:0,height:32,scroll:!1,type:{height:"auto",width:"auto",templateStart:ft}}},t.prototype.init=function(e){e.type.master=e,e.parse(this.GetHeaderData())},t.prototype.GetHeaderData=function(){for(var e=[],t=webix.Date.startOnMonday?1:0,i=0;i<7;i++)e.push({value:webix.i18n.calendar.dayShort[(t+i)%7]});return e[e.length-1].right=!0,e},t}(p),si=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;return{view:"list",type:{height:50,template:ht(this.app.getService("locale")._),timeStart:function(t){return e.TimeStart(t)}},on:{onItemClick:function(t){return e.ShowEvent(t)}}}},t.prototype.init=function(){this.List=this.getRoot(),this.State=this.app.getState(),webix.extend(this.List,webix.OverlayBox)},t.prototype.urlChange=function(){this.data=this.getParam("data"),this.data&&this.RefreshData()},t.prototype.RefreshData=function(){var e=this,t=webix.Date.datePart(this.State.date,!0),i=webix.Date.add(t,1,"day",!0);this.app.getService("local").getEvents(t,i).then((function(n){e.List.clearAll(),e.List.parse(n.map(ae(t,i))),e.ToggleOverlay()}))},t.prototype.ToggleOverlay=function(){if(this.List.count())this.List.hideOverlay();else{var e=this.app.getService("locale")._;this.List.showOverlay(e("No Events"))}},t.prototype.ShowEvent=function(e){var t=this.List.getItem(e);this.State.selected=me(t)},t.prototype.TimeStart=function(e){var t=this.app.getService("locale")._;return le(e)?t("All Day"):dt(e.start_date,e.end_date)},t}(p),li=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{rows:this.getParam("compact",!0)?[ni,si]:[ai,oi]}},t.prototype.init=function(){var e=this;this.Data=this.app.getService("local");var t=this.app.getState();this.on(t.$changes,"date",(function(t){return e.RefreshData(t)})),this.on(t.$changes,"active",(function(){return e.RefreshData(t.date)})),this.on(this.app,"events:refresh",(function(){return e.RefreshData(t.date)}));var i=this.app.getService("local").events(!0);this.on(i.data,"onStoreUpdated",(function(i,n,r){return r&&e.RefreshData(t.date)}))},t.prototype.RefreshData=function(e){var t=this,i=webix.Date.monthStart(e),n=webix.Date.add(i,1,"month",!0);i=webix.Date.weekStart(new Date(i.getFullYear(),i.getMonth(),1));var r=Math.ceil((n-i)/864e5/7);n=webix.Date.add(i,r,"week",!0),this.Data.getEvents(i,n).then((function(e){t.app&&t.setParam("data",{start:i,weeks:r,data:e},!0)}))},t}(p),ci=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=webix.skin.$active,t=this.app.getService("locale")._,i=this.getParam("state",!0);return{view:"toolbar",height:e.barHeight,elements:[{},{view:"richselect",label:t("Timeline scale"),labelWidth:120,width:260,value:i.timelineMode,options:[{id:"day",value:t("Day")},{id:"week",value:t("Week")},{id:"month",value:t("Month")}],on:{onChange:function(e){i.timelineMode=e}}}]}},t}(p),ui=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=e.prototype.config.call(this);return t.width=360,t.relative="bottom",t},t.prototype.init=function(e){this.Win=e,Me(this),Pt.call(this,e.getBody(),"timelineMore",!0)},t.prototype.ShowWindow=function(e,t,i){var n=this;if(this.ID===e&&this.Win.isVisible())return this.Win.hide();this.ID=e,i=i.map((function(e){return n.Events.getItem(e)}));var r=this.Win.getBody();r.clearAll(),r.parse(i),this.Win.show(t,{x:t.clientWidth})},t}(ri),hi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this,t=this.GetSectionHeight();return{cols:[{view:"treetable",localId:"sections",css:"webix_scheduler_timeline_sections",width:this.getParam("compact",!0)?80:200,header:!1,scroll:"y",rowHeight:t,scrollAlignY:!1,columns:[{id:"text",header:"",fillspace:!0}]},{view:"list",localId:"list",type:{height:t,template:""},css:"webix_scheduler_timeline"+(webix.env.touch?"_touch":"")+"_bars",onClick:{webix_scheduler_timeline_event:function(t){return e.ShowEvent(t)}},onDblClick:{webix_list_item:function(t,i){return e.ShowNew(t,i)}},tooltip:{template:""},scroll:"xy"}]}},t.prototype.init=function(){var e=this;this.Tree=this.$$("sections"),this.Bars=this.$$("list"),this.State=this.getParam("state",!0),this.InnerState=this.getParam("innerState",!0),this.Data=this.app.getService("local"),this.Events=new webix.DataCollection({scheme:{$change:function(t){return e.RefreshTask(t.id)}}}),this.MoreWindow=this.ui(new(this.app.dynamic(ui))(this.app,{events:this.Events})),Ct(this,"month"),Me(this),this._sectionsReady=this.Data.sections().then((function(t){e.Sections=t,e.Tree.parse(t),e.Bars.parse(t)})),this.HandleScroll();var t=this.app.getService("local").events(!0);this.on(t.data,"onStoreUpdated",(function(t,i,n){return n&&e.RefreshData()})),this.on(this.app,"events:refresh",(function(){return e.RefreshData()})),this.on(this.State.$changes,"active",(function(t,i){return i&&e.RefreshData()})),Pt.call(this,this.Bars,"timeline"),this._mousemove_handler=webix.event(this.Bars.$view,"pointermove",(function(t){"mouse"==t.pointerType&&function(e,t){if(!webix.DragControl.active){var i=Rt(e,t),n=i.id,r=i.node;if(n){var o=Xt(r,e.clientX);r.style.cursor="move"==o?"pointer":"ew-resize"}}}(t,e.Bars.$view)}));var i=this.getParam("compact",!0);!this.app.config.copypaste||webix.env.mobile||i||nt(this,this.Bars)},t.prototype.urlChange=function(){var e=this.Scales=this.getParam("scales",!0);this.DrawGrid(e),this.RefreshData(e)},t.prototype.GetSectionHeight=function(){var e=webix.skin.$active;return this._sectionSize=5,(e.barHeight-2*e.borderWidth)*this._sectionSize},t.prototype.RefreshData=function(e){var t=this;e||(e=this.Scales),webix.promise.all([this._sectionsReady,this.Data.getEvents(e.start,e.end)]).then((function(e){t.ClearCollections(),t.Events.parse(e[1]),t.RenderEvents()}))},t.prototype.ClearCollections=function(){this.Events.clearAll(),this._processed=[],this._lastRow={},this._moreEvents={}},t.prototype.RefreshTask=function(e){var t=this,i=this.GetEvent(e),n=function(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}(this.Sections.data.order,i.section);if(-1!=n){var r=this.State.timelineMode,o=this.GetUnitCount(r);"day"===r&&"week"===r||(o=this.GetUnitCount(o));var a,s=this._processed.find((function(e){if(e.section==i.section){if("day"===r)return t.CheckDates(e.end_date,i.start_date,e.all_day);var n=webix.Date.timePart(e.end_date)?t.GetUnitStart(o,webix.Date.add(e.end_date,1,o,!0)):e.end_date,a=t.GetUnitStart(o,i.start_date);return t.CheckDates(n,a,e.all_day)}return!1}));s?(a=s.$y,this._processed.splice(this._processed.findIndex((function(e){return s.id==e.id})),1)):(webix.isUndefined(this._lastRow[i.section])?this._lastRow[i.section]=0:this._lastRow[i.section]++,this._lastRow[i.section]>=this._sectionSize-1?i.$more=!0:i.$more=!1),this.UpdateTask(i,n,a),this._processed.push(i),this._processed.sort((function(e,t){return e.$y-t.$y}))}else i.$hide=!0},t.prototype.CheckDates=function(e,t,i){return(i?webix.Date.add(e,1,"day",!0):e)<=t},t.prototype.RenderEvents=function(){var e=this;if(this._DataObj&&(this.Bars.$view.firstChild.removeChild(this._DataObj),delete this._DataObj),this.Events.count()&&this.Bars.count()){var t=webix.html.create("div",{role:"presentation"}),i="",n=this.app.getService("locale")._;this.Events.data.each((function(t){t.$hide||(t.$more&&4!=e._lastRow[t.section]?(e._moreEvents[t.section]||(e._moreEvents[t.section]=[],i+=e.MoreBarTemplate(t,n)),e._moreEvents[t.section].push(t.id)):i+=e.BarsTemplate(t,n))})),t.innerHTML=i,this._DataObj=this.Bars.$view.firstChild.appendChild(t),this.app.callEvent("events:rendered",[])}},t.prototype.DrawGrid=function(e){var t=this.Bars;t.$view.style.backgroundImage="url("+this.GetGrid(e,{contrast:"#808080",dark:"#384047"}[webix.skin.$name]||"#ddd")+")",t.$view.style.marginTop="0px",t.$view.style.backgroundPosition="-"+this.InnerState.left+"px -"+this.InnerState.top+"px",this.Resize(e.width)},t.prototype.Resize=function(e){var t=this.Bars.$view.querySelector(".webix_scroll_cont");t.style.width=e+"px",t.style.minHeight="1px"},t.prototype.HandleScroll=function(){var e=this;this.InnerState=this.getParam("innerState",!0),this._scroll_handler=webix.event(this.Bars.$view,"scroll",(function(t){var i=t.target,n=Math.round(i.scrollTop),r=Math.round(i.scrollLeft);e.Bars.$view.style.backgroundPosition="-"+r+"px -"+n+"px",e.InnerState.$batch({top:n,left:r}),e.Tree.scrollTo(0,n),e.MoreWindow.HideWindow()})),this.on(this.Tree,"onScrollY",(function(){var e=this.getScrollState().y;this.$scope.Bars.scrollTo(this.$scope.InnerState.left,e)}))},t.prototype.BarsTemplate=function(e,t){var i=pt(e),n=this.Scales,r=e.$w-2;e.all_day&&e.end_date<n.end&&(r+=this.GetUnitWidth(n,e.start_date));var o='<div class="webix_scheduler_timeline_content">'+(e.text||t("(no title)"))+"</div>",a="webix_scheduler_timeline_event";a+=!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":" webix_scheduler_event_selected",e.start_date<this.Scales.start?a+=" webix_scheduler_event_break_left":e.end_date>this.Scales.end&&(a+=" webix_scheduler_event_break_right");var s=this.GetTooltip(e);return'<div webix_e_id="'+e.id+'" \n\t\t\twebix_tooltip="'+s+'" class="'+a+'" \n\t\t\tstyle="left:'+e.$x+"px;top:"+e.$y+"px;width:"+r+"px;height:"+e.$h+"px;"+i+'">\n\t\t\t'+o+"\n\t\t</div>"},t.prototype.GetTooltip=function(e){return e.text},t.prototype.MoreBarTemplate=function(e,t){var i=t("Show more"),n='<div class="webix_scheduler_timeline_content" webix_tooltip="'+i+'">'+i+"</div>";return'<div webix_e_id="$wsh_multi_more" webix_r_id="'+e.section+'" class="webix_scheduler_timeline_event webix_scheduler_multi_more" style="left:0px;top:'+e.$y+"px;width:100%;height:"+e.$h+'px;">\n\t\t\t'+n+"\n\t\t</div>"},t.prototype.ShowEvent=function(e){var t=Rt(e,this.Bars.$view);if("$wsh_multi_more"===t.id){var i=t.node.getAttribute("webix_r_id");this.MoreWindow.ShowWindow(i,this.Tree.getItemNode(i),this._moreEvents[i]||[])}else if(t.id&&"0"!=t.id){var n=this.GetEvent(t.id),r=webix.extend(t,me(n),!0);this.State.selected=r}return!1},t.prototype.ShowNew=function(e,t){var i=this.State;if(!i.readonly&&!i.clipboard){var n=this.Scales,r=n.start,o=n.precise?this.GetUnitCount(n.minUnit):n.minUnit,a=Math.floor(e.offsetX/this.GetUnitWidth(n)),s=this.AddUnit(o,r,a);i.selected={id:"0",date:s,section:t}}},t.prototype.GetEvent=function(e){return this.Events.getItem(e)},t.prototype.UpdateSelection=function(e,t){this.State.selected&&(t.id=e,this.State.selected=me(t))},t.prototype.GetTargetDate=function(){var e=this.mousePosUnit||0,t=this.Scales;return this.AddUnit(t.minUnit,t.start,e)},t.prototype.GetUnitCount=function(e){return Lt[e][0]},t.prototype.GetUnitStart=function(e,t){return Dt(e,t)},t.prototype.AddUnit=function(e,t,i){return $t(e)(t,i)},t.prototype.GetGrid=function(e,t){return Et(e.cellWidth,e.cellHeight,t)},t.prototype.UpdateTask=function(e,t,i){return It(e,this._lastRow[e.section]+t*this._sectionSize,this.Scales,this.Scales.cellHeight-12,i)},t.prototype.GetUnitWidth=function(e,t){if(e.precise&&("day"!==e.minUnit||"month"!==e.minUnit)){var i=Lt[e.minUnit][1],n="number"==typeof i?i:i(t);return Math.floor(e.cellWidth/n)}return e.cellWidth},t}(p),pi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{cols:[{width:this.getParam("compact",!0)?80:200,css:"webix_scheduler_timeline_space",borderless:!1},{view:"template",localId:"scale",height:20,css:"webix_scheduler_timeline_scale"}]}},t.prototype.init=function(){var e=this.$$("scale"),t=this.InnerState=this.getParam("innerState",!0);this.on(t.$changes,"left",(function(t){return e.scrollTo(t,null)}))},t.prototype.urlChange=function(){this.RenderScales()},t.prototype.RenderScales=function(){var e=this,t=this.getParam("scales",!0),i=this.$$("scale"),n=t.rows.map((function(i){return'<div class="webix_scheduler_timeline_scale_row" style=\'height:'+i.height+"px;width:"+t.width+"px'>"+i.cells.map((function(t){return e.CellTemplate(t,i.type)})).join("")+"</div>"})).join("");i.config.height=t.height,i.setHTML(n),i.resize()},t.prototype.CellTemplate=function(e){return'<div class="webix_scheduler_timeline_scale_cell '+e.css+'" style="width:'+e.width+'px;">'+e.format(e.date)+"</div>"},t.prototype.DateIsToday=function(e){var t=webix.Date.dayStart(new Date);return webix.Date.equal(t,webix.Date.dayStart(e))},t}(p),di=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{rows:[ci,pi,hi]}},t.prototype.init=function(){var e=this,t=this.State=this.getParam("state",!0),i=this.InnerState=V({top:0,left:0});this.setParam("innerState",i,!0),this.on(t.$changes,"date",(function(i){return e.SetScales(i,t.timelineMode)})),this.on(t.$changes,"timelineMode",(function(i,n){n&&e.SetScales(t.date,i)}))},t.prototype.SetScales=function(e,t){var i=this.ResetScales(t,e);this.setParam("scales",i,!0)},t.prototype.GetScalesArray=function(e){switch(e){case"day":return[{unit:"hour",format:"%H:00"}];case"week":return[{unit:"day",step:1,format:"%d"}];case"month":return[{unit:"week",format:function(e){var t=webix.Date.dateToStr("%d %M"),i=webix.Date.weekStart(e),n=webix.Date.add(webix.Date.add(i,1,"week",!0),-1,"day",!0);return t(i)+" - "+t(n)}}];default:return[{unit:this.GetDefaultScaleUnit(e),format:function(e,t){var i=webix.Date.dateToStr("%d %M %YYYY");return i(e)+" - "+i(t)}}]}},t.prototype.GetScalesCellWidth=function(e){switch(e){case"day":return 80;case"week":return 300;case"month":return 400;default:return 100}},t.prototype.GetScalePrecision=function(e){switch(e){case"day":case"week":return!1;default:return!0}},t.prototype.AddUnit=function(e,t,i){return $t(e)(t,i)},t.prototype.GetUnitStart=function(e,t){return Dt(e,t)},t.prototype.ResetScales=function(e,t){var i=this.GetUnitStart(e,t),n=this.AddUnit(e,i,1),r=webix.skin.$active;return Tt(i,n,this.GetScalePrecision(e),this.GetScalesCellWidth(e),r.barHeight-2*r.borderWidth,this.GetScalesArray(e))},t.prototype.GetDefaultScaleUnit=function(e){return Lt[e][0]||e},t}(p),_i=function(e){function t(t,i){var n=e.call(this,t)||this;return i&&(n.Unit=i.unit),n}return n(t,e),t.prototype.config=function(){var e=this;return{view:"list",localId:"unitList",css:"webix_scheduler_day_events",scroll:!1,autoheight:!0,template:"",type:{height:42,css:"webix_scheduler_day_scale_item"},onClick:{webix_scheduler_day_event:function(t){return e.ShowEvent(t)}},onDblClick:{webix_scheduler_day_scale_item:function(t,i){return e.ShowNew(i)}}}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.List=this.$$("unitList"),Ct(this,"scale"),Me(this),this.List.$setSize=function(e,t){webix.ui.view.prototype.$setSize.call(this,e,t)&&this.render()},this.minEventHeight=62,this.ParseHours(),this.on(this.State.$changes,"readonly",(function(){return e.List.render()})),this.List.attachEvent("onAfterRender",(function(){return e.RenderEvents()})),Pt.call(this,this.List,"units");var t=this.getParam("compact",!0);!this.app.config.copypaste||webix.env.mobile||t||nt(this,this.List)},t.prototype.FilterToday=function(t,i){var n=this;return e.prototype.FilterToday.call(this,t,i).filter((function(e){if(e.units){var t=e.units.split(","),i=n.Unit.id+"";return-1!==t.indexOf(i)}return!1}))},t.prototype.ShowNew=function(e){var t=this.State;if(!t.readonly&&!t.clipboard){var i=webix.Date.copy(this.Day||t.date),n=this.Unit.id;i.setHours(e),t.selected={id:"0",date:i,unit:n}}},t}(ei),fi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{type:"clean",cols:[{borderless:!1,width:51},{view:"dataview",localId:"header",css:"webix_scheduler_day_header",xCount:1,yCount:1,width:0,height:32,scroll:!1,type:{height:"auto",width:"auto"},template:function(e){return e.value}}]}},t.prototype.init=function(){var e=this;this.Header=this.$$("header"),this.Units=this.app.getService("local").units(),this.Units.then((function(t){e.Header.sync(t,(function(){e.Header.define({xCount:t.count()}),e.Header.resize()}))}))},t}(p),bi=function(e){function t(t,i){var n=e.call(this,t)||this;return i&&(n.Unit=i.unit),n}return n(t,e),t.prototype.config=function(){var e=this;return{view:"list",localId:"multiDayList",autoheight:!0,scroll:!1,css:"webix_scheduler_multilist",type:{height:36,template:function(t,i){return e.EventTemplate(t,i)}},onClick:{webix_scheduler_multiday_event:function(t,i,n){return e.ShowEvent(i,n)}}}},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.List=this.$$("multiDayList"),this._expandState="down",this.maxVisibleLines=3,this._DataObj=this.List.$view.firstChild,Ct(this,"multi",!0),this._moreBtn={id:"$wsh_multi_more",$css:"webix_scheduler_multi_more"},this.on(this.app,"units:multi:state",(function(t){t!==e._expandState&&("down"===t?e.WrapData():e.ExpandData())})),Pt.call(this,this.List,"multidayUnits"),Me(this),this.app.config.copypaste&&!webix.env.mobile&&nt(this,this.List,{multi:!0})},t.prototype.urlChange=function(){var e=this.getParam("data");if(e){var t=webix.copy(e.multi),i=this.FilterByUnits(t);this.LimitData(i),this.List.clearAll(),this.List.parse(i)}},t.prototype.EventTemplate=function(e,t){var i=t.height-8,n="height:"+i+"px; line-height:"+i+"px; width:calc(100% - 5px);",r="$wsh_multi_more"!==e.id?pt(e):"",o=this.GetStyle(e),a=this.app.getService("locale")._;return'\n\t\t\t<div\n\t\t\t\tclass="'+o+'"\n\t\t\t\tstyle="'+n+" "+r+'">\n\t\t\t\t\t'+(e.text||a("(No title)"))+"\n\t\t\t</div>\n\t\t"},t.prototype.GetStyle=function(e){var t="webix_scheduler_multiday_event";if("$wsh_multi_more"==e.id)return t;var i=this.State.date,n=e.all_day||webix.Date.timePart(e.end_date)?e.end_date:webix.Date.add(e.end_date,-1,"day",!0);return t+=!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":" webix_scheduler_event_selected",t+=e.$past?" webix_scheduler_past_event":"",e.start_date<i&&(t+=" webix_scheduler_event_break_left"),n>=webix.Date.add(i,1,"day",!0)&&(t+=" webix_scheduler_event_break_right"),t},t.prototype.LimitData=function(e){if(delete this._reserve,delete this._reserveIds,e.length>this.maxVisibleLines){var t=e.length-2,i=this.app.getService("locale")._;this._moreBtn.text=t+" "+i("more"),"down"===this._expandState?this._reserve=e.splice(2,t,this._moreBtn):this._reserve=e.slice(2),this._reserveIds=this._reserve.map((function(e){return e.id})),this.app.callEvent("units:multi:state",[this._expandState,!1])}},t.prototype.WrapData=function(){var e=this;if(!this._inAnimation&&(this._expandState="down",this._reserveIds)){this._inAnimation=!0;var t=this.List.$height-(this._reserveIds.length-1)*this.List.type.height;this.Animate("down",t,(function(){e.List.add(e._moreBtn),e.List.remove(e._reserveIds)}))}},t.prototype.ExpandData=function(){var e=this.List.exists("$wsh_multi_more");this._inAnimation||(this._expandState="up",e&&(this._inAnimation=!0,this.Animate("up"),this.List.remove("$wsh_multi_more"),this.List.parse(this._reserve)))},t.prototype.Animate=function(e,t,i){var n=this;this.List.$view.style.transition="height 150ms",t&&(this.List.$view.style.height=t+"px"),setTimeout((function(){i&&i(),n.List.$view.style.transition="",n._inAnimation=!1}),150)},t.prototype.ShowEvent=function(e,t){if("$wsh_multi_more"===e)this.app.callEvent("units:multi:state",["up",!0]);else{var i=me(this.List.getItem(e));i.node=t,this.State.selected=i}return!1},t.prototype.FilterByUnits=function(e){var t=this;return e.filter((function(e){if(e.units){var i=e.units.split(","),n=t.Unit.id+"";return-1!==i.indexOf(n)}return!1}))},t.prototype.GetEvent=function(e){return this.List.getItem(e)},t.prototype.GetTargetDate=function(){return this.State.date},t}(p),gi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=this,i=e.prototype.config.call(this),n=this.app.getService("local").units();return i.cols[0].onClick={"wxi-angle-down":function(){return t.app.callEvent("units:multi:state",["up",!0])},"wxi-angle-up":function(){return t.app.callEvent("units:multi:state",["down",!0])}},i.cols[1]={cols:[]},n.then((function(e){for(var n=e.serialize(),r=0;r<n.length;++r)i.cols[1].cols.push(new(t.app.dynamic(bi))(t.app,{unit:n[r]}));return i}))},t.prototype.init=function(){var e=this;this.State=this.app.getState(),this.MoreIcon=this.$$("more"),this.on(this.State.$changes,"date",(function(){e.SetMoreIcon()})),this.on(this.app,"units:multi:state",(function(t,i){e.Animate(t,i?150:1)}))},t.prototype.Animate=function(e,t){var i=this;setTimeout((function(){i.SetMoreIcon(e)}),t)},t}(At),wi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var e=this;this.Compact=this.getParam("compact",!0);var t=this.app.getService("local").units(),i={localId:"multi",hidden:!0,cols:[gi]},n={localId:"scroll",view:"scrollview",scroll:"y",css:"webix_scheduler_week_days",body:{cols:[wt]}};return t.then((function(t){for(var r=t.serialize(),o=0;o<r.length;++o)n.body.cols.push(new(e.app.dynamic(_i))(e.app,{unit:r[o]}));return{rows:[fi,i,n]}}))},t.prototype.init=function(){var e=this,t=this.app.getState();this.on(t.$changes,"date",(function(t){return e.RefreshData(t)})),this.on(t.$changes,"active",(function(){return e.RefreshData(t.date)})),this.on(this.app,"events:refresh",(function(){return e.RefreshData(t.date)}));var i=this.app.getService("local").events(!0);this.on(i.data,"onStoreUpdated",(function(i,n,r){return r&&e.RefreshData(t.date)}))},t.prototype.RefreshData=function(e){var t=this;this.GetDay(e).then((function(e){t.app&&t.setParam("data",e,!0),e.multi.length?t.$$("multi").show():t.$$("multi").hide()}))},t.prototype.GetDay=function(e){var t=webix.Date.add(e,1,"day",!0);return this.app.getService("local").getEvents(e,t).then((function(e){var t=[],i=[];return e.forEach((function(e){le(e)?t.push(e):i.push(e)})),{multi:t,single:i}}))},t}(p),Ai=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=e.prototype.config.call(this);return t.css="webix_scheduler_week",t.type.headerHeight=28,t},t.prototype.urlChange=function(){this.data=this.getParam("data"),this.data&&(this.List.clearAll(),this.List.parse(this.data.all),this.ToggleOverlay())},t.prototype.TemplateHeader=function(e){var t=new Date(1*e),i="%l, %F <span class='webix_scheduler_monthday"+(se(t)?" webix_scheduler_today":"")+"'>%j</span>";return'<span class="webix_unit_header_inner">'+webix.Date.dateToStr(i)(t)+"</span>"},t}(bt),xi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{type:"clean",cols:[{borderless:!1,width:51},{view:"dataview",localId:"header",css:"webix_scheduler_day_header",xCount:7,yCount:1,width:0,height:32,scroll:!1,type:{height:"auto",width:"auto"},template:function(e){return'<span class="webix_scheduler_weekday">'+e.day+'</span> <span class="webix_scheduler_monthday">'+e.date+"</span>"}}]}},t.prototype.urlChange=function(){this.data=this.getParam("data"),this.data&&this.RefreshData()},t.prototype.RefreshData=function(){for(var e=this.data.start,t=[];e<this.data.end;){var i={day:webix.i18n.calendar.dayShort[e.getDay()],date:e.getDate()};se(e)&&(i.$css="webix_scheduler_list_today"),t.push(i),e=webix.Date.add(e,1,"day",!0)}var n=this.$$("header");n.clearAll(),n.parse(t)},t}(p),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){var t=this,i=e.prototype.config.call(this);return i.cols[1]={view:"dataview",localId:"multiDayList",css:"webix_scheduler_multidays",scroll:!1,height:32,xCount:7,yCount:1,width:0,type:{width:"auto",height:"auto",itemHeight:36},template:"",tooltip:{template:""},onClick:{webix_scheduler_multiday_event:function(e){return t.ShowEvent(e)}}},i},t.prototype.init=function(){var t=this;this.State=this.app.getState(),e.prototype.init.call(this),Ct(this,"multi"),Me(this),this.Events=new webix.DataCollection({}),this.List.attachEvent("onAfterRender",(function(){return t.RenderEvents()})),Pt.call(this,this.List,"multiday"),this.app.config.copypaste&&!webix.env.mobile&&nt(this,this.List)},t.prototype.urlChange=function(){this.data=this.getParam("data"),this.data&&this.ParseDays(this.data.multi)},t.prototype.ParseDays=function(e){if(e.length){this.Events.clearAll(),this.Events.parse(e);for(var t=[],i=0;i<7;i++)t.push({id:i+1,date:webix.Date.add(this.data.start,i,"day",!0)});this.BreakEventsByDay(t),this.SetMoreIcon(this._maxEvents>this.maxVisibleLines?this._expandState:null),this.List.blockEvent(),this.List.parse(t),this.ResetListHeight(),this.List.unblockEvent(),this.RenderEvents()}},t.prototype.BreakEventsByDay=function(e){var t=this;this.Days=[];var i={};this._maxEvents=0,e.forEach((function(e,n){var r=e.date;t.Days.push([]),t.Events.data.each((function(e){if(webix.isUndefined(i[e.id])){if(e.start_date<webix.Date.add(r,1,"day",!0)&&e.end_date>=r){for(var o=0;!webix.isUndefined(t.Days[n][o]);)o++;i[e.id]=o;var a={};a.es=e.start_date,a.ee=e.all_day||webix.Date.timePart(e.end_date)?e.end_date:webix.Date.add(e.end_date,-1,"day",!0),a.length=1+ce(a.ls=new Date(Math.max(t.data.start,a.es)),a.le=new Date(Math.min(t.data.end-1,a.ee))),e.$config=a,t.Days[n][o]=e}}else r<=e.end_date&&e.all_day||r<e.end_date?t.Days[n][i[e.id]]="":delete i[e.id]})),t.Days[n].length>t._maxEvents&&(t._maxEvents=t.Days[n].length)}))},t.prototype.RenderEvents=function(){var e=this,t=this.Events.count();if(t){var i=webix.html.create("div",{role:"presentation"}),n="",r=0,o="down"===this._expandState&&this._maxEvents>this.maxVisibleLines;this.List.data.each((function(t,i){for(var a=[],s=o?e.maxVisibleLines-1:e.Days[i].length,l=0;l<s;++l)a[l]=e.Days[i][l],a[l]&&(a[l]=e.ToHTML(a[l],i,l),r++);n+=a.join("")})),o&&(n+=this.MoreOption(t-r)),i.innerHTML=n,this._DataObj=this.List.$view.firstChild.appendChild(i),this.app.callEvent("events:rendered",[])}},t.prototype.ToHTML=function(e,t,i){var n=pt(e),r=this.GetSizePosition(e.$config.length,t,i),o=this.GetStyle(e,e.$config),a=this.app.getService("locale")._;return'\n\t\t\t<div\n\t\t\t\twebix_tooltip="'+(e.text||a("(No title)"))+'"\n\t\t\t\twebix_e_id="'+e.id+'"\n\t\t\t\tclass="'+o+'"\n\t\t\t\tstyle="'+r+" "+n+'">\n\t\t\t\t\t'+(e.text||a("(No title)"))+"\n\t\t\t</div>\n\t\t"},t.prototype.GetStyle=function(e,t){var i=this.data,n=i.start,r=i.end,o="webix_scheduler_multiday_event";return o+=!this.State.selected||e.id!=this.State.selected.id&&e.id!=this.State.selected.date?"":" webix_scheduler_event_selected",t.es<n&&webix.Date.equal(n,webix.Date.dayStart(t.ls))&&(o+=" webix_scheduler_event_break_left"),t.ee>=r&&webix.Date.equal(webix.Date.add(r,-1,"day",!0),webix.Date.dayStart(t.le))&&(o+=" webix_scheduler_event_break_right"),o+(e.$past?" webix_scheduler_past_event":"")},t.prototype.MoreOption=function(e){var t=this.app.getService("locale")._;return'<div webix_e_id="$wsh_multi_more" class="webix_scheduler_multiday_event webix_scheduler_multi_more" style="'+this.GetSizePosition(this.List.config.xCount,0,this.maxVisibleLines-1)+'">'+e+" "+t("more")+"</div>"},t.prototype.GetSizePosition=function(e,t,i){var n=e*this.List.type.width-4,r=this.List.type.itemHeight-8;return"width:"+n+"px; height:"+r+"px; line-height:"+r+"px; left:"+(this.List.type.width*t+1)+"px; top:"+(i*this.List.type.itemHeight+4)+"px;"},t.prototype.ShowEvent=function(e){var t=Rt(e,this.List.$view);if(t.id){if("$wsh_multi_more"===t.id)return this.ExpandData();var i=this.Events.getItem(t.id),n=webix.extend(t,me(i),!0);this.State.selected=n}return!1},t.prototype.ExpandData=function(){this._inAnimation||(this._inAnimation=!0,this._expandState="up",this.Animate("up"),this.ResetListHeight(this._maxEvents))},t.prototype.WrapData=function(){var e=this;if(!this._inAnimation){this._inAnimation=!0,this._expandState="down";var t=this.List.$height-(this._maxEvents-this.maxVisibleLines)*this.List.type.height;this.Animate("down",t,(function(){e.ResetListHeight(e.maxVisibleLines)}))}},t.prototype.ResetListHeight=function(e){e||(e="down"===this._expandState?Math.min(this._maxEvents,this.maxVisibleLines):this._maxEvents);var t=e*this.List.type.itemHeight;this.List.type.height!==t&&(this.List.type.height=t,this.List.define("height",t),this.List.resize())},t.prototype.GetEvent=function(e){return this.Events.getItem(e)},t.prototype.GetTargetDate=function(e){return e?this.List.getItem(e).date:this.State.date},t}(At),mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){if(this.Compact=this.getParam("compact",!0),this.Compact)return{rows:[Ai]};for(var e={localId:"scroll",view:"scrollview",scroll:"y",css:"webix_scheduler_week_days",body:{cols:[wt]}},t=0;t<7;++t)e.body.cols.push(new(this.app.dynamic(ei))(this.app,{day:t}));return{rows:[xi,{localId:"multi",hidden:!0,cols:[vi]},e]}},t.prototype.init=function(){var e=this,t=this.app.getState();this.on(t.$changes,"date",(function(t){return e.RefreshData(t)})),this.on(t.$changes,"active",(function(){return e.RefreshData(t.date)})),this.on(this.app,"events:refresh",(function(){return e.RefreshData(t.date)}));var i=this.app.getService("local").events(!0);this.on(i.data,"onStoreUpdated",(function(i,n,r){return r&&e.RefreshData(t.date)})),this.Compact||this.on(t.$changes,"selected",(function(t){return t&&e.ScrollScale(t)}))},t.prototype.RefreshData=function(e){var t=this,i=webix.Date.weekStart(e),n=webix.Date.add(i,1,"week",!0);this.GetWeek(i,n).then((function(e){t.app&&t.setParam("data",e,!0),e.multi.length?t.$$("multi").show():t.$$("multi").hide()}))},t.prototype.GetWeek=function(e,t){var i=this;return this.app.getService("local").getEvents(e,t).then((function(n){if(i.Compact)return{start:e,end:t,all:n};var r=[],o=[];return n.forEach((function(e){le(e)?r.push(e):o.push(e)})),{start:e,end:t,multi:r,single:o}}))},t.prototype.ScrollScale=function(e){var t=this;"0"!==e.id||e.date||setTimeout((function(){var e=40*((new Date).getHours()+2);t.$$("scroll").scrollTo(0,e)}),100)},t}(p),yi=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._month=i.month,n}return n(t,e),t.prototype.config=function(){var e=this;return this.DayEvents={},{view:"calendar",localId:"calendar",events:function(t){return e.MarkEvent(t)},icons:!1,navigation:!1,calendarHeader:"%F",skipEmptyWeeks:!0,borderless:!0,onClick:{webix_cal_day_with_event:function(t){return e.ShowEvents(t)},webix_cal_month:function(){return e.ShowMonth()}},onDblClick:{webix_cal_day:function(t){return e.ShowNew(t)}},on:{onChange:function(t,i){return"user"===i&&e.SetStateDate(t)}}}},t.prototype.init=function(){var e=this;this.Data=this.app.getService("local"),this.Calendar=this.getRoot(),this.Events=new webix.DataCollection({});var t,i,n=this.State=this.app.getState();this.on(n.$changes,"date",(function(t){return e.ManageDateChange(t)})),this.on(n.$changes,"active",(t=function(){return e.RefreshData(e.GetMonthStart(n.date))},i=!1,function(){if(i)return t.apply(this,arguments);i=!0})),this.on(this.app,"events:refresh",(function(){return e.RefreshData(e.GetMonthStart(n.date))}));var r=this.app.getService("local").events(!0);this.on(r.data,"onStoreUpdated",(function(t,i,r){return r&&e.RefreshData(e.GetMonthStart(n.date))})),this.Popup=this.ui(new(this.app.dynamic(ri))(this.app,{events:this.Events,drag:!1}))},t.prototype.SetStateDate=function(e){this.State.date=webix.Date.dayStart(e)},t.prototype.ManageDateChange=function(e){if(!this._date||this._date.getFullYear()!=e.getFullYear()){var t=this.MonthStart=this.GetMonthStart(e);this.Calendar.showCalendar(t),this.RefreshData(t)}this._month===e.getMonth()?this.Calendar.setValue(e):this.Calendar.getValue()&&this.Calendar.setValue(),this._date=e},t.prototype.GetMonthStart=function(e){return new Date(e.getFullYear(),this._month,1)},t.prototype.RefreshData=function(e){var t=this;this.DayEvents={};var i=webix.Date.add(e,1,"month",!0);this.Data.getEvents(e,i).then((function(n){t.Events.clearAll(),t.Events.parse(n);for(var r=function(){var i=webix.Date.add(e,1,"day",!0);n.forEach((function(n){if((n.all_day?n.end_date>=e:n.end_date>e)&&n.start_date<i){var r=e.valueOf();t.DayEvents[r]||(t.DayEvents[r]=[]),t.DayEvents[r].push(n.id)}})),e=i};e<i;)r();t.Calendar.refresh()}))},t.prototype.MarkEvent=function(e){var t=webix.Date.isHoliday(e)||"";return this.DayEvents[e.valueOf()]&&(t+=" webix_cal_day_with_event"),t},t.prototype.GetDay=function(e){var t=e.target.innerHTML;return t?new Date(this.MonthStart).setDate(1*t):null},t.prototype.ShowEvents=function(e){var t=this.GetDay(e);if(t){var i=this.DayEvents[t];this.Popup.ShowWindow(t,e.target.parentNode,i||[])}},t.prototype.ShowNew=function(e){var t=this.State;if(!t.readonly&&!t.clipboard){var i=this.GetDay(e);i&&(t.mode="day",t.selected={id:"0",date:i})}},t.prototype.ShowMonth=function(){this.State.$batch({mode:"month",date:this.MonthStart})},t}(p),Ci=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.config=function(){return{view:"scrollview",body:{padding:20,view:"flexlayout",css:"webix_scheduler_year",cols:this.GetCalendars()}}},t.prototype.GetCalendars=function(){for(var e=[],t=0;t<12;t++)e.push(new(this.app.dynamic(yi))(this.app,{month:t}));return e},t}(p),ki={JetView:p};ki["bars/add"]=Y,ki["bars/date"]=G,ki.bars=re,ki["bars/nav"]=K,ki["bars/navpopup"]=ne,ki["event/actionmenu"]=oe,ki["event/form"]=Fe,ki["event/formpopup"]=Ue,ki["event/info"]=at,ki["event/recurringform"]=Le,ki.main=lt,ki["modes/agenda"]=gt,ki["modes/common/actionpopup"]=st,ki["modes/common/hourscale"]=wt,ki["modes/common/multimore"]=At,ki["modes/common/unitlist"]=bt,ki["modes/day/events"]=ei,ki["modes/day"]=ii,ki["modes/day/multiday"]=ti,ki["modes/month/compact"]=ni,ki["modes/month/events"]=oi,ki["modes/month/header"]=ai,ki["modes/month"]=li,ki["modes/month/list"]=si,ki["modes/month/more"]=ri,ki["modes/timeline/bar"]=ci,ki["modes/timeline/chart"]=hi,ki["modes/timeline"]=di,ki["modes/timeline/more"]=ui,ki["modes/timeline/scale"]=pi,ki["modes/units/events"]=_i,ki["modes/units/header"]=fi,ki["modes/units"]=wi,ki["modes/units/multiday"]=gi,ki["modes/units/multidaylist"]=bi,ki["modes/week/compact"]=Ai,ki["modes/week/header"]=xi,ki["modes/week"]=mi,ki["modes/week/multiday"]=vi,ki["modes/year/calendar"]=yi,ki["modes/year"]=Ci,ki["side/editor"]=ee,ki.side=ie,ki["side/popup"]=te;var Si=function(){function e(e){this.app=e,this.store=this.createEvents(),this.events_ready=null,!1!==e.config.calendars&&(this.cals=this.createCalendars(),this.cals_ready=null),!1!==e.config.units&&(this.unitsCache=this.createUnits(),this.units_ready=null),e.config.timeline&&(this._sections=this.createSections(),this.sections_ready=null);var t=e.config.serverUTC;this.strToDate=webix.Date.strToDate(webix.i18n.parseFormat,t),this.dateToStr=webix.Date.dateToStr(webix.i18n.parseFormat,t),this.dateToLocalStr=webix.Date.dateToStr(webix.i18n.parseFormat),this.loaded_ranges={}}return e.prototype.createEvents=function(){var e=this;return new webix.DataCollection({scheme:{$change:function(t){"string"==typeof t.start_date&&(t.start_date=e.strToDate(t.start_date)),"string"==typeof t.end_date&&(t.end_date=e.strToDate(t.end_date)),e.app.config.recurring&&(t.$recurring=t.recurring?pe(t.recurring):null,t.$recurring&&Te(t),"string"!=typeof t.origin_id||isNaN(t.origin_id)||(t.origin_id*=1)),"string"==typeof t.all_day&&(t.all_day*=1),e.getColor(t,e.cals&&e.cals.getItem(t.calendar))},$serialize:function(t){return e.eventOut(t)},$export:function(t){return e.eventOut(t)}}})},e.prototype.events=function(e,t){var i=this,n=this.store;return e?n:this.calendars().then((function(){return i.app.config.dynamic?i.events_ready||(i.events_ready=webix.promise.resolve(i.store)):i.events_ready&&!t||(i.events_ready=i.app.getService("backend").events().then((function(e){return n.clearAll(),n.parse(e),n}))),i.events_ready}))},e.prototype.getEvents=function(e,t){var i,n=this,r=this.app.config.dynamic;if(r){var o=this.getParams(r);i=o.then?o.then((function(){return n.getLocal(e,t)})):!0===o?this.getLocal(e,t):this.loaded_ranges[o.from]=this.getDynamic(o).then((function(){return n.getLocal(e,t)}))}else i=this.getLocal(e,t);return i},e.prototype.getLocal=function(e,t){var i=this;return this.events().then((function(n){var r=i.app.config,o=i.app.getState().active,a=[],s=new Date,l=i.app.config.dimPastEvents;return n.data.each((function(n){(!r.calendars||function(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return!0;return!1}(o,n.calendar))&&n.start_date<t&&(n.end_date>e||n.end_date>=e&&n.all_day||n.$recurring&&(!n.$recurring.UNTIL||n.$recurring.UNTIL>e))&&(i.app.config.recurring&&n.recurring?a=a.concat(function(e,t,i){var n=i.$recurring,r={},o=[];we(n,r);for(var a=new Date(i.start_date),s=i.end_date-i.start_date,l=1;e-a>=(s||1)&&(!n.UNTIL||a<n.UNTIL)&&(!n.COUNT||l<=n.COUNT)||ge(n.EXDATE,a);)++l,Ae(a,n,r);for(;t>a&&(!n.UNTIL||a<n.UNTIL)&&(!n.COUNT||l<=n.COUNT);){if(!ge(n.EXDATE,a)){var c=webix.copy(i);a.setHours(i.start_date.getHours()),c.start_date=new Date(a),c.end_date=new Date(1*a+s),c.$id=i.id,c.id=c.start_date.valueOf()+"_"+i.id,o.push(c)}l++,Ae(a,n,r)}return o}(e,t,n).map((function(e){return l&&(e.$past=i.isPast(e,s)),e}))):(delete n.recurring,l&&(n.$past=i.isPast(n,s)),a.push(n))),n.start_date=i.roundTime(n.start_date),n.end_date=i.roundTime(n.end_date)})),a.sort((function(e,t){return e.start_date-t.start_date||e.end_date-t.end_date})),a}))},e.prototype.isPast=function(e,t){return e.all_day?e.end_date<webix.Date.dayStart(t):e.end_date<t},e.prototype.getDynamic=function(e){var t=this;return this.app.getService("backend").events(e).then((function(i){return t.store.parse(i),t.loaded_ranges[e.from]=!0,i}))},e.prototype.getParams=function(e){var t=this.app.getState(),i=webix.i18n.parseFormatStr,n=webix.Date[e+"Start"](t.date),r=webix.Date.add(n,1,e,!0);"month"!==e&&"year"!==e||"week"!==t.mode&&"month"!==t.mode||(n.getDay()&&(n=webix.Date.weekStart(n)),r.getDay()&&(r=webix.Date.add(webix.Date.weekStart(r),1,"week")));var o=i(n);return this.loaded_ranges[o]?this.loaded_ranges[o]:{from:o,to:i(r)}},e.prototype.createCalendars=function(){var e=this;return new webix.DataCollection({scheme:{$sort:{dir:"desc",by:"active",as:Bi}},on:{onAfterDelete:function(){return e.setActive()},onAfterAdd:function(){return e.setActive()},"data->onDataUpdate":function(t,i,n){n&&(i.color!==n.color&&(e.store.data.each((function(n){n.calendar==t&&e.getColor(n,i)})),e.app.callEvent("events:refresh")),i.active!==n.active&&(e.setActive(),setTimeout((function(){e.cals.sort("#active#","desc",Bi)}),400)))}}})},e.prototype.calendars=function(e,t){var i=this;if(0==this.app.config.calendars)return!e&&webix.promise.resolve();var n=this.cals;return e?n:(this.cals_ready&&!t||(this.cals_ready=this.app.getService("backend").calendars().then((function(e){return n.clearAll(),n.parse(e),i.setActive(),n}))),this.cals_ready)},e.prototype.eventOut=function(e,t,i){e=webix.copy(e),!i&&e.recurring&&Te(e);var n=t?this.dateToStr:this.dateToLocalStr;return e.start_date&&(e.start_date=n(e.start_date)),e.end_date&&(e.end_date=n(e.end_date)),t||(delete e.$recurring,delete e.$textColor,delete e.$color,delete e.$past),e},e.prototype.setActive=function(){var e=[];this.cals.data.each((function(t){1*t.active&&e.push(t.id)})),this.app.getState().active=e},e.prototype.getColor=function(e,t){var i,n;e.$color=t?t.color:e.color||"#01C2A5",e.$textColor=(i=e.color||e.$color,n=webix.color.toRgb(i),Math.round((299*n[0]+587*n[1]+114*n[2])/1e3)>180?"#475466":"#ffffff")},e.prototype.roundTime=function(e){var t=webix.Date.copy(e);return t.setMinutes(5*Math.round(t.getMinutes()/5)),t},e.prototype.isLastPart=function(e){return!this.store.find((function(t){return e.origin_id==t.origin_id&&(e.$id||e.id)!=t.id&&e.start_date<t.start_date}),!0)},e.prototype.createUnits=function(){return new webix.DataCollection({data:[]})},e.prototype.units=function(e,t){if(0==this.app.config.units)return!e&&webix.promise.resolve();var i=this.unitsCache;return e?i:(this.units_ready&&!t||(this.units_ready=this.app.getService("backend").units().then((function(e){return i.clearAll(),i.parse(e),i}))),this.units_ready)},e.prototype.createSections=function(){return new webix.DataCollection({})},e.prototype.sections=function(e,t){var i=this._sections;return e?i:(this.sections_ready&&!t||(this.sections_ready=this.app.getService("backend").sections().then((function(e){return i.clearAll(),i.parse(e),i}))),this.sections_ready)},e.prototype.clearAll=function(){this.loaded_ranges={},this.store.clearAll(),this.events_ready=null,!1!==this.app.config.calendars&&(this.cals.clearAll(),this.cals_ready=null),!1!==this.app.config.units&&(this.unitsCache.clearAll(),this.units_ready=null),!1!==this.app.config.timeline&&(this._sections.clearAll(),this.sections_ready=null)},e}();function Bi(e,t,i){return 1*e[i]>1*t[i]?1:-1}var $i=function(){function e(e){this.app=e,this.Back=e.getService("backend");var t=this.Local=e.getService("local");this.Events=t.events(!0),this.Cals=t.calendars(!0),this.State=e.getState()}return e.prototype.addEvent=function(e,t,i){var n=this,r=this.Local.eventOut(e,!0,t);return this.Back.addEvent(r).then((function(t){return i&&n.Events.remove(i),e.id=t.id,n.Events.add(e)}))},e.prototype.updateEvent=function(e,t,i,n,r){var o=this,a=this.Local.eventOut(t,!0,r);return this.Back.updateEvent(e,a,i,n).then((function(){if(o.Events.updateItem(e,t),"all"===i){var r=o.Events.find((function(t){return t.origin_id==e})).map((function(e){return e.id}));o.Events.remove(r)}else if("next"===i&&n){var a=o.Events.getItem(e);a.origin_id&&(e=a.origin_id),r=o.Events.find((function(t){return t.origin_id==e&&t.start_date>=n})).map((function(e){return e.id})),o.Events.remove(r)}}))},e.prototype.removeEvent=function(e,t,i){var n=this,r=this.State.selected?this.State.selected.id:e.$id||e.id,o=!!t&&Be(i,e.start_date);if("next"===t&&o&&(t=$e.call(this,e,t)),!t||"all"===t||"this"===t&&!i||"next"===t&&e.origin_id&&o)"all"===t&&e.origin_id&&(r=e.origin_id),this.Back.removeEvent(r).then((function(){n.Events.remove(r);var e=n.Events.find((function(e){return e.origin_id==r})).map((function(e){return e.id}));n.Events.remove(e)}));else if("this"===t||"next"===t){i||(r=e.origin_id,e=this.Events.getItem(r));var a=webix.Date.dayStart(i?new Date(1*i.split("_")[0]):e.start_date),s="this"===t?ke(a,e):Ce(a,e);this.updateEvent(r,{recurring:s},t,a,!0)}},e.prototype.addCalendar=function(e){var t=this;return e||(e={text:"",color:"#997CEB",active:1}),this.Back.addCalendar(e).then((function(i){return e.id=i.id,t.Cals.add(e,0),e.id}))},e.prototype.updateCalendar=function(e,t){var i=this;return this.app.getState().readonly?webix.promise.resolve(this.Cals.updateItem(e,t)):this.Back.updateCalendar(e,t).then((function(){return i.Cals.updateItem(e,t)}))},e.prototype.removeCalendar=function(e){var t=this;this.Back.removeCalendar(e).then((function(){t.Cals.remove(e)}))},e}(),Di=function(){function e(e,t){this.app=e,this._url=t}return e.prototype.url=function(e){return this._url+e},e.prototype.events=function(e){return webix.ajax(this.url("events"),e).then((function(e){return e.json()}))},e.prototype.addEvent=function(e){return webix.ajax().post(this.url("events"),e).then((function(e){return e.json()}))},e.prototype.updateEvent=function(e,t,i,n){var r=t;return i&&(r.recurring_update_mode=i),n&&(r.recurring_update_date=n),webix.ajax().put(this.url("events/"+e),r).then((function(e){return e.json()}))},e.prototype.removeEvent=function(e){return webix.ajax().del(this.url("events/"+e)).then((function(e){return e.json()}))},e.prototype.calendars=function(){return webix.ajax(this.url("calendars")).then((function(e){return e.json()}))},e.prototype.addCalendar=function(e){return webix.ajax().post(this.url("calendars"),e).then((function(e){return e.json()}))},e.prototype.updateCalendar=function(e,t){return webix.ajax().put(this.url("calendars/"+e),t).then((function(e){return e.json()}))},e.prototype.removeCalendar=function(e){return webix.ajax().del(this.url("calendars/"+e)).then((function(e){return e.json()}))},e.prototype.units=function(e){return webix.ajax().get(this.url("units"),e).then((function(e){return e.json()}))},e.prototype.sections=function(){return webix.ajax(this.url("sections")).then((function(e){return e.json()}))},e}(),Ei=function(e){function t(t){var i,n,o,a=this,s=V({mode:t.mode||"month",date:webix.Date.datePart(t.date||new Date),readonly:t.readonly||!1,active:[],selected:null,timelineMode:t.timelineMode||"week"}),l={router:v,version:"10.1.0",debug:!0,start:"/main",params:{state:s,forceCompact:(t=t||{}).compact},compactWidth:780,recurring:!0,calendars:!0,timeline:!!t.timeline,copypaste:!0,dragCreate:!0,dimPastEvents:!1};return(a=e.call(this,r(r({},l),t))||this).setService("backend",new(a.dynamic(Di))(a,a.config.url)),a.setService("local",new(a.dynamic(Si))(a,t)),a.setService("operations",new(a.dynamic($i))(a)),o={updateConfig:function(e){var t=i.getRoot(),r=t.$view;n?n&&!r.id&&(r.id=n):(r.id?n=r.id:r.id=n="webix_"+webix.uid(),webix.html.addStyle(".webix_win_inside *:not(.webix_modal_box):not(.webix_modal_cover){ z-index: 0; }"),webix.html.addStyle("#"+n+"{ position: relative; }"),webix.html.addStyle("#"+n+" .webix_window{ z-index:2 !important; }"),webix.html.addStyle("#"+n+" .webix_disabled{ z-index:1 !important; }")),e.container=n,e.fullscreen&&(e._fillApp=!0,delete e.fullscreen),e.on||(e.on={});var o=!0,a=e.on.onShow;return e.on.onShow=function(){var e=this;a&&a.apply(this,arguments),o&&(this.$setSize=function(i,n){j(e,t,!0),webix.ui.window.prototype.$setSize.apply(e,[i,n])},N(this,i),o=null),webix.callEvent("onClick",[]),webix.html.addCss(r,"webix_win_inside"),t.disable(),j(this,t)},e}},(i=a).setService("jet-win",o),a.use(M,a.config.locale||{lang:"en",webix:{en:"en-US"}}),a}return n(t,e),t.prototype.dynamic=function(e){return this.config.override&&this.config.override.get(e)||e},t.prototype.require=function(e,t){return"jet-views"===e?ki[t]:"jet-locales"===e?Li[t]:null},t.prototype.getState=function(){return this.config.params.state},t}(x);webix.protoUI({name:"scheduler",app:Ei,defaults:{borderless:!0},$init:function(){var e=this;this.name="scheduler";var t=this.$app.getState();for(var i in t)O(t,this.config,i);t.$changes.attachEvent("date",(function(){})),this.$app.attachEvent("app:beforedrag",(function(t,i){return e.callEvent("onBeforeEventDrag",[t,i])})),this.$app.attachEvent("app:beforedrop",(function(t,i){return e.callEvent("onBeforeEventDrop",[t,i])}))},$exportView:function(e){return"png"===e.export_mode||"pdf"===e.export_mode&&"image"===e.display?this.$app.getRoot():this.$app.getService("local").events(!0)},getState:function(){return this.$app.getState()},getService:function(e){return this.$app.getService(e)},clearAll:function(){this.$app.getService("local").clearAll()}},webix.ui.jetapp);var Ti={Backend:Di,LocalData:Si,Operations:$i},Li={en:{Week:"Week",Day:"Day",Month:"Month",Year:"Year",Agenda:"Agenda",Units:"Units",Timeline:"Timeline",Today:"Today",Create:"Create",Next:"Next",Previous:"Previous","Next day":"Next day","Previous day":"Previous day","Next week":"Next week","Previous week":"Previous week","Next month":"Next month","Previous month":"Previous month","Add calendar":"Add calendar","Do you really want to remove this calendar?":"Do you really want to remove this calendar?","Edit calendar":"Edit calendar",Delete:"Delete",Save:"Save",Title:"Title",Color:"Color",Active:"Active",Settings:"Settings","(no title)":"(no title)","Inactive calendar":"Inactive calendar","No Events":"No Events","All Day":"All Day",more:"more","Expand all-day events":"Expand all-day events","Collapse all-day events":"Collapse all-day events","The event will be deleted permanently, are you sure?":"The event will be deleted permanently, are you sure?",Done:"Done","Delete event":"Delete event",Close:"Close",Edit:"Edit","(No title)":"(No title)",Event:"Event",Start:"Start",End:"End",Calendar:"Calendar",Notes:"Notes",from:"from",to:"to","Edit event":"Edit event","Assigned to units":"Assigned to units","No units":"No units","Unknown unit":"Unknown unit",never:"never",none:"none",daily:"daily",day:"day",days:"days",every:"Every",weekly:"weekly",week:"week",weeks:"weeks",each:"Every",monthly:"monthly",month:"month",months:"months",yearly:"yearly",year:"year",years:"years",Repeat:"Repeat","End repeat":"End repeat","Repeats each":"Repeats each",till:"till",times:"times","weekly, every":"weekly, every","monthly, every":"monthly, every","yearly, every":"yearly, every","every working day":"every working day",custom:"custom",Every:"Every",on:"on",of:"of","day of year":"day of year","after several occurrences":"after several occurrences",date:"date","week on":"week on","Change recurring pattern":"Change recurring pattern","Save changes?":"Save changes?","All events":"All events","This event":"This event","This event and the following":"This event and the following",Cancel:"Cancel",Apply:"Apply","Edit recurring event":"Edit recurring event","Timeline scale":"Timeline scale",Section:"Section","Show more":"Show more","Copy of":"Copy of","Copy event":"Copy event"}};e.App=Ei,e.locales=Li,e.services=Ti,e.views=ki,Object.defineProperty(e,"__esModule",{value:!0})}(t)},98629:()=>{webix.i18n.locales["th-TH"]={groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2,dateFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`%j/%m/${e.getFullYear()+543}`)(e),timeFormat:"%G:%i",longDateFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`%j %F ${e.getFullYear()+543}`)(e),fullDateFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`%j %F ${e.getFullYear()+543} %G:%i`)(e),am:["am","AM"],pm:["pm","PM"],price:"฿{obj}",priceSettings:{groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2},calendar:{monthFull:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dayFull:["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],dayShort:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},aria:{dateFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`%d %F ${e.getFullYear()+543}`)(e),monthFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`%F ${e.getFullYear()+543}`)(e),yearFormat:e=>null==e?"":"string"==typeof e?e:webix.Date.dateToStr(`${e.getFullYear()+543}`)(e)}}},43693:(e,t,i)=>{"use strict";i.r(t);var n=i(75701),r=i.n(n),o=i(1724);r()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;var a=i(94285);r()(a.Z,{insert:"head",singleton:!1}),a.Z.locals;var s=i(32543);r()(s.Z,{insert:"head",singleton:!1}),s.Z.locals;var l=i(60898);r()(l.Z,{insert:"head",singleton:!1}),l.Z.locals;var c=i(26997);r()(c.Z,{insert:"head",singleton:!1}),c.Z.locals;var u=i(43008);r()(u.Z,{insert:"head",singleton:!1}),u.Z.locals;var h=i(18607),p=i.n(h);i(28183),i(65717),i(54327),i(94654),i(71884),i(78841),webix.protoUI({name:"tinymce-editor",defaults:{config:{theme:"silver",statusbar:!1},value:""},$init:function(){webix.html.addStyle(".tox-tinymce{ border:0px !important}"),this._mce_id="webix_mce_"+(this.config.id||webix.uid()),this.$view.innerHTML="<textarea id='"+this._mce_id+"' style='width:100%; height:100%'></textarea>",this._waitEditor=webix.promise.defer(),this.$ready.push(this._require_tinymce_once)},render:function(){this._set_inner_size()},_require_tinymce_once:function(){var e=this.config;if(!1===e.cdn||window.tinymce)this._init_tinymce_once();else{var t=e.apiKey?e.apiKey:"no-api-key",i=e.cdn||"https://cdn.tiny.cloud/1/"+t+"/tinymce/5.0.14-54";window.tinyMCEPreInit={query:"",base:i,suffix:".min"},webix.require([i+"/tinymce.min.js"]).then(webix.bind(this._init_tinymce_once,this)).catch((function(e){console.log(e)}))}},_init_tinymce_once:function(){p().dom.Event.domLoaded||(p().dom.Event.domLoaded=!0);var e=webix.copy(this.config.config||{});webix.extend(e,{selector:"#"+this._mce_id,resize:!1},!0);var t=e.setup;e.setup=webix.bind((function(e){t&&t(e),e.on("init",webix.bind(this._mce_editor_ready,this),!0)}),this),webix.delay((function(){p().init(e)}),this)},_mce_editor_ready:function(e){this._editor=e.target,this.setValue(this.config.value),this._set_inner_size(),this._waitEditor.resolve(this._editor)},_set_inner_size:function(){this._editor&&(this.$view.querySelector(".tox-tinymce").style.height=this.$height+"px")},$setSize:function(e,t){webix.ui.view.prototype.$setSize.call(this,e,t)&&this._set_inner_size()},setValue:function(e){this.config.value=e,this._waitEditor.then((function(t){t.setContent(e)}))},getValue:function(){return this._editor?this._editor.getContent():this.config.value},focus:function(){this._waitEditor.then((function(e){e.focus()}))},getEditor:function(e){return e?this._waitEditor:this._editor}},webix.ui.view),i(98629),Promise.resolve().then(i.t.bind(i,42116,23)).then((e=>window.gantt=e)),Promise.resolve().then(i.t.bind(i,36645,23)).then((e=>window.kanban=e)),Promise.resolve().then(i.t.bind(i,9391,23)).then((e=>window.pivot=e)),Promise.resolve().then(i.t.bind(i,97136,23)).then((e=>window.reports=e)),Promise.resolve().then(i.t.bind(i,9934,23)).then((e=>window.scheduler=e))}}]);
//# sourceMappingURL=webix.resources.773897271bbb7c91daac.js.map